core: fix variable declaration used in several loops

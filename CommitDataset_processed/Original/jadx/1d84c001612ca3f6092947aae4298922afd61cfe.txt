core: fix 'break' in complex 'if' in loop (fix #67)

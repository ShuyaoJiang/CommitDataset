reformat code and fix sonar warnings

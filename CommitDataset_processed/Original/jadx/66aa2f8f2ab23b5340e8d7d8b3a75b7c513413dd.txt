fix issues reported by coverity and code style

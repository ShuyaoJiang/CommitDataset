core: move enum restore pass to later stage

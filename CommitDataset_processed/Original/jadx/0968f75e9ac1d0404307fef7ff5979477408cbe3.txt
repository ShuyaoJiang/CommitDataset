core: fix condition in loops (issue #9)

Refactor Token Service (#39808)

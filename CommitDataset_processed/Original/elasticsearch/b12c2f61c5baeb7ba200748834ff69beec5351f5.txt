Use exact numDocs in synced-flush and metadata snapshot (#30228)

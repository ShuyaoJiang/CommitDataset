Copy checkpoint atomically when rolling generation (#35407)

Make keepalive pings bidirectional and optimizable (#35441)

Refactors steps and adds some execution logic

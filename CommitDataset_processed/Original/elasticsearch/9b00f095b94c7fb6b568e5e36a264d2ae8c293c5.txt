Painless: Move More Logic to PainlessLookup (#32689)

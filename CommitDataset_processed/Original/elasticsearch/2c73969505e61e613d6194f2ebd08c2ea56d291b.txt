Introduce soft-deletes retention policy based on global checkpoint (#30335)

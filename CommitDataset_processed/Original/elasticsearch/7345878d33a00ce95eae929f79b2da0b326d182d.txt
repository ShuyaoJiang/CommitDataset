[ML] Refactor delimited file structure detection (#33233)

Implement adaptive replica selection (#26128)

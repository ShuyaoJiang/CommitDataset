Optimize the composite aggregation for match_all and range queries (#28745)

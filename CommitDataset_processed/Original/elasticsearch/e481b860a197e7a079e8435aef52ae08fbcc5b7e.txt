Enable engine factory to be pluggable (#31183)

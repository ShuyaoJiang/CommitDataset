Separate acquiring safe commit and last commit (#28271)

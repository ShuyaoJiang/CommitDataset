Changes update replica and alllocation to async steps

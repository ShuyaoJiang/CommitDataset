Squashed commit of the following: (#39836)

Unify http channels and exception handling (#31379)

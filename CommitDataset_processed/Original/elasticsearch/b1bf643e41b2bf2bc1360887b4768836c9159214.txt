lazy snapshot repository initialization (#31606)

Refactors ClientHelper to combine header logic (#30620)

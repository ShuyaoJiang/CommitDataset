[ML] Move consuming and closing results stream to result processor (#36314)

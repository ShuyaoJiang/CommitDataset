I give up. I can no longer maintain the in-place algorithm. The bugs have defeated me.

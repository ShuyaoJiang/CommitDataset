more carefully bound the segment count by maximum size/weight

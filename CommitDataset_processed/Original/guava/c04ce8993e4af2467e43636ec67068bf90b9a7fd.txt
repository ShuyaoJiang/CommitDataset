Lots of minor cleanups and simplifications.

Extract CollectPreconditions with some common checks.

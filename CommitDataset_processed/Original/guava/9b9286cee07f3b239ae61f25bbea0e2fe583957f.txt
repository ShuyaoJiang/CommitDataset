A teensy weensy optimization for the no-self-loops case.

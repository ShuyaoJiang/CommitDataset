Rewrite AbstractFuture to fix the following issues

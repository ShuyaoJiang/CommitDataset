Many small improvements in common.collect.

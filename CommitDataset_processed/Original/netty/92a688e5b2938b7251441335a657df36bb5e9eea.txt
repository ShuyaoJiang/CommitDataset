Retrofit the codec framework with the new API (in progress)

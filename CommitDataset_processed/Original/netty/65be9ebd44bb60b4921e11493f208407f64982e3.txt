 Start to refactor oio transport to share more code. See #186
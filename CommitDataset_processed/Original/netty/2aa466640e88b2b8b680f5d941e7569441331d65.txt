Ported Read/WriteTimeoutHandler with simplification

Correctly check if cipher is supported for each SslProvider before trying to run test and fix buffer leaks in test. (#8247)

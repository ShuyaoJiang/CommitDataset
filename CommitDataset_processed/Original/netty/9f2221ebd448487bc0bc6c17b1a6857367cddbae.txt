CompositeByteBuf optimizations and new addFlattenedComponents method (#8939)

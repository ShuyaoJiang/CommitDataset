Rewrite HttpObjectDecoder to make use of proper state machine

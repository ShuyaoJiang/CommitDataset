Extract common parts from `if` statements (#7831)

Implement Thread caches for pooled buffers to minimize conditions. This fixes [#2264] and [#808].

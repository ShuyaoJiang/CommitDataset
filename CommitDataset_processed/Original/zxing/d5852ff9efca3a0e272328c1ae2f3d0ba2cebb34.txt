Use preview buffer approach to avoid excessive GC

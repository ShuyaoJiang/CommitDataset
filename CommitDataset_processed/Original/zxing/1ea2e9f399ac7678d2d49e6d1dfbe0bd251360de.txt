Improvement from issue 309

1d complete; tests pass; need to valgrind

CommandLineRunner can now handle URIs again; refactored some duplicated code

Issue 918 Add MECARD/vCard switch after factoring out and tidying some of the contact encoding logic

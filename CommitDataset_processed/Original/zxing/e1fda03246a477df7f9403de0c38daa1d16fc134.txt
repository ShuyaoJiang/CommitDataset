Another user-suggested fix - misdetecting rectangular matrices in corner cases

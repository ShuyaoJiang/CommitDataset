Refactor metrics to expose richer feature set

Refactor CacheStatisticsProvider to use generics

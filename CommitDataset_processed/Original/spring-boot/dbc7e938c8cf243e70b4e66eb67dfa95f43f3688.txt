Restructor and improve Origin support

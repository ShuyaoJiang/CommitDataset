2.x: rename and refactor classes to match the design document
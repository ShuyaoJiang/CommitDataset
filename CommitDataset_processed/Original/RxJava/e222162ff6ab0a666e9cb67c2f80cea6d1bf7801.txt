2.x: first step switching to the reduced-allocation architecture (#4030)

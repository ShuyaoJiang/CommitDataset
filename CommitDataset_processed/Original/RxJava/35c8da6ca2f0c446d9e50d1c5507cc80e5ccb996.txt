2.x: add assembly tracking, minor fixes and cleanup (#4417)

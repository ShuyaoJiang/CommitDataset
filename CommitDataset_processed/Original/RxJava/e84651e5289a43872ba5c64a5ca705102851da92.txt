Use DisposableHelper and SubscriptionHelper to reduce duplication. (#4058)

Add proper tests for fluent-interface pattern and fixed a little bug

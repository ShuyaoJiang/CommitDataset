Refactored Event Queue (#806)

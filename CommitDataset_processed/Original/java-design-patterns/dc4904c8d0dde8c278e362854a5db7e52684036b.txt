Changed the implementation for better understanding

Fixed all the code changes after review

Split out the codegen runtime from the reflective lookup

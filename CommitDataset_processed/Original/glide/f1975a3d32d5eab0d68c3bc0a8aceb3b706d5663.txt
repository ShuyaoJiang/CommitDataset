Add preconditions and documentation to stop null gif header errors.

Bug 3425881/Patch 3450234 by Patrick Schlott/Christoph Schroeder, reviewed by Richard West

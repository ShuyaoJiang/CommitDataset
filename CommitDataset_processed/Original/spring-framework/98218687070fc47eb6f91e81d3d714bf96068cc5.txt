Refactor and polish various Comparator impls

Polish + minor refactoring of ResourceUrlProvider

Polishing along with backports to 3.1.4

Extract IdGenerator into a top-level class

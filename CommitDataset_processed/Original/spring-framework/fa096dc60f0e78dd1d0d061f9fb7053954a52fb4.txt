Minor refactoring in StringDecoder + polish

Replaced Map synchronization with ConcurrentHashMap to avoid session access deadlocks

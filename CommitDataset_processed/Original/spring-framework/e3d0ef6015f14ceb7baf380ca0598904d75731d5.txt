Use Map.forEach instead of manual Map.Entry iteration wherever possible

Refactor and polish spring-messaging

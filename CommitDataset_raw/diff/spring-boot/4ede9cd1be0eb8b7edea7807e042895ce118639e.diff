[+++ b/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/websocket/WebSocketAutoConfiguration.java, +import org.springframework.util.Assert;, + * @author Phillip Webb, +	private static final String WS_LISTENER = "org.apache.tomcat.websocket.server.WsContextListener";, +, +		return new EmbeddedServletContainerCustomizer() {, +					logger.info("NonEmbeddedServletContainerFactory detected. Websockets ", +							+ "support should be native so this normally is not a problem.");, +				Assert.state(container instanceof TomcatEmbeddedServletContainerFactory,, +				TomcatEmbeddedServletContainerFactory tomcatContainer = (TomcatEmbeddedServletContainerFactory) container;, +				tomcatContainer.addContextCustomizers(new TomcatContextCustomizer() {, +		// With Tomcat 8.0.8 ApplicationListener is not required, +		return null;, +	 * class moved packages in Tomcat 8 and been deleted in 8.0.8 so we have to use, +	 * reflection., +		if (listenerType == null) {, +			ReflectionUtils.invokeMethod(ClassUtils.getMethod(context.getClass(),, +					"addApplicationListener", String.class), context, WS_LISTENER);, +, +		}, +		else {, +			Object instance = BeanUtils.instantiateClass(, +					ClassUtils.getConstructorIfAvailable(listenerType, String.class,, +							boolean.class), WS_LISTENER, false);, +}]
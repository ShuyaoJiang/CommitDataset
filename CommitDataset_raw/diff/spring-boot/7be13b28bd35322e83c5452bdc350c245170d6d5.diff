[+++ b/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/metrics/export/MetricExportProperties.java, +	public void setUpDefaults() {, +				value.setIgnoreTimestamps(defaults.isIgnoreTimestamps());, +				value.setSendLatest(defaults.isSendLatest());, +				value.setDelayMillis(defaults.getDelayMillis());, +		return this.export;, +++ b/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/metrics/export/MetricExportProperties.java, +	public void setUpDefaults() {, +				value.setIgnoreTimestamps(defaults.isIgnoreTimestamps());, +				value.setSendLatest(defaults.isSendLatest());, +				value.setDelayMillis(defaults.getDelayMillis());, +		return this.export;, +++ /dev/null, +++ b/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/metrics/export/MetricExportProperties.java, +	public void setUpDefaults() {, +				value.setIgnoreTimestamps(defaults.isIgnoreTimestamps());, +				value.setSendLatest(defaults.isSendLatest());, +				value.setDelayMillis(defaults.getDelayMillis());, +		return this.export;, +++ /dev/null, +++ b/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/metrics/opentsdb/OpenTsdbMetricWriter.java, +/*, + * Copyright 2012-2015 the original author or authors., + *, + * Licensed under the Apache License, Version 2.0 (the "License");, + * you may not use this file except in compliance with the License., + * You may obtain a copy of the License at, + *, + *      http://www.apache.org/licenses/LICENSE-2.0, + *, + * Unless required by applicable law or agreed to in writing, software, + * distributed under the License is distributed on an "AS IS" BASIS,, + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied., + * See the License for the specific language governing permissions and, + * limitations under the License., + */, +, +package org.springframework.boot.actuate.metrics.opentsdb;, +, +import java.util.ArrayList;, +import java.util.Arrays;, +import java.util.List;, +import java.util.Map;, +, +import org.apache.commons.logging.Log;, +import org.apache.commons.logging.LogFactory;, +import org.springframework.boot.actuate.metrics.Metric;, +import org.springframework.boot.actuate.metrics.writer.Delta;, +import org.springframework.boot.actuate.metrics.writer.MetricWriter;, +import org.springframework.http.HttpEntity;, +import org.springframework.http.HttpHeaders;, +import org.springframework.http.MediaType;, +import org.springframework.http.ResponseEntity;, +import org.springframework.scheduling.annotation.Scheduled;, +import org.springframework.web.client.RestOperations;, +import org.springframework.web.client.RestTemplate;, +, +/**, + * A {@link MetricWriter} for the Open TSDB database (version 2.0), writing metrics to the, + * HTTP endpoint provided by the server. Data are buffered according to the, + * {@link #setBufferSize(int) bufferSize} property, and only flushed automatically when, + * the buffer size is reached. Users should either manually {@link #flush()} after writing, + * a batch of data if that makes sense, or consider adding a {@link Scheduled, + * <code>@Scheduled</code>} task to flush periodically., + *, + * @author Dave Syer, + */, +public class OpenTsdbMetricWriter implements MetricWriter {, +, +	private static final Log logger = LogFactory.getLog(OpenTsdbMetricWriter.class);, +, +	private RestOperations restTemplate = new RestTemplate();, +, +	/**, +	 * URL for POSTing data. Defaults to http://localhost:4242/api/put., +	 */, +	private String url = "http://localhost:4242/api/put";, +, +	/**, +	 * Buffer size to fill before posting data to server., +	 */, +	private int bufferSize = 64;, +, +	/**, +	 * The media type to use to serialize and accept responses from the server. Defaults, +	 * to "application/json"., +	 */, +	private MediaType mediaType = MediaType.APPLICATION_JSON;, +, +	private List<OpenTsdbData> buffer = new ArrayList<OpenTsdbData>(this.bufferSize);, +, +	private OpenTsdbNamingStrategy namingStrategy = new DefaultOpenTsdbNamingStrategy();, +, +	public RestOperations getRestTemplate() {, +		return this.restTemplate;, +	}, +, +	public void setRestTemplate(RestOperations restTemplate) {, +		this.restTemplate = restTemplate;, +	}]
[+++ b/spring-boot/src/main/java/org/springframework/boot/cloudfoundry/VcapApplicationListener.java, +			extractPropertiesFromApplication(properties, map);, +			extractPropertiesFromServices(properties, map);, +		}, +		catch (Exception ex) {, +			logger.error("Could not parse VCAP_SERVICES", ex);, +		}, +		return properties;, +	}, +, +	private void extractPropertiesFromApplication(Properties properties,, +			Map<String, Object> map) {, +		if (map != null) {, +			flatten(properties, map, "");, +		}, +	}, +, +	private void extractPropertiesFromServices(Properties properties,, +			Map<String, Object> map) {, +++ b/spring-boot/src/main/java/org/springframework/boot/cloudfoundry/VcapApplicationListener.java, +			extractPropertiesFromApplication(properties, map);, +			extractPropertiesFromServices(properties, map);, +		}, +		catch (Exception ex) {, +			logger.error("Could not parse VCAP_SERVICES", ex);, +		}, +		return properties;, +	}, +, +	private void extractPropertiesFromApplication(Properties properties,, +			Map<String, Object> map) {, +		if (map != null) {, +			flatten(properties, map, "");, +		}, +	}, +, +	private void extractPropertiesFromServices(Properties properties,, +			Map<String, Object> map) {, +++ b/spring-boot/src/test/java/org/springframework/boot/cloudfoundry/VcapApplicationListenerTests.java, +import static org.junit.Assert.assertEquals;, +import static org.junit.Assert.assertNull;, +, +	public void testApplicationUris() {, +		EnvironmentTestUtils, +				.addEnvironment(, +						this.context,, +						"VCAP_APPLICATION:{\"instance_id\":\"bb7935245adf3e650dfb7c58a06e9ece\",\"instance_index\":0,\"uris\":[\"foo.cfapps.io\"]}");, +		this.initializer.onApplicationEvent(this.event);, +		assertEquals("foo.cfapps.io",, +				this.context.getEnvironment().getProperty("vcap.application.uris[0]"));, +	}, +, +	@Test]
[+++ b/spring-boot-project/spring-boot-actuator/src/test/java/org/springframework/boot/actuate/metrics/web/client/MetricsRestTemplateCustomizerTests.java, +import org.junit.Before;, + * @author Brian Clozel, +	private MeterRegistry registry;, +, +	private RestTemplate restTemplate;, +, +	@Before, +	public void setup() {, +		this.registry = new SimpleMeterRegistry(SimpleConfig.DEFAULT, new MockClock());, +		this.restTemplate = new RestTemplate();, +	}, +, +				this.registry, new DefaultRestTemplateExchangeTagsProvider(),, +		customizer.customize(this.restTemplate);, +				.createServer(this.restTemplate);, +		String result = this.restTemplate.getForObject("/test/{id}", String.class, 123);, +		MockClock.clock(this.registry).add(SimpleConfig.DEFAULT_STEP);, +		assertThat(this.registry.find("http.client.requests"), +		assertThat(this.registry.find("http.client.requests"), +	@Test, +	public void avoidDuplicateRegistration() {, +		MetricsRestTemplateCustomizer customizer = new MetricsRestTemplateCustomizer(, +				this.registry, new DefaultRestTemplateExchangeTagsProvider(),, +				"http.client.requests", true);, +		customizer.customize(this.restTemplate);, +		assertThat(this.restTemplate.getInterceptors()).hasSize(1);, +		customizer.customize(this.restTemplate);, +		assertThat(this.restTemplate.getInterceptors()).hasSize(1);, +	}, +]
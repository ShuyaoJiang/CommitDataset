[+++ b/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/security/servlet/UserDetailsServiceAutoConfiguration.java, +import org.springframework.context.annotation.Lazy;, +	@Lazy, +++ b/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/security/servlet/UserDetailsServiceAutoConfiguration.java, +import org.springframework.context.annotation.Lazy;, +	@Lazy, +++ b/spring-boot-project/spring-boot-autoconfigure/src/test/java/org/springframework/boot/autoconfigure/security/servlet/UserDetailsServiceAutoConfigurationTests.java, +import org.springframework.security.config.annotation.authentication.builders.AuthenticationManagerBuilder;, +import org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter;, +	@Test, +	public void generatedPasswordShouldNotBePrintedIfAuthenticationManagerBuilderIsUsed() {, +		this.contextRunner, +				.withUserConfiguration(TestConfigWithAuthenticationManagerBuilder.class), +				.run(((context) -> assertThat(this.outputCapture.toString()), +						.doesNotContain("Using generated security password: ")));, +	}, +, +	@Configuration, +	@Import(TestSecurityConfiguration.class), +	protected static class TestConfigWithAuthenticationManagerBuilder {, +, +		@Bean, +		public WebSecurityConfigurerAdapter webSecurityConfigurerAdapter() {, +			return new WebSecurityConfigurerAdapter() {, +				@Override, +				protected void configure(AuthenticationManagerBuilder auth), +						throws Exception {, +					auth.inMemoryAuthentication().withUser("hero").password("{noop}hero"), +							.roles("HERO", "USER").and().withUser("user"), +							.password("{noop}user").roles("USER");, +				}, +			};, +		}, +, +	}, +]
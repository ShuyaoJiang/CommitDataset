[+++ b/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/security/AuthenticationAuditListener.java, + * Copyright 2012-2016 the original author or authors., +++ b/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/security/AuthenticationAuditListener.java, + * Copyright 2012-2016 the original author or authors., +++ b/spring-boot-actuator/src/test/java/org/springframework/boot/actuate/security/AuthenticationAuditListenerTests.java, + * Copyright 2012-2016 the original author or authors., +	public void testDetailsAreIncludedInAuditEvent() throws Exception {, +		Object details = new Object();, +		UsernamePasswordAuthenticationToken authentication = new UsernamePasswordAuthenticationToken(, +				"user", "password");, +		this.listener.onApplicationEvent(new AuthenticationFailureExpiredEvent(, +				authentication, new BadCredentialsException("Bad user")));, +		ArgumentCaptor<AuditApplicationEvent> auditApplicationEvent = ArgumentCaptor, +				.forClass(AuditApplicationEvent.class);, +		verify(this.publisher).publishEvent(auditApplicationEvent.capture());, +		assertThat(auditApplicationEvent.getValue().getAuditEvent().getData(),, +				hasEntry("details", details));]
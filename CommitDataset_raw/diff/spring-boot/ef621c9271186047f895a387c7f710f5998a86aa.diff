[+++ b/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/orm/jpa/HibernateJpaAutoConfiguration.java, +import org.apache.commons.logging.Log;, +import org.apache.commons.logging.LogFactory;, +import org.springframework.jndi.JndiLocatorDelegate;, +	private static final Log logger = LogFactory, +			.getLog(HibernateJpaAutoConfiguration.class);, +, +			try {, +			catch (NoClassDefFoundError ex) {, +				// Can happen if Hibernate 4.2 is used (for example on WAS), +				if (isUsingJndi()) {, +					// Assume that we are not using a stand-alone transaction manager, +					// and Hibernate will use JNDI, +					if (logger.isDebugEnabled()) {, +						logger.debug("Unable to set Hibernate JTA platform : ", +								+ ex.getMessage());, +					}, +				}, +				else {, +					throw new IllegalStateException("Unable to set Hibernate JTA ", +							+ "platform, are you using the correct ", +							+ "version of hibernate?", ex);, +				}, +			}, +		}, +	private boolean isUsingJndi() {, +		try {, +			return JndiLocatorDelegate.isDefaultJndiEnvironmentAvailable();, +		}, +		catch (Error ex) {, +			return false;, +		}, +	}, +]
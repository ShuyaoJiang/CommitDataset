[+++ b/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/orm/jpa/JpaBaseConfiguration.java, +import org.springframework.beans.factory.annotation.Autowired;, +import org.springframework.orm.jpa.persistenceunit.PersistenceUnitManager;, +	@Autowired(required = false), +	private PersistenceUnitManager persistenceUnitManager;, +, +		if (this.persistenceUnitManager != null) {, +			entityManagerFactoryBean, +					.setPersistenceUnitManager(this.persistenceUnitManager);, +		}, +++ b/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/orm/jpa/JpaBaseConfiguration.java, +import org.springframework.beans.factory.annotation.Autowired;, +import org.springframework.orm.jpa.persistenceunit.PersistenceUnitManager;, +	@Autowired(required = false), +	private PersistenceUnitManager persistenceUnitManager;, +, +		if (this.persistenceUnitManager != null) {, +			entityManagerFactoryBean, +					.setPersistenceUnitManager(this.persistenceUnitManager);, +		}, +++ b/spring-boot-autoconfigure/src/test/java/org/springframework/boot/autoconfigure/orm/jpa/AbstractJpaAutoConfigurationTests.java, +import java.lang.reflect.Field;, +import org.springframework.beans.factory.annotation.Autowired;, +import org.springframework.boot.autoconfigure.TestAutoConfigurationPackage;, +import org.springframework.orm.jpa.persistenceunit.DefaultPersistenceUnitManager;, +import org.springframework.orm.jpa.persistenceunit.PersistenceUnitManager;, +	@Test, +	public void customPersistenceUnitManager() throws Exception {, +		setupTestConfiguration(TestConfigurationWithCustomPersistenceUnitManager.class);, +		this.context.refresh();, +		LocalContainerEntityManagerFactoryBean entityManagerFactoryBean = this.context, +				.getBean(LocalContainerEntityManagerFactoryBean.class);, +		Field field = LocalContainerEntityManagerFactoryBean.class, +				.getDeclaredField("persistenceUnitManager");, +		field.setAccessible(true);, +		assertThat(field.get(entityManagerFactoryBean),, +				equalTo((Object) this.context.getBean(PersistenceUnitManager.class)));, +	}, +, +, +	@Configuration, +	@TestAutoConfigurationPackage(AbstractJpaAutoConfigurationTests.class), +	public static class TestConfigurationWithCustomPersistenceUnitManager {, +, +		@Autowired, +		private DataSource dataSource;, +, +		@Bean, +		public PersistenceUnitManager persistenceUnitManager() {, +			DefaultPersistenceUnitManager persistenceUnitManager = new DefaultPersistenceUnitManager();, +			persistenceUnitManager.setDefaultDataSource(this.dataSource);, +			persistenceUnitManager.setPackagesToScan(City.class.getPackage().getName());, +			return persistenceUnitManager;, +		}, +, +	}, +]
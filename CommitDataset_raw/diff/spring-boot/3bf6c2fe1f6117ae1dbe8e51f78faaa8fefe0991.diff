[+++ b/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/sendgrid/SendGridAutoConfiguration.java, +import org.springframework.boot.autoconfigure.condition.AnyNestedCondition;, +import org.springframework.context.annotation.Conditional;, +@Conditional(SendGridAutoConfiguration.SendGridPropertyCondition.class), +, +		SendGrid sendGrid;, +, +		if (this.properties.getApikey() != null) {, +			sendGrid = new SendGrid(this.properties.getApikey());, +		}, +		else {, +			sendGrid = new SendGrid(this.properties.getUsername(),, +		}, +, +, +	static class SendGridPropertyCondition extends AnyNestedCondition {, +, +		SendGridPropertyCondition() {, +			super(ConfigurationPhase.PARSE_CONFIGURATION);, +		}, +, +		@ConditionalOnProperty(prefix = "spring.sendgrid", value = "username"), +		private class SendGridUserProperty {, +		}, +, +		@ConditionalOnProperty(prefix = "spring.sendgrid", value = "apikey"), +		private class SendGridApiKeyProperty {, +		}, +	}, +++ b/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/sendgrid/SendGridAutoConfiguration.java, +import org.springframework.boot.autoconfigure.condition.AnyNestedCondition;, +import org.springframework.context.annotation.Conditional;, +@Conditional(SendGridAutoConfiguration.SendGridPropertyCondition.class), +, +		SendGrid sendGrid;, +, +		if (this.properties.getApikey() != null) {, +			sendGrid = new SendGrid(this.properties.getApikey());, +		}, +		else {, +			sendGrid = new SendGrid(this.properties.getUsername(),, +		}, +, +, +	static class SendGridPropertyCondition extends AnyNestedCondition {, +, +		SendGridPropertyCondition() {, +			super(ConfigurationPhase.PARSE_CONFIGURATION);, +		}, +, +		@ConditionalOnProperty(prefix = "spring.sendgrid", value = "username"), +		private class SendGridUserProperty {, +		}, +, +		@ConditionalOnProperty(prefix = "spring.sendgrid", value = "apikey"), +		private class SendGridApiKeyProperty {, +		}, +	}, +++ b/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/sendgrid/SendGridProperties.java, +	 * SendGrid api key., +	 */, +	private String apikey;, +, +	/**, +	public String getApikey() {, +		return this.apikey;, +	}, +, +	public void setApikey(final String apikey) {, +		this.apikey = apikey;, +	}, +, +++ b/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/sendgrid/SendGridAutoConfiguration.java, +import org.springframework.boot.autoconfigure.condition.AnyNestedCondition;, +import org.springframework.context.annotation.Conditional;, +@Conditional(SendGridAutoConfiguration.SendGridPropertyCondition.class), +, +		SendGrid sendGrid;, +, +		if (this.properties.getApikey() != null) {, +			sendGrid = new SendGrid(this.properties.getApikey());, +		}, +		else {, +			sendGrid = new SendGrid(this.properties.getUsername(),, +		}, +, +, +	static class SendGridPropertyCondition extends AnyNestedCondition {, +, +		SendGridPropertyCondition() {, +			super(ConfigurationPhase.PARSE_CONFIGURATION);, +		}, +, +		@ConditionalOnProperty(prefix = "spring.sendgrid", value = "username"), +		private class SendGridUserProperty {, +		}, +, +		@ConditionalOnProperty(prefix = "spring.sendgrid", value = "apikey"), +		private class SendGridApiKeyProperty {, +		}]
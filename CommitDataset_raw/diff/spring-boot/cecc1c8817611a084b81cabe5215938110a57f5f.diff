[+++ b/spring-boot-devtools/src/main/java/org/springframework/boot/devtools/env/DevToolsPropertyDefaultsPostProcessor.java, +import org.springframework.boot.bind.RelaxedPropertyResolver;, +import org.springframework.boot.devtools.restart.Restarter;, +import org.springframework.core.env.Environment;, +		if (isLocalApplication(environment) && canAddProperties(environment)) {, +	private boolean canAddProperties(Environment environment) {, +		return isRestarterInitialized() || isRemoteRestartEnabled(environment);, +	}, +, +	private boolean isRestarterInitialized() {, +		try {, +			Restarter restarter = Restarter.getInstance();, +			return (restarter != null && restarter.getInitialUrls() != null);, +		}, +		catch (Exception ex) {, +			return false;, +		}, +	}, +, +	private boolean isRemoteRestartEnabled(Environment environment) {, +		RelaxedPropertyResolver resolver = new RelaxedPropertyResolver(environment,, +				"spring.devtools.remote.");, +		return resolver.containsProperty("secret");, +	}, +, +++ b/spring-boot-devtools/src/main/java/org/springframework/boot/devtools/env/DevToolsPropertyDefaultsPostProcessor.java, +import org.springframework.boot.bind.RelaxedPropertyResolver;, +import org.springframework.boot.devtools.restart.Restarter;, +import org.springframework.core.env.Environment;, +		if (isLocalApplication(environment) && canAddProperties(environment)) {, +	private boolean canAddProperties(Environment environment) {, +		return isRestarterInitialized() || isRemoteRestartEnabled(environment);, +	}, +, +	private boolean isRestarterInitialized() {, +		try {, +			Restarter restarter = Restarter.getInstance();, +			return (restarter != null && restarter.getInitialUrls() != null);, +		}, +		catch (Exception ex) {, +			return false;, +		}, +	}, +, +	private boolean isRemoteRestartEnabled(Environment environment) {, +		RelaxedPropertyResolver resolver = new RelaxedPropertyResolver(environment,, +				"spring.devtools.remote.");, +		return resolver.containsProperty("secret");, +	}, +, +++ b/spring-boot-devtools/src/test/java/org/springframework/boot/devtools/env/DevToolPropertiesIntegrationTests.java, +import java.net.URL;, +import java.util.Collections;, +import org.junit.After;, +import org.junit.Before;, +import org.junit.Rule;, +import org.junit.Test;, +import org.junit.rules.ExpectedException;, +, +import org.springframework.beans.factory.NoSuchBeanDefinitionException;, +import org.springframework.boot.devtools.restart.RestartInitializer;, +import org.springframework.boot.devtools.restart.Restarter;, +	@Rule, +	public ExpectedException thrown = ExpectedException.none();, +, +	@Before, +	public void setup() {, +		Restarter.initialize(new String[] {}, false, new MockInitializer(), false);, +	}, +, +		Restarter.clearInstance();, +	@Test, +	public void postProcessWhenRestarterDisabledAndRemoteSecretNotSetShouldNotAddPropertySource(), +			throws Exception {, +		Restarter.clearInstance();, +		Restarter.disable();, +		SpringApplication application = new SpringApplication(, +				BeanConditionConfiguration.class);, +		application.setWebEnvironment(false);, +		this.context = application.run();, +		this.thrown.expect(NoSuchBeanDefinitionException.class);, +		this.context.getBean(MyBean.class);, +	}, +, +	@Test, +	public void postProcessWhenRestarterDisabledAndRemoteSecretSetShouldAddPropertySource(), +			throws Exception {, +		Restarter.clearInstance();, +		Restarter.disable();, +		SpringApplication application = new SpringApplication(, +				BeanConditionConfiguration.class);, +		application.setWebEnvironment(false);, +		application.setDefaultProperties(Collections.<String, Object>singletonMap(, +				"spring.devtools.remote.secret", "donttell"));, +		this.context = application.run();, +		this.context.getBean(MyBean.class);, +	}, +, +	static class MockInitializer implements RestartInitializer {, +]
[+++ b/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/BackgroundPreinitializer.java, +import java.util.concurrent.CountDownLatch;, +import org.springframework.boot.context.event.ApplicationFailedEvent;, +import org.springframework.boot.context.event.ApplicationReadyEvent;, +import org.springframework.boot.context.event.SpringApplicationEvent;, +		implements ApplicationListener<SpringApplicationEvent> {, +	private static final CountDownLatch preinitializationComplete = new CountDownLatch(1);, +, +	public void onApplicationEvent(SpringApplicationEvent event) {, +		if (event instanceof ApplicationEnvironmentPreparedEvent) {, +		if (event instanceof ApplicationReadyEvent, +				|| event instanceof ApplicationFailedEvent) {, +			try {, +				preinitializationComplete.await();, +			}, +			catch (InterruptedException ex) {, +				Thread.currentThread().interrupt();, +			}, +		}, +	}, +					preinitializationComplete.countDown();, +			preinitializationComplete.countDown();]
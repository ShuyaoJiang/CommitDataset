[+++ b/spring-boot/src/main/java/org/springframework/boot/context/embedded/AnnotationConfigEmbeddedWebApplicationContext.java, +++ b/spring-boot/src/main/java/org/springframework/boot/context/embedded/AnnotationConfigEmbeddedWebApplicationContext.java, +++ b/spring-boot/src/main/java/org/springframework/boot/context/embedded/EmbeddedWebApplicationContext.java, +import org.springframework.beans.BeansException;, +	public final void refresh() throws BeansException, IllegalStateException {, +		try {, +			super.refresh();, +		}, +		catch (RuntimeException e) {, +			stopAndReleaseEmbeddedServletContainer();, +			throw e;, +		}, +	}, +, +	@Override, +++ b/spring-boot/src/main/java/org/springframework/boot/context/embedded/AnnotationConfigEmbeddedWebApplicationContext.java, +++ b/spring-boot/src/main/java/org/springframework/boot/context/embedded/EmbeddedWebApplicationContext.java, +import org.springframework.beans.BeansException;, +	public final void refresh() throws BeansException, IllegalStateException {, +		try {, +			super.refresh();, +		}, +		catch (RuntimeException e) {, +			stopAndReleaseEmbeddedServletContainer();, +			throw e;, +		}, +	}, +, +	@Override, +++ b/spring-boot/src/main/java/org/springframework/boot/context/embedded/XmlEmbeddedWebApplicationContext.java]
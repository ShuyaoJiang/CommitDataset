[+++ b/spring-boot-autoconfigure/src/test/java/org/springframework/boot/autoconfigure/web/EmbeddedServletContainerAutoConfigurationTests.java, +import org.springframework.boot.context.embedded.ServletRegistrationBean;, +	public void contextAlreadyHasDispatcherServletAndRegistration() throws Exception {, +		this.context = new AnnotationConfigEmbeddedWebApplicationContext(, +				DispatcherServletWithRegistrationConfiguration.class,, +				EmbeddedContainerConfiguration.class,, +				EmbeddedServletContainerAutoConfiguration.class,, +				DispatcherServletAutoConfiguration.class);, +		verifyContext();, +		assertEquals(1, this.context.getBeanNamesForType(DispatcherServlet.class).length);, +	}, +, +	@Test, +	@Configuration, +	public static class DispatcherServletWithRegistrationConfiguration {, +, +		@Bean(name = DispatcherServletAutoConfiguration.DEFAULT_DISPATCHER_SERVLET_BEAN_NAME), +		public DispatcherServlet dispatcherServlet() {, +			return new DispatcherServlet();, +		}, +, +		@Bean, +		public ServletRegistrationBean dispatcherRegistration() {, +			return new ServletRegistrationBean(dispatcherServlet(), "/app/*");, +		}, +, +	}, +]
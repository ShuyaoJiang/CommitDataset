[+++ b/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/security/SecurityProperties.java, +, +			 * Use the 'Content-Security-Policy' header., +			 * Use the 'Content-Security-Policy-Report-Only' header., +, +		 * Security policy mode., +		public void setContentSecurityPolicyMode(, +				ContentSecurityPolicyMode contentSecurityPolicyMode) {, +++ b/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/security/SecurityProperties.java, +, +			 * Use the 'Content-Security-Policy' header., +			 * Use the 'Content-Security-Policy-Report-Only' header., +, +		 * Security policy mode., +		public void setContentSecurityPolicyMode(, +				ContentSecurityPolicyMode contentSecurityPolicyMode) {, +++ b/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/security/SpringBootWebSecurityConfiguration.java, +import org.springframework.boot.autoconfigure.security.SecurityProperties.Headers.ContentSecurityPolicyMode;, +			String policyDirectives = headers.getContentSecurityPolicy();, +			ContentSecurityPolicyMode mode = headers.getContentSecurityPolicyMode();, +			if (mode == ContentSecurityPolicyMode.DEFAULT) {, +				configurer.contentSecurityPolicy(policyDirectives);, +				configurer.contentSecurityPolicy(policyDirectives).reportOnly();, +++ b/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/security/SecurityProperties.java, +, +			 * Use the 'Content-Security-Policy' header., +			 * Use the 'Content-Security-Policy-Report-Only' header., +, +		 * Security policy mode., +		public void setContentSecurityPolicyMode(, +				ContentSecurityPolicyMode contentSecurityPolicyMode) {, +++ b/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/security/SpringBootWebSecurityConfiguration.java, +import org.springframework.boot.autoconfigure.security.SecurityProperties.Headers.ContentSecurityPolicyMode;, +			String policyDirectives = headers.getContentSecurityPolicy();, +			ContentSecurityPolicyMode mode = headers.getContentSecurityPolicyMode();, +			if (mode == ContentSecurityPolicyMode.DEFAULT) {, +				configurer.contentSecurityPolicy(policyDirectives);, +				configurer.contentSecurityPolicy(policyDirectives).reportOnly();, +++ b/spring-boot-autoconfigure/src/test/java/org/springframework/boot/autoconfigure/security/SpringBootWebSecurityConfigurationTests.java, +				.andExpect(MockMvcResultMatchers.header(), +						.doesNotExist("Content-Security-Policy"));, +				.andExpect(MockMvcResultMatchers.header(), +						.string("Content-Security-Policy", is("default-src 'self';"))), +				.andExpect(MockMvcResultMatchers.header(), +						.doesNotExist("Content-Security-Policy-Report-Only"));, +				.andExpect(MockMvcResultMatchers.header().string(, +						"Content-Security-Policy-Report-Only", is("default-src 'self';"))), +				.andExpect(MockMvcResultMatchers.header(), +						.doesNotExist("Content-Security-Policy"));]
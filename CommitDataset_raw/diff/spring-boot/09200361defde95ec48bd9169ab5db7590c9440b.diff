[+++ b/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/autoconfigure/EndpointMBeanExportAutoConfiguration.java, +import javax.management.MBeanServer;, +, +import org.springframework.boot.autoconfigure.jmx.JmxAutoConfiguration;, +@AutoConfigureAfter({ EndpointAutoConfiguration.class, JmxAutoConfiguration.class }), +	public EndpointMBeanExporter endpointMBeanExporter(MBeanServer server) {, +		mbeanExporter.setServer(server);, +++ b/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/autoconfigure/EndpointMBeanExportAutoConfiguration.java, +import javax.management.MBeanServer;, +, +import org.springframework.boot.autoconfigure.jmx.JmxAutoConfiguration;, +@AutoConfigureAfter({ EndpointAutoConfiguration.class, JmxAutoConfiguration.class }), +	public EndpointMBeanExporter endpointMBeanExporter(MBeanServer server) {, +		mbeanExporter.setServer(server);, +++ b/spring-boot-actuator/src/test/java/org/springframework/boot/actuate/autoconfigure/EndpointMBeanExportAutoConfigurationTests.java, +import org.springframework.boot.autoconfigure.jmx.JmxAutoConfiguration;, +		this.context.register(TestConfiguration.class, JmxAutoConfiguration.class,, +				EndpointAutoConfiguration.class,, +		this.context.register(JmxAutoConfiguration.class,, +				EndpointAutoConfiguration.class,, +		this.context.register(JmxAutoConfiguration.class,, +				EndpointAutoConfiguration.class,, +		this.context.register(JmxAutoConfiguration.class,, +				EndpointAutoConfiguration.class,, +		parent.register(JmxAutoConfiguration.class, EndpointAutoConfiguration.class,, +++ b/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/autoconfigure/EndpointMBeanExportAutoConfiguration.java, +import javax.management.MBeanServer;, +, +import org.springframework.boot.autoconfigure.jmx.JmxAutoConfiguration;, +@AutoConfigureAfter({ EndpointAutoConfiguration.class, JmxAutoConfiguration.class }), +	public EndpointMBeanExporter endpointMBeanExporter(MBeanServer server) {, +		mbeanExporter.setServer(server);, +++ b/spring-boot-actuator/src/test/java/org/springframework/boot/actuate/autoconfigure/EndpointMBeanExportAutoConfigurationTests.java, +import org.springframework.boot.autoconfigure.jmx.JmxAutoConfiguration;, +		this.context.register(TestConfiguration.class, JmxAutoConfiguration.class,, +				EndpointAutoConfiguration.class,, +		this.context.register(JmxAutoConfiguration.class,, +				EndpointAutoConfiguration.class,, +		this.context.register(JmxAutoConfiguration.class,, +				EndpointAutoConfiguration.class,, +		this.context.register(JmxAutoConfiguration.class,, +				EndpointAutoConfiguration.class,, +		parent.register(JmxAutoConfiguration.class, EndpointAutoConfiguration.class,, +++ b/spring-boot-autoconfigure/pom.xml, +			<groupId>org.springframework.integration</groupId>, +			<artifactId>spring-integration-jmx</artifactId>, +			<optional>true</optional>, +		</dependency>, +		<dependency>, +++ b/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/autoconfigure/EndpointMBeanExportAutoConfiguration.java, +import javax.management.MBeanServer;, +, +import org.springframework.boot.autoconfigure.jmx.JmxAutoConfiguration;, +@AutoConfigureAfter({ EndpointAutoConfiguration.class, JmxAutoConfiguration.class }), +	public EndpointMBeanExporter endpointMBeanExporter(MBeanServer server) {, +		mbeanExporter.setServer(server);, +++ b/spring-boot-actuator/src/test/java/org/springframework/boot/actuate/autoconfigure/EndpointMBeanExportAutoConfigurationTests.java, +import org.springframework.boot.autoconfigure.jmx.JmxAutoConfiguration;, +		this.context.register(TestConfiguration.class, JmxAutoConfiguration.class,, +				EndpointAutoConfiguration.class,, +		this.context.register(JmxAutoConfiguration.class,, +				EndpointAutoConfiguration.class,, +		this.context.register(JmxAutoConfiguration.class,, +				EndpointAutoConfiguration.class,, +		this.context.register(JmxAutoConfiguration.class,, +				EndpointAutoConfiguration.class,, +		parent.register(JmxAutoConfiguration.class, EndpointAutoConfiguration.class,, +++ b/spring-boot-autoconfigure/pom.xml, +			<groupId>org.springframework.integration</groupId>, +			<artifactId>spring-integration-jmx</artifactId>, +			<optional>true</optional>, +		</dependency>, +		<dependency>, +++ b/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/integration/IntegrationAutoConfiguration.java, +import org.springframework.boot.autoconfigure.AutoConfigureAfter;, +import org.springframework.boot.autoconfigure.condition.ConditionalOnExpression;, +import org.springframework.boot.autoconfigure.condition.ConditionalOnMissingBean;, +import org.springframework.boot.autoconfigure.jmx.JmxAutoConfiguration;, +import org.springframework.integration.jmx.config.EnableIntegrationMBeanExport;, +import org.springframework.integration.jmx.config.IntegrationMBeanExportConfiguration;, + * @author Dave Syer, +@AutoConfigureAfter(JmxAutoConfiguration.class), +	@Configuration, +	@ConditionalOnClass(EnableIntegrationMBeanExport.class), +	@ConditionalOnMissingBean(IntegrationMBeanExportConfiguration.class), +	@ConditionalOnExpression("${spring.jmx.enabled:true}"), +	@EnableIntegrationMBeanExport(defaultDomain = "${spring.jmx.default_domain:}", server = "${spring.jmx.server:mbeanServer}"), +	protected static class IntegrationJmxConfiguration {, +	}, +, +++ b/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/autoconfigure/EndpointMBeanExportAutoConfiguration.java, +import javax.management.MBeanServer;, +, +import org.springframework.boot.autoconfigure.jmx.JmxAutoConfiguration;, +@AutoConfigureAfter({ EndpointAutoConfiguration.class, JmxAutoConfiguration.class }), +	public EndpointMBeanExporter endpointMBeanExporter(MBeanServer server) {, +		mbeanExporter.setServer(server);, +++ b/spring-boot-actuator/src/test/java/org/springframework/boot/actuate/autoconfigure/EndpointMBeanExportAutoConfigurationTests.java, +import org.springframework.boot.autoconfigure.jmx.JmxAutoConfiguration;, +		this.context.register(TestConfiguration.class, JmxAutoConfiguration.class,]
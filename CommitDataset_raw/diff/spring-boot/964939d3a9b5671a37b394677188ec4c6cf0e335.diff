[+++ b/spring-boot-project/spring-boot-test-autoconfigure/src/main/java/org/springframework/boot/test/autoconfigure/restdocs/RestDocsWebTestClientBuilderCustomizer.java, + * Copyright 2012-2018 the original author or authors., + * A {@WebTestClientBuilderCustomizer} that configures Spring REST Docs., + * @author Andy Wilkinson, +class RestDocsWebTestClientBuilderCustomizer implements WebTestClientBuilderCustomizer {, +	RestDocsWebTestClientBuilderCustomizer(, +			WebTestClientRestDocumentationConfigurer delegate) {, +		customizeBaseUrl(builder);, +, +	private void customizeBaseUrl(WebTestClient.Builder builder) {, +		String scheme = StringUtils.hasText(this.uriScheme) ? this.uriScheme : "http";, +		String host = StringUtils.hasText(this.uriHost) ? this.uriHost : "localhost";, +		String baseUrl = scheme + "://" + host;, +		if (!isStandardPort()) {, +			baseUrl += ":" + this.uriPort;, +		}, +		builder.baseUrl(baseUrl);, +	}, +, +	private boolean isStandardPort() {, +		if (this.uriPort == null) {, +			return true;, +		}, +		return this.uriScheme.equals("http") && this.uriPort == 80, +				|| this.uriScheme.equals("https") && this.uriPort.equals(443);, +	}, +, +++ b/spring-boot-project/spring-boot-test-autoconfigure/src/main/java/org/springframework/boot/test/autoconfigure/restdocs/RestDocsWebTestClientBuilderCustomizer.java, + * Copyright 2012-2018 the original author or authors., + * A {@WebTestClientBuilderCustomizer} that configures Spring REST Docs., + * @author Andy Wilkinson, +class RestDocsWebTestClientBuilderCustomizer implements WebTestClientBuilderCustomizer {, +	RestDocsWebTestClientBuilderCustomizer(, +			WebTestClientRestDocumentationConfigurer delegate) {, +		customizeBaseUrl(builder);, +, +	private void customizeBaseUrl(WebTestClient.Builder builder) {, +		String scheme = StringUtils.hasText(this.uriScheme) ? this.uriScheme : "http";, +		String host = StringUtils.hasText(this.uriHost) ? this.uriHost : "localhost";, +		String baseUrl = scheme + "://" + host;, +		if (!isStandardPort()) {, +			baseUrl += ":" + this.uriPort;, +		}, +		builder.baseUrl(baseUrl);, +	}, +, +	private boolean isStandardPort() {, +		if (this.uriPort == null) {, +			return true;, +		}, +		return this.uriScheme.equals("http") && this.uriPort == 80, +				|| this.uriScheme.equals("https") && this.uriPort.equals(443);, +	}, +, +++ b/spring-boot-project/spring-boot-test-autoconfigure/src/main/java/org/springframework/boot/test/autoconfigure/restdocs/RestDocsWebTestClientConfigurationCustomizer.java, + * Copyright 2012-2018 the original author or authors., + * {@code RestDocsWebTestClientConfigurationCustomizer} bean is found in the application, + * context it will be {@link #customize called} to customize the, + * {@code WebTestClientRestDocumentationConfigurer} before it is applied. Intended for use, + * only when the attributes on {@link AutoConfigureRestDocs} do not provide sufficient, +++ b/spring-boot-project/spring-boot-test-autoconfigure/src/main/java/org/springframework/boot/test/autoconfigure/restdocs/RestDocsWebTestClientBuilderCustomizer.java, + * Copyright 2012-2018 the original author or authors., + * A {@WebTestClientBuilderCustomizer} that configures Spring REST Docs., + * @author Andy Wilkinson, +class RestDocsWebTestClientBuilderCustomizer implements WebTestClientBuilderCustomizer {, +	RestDocsWebTestClientBuilderCustomizer(, +			WebTestClientRestDocumentationConfigurer delegate) {, +		customizeBaseUrl(builder);, +, +	private void customizeBaseUrl(WebTestClient.Builder builder) {, +		String scheme = StringUtils.hasText(this.uriScheme) ? this.uriScheme : "http";, +		String host = StringUtils.hasText(this.uriHost) ? this.uriHost : "localhost";, +		String baseUrl = scheme + "://" + host;, +		if (!isStandardPort()) {, +			baseUrl += ":" + this.uriPort;, +		}, +		builder.baseUrl(baseUrl);, +	}, +, +	private boolean isStandardPort() {, +		if (this.uriPort == null) {, +			return true;, +		}, +		return this.uriScheme.equals("http") && this.uriPort == 80, +				|| this.uriScheme.equals("https") && this.uriPort.equals(443);, +	}, +, +++ b/spring-boot-project/spring-boot-test-autoconfigure/src/main/java/org/springframework/boot/test/autoconfigure/restdocs/RestDocsWebTestClientConfigurationCustomizer.java, + * Copyright 2012-2018 the original author or authors., + * {@code RestDocsWebTestClientConfigurationCustomizer} bean is found in the application, + * context it will be {@link #customize called} to customize the, + * {@code WebTestClientRestDocumentationConfigurer} before it is applied. Intended for use, + * only when the attributes on {@link AutoConfigureRestDocs} do not provide sufficient, +++ b/spring-boot-project/spring-boot-test-autoconfigure/src/test/java/org/springframework/boot/test/autoconfigure/restdocs/WebTestClientRestDocsAutoConfigurationIntegrationTests.java, + * Copyright 2012-2018 the original author or authors., + * Integration tests for {@link RestDocsAutoConfiguration} with {@link WebTestClient}., +		this.webTestClient.get().uri("/").exchange().expectBody(), +				.consumeWith(document("default-snippets"));]
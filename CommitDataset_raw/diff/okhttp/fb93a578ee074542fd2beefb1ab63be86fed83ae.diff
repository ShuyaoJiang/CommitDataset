[+++ b/okhttp-tests/src/test/java/com/squareup/okhttp/MediaTypeTest.java, +  @Test public void testDuplicatedCharsets() {, +    MediaType mediaType = MediaType.parse("text/plain; charset=utf-8; charset=UTF-8");, +    assertEquals("UTF-8", mediaType.charset().name());, +  }, +, +++ b/okhttp-tests/src/test/java/com/squareup/okhttp/MediaTypeTest.java, +  @Test public void testDuplicatedCharsets() {, +    MediaType mediaType = MediaType.parse("text/plain; charset=utf-8; charset=UTF-8");, +    assertEquals("UTF-8", mediaType.charset().name());, +  }, +, +++ b/okhttp-tests/src/test/java/com/squareup/okhttp/internal/http/URLConnectionTest.java, +++ b/okhttp-tests/src/test/java/com/squareup/okhttp/MediaTypeTest.java, +  @Test public void testDuplicatedCharsets() {, +    MediaType mediaType = MediaType.parse("text/plain; charset=utf-8; charset=UTF-8");, +    assertEquals("UTF-8", mediaType.charset().name());, +  }, +, +++ b/okhttp-tests/src/test/java/com/squareup/okhttp/internal/http/URLConnectionTest.java, +++ b/okhttp/src/main/java/com/squareup/okhttp/MediaType.java, +      String charsetParameter = parameter.group(2) != null, +      if (charset != null && !charsetParameter.equalsIgnoreCase(charset)) {, +        throw new IllegalArgumentException("Multiple different charsets: " + string);, +      }, +      charset = charsetParameter;]
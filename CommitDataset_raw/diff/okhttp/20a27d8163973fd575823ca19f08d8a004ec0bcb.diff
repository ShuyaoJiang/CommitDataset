[+++ b/okhttp-tests/src/test/java/com/squareup/okhttp/internal/spdy/Spdy3ConnectionTest.java, +import java.util.concurrent.CountDownLatch;, +import okio.AsyncTimeout;, +    awaitWatchdogIdle();, +    awaitWatchdogIdle();, +    awaitWatchdogIdle();, +  /**, +   * Returns true when all work currently in progress by the watchdog have completed. This method, +   * creates more work for the watchdog and waits for that work to be executed. When it is, we know, +   * work that preceded this call is complete., +   */, +  private void awaitWatchdogIdle() throws InterruptedException {, +    final CountDownLatch latch = new CountDownLatch(1);, +    AsyncTimeout watchdogJob = new AsyncTimeout() {, +      @Override protected void timedOut() {, +        latch.countDown();, +      }, +    };, +    watchdogJob.deadlineNanoTime(System.nanoTime()); // Due immediately!, +    watchdogJob.enter();, +    latch.await();, +  }, +]
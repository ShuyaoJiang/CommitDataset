[+++ b/okhttp/src/main/java/com/squareup/okhttp/Response.java, +import okio.Buffer;, +      // TODO once https://github.com/square/okio/pull/41 is released., +      // byte[] bytes = source.readByteArray();, +      // if (contentLength != -1 && contentLength != bytes.length) {, +      //   throw new IOException("Content-Length and stream length disagree");, +      // }, +      // return bytes;, +      Buffer buffer = new Buffer();, +      long contentRead = buffer.writeAll(source());, +      if (contentLength != -1 && contentLength != contentRead) {, +        throw new IOException("Content-Length and stream length disagree");, +, +      return buffer.readByteArray(buffer.size());, +++ b/okhttp/src/main/java/com/squareup/okhttp/Response.java, +import okio.Buffer;, +      // TODO once https://github.com/square/okio/pull/41 is released., +      // byte[] bytes = source.readByteArray();, +      // if (contentLength != -1 && contentLength != bytes.length) {, +      //   throw new IOException("Content-Length and stream length disagree");, +      // }, +      // return bytes;, +      Buffer buffer = new Buffer();, +      long contentRead = buffer.writeAll(source());, +      if (contentLength != -1 && contentLength != contentRead) {, +        throw new IOException("Content-Length and stream length disagree");, +, +      return buffer.readByteArray(buffer.size());, +++ b/okhttp/src/main/java/com/squareup/okhttp/internal/Util.java, +    result.writeAll(source);]
[+++ b/mockwebserver/src/main/java/com/squareup/okhttp/mockwebserver/MockWebServer.java, +  private InetSocketAddress inetSocketAddress;, +    if (inetSocketAddress == null) {, +      throw new IllegalStateException("Call start() before getHostName()");, +    }, +    return inetSocketAddress.getHostName();, +    if (inetSocketAddress == null) {, +    InetSocketAddress address = new InetSocketAddress(inetSocketAddress.getAddress(), getPort());, +    return new Proxy(Proxy.Type.HTTP, address);, +   * Starts the server on the loopback interface for the given port., +    start(InetAddress.getByName("localhost"), port);, +  }, +, +  /**, +   * Starts the server on the given address and port., +   *, +   * @param inetAddress the address to create the server socket on, +   *, +   * @param port the port to listen to, or 0 for any available port. Automated, +   *     tests should always use port 0 to avoid flakiness when a specific port, +   *     is unavailable., +   */, +  public void start(InetAddress inetAddress, int port) throws IOException {, +    start(new InetSocketAddress(inetAddress, port));, +  }, +, +  /**, +   * Starts the server and binds to the given socket address., +   *, +   * @param inetSocketAddress the socket address to bind the server on, +   */, +  private void start(InetSocketAddress inetSocketAddress) throws IOException {, +    this.inetSocketAddress = inetSocketAddress;, +    // Reuse if the user specified a port, +    serverSocket.setReuseAddress(inetSocketAddress.getPort() != 0);, +    serverSocket.bind(inetSocketAddress, 50);, +    port = serverSocket.getLocalPort();, +    executor.execute(new NamedRunnable("MockWebServer %s", port) {, +++ b/mockwebserver/src/main/java/com/squareup/okhttp/mockwebserver/MockWebServer.java, +  private InetSocketAddress inetSocketAddress;, +    if (inetSocketAddress == null) {, +      throw new IllegalStateException("Call start() before getHostName()");, +    }, +    return inetSocketAddress.getHostName();, +    if (inetSocketAddress == null) {, +    InetSocketAddress address = new InetSocketAddress(inetSocketAddress.getAddress(), getPort());, +    return new Proxy(Proxy.Type.HTTP, address);, +   * Starts the server on the loopback interface for the given port., +    start(InetAddress.getByName("localhost"), port);, +  }, +, +  /**, +   * Starts the server on the given address and port., +   *, +   * @param inetAddress the address to create the server socket on, +   *, +   * @param port the port to listen to, or 0 for any available port. Automated, +   *     tests should always use port 0 to avoid flakiness when a specific port, +   *     is unavailable., +   */, +  public void start(InetAddress inetAddress, int port) throws IOException {, +    start(new InetSocketAddress(inetAddress, port));, +  }, +, +  /**, +   * Starts the server and binds to the given socket address., +   *, +   * @param inetSocketAddress the socket address to bind the server on, +   */, +  private void start(InetSocketAddress inetSocketAddress) throws IOException {, +    this.inetSocketAddress = inetSocketAddress;, +    // Reuse if the user specified a port, +    serverSocket.setReuseAddress(inetSocketAddress.getPort() != 0);, +    serverSocket.bind(inetSocketAddress, 50);, +    port = serverSocket.getLocalPort();, +    executor.execute(new NamedRunnable("MockWebServer %s", port) {, +++ b/mockwebserver/src/main/java/com/squareup/okhttp/mockwebserver/SocketPolicy.java, +/** What should be done with the incoming socket. */, +   * Don't response to the request but keep the socket open. For testing, +++ b/mockwebserver/src/main/java/com/squareup/okhttp/mockwebserver/MockWebServer.java, +  private InetSocketAddress inetSocketAddress;, +    if (inetSocketAddress == null) {, +      throw new IllegalStateException("Call start() before getHostName()");, +    }, +    return inetSocketAddress.getHostName();, +    if (inetSocketAddress == null) {, +    InetSocketAddress address = new InetSocketAddress(inetSocketAddress.getAddress(), getPort());, +    return new Proxy(Proxy.Type.HTTP, address);, +   * Starts the server on the loopback interface for the given port., +    start(InetAddress.getByName("localhost"), port);, +  }, +, +  /**, +   * Starts the server on the given address and port., +   *, +   * @param inetAddress the address to create the server socket on, +   *, +   * @param port the port to listen to, or 0 for any available port. Automated, +   *     tests should always use port 0 to avoid flakiness when a specific port, +   *     is unavailable.]
[+++ b/okhttp/src/main/java/okhttp3/internal/platform/AndroidPlatform.java, +import java.security.Security;, +  /**, +   * Checks to see if Google Play Services Dynamic Security Provider is present which provides ALPN, +   * support. If it isn't checks to see if device is Android 5.0+ since 4.x device have broken, +   * ALPN support., +   */, +  private static boolean supportsAlpn() {, +    if (Security.getProvider("GMSCore_OpenSSL") != null) {, +      return true;, +    } else {, +      try {, +        Class.forName("android.net.Network"); // Arbitrary class added in Android 5.0., +        return true;, +      } catch (ClassNotFoundException ignored) { }, +    }, +    return false;, +  }, +, +      if (supportsAlpn()) {, +        getAlpnSelectedProtocol, +            = new OptionalMethod<>(byte[].class, "getAlpnSelectedProtocol");, +        setAlpnProtocols, +            = new OptionalMethod<>(null, "setAlpnProtocols", byte[].class);]
[+++ b/mockwebserver/src/main/java/okhttp3/internal/tls/SslClient.java, +          .commonName(InetAddress.getByName("localhost").getCanonicalHostName()), +++ b/mockwebserver/src/main/java/okhttp3/internal/tls/SslClient.java, +          .commonName(InetAddress.getByName("localhost").getCanonicalHostName()), +++ b/mockwebserver/src/main/java/okhttp3/mockwebserver/MockWebServer.java, +    return inetSocketAddress.getAddress().getCanonicalHostName();, +    InetSocketAddress address = new InetSocketAddress(inetSocketAddress.getAddress(), +            .getCanonicalHostName(), getPort());, +++ b/mockwebserver/src/main/java/okhttp3/internal/tls/SslClient.java, +          .commonName(InetAddress.getByName("localhost").getCanonicalHostName()), +++ b/mockwebserver/src/main/java/okhttp3/mockwebserver/MockWebServer.java, +    return inetSocketAddress.getAddress().getCanonicalHostName();, +    InetSocketAddress address = new InetSocketAddress(inetSocketAddress.getAddress(), +            .getCanonicalHostName(), getPort());, +++ b/mockwebserver/src/test/java/okhttp3/mockwebserver/MockWebServerTest.java, +import java.net.InetAddress;, +++ b/mockwebserver/src/main/java/okhttp3/internal/tls/SslClient.java, +          .commonName(InetAddress.getByName("localhost").getCanonicalHostName()), +++ b/mockwebserver/src/main/java/okhttp3/mockwebserver/MockWebServer.java, +    return inetSocketAddress.getAddress().getCanonicalHostName();, +    InetSocketAddress address = new InetSocketAddress(inetSocketAddress.getAddress(), +            .getCanonicalHostName(), getPort());, +++ b/mockwebserver/src/test/java/okhttp3/mockwebserver/MockWebServerTest.java, +import java.net.InetAddress;, +++ b/okhttp-tests/src/test/java/okhttp3/EventListenerTest.java, +    assertEquals(server.getHostName(), dnsStart.domainName);, +    assertEquals(server.getHostName(), dnsEnd.domainName);, +++ b/mockwebserver/src/main/java/okhttp3/internal/tls/SslClient.java, +          .commonName(InetAddress.getByName("localhost").getCanonicalHostName()), +++ b/mockwebserver/src/main/java/okhttp3/mockwebserver/MockWebServer.java, +    return inetSocketAddress.getAddress().getCanonicalHostName();, +    InetSocketAddress address = new InetSocketAddress(inetSocketAddress.getAddress(), +            .getCanonicalHostName(), getPort());, +++ b/mockwebserver/src/test/java/okhttp3/mockwebserver/MockWebServerTest.java, +import java.net.InetAddress;, +++ b/okhttp-tests/src/test/java/okhttp3/EventListenerTest.java, +    assertEquals(server.getHostName(), dnsStart.domainName);, +    assertEquals(server.getHostName(), dnsEnd.domainName);, +++ b/okhttp-tests/src/test/java/okhttp3/internal/tls/ClientAuthTest.java, +    assertEquals(new X500Principal("CN=" + server.getHostName()), response.handshake().peerPrincipal());, +    assertEquals(new X500Principal("CN=" + server.getHostName()), response.handshake().peerPrincipal());, +    assertEquals(new X500Principal("CN=" + server.getHostName()), response.handshake().peerPrincipal());, +    assertEquals(new X500Principal("CN=" + server.getHostName()), response.handshake().peerPrincipal());]
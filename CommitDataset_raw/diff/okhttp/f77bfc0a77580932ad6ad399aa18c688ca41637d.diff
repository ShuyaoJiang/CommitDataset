[+++ b/okhttp-tests/src/test/java/com/squareup/okhttp/internal/spdy/HpackDraft05Test.java, +import java.util.Arrays;, +   * Variable-length quantity special cases strings which are longer than 127, +   * bytes.  Values such as cookies can be 4KiB, and should be possible to send., +   *, +   * <p> http://tools.ietf.org/html/draft-ietf-httpbis-header-compression-05#section-4.1.2, +   */, +  @Test public void largeHeaderValue() throws IOException {, +    char[] value = new char[4096];, +    Arrays.fill(value, '!');, +    List<Header> headerBlock = headerEntries("cookie", new String(value));, +, +    hpackWriter.writeHeaders(headerBlock);, +    bytesIn.write(bytesOut, bytesOut.size());, +    hpackReader.readHeaders();, +    hpackReader.emitReferenceSet();, +, +    assertEquals(0, hpackReader.headerCount);, +, +    assertEquals(headerBlock, hpackReader.getAndReset());, +  }, +, +  /**, +++ b/okhttp-tests/src/test/java/com/squareup/okhttp/internal/spdy/HpackDraft05Test.java, +import java.util.Arrays;, +   * Variable-length quantity special cases strings which are longer than 127, +   * bytes.  Values such as cookies can be 4KiB, and should be possible to send., +   *, +   * <p> http://tools.ietf.org/html/draft-ietf-httpbis-header-compression-05#section-4.1.2, +   */, +  @Test public void largeHeaderValue() throws IOException {, +    char[] value = new char[4096];, +    Arrays.fill(value, '!');, +    List<Header> headerBlock = headerEntries("cookie", new String(value));, +, +    hpackWriter.writeHeaders(headerBlock);, +    bytesIn.write(bytesOut, bytesOut.size());, +    hpackReader.readHeaders();, +    hpackReader.emitReferenceSet();, +, +    assertEquals(0, hpackReader.headerCount);, +, +    assertEquals(headerBlock, hpackReader.getAndReset());, +  }, +, +  /**, +++ b/okhttp/src/main/java/com/squareup/okhttp/internal/DiskLruCache.java, +      BufferedSink writer = null;, +      try {, +        writer = Okio.buffer(Okio.sink(newOutputStream(index)));, +      } finally {, +        Util.closeQuietly(writer);, +      }, +++ b/okhttp-tests/src/test/java/com/squareup/okhttp/internal/spdy/HpackDraft05Test.java, +import java.util.Arrays;, +   * Variable-length quantity special cases strings which are longer than 127, +   * bytes.  Values such as cookies can be 4KiB, and should be possible to send., +   *, +   * <p> http://tools.ietf.org/html/draft-ietf-httpbis-header-compression-05#section-4.1.2, +   */, +  @Test public void largeHeaderValue() throws IOException {, +    char[] value = new char[4096];, +    Arrays.fill(value, '!');, +    List<Header> headerBlock = headerEntries("cookie", new String(value));, +, +    hpackWriter.writeHeaders(headerBlock);, +    bytesIn.write(bytesOut, bytesOut.size());, +    hpackReader.readHeaders();, +    hpackReader.emitReferenceSet();, +, +    assertEquals(0, hpackReader.headerCount);, +, +    assertEquals(headerBlock, hpackReader.getAndReset());, +  }, +, +  /**, +++ b/okhttp/src/main/java/com/squareup/okhttp/internal/DiskLruCache.java, +      BufferedSink writer = null;, +      try {, +        writer = Okio.buffer(Okio.sink(newOutputStream(index)));, +      } finally {, +        Util.closeQuietly(writer);, +      }, +++ b/okhttp/src/main/java/com/squareup/okhttp/internal/Util.java, +import okio.Sink;, +   * Closes {@code source}, ignoring any checked exceptions. Does nothing if, +   * {@code source} is null., +   */, +  public static void closeQuietly(Source source) {, +    if (source != null) {, +      try {, +        source.close();, +      } catch (RuntimeException rethrown) {, +        throw rethrown;, +      } catch (Exception ignored) {, +      }, +    }, +  }, +, +  /**]
[+++ b/okhttp-tests/src/test/java/com/squareup/okhttp/internal/spdy/Http2ConnectionTest.java, +    int windowSize = 100;, +    int windowUpdateThreshold = 50;, +      // Send frames of summing to size 50, which is windowUpdateThreshold., +      peer.sendFrame().data(false, 3, data(24));, +      peer.sendFrame().data(false, 3, data(25));, +      peer.sendFrame().data(false, 3, data(1));, +    connection.okHttpSettings.set(Settings.INITIAL_WINDOW_SIZE, 0, windowSize);, +    buffer.writeAll(in);, +    assertEquals(150, buffer.size());, +++ b/okhttp-tests/src/test/java/com/squareup/okhttp/internal/spdy/Http2ConnectionTest.java, +    int windowSize = 100;, +    int windowUpdateThreshold = 50;, +      // Send frames of summing to size 50, which is windowUpdateThreshold., +      peer.sendFrame().data(false, 3, data(24));, +      peer.sendFrame().data(false, 3, data(25));, +      peer.sendFrame().data(false, 3, data(1));, +    connection.okHttpSettings.set(Settings.INITIAL_WINDOW_SIZE, 0, windowSize);, +    buffer.writeAll(in);, +    assertEquals(150, buffer.size());, +++ b/okhttp-tests/src/test/java/com/squareup/okhttp/internal/spdy/Spdy3ConnectionTest.java, +    int windowSize = 100;, +    int windowUpdateThreshold = 50;, +      // Send frames of summing to size 50, which is windowUpdateThreshold., +      peer.sendFrame().data(false, 1, data(24));, +      peer.sendFrame().data(false, 1, data(25));, +      peer.sendFrame().data(false, 1, data(1));, +    connection.okHttpSettings.set(Settings.INITIAL_WINDOW_SIZE, 0, windowSize);, +    buffer.writeAll(in);, +    assertEquals(150, buffer.size());, +++ b/okhttp-tests/src/test/java/com/squareup/okhttp/internal/spdy/Http2ConnectionTest.java, +    int windowSize = 100;, +    int windowUpdateThreshold = 50;, +      // Send frames of summing to size 50, which is windowUpdateThreshold., +      peer.sendFrame().data(false, 3, data(24));, +      peer.sendFrame().data(false, 3, data(25));, +      peer.sendFrame().data(false, 3, data(1));, +    connection.okHttpSettings.set(Settings.INITIAL_WINDOW_SIZE, 0, windowSize);, +    buffer.writeAll(in);, +    assertEquals(150, buffer.size());, +++ b/okhttp-tests/src/test/java/com/squareup/okhttp/internal/spdy/Spdy3ConnectionTest.java, +    int windowSize = 100;, +    int windowUpdateThreshold = 50;, +      // Send frames of summing to size 50, which is windowUpdateThreshold., +      peer.sendFrame().data(false, 1, data(24));, +      peer.sendFrame().data(false, 1, data(25));, +      peer.sendFrame().data(false, 1, data(1));, +    connection.okHttpSettings.set(Settings.INITIAL_WINDOW_SIZE, 0, windowSize);, +    buffer.writeAll(in);, +    assertEquals(150, buffer.size());, +++ b/okhttp/src/main/java/com/squareup/okhttp/internal/http/HttpEngine.java, +            .message("Gateway Timeout"), +++ b/okhttp-tests/src/test/java/com/squareup/okhttp/internal/spdy/Http2ConnectionTest.java, +    int windowSize = 100;, +    int windowUpdateThreshold = 50;, +      // Send frames of summing to size 50, which is windowUpdateThreshold., +      peer.sendFrame().data(false, 3, data(24));, +      peer.sendFrame().data(false, 3, data(25));, +      peer.sendFrame().data(false, 3, data(1));, +    connection.okHttpSettings.set(Settings.INITIAL_WINDOW_SIZE, 0, windowSize);, +    buffer.writeAll(in);, +    assertEquals(150, buffer.size());, +++ b/okhttp-tests/src/test/java/com/squareup/okhttp/internal/spdy/Spdy3ConnectionTest.java, +    int windowSize = 100;, +    int windowUpdateThreshold = 50;, +      // Send frames of summing to size 50, which is windowUpdateThreshold., +      peer.sendFrame().data(false, 1, data(24));, +      peer.sendFrame().data(false, 1, data(25));, +      peer.sendFrame().data(false, 1, data(1));, +    connection.okHttpSettings.set(Settings.INITIAL_WINDOW_SIZE, 0, windowSize);, +    buffer.writeAll(in);, +    assertEquals(150, buffer.size());, +++ b/okhttp/src/main/java/com/squareup/okhttp/internal/http/HttpEngine.java, +            .message("Gateway Timeout"), +++ b/okhttp/src/main/java/com/squareup/okhttp/internal/spdy/SpdyConnection.java, +  private static final int OKHTTP_CLIENT_WINDOW_SIZE = 16 * 1024 * 1024;, +      okHttpSettings.set(Settings.INITIAL_WINDOW_SIZE, 0, OKHTTP_CLIENT_WINDOW_SIZE);, +    int windowSize = okHttpSettings.getInitialWindowSize(Settings.DEFAULT_INITIAL_WINDOW_SIZE);, +    if (windowSize != Settings.DEFAULT_INITIAL_WINDOW_SIZE) {, +      frameWriter.windowUpdate(0, windowSize - Settings.DEFAULT_INITIAL_WINDOW_SIZE);, +    }, +++ b/okhttp-tests/src/test/java/com/squareup/okhttp/internal/spdy/Http2ConnectionTest.java, +    int windowSize = 100;, +    int windowUpdateThreshold = 50;, +      // Send frames of summing to size 50, which is windowUpdateThreshold., +      peer.sendFrame().data(false, 3, data(24));, +      peer.sendFrame().data(false, 3, data(25));, +      peer.sendFrame().data(false, 3, data(1));, +    connection.okHttpSettings.set(Settings.INITIAL_WINDOW_SIZE, 0, windowSize);, +    buffer.writeAll(in);, +    assertEquals(150, buffer.size());, +++ b/okhttp-tests/src/test/java/com/squareup/okhttp/internal/spdy/Spdy3ConnectionTest.java, +    int windowSize = 100;, +    int windowUpdateThreshold = 50;, +      // Send frames of summing to size 50, which is windowUpdateThreshold., +      peer.sendFrame().data(false, 1, data(24));, +      peer.sendFrame().data(false, 1, data(25));, +      peer.sendFrame().data(false, 1, data(1));, +    connection.okHttpSettings.set(Settings.INITIAL_WINDOW_SIZE, 0, windowSize);, +    buffer.writeAll(in);]
[+++ b/okhttp/src/main/java/com/squareup/okhttp/Headers.java, +++ b/okhttp/src/main/java/com/squareup/okhttp/Headers.java, +++ b/okhttp/src/main/java/com/squareup/okhttp/HttpResponseCache.java, +      this.varyHeaders = OkHeaders.varyHeaders(response);, +++ b/okhttp/src/main/java/com/squareup/okhttp/Headers.java, +++ b/okhttp/src/main/java/com/squareup/okhttp/HttpResponseCache.java, +      this.varyHeaders = OkHeaders.varyHeaders(response);, +++ b/okhttp/src/main/java/com/squareup/okhttp/internal/http/OkHeaders.java, +  private static Set<String> varyFields(Response response) {, +, +  /**, +   * Returns the subset of the headers in {@code response}'s request that, +   * impact the content of response's body., +   */, +  public static Headers varyHeaders(Response response) {, +    Set<String> varyFields = varyFields(response);, +    if (varyFields.isEmpty()) return new Headers.Builder().build();, +, +    Headers.Builder result = new Headers.Builder();, +    Headers requestHeaders = response.request().headers();, +    for (int i = 0; i < requestHeaders.size(); i++) {, +      String fieldName = requestHeaders.name(i);, +      if (varyFields.contains(fieldName)) {, +        result.add(fieldName, requestHeaders.value(i));, +      }, +    }, +    return result.build();, +  }]
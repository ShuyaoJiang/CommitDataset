[+++ b/CHANGELOG.md, + * Fix: Ensure `null` is never returned from a connection's `getHeaderFields()`., +++ b/CHANGELOG.md, + * Fix: Ensure `null` is never returned from a connection's `getHeaderFields()`., +++ b/mockwebserver/src/main/java/com/squareup/okhttp/mockwebserver/MockWebServer.java, +    executor = Executors.newCachedThreadPool();, +    executor.execute(namedRunnable("MockWebServer-accept-" + port, new Runnable() {, +      public void run() {, +    }));, +    String name = "MockWebServer-" + raw.getRemoteSocketAddress();, +    executor.execute(namedRunnable(name, new Runnable() {, +      public void run() {, +    }));, +  private static Runnable namedRunnable(final String name, final Runnable runnable) {, +    return new Runnable() {, +      public void run() {, +        String originalName = Thread.currentThread().getName();, +        Thread.currentThread().setName(name);, +        try {, +          runnable.run();, +        } finally {, +          Thread.currentThread().setName(originalName);, +        }, +      }, +    };, +  }, +, +++ b/CHANGELOG.md, + * Fix: Ensure `null` is never returned from a connection's `getHeaderFields()`., +++ b/mockwebserver/src/main/java/com/squareup/okhttp/mockwebserver/MockWebServer.java, +    executor = Executors.newCachedThreadPool();, +    executor.execute(namedRunnable("MockWebServer-accept-" + port, new Runnable() {, +      public void run() {, +    }));, +    String name = "MockWebServer-" + raw.getRemoteSocketAddress();, +    executor.execute(namedRunnable(name, new Runnable() {, +      public void run() {, +    }));, +  private static Runnable namedRunnable(final String name, final Runnable runnable) {, +    return new Runnable() {, +      public void run() {, +        String originalName = Thread.currentThread().getName();, +        Thread.currentThread().setName(name);, +        try {, +          runnable.run();, +        } finally {, +          Thread.currentThread().setName(originalName);, +        }, +      }, +    };, +  }, +, +++ b/okhttp-protocols/src/main/java/com/squareup/okhttp/internal/Util.java, +  public static ThreadFactory daemonThreadFactory(final String name) {, +        result.setDaemon(true);, +++ b/CHANGELOG.md, + * Fix: Ensure `null` is never returned from a connection's `getHeaderFields()`., +++ b/mockwebserver/src/main/java/com/squareup/okhttp/mockwebserver/MockWebServer.java, +    executor = Executors.newCachedThreadPool();, +    executor.execute(namedRunnable("MockWebServer-accept-" + port, new Runnable() {, +      public void run() {, +    }));, +    String name = "MockWebServer-" + raw.getRemoteSocketAddress();, +    executor.execute(namedRunnable(name, new Runnable() {, +      public void run() {, +    }));, +  private static Runnable namedRunnable(final String name, final Runnable runnable) {, +    return new Runnable() {, +      public void run() {, +        String originalName = Thread.currentThread().getName();, +        Thread.currentThread().setName(name);, +        try {, +          runnable.run();, +        } finally {, +          Thread.currentThread().setName(originalName);, +        }, +      }, +    };, +  }, +, +++ b/okhttp-protocols/src/main/java/com/squareup/okhttp/internal/Util.java, +  public static ThreadFactory daemonThreadFactory(final String name) {, +        result.setDaemon(true);, +++ b/okhttp-protocols/src/main/java/com/squareup/okhttp/internal/spdy/SpdyConnection.java, +      Util.daemonThreadFactory("OkHttp SpdyConnection"));, +    new Thread(new Reader(), "Spdy Reader " + hostName).start();, +    executor.submit(new NamedRunnable("OkHttp SPDY Writer %s stream %d", hostName, streamId) {, +    executor.submit(new NamedRunnable("OkHttp SPDY Writer %s stream %d", hostName, streamId) {, +    executor.submit(new NamedRunnable("OkHttp SPDY Writer %s ping %08x%08x",, +  private class Reader implements Runnable, FrameReader.Handler {, +    @Override public void run() {, +          executor.submit(new NamedRunnable("OkHttp Callback %s stream %d", hostName, streamId) {, +++ b/CHANGELOG.md, + * Fix: Ensure `null` is never returned from a connection's `getHeaderFields()`., +++ b/mockwebserver/src/main/java/com/squareup/okhttp/mockwebserver/MockWebServer.java, +    executor = Executors.newCachedThreadPool();, +    executor.execute(namedRunnable("MockWebServer-accept-" + port, new Runnable() {, +      public void run() {, +    }));, +    String name = "MockWebServer-" + raw.getRemoteSocketAddress();]
[+++ b/okhttp/src/main/java/okhttp3/internal/ws/WebSocketWriter.java, +      random.nextBytes(maskKey);, +      for (long written = 0; written < byteCount; ) {, +        int read = buffer.read(maskBuffer, 0, toRead);, +    } else {, +      sink.write(buffer, byteCount);, +    }, +, +    sink.emit();]
[+++ b/okhttp-tests/src/main/java/okhttp3/TestTls13Request.java, +, +  // TLS 1.3, +  private static final CipherSuite[] TLS13_CIPHER_SUITES = new CipherSuite[] {, +      CipherSuite.TLS_AES_128_GCM_SHA256,, +      CipherSuite.TLS_AES_256_GCM_SHA384,, +      CipherSuite.TLS_CHACHA20_POLY1305_SHA256,, +      CipherSuite.TLS_AES_128_CCM_SHA256,, +      CipherSuite.TLS_AES_256_CCM_8_SHA256, +  };, +, +  /**, +   * A TLS 1.3 only Connection Spec. This will be eventually be exposed, +   * as part of MODERN_TLS or folded into the default OkHttp client once published and, +   * available in JDK11 or Conscrypt., +   */, +  private static final ConnectionSpec TLS_13 = new ConnectionSpec.Builder(true), +      .cipherSuites(TLS13_CIPHER_SUITES), +      .tlsVersions(TlsVersion.TLS_1_3), +      .supportsTlsExtensions(true), +      .build();, +, +, +  private static final ConnectionSpec TLS_12 =, +      new ConnectionSpec.Builder(ConnectionSpec.RESTRICTED_TLS).tlsVersions(TlsVersion.TLS_1_2), +          .build();, +, +            "https://tls13.crypto.mozilla.org/", "https://tls.ctf.network/robots.txt",, +            "https://tls13.baishancloud.com/", "https://tls13.akamai.io/", "https://swifttls.org/",, +            "https://www.googleapis.com/robots.txt", "https://graph.facebook.com/robots.txt",, +            "https://api.twitter.com/robots.txt", "https://connect.squareup.com/robots.txt");, +    testClient(urls, buildClient(TLS_13));, +    System.out.println("\nTLS1.3 then fallback");, +    testClient(urls, buildClient(TLS_13, TLS_12));, +    System.out.println("\nTLS1.3+TLS1.2");, +    testClient(urls, buildClient(ConnectionSpec.RESTRICTED_TLS));, +++ b/okhttp-tests/src/main/java/okhttp3/TestTls13Request.java, +, +  // TLS 1.3, +  private static final CipherSuite[] TLS13_CIPHER_SUITES = new CipherSuite[] {, +      CipherSuite.TLS_AES_128_GCM_SHA256,, +      CipherSuite.TLS_AES_256_GCM_SHA384,, +      CipherSuite.TLS_CHACHA20_POLY1305_SHA256,, +      CipherSuite.TLS_AES_128_CCM_SHA256,, +      CipherSuite.TLS_AES_256_CCM_8_SHA256, +  };, +, +  /**, +   * A TLS 1.3 only Connection Spec. This will be eventually be exposed, +   * as part of MODERN_TLS or folded into the default OkHttp client once published and, +   * available in JDK11 or Conscrypt., +   */, +  private static final ConnectionSpec TLS_13 = new ConnectionSpec.Builder(true), +      .cipherSuites(TLS13_CIPHER_SUITES), +      .tlsVersions(TlsVersion.TLS_1_3), +      .supportsTlsExtensions(true), +      .build();, +, +, +  private static final ConnectionSpec TLS_12 =, +      new ConnectionSpec.Builder(ConnectionSpec.RESTRICTED_TLS).tlsVersions(TlsVersion.TLS_1_2), +          .build();, +, +            "https://tls13.crypto.mozilla.org/", "https://tls.ctf.network/robots.txt",, +            "https://tls13.baishancloud.com/", "https://tls13.akamai.io/", "https://swifttls.org/",, +            "https://www.googleapis.com/robots.txt", "https://graph.facebook.com/robots.txt",, +            "https://api.twitter.com/robots.txt", "https://connect.squareup.com/robots.txt");, +    testClient(urls, buildClient(TLS_13));, +    System.out.println("\nTLS1.3 then fallback");, +    testClient(urls, buildClient(TLS_13, TLS_12));, +    System.out.println("\nTLS1.3+TLS1.2");, +    testClient(urls, buildClient(ConnectionSpec.RESTRICTED_TLS));, +++ b/okhttp/src/main/java/okhttp3/CipherSuite.java, +  // TLS 1.3 https://tools.ietf.org/html/rfc8446, +++ b/okhttp-tests/src/main/java/okhttp3/TestTls13Request.java, +, +  // TLS 1.3, +  private static final CipherSuite[] TLS13_CIPHER_SUITES = new CipherSuite[] {, +      CipherSuite.TLS_AES_128_GCM_SHA256,, +      CipherSuite.TLS_AES_256_GCM_SHA384,, +      CipherSuite.TLS_CHACHA20_POLY1305_SHA256,, +      CipherSuite.TLS_AES_128_CCM_SHA256,, +      CipherSuite.TLS_AES_256_CCM_8_SHA256, +  };, +, +  /**, +   * A TLS 1.3 only Connection Spec. This will be eventually be exposed, +   * as part of MODERN_TLS or folded into the default OkHttp client once published and, +   * available in JDK11 or Conscrypt., +   */, +  private static final ConnectionSpec TLS_13 = new ConnectionSpec.Builder(true), +      .cipherSuites(TLS13_CIPHER_SUITES), +      .tlsVersions(TlsVersion.TLS_1_3), +      .supportsTlsExtensions(true), +      .build();, +, +, +  private static final ConnectionSpec TLS_12 =, +      new ConnectionSpec.Builder(ConnectionSpec.RESTRICTED_TLS).tlsVersions(TlsVersion.TLS_1_2), +          .build();]
[+++ b/okhttp/src/main/java/okhttp3/internal/connection/RealConnection.java, +import javax.net.ssl.SSLSession;, +      // block for session establishment, +      SSLSession sslSocketSession = sslSocket.getSession();, +      if (!isValid(sslSocketSession)) {, +        throw new IOException("a valid ssl session was not established");, +      }, +      Handshake unverifiedHandshake = Handshake.get(sslSocketSession);, +  private boolean isValid(SSLSession sslSocketSession) {, +    // don't use SslSocket.getSession since for failed results it returns SSL_NULL_WITH_NULL_NULL, +    return !"NONE".equals(sslSocketSession.getProtocol()) && !"SSL_NULL_WITH_NULL_NULL".equals(, +        sslSocketSession.getCipherSuite());, +  }, +]
[+++ b/okhttp-tests/src/test/java/okhttp3/internal/http2/HttpOverHttp2Test.java, +import java.util.concurrent.TimeUnit;, +import okhttp3.mockwebserver.internal.tls.SslClient;, +  @Test public void pingsTransmitted() throws Exception {, +    // Ping every 500 ms, starting at 500 ms., +    client = client.newBuilder(), +        .pingInterval(500, TimeUnit.MILLISECONDS), +        .build();, +, +    // Delay the response to give 1 ping enough time to be sent and replied to., +    server.enqueue(new MockResponse(), +        .setBodyDelay(750, TimeUnit.MILLISECONDS), +        .setBody("ABC"));, +, +    Call call = client.newCall(new Request.Builder(), +        .url(server.url("/")), +        .build());, +    Response response = call.execute();, +    assertEquals("ABC", response.body().string());, +, +    assertEquals(Protocol.HTTP_2, response.protocol());, +, +    // Confirm a single ping was sent and received, and its reply was sent and received., +    List<String> logs = http2Handler.takeAll();, +    assertEquals(1, countFrames(logs, "FINE: >> 0x00000000     8 PING          "));, +    assertEquals(1, countFrames(logs, "FINE: << 0x00000000     8 PING          "));, +    assertEquals(1, countFrames(logs, "FINE: >> 0x00000000     8 PING          ACK"));, +    assertEquals(1, countFrames(logs, "FINE: << 0x00000000     8 PING          ACK"));, +  }, +, +    for (String log: logs) {, +      if (log.contains(type)) {, +        return log;, +  private int countFrames(List<String> logs, String message) {, +    int result = 0;, +    for (String log: logs) {, +      if (log.equals(message)) {, +        result++;, +      }, +    }, +    return result;, +  }, +, +++ b/okhttp-tests/src/test/java/okhttp3/internal/http2/HttpOverHttp2Test.java, +import java.util.concurrent.TimeUnit;, +import okhttp3.mockwebserver.internal.tls.SslClient;, +  @Test public void pingsTransmitted() throws Exception {, +    // Ping every 500 ms, starting at 500 ms., +    client = client.newBuilder(), +        .pingInterval(500, TimeUnit.MILLISECONDS), +        .build();, +, +    // Delay the response to give 1 ping enough time to be sent and replied to., +    server.enqueue(new MockResponse(), +        .setBodyDelay(750, TimeUnit.MILLISECONDS), +        .setBody("ABC"));, +, +    Call call = client.newCall(new Request.Builder(), +        .url(server.url("/")), +        .build());, +    Response response = call.execute();, +    assertEquals("ABC", response.body().string());, +, +    assertEquals(Protocol.HTTP_2, response.protocol());, +, +    // Confirm a single ping was sent and received, and its reply was sent and received., +    List<String> logs = http2Handler.takeAll();, +    assertEquals(1, countFrames(logs, "FINE: >> 0x00000000     8 PING          "));, +    assertEquals(1, countFrames(logs, "FINE: << 0x00000000     8 PING          "));, +    assertEquals(1, countFrames(logs, "FINE: >> 0x00000000     8 PING          ACK"));, +    assertEquals(1, countFrames(logs, "FINE: << 0x00000000     8 PING          ACK"));, +  }, +, +    for (String log: logs) {, +      if (log.contains(type)) {, +        return log;, +  private int countFrames(List<String> logs, String message) {, +    int result = 0;, +    for (String log: logs) {, +      if (log.equals(message)) {, +        result++;, +      }, +    }, +    return result;, +  }, +, +++ b/okhttp-urlconnection/src/main/java/okhttp3/internal/huc/OkHttpsURLConnection.java, +      throw new IllegalArgumentException("sslSocketFactory == null");, +++ b/okhttp-tests/src/test/java/okhttp3/internal/http2/HttpOverHttp2Test.java, +import java.util.concurrent.TimeUnit;, +import okhttp3.mockwebserver.internal.tls.SslClient;, +  @Test public void pingsTransmitted() throws Exception {, +    // Ping every 500 ms, starting at 500 ms., +    client = client.newBuilder(), +        .pingInterval(500, TimeUnit.MILLISECONDS), +        .build();, +, +    // Delay the response to give 1 ping enough time to be sent and replied to., +    server.enqueue(new MockResponse(), +        .setBodyDelay(750, TimeUnit.MILLISECONDS)]
[+++ b/okhttp-tests/src/test/java/com/squareup/okhttp/CacheTest.java, +/*, + * Copyright (C) 2011 The Android Open Source Project, + *, + * Licensed under the Apache License, Version 2.0 (the "License");, + * you may not use this file except in compliance with the License., + * You may obtain a copy of the License at, + *, + *      http://www.apache.org/licenses/LICENSE-2.0, + *, + * Unless required by applicable law or agreed to in writing, software, + * distributed under the License is distributed on an "AS IS" BASIS,, + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied., + * See the License for the specific language governing permissions and, + * limitations under the License., + */, +, +package com.squareup.okhttp;, +, +import com.squareup.okhttp.internal.SslContextBuilder;, +import com.squareup.okhttp.internal.Util;, +import com.squareup.okhttp.internal.http.OkHeaders;, +import com.squareup.okhttp.mockwebserver.MockResponse;, +import com.squareup.okhttp.mockwebserver.MockWebServer;, +import com.squareup.okhttp.mockwebserver.RecordedRequest;, +import com.squareup.okhttp.mockwebserver.rule.MockWebServerRule;, +import java.io.BufferedReader;, +import java.io.File;, +import java.io.FileNotFoundException;, +import java.io.IOException;, +import java.io.InputStream;, +import java.io.InputStreamReader;, +import java.io.OutputStream;, +import java.net.CacheRequest;, +import java.net.CacheResponse;, +import java.net.CookieHandler;, +import java.net.CookieManager;, +import java.net.HttpCookie;, +import java.net.HttpURLConnection;, +import java.net.ResponseCache;, +import java.net.URI;, +import java.net.URISyntaxException;, +import java.net.URL;, +import java.net.URLConnection;, +import java.security.Principal;, +import java.security.cert.Certificate;, +import java.text.DateFormat;, +import java.text.SimpleDateFormat;, +import java.util.ArrayList;, +import java.util.Arrays;, +import java.util.Date;, +import java.util.Iterator;, +import java.util.List;, +import java.util.Locale;, +import java.util.Map;, +import java.util.TimeZone;, +import java.util.concurrent.TimeUnit;, +import java.util.concurrent.atomic.AtomicBoolean;, +import java.util.concurrent.atomic.AtomicInteger;, +import java.util.concurrent.atomic.AtomicReference;, +import javax.net.ssl.HostnameVerifier;, +import javax.net.ssl.HttpsURLConnection;, +import javax.net.ssl.SSLContext;, +import javax.net.ssl.SSLSession;, +import okio.Buffer;, +import okio.BufferedSink;, +import okio.GzipSink;, +import okio.Okio;, +import org.junit.After;, +import org.junit.Before;, +import org.junit.Rule;, +import org.junit.Test;, +import org.junit.rules.TemporaryFolder;, +, +import static com.squareup.okhttp.mockwebserver.SocketPolicy.DISCONNECT_AT_END;, +import static org.junit.Assert.assertEquals;, +import static org.junit.Assert.assertFalse;, +import static org.junit.Assert.assertNotNull;, +import static org.junit.Assert.assertNull;, +import static org.junit.Assert.assertSame;, +import static org.junit.Assert.assertTrue;, +import static org.junit.Assert.fail;, +, +/**, + * Android's HttpResponseCacheTest. This tests both {@link Cache} and handling, + * of {@link ResponseCache}., + */, +public final class CacheTest {, +  private static final HostnameVerifier NULL_HOSTNAME_VERIFIER = new HostnameVerifier() {, +    @Override public boolean verify(String s, SSLSession sslSession) {, +      return true;, +    }, +  };, +, +  private static final SSLContext sslContext = SslContextBuilder.localhost();, +, +  @Rule public TemporaryFolder cacheRule = new TemporaryFolder();, +  @Rule public MockWebServerRule serverRule = new MockWebServerRule();, +  @Rule public MockWebServerRule server2Rule = new MockWebServerRule();, +]
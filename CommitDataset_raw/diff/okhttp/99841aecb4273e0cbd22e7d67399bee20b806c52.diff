[+++ /dev/null, +++ /dev/null, +++ b/benchmarks/pom.xml, +      <groupId>com.google.caliper</groupId>, +      <artifactId>caliper</artifactId>, +      <version>1.0-beta-1</version>, +    </dependency>, +    <dependency>, +    <!-- Netty needs this if gzip is enabled. -->, +    <dependency>, +      <groupId>com.jcraft</groupId>, +      <artifactId>jzlib</artifactId>, +      <version>1.1.2</version>, +    </dependency>, +++ /dev/null, +++ b/benchmarks/pom.xml, +      <groupId>com.google.caliper</groupId>, +      <artifactId>caliper</artifactId>, +      <version>1.0-beta-1</version>, +    </dependency>, +    <dependency>, +    <!-- Netty needs this if gzip is enabled. -->, +    <dependency>, +      <groupId>com.jcraft</groupId>, +      <artifactId>jzlib</artifactId>, +      <version>1.1.2</version>, +    </dependency>, +++ b/benchmarks/src/main/java/com/squareup/okhttp/benchmarks/ApacheHttpClient.java, +        long total = readAllAndClose(in);, +++ /dev/null, +++ b/benchmarks/pom.xml, +      <groupId>com.google.caliper</groupId>, +      <artifactId>caliper</artifactId>, +      <version>1.0-beta-1</version>, +    </dependency>, +    <dependency>, +    <!-- Netty needs this if gzip is enabled. -->, +    <dependency>, +      <groupId>com.jcraft</groupId>, +      <artifactId>jzlib</artifactId>, +      <version>1.1.2</version>, +    </dependency>, +++ b/benchmarks/src/main/java/com/squareup/okhttp/benchmarks/ApacheHttpClient.java, +        long total = readAllAndClose(in);, +++ b/benchmarks/src/main/java/com/squareup/okhttp/benchmarks/Benchmark.java, +import com.google.caliper.Param;, +import com.google.caliper.model.ArbitraryMeasurement;, +import com.google.caliper.runner.CaliperMain;, +public class Benchmark extends com.google.caliper.Benchmark {, +  private static final boolean VERBOSE = false;, +, +  @Param, +  Client client;, +  @Param({ "1", "10" }), +  int concurrencyLevel;, +  @Param, +  boolean tls;, +  @Param, +  boolean gzip;, +  @Param, +  boolean chunked;, +  @Param({ "128", "1048576" }), +  int bodyByteCount;, +  @Param({ "0", "20" }), +  int headerCount;, +  public static void main(String[] args) {, +    List<String> allArgs = new ArrayList<String>();, +    allArgs.add("--instrument");, +    allArgs.add("arbitrary");, +    allArgs.addAll(Arrays.asList(args));, +, +    CaliperMain.main(Benchmark.class, allArgs.toArray(new String[allArgs.size()]));, +  @ArbitraryMeasurement(description = "requests per second"), +  public double run() throws Exception {, +    if (VERBOSE) System.out.println(toString());, +    HttpClient httpClient = client.create();, +    double best = 0.0;, +        if (VERBOSE) {, +        }, +        best = Math.max(best, requestsPerSecond);, +, +    return best;, +    return String.format("%s %s\nbodyByteCount=%s headerCount=%s concurrencyLevel=%s",, +        client, modifiers, bodyByteCount, headerCount, concurrencyLevel);, +++ /dev/null, +++ b/benchmarks/pom.xml, +      <groupId>com.google.caliper</groupId>, +      <artifactId>caliper</artifactId>, +      <version>1.0-beta-1</version>, +    </dependency>, +    <dependency>, +    <!-- Netty needs this if gzip is enabled. -->, +    <dependency>, +      <groupId>com.jcraft</groupId>, +      <artifactId>jzlib</artifactId>, +      <version>1.1.2</version>, +    </dependency>, +++ b/benchmarks/src/main/java/com/squareup/okhttp/benchmarks/ApacheHttpClient.java, +        long total = readAllAndClose(in);, +++ b/benchmarks/src/main/java/com/squareup/okhttp/benchmarks/Benchmark.java]
[+++ b/jadx-gui/src/main/java/jadx/gui/ui/MainWindow.java, +import jadx.gui.utils.JadxPreferences;, +	private JCheckBoxMenuItem flatPkgMenuItem;, +	private JToggleButton flatPkgButton;, +	private boolean isFlattenPackage;, +, +		, +		String currentDirectory = JadxPreferences.getLastOpenFilePath();, +		if (!currentDirectory.isEmpty()) {, +			fileChooser.setCurrentDirectory(new File(currentDirectory));, +		}, +, +			JadxPreferences.putLastOpenFilePath(fileChooser.getCurrentDirectory().getPath());, +			, +, +		String currentDirectory = JadxPreferences.getLastSaveFilePath();, +		if (!currentDirectory.isEmpty()) {, +			fileChooser.setCurrentDirectory(new File(currentDirectory));, +		}, +		, +			JadxPreferences.putLastSaveFilePath(fileChooser.getCurrentDirectory().getPath());, +		treeRoot.setFlatPackages(isFlattenPackage);, +	private void toggleFlattenPackage() {, +		setFlattenPackage(!isFlattenPackage);, +	}, +, +	private void setFlattenPackage(boolean value) {, +		isFlattenPackage = value;, +		JadxPreferences.putFlattenPackage(isFlattenPackage);, +, +		flatPkgButton.setSelected(isFlattenPackage);, +		flatPkgMenuItem.setState(isFlattenPackage);, +, +			treeRoot.setFlatPackages(isFlattenPackage);, +		isFlattenPackage = JadxPreferences.getFlattenPackage();, +, +		flatPkgMenuItem = new JCheckBoxMenuItem(NLS.str("menu.flatten"), ICON_FLAT_PKG);, +		flatPkgMenuItem.setState(isFlattenPackage);, +		flatPkgButton = new JToggleButton(ICON_FLAT_PKG);, +		flatPkgButton.setSelected(isFlattenPackage);, +				toggleFlattenPackage();, +++ b/jadx-gui/src/main/java/jadx/gui/ui/MainWindow.java, +import jadx.gui.utils.JadxPreferences;, +	private JCheckBoxMenuItem flatPkgMenuItem;, +	private JToggleButton flatPkgButton;, +	private boolean isFlattenPackage;, +, +		, +		String currentDirectory = JadxPreferences.getLastOpenFilePath();, +		if (!currentDirectory.isEmpty()) {, +			fileChooser.setCurrentDirectory(new File(currentDirectory));, +		}, +, +			JadxPreferences.putLastOpenFilePath(fileChooser.getCurrentDirectory().getPath());, +			, +, +		String currentDirectory = JadxPreferences.getLastSaveFilePath();, +		if (!currentDirectory.isEmpty()) {, +			fileChooser.setCurrentDirectory(new File(currentDirectory));, +		}, +		, +			JadxPreferences.putLastSaveFilePath(fileChooser.getCurrentDirectory().getPath());, +		treeRoot.setFlatPackages(isFlattenPackage);, +	private void toggleFlattenPackage() {, +		setFlattenPackage(!isFlattenPackage);, +	}, +, +	private void setFlattenPackage(boolean value) {, +		isFlattenPackage = value;, +		JadxPreferences.putFlattenPackage(isFlattenPackage);, +, +		flatPkgButton.setSelected(isFlattenPackage);, +		flatPkgMenuItem.setState(isFlattenPackage);, +, +			treeRoot.setFlatPackages(isFlattenPackage);, +		isFlattenPackage = JadxPreferences.getFlattenPackage();, +, +		flatPkgMenuItem = new JCheckBoxMenuItem(NLS.str("menu.flatten"), ICON_FLAT_PKG);, +		flatPkgMenuItem.setState(isFlattenPackage);, +		flatPkgButton = new JToggleButton(ICON_FLAT_PKG);, +		flatPkgButton.setSelected(isFlattenPackage);, +				toggleFlattenPackage();, +++ b/jadx-gui/src/main/java/jadx/gui/utils/JadxPreferences.java, +package jadx.gui.utils;, +, +import java.util.prefs.Preferences;, +, +public class JadxPreferences {, +, +	public static String getLastOpenFilePath() {, +		String result = "";, +, +		try {, +			result = getPreferences().get(KEY_LAST_OPEN_FILE_PATH, "");, +, +			if (result.isEmpty()), +			{, +				result = System.getProperty("user.home");, +			}, +		}]
[+++ b/.DS_Store, +++ b/.DS_Store, +++ b/jadx-core/src/main/java/jadx/core/codegen/CodeWriter.java, +import jadx.core.utils.files.ZipSecurity;, +		if(!ZipSecurity.isValidZipEntryName(subDir) || !ZipSecurity.isValidZipEntryName(fileName)) {, +			return;, +		}, +		if(!ZipSecurity.isValidZipEntryName(fileName)) {, +			return;, +		}, +++ b/.DS_Store, +++ b/jadx-core/src/main/java/jadx/core/codegen/CodeWriter.java, +import jadx.core.utils.files.ZipSecurity;, +		if(!ZipSecurity.isValidZipEntryName(subDir) || !ZipSecurity.isValidZipEntryName(fileName)) {, +			return;, +		}, +		if(!ZipSecurity.isValidZipEntryName(fileName)) {, +			return;, +		}, +++ b/jadx-core/src/main/java/jadx/core/dex/visitors/SaveCode.java, +import jadx.core.utils.files.ZipSecurity;, +++ b/.DS_Store, +++ b/jadx-core/src/main/java/jadx/core/codegen/CodeWriter.java, +import jadx.core.utils.files.ZipSecurity;, +		if(!ZipSecurity.isValidZipEntryName(subDir) || !ZipSecurity.isValidZipEntryName(fileName)) {, +			return;, +		}, +		if(!ZipSecurity.isValidZipEntryName(fileName)) {, +			return;, +		}, +++ b/jadx-core/src/main/java/jadx/core/dex/visitors/SaveCode.java, +import jadx.core.utils.files.ZipSecurity;, +++ b/jadx-core/src/main/java/jadx/core/utils/files/ZipSecurity.java, +	private static final int MAX_SIZE_DIFF = 10;, +			LOG.error("Path traversal attack detected, invalid name: {}", entryName);, +			LOG.error("Path traversal attack detected, invalid name: {}", entryName);, +			LOG.error("Zip bomp attack detected, invalid sizes: compressed {}, uncompressed {}, name {}",, +					compressedSize, uncompressedSize, entry.getName());]
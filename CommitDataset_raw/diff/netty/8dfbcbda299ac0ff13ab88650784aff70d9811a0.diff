[+++ b/transport/src/main/java/io/netty/channel/ChannelOutboundBuffer.java, +            } else {, +                // We need to check for next here as the notification of the future may trigger some other event, +                // which will also call ChannelOutboundBuffer and so set currentMessage and currentPromise to null., +                // See https://github.com/netty/netty/issues/1501, +                if (!next()) {, +                    return;, +                }]
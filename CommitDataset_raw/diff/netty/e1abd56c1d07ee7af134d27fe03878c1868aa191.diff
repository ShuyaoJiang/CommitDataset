[+++ b/src/main/java/org/jboss/netty/channel/socket/http/HttpTunnelWorker.java, + * @author Trustin Lee (tlee@redhat.com), +            synchronized (channel.interestOpsLock) {, +                        channel.interestOpsLock.wait();, +                fireMessageReceived(, +                        channel,, +                        ChannelBuffers.wrappedBuffer(, +                                channel.getConfig().getBufferFactory().getDefaultOrder(),, +                                buf));, +            ChannelBuffer buf = (ChannelBuffer) message;, +            int writtenBytes = channel.sendChunk(buf);, +            fireWriteComplete(channel, writtenBytes);, +                synchronized (channel.interestOpsLock) {, +                    channel.setInterestOpsNow(interestOps);, +, +                }, +++ b/src/main/java/org/jboss/netty/channel/socket/http/HttpTunnelWorker.java, + * @author Trustin Lee (tlee@redhat.com), +            synchronized (channel.interestOpsLock) {, +                        channel.interestOpsLock.wait();, +                fireMessageReceived(, +                        channel,, +                        ChannelBuffers.wrappedBuffer(, +                                channel.getConfig().getBufferFactory().getDefaultOrder(),, +                                buf));, +            ChannelBuffer buf = (ChannelBuffer) message;, +            int writtenBytes = channel.sendChunk(buf);, +            fireWriteComplete(channel, writtenBytes);, +                synchronized (channel.interestOpsLock) {, +                    channel.setInterestOpsNow(interestOps);, +, +                }, +++ b/src/main/java/org/jboss/netty/channel/socket/http/HttpTunnelingChannelHandler.java, + * @author Trustin Lee (tlee@redhat.com), +++ b/src/main/java/org/jboss/netty/channel/socket/http/HttpTunnelWorker.java, + * @author Trustin Lee (tlee@redhat.com), +            synchronized (channel.interestOpsLock) {, +                        channel.interestOpsLock.wait();, +                fireMessageReceived(, +                        channel,, +                        ChannelBuffers.wrappedBuffer(, +                                channel.getConfig().getBufferFactory().getDefaultOrder(),, +                                buf));, +            ChannelBuffer buf = (ChannelBuffer) message;, +            int writtenBytes = channel.sendChunk(buf);, +            fireWriteComplete(channel, writtenBytes);, +                synchronized (channel.interestOpsLock) {, +                    channel.setInterestOpsNow(interestOps);, +, +                }, +++ b/src/main/java/org/jboss/netty/channel/socket/http/HttpTunnelingChannelHandler.java, + * @author Trustin Lee (tlee@redhat.com), +++ b/src/main/java/org/jboss/netty/channel/socket/http/HttpTunnelingClientSocketChannel.java, + * @author Trustin Lee (tlee@redhat.com), +    final Object interestOpsLock = new Object();, +    int sendChunk(ChannelBuffer a) {, +, +        return size + hex.length() + HttpTunnelingClientSocketPipelineSink.LINE_TERMINATOR.length();, +++ b/src/main/java/org/jboss/netty/channel/socket/http/HttpTunnelWorker.java, + * @author Trustin Lee (tlee@redhat.com), +            synchronized (channel.interestOpsLock) {, +                        channel.interestOpsLock.wait();, +                fireMessageReceived(, +                        channel,, +                        ChannelBuffers.wrappedBuffer(, +                                channel.getConfig().getBufferFactory().getDefaultOrder(),, +                                buf));, +            ChannelBuffer buf = (ChannelBuffer) message;, +            int writtenBytes = channel.sendChunk(buf);, +            fireWriteComplete(channel, writtenBytes);, +                synchronized (channel.interestOpsLock) {, +                    channel.setInterestOpsNow(interestOps);, +, +                }, +++ b/src/main/java/org/jboss/netty/channel/socket/http/HttpTunnelingChannelHandler.java, + * @author Trustin Lee (tlee@redhat.com), +++ b/src/main/java/org/jboss/netty/channel/socket/http/HttpTunnelingClientSocketChannel.java, + * @author Trustin Lee (tlee@redhat.com), +    final Object interestOpsLock = new Object();, +    int sendChunk(ChannelBuffer a) {, +, +        return size + hex.length() + HttpTunnelingClientSocketPipelineSink.LINE_TERMINATOR.length();, +++ b/src/main/java/org/jboss/netty/channel/socket/http/HttpTunnelingClientSocketChannelFactory.java, + * @author Trustin Lee (tlee@redhat.com), +++ b/src/main/java/org/jboss/netty/channel/socket/http/HttpTunnelWorker.java, + * @author Trustin Lee (tlee@redhat.com), +            synchronized (channel.interestOpsLock) {, +                        channel.interestOpsLock.wait();, +                fireMessageReceived(, +                        channel,, +                        ChannelBuffers.wrappedBuffer(, +                                channel.getConfig().getBufferFactory().getDefaultOrder(),, +                                buf));, +            ChannelBuffer buf = (ChannelBuffer) message;, +            int writtenBytes = channel.sendChunk(buf);, +            fireWriteComplete(channel, writtenBytes);, +                synchronized (channel.interestOpsLock) {, +                    channel.setInterestOpsNow(interestOps);, +, +                }]
[+++ b/common/src/main/java/io/netty/util/ResourceLeakDetector.java, +import java.util.Collections;, +import java.util.concurrent.ConcurrentHashMap;, +    private final Set<DefaultResourceLeak<?>> allLeaks =, +            Collections.newSetFromMap(new ConcurrentHashMap<DefaultResourceLeak<?>, Boolean>());, +        private final Set<DefaultResourceLeak<?>> allLeaks;, +                Set<DefaultResourceLeak<?>> allLeaks) {, +            allLeaks.add(this);, +            return allLeaks.remove(this);, +            if (allLeaks.remove(this)) {]
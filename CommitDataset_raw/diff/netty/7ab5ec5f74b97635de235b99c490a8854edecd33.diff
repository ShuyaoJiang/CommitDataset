[+++ b/src/main/java/org/jboss/netty/handler/codec/compression/ZlibDecoder.java, +, +                loop: for (;;) {, +                    if (z.next_out_index > 0) {, +                        decompressed.writeBytes(out, 0, z.next_out_index);, +                        z.avail_out = out.length;, +                    }, +                    z.next_out_index = 0;, +, +                        break loop;, +                    case JZlib.Z_OK:, +                        break;, +                    case JZlib.Z_BUF_ERROR:, +                        if (z.avail_in <= 0) {, +                            break loop;, +                }, +++ b/src/main/java/org/jboss/netty/handler/codec/compression/ZlibDecoder.java, +, +                loop: for (;;) {, +                    if (z.next_out_index > 0) {, +                        decompressed.writeBytes(out, 0, z.next_out_index);, +                        z.avail_out = out.length;, +                    }, +                    z.next_out_index = 0;, +, +                        break loop;, +                    case JZlib.Z_OK:, +                        break;, +                    case JZlib.Z_BUF_ERROR:, +                        if (z.avail_in <= 0) {, +                            break loop;, +                }, +++ b/src/main/java/org/jboss/netty/handler/codec/compression/ZlibEncoder.java, +        if (wrapper == ZlibWrapper.ZLIB_OR_NONE) {, +            throw new IllegalArgumentException(, +                    "wrapper '" + ZlibWrapper.ZLIB_OR_NONE + "' is not " +, +                    "allowed for compression.");, +        }, +++ b/src/main/java/org/jboss/netty/handler/codec/compression/ZlibDecoder.java, +, +                loop: for (;;) {, +                    if (z.next_out_index > 0) {, +                        decompressed.writeBytes(out, 0, z.next_out_index);, +                        z.avail_out = out.length;, +                    }, +                    z.next_out_index = 0;, +, +                        break loop;, +                    case JZlib.Z_OK:, +                        break;, +                    case JZlib.Z_BUF_ERROR:, +                        if (z.avail_in <= 0) {, +                            break loop;, +                }, +++ b/src/main/java/org/jboss/netty/handler/codec/compression/ZlibEncoder.java, +        if (wrapper == ZlibWrapper.ZLIB_OR_NONE) {, +            throw new IllegalArgumentException(, +                    "wrapper '" + ZlibWrapper.ZLIB_OR_NONE + "' is not " +, +                    "allowed for compression.");, +        }, +++ b/src/main/java/org/jboss/netty/handler/codec/compression/ZlibUtil.java, +        case ZLIB_OR_NONE:, +            convertedWrapperType = JZlib.W_ZLIB_OR_NONE;, +            break;, +++ b/src/main/java/org/jboss/netty/handler/codec/compression/ZlibDecoder.java, +, +                loop: for (;;) {, +                    if (z.next_out_index > 0) {, +                        decompressed.writeBytes(out, 0, z.next_out_index);, +                        z.avail_out = out.length;, +                    }, +                    z.next_out_index = 0;, +, +                        break loop;, +                    case JZlib.Z_OK:, +                        break;, +                    case JZlib.Z_BUF_ERROR:, +                        if (z.avail_in <= 0) {, +                            break loop;, +                }, +++ b/src/main/java/org/jboss/netty/handler/codec/compression/ZlibEncoder.java, +        if (wrapper == ZlibWrapper.ZLIB_OR_NONE) {, +            throw new IllegalArgumentException(, +                    "wrapper '" + ZlibWrapper.ZLIB_OR_NONE + "' is not " +, +                    "allowed for compression.");, +        }, +++ b/src/main/java/org/jboss/netty/handler/codec/compression/ZlibUtil.java, +        case ZLIB_OR_NONE:, +            convertedWrapperType = JZlib.W_ZLIB_OR_NONE;, +            break;, +++ b/src/main/java/org/jboss/netty/handler/codec/compression/ZlibWrapper.java, +    NONE,, +    /**, +     * Try {@link #ZLIB} first and then {@link #NONE} if the first attempt fails., +     * Please note that you can specify this wrapper type only when decompressing., +     */, +    ZLIB_OR_NONE;, +++ b/src/main/java/org/jboss/netty/handler/codec/compression/ZlibDecoder.java, +, +                loop: for (;;) {]
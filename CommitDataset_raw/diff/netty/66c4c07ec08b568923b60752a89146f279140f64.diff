[+++ b/codec-http/src/main/java/io/netty/handler/codec/http/HttpObjectEncoder.java, +import io.netty.buffer.Unpooled;, +                } else {, +                    // Need to produce some output otherwise an, +                    // IllegalstateException will be thrown, +                    out.add(Unpooled.EMPTY_BUFFER);, +                } else {, +                  if (contentLength == 0) {, +                      // Need to produce some output otherwise an, +                      // IllegalstateException will be thrown, +                      out.add(Unpooled.EMPTY_BUFFER);, +                  }]
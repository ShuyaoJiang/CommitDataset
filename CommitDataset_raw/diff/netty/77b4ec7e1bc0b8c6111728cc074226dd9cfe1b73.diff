[+++ b/buffer/src/main/java/io/netty/buffer/PoolArena.java, +                    oldMemory, oldOffset,, +                    buf.memory, buf.offset, oldCapacity);, +++ b/buffer/src/main/java/io/netty/buffer/PoolArena.java, +                    oldMemory, oldOffset,, +                    buf.memory, buf.offset, oldCapacity);, +++ b/buffer/src/main/java/io/netty/buffer/UnpooledDirectByteBuf.java, +            oldBuffer.position(0).limit(oldBuffer.capacity());, +            newBuffer.position(0).limit(oldBuffer.capacity());, +++ b/buffer/src/main/java/io/netty/buffer/PoolArena.java, +                    oldMemory, oldOffset,, +                    buf.memory, buf.offset, oldCapacity);, +++ b/buffer/src/main/java/io/netty/buffer/UnpooledDirectByteBuf.java, +            oldBuffer.position(0).limit(oldBuffer.capacity());, +            newBuffer.position(0).limit(oldBuffer.capacity());, +++ b/buffer/src/main/java/io/netty/buffer/UnpooledHeapByteBuf.java, +            System.arraycopy(array, 0, newArray, 0, array.length);, +++ b/buffer/src/main/java/io/netty/buffer/PoolArena.java, +                    oldMemory, oldOffset,, +                    buf.memory, buf.offset, oldCapacity);, +++ b/buffer/src/main/java/io/netty/buffer/UnpooledDirectByteBuf.java, +            oldBuffer.position(0).limit(oldBuffer.capacity());, +            newBuffer.position(0).limit(oldBuffer.capacity());, +++ b/buffer/src/main/java/io/netty/buffer/UnpooledHeapByteBuf.java, +            System.arraycopy(array, 0, newArray, 0, array.length);, +++ b/buffer/src/main/java/io/netty/buffer/UnpooledUnsafeDirectByteBuf.java, +            oldBuffer.position(0).limit(oldBuffer.capacity());, +            newBuffer.position(0).limit(oldBuffer.capacity());, +++ b/buffer/src/main/java/io/netty/buffer/PoolArena.java, +                    oldMemory, oldOffset,, +                    buf.memory, buf.offset, oldCapacity);, +++ b/buffer/src/main/java/io/netty/buffer/UnpooledDirectByteBuf.java, +            oldBuffer.position(0).limit(oldBuffer.capacity());, +            newBuffer.position(0).limit(oldBuffer.capacity());, +++ b/buffer/src/main/java/io/netty/buffer/UnpooledHeapByteBuf.java, +            System.arraycopy(array, 0, newArray, 0, array.length);, +++ b/buffer/src/main/java/io/netty/buffer/UnpooledUnsafeDirectByteBuf.java, +            oldBuffer.position(0).limit(oldBuffer.capacity());, +            newBuffer.position(0).limit(oldBuffer.capacity());, +++ b/buffer/src/test/java/io/netty/buffer/DuplicateByteBufTest.java, +    // See https://github.com/netty/netty/issues/1800, +    @Test, +    public void testIncreaseCapacityWrapped() {, +        ByteBuf wrapped = buffer.unwrap();, +        wrapped.writeByte(0);, +        wrapped.readerIndex(wrapped.readerIndex() + 1);, +        buffer.writerIndex(buffer.writerIndex() + 1);, +        wrapped.capacity(wrapped.capacity() * 2);, +, +        assertEquals((byte) 0, buffer.readByte());, +    }]
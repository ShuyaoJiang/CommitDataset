[+++ b/codec/src/main/java/io/netty/handler/codec/LengthFieldBasedFrameDecoder.java, +import java.nio.ByteOrder;, +import java.util.List;, +, +    private void discardingTooLongFrame(ByteBuf in) {, +    private static void failOnNegativeLengthField(ByteBuf in, long frameLength, int lengthFieldEndOffset) {, +    private static void failOnFrameLengthLessThanLengthFieldEndOffset(ByteBuf in,, +                                                                      long frameLength,, +                                                                      int lengthFieldEndOffset) {, +    private void exceededFrameLength(ByteBuf in, long frameLength) {, +    }, +, +    private static void failOnFrameLengthLessThanInitialBytesToStrip(ByteBuf in,, +                                                                     long frameLength,, +                                                                     int initialBytesToStrip) {, +        in.skipBytes((int) frameLength);, +        throw new CorruptedFrameException(, +           "Adjusted frame length (" + frameLength + ") is less " +, +              "than initialBytesToStrip: " + initialBytesToStrip);, +    }, +, +    /**, +     * Create a frame out of the {@link ByteBuf} and return it., +     *, +     * @param   ctx             the {@link ChannelHandlerContext} which this {@link ByteToMessageDecoder} belongs to, +     * @param   in              the {@link ByteBuf} from which to read data, +     * @return  frame           the {@link ByteBuf} which represent the frame or {@code null} if no frame could, +     *                          be created., +     */, +    protected Object decode(ChannelHandlerContext ctx, ByteBuf in) throws Exception {, +        if (discardingTooLongFrame) {, +            discardingTooLongFrame(in);, +        }, +, +        if (in.readableBytes() < lengthFieldEndOffset) {, +            return null;, +        }, +, +        int actualLengthFieldOffset = in.readerIndex() + lengthFieldOffset;, +        long frameLength = getUnadjustedFrameLength(in, actualLengthFieldOffset, lengthFieldLength, byteOrder);, +, +        if (frameLength < 0) {, +            failOnNegativeLengthField(in, frameLength, lengthFieldEndOffset);, +        }, +, +        frameLength += lengthAdjustment + lengthFieldEndOffset;, +, +        if (frameLength < lengthFieldEndOffset) {, +            failOnFrameLengthLessThanLengthFieldEndOffset(in, frameLength, lengthFieldEndOffset);, +        }, +, +        if (frameLength > maxFrameLength) {, +            exceededFrameLength(in, frameLength);, +            failOnFrameLengthLessThanInitialBytesToStrip(in, frameLength, initialBytesToStrip);]
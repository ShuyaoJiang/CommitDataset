[+++ b/transport/src/main/java/io/netty/channel/AbstractChannel.java, +import io.netty.util.internal.EmptyArrays;, +    static final ClosedChannelException CLOSED_CHANNEL_EXCEPTION = new ClosedChannelException();, +    static final NotYetConnectedException NOT_YET_CONNECTED_EXCEPTION = new NotYetConnectedException();, +, +    static {, +        CLOSED_CHANNEL_EXCEPTION.setStackTrace(EmptyArrays.EMPTY_STACK_TRACE);, +        NOT_YET_CONNECTED_EXCEPTION.setStackTrace(EmptyArrays.EMPTY_STACK_TRACE);, +    }, +, +                    outboundBuffer.fail(CLOSED_CHANNEL_EXCEPTION);, +            if (!isActive()) {, +                // Mark the write request as failure if the channl is inactive., +                if (isOpen()) {, +                    promise.tryFailure(NOT_YET_CONNECTED_EXCEPTION);, +                } else {, +                    promise.tryFailure(CLOSED_CHANNEL_EXCEPTION);, +                }, +            } else {, +        }, +                    outboundBuffer.fail(NOT_YET_CONNECTED_EXCEPTION);, +                    outboundBuffer.fail(CLOSED_CHANNEL_EXCEPTION);, +            promise.setFailure(CLOSED_CHANNEL_EXCEPTION);]
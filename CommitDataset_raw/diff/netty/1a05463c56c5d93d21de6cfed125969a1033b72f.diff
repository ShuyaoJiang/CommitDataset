[+++ b/handler/src/test/java/io/netty/handler/ssl/SSLEngineTest.java, +            if (!clientHandshakeFinished) {, +                assertEquals(empty.remaining(), clientResult.bytesConsumed());, +                assertEquals(cTOs.position() - cTOsPos,  clientResult.bytesProduced());, +, +                if (isHandshakeFinished(clientResult)) {, +                    clientHandshakeFinished = true;, +                }, +            }, +, +            if (!serverHandshakeFinished) {, +                if (isHandshakeFinished(serverResult)) {, +                    serverHandshakeFinished = true;, +                }, +            }, +, +            if (!clientHandshakeFinished) {, +, +            } else {, +                assertFalse(sTOc.hasRemaining());, +            }, +, +            if (!serverHandshakeFinished) {, +                int serverAppReadBufferPos = serverAppReadBuffer.position();, +                serverResult = serverEngine.unwrap(cTOs, serverAppReadBuffer);, +                runDelegatedTasks(serverResult, serverEngine);, +                assertEquals(cTOs.position() - cTOsPos, serverResult.bytesConsumed());, +                assertEquals(serverAppReadBuffer.position() - serverAppReadBufferPos, serverResult.bytesProduced());, +, +            } else {, +                assertFalse(cTOs.hasRemaining());, +            }, +, +            sTOc.compact();, +            cTOs.compact();]
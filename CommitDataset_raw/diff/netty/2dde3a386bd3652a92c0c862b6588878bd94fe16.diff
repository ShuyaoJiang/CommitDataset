[+++ b/codec-http/src/main/java/io/netty/handler/codec/http/websocketx/WebSocketServerProtocolHandler.java, +import io.netty.channel.Channel;, +            WebSocketServerHandshaker handshaker = getHandshaker(ctx.channel());, +    static WebSocketServerHandshaker getHandshaker(Channel channel) {, +        return channel.attr(HANDSHAKER_ATTR_KEY).get();, +    static void setHandshaker(Channel channel, WebSocketServerHandshaker handshaker) {, +        channel.attr(HANDSHAKER_ATTR_KEY).set(handshaker);, +++ b/codec-http/src/main/java/io/netty/handler/codec/http/websocketx/WebSocketServerProtocolHandler.java, +import io.netty.channel.Channel;, +            WebSocketServerHandshaker handshaker = getHandshaker(ctx.channel());, +    static WebSocketServerHandshaker getHandshaker(Channel channel) {, +        return channel.attr(HANDSHAKER_ATTR_KEY).get();, +    static void setHandshaker(Channel channel, WebSocketServerHandshaker handshaker) {, +        channel.attr(HANDSHAKER_ATTR_KEY).set(handshaker);, +++ b/codec-http/src/main/java/io/netty/handler/codec/http/websocketx/WebSocketServerProtocolHandshakeHandler.java, +                WebSocketServerProtocolHandler.setHandshaker(ctx.channel(), handshaker);, +++ b/codec-http/src/main/java/io/netty/handler/codec/http/websocketx/WebSocketServerProtocolHandler.java, +import io.netty.channel.Channel;, +            WebSocketServerHandshaker handshaker = getHandshaker(ctx.channel());, +    static WebSocketServerHandshaker getHandshaker(Channel channel) {, +        return channel.attr(HANDSHAKER_ATTR_KEY).get();, +    static void setHandshaker(Channel channel, WebSocketServerHandshaker handshaker) {, +        channel.attr(HANDSHAKER_ATTR_KEY).set(handshaker);, +++ b/codec-http/src/main/java/io/netty/handler/codec/http/websocketx/WebSocketServerProtocolHandshakeHandler.java, +                WebSocketServerProtocolHandler.setHandshaker(ctx.channel(), handshaker);, +++ b/codec-http/src/test/java/io/netty/handler/codec/http/websocketx/WebSocketServerProtocolHandlerTest.java, +        assertNotNull(WebSocketServerProtocolHandler.getHandshaker(handshakerCtx.channel()));]
[+++ b/src/main/java/org/jboss/netty/channel/xnio/AbstractXnioChannelHandler.java, +        int writtenBytes = 0;, +                    boolean sent = false;, +                        if (channel instanceof GatheringByteChannel) {, +                            ByteBuffer nioBuf = buf.toByteBuffer(bufIdx, buf.writerIndex() - bufIdx);, +                            int nioBufSize = nioBuf.remaining();, +                            SocketAddress remoteAddress = evt.getRemoteAddress();, +                        } else {, +                            throw new IllegalArgumentException("Unsupported channel type: " + channel.getClass().getName());, +                        }, +                    if (bufIdx == buf.writerIndex() || sent) {, +        if (writtenBytes > 0) {, +        }, +        if (open) {, +            if (addOpWrite && channel instanceof SuspendableWriteChannel) {]
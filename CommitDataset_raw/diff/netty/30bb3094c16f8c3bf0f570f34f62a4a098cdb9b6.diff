[+++ b/buffer/src/test/java/io/netty/buffer/PooledByteBufAllocatorTest.java, +    public void testNumThreadCachesWithNoDirectArenas() throws InterruptedException {, +    private static CountDownLatch createNewThreadCache(final PooledByteBufAllocator allocator), +            throws InterruptedException {, +        final CountDownLatch cacheLatch = new CountDownLatch(1);, +, +                // Countdown the latch after we allocated a buffer. At this point the cache must exists., +                cacheLatch.countDown();, +, +                buf.writeZero(buf.capacity());, +        // Wait until we allocated a buffer and so be sure the thread was started and the cache exists., +        cacheLatch.await();]
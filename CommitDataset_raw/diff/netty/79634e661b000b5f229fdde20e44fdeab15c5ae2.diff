[+++ b/codec-http/src/main/java/io/netty/handler/codec/http/websocketx/WebSocketUtil.java, +import io.netty.util.concurrent.FastThreadLocal;, +, +    private static final FastThreadLocal<MessageDigest> MD5 = new FastThreadLocal<MessageDigest>() {, +        @Override, +        protected MessageDigest initialValue() throws Exception {, +            try {, +                //Try to get a MessageDigest that uses MD5, +                return MessageDigest.getInstance("MD5");, +            } catch (NoSuchAlgorithmException e) {, +                //This shouldn't happen! How old is the computer?, +                throw new InternalError("MD5 not supported on this platform - Outdated?");, +            }, +        }, +    };, +, +    private static final FastThreadLocal<MessageDigest> SHA1 = new FastThreadLocal<MessageDigest>() {, +        @Override, +        protected MessageDigest initialValue() throws Exception {, +            try {, +                //Try to get a MessageDigest that uses SHA1, +                return MessageDigest.getInstance("SHA1");, +            } catch (NoSuchAlgorithmException e) {, +                //This shouldn't happen! How old is the computer?, +                throw new InternalError("SHA-1 not supported on this platform - Outdated?");, +            }, +        }, +    };, +, +        // TODO(normanmaurer): Create md5 method that not need MessageDigest., +        return MD5.get().digest(data);, +        // TODO(normanmaurer): Create sha1 method that not need MessageDigest., +        return SHA1.get().digest(data);]
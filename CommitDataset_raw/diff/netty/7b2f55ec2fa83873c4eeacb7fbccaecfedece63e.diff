[+++ b/codec-http2/src/main/java/io/netty/handler/codec/http2/DefaultHttp2RemoteFlowController.java, +        monitor = listener == null ? new WritabilityMonitor() : new ListenerWritabilityMonitor(listener);, +    private class WritabilityMonitor {, +        private final Writer writer = new StreamByteDistributor.Writer() {, +            @Override, +            public void write(Http2Stream stream, int numBytes) {, +                state(stream).writeAllocatedBytes(numBytes);, +        };, +        ListenerWritabilityMonitor(Listener listener) {, +++ b/codec-http2/src/main/java/io/netty/handler/codec/http2/DefaultHttp2RemoteFlowController.java, +        monitor = listener == null ? new WritabilityMonitor() : new ListenerWritabilityMonitor(listener);, +    private class WritabilityMonitor {, +        private final Writer writer = new StreamByteDistributor.Writer() {, +            @Override, +            public void write(Http2Stream stream, int numBytes) {, +                state(stream).writeAllocatedBytes(numBytes);, +        };, +        ListenerWritabilityMonitor(Listener listener) {, +++ b/codec-http2/src/main/java/io/netty/handler/codec/http2/Http2RemoteFlowController.java, +++ b/codec-http2/src/main/java/io/netty/handler/codec/http2/DefaultHttp2RemoteFlowController.java, +        monitor = listener == null ? new WritabilityMonitor() : new ListenerWritabilityMonitor(listener);, +    private class WritabilityMonitor {, +        private final Writer writer = new StreamByteDistributor.Writer() {, +            @Override, +            public void write(Http2Stream stream, int numBytes) {, +                state(stream).writeAllocatedBytes(numBytes);, +        };, +        ListenerWritabilityMonitor(Listener listener) {, +++ b/codec-http2/src/main/java/io/netty/handler/codec/http2/Http2RemoteFlowController.java, +++ b/codec-http2/src/test/java/io/netty/handler/codec/http2/DefaultHttp2RemoteFlowControllerTest.java]
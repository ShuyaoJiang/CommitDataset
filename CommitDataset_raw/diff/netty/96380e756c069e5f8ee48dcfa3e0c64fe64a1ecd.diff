[+++ b/codec-http/src/main/java/io/netty/handler/codec/http/HttpObjectDecoder.java, +            // Check if the closure of the connection signifies the end of the content., +            if (!prematureClosure) {, +                if (actualContentLength == 0) {, +                    out.add(LastHttpContent.EMPTY_LAST_CONTENT);, +                } else {, +                    out.add(new DefaultLastHttpContent(content));, +                }, +++ b/codec-http/src/main/java/io/netty/handler/codec/http/HttpObjectDecoder.java, +            // Check if the closure of the connection signifies the end of the content., +            if (!prematureClosure) {, +                if (actualContentLength == 0) {, +                    out.add(LastHttpContent.EMPTY_LAST_CONTENT);, +                } else {, +                    out.add(new DefaultLastHttpContent(content));, +                }, +++ b/codec-http/src/test/java/io/netty/handler/codec/http/HttpResponseDecoderTest.java, +    public void testLastResponseWithEmptyHeaderAndEmptyContent() {, +, +    @Test, +    public void testLastResponseWithoutContentLengthHeader() {, +        EmbeddedChannel ch = new EmbeddedChannel(new HttpResponseDecoder());, +        ch.writeInbound(Unpooled.copiedBuffer("HTTP/1.1 200 OK\r\n\r\n", CharsetUtil.US_ASCII));, +, +        HttpResponse res = (HttpResponse) ch.readInbound();, +        assertThat(res.getProtocolVersion(), sameInstance(HttpVersion.HTTP_1_1));, +        assertThat(res.getStatus(), is(HttpResponseStatus.OK));, +        assertThat(ch.readInbound(), is(nullValue()));, +, +        ch.writeInbound(Unpooled.wrappedBuffer(new byte[1024]));, +        HttpContent content = (HttpContent) ch.readInbound();, +        assertThat(content.content().readableBytes(), is(1024));, +, +        assertThat(ch.finish(), is(true));, +, +        LastHttpContent lastContent = (LastHttpContent) ch.readInbound();, +        assertThat(lastContent.content().isReadable(), is(false));, +, +        assertThat(ch.readInbound(), is(nullValue()));, +    }, +++ b/codec-http/src/main/java/io/netty/handler/codec/http/HttpObjectDecoder.java, +            // Check if the closure of the connection signifies the end of the content., +            if (!prematureClosure) {, +                if (actualContentLength == 0) {, +                    out.add(LastHttpContent.EMPTY_LAST_CONTENT);, +                } else {, +                    out.add(new DefaultLastHttpContent(content));, +                }, +++ b/codec-http/src/test/java/io/netty/handler/codec/http/HttpResponseDecoderTest.java, +    public void testLastResponseWithEmptyHeaderAndEmptyContent() {, +, +    @Test, +    public void testLastResponseWithoutContentLengthHeader() {, +        EmbeddedChannel ch = new EmbeddedChannel(new HttpResponseDecoder());, +        ch.writeInbound(Unpooled.copiedBuffer("HTTP/1.1 200 OK\r\n\r\n", CharsetUtil.US_ASCII));, +, +        HttpResponse res = (HttpResponse) ch.readInbound();, +        assertThat(res.getProtocolVersion(), sameInstance(HttpVersion.HTTP_1_1));, +        assertThat(res.getStatus(), is(HttpResponseStatus.OK));, +        assertThat(ch.readInbound(), is(nullValue()));, +, +        ch.writeInbound(Unpooled.wrappedBuffer(new byte[1024]));, +        HttpContent content = (HttpContent) ch.readInbound();, +        assertThat(content.content().readableBytes(), is(1024));, +, +        assertThat(ch.finish(), is(true));, +, +        LastHttpContent lastContent = (LastHttpContent) ch.readInbound();, +        assertThat(lastContent.content().isReadable(), is(false));, +, +        assertThat(ch.readInbound(), is(nullValue()));, +    }, +++ b/transport/src/main/java/io/netty/channel/MessageList.java, +     * Sets the message on the given index., +     */, +    public MessageList<T> set(int index, T value) {, +        checkExclusive(index);, +        if (value == null) {, +            throw new NullPointerException("value");, +        }, +        elements[index] = value;, +        return this;, +    }, +, +    /**, +++ b/codec-http/src/main/java/io/netty/handler/codec/http/HttpObjectDecoder.java, +            // Check if the closure of the connection signifies the end of the content., +            if (!prematureClosure) {, +                if (actualContentLength == 0) {, +                    out.add(LastHttpContent.EMPTY_LAST_CONTENT);, +                } else {, +                    out.add(new DefaultLastHttpContent(content));, +                }, +++ b/codec-http/src/test/java/io/netty/handler/codec/http/HttpResponseDecoderTest.java, +    public void testLastResponseWithEmptyHeaderAndEmptyContent() {, +, +    @Test, +    public void testLastResponseWithoutContentLengthHeader() {, +        EmbeddedChannel ch = new EmbeddedChannel(new HttpResponseDecoder());, +        ch.writeInbound(Unpooled.copiedBuffer("HTTP/1.1 200 OK\r\n\r\n", CharsetUtil.US_ASCII));]
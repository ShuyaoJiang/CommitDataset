[+++ b/codec/src/main/java/io/netty/handler/codec/compression/JZlibDecoder.java, +            final int oldNextInIndex = z.next_in_index;, +            ByteBuf decompressed = ctx.alloc().heapBuffer(inputLength << 1);, +                    decompressed.ensureWritable(z.avail_in << 1);, +                    z.avail_out = decompressed.writableBytes();, +++ b/codec/src/main/java/io/netty/handler/codec/compression/JZlibDecoder.java, +            final int oldNextInIndex = z.next_in_index;, +            ByteBuf decompressed = ctx.alloc().heapBuffer(inputLength << 1);, +                    decompressed.ensureWritable(z.avail_in << 1);, +                    z.avail_out = decompressed.writableBytes();, +++ b/codec/src/main/java/io/netty/handler/codec/compression/JdkZlibDecoder.java, +        ByteBuf decompressed = ctx.alloc().heapBuffer(inflater.getRemaining() << 1);, +                byte[] outArray = decompressed.array();, +                int outputLength = inflater.inflate(outArray, outIndex, decompressed.writableBytes());, +                } else {, +                    decompressed.ensureWritable(inflater.getRemaining() << 1);]
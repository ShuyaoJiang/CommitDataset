[+++ b/codec-http/src/main/java/io/netty/handler/codec/http/websocketx/WebSocketClientHandshaker00.java, +import io.netty.buffer.ByteBuf;, +import io.netty.buffer.Unpooled;, +    private ByteBuf expectedChallengeResponseBytes;, +        expectedChallengeResponseBytes = Unpooled.wrappedBuffer(WebSocketUtil.md5(challenge));, +        ByteBuf challenge = response.data();, +        if (!challenge.equals(expectedChallengeResponseBytes)) {]
[+++ b/buffer/src/main/java/io/netty/buffer/ByteBufUtil.java, +                decodeString(decoder, buffer.internalNioBuffer(0, len), dst);, +++ b/buffer/src/main/java/io/netty/buffer/ByteBufUtil.java, +                decodeString(decoder, buffer.internalNioBuffer(0, len), dst);, +++ b/buffer/src/test/java/io/netty/buffer/ByteBufUtilTest.java, +, +    @Test, +    public void testToStringDoesNotThrowIndexOutOfBounds() {, +        CompositeByteBuf buffer = Unpooled.compositeBuffer();, +        try {, +            byte[] bytes = "1234".getBytes(CharsetUtil.UTF_8);, +            buffer.addComponent(Unpooled.buffer(bytes.length).writeBytes(bytes));, +            buffer.addComponent(Unpooled.buffer(bytes.length).writeBytes(bytes));, +            Assert.assertEquals("1234", buffer.toString(bytes.length, bytes.length, CharsetUtil.UTF_8));, +        } finally {, +            buffer.release();, +        }, +    }]
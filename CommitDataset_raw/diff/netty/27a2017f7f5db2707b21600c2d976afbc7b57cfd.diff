[+++ b/codec/src/main/java/io/netty/handler/codec/DefaultHeaders.java, +    private EntryVisitor<T> setAllVisitor;, +    private EntryVisitor<T> addAllVisitor;, +                headers.forEachEntry(setAllVisitor());, +                headers.forEachEntry(addAllVisitor());, +    /**, +     * Lazy initialization of the visitor which will set all headers., +     */, +    private EntryVisitor<T> setAllVisitor() {, +        if (setAllVisitor == null) {, +            setAllVisitor = new EntryVisitor<T>() {, +                @Override, +                public boolean visit(Entry<T, T> entry) {, +                    set(entry.getKey(), entry.getValue());, +                    return true;, +                }, +            };, +        }, +        return setAllVisitor;, +    }, +, +    /**, +     * Lazy initialization of the visitor which will add all headers., +     */, +    private EntryVisitor<T> addAllVisitor() {, +        if (addAllVisitor == null) {, +            addAllVisitor = new EntryVisitor<T>() {, +                @Override, +                public boolean visit(Entry<T, T> entry) {, +                    add(entry.getKey(), entry.getValue());, +                    return true;, +                }, +            };, +        }, +        return addAllVisitor;, +    }, +]
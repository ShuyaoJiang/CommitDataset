[+++ b/src/main/java/org/jboss/netty/handler/ssl/SslHandler.java, +                packetLength = (getShort(buffer, buffer.readerIndex() + 3) & 0xFFFF) + 5;, +                    packetLength = (getShort(buffer, buffer.readerIndex()) & 0x7FFF) + 2;, +                    packetLength = (getShort(buffer, buffer.readerIndex()) & 0x3FFF) + 3;, +    /**, +     * Reads a big-endian short integer from the buffer.  Please note that we do not use, +     * {@link ChannelBuffer#getShort(int)} because it might be a little-endian buffer., +     */, +    private static short getShort(ChannelBuffer buf, int offset) {, +        return (short) (buf.getByte(offset) << 8 | buf.getByte(offset + 1) & 0xFF);, +    }, +]
[+++ b/codec-dns/src/main/java/io/netty/handler/codec/dns/DefaultDnsRecordEncoder.java, +    private static byte padWithZeros(byte b, int lowOrderBitsToPreserve) {, +            return (byte) (0x80 & b);, +            return (byte) (0xC0 & b);, +            return (byte) (0xE0 & b);, +            return (byte) (0xF0 & b);, +            return (byte) (0xF8 & b);, +            return (byte) (0xFC & b);, +            return (byte) (0xFE & b);, +++ b/codec-dns/src/main/java/io/netty/handler/codec/dns/DefaultDnsRecordEncoder.java, +    private static byte padWithZeros(byte b, int lowOrderBitsToPreserve) {, +            return (byte) (0x80 & b);, +            return (byte) (0xC0 & b);, +            return (byte) (0xE0 & b);, +            return (byte) (0xF0 & b);, +            return (byte) (0xF8 & b);, +            return (byte) (0xFC & b);, +            return (byte) (0xFE & b);, +++ b/codec-dns/src/test/java/io/netty/handler/codec/dns/DefaultDnsRecordEncoderTest.java, +        testOptEcsRecordIp(SocketUtils.addressByName("1.2.3.255"));, +        testOptEcsRecordIp(SocketUtils.addressByName("::FF"));, +            int paddingMask = ~((1 << (8 - lowOrderBitsToPreserve)) - 1);, +            addressPart.setByte(idx, lastByte & paddingMask);]
[+++ b/codec-http/src/main/java/io/netty/handler/codec/http/cookie/CookieUtil.java, +    private static final BitSet VALID_COOKIE_NAME_OCTETS = validCookieNameOctets();, +    // cookie-octet = %x21 / %x23-2B / %x2D-3A / %x3C-5B / %x5D-7E, +        BitSet bits = new BitSet();, +        bits.set(0x21);, +        for (int i = 0x23; i <= 0x2B; i++) {, +        for (int i = 0x2D; i <= 0x3A; i++) {, +            bits.set(i);, +        }, +        for (int i = 0x3C; i <= 0x5B; i++) {, +            bits.set(i);, +        }, +        for (int i = 0x5D; i <= 0x7E; i++) {, +            bits.set(i);, +        }, +    private static BitSet validCookieNameOctets() {, +        BitSet bits = new BitSet();, +        for (int i = 32; i < 127; i++) {, +            bits.set(i);, +        }, +        int[] separators = new int[], +                { '(', ')', '<', '>', '@', ',', ';', ':', '\\', '"', '/', '[', ']', '?', '=', '{', '}', ' ', '\t' };, +        for (int separator : separators) {, +            bits.set(separator, false);, +        }, +++ b/codec-http/src/main/java/io/netty/handler/codec/http/cookie/CookieUtil.java, +    private static final BitSet VALID_COOKIE_NAME_OCTETS = validCookieNameOctets();, +    // cookie-octet = %x21 / %x23-2B / %x2D-3A / %x3C-5B / %x5D-7E, +        BitSet bits = new BitSet();, +        bits.set(0x21);, +        for (int i = 0x23; i <= 0x2B; i++) {, +        for (int i = 0x2D; i <= 0x3A; i++) {, +            bits.set(i);, +        }, +        for (int i = 0x3C; i <= 0x5B; i++) {, +            bits.set(i);, +        }, +        for (int i = 0x5D; i <= 0x7E; i++) {, +            bits.set(i);, +        }, +    private static BitSet validCookieNameOctets() {, +        BitSet bits = new BitSet();, +        for (int i = 32; i < 127; i++) {, +            bits.set(i);, +        }, +        int[] separators = new int[], +                { '(', ')', '<', '>', '@', ',', ';', ':', '\\', '"', '/', '[', ']', '?', '=', '{', '}', ' ', '\t' };, +        for (int separator : separators) {, +            bits.set(separator, false);, +        }, +++ b/codec-http/src/test/java/io/netty/handler/codec/http/cookie/ServerCookieEncoderTest.java, +import java.util.HashSet;, +import java.util.Set;, +    public void illegalCharInCookieValueMakesStrictEncoderThrowsException() {, +, +        Set<Character> illegalChars = new HashSet<Character>();, +        // CTLs, +        for (int i = 0x00; i <= 0x1F; i++) {, +            illegalChars.add((char) i);, +        }, +        illegalChars.add((char) 0x7F);, +        // whitespace, DQUOTE, comma, semicolon, and backslash, +        for (char c : new char[] { ' ', '"', ',', ';', '\\' }) {, +            illegalChars.add(c);, +        }, +, +        int exceptions = 0;, +, +        for (char c : illegalChars) {, +            Cookie cookie = new DefaultCookie("name", "value" + c);, +            try {, +                ServerCookieEncoder.STRICT.encode(cookie);, +            } catch (IllegalArgumentException e) {, +                exceptions++;, +            }, +        }, +, +        assertEquals(illegalChars.size(), exceptions);, +    }, +, +    @Test]
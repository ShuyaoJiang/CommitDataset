[+++ b/buffer/src/main/java/io/netty/buffer/ByteBufAllocator.java, +, +    /**, +     * Returns {@code true} if direct {@link ByteBuf}'s are pooled, +     */, +    boolean isDirectBufferPooled();, +++ b/buffer/src/main/java/io/netty/buffer/ByteBufAllocator.java, +, +    /**, +     * Returns {@code true} if direct {@link ByteBuf}'s are pooled, +     */, +    boolean isDirectBufferPooled();, +++ b/buffer/src/main/java/io/netty/buffer/PooledByteBufAllocator.java, +    @Override, +    public boolean isDirectBufferPooled() {, +        return directArenas != null;, +    }, +, +++ b/buffer/src/main/java/io/netty/buffer/ByteBufAllocator.java, +, +    /**, +     * Returns {@code true} if direct {@link ByteBuf}'s are pooled, +     */, +    boolean isDirectBufferPooled();, +++ b/buffer/src/main/java/io/netty/buffer/PooledByteBufAllocator.java, +    @Override, +    public boolean isDirectBufferPooled() {, +        return directArenas != null;, +    }, +, +++ b/buffer/src/main/java/io/netty/buffer/UnpooledByteBufAllocator.java, +, +    @Override, +    public boolean isDirectBufferPooled() {, +        return false;, +    }, +++ b/buffer/src/main/java/io/netty/buffer/ByteBufAllocator.java, +, +    /**, +     * Returns {@code true} if direct {@link ByteBuf}'s are pooled, +     */, +    boolean isDirectBufferPooled();, +++ b/buffer/src/main/java/io/netty/buffer/PooledByteBufAllocator.java, +    @Override, +    public boolean isDirectBufferPooled() {, +        return directArenas != null;, +    }, +, +++ b/buffer/src/main/java/io/netty/buffer/UnpooledByteBufAllocator.java, +, +    @Override, +    public boolean isDirectBufferPooled() {, +        return false;, +    }, +++ b/transport-sctp/src/main/java/io/netty/channel/sctp/nio/NioSctpChannel.java, +import io.netty.buffer.ByteBufAllocator;, +import io.netty.channel.ChannelOutboundBuffer;, +    protected boolean doWriteMessage(Object msg, ChannelOutboundBuffer in) throws Exception {, +        ByteBufAllocator alloc = alloc();, +        boolean needsCopy = data.nioBufferCount() != 1;, +        if (!needsCopy) {, +            if (!data.isDirect() && alloc.isDirectBufferPooled()) {, +                needsCopy = true;, +            }, +        }, +        if (!needsCopy) {, +            data = alloc.directBuffer(dataLen).writeBytes(data);, +            nioData = data.nioBuffer();, +        boolean done = writtenBytes > 0;, +        if (needsCopy) {, +            if (!done) {, +                in.current(new SctpMessage(mi, data));, +            } else {, +                in.current(data);, +            }, +        }, +        return done;, +++ b/buffer/src/main/java/io/netty/buffer/ByteBufAllocator.java, +, +    /**, +     * Returns {@code true} if direct {@link ByteBuf}'s are pooled, +     */, +    boolean isDirectBufferPooled();, +++ b/buffer/src/main/java/io/netty/buffer/PooledByteBufAllocator.java, +    @Override, +    public boolean isDirectBufferPooled() {, +        return directArenas != null;, +    }, +, +++ b/buffer/src/main/java/io/netty/buffer/UnpooledByteBufAllocator.java, +, +    @Override, +    public boolean isDirectBufferPooled() {, +        return false;, +    }, +++ b/transport-sctp/src/main/java/io/netty/channel/sctp/nio/NioSctpChannel.java, +import io.netty.buffer.ByteBufAllocator;, +import io.netty.channel.ChannelOutboundBuffer;, +    protected boolean doWriteMessage(Object msg, ChannelOutboundBuffer in) throws Exception {, +        ByteBufAllocator alloc = alloc();]
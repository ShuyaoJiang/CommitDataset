[+++ b/handler/src/test/java/io/netty/handler/ssl/SslHandlerTest.java, +import io.netty.channel.ChannelFuture;, +import io.netty.channel.ChannelFutureListener;, +                                private boolean sentData;, +                                private Throwable writeCause;, +, +                                            ctx.writeAndFlush(content).addListener(new ChannelFutureListener() {, +                                                @Override, +                                                public void operationComplete(ChannelFuture future) throws Exception {, +                                                    writeCause = future.cause();, +                                                    if (writeCause == null) {, +                                                        sentData = true;, +                                                    }, +                                                }, +                                            });, +                                    donePromise.tryFailure(new IllegalStateException("server exception sentData: " +, +                                            sentData + " writeCause: " + writeCause, cause));, +                                    donePromise.tryFailure(new IllegalStateException("server closed sentData: " +, +                                            sentData + " writeCause: " + writeCause));, +                                public void userEventTriggered(ChannelHandlerContext ctx, Object evt) {, +                                    if (evt instanceof SslHandshakeCompletionEvent) {, +                                        SslHandshakeCompletionEvent sslEvt = (SslHandshakeCompletionEvent) evt;, +                                        if (!sslEvt.isSuccess()) {, +                                            donePromise.tryFailure(sslEvt.cause());, +                                        }, +                                    }, +                                }, +, +                                @Override, +                                    donePromise.tryFailure(new IllegalStateException("client exception. bytesSeen: " +, +                                                                                     bytesSeen, cause));]
[+++ b/src/main/java/org/jboss/netty/handler/codec/embedder/AbstractCodecEmbedder.java, +import org.jboss.netty.channel.ChannelHandlerContext;, +import org.jboss.netty.channel.ChannelPipelineCoverage;, +import org.jboss.netty.channel.ChannelUpstreamHandler;, +    private final EmbeddedChannelSink sink = new EmbeddedChannelSink();, +, +        pipeline.addLast("LAST", sink);, +        channel = new EmbeddedChannel(pipeline, sink);, +    @ChannelPipelineCoverage("all"), +    private final class EmbeddedChannelSink implements ChannelSink, ChannelUpstreamHandler {, +        public void handleUpstream(ChannelHandlerContext ctx, ChannelEvent e) {, +            handleEvent(e);, +        }, +, +            handleEvent(e);, +        }, +, +        private void handleEvent(ChannelEvent e) {]
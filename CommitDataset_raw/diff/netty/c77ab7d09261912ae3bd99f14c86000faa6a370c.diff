[+++ b/handler/src/main/java/io/netty/handler/ssl/SslHandler.java, +        if (unwrapLater) {, +            unwrap(ctx);, +    private void flushNonAppData0(ChannelHandlerContext ctx, boolean inUnwrap) throws SSLException {, +                    case FINISHED:, +                        setHandshakeSuccess();, +                        break;, +                    case NEED_UNWRAP:, +                        if (!inUnwrap) {, +                            unwrap(ctx);, +                        }, +                        break;, +                    case NEED_WRAP:, +                        break;, +                        if (!inUnwrap) {, +                            unwrap(ctx);, +    private void unwrap(ChannelHandlerContext ctx) throws SSLException {, +        RecyclableArrayList out = RecyclableArrayList.newInstance();, +        try {, +            unwrap(ctx, Unpooled.EMPTY_BUFFER.nioBuffer(), out);, +            for (int i = 0; i < out.size(); i++) {, +                ctx.fireChannelRead(out.get(i));, +            }, +        } finally {, +            out.recycle();, +        }, +    }, +, +                        flushNonAppData0(ctx, true);, +                flush0(ctx);, +            flushNonAppData0(ctx, false);]
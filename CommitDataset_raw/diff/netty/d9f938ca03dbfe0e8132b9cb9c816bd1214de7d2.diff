[+++ b/handler/src/main/java/io/netty/handler/ssl/OpenSsl.java, +import io.netty.buffer.ByteBuf;, +import org.apache.tomcat.jni.Buffer;, +    static long memoryAddress(ByteBuf buf) {, +        assert buf.isDirect();, +        return buf.hasMemoryAddress() ? buf.memoryAddress() : Buffer.address(buf.nioBuffer());, +    }, +, +++ b/handler/src/main/java/io/netty/handler/ssl/OpenSsl.java, +import io.netty.buffer.ByteBuf;, +import org.apache.tomcat.jni.Buffer;, +    static long memoryAddress(ByteBuf buf) {, +        assert buf.isDirect();, +        return buf.hasMemoryAddress() ? buf.memoryAddress() : Buffer.address(buf.nioBuffer());, +    }, +, +++ b/handler/src/main/java/io/netty/handler/ssl/OpenSslContext.java, +        if (SSL.writeToBIO(bio, OpenSsl.memoryAddress(buffer), readable) != readable) {, +++ b/handler/src/main/java/io/netty/handler/ssl/OpenSsl.java, +import io.netty.buffer.ByteBuf;, +import org.apache.tomcat.jni.Buffer;, +    static long memoryAddress(ByteBuf buf) {, +        assert buf.isDirect();, +        return buf.hasMemoryAddress() ? buf.memoryAddress() : Buffer.address(buf.nioBuffer());, +    }, +, +++ b/handler/src/main/java/io/netty/handler/ssl/OpenSslContext.java, +        if (SSL.writeToBIO(bio, OpenSsl.memoryAddress(buffer), readable) != readable) {, +++ b/handler/src/main/java/io/netty/handler/ssl/OpenSslEngine.java, +import static io.netty.handler.ssl.OpenSsl.memoryAddress;]
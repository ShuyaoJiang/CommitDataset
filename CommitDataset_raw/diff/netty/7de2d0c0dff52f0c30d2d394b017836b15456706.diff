[+++ b/src/main/java/org/jboss/netty/handler/ssl/SslHandler.java, +                    boolean outboundDone;, +                    SSLEngineResult result = null;, +                            outboundDone = engine.isOutboundDone();, +                            if (!outboundDone) {, +                        }, +, +                    if (outboundDone) {, +                        success = false;, +                        break;, +                    } else if (result.bytesProduced() > 0) {, +                IllegalStateException cause =, +                    new IllegalStateException("SSLEngine already closed");, +                    pendingWrite.future.setFailure(cause);, +                    if (engine.isOutboundDone()) {, +                        break;, +                    }, +, +                    boolean inboundDone = engine.isInboundDone();, +                    if (inboundDone) {, +                        break;, +                    }, +, +                        !inboundDone && !engine.isOutboundDone()) {]
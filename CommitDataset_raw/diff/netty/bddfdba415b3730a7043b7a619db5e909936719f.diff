[+++ b/src/main/java/org/jboss/netty/channel/socket/nio/NioWorker.java, +        final ByteBuffer directBuffer;, +        final boolean fromPool;, +        if (buffer.isDirect()) {, +            directBuffer = buffer.toByteBuffer();, +            fromPool = false;, +        } else {, +            directBuffer = directBufferPool.acquire(buffer.writableBytes());, +            fromPool = true;, +        }, +        , +            while ((ret = ch.read(directBuffer)) > 0) {, +                if (!directBuffer.hasRemaining()) {, +            directBuffer.flip();, +            buffer.writeBytes(directBuffer);, +        } finally {, +            if (fromPool) {, +                directBufferPool.release(directBuffer);, +            }]
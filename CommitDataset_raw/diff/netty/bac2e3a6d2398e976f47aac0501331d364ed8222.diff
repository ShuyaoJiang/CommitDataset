[+++ b/handler/src/main/java/io/netty/handler/timeout/IdleStateHandler.java, +    // Not create a new ChannelFutureListener per write operation to reduce GC pressure., +    private final ChannelFutureListener writeListener = new ChannelFutureListener() {, +        @Override, +        public void operationComplete(ChannelFuture future) throws Exception {, +            lastWriteTime = System.nanoTime();, +            firstWriterIdleEvent = firstAllIdleEvent = true;, +        }, +    };, +, +    private volatile boolean reading;, +        if (readerIdleTimeNanos > 0 || allIdleTimeNanos > 0) {, +            reading = true;, +        }, +    public void channelReadComplete(ChannelHandlerContext ctx) throws Exception {, +        if (readerIdleTimeNanos > 0 || allIdleTimeNanos > 0) {, +            lastReadTime = System.nanoTime();, +            reading = false;, +        }, +        ctx.fireChannelReadComplete();, +    }, +, +    @Override, +            unvoid.addListener(writeListener);, +            long nextDelay = readerIdleTimeNanos;, +            if (!reading) {, +                nextDelay -= System.nanoTime() - lastReadTime;, +            }, +, +            long nextDelay = writerIdleTimeNanos - (System.nanoTime() - lastWriteTime);, +            long nextDelay = allIdleTimeNanos;, +            if (!reading) {, +                nextDelay -= System.nanoTime() - Math.max(lastReadTime, lastWriteTime);, +            }]
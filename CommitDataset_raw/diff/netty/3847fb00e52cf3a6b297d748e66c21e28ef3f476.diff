[+++ b/src/main/java/org/jboss/netty/channel/AbstractChannel.java, +    private final Integer id;, +, +        id = allocateId(this);, +, +        pipeline.attach(this, sink);, +    }, +, +    /**, +     * (Internal use only) Creates a new temporary instance with the specified, +     * ID., +     *, +     * @param parent, +     *        the parent of this channel. {@code null} if there's no parent., +     * @param factory, +     *        the factory which created this channel, +     * @param pipeline, +     *        the pipeline which is going to be attached to this channel, +     * @param sink, +     *        the sink which will receive downstream events from the pipeline, +     *        and send upstream events to the pipeline, +     */, +    protected AbstractChannel(, +            Integer id,, +            Channel parent, ChannelFactory factory,, +            ChannelPipeline pipeline, ChannelSink sink) {, +, +        this.id = id;, +        this.parent = parent;, +        this.factory = factory;, +        this.pipeline = pipeline;, +++ b/src/main/java/org/jboss/netty/channel/AbstractChannel.java, +    private final Integer id;, +, +        id = allocateId(this);, +, +        pipeline.attach(this, sink);, +    }, +, +    /**, +     * (Internal use only) Creates a new temporary instance with the specified, +     * ID., +     *, +     * @param parent, +     *        the parent of this channel. {@code null} if there's no parent., +     * @param factory, +     *        the factory which created this channel, +     * @param pipeline, +     *        the pipeline which is going to be attached to this channel, +     * @param sink, +     *        the sink which will receive downstream events from the pipeline, +     *        and send upstream events to the pipeline, +     */, +    protected AbstractChannel(, +            Integer id,, +            Channel parent, ChannelFactory factory,, +            ChannelPipeline pipeline, ChannelSink sink) {, +, +        this.id = id;, +        this.parent = parent;, +        this.factory = factory;, +        this.pipeline = pipeline;, +++ b/src/main/java/org/jboss/netty/handler/codec/embedder/EmbeddedChannel.java, + * TODO Make EmbeddedChannel implement ChannelConfig and ChannelSink to reduce overhead., + * TODO Do not extend AbstractChannel to reduce overhead and remove the internal-use-only constructor in AbstractChannel., + *, +    private static final Integer DUMMY_ID = Integer.valueOf(0);, +, +        super(DUMMY_ID, null, EmbeddedChannelFactory.INSTANCE, pipeline, sink);]
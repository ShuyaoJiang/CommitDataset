[+++ b/codec/src/main/java/io/netty/handler/codec/compression/JdkZlibEncoder.java, +        for (;;) {, +            if (deflater.needsInput()) {, +                // Consumed everything, +                break;, +            } else {, +                if (!out.isWritable()) {, +                    // We did not consume everything but the buffer is not writable anymore. Increase the capacity to, +                    // make more room., +                    out.ensureWritable(out.writerIndex());, +                }, +            }]
[+++ b/codec/src/main/java/io/netty/handler/codec/ByteToMessageDecoder.java, +                    if (cumulation.writerIndex() > cumulation.maxCapacity() - data.readableBytes(), +                            || cumulation.refCnt() > 1) {, +                        // Expand cumulation (by replace it) when either there is not more room in the buffer, +                        // or if the refCnt is greater then 1 which may happen when the user use slice().retain() or, +                        // duplicate().retain()., +                        //, +                        // See:, +                        // - https://github.com/netty/netty/issues/2327, +                        // - https://github.com/netty/netty/issues/1764, +        if (cumulation != null && !first && cumulation.refCnt() == 1) {, +            // buffer but only if the refCnt == 1  as otherwise the user may have, +            // used slice().retain() or duplicate().retain()., +            //, +            // See:, +            // - https://github.com/netty/netty/issues/2327, +            // - https://github.com/netty/netty/issues/1764]
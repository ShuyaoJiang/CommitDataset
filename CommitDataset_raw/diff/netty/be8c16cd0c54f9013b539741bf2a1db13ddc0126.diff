[+++ b/handler/src/main/java/io/netty/handler/ssl/ReferenceCountedOpenSslServerContext.java, +, +                X509Certificate[] issuers = manager.getAcceptedIssuers();, +                if (issuers != null && issuers.length > 0) {, +                    long bio = 0;, +                    try {, +                        bio = toBIO(issuers);, +                        if (!SSLContext.setCACertificateBio(ctx, bio)) {, +                            throw new SSLException("unable to setup accepted issuers for trustmanager " + manager);, +                        }, +                    } finally {, +                        freeBio(bio);, +                    }, +                }, +            } catch (SSLException e) {, +                throw e;, +++ b/handler/src/main/java/io/netty/handler/ssl/ReferenceCountedOpenSslServerContext.java, +, +                X509Certificate[] issuers = manager.getAcceptedIssuers();, +                if (issuers != null && issuers.length > 0) {, +                    long bio = 0;, +                    try {, +                        bio = toBIO(issuers);, +                        if (!SSLContext.setCACertificateBio(ctx, bio)) {, +                            throw new SSLException("unable to setup accepted issuers for trustmanager " + manager);, +                        }, +                    } finally {, +                        freeBio(bio);, +                    }, +                }, +            } catch (SSLException e) {, +                throw e;, +++ b/handler/src/test/java/io/netty/handler/ssl/RenegotiateTest.java, +    @Test(timeout = 30000), +++ b/handler/src/main/java/io/netty/handler/ssl/ReferenceCountedOpenSslServerContext.java, +, +                X509Certificate[] issuers = manager.getAcceptedIssuers();, +                if (issuers != null && issuers.length > 0) {, +                    long bio = 0;, +                    try {, +                        bio = toBIO(issuers);, +                        if (!SSLContext.setCACertificateBio(ctx, bio)) {, +                            throw new SSLException("unable to setup accepted issuers for trustmanager " + manager);, +                        }, +                    } finally {, +                        freeBio(bio);, +                    }, +                }, +            } catch (SSLException e) {, +                throw e;, +++ b/handler/src/test/java/io/netty/handler/ssl/RenegotiateTest.java, +    @Test(timeout = 30000), +++ b/handler/src/test/java/io/netty/handler/ssl/SSLEngineTest.java, +    @Test(timeout = 30000), +    @Test(timeout = 30000), +++ b/handler/src/main/java/io/netty/handler/ssl/ReferenceCountedOpenSslServerContext.java, +, +                X509Certificate[] issuers = manager.getAcceptedIssuers();, +                if (issuers != null && issuers.length > 0) {, +                    long bio = 0;, +                    try {, +                        bio = toBIO(issuers);, +                        if (!SSLContext.setCACertificateBio(ctx, bio)) {, +                            throw new SSLException("unable to setup accepted issuers for trustmanager " + manager);, +                        }, +                    } finally {, +                        freeBio(bio);, +                    }, +                }, +            } catch (SSLException e) {, +                throw e;, +++ b/handler/src/test/java/io/netty/handler/ssl/RenegotiateTest.java, +    @Test(timeout = 30000), +++ b/handler/src/test/java/io/netty/handler/ssl/SSLEngineTest.java, +    @Test(timeout = 30000), +    @Test(timeout = 30000), +++ b/handler/src/test/java/io/netty/handler/ssl/SniClientTest.java, +    @Test(timeout = 30000), +    @Test(timeout = 30000), +    @Test(timeout = 30000), +    @Test(timeout = 30000), +++ b/handler/src/main/java/io/netty/handler/ssl/ReferenceCountedOpenSslServerContext.java, +, +                X509Certificate[] issuers = manager.getAcceptedIssuers();, +                if (issuers != null && issuers.length > 0) {, +                    long bio = 0;, +                    try {, +                        bio = toBIO(issuers);, +                        if (!SSLContext.setCACertificateBio(ctx, bio)) {, +                            throw new SSLException("unable to setup accepted issuers for trustmanager " + manager);, +                        }, +                    } finally {, +                        freeBio(bio);, +                    }, +                }, +            } catch (SSLException e) {, +                throw e;, +++ b/handler/src/test/java/io/netty/handler/ssl/RenegotiateTest.java, +    @Test(timeout = 30000), +++ b/handler/src/test/java/io/netty/handler/ssl/SSLEngineTest.java]
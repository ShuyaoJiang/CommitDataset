[+++ b/codec-http/src/main/java/io/netty/handler/codec/http/websocketx/WebSocketFrameAggregator.java, +    private boolean tooLongFrameFound;, +            tooLongFrameFound = false;, +            if (tooLongFrameFound) {, +                if (msg.isFinalFragment()) {, +                    currentFrame = null;, +                }, +                return;, +            }, +                tooLongFrameFound = true;, +++ b/codec-http/src/main/java/io/netty/handler/codec/http/websocketx/WebSocketFrameAggregator.java, +    private boolean tooLongFrameFound;, +            tooLongFrameFound = false;, +            if (tooLongFrameFound) {, +                if (msg.isFinalFragment()) {, +                    currentFrame = null;, +                }, +                return;, +            }, +                tooLongFrameFound = true;, +++ b/codec-http/src/test/java/io/netty/handler/codec/http/websocketx/WebSocketFrameAggregatorTest.java, +    @Test, +        try {, +            Assert.fail();, +        } catch (TooLongFrameException e) {, +            // expected, +        }, +        channel.writeInbound(new ContinuationWebSocketFrame(false, 0, content2.copy()));, +        channel.writeInbound(new ContinuationWebSocketFrame(true, 0, content2.copy()));, +, +        channel.writeInbound(new BinaryWebSocketFrame(true, 1, content1.copy()));, +        channel.writeInbound(new BinaryWebSocketFrame(false, 0, content1.copy()));, +        try {, +            channel.writeInbound(new ContinuationWebSocketFrame(false, 0, content2.copy()));, +            Assert.fail();, +        } catch (TooLongFrameException e) {, +            // expected, +        }, +        channel.writeInbound(new ContinuationWebSocketFrame(false, 0, content2.copy()));, +        channel.writeInbound(new ContinuationWebSocketFrame(true, 0, content2.copy()));]
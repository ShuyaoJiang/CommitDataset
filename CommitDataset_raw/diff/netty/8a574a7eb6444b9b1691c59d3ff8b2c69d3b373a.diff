[+++ b/src/main/java/org/jboss/netty/buffer/ChannelBuffers.java, +        return copiedBuffer(BIG_ENDIAN, string, charset);, +        if (string == null) {, +            throw new NullPointerException("string");, +        }, +, +        if (string instanceof CharBuffer) {, +            return copiedBuffer(endianness, (CharBuffer) string, charset);, +        }, +, +        return copiedBuffer(endianness, CharBuffer.wrap(string), charset);, +, +        if (string instanceof CharBuffer) {, +            CharBuffer buf = (CharBuffer) string;, +            if (buf.hasArray()) {, +                return copiedBuffer(, +                        endianness,, +                        buf.array(),, +                        buf.arrayOffset() + buf.position() + offset,, +                        length, charset);, +            }, +, +            buf = buf.slice();, +            buf.limit(length);, +            buf.position(offset);, +            return copiedBuffer(endianness, buf, charset);, +        }, +, +    private static ChannelBuffer copiedBuffer(ByteOrder endianness, CharBuffer buffer, Charset charset) {, +]
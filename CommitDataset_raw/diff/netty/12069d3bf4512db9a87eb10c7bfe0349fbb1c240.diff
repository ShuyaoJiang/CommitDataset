[+++ b/handler/src/main/java/io/netty/handler/stream/ChunkedWriteHandler.java, +import java.util.LinkedList;, +    private final Queue<Object> queue = new LinkedList<Object>();, +        final ChannelHandlerContext ctx = this.ctx;, +        if (ctx.executor().inEventLoop()) {, +                doFlush(ctx);, +        } else {, +            // let the transfer resume on the next event loop round, +            ctx.executor().execute(new Runnable() {, +                , +                @Override, +                public void run() {, +                    try {, +                        doFlush(ctx);, +                    } catch (Exception e) {, +                        if (logger.isWarnEnabled()) {, +                            logger.warn("Unexpected exception while sending chunks.", e);, +                        }, +                    }                    , +                }, +            });, +        }, +            doFlush(ctx);, +        doFlush(ctx);, +    private void doFlush(final ChannelHandlerContext ctx) throws Exception {, +   , +        doFlush(ctx);]
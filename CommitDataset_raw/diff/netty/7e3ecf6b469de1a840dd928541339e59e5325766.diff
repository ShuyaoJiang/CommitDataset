[+++ b/src/main/java/org/jboss/netty/handler/ssl/SslHandler.java, +                        wrapNonAppData(ctx, channel);, +                // wrap() acquires pendingUnencryptedWrites first and then, +                // handshakeLock.  If handshakeLock is already hold by the, +                // current thread, calling wrap() will lead to a dead lock., +                if (!Thread.holdsLock(handshakeLock)) {, +            }]
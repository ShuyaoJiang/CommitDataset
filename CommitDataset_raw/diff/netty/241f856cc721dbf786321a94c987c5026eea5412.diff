[+++ b/transport/src/main/java/io/netty/channel/AbstractChannel.java, +                    closeFuture.setClosed();, +                closeFuture.setClosed();, +            if (closeFuture.isSuccess()) {, +                // Closed already., +                promise.setSuccess();, +            }, +, +                closeFuture.setClosed();, +++ b/transport/src/main/java/io/netty/channel/AbstractChannel.java, +                    closeFuture.setClosed();, +                closeFuture.setClosed();, +            if (closeFuture.isSuccess()) {, +                // Closed already., +                promise.setSuccess();, +            }, +, +                closeFuture.setClosed();, +++ b/transport/src/main/java/io/netty/channel/local/LocalChannel.java, +    protected void doClose() throws Exception {, +++ b/transport/src/main/java/io/netty/channel/AbstractChannel.java, +                    closeFuture.setClosed();, +                closeFuture.setClosed();, +            if (closeFuture.isSuccess()) {, +                // Closed already., +                promise.setSuccess();, +            }, +, +                closeFuture.setClosed();, +++ b/transport/src/main/java/io/netty/channel/local/LocalChannel.java, +    protected void doClose() throws Exception {, +++ b/transport/src/main/java/io/netty/channel/local/LocalServerChannel.java, +    protected void doClose() throws Exception {]
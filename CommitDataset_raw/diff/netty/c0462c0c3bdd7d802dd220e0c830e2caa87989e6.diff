[+++ b/buffer/src/main/java/io/netty/buffer/PoolChunk.java, +    private final byte[] memoryMap;, +    private final byte[] depthMap;, +        memoryMap = new byte[maxSubpageAllocs << 1];, +        depthMap = new byte[memoryMap.length];, +                memoryMap[memoryMapIndex] = (byte) d;, +                depthMap[memoryMapIndex] = (byte) d;, +                memoryMapIndex ++;, +        depthMap = null;, +        final int freeBytes = this.freeBytes;, +        int d = maxOrder - (log2(normCapacity) - pageShifts);, +, +        final PoolSubpage<T>[] subpages = this.subpages;, +        final int pageSize = this.pageSize;, +, +        return memoryMap[id];, +        memoryMap[id] = val;, +        return depthMap[id];]
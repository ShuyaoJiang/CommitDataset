[+++ b/codec-http/src/main/java/io/netty/handler/codec/spdy/SpdyFrameEncoder.java, +               msg instanceof SpdyHeadersFrame ||, +               msg instanceof SpdyPingFrame;, +++ b/codec-http/src/main/java/io/netty/handler/codec/spdy/SpdyFrameEncoder.java, +               msg instanceof SpdyHeadersFrame ||, +               msg instanceof SpdyPingFrame;, +++ b/codec/src/main/java/io/netty/handler/codec/CodecUtil.java, +import io.netty.channel.NoSuchBufferException;, +            try {, +                ctx.nextInboundMessageBuffer().add(msg);, +            } catch (NoSuchBufferException e) {, +                if (msg instanceof ChannelBuffer) {, +            try {, +                ctx.nextOutboundMessageBuffer().add(msg);, +            } catch (NoSuchBufferException e) {, +                if (msg instanceof ChannelBuffer) {, +        throw new NoSuchBufferException();, +++ b/codec-http/src/main/java/io/netty/handler/codec/spdy/SpdyFrameEncoder.java, +               msg instanceof SpdyHeadersFrame ||, +               msg instanceof SpdyPingFrame;, +++ b/codec/src/main/java/io/netty/handler/codec/CodecUtil.java, +import io.netty.channel.NoSuchBufferException;, +            try {, +                ctx.nextInboundMessageBuffer().add(msg);, +            } catch (NoSuchBufferException e) {, +                if (msg instanceof ChannelBuffer) {, +            try {, +                ctx.nextOutboundMessageBuffer().add(msg);, +            } catch (NoSuchBufferException e) {, +                if (msg instanceof ChannelBuffer) {, +        throw new NoSuchBufferException();, +++ b/codec/src/main/java/io/netty/handler/codec/embedder/EmbeddedChannel.java, +import io.netty.buffer.ChannelBuffers;, +        firstOut = ChannelBufferHolders.catchAllBuffer(productQueue, ChannelBuffers.dynamicBuffer());, +        // We do nothing for message buffer because it's actually productQueue., +++ b/codec-http/src/main/java/io/netty/handler/codec/spdy/SpdyFrameEncoder.java, +               msg instanceof SpdyHeadersFrame ||, +               msg instanceof SpdyPingFrame;, +++ b/codec/src/main/java/io/netty/handler/codec/CodecUtil.java, +import io.netty.channel.NoSuchBufferException;, +            try {, +                ctx.nextInboundMessageBuffer().add(msg);, +            } catch (NoSuchBufferException e) {, +                if (msg instanceof ChannelBuffer) {, +            try {, +                ctx.nextOutboundMessageBuffer().add(msg);, +            } catch (NoSuchBufferException e) {, +                if (msg instanceof ChannelBuffer) {, +        throw new NoSuchBufferException();, +++ b/codec/src/main/java/io/netty/handler/codec/embedder/EmbeddedChannel.java, +import io.netty.buffer.ChannelBuffers;, +        firstOut = ChannelBufferHolders.catchAllBuffer(productQueue, ChannelBuffers.dynamicBuffer());, +        // We do nothing for message buffer because it's actually productQueue., +++ b/transport/src/main/java/io/netty/channel/ChannelBufferHolder.java, +            // XXX: Should we introduce hasNext(Inbound|Outbound)(Message|Byte)Buffer(), +            //      just because of this?, +            try {, +                ctx.nextInboundMessageBuffer();, +                return true;, +            } catch (NoSuchBufferException e) {, +                return false;, +            }, +            try {, +                ctx.nextOutboundMessageBuffer();, +                return true;, +            } catch (NoSuchBufferException e) {, +                return false;, +            }, +            try {, +                ctx.nextInboundByteBuffer();, +                return true;, +            } catch (NoSuchBufferException e) {, +                return false;, +            }, +            try {, +                ctx.nextOutboundByteBuffer();, +                return true;, +            } catch (NoSuchBufferException e) {, +                return false;, +            }, +                throw new NoSuchBufferException();, +                throw new NoSuchBufferException();, +++ b/codec-http/src/main/java/io/netty/handler/codec/spdy/SpdyFrameEncoder.java, +               msg instanceof SpdyHeadersFrame ||, +               msg instanceof SpdyPingFrame;, +++ b/codec/src/main/java/io/netty/handler/codec/CodecUtil.java, +import io.netty.channel.NoSuchBufferException;, +            try {, +                ctx.nextInboundMessageBuffer().add(msg);, +            } catch (NoSuchBufferException e) {, +                if (msg instanceof ChannelBuffer) {, +            try {, +                ctx.nextOutboundMessageBuffer().add(msg);, +            } catch (NoSuchBufferException e) {, +                if (msg instanceof ChannelBuffer) {, +        throw new NoSuchBufferException();, +++ b/codec/src/main/java/io/netty/handler/codec/embedder/EmbeddedChannel.java, +import io.netty.buffer.ChannelBuffers;, +        firstOut = ChannelBufferHolders.catchAllBuffer(productQueue, ChannelBuffers.dynamicBuffer());, +        // We do nothing for message buffer because it's actually productQueue.]
[+++ b/src/main/java/org/jboss/netty/channel/socket/nio/NioSocketChannel.java, +import java.util.LinkedList;, +import java.util.concurrent.BlockingQueue;, +    final BlockingQueue<MessageEvent> writeBuffer =, +        new LinkedBlockingQueue<MessageEvent>();, +    final Queue<MessageEvent> internalWriteBuffer =, +        new LinkedList<MessageEvent>();, +++ b/src/main/java/org/jboss/netty/channel/socket/nio/NioSocketChannel.java, +import java.util.LinkedList;, +import java.util.concurrent.BlockingQueue;, +    final BlockingQueue<MessageEvent> writeBuffer =, +        new LinkedBlockingQueue<MessageEvent>();, +    final Queue<MessageEvent> internalWriteBuffer =, +        new LinkedList<MessageEvent>();, +++ b/src/main/java/org/jboss/netty/channel/socket/nio/NioWorker.java, +        Queue<MessageEvent> internalWriteBuffer = channel.internalWriteBuffer;, +        synchronized (internalWriteBuffer) {, +            if (internalWriteBuffer.isEmpty()) {, +                channel.writeBuffer.drainTo(internalWriteBuffer);, +            }, +, +                    evt = internalWriteBuffer.poll();, +        Queue<MessageEvent> internalWriteBuffer = channel.internalWriteBuffer;, +        int writtenBytes = 0;, +        synchronized (internalWriteBuffer) {, +            if (internalWriteBuffer.isEmpty()) {, +                channel.writeBuffer.drainTo(internalWriteBuffer);, +            }, +, +                    evt = internalWriteBuffer.poll();, +        Queue<MessageEvent> internalWriteBuffer = channel.internalWriteBuffer;, +        synchronized (internalWriteBuffer) {, +            if (internalWriteBuffer.isEmpty()) {, +                channel.writeBuffer.drainTo(internalWriteBuffer);, +            }, +, +                evt = internalWriteBuffer.poll();]
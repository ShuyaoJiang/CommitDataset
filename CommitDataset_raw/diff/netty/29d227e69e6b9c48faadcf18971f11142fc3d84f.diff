[+++ b/src/main/java/org/jboss/netty/channel/AbstractChannelFactory.java, +    void notifyState(Channel channel) {, +        TrafficMonitor[] trafficMonitors = this.trafficMonitors;, +        for (TrafficMonitor m: trafficMonitors) {, +            try {, +                m.onState(channel);, +            } catch (Exception e) {, +                logger.warn(, +                        "An exception was thrown by " +, +                        TrafficMonitor.class.getSimpleName() +, +                        ".onState().", e);, +            }, +        }, +    }, +, +++ b/src/main/java/org/jboss/netty/channel/AbstractChannelFactory.java, +    void notifyState(Channel channel) {, +        TrafficMonitor[] trafficMonitors = this.trafficMonitors;, +        for (TrafficMonitor m: trafficMonitors) {, +            try {, +                m.onState(channel);, +            } catch (Exception e) {, +                logger.warn(, +                        "An exception was thrown by " +, +                        TrafficMonitor.class.getSimpleName() +, +                        ".onState().", e);, +            }, +        }, +    }, +, +++ b/src/main/java/org/jboss/netty/channel/Channels.java, +        notifyState(channel);, +        notifyState(channel);, +    private static void notifyState(Channel channel) {, +        ChannelFactory factory = channel.getFactory();, +        if (factory instanceof AbstractChannelFactory) {, +            ((AbstractChannelFactory) factory).notifyState(channel);, +        }, +    }, +, +++ b/src/main/java/org/jboss/netty/channel/AbstractChannelFactory.java, +    void notifyState(Channel channel) {, +        TrafficMonitor[] trafficMonitors = this.trafficMonitors;, +        for (TrafficMonitor m: trafficMonitors) {, +            try {, +                m.onState(channel);, +            } catch (Exception e) {, +                logger.warn(, +                        "An exception was thrown by " +, +                        TrafficMonitor.class.getSimpleName() +, +                        ".onState().", e);, +            }, +        }, +    }, +, +++ b/src/main/java/org/jboss/netty/channel/Channels.java, +        notifyState(channel);, +        notifyState(channel);, +    private static void notifyState(Channel channel) {, +        ChannelFactory factory = channel.getFactory();, +        if (factory instanceof AbstractChannelFactory) {, +            ((AbstractChannelFactory) factory).notifyState(channel);, +        }, +    }, +, +++ b/src/main/java/org/jboss/netty/channel/TrafficMonitor.java, +    void onState(Channel channel) throws Exception;]
[+++ b/codec/src/main/java/io/netty/handler/codec/xml/XmlFrameDecoder.java, +                        // found </, we must check if it is enclosed, +                        int peekFurtherAheadIndex = i + 2;, +                        while (peekFurtherAheadIndex <= bufferLength - 1) {, +                            //if we have </ and enclosing > we can decrement openBracketsCount, +                            if (in.getByte(peekFurtherAheadIndex) == '>') {, +                                break;, +                            }, +                            peekFurtherAheadIndex++;, +                        }, +        int xmlElementLength = length - readerIndex;, +        if (openBracketsCount == 0 && xmlElementLength > 0) {, +            if (readerIndex + xmlElementLength >= bufferLength) {, +                xmlElementLength = in.readableBytes();, +                    extractFrame(in, readerIndex + leadingWhiteSpaceCount, xmlElementLength - leadingWhiteSpaceCount);, +            in.skipBytes(xmlElementLength);, +++ b/codec/src/main/java/io/netty/handler/codec/xml/XmlFrameDecoder.java, +                        // found </, we must check if it is enclosed, +                        int peekFurtherAheadIndex = i + 2;, +                        while (peekFurtherAheadIndex <= bufferLength - 1) {, +                            //if we have </ and enclosing > we can decrement openBracketsCount, +                            if (in.getByte(peekFurtherAheadIndex) == '>') {, +                                break;, +                            }, +                            peekFurtherAheadIndex++;, +                        }, +        int xmlElementLength = length - readerIndex;, +        if (openBracketsCount == 0 && xmlElementLength > 0) {, +            if (readerIndex + xmlElementLength >= bufferLength) {, +                xmlElementLength = in.readableBytes();, +                    extractFrame(in, readerIndex + leadingWhiteSpaceCount, xmlElementLength - leadingWhiteSpaceCount);, +            in.skipBytes(xmlElementLength);, +++ b/codec/src/test/java/io/netty/handler/codec/xml/XmlFrameDecoderTest.java, +    public void testDecodeInvalidXml() {, +        testDecodeWithXml("<a></", new Object[0]);, +        testDecodeWithXml("<a></a", new Object[0]);, +    }, +, +    @Test, +    public void testDecodeWithMultipleMessages() {, +                "msgnr=\"2\"/>\n</root>" +, +                "<root xmlns=\"http://www.acme.com/acme\" status=\"logout\" timestamp=\"1362410584795\"/>";, +        final String frame3 = "<root xmlns=\"http://www.acme.com/acme\" status=\"logout\" " +, +                "timestamp=\"1362410584795\"/>";, +        testDecodeWithXml(input, frame1, frame2, frame3);]
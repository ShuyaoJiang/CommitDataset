[+++ b/src/main/java/org/jboss/netty/util/FastQueue.java, +import java.util.LinkedList;, +import java.util.Queue;, +, +    private Queue<E> offeredElements;, +    private Queue<E> drainedElements;, +        if (offeredElements == null) {, +            offeredElements = new LinkedList<E>();, +        offeredElements.offer(e);, +                    drainedElements = offeredElements;, +                    if (offeredElements == null) {, +                    offeredElements = null;, +            E e = cast(drainedElements.poll());, +            if (e != null) {, +                return e;]
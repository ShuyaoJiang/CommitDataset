[+++ b/transport/src/main/java/io/netty/channel/DefaultChannelHandlerInvoker.java, +import io.netty.util.internal.SystemPropertyUtil;, +        private static final boolean ESTIMATE_TASK_SIZE_ON_SUBMIT =, +                SystemPropertyUtil.getBoolean("io.netty.transport.estimateSizeOnSubmit", true);, +        // Assuming a 64-bit JVM, 16 bytes object header, 3 reference fields and one int field, plus alignment, +        private static final int WRITE_TASK_OVERHEAD =, +                SystemPropertyUtil.getInt("io.netty.transport.writeTaskSizeOverhead", 48);, +, +            if (ESTIMATE_TASK_SIZE_ON_SUBMIT) {, +, +                    task.size = ((AbstractChannel) ctx.channel()).estimatorHandle().size(msg) + WRITE_TASK_OVERHEAD;, +                } else {, +                    task.size = 0;, +            } else {, +                task.size = 0;, +            }, +, +                if (ESTIMATE_TASK_SIZE_ON_SUBMIT && buffer != null) {]
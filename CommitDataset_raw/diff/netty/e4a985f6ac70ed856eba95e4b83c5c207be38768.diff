[+++ b/transport/src/main/java/io/netty/channel/MessageList.java, +import java.util.ConcurrentModificationException;, +import java.util.Iterator;, +public final class MessageList<T> implements Iterable<T> {, +    private int modifications;, +        ret.modifications = 0;, +        modifications++;, +        modifications++;, +        modifications++;, +    @Override, +    public Iterator<T> iterator() {, +        return new MessageListIterator();, +    }, +, +, +    private final class MessageListIterator implements Iterator<T> {, +        private int index;, +        private int expectedModifications = modifications;, +, +        private void checkConcurrentModifications() {, +            if (expectedModifications != modifications) {, +                throw new ConcurrentModificationException();, +            }, +            if (index > size) {, +                throw new ConcurrentModificationException();, +            }, +        }, +, +        @Override, +        public boolean hasNext() {, +            return index < size;, +        }, +, +        @Override, +        public T next() {, +            checkConcurrentModifications();, +            if (hasNext()) {, +                return elements[index++];, +            }, +            throw new UnsupportedOperationException();, +        }, +, +        @Override, +        public void remove() {, +           throw new UnsupportedOperationException("Read-Only");, +        }, +    }]
[+++ b/codec/src/main/java/io/netty/handler/codec/ByteToMessageDecoder.java, +    private int discardAfterReads = 16;, +    private int numReads;, +     * Set the number of reads after which {@link ByteBuf#discardSomeReadBytes()} are called and so free up memory., +     * The default is {@code 16}., +     */, +    public void setDiscardAfterReads(int discardAfterReads) {, +        if (discardAfterReads <= 0) {, +            throw new IllegalArgumentException("discardAfterReads must be > 0");, +        }, +        this.discardAfterReads = discardAfterReads;, +    }, +, +    /**, +        numReads = 0;, +                    numReads = 0;, +                } else if (++ numReads >= discardAfterReads) {, +                    // We did enough reads already try to discard some bytes so we not risk to see a OOME., +                    // See https://github.com/netty/netty/issues/4275, +                    numReads = 0;, +                    discardSomeReadBytes();, +, +        numReads = 0;]
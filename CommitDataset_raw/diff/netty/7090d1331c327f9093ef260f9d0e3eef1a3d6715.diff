[+++ b/handler/src/main/java/io/netty/handler/ssl/OpenSslEngine.java, +                // Clear out options which disable protocols, +                SSL.clearOptions(ssl, SSL.SSL_OP_NO_SSLv2 | SSL.SSL_OP_NO_SSLv3 | SSL.SSL_OP_NO_TLSv1 |, +                    SSL.SSL_OP_NO_TLSv1_1 | SSL.SSL_OP_NO_TLSv1_2);, +, +                int opts = 0;, +                    opts |= SSL.SSL_OP_NO_SSLv2;, +                    opts |= SSL.SSL_OP_NO_SSLv3;, +                    opts |= SSL.SSL_OP_NO_TLSv1;, +                    opts |= SSL.SSL_OP_NO_TLSv1_1;, +                    opts |= SSL.SSL_OP_NO_TLSv1_2;, +, +                // Disable protocols we do not want, +                SSL.setOptions(ssl, opts);, +++ b/handler/src/main/java/io/netty/handler/ssl/OpenSslEngine.java, +                // Clear out options which disable protocols, +                SSL.clearOptions(ssl, SSL.SSL_OP_NO_SSLv2 | SSL.SSL_OP_NO_SSLv3 | SSL.SSL_OP_NO_TLSv1 |, +                    SSL.SSL_OP_NO_TLSv1_1 | SSL.SSL_OP_NO_TLSv1_2);, +, +                int opts = 0;, +                    opts |= SSL.SSL_OP_NO_SSLv2;, +                    opts |= SSL.SSL_OP_NO_SSLv3;, +                    opts |= SSL.SSL_OP_NO_TLSv1;, +                    opts |= SSL.SSL_OP_NO_TLSv1_1;, +                    opts |= SSL.SSL_OP_NO_TLSv1_2;, +, +                // Disable protocols we do not want, +                SSL.setOptions(ssl, opts);, +++ b/handler/src/test/java/io/netty/handler/ssl/JdkSslEngineTest.java, +import io.netty.handler.ssl.JdkApplicationProtocolNegotiator.ProtocolSelector;, +import io.netty.handler.ssl.JdkApplicationProtocolNegotiator.ProtocolSelectorFactory;, +import org.junit.Test;, +import javax.net.ssl.SSLEngine;, +import javax.net.ssl.SSLHandshakeException;, +import static org.junit.Assert.assertNull;, +import static org.junit.Assert.assertTrue;, +import static org.junit.Assume.assumeNoException;, +    @Test, +    public void testEnablingAnAlreadyDisabledSslProtocol() throws Exception {, +        testEnablingAnAlreadyDisabledSslProtocol(new String[]{}, new String[]{PROTOCOL_TLS_V1_2});, +    }, +, +++ b/handler/src/main/java/io/netty/handler/ssl/OpenSslEngine.java, +                // Clear out options which disable protocols, +                SSL.clearOptions(ssl, SSL.SSL_OP_NO_SSLv2 | SSL.SSL_OP_NO_SSLv3 | SSL.SSL_OP_NO_TLSv1 |, +                    SSL.SSL_OP_NO_TLSv1_1 | SSL.SSL_OP_NO_TLSv1_2);, +, +                int opts = 0;, +                    opts |= SSL.SSL_OP_NO_SSLv2;, +                    opts |= SSL.SSL_OP_NO_SSLv3;, +                    opts |= SSL.SSL_OP_NO_TLSv1;, +                    opts |= SSL.SSL_OP_NO_TLSv1_1;, +                    opts |= SSL.SSL_OP_NO_TLSv1_2;, +, +                // Disable protocols we do not want, +                SSL.setOptions(ssl, opts);, +++ b/handler/src/test/java/io/netty/handler/ssl/JdkSslEngineTest.java, +import io.netty.handler.ssl.JdkApplicationProtocolNegotiator.ProtocolSelector;, +import io.netty.handler.ssl.JdkApplicationProtocolNegotiator.ProtocolSelectorFactory;, +import org.junit.Test;, +import javax.net.ssl.SSLEngine;, +import javax.net.ssl.SSLHandshakeException;, +import static org.junit.Assert.assertNull;, +import static org.junit.Assert.assertTrue;, +import static org.junit.Assume.assumeNoException;, +    @Test, +    public void testEnablingAnAlreadyDisabledSslProtocol() throws Exception {, +        testEnablingAnAlreadyDisabledSslProtocol(new String[]{}, new String[]{PROTOCOL_TLS_V1_2});, +    }, +, +++ b/handler/src/test/java/io/netty/handler/ssl/OpenSslEngineTest.java, +    @Test, +    public void testEnablingAnAlreadyDisabledSslProtocol() throws Exception {, +        assumeTrue(OpenSsl.isAvailable());, +        testEnablingAnAlreadyDisabledSslProtocol(new String[]{PROTOCOL_SSL_V2_HELLO},, +            new String[]{PROTOCOL_SSL_V2_HELLO, PROTOCOL_TLS_V1_2});, +    }, +, +++ b/handler/src/main/java/io/netty/handler/ssl/OpenSslEngine.java, +                // Clear out options which disable protocols, +                SSL.clearOptions(ssl, SSL.SSL_OP_NO_SSLv2 | SSL.SSL_OP_NO_SSLv3 | SSL.SSL_OP_NO_TLSv1 |, +                    SSL.SSL_OP_NO_TLSv1_1 | SSL.SSL_OP_NO_TLSv1_2);, +, +                int opts = 0;, +                    opts |= SSL.SSL_OP_NO_SSLv2;, +                    opts |= SSL.SSL_OP_NO_SSLv3;, +                    opts |= SSL.SSL_OP_NO_TLSv1;, +                    opts |= SSL.SSL_OP_NO_TLSv1_1;, +                    opts |= SSL.SSL_OP_NO_TLSv1_2;, +, +                // Disable protocols we do not want, +                SSL.setOptions(ssl, opts);, +++ b/handler/src/test/java/io/netty/handler/ssl/JdkSslEngineTest.java, +import io.netty.handler.ssl.JdkApplicationProtocolNegotiator.ProtocolSelector;, +import io.netty.handler.ssl.JdkApplicationProtocolNegotiator.ProtocolSelectorFactory;, +import org.junit.Test;, +import javax.net.ssl.SSLEngine;, +import javax.net.ssl.SSLHandshakeException;, +import static org.junit.Assert.assertNull;, +import static org.junit.Assert.assertTrue;]
[+++ b/handler/src/main/java/io/netty/handler/ssl/SniHandler.java, +        if (!suppressRead && !handshakeFailed) {, +            final int writerIndex = in.writerIndex();, +                    final int readerIndex = in.readerIndex();, +                    final int readableBytes = writerIndex - readerIndex;, +                    if (readableBytes < SslUtils.SSL_RECORD_HEADER_LENGTH) {, +                        // Not enough data to determine the record type and length., +                        return;, +                    }, +, +                    final int command = in.getUnsignedByte(readerIndex);, +                            final int len = SslUtils.getEncryptedPacketLength(in, readerIndex);, +                            in.skipBytes(len);, +                            final int majorVersion = in.getUnsignedByte(readerIndex + 1);, +                                final int packetLength = in.getUnsignedShort(readerIndex + 3) +, +                                                         SslUtils.SSL_RECORD_HEADER_LENGTH;, +                                if (readableBytes < packetLength) {, +                                    // client hello incomplete; try again to decode once more data is ready., +, +, +                                final int endOffset = readerIndex + packetLength;, +                                if (endOffset - offset < 6) {, +                                    break loop;, +                                }, +, +                                final int sessionIdLength = in.getUnsignedByte(offset);, +                                final int cipherSuitesLength = in.getUnsignedShort(offset);, +                                final int compressionMethodLength = in.getUnsignedByte(offset);, +                                final int extensionsLength = in.getUnsignedShort(offset);, +                                final int extensionsLimit = offset + extensionsLength;, +                                if (extensionsLimit > endOffset) {, +                                    // Extensions should never exceed the record boundary., +                                    break loop;, +                                }, +, +                                for (;;) {, +                                    if (extensionsLimit - offset < 4) {, +                                        break loop;, +                                    }, +, +                                    final int extensionType = in.getUnsignedShort(offset);, +                                    final int extensionLength = in.getUnsignedShort(offset);, +                                    if (extensionsLimit - offset < extensionLength) {, +                                        break loop;, +                                    }, +, +                                        offset += 2;, +                                        if (extensionsLimit - offset < 3) {, +                                            break loop;, +                                        }, +, +                                        final int serverNameType = in.getUnsignedByte(offset);, +                                        offset++;, +, +                                            final int serverNameLength = in.getUnsignedShort(offset);, +                                            offset += 2;, +, +                                            if (extensionsLimit - offset < serverNameLength) {, +                                                break loop;, +                                            }, +, +                                            final String hostname = in.toString(offset, serverNameLength,]
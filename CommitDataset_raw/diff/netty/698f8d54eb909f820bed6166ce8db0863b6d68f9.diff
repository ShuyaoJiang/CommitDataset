[+++ b/src/main/java/org/jboss/netty/channel/socket/nio/NioDatagramWorker.java, +    private volatile int cancelledKeys;, +, +                cancelledKeys = 0;, +            boolean cancelled = false;, +                    cancelled = true;, +            if (cancelled) {, +                int cancelledKeys = ++ worker.cancelledKeys;, +                if (cancelledKeys >= 128) { // FIXME hardcoded value, +                    worker.cancelledKeys = 0;, +                    // Reclaim the associated file descriptors immediately., +                    // Otherwise the process will experience sudden spike, +                    // in the number of open files, with high chance of getting, +                    // the 'too many open files' error., +                    if (Thread.currentThread() == worker.thread) {, +                        selector.selectNow();, +                        if (worker.wakenUp.get()) {, +                            selector.wakeup();, +                        }, +                    } else {, +                        if (worker.wakenUp.compareAndSet(false, true)) {, +                            selector.wakeup();, +                        }, +                    }, +                }, +            }, +]
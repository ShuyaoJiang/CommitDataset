[+++ b/handler/src/main/java/io/netty/handler/ssl/ReferenceCountedOpenSslEngine.java, +        return (int) min(MAX_ENCRYPTED_PACKET_LENGTH,, +                pendingBytes + (long) MAX_TLS_RECORD_OVERHEAD_LENGTH * numComponents);, +++ b/handler/src/main/java/io/netty/handler/ssl/ReferenceCountedOpenSslEngine.java, +        return (int) min(MAX_ENCRYPTED_PACKET_LENGTH,, +                pendingBytes + (long) MAX_TLS_RECORD_OVERHEAD_LENGTH * numComponents);, +++ b/handler/src/test/java/io/netty/handler/ssl/OpenSslEngineTest.java, +        assertEquals(MAX_ENCRYPTED_PACKET_LENGTH,, +    @Test, +    public void testCalculateOutNetBufSizeMaxEncryptedPacketLength() {, +        assertEquals(MAX_ENCRYPTED_PACKET_LENGTH,, +                ReferenceCountedOpenSslEngine.calculateOutNetBufSize(MAX_ENCRYPTED_PACKET_LENGTH + 1, 2));, +    }, +]
[+++ b/src/main/java/org/jboss/netty/example/proxy/HexDumpProxyInboundHandler.java, +            closeOnFlush(outboundChannel);, +        closeOnFlush(e.getChannel());, +            closeOnFlush(inboundChannel);, +            closeOnFlush(e.getChannel());, +        }, +    }, +    , +    /**, +     * Closes the specified channel after all queued write requests are flushed., +     */, +    static void closeOnFlush(Channel ch) {, +        if (ch.isConnected()) {, +            ch.write(ChannelBuffers.EMPTY_BUFFER).addListener(ChannelFutureListener.CLOSE);]
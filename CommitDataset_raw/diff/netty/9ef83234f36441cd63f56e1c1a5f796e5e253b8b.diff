[+++ b/codec-http/src/test/java/io/netty/handler/codec/http/HttpRequestDecoderTest.java, +import io.netty.handler.codec.TooLongFrameException;, +, +    @Test, +    public void testTooLargeInitialLine() {, +        EmbeddedChannel channel = new EmbeddedChannel(new HttpRequestDecoder(10, 1024, 1024));, +        String requestStr = "GET /some/path HTTP/1.1\r\n" +, +                "Host: localhost1\r\n\r\n";, +, +        assertTrue(channel.writeInbound(Unpooled.copiedBuffer(requestStr, CharsetUtil.US_ASCII)));, +        HttpRequest request = channel.readInbound();, +        assertTrue(request.decoderResult().isFailure());, +        assertTrue(request.decoderResult().cause() instanceof TooLongFrameException);, +        assertFalse(channel.finish());, +    }, +, +    @Test, +    public void testTooLargeHeaders() {, +        EmbeddedChannel channel = new EmbeddedChannel(new HttpRequestDecoder(1024, 10, 1024));, +        String requestStr = "GET /some/path HTTP/1.1\r\n" +, +                "Host: localhost1\r\n\r\n";, +, +        assertTrue(channel.writeInbound(Unpooled.copiedBuffer(requestStr, CharsetUtil.US_ASCII)));, +        HttpRequest request = channel.readInbound();, +        assertTrue(request.decoderResult().isFailure());, +        assertTrue(request.decoderResult().cause() instanceof TooLongFrameException);, +        assertFalse(channel.finish());, +    }]
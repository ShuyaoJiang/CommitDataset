[+++ b/codec-http/src/main/java/io/netty/handler/codec/http/cors/CorsHandler.java, +import static io.netty.util.internal.ObjectUtil.checkNotNull;, +        this(Collections.singletonList(checkNotNull(config, "config")), config.isShortCircuit());, +        if (origin != null && config != null) {, +++ b/codec-http/src/main/java/io/netty/handler/codec/http/cors/CorsHandler.java, +import static io.netty.util.internal.ObjectUtil.checkNotNull;, +        this(Collections.singletonList(checkNotNull(config, "config")), config.isShortCircuit());, +        if (origin != null && config != null) {, +++ b/codec-http/src/test/java/io/netty/handler/codec/http/cors/CorsHandlerTest.java, +    public void preflightRequestWithUnauthorizedOrigin() {, +        final String origin = "http://host";, +        final CorsConfig config = forOrigin("http://localhost").build();, +        final HttpResponse response = preflightRequest(config, origin, "xheader1");, +        assertThat(response.headers().contains(ACCESS_CONTROL_ALLOW_ORIGIN), is(false));, +    }, +, +    @Test]
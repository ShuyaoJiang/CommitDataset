[+++ b/handler/src/test/java/io/netty/handler/ssl/SslHandlerTest.java, +    private static SSLEngine newServerModeSSLEngine() throws NoSuchAlgorithmException {, +        SSLEngine engine = SSLContext.getDefault().createSSLEngine();, +        // Set the mode before we try to do the handshake as otherwise it may throw an IllegalStateException., +        // See:, +        //  - https://docs.oracle.com/javase/10/docs/api/javax/net/ssl/SSLEngine.html#beginHandshake(), +        //  - http://mail.openjdk.java.net/pipermail/security-dev/2018-July/017715.html, +        engine.setUseClientMode(false);, +        return engine;, +    }, +, +        SSLEngine engine = newServerModeSSLEngine();, +        SSLEngine engine = newServerModeSSLEngine();, +        SSLEngine engine = newServerModeSSLEngine();, +        SSLEngine engine = newServerModeSSLEngine();, +        SSLEngine engine = newServerModeSSLEngine();, +        SslHandler handler = new SslHandler(engine);, +        SSLEngine engine = newServerModeSSLEngine();, +++ b/handler/src/test/java/io/netty/handler/ssl/SslHandlerTest.java, +    private static SSLEngine newServerModeSSLEngine() throws NoSuchAlgorithmException {, +        SSLEngine engine = SSLContext.getDefault().createSSLEngine();, +        // Set the mode before we try to do the handshake as otherwise it may throw an IllegalStateException., +        // See:, +        //  - https://docs.oracle.com/javase/10/docs/api/javax/net/ssl/SSLEngine.html#beginHandshake(), +        //  - http://mail.openjdk.java.net/pipermail/security-dev/2018-July/017715.html, +        engine.setUseClientMode(false);, +        return engine;, +    }, +, +        SSLEngine engine = newServerModeSSLEngine();, +        SSLEngine engine = newServerModeSSLEngine();, +        SSLEngine engine = newServerModeSSLEngine();, +        SSLEngine engine = newServerModeSSLEngine();, +        SSLEngine engine = newServerModeSSLEngine();, +        SslHandler handler = new SslHandler(engine);, +        SSLEngine engine = newServerModeSSLEngine();, +++ b/testsuite/src/main/java/io/netty/testsuite/transport/socket/SocketSslClientRenegotiateTest.java, +        String renegotiation = clientSslHandler.engine().getEnabledCipherSuites()[0];, +        // Use the first previous enabled ciphersuite and try to renegotiate.]
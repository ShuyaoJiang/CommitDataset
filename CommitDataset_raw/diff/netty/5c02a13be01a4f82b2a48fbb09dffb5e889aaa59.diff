[+++ b/pom.xml, +      <groupId>org.apache.felix</groupId>, +      <artifactId>org.osgi.compendium</artifactId>, +      <version>1.2.0</version>, +      <scope>compile</scope>, +      <optional>true</optional>, +    </dependency>, +    <dependency>, +++ b/pom.xml, +      <groupId>org.apache.felix</groupId>, +      <artifactId>org.osgi.compendium</artifactId>, +      <version>1.2.0</version>, +      <scope>compile</scope>, +      <optional>true</optional>, +    </dependency>, +    <dependency>, +++ b/src/main/java/org/jboss/netty/container/osgi/NettyBundleActivator.java, +import org.jboss.netty.logging.InternalLogger;, +import org.jboss.netty.logging.InternalLoggerFactory;, +import org.jboss.netty.logging.OsgiLoggerFactory;, +import org.osgi.framework.ServiceReference;, +import org.osgi.service.log.LogService;, +        initLoggerFactory(ctx);, +    private void initLoggerFactory(BundleContext ctx) {, +        ServiceReference logServiceRef = ctx.getServiceReference(LogService.class.getName());, +        if (logServiceRef == null) {, +            // LogService is not available., +            return;, +        }, +, +        LogService logService;, +        try {, +            logService = (LogService) ctx.getService(logServiceRef);, +        } catch (Exception e) {, +            // Same name, different service, +            return;, +        }, +, +        Properties props = new Properties();, +        props.setProperty("category", "netty");, +, +        ServiceRegistration reg = ctx.registerService(, +                InternalLogger.class.getName(), new Object(), props);, +        registrations.add(reg);, +, +        InternalLoggerFactory.setDefaultFactory(, +                new OsgiLoggerFactory(logService, reg.getReference()));, +    }, +, +++ b/pom.xml, +      <groupId>org.apache.felix</groupId>, +      <artifactId>org.osgi.compendium</artifactId>, +      <version>1.2.0</version>, +      <scope>compile</scope>, +      <optional>true</optional>, +    </dependency>, +    <dependency>, +++ b/src/main/java/org/jboss/netty/container/osgi/NettyBundleActivator.java, +import org.jboss.netty.logging.InternalLogger;, +import org.jboss.netty.logging.InternalLoggerFactory;, +import org.jboss.netty.logging.OsgiLoggerFactory;, +import org.osgi.framework.ServiceReference;, +import org.osgi.service.log.LogService;, +        initLoggerFactory(ctx);, +    private void initLoggerFactory(BundleContext ctx) {, +        ServiceReference logServiceRef = ctx.getServiceReference(LogService.class.getName());, +        if (logServiceRef == null) {, +            // LogService is not available., +            return;, +        }, +, +        LogService logService;, +        try {, +            logService = (LogService) ctx.getService(logServiceRef);, +        } catch (Exception e) {, +            // Same name, different service, +            return;, +        }, +, +        Properties props = new Properties();, +        props.setProperty("category", "netty");, +, +        ServiceRegistration reg = ctx.registerService(, +                InternalLogger.class.getName(), new Object(), props);, +        registrations.add(reg);, +, +        InternalLoggerFactory.setDefaultFactory(, +                new OsgiLoggerFactory(logService, reg.getReference()));, +    }, +, +++ b/src/main/java/org/jboss/netty/logging/OsgiLogger.java, +/*, + * JBoss, Home of Professional Open Source, + *, + * Copyright 2008, Red Hat Middleware LLC, and individual contributors, + * by the @author tags. See the COPYRIGHT.txt in the distribution for a, + * full listing of individual contributors., + *, + * This is free software; you can redistribute it and/or modify it, + * under the terms of the GNU Lesser General Public License as]
[+++ b/handler/src/main/java/io/netty/handler/ssl/OpenSsl.java, +    private static final boolean IS_BORINGSSL;, +            IS_BORINGSSL = "BoringSSL".equals(versionString());, +, +                                !tlsv13Supported && isTLSv13Cipher(c)) {, +                        if (IS_BORINGSSL) {, +                            // Currently BoringSSL does not include these when calling SSL.getCiphers() even when these, +                            // are supported., +                            Collections.addAll(availableOpenSslCipherSuites,, +                                               "TLS_AES_128_GCM_SHA256",, +                                               "TLS_AES_256_GCM_SHA384" ,, +                                               "TLS_CHACHA20_POLY1305_SHA256");, +                        }, +                if (!isTLSv13Cipher(cipher)) {, +            IS_BORINGSSL = false;, +, +    static boolean isBoringSSL() {, +        return IS_BORINGSSL;, +    }, +++ b/handler/src/main/java/io/netty/handler/ssl/OpenSsl.java, +    private static final boolean IS_BORINGSSL;, +            IS_BORINGSSL = "BoringSSL".equals(versionString());, +, +                                !tlsv13Supported && isTLSv13Cipher(c)) {, +                        if (IS_BORINGSSL) {, +                            // Currently BoringSSL does not include these when calling SSL.getCiphers() even when these, +                            // are supported., +                            Collections.addAll(availableOpenSslCipherSuites,, +                                               "TLS_AES_128_GCM_SHA256",, +                                               "TLS_AES_256_GCM_SHA384" ,, +                                               "TLS_CHACHA20_POLY1305_SHA256");, +                        }, +                if (!isTLSv13Cipher(cipher)) {, +            IS_BORINGSSL = false;, +, +    static boolean isBoringSSL() {, +        return IS_BORINGSSL;, +    }, +++ b/handler/src/main/java/io/netty/handler/ssl/SslHandler.java, +, +            if (flushedBeforeHandshake && handshakePromise.isDone()) {, +                // We need to call wrap(...) in case there was a flush done before the handshake completed to ensure, +                // we do not stale., +                //, +                // See https://github.com/netty/netty/pull/2437, +                flushedBeforeHandshake = false;, +                wrapLater = true;, +            }, +, +++ b/handler/src/main/java/io/netty/handler/ssl/OpenSsl.java, +    private static final boolean IS_BORINGSSL;, +            IS_BORINGSSL = "BoringSSL".equals(versionString());, +, +                                !tlsv13Supported && isTLSv13Cipher(c)) {, +                        if (IS_BORINGSSL) {, +                            // Currently BoringSSL does not include these when calling SSL.getCiphers() even when these, +                            // are supported., +                            Collections.addAll(availableOpenSslCipherSuites,, +                                               "TLS_AES_128_GCM_SHA256",, +                                               "TLS_AES_256_GCM_SHA384" ,, +                                               "TLS_CHACHA20_POLY1305_SHA256");, +                        }, +                if (!isTLSv13Cipher(cipher)) {, +            IS_BORINGSSL = false;, +, +    static boolean isBoringSSL() {, +        return IS_BORINGSSL;, +    }, +++ b/handler/src/main/java/io/netty/handler/ssl/SslHandler.java, +, +            if (flushedBeforeHandshake && handshakePromise.isDone()) {, +                // We need to call wrap(...) in case there was a flush done before the handshake completed to ensure, +                // we do not stale., +                //, +                // See https://github.com/netty/netty/pull/2437, +                flushedBeforeHandshake = false;, +                wrapLater = true;, +            }, +, +++ b/handler/src/test/java/io/netty/handler/ssl/OpenSslTestUtils.java, +++ b/handler/src/main/java/io/netty/handler/ssl/OpenSsl.java, +    private static final boolean IS_BORINGSSL;, +            IS_BORINGSSL = "BoringSSL".equals(versionString());, +, +                                !tlsv13Supported && isTLSv13Cipher(c)) {, +                        if (IS_BORINGSSL) {, +                            // Currently BoringSSL does not include these when calling SSL.getCiphers() even when these, +                            // are supported., +                            Collections.addAll(availableOpenSslCipherSuites,, +                                               "TLS_AES_128_GCM_SHA256",, +                                               "TLS_AES_256_GCM_SHA384" ,, +                                               "TLS_CHACHA20_POLY1305_SHA256");, +                        }, +                if (!isTLSv13Cipher(cipher)) {, +            IS_BORINGSSL = false;, +, +    static boolean isBoringSSL() {, +        return IS_BORINGSSL;, +    }, +++ b/handler/src/main/java/io/netty/handler/ssl/SslHandler.java]
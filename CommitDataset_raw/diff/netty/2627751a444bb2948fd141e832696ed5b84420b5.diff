[+++ b/src/main/java/org/jboss/netty/channel/socket/http/HttpTunnelingSessionListener.java, +import static org.jboss.netty.channel.socket.http.HttpTunnelingServlet.*;, +        bootstrap.setPipelineFactory(new HttpTunnelingChannelPipelineFactory(handler));, +, +    /**, +     * @author The Netty Project (netty-dev@lists.jboss.org), +     * @author Trustin Lee (tlee@redhat.com), +     * @version $Rev$, $Date$, +     */, +    private static final class HttpTunnelingChannelPipelineFactory implements ChannelPipelineFactory {, +, +        private final HttpTunnelingChannelHandler handler;, +, +        HttpTunnelingChannelPipelineFactory(HttpTunnelingChannelHandler handler) {, +            this.handler = handler;, +        }, +, +        public ChannelPipeline getPipeline() throws Exception {, +            ChannelPipeline pipeline = pipeline();, +            pipeline.addLast(HttpTunnelingSessionListener.class.getName(), handler);, +            return pipeline;, +        }, +    }]
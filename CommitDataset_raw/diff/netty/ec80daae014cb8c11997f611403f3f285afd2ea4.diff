[+++ b/src/main/java/org/jboss/netty/handler/codec/embedder/AbstractCodecEmbedder.java, +import java.util.ConcurrentModificationException;, +        final int size = size();, +        Object[] a = new Object[size];, +        for (int i = 0; i < size; i ++) {, +            E product = poll();, +            if (product == null) {, +                throw new ConcurrentModificationException();, +            }, +            a[i] = product;, +        }, +        return a;]
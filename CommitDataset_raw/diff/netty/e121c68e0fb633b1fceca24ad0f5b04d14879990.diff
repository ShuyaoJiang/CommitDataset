[+++ b/codec-http/src/main/java/io/netty/handler/codec/rtsp/RtspDecoder.java, +/*, + * Copyright 2015 The Netty Project, + *, + * The Netty Project licenses this file to you under the Apache License,, + * version 2.0 (the "License"); you may not use this file except in compliance, + * with the License. You may obtain a copy of the License at:, + *, + *   http://www.apache.org/licenses/LICENSE-2.0, + *, + * Unless required by applicable law or agreed to in writing, software, + * distributed under the License is distributed on an "AS IS" BASIS, WITHOUT, + * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the, + * License for the specific language governing permissions and limitations, + * under the License., + */, +package io.netty.handler.codec.rtsp;, +, +import java.util.regex.Pattern;, +, +import io.netty.handler.codec.http.DefaultFullHttpRequest;, +import io.netty.handler.codec.http.DefaultFullHttpResponse;, +import io.netty.handler.codec.http.DefaultHttpRequest;, +import io.netty.handler.codec.http.DefaultHttpResponse;, +import io.netty.handler.codec.http.HttpMessage;, +import io.netty.handler.codec.http.HttpObjectDecoder;, +import io.netty.handler.codec.http.HttpResponseStatus;, +, +/**, + * Decodes {@link ByteBuf}s into RTSP messages represented in, + * {@link HttpMessage}s., + * <p>, + * <h3>Parameters that prevents excessive memory consumption</h3>, + * <table border="1">, + * <tr>, + * <th>Name</th><th>Meaning</th>, + * </tr>, + * <tr>, + * <td>{@code maxInitialLineLength}</td>, + * <td>The maximum length of the initial line, + *     (e.g. {@code "SETUP / RTSP/1.0"} or {@code "RTSP/1.0 200 OK"}), + *     If the length of the initial line exceeds this value, a, + *     {@link TooLongFrameException} will be raised.</td>, + * </tr>, + * <tr>, + * <td>{@code maxHeaderSize}</td>, + * <td>The maximum length of all headers. If the sum of the length of each, + *     header exceeds this value, a {@link TooLongFrameException} will be, + *     raised.</td>, + * </tr>, + * <tr>, + * <td>{@code maxContentLength}</td>, + * <td>The maximum length of the content.  If the content length exceeds this, + *     value, a {@link TooLongFrameException} will be raised.</td>, + * </tr>, + * </table>, + */, +public class RtspDecoder extends HttpObjectDecoder {, +    /**, +     * Status code for unknown responses., +     */, +    private static final HttpResponseStatus UNKNOWN_STATUS =, +            new HttpResponseStatus(999, "Unknown");, +    /**, +     * True if the message to decode is a request., +     * False if the message to decode is a response., +     */, +    private boolean isDecodingRequest;, +, +    /**, +     * Regex used on first line in message to detect if it is a response., +     */, +    private static final Pattern versionPattern = Pattern.compile("RTSP/\\d\\.\\d");, +, +    /**, +     * Constant for default max initial line length., +     */, +    public static final int DEFAULT_MAX_INITIAL_LINE_LENGTH = 4096;, +, +    /**, +     * Constant for default max header size., +     */, +    public static final int DEFAULT_MAX_HEADER_SIZE = 8192;, +, +    /**, +     * Constant for default max content length., +     */, +    public static final int DEFAULT_MAX_CONTENT_LENGTH = 8192;, +, +    /**, +     * Creates a new instance with the default, +     * {@code maxInitialLineLength (4096)}, {@code maxHeaderSize (8192)}, and, +     * {@code maxContentLength (8192)}., +     */, +    public RtspDecoder() {, +        this(DEFAULT_MAX_INITIAL_LINE_LENGTH,, +             DEFAULT_MAX_HEADER_SIZE,, +             DEFAULT_MAX_CONTENT_LENGTH);, +    }, +]
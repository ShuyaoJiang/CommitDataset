[+++ b/codec/src/main/java/io/netty/handler/codec/MessageToMessageEncoder.java, +                if (sizeMinusOne == 0) {, +                    ctx.write(out.get(0), promise);, +                } else if (sizeMinusOne > 0) {, +                    // Check if we can use a voidPromise for our extra writes to reduce GC-Pressure, +                    // See https://github.com/netty/netty/issues/2525, +                    ChannelPromise voidPromise = ctx.voidPromise();, +                    boolean isVoidPromise = promise == voidPromise;, +                        ChannelPromise p;, +                        if (isVoidPromise) {, +                            p = voidPromise;, +                        } else {, +                            p = ctx.newPromise();, +                        }, +                        ctx.write(out.get(i), p);]
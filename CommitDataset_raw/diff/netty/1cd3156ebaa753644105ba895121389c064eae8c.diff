[+++ b/transport/src/test/java/io/netty/channel/local/LocalTransportThreadModelTest.java, +import io.netty.util.internal.QueueFactory;, +import java.util.concurrent.TimeUnit;, +    @Test(timeout = 5000), +    public void testStagedExecutionMultiple() throws Throwable {, +        for (int i = 0; i < 10; i ++) {, +            testStagedExecution();, +        }, +    }, +, +    @Test(timeout = 5000), +        // Wait until all events are handled completely., +        while (h1.outboundThreadNames.size() < 3 || h3.inboundThreadNames.size() < 3) {, +            if (h1.exception.get() != null) {, +                throw h1.exception.get();, +            }, +            if (h2.exception.get() != null) {, +                throw h2.exception.get();, +            }, +            if (h3.exception.get() != null) {, +                throw h3.exception.get();, +            }, +, +            Thread.sleep(10);, +        }, +, +        } finally {, +            l.shutdown();, +            l.awaitTermination(5, TimeUnit.SECONDS);, +            e1.shutdown();, +            e1.awaitTermination(5, TimeUnit.SECONDS);, +            e2.shutdown();, +            e2.awaitTermination(5, TimeUnit.SECONDS);, +        ch.pipeline().fireInboundBufferUpdated();, +        private final Queue<String> inboundThreadNames = QueueFactory.createQueue();, +        private final Queue<String> outboundThreadNames = QueueFactory.createQueue();]
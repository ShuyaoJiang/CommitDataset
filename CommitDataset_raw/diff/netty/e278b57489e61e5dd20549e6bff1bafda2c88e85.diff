[+++ b/codec-http/src/test/java/io/netty/handler/codec/http/HttpObjectAggregatorTest.java, +import io.netty.handler.codec.TooLongFrameException;, +        HttpContent chunk1 = new DefaultHttpContent(Unpooled.copiedBuffer("test", CharsetUtil.US_ASCII));, +        HttpContent chunk2 = new DefaultHttpContent(Unpooled.copiedBuffer("test2", CharsetUtil.US_ASCII));, +        assertFalse(embedder.writeInbound(chunk1));, +        assertFalse(embedder.writeInbound(chunk2));, +            assertFalse(embedder.writeInbound(chunk3));, +        checkOversizedRequest(message);, +        checkOversizedRequest(message);, +    private static void checkOversizedRequest(HttpRequest message) {, +        HttpContent chunk1 = new DefaultHttpContent(Unpooled.copiedBuffer("test", CharsetUtil.US_ASCII));, +            embedder.writeInbound(chunk1);, +    @Test, +    public void testOversizedResponse() {, +        EmbeddedChannel embedder = new EmbeddedChannel(new HttpObjectAggregator(4));, +        HttpResponse message = new DefaultHttpResponse(HttpVersion.HTTP_1_1, HttpResponseStatus.OK);, +        HttpContent chunk1 = new DefaultHttpContent(Unpooled.copiedBuffer("test", CharsetUtil.US_ASCII));, +        HttpContent chunk2 = new DefaultHttpContent(Unpooled.copiedBuffer("test2", CharsetUtil.US_ASCII));, +, +        assertFalse(embedder.writeInbound(message));, +        assertFalse(embedder.writeInbound(chunk1));, +, +        try {, +            embedder.writeInbound(chunk2);, +            fail();, +        } catch (TooLongFrameException expected) {, +            // Expected, +        }, +, +        assertFalse(embedder.isOpen());, +        assertFalse(embedder.finish());, +    }, +]
[+++ b/buffer/src/main/java/io/netty/buffer/CompositeByteBuf.java, +            merged.put(buffers[i]);, +++ b/buffer/src/main/java/io/netty/buffer/CompositeByteBuf.java, +            merged.put(buffers[i]);, +++ b/buffer/src/test/java/io/netty/buffer/AbstractCompositeByteBufTest.java, +    public void testCompositeToSingleBuffer() {, +        CompositeByteBuf buf = compositeBuffer(3);, +, +        buf.addComponent(wrappedBuffer(new byte[] {1, 2, 3}));, +        assertEquals(1, buf.numComponents());, +, +        buf.addComponent(wrappedBuffer(new byte[] {4}));, +        assertEquals(2, buf.numComponents());, +, +        buf.addComponent(wrappedBuffer(new byte[] {5, 6}));, +        assertEquals(3, buf.numComponents());, +, +        // NOTE: hard-coding 6 here, since it seems like addComponent doesn't bump the writer index., +        // I'm unsure as to whether or not this is correct behavior, +        ByteBuffer nioBuffer = buf.nioBuffer(0, 6);, +        byte[] bytes = nioBuffer.array();, +        assertEquals(6, bytes.length);, +        assertArrayEquals(new byte[] {1, 2, 3, 4, 5, 6}, bytes);, +    }, +, +    @Test]
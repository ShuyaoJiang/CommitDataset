[+++ b/codec-http2/src/main/java/io/netty/handler/codec/http2/DefaultHttp2FrameReader.java, +import io.netty.buffer.ByteBuf;, +import io.netty.buffer.ByteBufAllocator;, +import io.netty.channel.ChannelHandlerContext;, +import io.netty.handler.codec.http2.Http2FrameReader.Configuration;, +, +import static io.netty.handler.codec.http2.Http2CodecUtil.PING_FRAME_PAYLOAD_LENGTH;, +        if (payloadLength != PING_FRAME_PAYLOAD_LENGTH) {, +++ b/codec-http2/src/main/java/io/netty/handler/codec/http2/DefaultHttp2FrameReader.java, +import io.netty.buffer.ByteBuf;, +import io.netty.buffer.ByteBufAllocator;, +import io.netty.channel.ChannelHandlerContext;, +import io.netty.handler.codec.http2.Http2FrameReader.Configuration;, +, +import static io.netty.handler.codec.http2.Http2CodecUtil.PING_FRAME_PAYLOAD_LENGTH;, +        if (payloadLength != PING_FRAME_PAYLOAD_LENGTH) {, +++ b/codec-http2/src/main/java/io/netty/handler/codec/http2/DefaultHttp2FrameWriter.java, +import io.netty.buffer.ByteBuf;, +import io.netty.channel.ChannelFuture;, +import io.netty.channel.ChannelHandlerContext;, +import io.netty.channel.ChannelPromise;, +import io.netty.handler.codec.http2.Http2CodecUtil.SimpleChannelPromiseAggregator;, +import io.netty.handler.codec.http2.Http2FrameWriter.Configuration;, +, +import static io.netty.handler.codec.http2.Http2CodecUtil.PING_FRAME_PAYLOAD_LENGTH;, +            verifyPingPayload(data);, +, +    private static void verifyPingPayload(ByteBuf data) {, +        if (data == null || data.readableBytes() != PING_FRAME_PAYLOAD_LENGTH) {, +            throw new IllegalArgumentException("Opaque data must be " + PING_FRAME_PAYLOAD_LENGTH + " bytes");, +        }, +    }]
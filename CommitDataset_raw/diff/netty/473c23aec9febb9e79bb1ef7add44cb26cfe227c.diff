[+++ b/handler/src/main/java/io/netty/handler/ssl/OpenSslEngine.java, +    enum ClientAuthMode {, +        NONE,, +        OPTIONAL,, +        REQUIRE,, +    }, +, +    private volatile ClientAuthMode clientAuth = ClientAuthMode.NONE;, +        setClientAuth(b ? ClientAuthMode.REQUIRE : ClientAuthMode.NONE);, +        return clientAuth == ClientAuthMode.REQUIRE;, +        setClientAuth(b ? ClientAuthMode.OPTIONAL : ClientAuthMode.NONE);, +        return clientAuth == ClientAuthMode.OPTIONAL;, +    }, +, +    private void setClientAuth(ClientAuthMode mode) {, +        if (clientMode) {, +            return;, +        }, +        synchronized (this) {, +            if (clientAuth == mode) {, +                // No need to issue any JNI calls if the mode is the same, +                return;, +            }, +            switch (mode) {, +                case NONE:, +                    SSL.setVerify(ssl, SSL.SSL_CVERIFY_NONE, OpenSslContext.VERIFY_DEPTH);, +                    break;, +                case REQUIRE:, +                    SSL.setVerify(ssl, SSL.SSL_CVERIFY_REQUIRE, OpenSslContext.VERIFY_DEPTH);, +                    break;, +                case OPTIONAL:, +                    SSL.setVerify(ssl, SSL.SSL_CVERIFY_OPTIONAL, OpenSslContext.VERIFY_DEPTH);, +                    break;, +            }, +            clientAuth = mode;, +        }]
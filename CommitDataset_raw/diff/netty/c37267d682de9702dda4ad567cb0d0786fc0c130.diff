[+++ b/transport/src/main/java/io/netty/channel/nio/NioEventLoop.java, +        final SelectorTuple selectorTuple = openSelector();, +        selector = selectorTuple.selector;, +        unwrappedSelector = selectorTuple.unwrappedSelector;, +    private static final class SelectorTuple {, +        final Selector unwrappedSelector;, +        final Selector selector;, +, +        SelectorTuple(Selector unwrappedSelector) {, +            this.unwrappedSelector = unwrappedSelector;, +            this.selector = unwrappedSelector;, +        }, +, +        SelectorTuple(Selector unwrappedSelector, Selector selector) {, +            this.unwrappedSelector = unwrappedSelector;, +            this.selector = selector;, +        }, +    }, +, +    private SelectorTuple openSelector() {, +        final Selector unwrappedSelector;, +            return new SelectorTuple(unwrappedSelector);, +            return new SelectorTuple(unwrappedSelector);, +            return new SelectorTuple(unwrappedSelector);, +        return new SelectorTuple(unwrappedSelector,, +                                 new SelectedSelectionKeySetSelector(unwrappedSelector, selectedKeySet));, +        final SelectorTuple newSelectorTuple;, +            newSelectorTuple = openSelector();, +                if (!key.isValid() || key.channel().keyFor(newSelectorTuple.unwrappedSelector) != null) {, +                SelectionKey newKey = key.channel().register(newSelectorTuple.unwrappedSelector, interestOps, a);, +        selector = newSelectorTuple.selector;, +        unwrappedSelector = newSelectorTuple.unwrappedSelector;]
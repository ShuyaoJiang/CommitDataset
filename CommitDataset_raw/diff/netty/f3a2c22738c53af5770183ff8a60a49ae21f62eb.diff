[+++ b/testsuite/src/test/java/io/netty/testsuite/transport/socket/SocketFileRegionTest.java, +        FileRegion emptyRegion = new DefaultFileRegion(new FileInputStream(file).getChannel(), 0, 0);, +, +        // Do write ByteBuf and then FileRegion to ensure that mixed writes work, +        // Also, write an empty FileRegion to test if writing an empty FileRegion does not cause any issues., +        //     https://github.com/netty/netty/issues/2964, +            assertEquals(cc.voidPromise(), cc.write(emptyRegion, cc.voidPromise()));, +            assertNotEquals(cc.voidPromise(), cc.write(emptyRegion));, +, +++ b/testsuite/src/test/java/io/netty/testsuite/transport/socket/SocketFileRegionTest.java, +        FileRegion emptyRegion = new DefaultFileRegion(new FileInputStream(file).getChannel(), 0, 0);, +, +        // Do write ByteBuf and then FileRegion to ensure that mixed writes work, +        // Also, write an empty FileRegion to test if writing an empty FileRegion does not cause any issues., +        //     https://github.com/netty/netty/issues/2964, +            assertEquals(cc.voidPromise(), cc.write(emptyRegion, cc.voidPromise()));, +            assertNotEquals(cc.voidPromise(), cc.write(emptyRegion));, +, +++ b/transport/src/main/java/io/netty/channel/nio/AbstractNioByteChannel.java, +                boolean done = region.transfered() >= region.count();, +, +                if (!done) {, +, +                }]
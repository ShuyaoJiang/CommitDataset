[+++ b/handler/src/main/java/io/netty/handler/ssl/OpenSslEngine.java, +    private static final Method GET_USE_CIPHER_SUITES_ORDER_METHOD;, +    private static final Method SET_USE_CIPHER_SUITES_ORDER_METHOD;, +        Method getUseCipherSuitesOrderMethod = null;, +        Method setUseCipherSuitesOrderMethod = null;, +                getUseCipherSuitesOrderMethod = SSLParameters.class.getDeclaredMethod("getUseCipherSuitesOrder");, +                SSLParameters parameters = new SSLParameters();, +                @SuppressWarnings("unused"), +                Boolean order = (Boolean) getUseCipherSuitesOrderMethod.invoke(parameters);, +                setUseCipherSuitesOrderMethod = SSLParameters.class.getDeclaredMethod("setUseCipherSuitesOrder",, +                        boolean.class);, +                setUseCipherSuitesOrderMethod.invoke(parameters, true);, +            } catch (Throwable ignore) {, +                getUseCipherSuitesOrderMethod = null;, +                setUseCipherSuitesOrderMethod = null;, +            }, +            try {, +        GET_USE_CIPHER_SUITES_ORDER_METHOD = getUseCipherSuitesOrderMethod;, +        SET_USE_CIPHER_SUITES_ORDER_METHOD = setUseCipherSuitesOrderMethod;, +            if (version >= 8) {, +                if (SET_SERVER_NAMES_METHOD != null && sniHostNames != null) {, +                if (SET_USE_CIPHER_SUITES_ORDER_METHOD != null && !isDestroyed()) {, +                    try {, +                        SET_USE_CIPHER_SUITES_ORDER_METHOD.invoke(sslParameters,, +                                (SSL.getOptions(ssl) & SSL.SSL_OP_CIPHER_SERVER_PREFERENCE) != 0);, +                    } catch (IllegalAccessException e) {, +                        throw new Error(e);, +                    } catch (InvocationTargetException e) {, +                        throw new Error(e);, +                    }, +                }, +            }, +            if (version >= 8) {, +                if (SNI_HOSTNAME_CLASS != null && clientMode && !isDestroyed()) {, +                if (GET_USE_CIPHER_SUITES_ORDER_METHOD != null && !isDestroyed()) {, +                    try {, +                        if ((Boolean) GET_USE_CIPHER_SUITES_ORDER_METHOD.invoke(sslParameters)) {, +                            SSL.setOptions(ssl, SSL.SSL_OP_CIPHER_SERVER_PREFERENCE);, +                        } else {, +                            SSL.clearOptions(ssl, SSL.SSL_OP_CIPHER_SERVER_PREFERENCE);, +                        }, +                    } catch (IllegalAccessException e) {, +                        throw new Error(e);, +                    } catch (InvocationTargetException e) {, +                        throw new Error(e);, +                    }, +                }, +            }]
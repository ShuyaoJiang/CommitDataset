[+++ b/transport/src/main/java/io/netty/channel/nio/AbstractNioChannel.java, +            if (promise == null) {, +                // Closed via cancellation and the promise has been notified already., +                return;, +            }, +, +        private void fulfillConnectPromise(ChannelPromise promise, Throwable cause) {, +            if (promise == null) {, +                // Closed via cancellation and the promise has been notified already., +            }, +, +            // Use tryFailure() instead of setFailure() to avoid the race against cancel()., +            promise.tryFailure(cause);, +            closeIfClosed();, +        }, +, +                fulfillConnectPromise(connectPromise, wasActive);, +                fulfillConnectPromise(connectPromise, t);]
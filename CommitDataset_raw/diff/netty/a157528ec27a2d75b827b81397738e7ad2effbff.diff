[+++ b/handler/src/main/java/io/netty/handler/ssl/OpenSslContext.java, +        return new OpenSslEngine(ctx, alloc, isClient(), sessionContext(), apn, engineMap,, +++ b/handler/src/main/java/io/netty/handler/ssl/OpenSslContext.java, +        return new OpenSslEngine(ctx, alloc, isClient(), sessionContext(), apn, engineMap,, +++ b/handler/src/main/java/io/netty/handler/ssl/OpenSslEngine.java, +    private final Certificate[] localCerts;, +        // Adding the OpenSslEngine to the OpenSslEngineMap so it can be used in the AbstractCertificateVerifier., +        engineMap.add(this);, +, +++ b/handler/src/main/java/io/netty/handler/ssl/OpenSslContext.java, +        return new OpenSslEngine(ctx, alloc, isClient(), sessionContext(), apn, engineMap,, +++ b/handler/src/main/java/io/netty/handler/ssl/OpenSslEngine.java, +    private final Certificate[] localCerts;, +        // Adding the OpenSslEngine to the OpenSslEngineMap so it can be used in the AbstractCertificateVerifier., +        engineMap.add(this);, +, +++ b/handler/src/main/java/io/netty/handler/ssl/SslHandler.java, +        if (engine instanceof OpenSslEngine) {, +            // Call shutdown so we ensure all the native memory is released asap, +            ((OpenSslEngine) engine).shutdown();, +        }]
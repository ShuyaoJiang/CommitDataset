[+++ b/common/src/main/java/io/netty/util/internal/InternalThreadLocalMap.java, +import io.netty.util.internal.logging.InternalLogger;, +import io.netty.util.internal.logging.InternalLoggerFactory;, +    private static final InternalLogger logger = InternalLoggerFactory.getInstance(InternalThreadLocalMap.class);, +, +    private static final int STRING_BUILDER_INITIAL_SIZE;, +    private static final int STRING_BUILDER_MAX_SIZE;, +    static {, +        STRING_BUILDER_INITIAL_SIZE =, +                SystemPropertyUtil.getInt("io.netty.threadLocalMap.stringBuilder.initialSize", 1024);, +        logger.debug("-Dio.netty.threadLocalMap.stringBuilder.initialSize: {}", STRING_BUILDER_INITIAL_SIZE);, +, +        STRING_BUILDER_MAX_SIZE = SystemPropertyUtil.getInt("io.netty.threadLocalMap.stringBuilder.maxSize", 1024 * 4);, +        logger.debug("-Dio.netty.threadLocalMap.stringBuilder.maxSize: {}", STRING_BUILDER_MAX_SIZE);, +    }, +, +        StringBuilder sb = stringBuilder;, +        if (sb == null) {, +            return stringBuilder = new StringBuilder(STRING_BUILDER_INITIAL_SIZE);, +        if (sb.capacity() > STRING_BUILDER_MAX_SIZE) {, +            sb.setLength(STRING_BUILDER_INITIAL_SIZE);, +            sb.trimToSize();, +        sb.setLength(0);, +        return sb;]
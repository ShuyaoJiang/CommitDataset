[+++ b/src/main/java/org/jboss/netty/buffer/CompositeChannelBuffer.java, +        ChannelBuffer duplicate = new CompositeChannelBuffer(this);, +        duplicate.setIndex(readerIndex(), writerIndex());, +        return duplicate;, +++ b/src/main/java/org/jboss/netty/buffer/CompositeChannelBuffer.java, +        ChannelBuffer duplicate = new CompositeChannelBuffer(this);, +        duplicate.setIndex(readerIndex(), writerIndex());, +        return duplicate;, +++ b/src/main/java/org/jboss/netty/buffer/SlicedChannelBuffer.java, +        ChannelBuffer duplicate = new SlicedChannelBuffer(buffer, adjustment, length);, +        duplicate.setIndex(readerIndex(), writerIndex());, +        return duplicate;, +++ b/src/main/java/org/jboss/netty/buffer/CompositeChannelBuffer.java, +        ChannelBuffer duplicate = new CompositeChannelBuffer(this);, +        duplicate.setIndex(readerIndex(), writerIndex());, +        return duplicate;, +++ b/src/main/java/org/jboss/netty/buffer/SlicedChannelBuffer.java, +        ChannelBuffer duplicate = new SlicedChannelBuffer(buffer, adjustment, length);, +        duplicate.setIndex(readerIndex(), writerIndex());, +        return duplicate;, +++ b/src/main/java/org/jboss/netty/buffer/TruncatedChannelBuffer.java, +        ChannelBuffer duplicate = new TruncatedChannelBuffer(buffer, length);, +        duplicate.setIndex(readerIndex(), writerIndex());, +        return duplicate;, +++ b/src/main/java/org/jboss/netty/buffer/CompositeChannelBuffer.java, +        ChannelBuffer duplicate = new CompositeChannelBuffer(this);, +        duplicate.setIndex(readerIndex(), writerIndex());, +        return duplicate;, +++ b/src/main/java/org/jboss/netty/buffer/SlicedChannelBuffer.java, +        ChannelBuffer duplicate = new SlicedChannelBuffer(buffer, adjustment, length);, +        duplicate.setIndex(readerIndex(), writerIndex());, +        return duplicate;, +++ b/src/main/java/org/jboss/netty/buffer/TruncatedChannelBuffer.java, +        ChannelBuffer duplicate = new TruncatedChannelBuffer(buffer, length);, +        duplicate.setIndex(readerIndex(), writerIndex());, +        return duplicate;, +++ b/src/test/java/org/jboss/netty/buffer/AbstractChannelBufferTest.java, +        // Make sure all properties are copied., +        assertEquals(buffer.readableBytes(), copy.capacity());, +        assertSame(buffer.order(), copy.order());, +        // Make sure the buffer content is independent from each other., +    public void testDuplicate() {, +        for (int i = 0; i < buffer.capacity(); i ++) {, +            byte value = (byte) random.nextInt();, +            buffer.setByte(i, value);, +        }, +, +        final int readerIndex = CAPACITY / 3;, +        final int writerIndex = CAPACITY * 2 / 3;, +        buffer.setIndex(readerIndex, writerIndex);, +, +        // Make sure all properties are copied., +        ChannelBuffer duplicate = buffer.duplicate();, +        assertEquals(buffer.readerIndex(), duplicate.readerIndex());, +        assertEquals(buffer.writerIndex(), duplicate.writerIndex());, +        assertEquals(buffer.capacity(), duplicate.capacity());, +        assertSame(buffer.order(), duplicate.order());, +        for (int i = 0; i < duplicate.capacity(); i ++) {, +            assertEquals(buffer.getByte(i), duplicate.getByte(i));, +        }, +, +        // Make sure the buffer content is shared., +        buffer.setByte(readerIndex, (byte) (buffer.getByte(readerIndex) + 1));, +        assertTrue(buffer.getByte(readerIndex) == duplicate.getByte(readerIndex));, +        duplicate.setByte(1, (byte) (duplicate.getByte(1) + 1));, +        assertTrue(buffer.getByte(1) == duplicate.getByte(1));, +    }, +, +    @Test]
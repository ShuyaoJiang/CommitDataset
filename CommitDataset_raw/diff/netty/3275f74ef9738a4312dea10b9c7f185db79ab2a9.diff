[+++ b/src/main/java/org/jboss/netty/handler/codec/compression/ZlibEncoder.java, +import org.jboss.netty.channel.LifeCycleAwareChannelHandler;, +public class ZlibEncoder extends OneToOneEncoder implements LifeCycleAwareChannelHandler {, +    private volatile ChannelHandlerContext ctx;, +    public ChannelFuture close() {, +        ChannelHandlerContext ctx = this.ctx;, +        if (ctx == null) {, +            throw new IllegalStateException("not added to a pipeline");, +        }, +        return finishEncode(ctx, null);, +, +    public void beforeAdd(ChannelHandlerContext ctx) throws Exception {, +        this.ctx = ctx;, +    }, +, +    public void afterAdd(ChannelHandlerContext ctx) throws Exception {, +        // Unused, +    }, +, +    public void beforeRemove(ChannelHandlerContext ctx) throws Exception {, +        // Unused, +    }, +, +    public void afterRemove(ChannelHandlerContext ctx) throws Exception {, +        // Unused, +    }]
[+++ b/codec-http/src/main/java/io/netty/handler/codec/http/cookie/CookieUtil.java, +    private static final BitSet VALID_COOKIE_NAME_OCTETS = validCookieNameOctets();, +, +    private static final BitSet VALID_COOKIE_ATTRIBUTE_VALUE_OCTETS = validCookieAttributeValueOctets();, +, +    // token = 1*<any CHAR except CTLs or separators>, +    // separators = "(" | ")" | "<" | ">" | "@", +    // | "," | ";" | ":" | "\" | <">, +    // | "/" | "[" | "]" | "?" | "=", +    // | "{" | "}" | SP | HT, +    private static BitSet validCookieNameOctets() {, +        BitSet bits = new BitSet();, +        for (int i = 32; i < 127; i++) {, +            bits.set(i);, +        }, +        int[] separators = new int[], +                { '(', ')', '<', '>', '@', ',', ';', ':', '\\', '"', '/', '[', ']', '?', '=', '{', '}', ' ', '\t' };, +        for (int separator : separators) {, +            bits.set(separator, false);, +        }, +        return bits;, +    }, +    // path-value        = <any CHAR except CTLs or ";">, +    private static BitSet validCookieAttributeValueOctets() {, +        bits.set(';', false);, +    static String validateAttributeValue(String name, String value) {, +        if (value == null) {, +            return null;, +        }, +        value = value.trim();, +        if (value.isEmpty()) {, +            return null;, +        }, +        int i = firstInvalidOctet(value, VALID_COOKIE_ATTRIBUTE_VALUE_OCTETS);, +        if (i != -1) {, +            throw new IllegalArgumentException(name + " contains the prohibited characters: " + value.charAt(i));, +        }, +        return value;, +    }, +, +++ b/codec-http/src/main/java/io/netty/handler/codec/http/cookie/CookieUtil.java, +    private static final BitSet VALID_COOKIE_NAME_OCTETS = validCookieNameOctets();, +, +    private static final BitSet VALID_COOKIE_ATTRIBUTE_VALUE_OCTETS = validCookieAttributeValueOctets();, +, +    // token = 1*<any CHAR except CTLs or separators>, +    // separators = "(" | ")" | "<" | ">" | "@", +    // | "," | ";" | ":" | "\" | <">, +    // | "/" | "[" | "]" | "?" | "=", +    // | "{" | "}" | SP | HT, +    private static BitSet validCookieNameOctets() {, +        BitSet bits = new BitSet();, +        for (int i = 32; i < 127; i++) {, +            bits.set(i);, +        }, +        int[] separators = new int[], +                { '(', ')', '<', '>', '@', ',', ';', ':', '\\', '"', '/', '[', ']', '?', '=', '{', '}', ' ', '\t' };, +        for (int separator : separators) {, +            bits.set(separator, false);, +        }, +        return bits;, +    }, +    // path-value        = <any CHAR except CTLs or ";">, +    private static BitSet validCookieAttributeValueOctets() {, +        bits.set(';', false);, +    static String validateAttributeValue(String name, String value) {, +        if (value == null) {, +            return null;, +        }, +        value = value.trim();, +        if (value.isEmpty()) {, +            return null;, +        }, +        int i = firstInvalidOctet(value, VALID_COOKIE_ATTRIBUTE_VALUE_OCTETS);, +        if (i != -1) {, +            throw new IllegalArgumentException(name + " contains the prohibited characters: " + value.charAt(i));, +        }, +        return value;, +    }, +, +++ b/codec-http/src/main/java/io/netty/handler/codec/http/cookie/DefaultCookie.java, +import static io.netty.handler.codec.http.cookie.CookieUtil.*;, +        this.domain = validateAttributeValue("domain", domain);, +        this.path = validateAttributeValue("path", path);, +    /**, +     * Validate a cookie attribute value, throws a {@link IllegalArgumentException} otherwise., +     * Only intended to be used by {@link io.netty.handler.codec.http.DefaultCookie}., +     * @param name attribute name, +     * @param value attribute value, +     * @return the trimmed, validated attribute value, +     * @deprecated CookieUtil is package private, will be removed once old Cookie API is dropped, +     */, +    @Deprecated, +    protected String validateValue(String name, String value) {, +        return validateAttributeValue(name, value);, +    }, +, +++ b/codec-http/src/main/java/io/netty/handler/codec/http/cookie/CookieUtil.java, +    private static final BitSet VALID_COOKIE_NAME_OCTETS = validCookieNameOctets();, +]
[+++ b/src/main/java/org/jboss/netty/handler/codec/http/HttpMessageEncoder.java, +import static org.jboss.netty.buffer.ChannelBuffers.*;, +        if (msg instanceof HttpMessage) {, +            ChannelBuffer header = ChannelBuffers.dynamicBuffer(, +            encodeInitialLine(header, request);, +            encodeHeaders(header, request);, +            header.writeBytes(CRLF);, +, +            ChannelBuffer content = request.getContent();, +            if (content == null) {, +                return header; // no content, +            } else {, +                return wrappedBuffer(header, content);, +        }, +, +        if (msg instanceof HttpChunk) {, +            HttpChunk chunk = (HttpChunk) msg;, +            ChannelBuffer content = chunk.getContent();, +            int contentLength = content.readableBytes();, +, +            return wrappedBuffer(, +                    copiedBuffer(Integer.toHexString(contentLength), "USASCII"),, +                    wrappedBuffer(CRLF),, +                    content.slice(content.readerIndex(), contentLength),, +                    wrappedBuffer(CRLF));, +        }, +, +        // Unknown message type., +        return msg;]
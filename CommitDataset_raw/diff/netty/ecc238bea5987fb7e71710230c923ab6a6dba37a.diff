[+++ b/handler/src/main/java/io/netty/handler/ssl/ReferenceCountedOpenSslEngine.java, +            final boolean endPointVerificationEnabled = isEndPointVerificationEnabled(endPointIdentificationAlgorithm);, +, +            final boolean wasEndPointVerificationEnabled =, +                    isEndPointVerificationEnabled(this.endPointIdentificationAlgorithm);, +, +            if (wasEndPointVerificationEnabled && !endPointVerificationEnabled) {, +                // Passing in null will disable hostname verification again so only do so if it was enabled before., +                SSL.setHostNameValidation(ssl, DEFAULT_HOSTNAME_VALIDATION_FLAGS, null);, +            } else {, +                String host = endPointVerificationEnabled ? getPeerHost() : null;, +                if (host != null && !host.isEmpty()) {, +                    SSL.setHostNameValidation(ssl, DEFAULT_HOSTNAME_VALIDATION_FLAGS, host);, +                }, +            }, +    private static boolean isEndPointVerificationEnabled(String endPointIdentificationAlgorithm) {, +        return endPointIdentificationAlgorithm != null && !endPointIdentificationAlgorithm.isEmpty();, +    }, +]
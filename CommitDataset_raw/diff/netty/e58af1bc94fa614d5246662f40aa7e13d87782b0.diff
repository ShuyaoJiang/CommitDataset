[+++ b/codec/src/main/java/io/netty/handler/codec/LengthFieldPrepender.java, +    protected void encode(ChannelHandlerContext ctx, ByteBuf msg, ByteBuf out) throws Exception {, +        int length = msg.readableBytes() + lengthAdjustment;, +        if (lengthIncludesLengthFieldLength) {, +            length += lengthFieldLength;, +        }, +++ b/codec/src/main/java/io/netty/handler/codec/LengthFieldPrepender.java, +    protected void encode(ChannelHandlerContext ctx, ByteBuf msg, ByteBuf out) throws Exception {, +        int length = msg.readableBytes() + lengthAdjustment;, +        if (lengthIncludesLengthFieldLength) {, +            length += lengthFieldLength;, +        }, +++ b/codec/src/test/java/io/netty/handler/codec/frame/LengthFieldPrependerTest.java, + * Copyright 2013 The Netty Project, +import static io.netty.buffer.Unpooled.*;, +import static org.hamcrest.core.Is.*;, +import static org.junit.Assert.*;]
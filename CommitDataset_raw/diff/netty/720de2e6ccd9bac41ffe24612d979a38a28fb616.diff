[+++ b/transport/src/main/java/io/netty/channel/DefaultChannelHandlerContext.java, +        validatePromise(promise, false);, +        validatePromise(promise, false);, +        validatePromise(promise, false);, +        validatePromise(promise, false);, +        validatePromise(promise, false);, +        if (msgs == null) {, +            throw new NullPointerException("msgs");, +        }, +        validatePromise(promise, true);, +, +    private void validatePromise(ChannelFuture promise, boolean allowUnsafe) {, +        if (promise == null) {, +            throw new NullPointerException("promise");, +        if (promise.channel() != channel()) {, +                    "promise.channel does not match: %s (expected: %s)", promise.channel(), channel()));, +        if (promise.isDone()) {, +        if (!allowUnsafe && promise instanceof VoidChannelPromise) {, +        if (promise instanceof AbstractChannel.CloseFuture) {]
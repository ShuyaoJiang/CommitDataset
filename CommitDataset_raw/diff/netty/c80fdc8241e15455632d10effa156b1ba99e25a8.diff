[+++ b/transport/src/main/java/io/netty/channel/AbstractChannel.java, +    private boolean closeInitiated;, +            if (closeInitiated) {, +                if (closeFuture.isDone()) {, +                    // Closed already., +                    safeSetSuccess(promise);, +                } else if (!(promise instanceof VoidChannelPromise)) { // Only needed if no VoidChannelPromise., +            closeInitiated = true;, +            final ChannelOutboundBuffer outboundBuffer = this.outboundBuffer;, +                                    if (outboundBuffer != null) {, +                                    }, +                    if (outboundBuffer != null) {, +                }]
[+++ b/handler/src/main/java/io/netty/handler/ssl/OpenSsl.java, +import org.apache.tomcat.Apr;, +import java.io.IOException;, +import java.io.InputStream;, +import java.util.Properties;, +        if (cause == null && !isNettyTcnative()) {, +            logger.debug("incompatible tcnative in the classpath; ", +                    + OpenSslEngine.class.getSimpleName() + " will be unavailable.");, +            cause = new ClassNotFoundException("incompatible tcnative in the classpath");, +        }, +, +    private static boolean isNettyTcnative() {, +        return AccessController.doPrivileged(new PrivilegedAction<Boolean>() {, +            @Override, +            public Boolean run() {, +                InputStream is = null;, +                try {, +                    is = Apr.class.getResourceAsStream("/org/apache/tomcat/apr.properties");, +                    Properties props = new Properties();, +                    props.load(is);, +                    String info = props.getProperty("tcn.info");, +                    return info != null && info.startsWith("netty-tcnative");, +                } catch (Throwable ignore) {, +                    return false;, +                } finally {, +                    if (is != null) {, +                        try {, +                            is.close();, +                        } catch (IOException ignore) {, +                            // ignore, +                        }, +                    }, +                }, +            }, +        });, +    }, +]
[+++ b/src/main/java/org/jboss/netty/buffer/AbstractChannelBuffer.java, +    public void ensureWritableBytes(int writableBytes) {, +        if (writableBytes > writableBytes()) {, +            throw new IndexOutOfBoundsException();, +        }, +    }, +, +++ b/src/main/java/org/jboss/netty/buffer/AbstractChannelBuffer.java, +    public void ensureWritableBytes(int writableBytes) {, +        if (writableBytes > writableBytes()) {, +            throw new IndexOutOfBoundsException();, +        }, +    }, +, +++ b/src/main/java/org/jboss/netty/buffer/ChannelBuffer.java, +     * Makes sure the number of {@linkplain #writableBytes() the writable bytes}, +     * is equal to or greater than the specified value.  If there is enough, +     * writable bytes in this buffer, this method returns with no side effect., +     * Otherwise:, +     * <ul>, +     * <li>a non-dynamic buffer will throw an {@link IndexOutOfBoundsException}.</li>, +     * <li>a dynamic buffer will expand its capacity so that the number of the, +     *     {@link #writableBytes() writable bytes} becomes equal to or greater, +     *     than the specified value. The expansion involves the reallocation of, +     *     the internal buffer and consequently memory copy.</li>, +     * </ul>, +     *, +     * @param writableBytes, +     *        the expected minimum number of writable bytes, +     * @throws IndexOutOfBoundsException, +     *         if {@linkplain #writableBytes() the writable bytes} of this, +     *         buffer is less than the specified value and the capacity of the, +     *         buffer cannot be expanded, +     */, +    void ensureWritableBytes(int writableBytes);, +, +    /**, +++ b/src/main/java/org/jboss/netty/buffer/AbstractChannelBuffer.java, +    public void ensureWritableBytes(int writableBytes) {, +        if (writableBytes > writableBytes()) {, +            throw new IndexOutOfBoundsException();, +        }, +    }, +, +++ b/src/main/java/org/jboss/netty/buffer/ChannelBuffer.java, +     * Makes sure the number of {@linkplain #writableBytes() the writable bytes}, +     * is equal to or greater than the specified value.  If there is enough, +     * writable bytes in this buffer, this method returns with no side effect., +     * Otherwise:, +     * <ul>, +     * <li>a non-dynamic buffer will throw an {@link IndexOutOfBoundsException}.</li>, +     * <li>a dynamic buffer will expand its capacity so that the number of the, +     *     {@link #writableBytes() writable bytes} becomes equal to or greater, +     *     than the specified value. The expansion involves the reallocation of, +     *     the internal buffer and consequently memory copy.</li>, +     * </ul>, +     *, +     * @param writableBytes, +     *        the expected minimum number of writable bytes, +     * @throws IndexOutOfBoundsException, +     *         if {@linkplain #writableBytes() the writable bytes} of this, +     *         buffer is less than the specified value and the capacity of the, +     *         buffer cannot be expanded, +     */, +    void ensureWritableBytes(int writableBytes);, +, +    /**, +++ b/src/main/java/org/jboss/netty/buffer/DynamicChannelBuffer.java, +    @Override, +    public void ensureWritableBytes(int minWritableBytes) {, +        if (minWritableBytes <= writableBytes()) {, +            return;, +        }, +, +        int newCapacity;, +        if (capacity() == 0) {, +            newCapacity = 1;, +        } else {, +            newCapacity = capacity();, +        }, +        int minNewCapacity = writerIndex() + minWritableBytes;, +        while (newCapacity < minNewCapacity) {, +            newCapacity <<= 1;, +        }, +, +        ChannelBuffer newBuffer = factory().getBuffer(order(), newCapacity);, +        newBuffer.writeBytes(buffer, 0, writerIndex());, +        buffer = newBuffer;, +    }, +, +++ b/src/main/java/org/jboss/netty/buffer/AbstractChannelBuffer.java, +    public void ensureWritableBytes(int writableBytes) {, +        if (writableBytes > writableBytes()) {, +            throw new IndexOutOfBoundsException();, +        }, +    }, +, +++ b/src/main/java/org/jboss/netty/buffer/ChannelBuffer.java, +     * Makes sure the number of {@linkplain #writableBytes() the writable bytes}, +     * is equal to or greater than the specified value.  If there is enough]
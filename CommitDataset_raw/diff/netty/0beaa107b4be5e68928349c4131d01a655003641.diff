[+++ b/buffer/src/main/java/io/netty/buffer/ChannelBuffers.java, +++ b/buffer/src/main/java/io/netty/buffer/ChannelBuffers.java, +++ b/buffer/src/test/java/io/netty/buffer/ChannelBuffersTest.java, +++ b/buffer/src/main/java/io/netty/buffer/ChannelBuffers.java, +++ b/buffer/src/test/java/io/netty/buffer/ChannelBuffersTest.java, +++ b/codec/src/main/java/io/netty/handler/codec/embedder/AbstractCodecEmbedder.java, +, +        @Override, +        public void fireUpstreamEventLater(ChannelPipeline pipeline, ChannelEvent e) throws Exception {, +            handleEvent(e);, +        }, +++ b/buffer/src/main/java/io/netty/buffer/ChannelBuffers.java, +++ b/buffer/src/test/java/io/netty/buffer/ChannelBuffersTest.java, +++ b/codec/src/main/java/io/netty/handler/codec/embedder/AbstractCodecEmbedder.java, +, +        @Override, +        public void fireUpstreamEventLater(ChannelPipeline pipeline, ChannelEvent e) throws Exception {, +            handleEvent(e);, +        }, +++ /dev/null, +++ b/buffer/src/main/java/io/netty/buffer/ChannelBuffers.java, +++ b/buffer/src/test/java/io/netty/buffer/ChannelBuffersTest.java, +++ b/codec/src/main/java/io/netty/handler/codec/embedder/AbstractCodecEmbedder.java, +, +        @Override, +        public void fireUpstreamEventLater(ChannelPipeline pipeline, ChannelEvent e) throws Exception {, +            handleEvent(e);, +        }, +++ /dev/null, +++ b/handler/src/main/java/io/netty/handler/stream/ChunkedWriteHandler.java, +            flush(ctx, false);, +            flush(ctx, false);, +            discard(ctx, false);, +                flush(ctx, true);, +                    discard(ctx, true);, +    private void discard(ChannelHandlerContext ctx, boolean fireNow) {, +            if (fireNow) {, +                fireExceptionCaught(ctx.getChannel(), cause);, +            } else {, +                fireExceptionCaughtLater(ctx.getChannel(), cause);, +            }, +    private synchronized void flush(ChannelHandlerContext ctx, boolean fireNow) throws Exception {, +            discard(ctx, fireNow);, +                        if (fireNow) {  , +                        } else {, +                            fireExceptionCaughtLater(ctx.getChannel(), t);, +                        }, +                discard(ctx, fireNow);, +++ b/buffer/src/main/java/io/netty/buffer/ChannelBuffers.java, +++ b/buffer/src/test/java/io/netty/buffer/ChannelBuffersTest.java, +++ b/codec/src/main/java/io/netty/handler/codec/embedder/AbstractCodecEmbedder.java, +, +        @Override, +        public void fireUpstreamEventLater(ChannelPipeline pipeline, ChannelEvent e) throws Exception {, +            handleEvent(e);, +        }, +++ /dev/null, +++ b/handler/src/main/java/io/netty/handler/stream/ChunkedWriteHandler.java, +            flush(ctx, false);, +            flush(ctx, false);, +            discard(ctx, false);, +                flush(ctx, true);, +                    discard(ctx, true);, +    private void discard(ChannelHandlerContext ctx, boolean fireNow) {, +            if (fireNow) {, +                fireExceptionCaught(ctx.getChannel(), cause);, +            } else {, +                fireExceptionCaughtLater(ctx.getChannel(), cause);, +            }, +    private synchronized void flush(ChannelHandlerContext ctx, boolean fireNow) throws Exception {, +            discard(ctx, fireNow);, +                        if (fireNow) {  , +                        } else {, +                            fireExceptionCaughtLater(ctx.getChannel(), t);, +                        }, +                discard(ctx, fireNow);, +++ b/handler/src/main/java/io/netty/handler/timeout/WriteTimeoutHandler.java, +        Channels.fireExceptionCaughtLater(ctx.getChannel(), EXCEPTION);, +++ b/buffer/src/main/java/io/netty/buffer/ChannelBuffers.java, +++ b/buffer/src/test/java/io/netty/buffer/ChannelBuffersTest.java, +++ b/codec/src/main/java/io/netty/handler/codec/embedder/AbstractCodecEmbedder.java, +, +        @Override, +        public void fireUpstreamEventLater(ChannelPipeline pipeline, ChannelEvent e) throws Exception {, +            handleEvent(e);, +        }, +++ /dev/null, +++ b/handler/src/main/java/io/netty/handler/stream/ChunkedWriteHandler.java, +            flush(ctx, false);, +            flush(ctx, false);, +            discard(ctx, false);, +                flush(ctx, true);, +                    discard(ctx, true);, +    private void discard(ChannelHandlerContext ctx, boolean fireNow) {, +            if (fireNow) {, +                fireExceptionCaught(ctx.getChannel(), cause);, +            } else {, +                fireExceptionCaughtLater(ctx.getChannel(), cause);, +            }, +    private synchronized void flush(ChannelHandlerContext ctx, boolean fireNow) throws Exception {]
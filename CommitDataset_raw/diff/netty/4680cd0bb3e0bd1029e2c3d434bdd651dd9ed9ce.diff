[+++ b/src/main/java/org/jboss/netty/handler/codec/protobuf/ProtobufDecoder.java, +        ChannelBuffer buf = (ChannelBuffer) msg;, +        if (buf.hasArray()) {, +            if(extensionRegistry == null) {, +                return prototype.newBuilderForType().mergeFrom(, +                        buf.array(),buf.arrayOffset(), buf.readableBytes()).build();, +            } else {, +                return prototype.newBuilderForType().mergeFrom(, +                        buf.array(), buf.arrayOffset(), buf.readableBytes(), extensionRegistry).build();, +            }, +        } else {, +                        new ChannelBufferInputStream((ChannelBuffer) msg), extensionRegistry).build();, +            }]
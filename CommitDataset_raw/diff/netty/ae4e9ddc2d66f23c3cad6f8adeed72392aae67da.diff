[+++ b/handler/src/main/java/io/netty/handler/ssl/SslHandler.java, +        try {, +        } finally {, +            // We may have written some parts of data before an exception was thrown so ensure we always flush., +            // See https://github.com/netty/netty/issues/3900#issuecomment-172481830, +    }, +, +            // We may have written some parts of data before an exception was thrown so ensure we always flush., +            // See https://github.com/netty/netty/issues/3900#issuecomment-172481830, +            flushIfNeeded(ctx);, +        flushIfNeeded(ctx);, +    private void flushIfNeeded(ChannelHandlerContext ctx) {, +        if (needsFlush) {, +            needsFlush = false;, +            ctx.flush();, +        }, +    }, +, +        } finally {, +            // We have may haven written some parts of data before an exception was thrown so ensure we always flush., +            // See https://github.com/netty/netty/issues/3900#issuecomment-172481830, +            ctx.flush();]
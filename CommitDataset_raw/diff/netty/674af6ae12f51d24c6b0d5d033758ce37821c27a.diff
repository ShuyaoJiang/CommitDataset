[+++ b/src/main/java/org/jboss/netty/handler/codec/protobuf/ProtobufVarint32FrameDecoder.java, +import org.jboss.netty.handler.codec.frame.CorruptedFrameException;, +    // TODO maxFrameLength + safe skip + fail-fast option, +    //      (just like LengthFieldBasedFrameDecoder), +        final byte[] buf = new byte[5];, +        for (int i = 0; i < buf.length; i ++) {, +                buffer.resetReaderIndex();, +                return null;, +                int length = CodedInputStream.newInstance(buf, 0, i + 1).readRawVarint32();, +                if (length < 0) {, +                    throw new CorruptedFrameException("negative length: " + length);, +                if (buffer.readableBytes() < length) {, +                } else {, +                    return buffer.readBytes(length);, +                }, +            }, +        }, +, +        // Couldn't find the byte whose MSB is off., +        throw new CorruptedFrameException("length larger than 32-bit");]
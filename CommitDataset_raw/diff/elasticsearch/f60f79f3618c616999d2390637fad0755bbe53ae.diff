[+++ b/core/src/main/java/org/elasticsearch/action/admin/indices/mapping/put/PutMappingRequest.java, +        if (in.getVersion().before(Version.V_5_3_0)) {, +++ b/core/src/main/java/org/elasticsearch/action/admin/indices/mapping/put/PutMappingRequest.java, +        if (in.getVersion().before(Version.V_5_3_0)) {, +++ b/core/src/main/java/org/elasticsearch/action/admin/indices/template/put/PutIndexTemplateRequest.java, +            if (in.getVersion().before(Version.V_5_3_0)) {, +++ b/core/src/main/java/org/elasticsearch/action/admin/indices/mapping/put/PutMappingRequest.java, +        if (in.getVersion().before(Version.V_5_3_0)) {, +++ b/core/src/main/java/org/elasticsearch/action/admin/indices/template/put/PutIndexTemplateRequest.java, +            if (in.getVersion().before(Version.V_5_3_0)) {, +++ b/core/src/test/java/org/elasticsearch/action/admin/indices/mapping/put/PutMappingRequestTests.java, +        final Version version = randomFrom(Version.CURRENT, Version.V_5_3_0, Version.V_5_3_1, Version.V_5_3_2, Version.V_5_4_0);, +        try (BytesStreamOutput bytesStreamOutput = new BytesStreamOutput()) {, +            bytesStreamOutput.setVersion(version);, +            try (StreamInput in = StreamInput.wrap(bytesStreamOutput.bytes().toBytesRef().bytes)) {, +                in.setVersion(version);, +        }, +    }, +++ b/core/src/main/java/org/elasticsearch/action/admin/indices/mapping/put/PutMappingRequest.java, +        if (in.getVersion().before(Version.V_5_3_0)) {, +++ b/core/src/main/java/org/elasticsearch/action/admin/indices/template/put/PutIndexTemplateRequest.java, +            if (in.getVersion().before(Version.V_5_3_0)) {, +++ b/core/src/test/java/org/elasticsearch/action/admin/indices/mapping/put/PutMappingRequestTests.java, +        final Version version = randomFrom(Version.CURRENT, Version.V_5_3_0, Version.V_5_3_1, Version.V_5_3_2, Version.V_5_4_0);, +        try (BytesStreamOutput bytesStreamOutput = new BytesStreamOutput()) {, +            bytesStreamOutput.setVersion(version);, +            try (StreamInput in = StreamInput.wrap(bytesStreamOutput.bytes().toBytesRef().bytes)) {, +                in.setVersion(version);, +        }, +    }, +++ b/core/src/test/java/org/elasticsearch/action/admin/indices/template/put/PutIndexTemplateRequestTests.java, +        final Version version = randomFrom(Version.CURRENT, Version.V_5_3_0, Version.V_5_3_1, Version.V_5_3_2, Version.V_5_4_0);, +        try (BytesStreamOutput out = new BytesStreamOutput()) {, +            out.setVersion(version);, +            try (StreamInput in = StreamInput.wrap(out.bytes().toBytesRef().bytes)) {, +                in.setVersion(version);, +                assertEquals(XContentHelper.convertToJson(new BytesArray(mapping), false, XContentType.YAML),, +                    serialized.mappings().get("bar"));, +            }, +        }]
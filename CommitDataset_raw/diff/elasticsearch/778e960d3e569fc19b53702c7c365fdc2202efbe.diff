[+++ b/plugin/src/main/java/org/elasticsearch/xpack/ml/job/process/DataCountsReporter.java, +public class DataCountsReporter extends AbstractComponent {, +    public DataCountsReporter(Settings settings, Job job, DataCounts counts, JobDataCountsPersister dataCountsPersister) {, +++ b/plugin/src/main/java/org/elasticsearch/xpack/ml/job/process/DataCountsReporter.java, +public class DataCountsReporter extends AbstractComponent {, +    public DataCountsReporter(Settings settings, Job job, DataCounts counts, JobDataCountsPersister dataCountsPersister) {, +++ b/plugin/src/main/java/org/elasticsearch/xpack/ml/job/process/autodetect/AutodetectCommunicator.java, +++ b/plugin/src/main/java/org/elasticsearch/xpack/ml/job/process/DataCountsReporter.java, +public class DataCountsReporter extends AbstractComponent {, +    public DataCountsReporter(Settings settings, Job job, DataCounts counts, JobDataCountsPersister dataCountsPersister) {, +++ b/plugin/src/main/java/org/elasticsearch/xpack/ml/job/process/autodetect/AutodetectCommunicator.java, +++ b/plugin/src/main/java/org/elasticsearch/xpack/ml/job/process/autodetect/AutodetectProcessManager.java, +        DataCountsReporter dataCountsReporter = new DataCountsReporter(settings, job, autodetectParams.dataCounts(),, +                jobDataCountsPersister);, +, +++ b/plugin/src/main/java/org/elasticsearch/xpack/ml/job/process/DataCountsReporter.java, +public class DataCountsReporter extends AbstractComponent {, +    public DataCountsReporter(Settings settings, Job job, DataCounts counts, JobDataCountsPersister dataCountsPersister) {, +++ b/plugin/src/main/java/org/elasticsearch/xpack/ml/job/process/autodetect/AutodetectCommunicator.java, +++ b/plugin/src/main/java/org/elasticsearch/xpack/ml/job/process/autodetect/AutodetectProcessManager.java, +        DataCountsReporter dataCountsReporter = new DataCountsReporter(settings, job, autodetectParams.dataCounts(),, +                jobDataCountsPersister);, +, +++ b/plugin/src/test/java/org/elasticsearch/xpack/ml/job/process/DataCountsReporterTests.java, +        DataCountsReporter dataCountsReporter = new DataCountsReporter(settings, job, new DataCounts(job.getId()),, +                jobDataCountsPersister);, +        DataCountsReporter dataCountsReporter = new DataCountsReporter(settings, job, new DataCounts(job.getId()),, +                jobDataCountsPersister);, +        DataCountsReporter dataCountsReporter =, +                new DataCountsReporter(settings, job, counts, jobDataCountsPersister);, +        DataCountsReporter dataCountsReporter = new DataCountsReporter(settings, job, new DataCounts(job.getId()),, +                jobDataCountsPersister);, +        DataCountsReporter dataCountsReporter = new DataCountsReporter(settings, job, new DataCounts(job.getId()),, +                jobDataCountsPersister);, +        DataCountsReporter dataCountsReporter = new DataCountsReporter(settings, job, new DataCounts(job.getId()),, +                jobDataCountsPersister);, +        DummyDataCountsReporter dataCountsReporter = new DummyDataCountsReporter();, +        DummyDataCountsReporter dataCountsReporter = new DummyDataCountsReporter();, +        DummyDataCountsReporter dataCountsReporter = new DummyDataCountsReporter();, +        DummyDataCountsReporter dataCountsReporter = new DummyDataCountsReporter();, +        DummyDataCountsReporter dataCountsReporter = new DummyDataCountsReporter();, +        DataCountsReporter dataCountsReporter = new DataCountsReporter(settings, job, new DataCounts(job.getId()),, +                jobDataCountsPersister);, +        assertEquals(0L, stats.getSparseBucketCount());, +++ b/plugin/src/main/java/org/elasticsearch/xpack/ml/job/process/DataCountsReporter.java, +public class DataCountsReporter extends AbstractComponent {, +    public DataCountsReporter(Settings settings, Job job, DataCounts counts, JobDataCountsPersister dataCountsPersister) {, +++ b/plugin/src/main/java/org/elasticsearch/xpack/ml/job/process/autodetect/AutodetectCommunicator.java, +++ b/plugin/src/main/java/org/elasticsearch/xpack/ml/job/process/autodetect/AutodetectProcessManager.java, +        DataCountsReporter dataCountsReporter = new DataCountsReporter(settings, job, autodetectParams.dataCounts(),, +                jobDataCountsPersister);, +, +++ b/plugin/src/test/java/org/elasticsearch/xpack/ml/job/process/DataCountsReporterTests.java, +        DataCountsReporter dataCountsReporter = new DataCountsReporter(settings, job, new DataCounts(job.getId()),, +                jobDataCountsPersister);, +        DataCountsReporter dataCountsReporter = new DataCountsReporter(settings, job, new DataCounts(job.getId()),, +                jobDataCountsPersister);, +        DataCountsReporter dataCountsReporter =, +                new DataCountsReporter(settings, job, counts, jobDataCountsPersister);, +        DataCountsReporter dataCountsReporter = new DataCountsReporter(settings, job, new DataCounts(job.getId()),, +                jobDataCountsPersister);, +        DataCountsReporter dataCountsReporter = new DataCountsReporter(settings, job, new DataCounts(job.getId()),, +                jobDataCountsPersister);, +        DataCountsReporter dataCountsReporter = new DataCountsReporter(settings, job, new DataCounts(job.getId()),, +                jobDataCountsPersister);, +        DummyDataCountsReporter dataCountsReporter = new DummyDataCountsReporter();, +        DummyDataCountsReporter dataCountsReporter = new DummyDataCountsReporter();, +        DummyDataCountsReporter dataCountsReporter = new DummyDataCountsReporter();, +        DummyDataCountsReporter dataCountsReporter = new DummyDataCountsReporter();, +        DummyDataCountsReporter dataCountsReporter = new DummyDataCountsReporter();, +        DataCountsReporter dataCountsReporter = new DataCountsReporter(settings, job, new DataCounts(job.getId()),, +                jobDataCountsPersister);, +        assertEquals(0L, stats.getSparseBucketCount());, +++ b/plugin/src/test/java/org/elasticsearch/xpack/ml/job/process/DummyDataCountsReporter.java, +        super(Settings.EMPTY, createJob(), new DataCounts("DummyJobId"),]
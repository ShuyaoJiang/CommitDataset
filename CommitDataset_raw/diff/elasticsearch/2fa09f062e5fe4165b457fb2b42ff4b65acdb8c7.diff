[+++ b/docs/plugins/mapper-annotated-text.asciidoc, +[[mapper-annotated-text]], +=== Mapper Annotated Text Plugin, +, +experimental[], +, +The mapper-annotated-text plugin provides the ability to index text that is a, +combination of free-text and special markup that is typically used to identify, +items of interest such as people or organisations (see NER or Named Entity Recognition, +tools). , +, +, +The elasticsearch markup allows one or more additional tokens to be injected, unchanged, into the token, +stream at the same position as the underlying text it annotates., +, +:plugin_name: mapper-annotated-text, +include::install_remove.asciidoc[], +, +[[mapper-annotated-text-usage]], +==== Using the `annotated-text` field, +, +The `annotated-text` tokenizes text content as per the more common `text` field (see , +"limitations" below) but also injects any marked-up annotation tokens directly into, +the search index:, +, +[source,js], +--------------------------, +PUT my_index, +{, +  "mappings": {, +    "_doc": {, +      "properties": {, +        "my_field": {, +          "type": "annotated_text", +        }, +      }, +    }, +  }, +}, +--------------------------, +// CONSOLE, +, +Such a mapping would allow marked-up text eg wikipedia articles to be indexed as both text, +and structured tokens. The annotations use a markdown-like syntax using URL encoding of, +one or more values separated by the `&` symbol., +, +, +We can use the "_analyze" api to test how an example annotation would be stored as tokens, +in the search index:, +, +, +[source,js], +--------------------------, +GET my_index/_analyze, +{, +  "field": "my_field", , +  "text":"Investors in [Apple](Apple+Inc.) rejoiced.", +}, +--------------------------, +// NOTCONSOLE, +, +Response:, +, +[source,js], +--------------------------------------------------, +{, +  "tokens": [, +    {, +      "token": "investors",, +      "start_offset": 0,, +      "end_offset": 9,, +      "type": "<ALPHANUM>",, +      "position": 0, +    },, +    {, +      "token": "in",, +      "start_offset": 10,, +      "end_offset": 12,, +      "type": "<ALPHANUM>",, +      "position": 1, +    },, +    {, +      "token": "Apple Inc.", <1> , +      "start_offset": 13,, +      "end_offset": 18,, +      "type": "annotation",, +      "position": 2, +    },, +    {, +      "token": "apple",, +      "start_offset": 13,, +      "end_offset": 18,, +      "type": "<ALPHANUM>",, +      "position": 2, +    },, +    {, +      "token": "rejoiced",, +      "start_offset": 19,, +      "end_offset": 27,, +      "type": "<ALPHANUM>",]
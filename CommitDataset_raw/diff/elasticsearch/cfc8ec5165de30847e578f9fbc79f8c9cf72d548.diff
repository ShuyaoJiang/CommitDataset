[+++ b/modules/elasticsearch/src/main/java/org/elasticsearch/action/search/SearchResponse.java, +import org.elasticsearch.util.xcontent.ToXContent;, +import org.elasticsearch.util.xcontent.builder.XContentBuilder;, +public class SearchResponse implements ActionResponse, ToXContent {, +    @Override public void toXContent(XContentBuilder builder, Params params) throws IOException {, +        internalResponse.toXContent(builder, params);, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/action/search/SearchResponse.java, +import org.elasticsearch.util.xcontent.ToXContent;, +import org.elasticsearch.util.xcontent.builder.XContentBuilder;, +public class SearchResponse implements ActionResponse, ToXContent {, +    @Override public void toXContent(XContentBuilder builder, Params params) throws IOException {, +        internalResponse.toXContent(builder, params);, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/rest/JsonRestResponse.java, +import org.elasticsearch.util.xcontent.builder.XContentBuilder;, +    private final XContentBuilder builder;, +        this.builder = null;, +    public JsonRestResponse(RestRequest request, Status status, XContentBuilder builder) throws IOException {, +        this.builder = builder;, +        return builder.unsafeBytes();, +        return builder.unsafeBytesLength();, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/action/search/SearchResponse.java, +import org.elasticsearch.util.xcontent.ToXContent;, +import org.elasticsearch.util.xcontent.builder.XContentBuilder;, +public class SearchResponse implements ActionResponse, ToXContent {, +    @Override public void toXContent(XContentBuilder builder, Params params) throws IOException {, +        internalResponse.toXContent(builder, params);, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/rest/JsonRestResponse.java, +import org.elasticsearch.util.xcontent.builder.XContentBuilder;, +    private final XContentBuilder builder;, +        this.builder = null;, +    public JsonRestResponse(RestRequest request, Status status, XContentBuilder builder) throws IOException {, +        this.builder = builder;, +        return builder.unsafeBytes();, +        return builder.unsafeBytesLength();, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/rest/JsonThrowableRestResponse.java, +import org.elasticsearch.util.xcontent.builder.XContentBuilder;, +import static org.elasticsearch.rest.action.support.RestXContentBuilder.*;, +    private static XContentBuilder convert(RestRequest request, Throwable t) throws IOException {, +        XContentBuilder builder = restContentBuilder(request), +    private static void buildThrowable(Throwable t, XContentBuilder builder) throws IOException {, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/action/search/SearchResponse.java, +import org.elasticsearch.util.xcontent.ToXContent;, +import org.elasticsearch.util.xcontent.builder.XContentBuilder;, +public class SearchResponse implements ActionResponse, ToXContent {, +    @Override public void toXContent(XContentBuilder builder, Params params) throws IOException {, +        internalResponse.toXContent(builder, params);, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/rest/JsonRestResponse.java, +import org.elasticsearch.util.xcontent.builder.XContentBuilder;, +    private final XContentBuilder builder;, +        this.builder = null;, +    public JsonRestResponse(RestRequest request, Status status, XContentBuilder builder) throws IOException {, +        this.builder = builder;, +        return builder.unsafeBytes();, +        return builder.unsafeBytesLength();, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/rest/JsonThrowableRestResponse.java, +import org.elasticsearch.util.xcontent.builder.XContentBuilder;, +import static org.elasticsearch.rest.action.support.RestXContentBuilder.*;, +    private static XContentBuilder convert(RestRequest request, Throwable t) throws IOException {, +        XContentBuilder builder = restContentBuilder(request), +    private static void buildThrowable(Throwable t, XContentBuilder builder) throws IOException {, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/rest/RestRequest.java, +import org.elasticsearch.util.xcontent.ToXContent;, +public interface RestRequest extends ToXContent.Params {, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/action/search/SearchResponse.java, +import org.elasticsearch.util.xcontent.ToXContent;, +import org.elasticsearch.util.xcontent.builder.XContentBuilder;, +public class SearchResponse implements ActionResponse, ToXContent {, +    @Override public void toXContent(XContentBuilder builder, Params params) throws IOException {, +        internalResponse.toXContent(builder, params);, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/rest/JsonRestResponse.java, +import org.elasticsearch.util.xcontent.builder.XContentBuilder;, +    private final XContentBuilder builder;, +        this.builder = null;, +    public JsonRestResponse(RestRequest request, Status status, XContentBuilder builder) throws IOException {, +        this.builder = builder;, +        return builder.unsafeBytes();, +        return builder.unsafeBytesLength();, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/rest/JsonThrowableRestResponse.java, +import org.elasticsearch.util.xcontent.builder.XContentBuilder;, +import static org.elasticsearch.rest.action.support.RestXContentBuilder.*;, +    private static XContentBuilder convert(RestRequest request, Throwable t) throws IOException {, +        XContentBuilder builder = restContentBuilder(request), +    private static void buildThrowable(Throwable t, XContentBuilder builder) throws IOException {, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/rest/RestRequest.java, +import org.elasticsearch.util.xcontent.ToXContent;, +public interface RestRequest extends ToXContent.Params {, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/rest/action/admin/cluster/health/RestClusterHealthAction.java, +import org.elasticsearch.rest.action.support.RestXContentBuilder;, +import org.elasticsearch.util.xcontent.builder.XContentBuilder;, +                XContentBuilder builder = RestXContentBuilder.restContentBuilder(request);, +                    XContentBuilder builder = RestXContentBuilder.restContentBuilder(request);, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/action/search/SearchResponse.java, +import org.elasticsearch.util.xcontent.ToXContent;, +import org.elasticsearch.util.xcontent.builder.XContentBuilder;, +public class SearchResponse implements ActionResponse, ToXContent {, +    @Override public void toXContent(XContentBuilder builder, Params params) throws IOException {, +        internalResponse.toXContent(builder, params);, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/rest/JsonRestResponse.java, +import org.elasticsearch.util.xcontent.builder.XContentBuilder;, +    private final XContentBuilder builder;]
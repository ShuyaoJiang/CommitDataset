[+++ b/plugin/src/main/java/org/elasticsearch/xpack/ml/action/ForecastJobAction.java, +import org.elasticsearch.Version;, +import org.elasticsearch.cluster.ClusterState;, +import org.elasticsearch.xpack.ml.utils.ExceptionsHelper;, +                AutodetectProcessManager processManager) {, +            ClusterState state = clusterService.state();, +            Job job = JobManager.getJobOrThrowIfUnknown(task.getJobId(), state);, +            validate(job, request);, +, +, +, +, +        static void validate(Job job, Request request) {, +            if (job.getJobVersion() == null || job.getJobVersion().before(Version.V_6_1_0)) {, +                throw ExceptionsHelper.badRequestException(, +                        "Cannot run forecast because jobs created prior to version 6.1 are not supported");, +            }, +, +            if (request.getDuration() != null) {, +                TimeValue duration = request.getDuration();, +                TimeValue bucketSpan = job.getAnalysisConfig().getBucketSpan();, +, +                if (duration.compareTo(bucketSpan) < 0) {, +                    throw ExceptionsHelper.badRequestException(, +                            "[" + DURATION.getPreferredName() + "] must be greater or equal to the bucket span: [" + duration.getStringRep(), +                                    + "/" + bucketSpan.getStringRep() + "]");, +                }, +            }, +        }, +++ b/plugin/src/main/java/org/elasticsearch/xpack/ml/action/ForecastJobAction.java, +import org.elasticsearch.Version;, +import org.elasticsearch.cluster.ClusterState;, +import org.elasticsearch.xpack.ml.utils.ExceptionsHelper;, +                AutodetectProcessManager processManager) {, +            ClusterState state = clusterService.state();, +            Job job = JobManager.getJobOrThrowIfUnknown(task.getJobId(), state);, +            validate(job, request);, +, +, +, +, +        static void validate(Job job, Request request) {, +            if (job.getJobVersion() == null || job.getJobVersion().before(Version.V_6_1_0)) {, +                throw ExceptionsHelper.badRequestException(, +                        "Cannot run forecast because jobs created prior to version 6.1 are not supported");, +            }, +, +            if (request.getDuration() != null) {, +                TimeValue duration = request.getDuration();, +                TimeValue bucketSpan = job.getAnalysisConfig().getBucketSpan();, +, +                if (duration.compareTo(bucketSpan) < 0) {, +                    throw ExceptionsHelper.badRequestException(, +                            "[" + DURATION.getPreferredName() + "] must be greater or equal to the bucket span: [" + duration.getStringRep(), +                                    + "/" + bucketSpan.getStringRep() + "]");, +                }, +            }, +        }, +++ b/plugin/src/main/java/org/elasticsearch/xpack/ml/job/config/Job.java, +        public Builder setCreateTime(Date createTime) {, +++ b/plugin/src/main/java/org/elasticsearch/xpack/ml/action/ForecastJobAction.java, +import org.elasticsearch.Version;, +import org.elasticsearch.cluster.ClusterState;, +import org.elasticsearch.xpack.ml.utils.ExceptionsHelper;, +                AutodetectProcessManager processManager) {, +            ClusterState state = clusterService.state();, +            Job job = JobManager.getJobOrThrowIfUnknown(task.getJobId(), state);, +            validate(job, request);, +, +, +, +, +        static void validate(Job job, Request request) {, +            if (job.getJobVersion() == null || job.getJobVersion().before(Version.V_6_1_0)) {, +                throw ExceptionsHelper.badRequestException(, +                        "Cannot run forecast because jobs created prior to version 6.1 are not supported");, +            }, +, +            if (request.getDuration() != null) {, +                TimeValue duration = request.getDuration();, +                TimeValue bucketSpan = job.getAnalysisConfig().getBucketSpan();, +, +                if (duration.compareTo(bucketSpan) < 0) {, +                    throw ExceptionsHelper.badRequestException(, +                            "[" + DURATION.getPreferredName() + "] must be greater or equal to the bucket span: [" + duration.getStringRep(), +                                    + "/" + bucketSpan.getStringRep() + "]");, +                }, +            }, +        }, +++ b/plugin/src/main/java/org/elasticsearch/xpack/ml/job/config/Job.java, +        public Builder setCreateTime(Date createTime) {, +++ b/plugin/src/test/java/org/elasticsearch/xpack/ml/action/ForecastJobActionRequestTests.java, +import org.elasticsearch.ElasticsearchStatusException;, +import org.elasticsearch.Version;, +import org.elasticsearch.xpack.ml.job.config.AnalysisConfig;, +import org.elasticsearch.xpack.ml.job.config.DataDescription;, +import org.elasticsearch.xpack.ml.job.config.Detector;, +import org.elasticsearch.xpack.ml.job.config.Job;, +, +import java.util.Collections;]
[+++ b/core/src/main/java/org/elasticsearch/action/search/SearchRequestBuilder.java, +import org.elasticsearch.search.aggregations.PipelineAggregationBuilder;, +    public SearchRequestBuilder addAggregation(PipelineAggregationBuilder aggregation) {, +++ b/core/src/main/java/org/elasticsearch/action/search/SearchRequestBuilder.java, +import org.elasticsearch.search.aggregations.PipelineAggregationBuilder;, +    public SearchRequestBuilder addAggregation(PipelineAggregationBuilder aggregation) {, +++ b/core/src/main/java/org/elasticsearch/search/SearchModule.java, +import org.elasticsearch.search.aggregations.PipelineAggregationBuilder;, +import org.elasticsearch.search.aggregations.pipeline.bucketmetrics.avg.AvgBucketPipelineAggregationBuilder;, +import org.elasticsearch.search.aggregations.pipeline.bucketmetrics.max.MaxBucketPipelineAggregationBuilder;, +import org.elasticsearch.search.aggregations.pipeline.bucketmetrics.min.MinBucketPipelineAggregationBuilder;, +import org.elasticsearch.search.aggregations.pipeline.bucketmetrics.percentile.PercentilesBucketPipelineAggregationBuilder;, +import org.elasticsearch.search.aggregations.pipeline.bucketmetrics.stats.StatsBucketPipelineAggregationBuilder;, +import org.elasticsearch.search.aggregations.pipeline.bucketmetrics.stats.extended.ExtendedStatsBucketPipelineAggregationBuilder;, +import org.elasticsearch.search.aggregations.pipeline.bucketmetrics.sum.SumBucketPipelineAggregationBuilder;, +import org.elasticsearch.search.aggregations.pipeline.bucketscript.BucketScriptPipelineAggregationBuilder;, +import org.elasticsearch.search.aggregations.pipeline.bucketselector.BucketSelectorPipelineAggregationBuilder;, +import org.elasticsearch.search.aggregations.pipeline.cumulativesum.CumulativeSumPipelineAggregationBuilder;, +import org.elasticsearch.search.aggregations.pipeline.derivative.DerivativePipelineAggregationBuilder;, +import org.elasticsearch.search.aggregations.pipeline.movavg.MovAvgPipelineAggregationBuilder;, +import org.elasticsearch.search.aggregations.pipeline.serialdiff.SerialDiffPipelineAggregationBuilder;, +    public void registerPipelineAggregation(Writeable.Reader<? extends PipelineAggregationBuilder> reader,, +        namedWriteableRegistry.register(PipelineAggregationBuilder.class, aggregationName.getPreferredName(), reader);, +        registerPipelineAggregation(DerivativePipelineAggregationBuilder::new, DerivativePipelineAggregationBuilder::parse,, +                DerivativePipelineAggregationBuilder.AGGREGATION_NAME_FIELD);, +        registerPipelineAggregation(MaxBucketPipelineAggregationBuilder::new, MaxBucketPipelineAggregationBuilder.PARSER,, +                MaxBucketPipelineAggregationBuilder.AGGREGATION_NAME_FIELD);, +        registerPipelineAggregation(MinBucketPipelineAggregationBuilder::new, MinBucketPipelineAggregationBuilder.PARSER,, +                MinBucketPipelineAggregationBuilder.AGGREGATION_FIELD_NAME);, +        registerPipelineAggregation(AvgBucketPipelineAggregationBuilder::new, AvgBucketPipelineAggregationBuilder.PARSER,, +                AvgBucketPipelineAggregationBuilder.AGGREGATION_NAME_FIELD);, +        registerPipelineAggregation(SumBucketPipelineAggregationBuilder::new, SumBucketPipelineAggregationBuilder.PARSER,, +                SumBucketPipelineAggregationBuilder.AGGREGATION_NAME_FIELD);, +        registerPipelineAggregation(StatsBucketPipelineAggregationBuilder::new, StatsBucketPipelineAggregationBuilder.PARSER,, +                StatsBucketPipelineAggregationBuilder.AGGREGATION_NAME_FIELD);, +        registerPipelineAggregation(ExtendedStatsBucketPipelineAggregationBuilder::new, new ExtendedStatsBucketParser(),, +                ExtendedStatsBucketPipelineAggregationBuilder.AGGREGATION_NAME_FIELD);, +        registerPipelineAggregation(PercentilesBucketPipelineAggregationBuilder::new, PercentilesBucketPipelineAggregationBuilder.PARSER,, +                PercentilesBucketPipelineAggregationBuilder.AGGREGATION_NAME_FIELD);, +        registerPipelineAggregation(MovAvgPipelineAggregationBuilder::new,, +                (n, c) -> MovAvgPipelineAggregationBuilder.parse(movingAverageModelParserRegistry, n, c),, +                MovAvgPipelineAggregationBuilder.AGGREGATION_FIELD_NAME);, +        registerPipelineAggregation(CumulativeSumPipelineAggregationBuilder::new, CumulativeSumPipelineAggregationBuilder::parse,, +                CumulativeSumPipelineAggregationBuilder.AGGREGATION_NAME_FIELD);, +        registerPipelineAggregation(BucketScriptPipelineAggregationBuilder::new, BucketScriptPipelineAggregationBuilder::parse,, +                BucketScriptPipelineAggregationBuilder.AGGREGATION_NAME_FIELD);, +        registerPipelineAggregation(BucketSelectorPipelineAggregationBuilder::new, BucketSelectorPipelineAggregationBuilder::parse,, +                BucketSelectorPipelineAggregationBuilder.AGGREGATION_NAME_FIELD);, +        registerPipelineAggregation(SerialDiffPipelineAggregationBuilder::new, SerialDiffPipelineAggregationBuilder::parse,, +                SerialDiffPipelineAggregationBuilder.AGGREGATION_NAME_FIELD);, +++ b/core/src/main/java/org/elasticsearch/action/search/SearchRequestBuilder.java, +import org.elasticsearch.search.aggregations.PipelineAggregationBuilder;, +    public SearchRequestBuilder addAggregation(PipelineAggregationBuilder aggregation) {, +++ b/core/src/main/java/org/elasticsearch/search/SearchModule.java, +import org.elasticsearch.search.aggregations.PipelineAggregationBuilder;, +import org.elasticsearch.search.aggregations.pipeline.bucketmetrics.avg.AvgBucketPipelineAggregationBuilder;, +import org.elasticsearch.search.aggregations.pipeline.bucketmetrics.max.MaxBucketPipelineAggregationBuilder;, +import org.elasticsearch.search.aggregations.pipeline.bucketmetrics.min.MinBucketPipelineAggregationBuilder;, +import org.elasticsearch.search.aggregations.pipeline.bucketmetrics.percentile.PercentilesBucketPipelineAggregationBuilder;, +import org.elasticsearch.search.aggregations.pipeline.bucketmetrics.stats.StatsBucketPipelineAggregationBuilder;, +import org.elasticsearch.search.aggregations.pipeline.bucketmetrics.stats.extended.ExtendedStatsBucketPipelineAggregationBuilder;, +import org.elasticsearch.search.aggregations.pipeline.bucketmetrics.sum.SumBucketPipelineAggregationBuilder;, +import org.elasticsearch.search.aggregations.pipeline.bucketscript.BucketScriptPipelineAggregationBuilder;, +import org.elasticsearch.search.aggregations.pipeline.bucketselector.BucketSelectorPipelineAggregationBuilder;, +import org.elasticsearch.search.aggregations.pipeline.cumulativesum.CumulativeSumPipelineAggregationBuilder;, +import org.elasticsearch.search.aggregations.pipeline.derivative.DerivativePipelineAggregationBuilder;, +import org.elasticsearch.search.aggregations.pipeline.movavg.MovAvgPipelineAggregationBuilder;, +import org.elasticsearch.search.aggregations.pipeline.serialdiff.SerialDiffPipelineAggregationBuilder;, +    public void registerPipelineAggregation(Writeable.Reader<? extends PipelineAggregationBuilder> reader,, +        namedWriteableRegistry.register(PipelineAggregationBuilder.class, aggregationName.getPreferredName(), reader);, +        registerPipelineAggregation(DerivativePipelineAggregationBuilder::new, DerivativePipelineAggregationBuilder::parse,, +                DerivativePipelineAggregationBuilder.AGGREGATION_NAME_FIELD);, +        registerPipelineAggregation(MaxBucketPipelineAggregationBuilder::new, MaxBucketPipelineAggregationBuilder.PARSER,, +                MaxBucketPipelineAggregationBuilder.AGGREGATION_NAME_FIELD);, +        registerPipelineAggregation(MinBucketPipelineAggregationBuilder::new, MinBucketPipelineAggregationBuilder.PARSER,, +                MinBucketPipelineAggregationBuilder.AGGREGATION_FIELD_NAME);, +        registerPipelineAggregation(AvgBucketPipelineAggregationBuilder::new, AvgBucketPipelineAggregationBuilder.PARSER,, +                AvgBucketPipelineAggregationBuilder.AGGREGATION_NAME_FIELD);, +        registerPipelineAggregation(SumBucketPipelineAggregationBuilder::new, SumBucketPipelineAggregationBuilder.PARSER,, +                SumBucketPipelineAggregationBuilder.AGGREGATION_NAME_FIELD);, +        registerPipelineAggregation(StatsBucketPipelineAggregationBuilder::new, StatsBucketPipelineAggregationBuilder.PARSER,, +                StatsBucketPipelineAggregationBuilder.AGGREGATION_NAME_FIELD);, +        registerPipelineAggregation(ExtendedStatsBucketPipelineAggregationBuilder::new, new ExtendedStatsBucketParser(),, +                ExtendedStatsBucketPipelineAggregationBuilder.AGGREGATION_NAME_FIELD);, +        registerPipelineAggregation(PercentilesBucketPipelineAggregationBuilder::new, PercentilesBucketPipelineAggregationBuilder.PARSER,, +                PercentilesBucketPipelineAggregationBuilder.AGGREGATION_NAME_FIELD);, +        registerPipelineAggregation(MovAvgPipelineAggregationBuilder::new,, +                (n, c) -> MovAvgPipelineAggregationBuilder.parse(movingAverageModelParserRegistry, n, c),, +                MovAvgPipelineAggregationBuilder.AGGREGATION_FIELD_NAME);, +        registerPipelineAggregation(CumulativeSumPipelineAggregationBuilder::new, CumulativeSumPipelineAggregationBuilder::parse,, +                CumulativeSumPipelineAggregationBuilder.AGGREGATION_NAME_FIELD);, +        registerPipelineAggregation(BucketScriptPipelineAggregationBuilder::new, BucketScriptPipelineAggregationBuilder::parse,, +                BucketScriptPipelineAggregationBuilder.AGGREGATION_NAME_FIELD);, +        registerPipelineAggregation(BucketSelectorPipelineAggregationBuilder::new, BucketSelectorPipelineAggregationBuilder::parse,, +                BucketSelectorPipelineAggregationBuilder.AGGREGATION_NAME_FIELD);, +        registerPipelineAggregation(SerialDiffPipelineAggregationBuilder::new, SerialDiffPipelineAggregationBuilder::parse,, +                SerialDiffPipelineAggregationBuilder.AGGREGATION_NAME_FIELD);, +++ b/core/src/main/java/org/elasticsearch/search/aggregations/AbstractAggregationBuilder.java, +    public AB subAggregation(PipelineAggregationBuilder aggregation) {, +++ b/core/src/main/java/org/elasticsearch/action/search/SearchRequestBuilder.java]
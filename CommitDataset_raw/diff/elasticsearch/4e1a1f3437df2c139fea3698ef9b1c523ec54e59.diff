[+++ b/modules/elasticsearch/src/main/java/org/elasticsearch/cluster/metadata/IndexMetaData.java, +    public String mapping(String mappingType) {, +        return mappings.get(mappingType);, +    }, +, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/cluster/metadata/IndexMetaData.java, +    public String mapping(String mappingType) {, +        return mappings.get(mappingType);, +    }, +, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/gateway/GatewayService.java, +import java.util.Map;, +                                        metaDataService.createIndex(indexMetaData.index(), indexMetaData.settings(), timeValueMillis(500));, +                                    for (Map.Entry<String, String> entry : indexMetaData.mappings().entrySet()) {, +                                        try {, +                                            metaDataService.putMapping(new String[]{indexMetaData.index()}, entry.getKey(), entry.getValue(), true, timeValueMillis(10));, +                                        } catch (Exception e) {, +                                            logger.error("Failed to put mapping [" + entry.getKey() + "] for index [" + indexMetaData.index() + "]", e);, +                                        }, +                                    }, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/cluster/metadata/IndexMetaData.java, +    public String mapping(String mappingType) {, +        return mappings.get(mappingType);, +    }, +, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/gateway/GatewayService.java, +import java.util.Map;, +                                        metaDataService.createIndex(indexMetaData.index(), indexMetaData.settings(), timeValueMillis(500));, +                                    for (Map.Entry<String, String> entry : indexMetaData.mappings().entrySet()) {, +                                        try {, +                                            metaDataService.putMapping(new String[]{indexMetaData.index()}, entry.getKey(), entry.getValue(), true, timeValueMillis(10));, +                                        } catch (Exception e) {, +                                            logger.error("Failed to put mapping [" + entry.getKey() + "] for index [" + indexMetaData.index() + "]", e);, +                                        }, +                                    }, +++ b/modules/test/integration/src/test/java/org/elasticsearch/test/integration/gateway/AbstractSimpleIndexGatewayTests.java, +import org.elasticsearch.action.admin.cluster.state.ClusterStateResponse;, +import org.elasticsearch.action.admin.indices.mapping.put.PutMappingResponse;, +, +        // create a mapping, +        PutMappingResponse putMappingResponse = client("server1").admin().indices().putMapping(putMappingRequest("test").type("type1"), +                .mappingSource(mappingSource())).actionGet();, +        assertThat(putMappingResponse.acknowledged(), equalTo(true));, +, +        // verify that mapping is there, +        ClusterStateResponse clusterState = client("server1").admin().cluster().state(clusterState()).actionGet();, +        assertThat(clusterState.state().metaData().index("test").mapping("type1"), notNullValue());, +, +        // verify that mapping is there, +        clusterState = client("server1").admin().cluster().state(clusterState()).actionGet();, +        assertThat(clusterState.state().metaData().index("test").mapping("type1"), notNullValue());, +, +    private String mappingSource() {, +        return "{ type1 : { properties : { name : { type : \"string\" } } } }";, +    }, +]
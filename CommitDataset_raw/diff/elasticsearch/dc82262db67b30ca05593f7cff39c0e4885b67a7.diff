[+++ b/plugins/cloud-aws/rest-api-spec/test/cloud_aws/20_repository.yaml, +# Integration tests for Cloud AWS components, +#, +"S3 repository can be registereed":, +    - do:, +        snapshot.create_repository:, +          repository: test_repo_s3_1, +          verify: false, +          body:, +            type: s3, +            settings:, +              bucket: "my_bucket_name", +              access_key: "AKVAIQBF2RECL7FJWGJQ", +              secret_key: "vExyMThREXeRMm/b/LRzEB8jWwvzQeXgjqMX+6br", +, +    # Get repositry, +    - do:, +        snapshot.get_repository:, +          repository: test_repo_s3_1, +, +    - is_true: test_repo_s3_1, +    - is_true: test_repo_s3_1.settings.bucket, +    - is_false: test_repo_s3_1.settings.access_key, +    - is_false: test_repo_s3_1.settings.secret_key, +++ b/plugins/cloud-aws/rest-api-spec/test/cloud_aws/20_repository.yaml, +# Integration tests for Cloud AWS components, +#, +"S3 repository can be registereed":, +    - do:, +        snapshot.create_repository:, +          repository: test_repo_s3_1, +          verify: false, +          body:, +            type: s3, +            settings:, +              bucket: "my_bucket_name", +              access_key: "AKVAIQBF2RECL7FJWGJQ", +              secret_key: "vExyMThREXeRMm/b/LRzEB8jWwvzQeXgjqMX+6br", +, +    # Get repositry, +    - do:, +        snapshot.get_repository:, +          repository: test_repo_s3_1, +, +    - is_true: test_repo_s3_1, +    - is_true: test_repo_s3_1.settings.bucket, +    - is_false: test_repo_s3_1.settings.access_key, +    - is_false: test_repo_s3_1.settings.secret_key, +++ b/plugins/cloud-aws/src/main/java/org/elasticsearch/cloud/aws/AwsEc2Service.java, +        // Filter global settings, +        // Filter repository-specific settings, +        settingsFilter.addFilter("access_key");, +        settingsFilter.addFilter("secret_key");, +++ b/plugins/cloud-aws/rest-api-spec/test/cloud_aws/20_repository.yaml, +# Integration tests for Cloud AWS components, +#, +"S3 repository can be registereed":, +    - do:, +        snapshot.create_repository:, +          repository: test_repo_s3_1, +          verify: false, +          body:, +            type: s3, +            settings:, +              bucket: "my_bucket_name", +              access_key: "AKVAIQBF2RECL7FJWGJQ", +              secret_key: "vExyMThREXeRMm/b/LRzEB8jWwvzQeXgjqMX+6br", +, +    # Get repositry, +    - do:, +        snapshot.get_repository:, +          repository: test_repo_s3_1, +, +    - is_true: test_repo_s3_1, +    - is_true: test_repo_s3_1.settings.bucket, +    - is_false: test_repo_s3_1.settings.access_key, +    - is_false: test_repo_s3_1.settings.secret_key, +++ b/plugins/cloud-aws/src/main/java/org/elasticsearch/cloud/aws/AwsEc2Service.java, +        // Filter global settings, +        // Filter repository-specific settings, +        settingsFilter.addFilter("access_key");, +        settingsFilter.addFilter("secret_key");, +++ b/plugins/pom.xml, +                    <!-- used in repository plugin REST tests -->, +                    <include>api/snapshot.create_repository.json</include>, +                    <include>api/snapshot.get_repository.json</include>]
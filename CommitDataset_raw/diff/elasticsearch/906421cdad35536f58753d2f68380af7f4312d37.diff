[+++ b/docs/reference/monitoring/collecting-monitoring-data.asciidoc, +[role="xpack"], +[testenv="gold"], +[[collecting-monitoring-data]], +=== Collecting monitoring data, +++++, +<titleabbrev>Collecting monitoring data</titleabbrev>, +++++, +, +If you enable the Elastic {monitor-features} in your cluster, you can , +optionally collect metrics about {es}. By default, monitoring is enabled but , +data collection is disabled. , +, +This method involves sending the metrics to the monitoring cluster by using , +exporters. For an alternative method, see <<configuring-metricbeat>>., +, +NOTE: If you want to collect monitoring data from sources such as Beats and {ls}, +and route it to a monitoring cluster, you must follow this method. You cannot, +use {metricbeat} to ship the monitoring data for those products yet., +, +Advanced monitoring settings enable you to control how frequently data is , +collected, configure timeouts, and set the retention period for locally-stored , +monitoring indices. You can also adjust how monitoring data is displayed. , +, +To learn about monitoring in general, see , +{stack-ov}/xpack-monitoring.html[Monitoring the {stack}]. , +, +. Configure your cluster to collect monitoring data:, +, +.. Verify that the `xpack.monitoring.enabled` setting is `true`, which is its , +default value, on each node in the cluster. For more information, see , +<<monitoring-settings>>. , +, +.. Verify that the `xpack.monitoring.elasticsearch.collection.enabled` setting , +is `true`, which is its default value, on each node in the cluster. , ++, +--, +NOTE: You can specify this setting in either the `elasticsearch.yml` on each , +node or across the cluster as a dynamic cluster setting. If {es} , +{security-features} are enabled, you must have `monitor` cluster privileges to , +view the cluster settings and `manage` cluster privileges to change them., +, +For more information, see <<monitoring-settings>> and <<cluster-update-settings>>., +--, +, +.. Set the `xpack.monitoring.collection.enabled` setting to `true` on each, +node in the cluster. By default, it is is disabled (`false`). , ++ , +--, +NOTE: You can specify this setting in either the `elasticsearch.yml` on each , +node or across the cluster as a dynamic cluster setting. If {es} , +{security-features} are enabled, you must have `monitor` cluster privileges to , +view the cluster settings and `manage` cluster privileges to change them., +, +For example, use the following APIs to review and change this setting:, +, +[source,js], +----------------------------------, +GET _cluster/settings, +, +PUT _cluster/settings, +{, +  "persistent": {, +    "xpack.monitoring.collection.enabled": true, +  }, +}, +----------------------------------, +// CONSOLE, +, +Alternatively, you can enable this setting in {kib}. In the side navigation, , +click *Monitoring*. If data collection is disabled, you are prompted to turn it , +on. , +, +For more , +information, see <<monitoring-settings>> and <<cluster-update-settings>>., +--, +, +.. Optional: Specify which indices you want to monitor. , ++, +--, +By default, the monitoring agent collects data from all {es} indices., +To collect data from particular indices, configure the, +`xpack.monitoring.collection.indices` setting. You can specify multiple indices , +as a comma-separated list or use an index pattern to match multiple indices. For , +example:, +, +[source,yaml], +----------------------------------, +xpack.monitoring.collection.indices: logstash-*, index1, test2, +----------------------------------, +, +You can prepend `+` or `-` to explicitly include or exclude index names or , +patterns. For example, to include all indices that start with `test` except , +`test3`, you could specify `+test*,-test3`., +--, +, +.. Optional: Specify how often to collect monitoring data. The default value for , +the `xpack.monitoring.collection.interval` setting 10 seconds. See , +<<monitoring-settings>>., +]
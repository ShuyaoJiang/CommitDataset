[+++ b/modules/elasticsearch/src/main/java/org/elasticsearch/index/mapper/xcontent/XContentDocumentMapper.java, +, +                if (attributes != null && !attributes.isEmpty()) {, +                    builder.field("_attributes", attributes());, +                }, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/index/mapper/xcontent/XContentDocumentMapper.java, +, +                if (attributes != null && !attributes.isEmpty()) {, +                    builder.field("_attributes", attributes());, +                }, +++ b/modules/elasticsearch/src/test/java/org/elasticsearch/index/mapper/xcontent/simple/SimpleMapperTests.java, +, +    @Test public void testAttributes() throws Exception {, +        String mapping = copyToStringFromClasspath("/org/elasticsearch/index/mapper/xcontent/simple/test-mapping.json");, +        XContentDocumentMapper docMapper = MapperTests.newParser().parse(mapping);, +, +        assertThat((String) docMapper.attributes().get("param1"), equalTo("value1"));, +, +        String builtMapping = docMapper.mappingSource().string();, +        XContentDocumentMapper builtDocMapper = MapperTests.newParser().parse(builtMapping);, +        assertThat((String) builtDocMapper.attributes().get("param1"), equalTo("value1"));, +    }]
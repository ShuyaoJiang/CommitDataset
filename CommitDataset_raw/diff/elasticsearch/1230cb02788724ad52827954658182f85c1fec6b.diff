[+++ b/core/src/test/java/org/elasticsearch/test/ESIntegTestCase.java, +        return new ExternalTestCluster(createTempDir(), externalClusterClientSettings(), transportClientPlugins(), transportAddresses);, +++ b/core/src/test/java/org/elasticsearch/test/ESIntegTestCase.java, +        return new ExternalTestCluster(createTempDir(), externalClusterClientSettings(), transportClientPlugins(), transportAddresses);, +++ b/core/src/test/java/org/elasticsearch/test/ExternalTestCluster.java, +import org.elasticsearch.plugins.Plugin;, +import java.util.Collection;, +    public ExternalTestCluster(Path tempDir, Settings additionalSettings, Collection<Class<? extends Plugin>> pluginClasses, TransportAddress... transportAddresses) {, +        TransportClient.Builder transportClientBuilder = TransportClient.builder().settings(clientSettings);, +        for (Class<? extends Plugin> pluginClass : pluginClasses) {, +            transportClientBuilder.addPlugin(pluginClass);, +        }, +        this.client = transportClientBuilder.build().addTransportAddresses(transportAddresses);]
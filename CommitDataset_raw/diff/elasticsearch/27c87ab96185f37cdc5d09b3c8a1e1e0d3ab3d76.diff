[+++ b/core/src/test/java/org/elasticsearch/indexing/IndexActionIT.java, +import org.elasticsearch.action.search.SearchResponse;, +import org.elasticsearch.test.hamcrest.ElasticsearchAssertions;, +import org.elasticsearch.test.junit.annotations.TestLogging;, +, +    @TestLogging("_root:DEBUG,org.elasticsearch.index.shard.IndexShard:TRACE,org.elasticsearch.action.search:TRACE"), +                builders.add(client().prepareIndex("test", "type").setSource("field", "value_" + j));, +                    SearchResponse response = client().prepareSearch("test").get();, +                    if (response.getHits().totalHits() != numOfDocs) {, +                        final String message = "Count is " + response.getHits().totalHits() + " but " + numOfDocs + " was expected. ", +                            + ElasticsearchAssertions.formatShardStatus(response);, +                        logger.error("{}. search response: \n{}", message, response);, +                        fail(message);, +                    }, +                    SearchResponse response = client().prepareSearch("test").setTypes("type").get();, +                    if (response.getHits().totalHits() != numOfDocs) {, +                        final String message = "Count is " + response.getHits().totalHits() + " but " + numOfDocs + " was expected. ", +                            + ElasticsearchAssertions.formatShardStatus(response);, +                        logger.error("{}. search response: \n{}", message, response);, +                        fail(message);, +                    }]
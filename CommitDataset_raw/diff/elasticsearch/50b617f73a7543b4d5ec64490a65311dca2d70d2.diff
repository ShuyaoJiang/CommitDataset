[+++ b/core/src/main/java/org/elasticsearch/index/shard/IndexShard.java, +        if (globalCheckpoint > localCheckpoint) {, +             * checkpoint updates. However, since this shard is not yet contributing to calculating the global checkpoint, it can be the, +             * case that the global checkpoint update from the primary is ahead of the local checkpoint on this shard. In this case, we, +             * ignore the global checkpoint update. This can happen if we are in the translog stage of recovery. Prior to this, the engine, +             * is not opened and this shard will not receive global checkpoint updates, and after this the shard will be contributing to, +             * calculations of the the global checkpoint. However, we can not assert that we are in the translog stage of recovery here as, +             * while the global checkpoint update may have emanated from the primary when we were in that state, we could subsequently move, +             * to recovery finalization, or even finished recovery before the update arrives here., +            return;, +        seqNoService.updateGlobalCheckpointOnReplica(globalCheckpoint);]
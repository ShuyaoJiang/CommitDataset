[+++ b/core/src/main/java/org/elasticsearch/common/Base64.java, +        int outBuffPosn = decode(source, off, len, options, DECODABET, outBuff);, +, +        byte[] out = new byte[outBuffPosn];, +        System.arraycopy(outBuff, 0, out, 0, outBuffPosn);, +        return out;, +    }   // end decode, +, +    private static int decode(byte[] source, int off, int len, int options, byte[] DECODABET, byte[] outBuff) throws IOException {, +        int outBuffPosn = 0;             // Keep track of where we're writing, +        for (int i = off; i < off + len; i++) {  // Loop through source, +            byte sbiDecode = DECODABET[source[i] & 0xFF];, +                              throw new IOException(String.format(Locale.ROOT,, +                        throw new IOException(String.format(Locale.ROOT,, +                throw new IOException(String.format(Locale.ROOT,, +        return outBuffPosn;, +    }]
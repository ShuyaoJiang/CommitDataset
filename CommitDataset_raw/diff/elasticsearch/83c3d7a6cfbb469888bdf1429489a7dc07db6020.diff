[+++ b/x-pack/plugin/sql/src/main/java/org/elasticsearch/xpack/sql/querydsl/agg/Aggs.java, +        if (metricAggs.contains(agg)) {, +            return this;, +        }, +++ b/x-pack/plugin/sql/src/main/java/org/elasticsearch/xpack/sql/querydsl/agg/Aggs.java, +        if (metricAggs.contains(agg)) {, +            return this;, +        }, +++ b/x-pack/qa/sql/src/main/resources/agg.sql-spec, +, +// repetion of same aggs to check whether the generated query contains duplicates or not, +aggRepeatFunctionAcrossFields, +SELECT MIN(emp_no) AS a, 1 + MIN(emp_no) AS b, ABS(MIN(emp_no)) AS c FROM test_emp;, +aggRepeatFunctionBetweenSelectAndHaving, +SELECT gender, COUNT(DISTINCT languages) AS c FROM test_emp GROUP BY gender HAVING count(DISTINCT languages) > 0 ORDER BY gender;, +, +]
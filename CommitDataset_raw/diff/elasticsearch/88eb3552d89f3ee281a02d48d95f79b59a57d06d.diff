[+++ b/src/main/java/org/elasticsearch/common/util/concurrent/AtomicArray.java, +import org.elasticsearch.ElasticSearchGenerationException;, +        if (a.length != array.length()) {, +            throw new ElasticSearchGenerationException("AtomicArrays can only be copied to arrays of the same size");]
[+++ b/modules/lang-painless/src/main/java/org/elasticsearch/painless/DefBootstrap.java, +            final Lookup publicLookup = MethodHandles.publicLookup();, +                MethodHandle mh = publicLookup.findVirtual(ClassValue.class, "get",, +                        publicLookup.findVirtual(Object.class, "getClass", MethodType.methodType(Class.class)));, +                MEGAMORPHIC_LOOKUP = mh.asType(mh.type().changeReturnType(MethodHandle.class));]
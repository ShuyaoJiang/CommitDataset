[+++ b/src/main/java/org/elasticsearch/action/admin/indices/close/TransportCloseIndexAction.java, +import org.elasticsearch.cluster.metadata.MetaDataIndexStateService;, +    private final MetaDataIndexStateService stateIndexService;, +                                     ThreadPool threadPool, MetaDataIndexStateService stateIndexService) {, +        stateIndexService.closeIndex(new MetaDataIndexStateService.Request(request.indices()).timeout(request.timeout()).masterTimeout(request.masterNodeTimeout()), new MetaDataIndexStateService.Listener() {, +            public void onResponse(MetaDataIndexStateService.Response response) {, +++ b/src/main/java/org/elasticsearch/action/admin/indices/close/TransportCloseIndexAction.java, +import org.elasticsearch.cluster.metadata.MetaDataIndexStateService;, +    private final MetaDataIndexStateService stateIndexService;, +                                     ThreadPool threadPool, MetaDataIndexStateService stateIndexService) {, +        stateIndexService.closeIndex(new MetaDataIndexStateService.Request(request.indices()).timeout(request.timeout()).masterTimeout(request.masterNodeTimeout()), new MetaDataIndexStateService.Listener() {, +            public void onResponse(MetaDataIndexStateService.Response response) {, +++ b/src/main/java/org/elasticsearch/action/admin/indices/open/TransportOpenIndexAction.java, +import org.elasticsearch.cluster.metadata.MetaDataIndexStateService;, +    private final MetaDataIndexStateService stateIndexService;, +                                    ThreadPool threadPool, MetaDataIndexStateService stateIndexService) {, +        stateIndexService.openIndex(new MetaDataIndexStateService.Request(request.indices()).timeout(request.timeout()).masterTimeout(request.masterNodeTimeout()), new MetaDataIndexStateService.Listener() {, +            public void onResponse(MetaDataIndexStateService.Response response) {, +++ b/src/main/java/org/elasticsearch/action/admin/indices/close/TransportCloseIndexAction.java, +import org.elasticsearch.cluster.metadata.MetaDataIndexStateService;, +    private final MetaDataIndexStateService stateIndexService;, +                                     ThreadPool threadPool, MetaDataIndexStateService stateIndexService) {, +        stateIndexService.closeIndex(new MetaDataIndexStateService.Request(request.indices()).timeout(request.timeout()).masterTimeout(request.masterNodeTimeout()), new MetaDataIndexStateService.Listener() {, +            public void onResponse(MetaDataIndexStateService.Response response) {, +++ b/src/main/java/org/elasticsearch/action/admin/indices/open/TransportOpenIndexAction.java, +import org.elasticsearch.cluster.metadata.MetaDataIndexStateService;, +    private final MetaDataIndexStateService stateIndexService;, +                                    ThreadPool threadPool, MetaDataIndexStateService stateIndexService) {, +        stateIndexService.openIndex(new MetaDataIndexStateService.Request(request.indices()).timeout(request.timeout()).masterTimeout(request.masterNodeTimeout()), new MetaDataIndexStateService.Listener() {, +            public void onResponse(MetaDataIndexStateService.Response response) {, +++ b/src/main/java/org/elasticsearch/cluster/ClusterModule.java, +        bind(MetaDataIndexStateService.class).asEagerSingleton();, +++ b/src/main/java/org/elasticsearch/action/admin/indices/close/TransportCloseIndexAction.java, +import org.elasticsearch.cluster.metadata.MetaDataIndexStateService;, +    private final MetaDataIndexStateService stateIndexService;, +                                     ThreadPool threadPool, MetaDataIndexStateService stateIndexService) {, +        stateIndexService.closeIndex(new MetaDataIndexStateService.Request(request.indices()).timeout(request.timeout()).masterTimeout(request.masterNodeTimeout()), new MetaDataIndexStateService.Listener() {, +            public void onResponse(MetaDataIndexStateService.Response response) {, +++ b/src/main/java/org/elasticsearch/action/admin/indices/open/TransportOpenIndexAction.java, +import org.elasticsearch.cluster.metadata.MetaDataIndexStateService;, +    private final MetaDataIndexStateService stateIndexService;, +                                    ThreadPool threadPool, MetaDataIndexStateService stateIndexService) {, +        stateIndexService.openIndex(new MetaDataIndexStateService.Request(request.indices()).timeout(request.timeout()).masterTimeout(request.masterNodeTimeout()), new MetaDataIndexStateService.Listener() {, +            public void onResponse(MetaDataIndexStateService.Response response) {, +++ b/src/main/java/org/elasticsearch/cluster/ClusterModule.java, +        bind(MetaDataIndexStateService.class).asEagerSingleton();, +++ b/src/main/java/org/elasticsearch/cluster/block/ClusterBlocks.java, +import org.elasticsearch.cluster.metadata.MetaDataIndexStateService;, +                addIndexBlock(indexMetaData.index(), MetaDataIndexStateService.INDEX_CLOSED_BLOCK);, +++ b/src/main/java/org/elasticsearch/action/admin/indices/close/TransportCloseIndexAction.java, +import org.elasticsearch.cluster.metadata.MetaDataIndexStateService;, +    private final MetaDataIndexStateService stateIndexService;, +                                     ThreadPool threadPool, MetaDataIndexStateService stateIndexService) {, +        stateIndexService.closeIndex(new MetaDataIndexStateService.Request(request.indices()).timeout(request.timeout()).masterTimeout(request.masterNodeTimeout()), new MetaDataIndexStateService.Listener() {, +            public void onResponse(MetaDataIndexStateService.Response response) {, +++ b/src/main/java/org/elasticsearch/action/admin/indices/open/TransportOpenIndexAction.java, +import org.elasticsearch.cluster.metadata.MetaDataIndexStateService;, +    private final MetaDataIndexStateService stateIndexService;, +                                    ThreadPool threadPool, MetaDataIndexStateService stateIndexService) {, +        stateIndexService.openIndex(new MetaDataIndexStateService.Request(request.indices()).timeout(request.timeout()).masterTimeout(request.masterNodeTimeout()), new MetaDataIndexStateService.Listener() {, +            public void onResponse(MetaDataIndexStateService.Response response) {, +++ b/src/main/java/org/elasticsearch/cluster/ClusterModule.java, +        bind(MetaDataIndexStateService.class).asEagerSingleton();, +++ b/src/main/java/org/elasticsearch/cluster/block/ClusterBlocks.java, +import org.elasticsearch.cluster.metadata.MetaDataIndexStateService;, +                addIndexBlock(indexMetaData.index(), MetaDataIndexStateService.INDEX_CLOSED_BLOCK);, +++ b/src/main/java/org/elasticsearch/cluster/metadata/MetaDataCreateIndexService.java, +                        blocks.addIndexBlock(request.index, MetaDataIndexStateService.INDEX_CLOSED_BLOCK);, +++ b/src/main/java/org/elasticsearch/action/admin/indices/close/TransportCloseIndexAction.java, +import org.elasticsearch.cluster.metadata.MetaDataIndexStateService;, +    private final MetaDataIndexStateService stateIndexService;, +                                     ThreadPool threadPool, MetaDataIndexStateService stateIndexService) {, +        stateIndexService.closeIndex(new MetaDataIndexStateService.Request(request.indices()).timeout(request.timeout()).masterTimeout(request.masterNodeTimeout()), new MetaDataIndexStateService.Listener() {, +            public void onResponse(MetaDataIndexStateService.Response response) {, +++ b/src/main/java/org/elasticsearch/action/admin/indices/open/TransportOpenIndexAction.java, +import org.elasticsearch.cluster.metadata.MetaDataIndexStateService;, +    private final MetaDataIndexStateService stateIndexService;, +                                    ThreadPool threadPool, MetaDataIndexStateService stateIndexService) {, +        stateIndexService.openIndex(new MetaDataIndexStateService.Request(request.indices()).timeout(request.timeout()).masterTimeout(request.masterNodeTimeout()), new MetaDataIndexStateService.Listener() {, +            public void onResponse(MetaDataIndexStateService.Response response) {, +++ b/src/main/java/org/elasticsearch/cluster/ClusterModule.java, +        bind(MetaDataIndexStateService.class).asEagerSingleton();, +++ b/src/main/java/org/elasticsearch/cluster/block/ClusterBlocks.java, +import org.elasticsearch.cluster.metadata.MetaDataIndexStateService;, +                addIndexBlock(indexMetaData.index(), MetaDataIndexStateService.INDEX_CLOSED_BLOCK);, +++ b/src/main/java/org/elasticsearch/cluster/metadata/MetaDataCreateIndexService.java, +                        blocks.addIndexBlock(request.index, MetaDataIndexStateService.INDEX_CLOSED_BLOCK);, +++ b/src/main/java/org/elasticsearch/cluster/metadata/MetaDataIndexStateService.java, +/*, + * Licensed to ElasticSearch and Shay Banon under one, + * or more contributor license agreements.  See the NOTICE file, + * distributed with this work for additional information, + * regarding copyright ownership. ElasticSearch licenses this, + * file to you under the Apache License, Version 2.0 (the, + * "License"); you may not use this file except in compliance, + * with the License.  You may obtain a copy of the License at, + *, + *    http://www.apache.org/licenses/LICENSE-2.0, + *, + * Unless required by applicable law or agreed to in writing,]
[+++ b/modules/elasticsearch/src/main/java/org/elasticsearch/gateway/blobstore/BlobStoreGateway.java, +import org.elasticsearch.common.compress.lzf.LZFOutputStream;, +import org.elasticsearch.common.io.FastByteArrayOutputStream;, +import java.io.OutputStream;, +            FastByteArrayOutputStream out = new FastByteArrayOutputStream();, +            OutputStream os = out;, +                os = new LZFOutputStream(os);, +            XContentBuilder builder = XContentFactory.contentBuilder(XContentType.JSON, os);, +            metaDataBlobContainer.writeBlob(newMetaData, new ByteArrayInputStream(out.unsafeByteArray(), 0, out.size()), out.size());]
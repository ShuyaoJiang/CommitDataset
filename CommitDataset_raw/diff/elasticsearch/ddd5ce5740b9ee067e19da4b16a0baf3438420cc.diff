[+++ b/x-pack/plugin/ccr/src/test/java/org/elasticsearch/xpack/ccr/action/ShardChangesActionTests.java, +        final int numWrites = randomIntBetween(10, 4096);, +, +        // invalid range, +        {, +            final long fromSeqNo = randomLongBetween(Long.MIN_VALUE, -1);, +            final int batchSize = randomIntBetween(0, Integer.MAX_VALUE);, +            final IllegalArgumentException invalidRangeError = expectThrows(IllegalArgumentException.class,, +                () -> ShardChangesAction.getOperations(indexShard, indexShard.getGlobalCheckpoint(),, +                    fromSeqNo, batchSize, indexShard.getHistoryUUID(), Long.MAX_VALUE));, +            assertThat(invalidRangeError.getMessage(),, +                equalTo("Invalid range; from_seqno [" + fromSeqNo + "], to_seqno [" + (fromSeqNo + batchSize - 1) + "]"));, +        }]
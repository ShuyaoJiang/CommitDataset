[+++ b/src/main/java/org/elasticsearch/discovery/zen/ZenDiscovery.java, +                        currentState = ClusterState.builder(currentState).nodes(latestDiscoNodes).blocks(clusterBlocks).build();, +, +                        // eagerly run reroute to remove dead nodes from routing table, +                        RoutingAllocation.Result result = allocationService.reroute(currentState);, +                        return ClusterState.builder(currentState).routingResult(result).build();, +++ b/src/main/java/org/elasticsearch/discovery/zen/ZenDiscovery.java, +                        currentState = ClusterState.builder(currentState).nodes(latestDiscoNodes).blocks(clusterBlocks).build();, +, +                        // eagerly run reroute to remove dead nodes from routing table, +                        RoutingAllocation.Result result = allocationService.reroute(currentState);, +                        return ClusterState.builder(currentState).routingResult(result).build();, +++ b/src/test/java/org/elasticsearch/recovery/FullRollingRestartTests.java, +import static org.elasticsearch.test.ElasticsearchIntegrationTest.Scope;, +    @TestLogging("indices.cluster:TRACE,cluster.service:TRACE,action.search:TRACE,indices.recovery:TRACE")]
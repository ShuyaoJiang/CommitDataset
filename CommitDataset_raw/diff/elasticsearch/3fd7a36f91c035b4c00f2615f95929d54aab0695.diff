[+++ b/core/bin/plugin, +exec "$JAVA" $JAVA_OPTS $ES_JAVA_OPTS -Xmx64m -Xms16m -Delasticsearch -Des.path.home="$ES_HOME" $properties -cp "$ES_HOME/lib/*" org.elasticsearch.plugins.PluginManager $args, +++ b/core/bin/plugin, +exec "$JAVA" $JAVA_OPTS $ES_JAVA_OPTS -Xmx64m -Xms16m -Delasticsearch -Des.path.home="$ES_HOME" $properties -cp "$ES_HOME/lib/*" org.elasticsearch.plugins.PluginManager $args, +++ b/core/bin/plugin.bat, +"%JAVA_HOME%\bin\java" %JAVA_OPTS% %ES_JAVA_OPTS% -Xmx64m -Xms16m -Des.path.home="%ES_HOME%" -cp "%ES_HOME%/lib/*;" "org.elasticsearch.plugins.PluginManager" %*, +++ b/core/bin/plugin, +exec "$JAVA" $JAVA_OPTS $ES_JAVA_OPTS -Xmx64m -Xms16m -Delasticsearch -Des.path.home="$ES_HOME" $properties -cp "$ES_HOME/lib/*" org.elasticsearch.plugins.PluginManager $args, +++ b/core/bin/plugin.bat, +"%JAVA_HOME%\bin\java" %JAVA_OPTS% %ES_JAVA_OPTS% -Xmx64m -Xms16m -Des.path.home="%ES_HOME%" -cp "%ES_HOME%/lib/*;" "org.elasticsearch.plugins.PluginManager" %*, +++ b/core/src/main/java/org/elasticsearch/index/fielddata/IndexFieldDataService.java, +            return (IFD) builder.build(index, indexSettings, fieldType, cache, circuitBreakerService, indexService.mapperService());, +++ b/core/bin/plugin, +exec "$JAVA" $JAVA_OPTS $ES_JAVA_OPTS -Xmx64m -Xms16m -Delasticsearch -Des.path.home="$ES_HOME" $properties -cp "$ES_HOME/lib/*" org.elasticsearch.plugins.PluginManager $args, +++ b/core/bin/plugin.bat, +"%JAVA_HOME%\bin\java" %JAVA_OPTS% %ES_JAVA_OPTS% -Xmx64m -Xms16m -Des.path.home="%ES_HOME%" -cp "%ES_HOME%/lib/*;" "org.elasticsearch.plugins.PluginManager" %*, +++ b/core/src/main/java/org/elasticsearch/index/fielddata/IndexFieldDataService.java, +            return (IFD) builder.build(index, indexSettings, fieldType, cache, circuitBreakerService, indexService.mapperService());, +++ b/core/src/main/java/org/elasticsearch/index/mapper/MapperService.java, +    public MapperService(Index index, @IndexSettings Settings indexSettings, AnalysisService analysisService,, +++ b/core/bin/plugin, +exec "$JAVA" $JAVA_OPTS $ES_JAVA_OPTS -Xmx64m -Xms16m -Delasticsearch -Des.path.home="$ES_HOME" $properties -cp "$ES_HOME/lib/*" org.elasticsearch.plugins.PluginManager $args, +++ b/core/bin/plugin.bat, +"%JAVA_HOME%\bin\java" %JAVA_OPTS% %ES_JAVA_OPTS% -Xmx64m -Xms16m -Des.path.home="%ES_HOME%" -cp "%ES_HOME%/lib/*;" "org.elasticsearch.plugins.PluginManager" %*, +++ b/core/src/main/java/org/elasticsearch/index/fielddata/IndexFieldDataService.java, +            return (IFD) builder.build(index, indexSettings, fieldType, cache, circuitBreakerService, indexService.mapperService());, +++ b/core/src/main/java/org/elasticsearch/index/mapper/MapperService.java, +    public MapperService(Index index, @IndexSettings Settings indexSettings, AnalysisService analysisService,, +++ b/core/src/main/java/org/elasticsearch/plugins/PluginManager.java, +import org.elasticsearch.common.SuppressForbidden;, +import java.io.PrintStream;, +++ b/core/bin/plugin, +exec "$JAVA" $JAVA_OPTS $ES_JAVA_OPTS -Xmx64m -Xms16m -Delasticsearch -Des.path.home="$ES_HOME" $properties -cp "$ES_HOME/lib/*" org.elasticsearch.plugins.PluginManager $args, +++ b/core/bin/plugin.bat, +"%JAVA_HOME%\bin\java" %JAVA_OPTS% %ES_JAVA_OPTS% -Xmx64m -Xms16m -Des.path.home="%ES_HOME%" -cp "%ES_HOME%/lib/*;" "org.elasticsearch.plugins.PluginManager" %*, +++ b/core/src/main/java/org/elasticsearch/index/fielddata/IndexFieldDataService.java, +            return (IFD) builder.build(index, indexSettings, fieldType, cache, circuitBreakerService, indexService.mapperService());, +++ b/core/src/main/java/org/elasticsearch/index/mapper/MapperService.java, +    public MapperService(Index index, @IndexSettings Settings indexSettings, AnalysisService analysisService,, +++ b/core/src/main/java/org/elasticsearch/plugins/PluginManager.java, +import org.elasticsearch.common.SuppressForbidden;, +import java.io.PrintStream;, +++ b/core/src/test/java/org/elasticsearch/index/engine/InternalEngineTests.java, +, +            MapperService mapperService = new MapperService(index, settings, analysisService, similarityLookupService, null);, +++ b/core/bin/plugin, +exec "$JAVA" $JAVA_OPTS $ES_JAVA_OPTS -Xmx64m -Xms16m -Delasticsearch -Des.path.home="$ES_HOME" $properties -cp "$ES_HOME/lib/*" org.elasticsearch.plugins.PluginManager $args, +++ b/core/bin/plugin.bat, +"%JAVA_HOME%\bin\java" %JAVA_OPTS% %ES_JAVA_OPTS% -Xmx64m -Xms16m -Des.path.home="%ES_HOME%" -cp "%ES_HOME%/lib/*;" "org.elasticsearch.plugins.PluginManager" %*, +++ b/core/src/main/java/org/elasticsearch/index/fielddata/IndexFieldDataService.java, +            return (IFD) builder.build(index, indexSettings, fieldType, cache, circuitBreakerService, indexService.mapperService());, +++ b/core/src/main/java/org/elasticsearch/index/mapper/MapperService.java, +    public MapperService(Index index, @IndexSettings Settings indexSettings, AnalysisService analysisService,, +++ b/core/src/main/java/org/elasticsearch/plugins/PluginManager.java, +import org.elasticsearch.common.SuppressForbidden;, +import java.io.PrintStream;, +++ b/core/src/test/java/org/elasticsearch/index/engine/InternalEngineTests.java, +, +            MapperService mapperService = new MapperService(index, settings, analysisService, similarityLookupService, null);, +++ b/core/src/test/java/org/elasticsearch/index/fielddata/IndexFieldDataServiceTests.java, +++ b/core/bin/plugin, +exec "$JAVA" $JAVA_OPTS $ES_JAVA_OPTS -Xmx64m -Xms16m -Delasticsearch -Des.path.home="$ES_HOME" $properties -cp "$ES_HOME/lib/*" org.elasticsearch.plugins.PluginManager $args, +++ b/core/bin/plugin.bat, +"%JAVA_HOME%\bin\java" %JAVA_OPTS% %ES_JAVA_OPTS% -Xmx64m -Xms16m -Des.path.home="%ES_HOME%" -cp "%ES_HOME%/lib/*;" "org.elasticsearch.plugins.PluginManager" %*, +++ b/core/src/main/java/org/elasticsearch/index/fielddata/IndexFieldDataService.java, +            return (IFD) builder.build(index, indexSettings, fieldType, cache, circuitBreakerService, indexService.mapperService());, +++ b/core/src/main/java/org/elasticsearch/index/mapper/MapperService.java, +    public MapperService(Index index, @IndexSettings Settings indexSettings, AnalysisService analysisService,, +++ b/core/src/main/java/org/elasticsearch/plugins/PluginManager.java, +import org.elasticsearch.common.SuppressForbidden;, +import java.io.PrintStream;, +++ b/core/src/test/java/org/elasticsearch/index/engine/InternalEngineTests.java, +, +            MapperService mapperService = new MapperService(index, settings, analysisService, similarityLookupService, null);, +++ b/core/src/test/java/org/elasticsearch/index/fielddata/IndexFieldDataServiceTests.java, +++ b/core/src/test/java/org/elasticsearch/plugins/PluginManagerTests.java, +        try {, +            Files.createDirectories(initialSettings.v2().pluginsFile());, +        } catch (IOException e) {, +            throw new RuntimeException(e);, +        }, +, +++ b/core/bin/plugin, +exec "$JAVA" $JAVA_OPTS $ES_JAVA_OPTS -Xmx64m -Xms16m -Delasticsearch -Des.path.home="$ES_HOME" $properties -cp "$ES_HOME/lib/*" org.elasticsearch.plugins.PluginManager $args, +++ b/core/bin/plugin.bat, +"%JAVA_HOME%\bin\java" %JAVA_OPTS% %ES_JAVA_OPTS% -Xmx64m -Xms16m -Des.path.home="%ES_HOME%" -cp "%ES_HOME%/lib/*;" "org.elasticsearch.plugins.PluginManager" %*, +++ b/core/src/main/java/org/elasticsearch/index/fielddata/IndexFieldDataService.java, +            return (IFD) builder.build(index, indexSettings, fieldType, cache, circuitBreakerService, indexService.mapperService());, +++ b/core/src/main/java/org/elasticsearch/index/mapper/MapperService.java, +    public MapperService(Index index, @IndexSettings Settings indexSettings, AnalysisService analysisService,, +++ b/core/src/main/java/org/elasticsearch/plugins/PluginManager.java, +import org.elasticsearch.common.SuppressForbidden;, +import java.io.PrintStream;, +++ b/core/src/test/java/org/elasticsearch/index/engine/InternalEngineTests.java, +, +            MapperService mapperService = new MapperService(index, settings, analysisService, similarityLookupService, null);, +++ b/core/src/test/java/org/elasticsearch/index/fielddata/IndexFieldDataServiceTests.java, +++ b/core/src/test/java/org/elasticsearch/plugins/PluginManagerTests.java, +        try {, +            Files.createDirectories(initialSettings.v2().pluginsFile());]
[+++ b/x-pack/plugin/sql/sql-client/src/main/java/org/elasticsearch/xpack/sql/client/JreHttpUrlConnection.java, +    private static final String SQL_NOT_AVAILABLE_ERROR_MESSAGE = "request [/_xpack/sql] contains unrecognized parameter: [mode]";, +            // check if x-pack or sql are not available (x-pack not installed or sql not enabled), +            // by checking the error message the server is sending back , +            if (con.getResponseCode() >= HttpURLConnection.HTTP_BAD_REQUEST, +                    && failure.reason().contains(SQL_NOT_AVAILABLE_ERROR_MESSAGE)) {, +                return new ResponseOrException<>(new SQLException("X-Pack/SQL do not seem to be available", +                        + " on the Elasticsearch node using the access path '", +                        + con.getURL().getHost(), +                        + (con.getURL().getPort() > 0 ? ":" + con.getURL().getPort() : ""), +                        + "'.", +                        + " Please verify X-Pack is installed and SQL enabled. Alternatively, check if any proxy is interfering", +                        + " the communication to Elasticsearch",, +                        SQL_STATE_BAD_SERVER));, +            }]
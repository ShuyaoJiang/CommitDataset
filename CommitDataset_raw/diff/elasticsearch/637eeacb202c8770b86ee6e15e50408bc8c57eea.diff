[+++ b/src/main/java/org/elasticsearch/search/facet/statistical/StatisticalFacetParser.java, +import org.elasticsearch.index.mapper.core.NumberFieldMapper;, +                if (!(fieldMapper instanceof NumberFieldMapper)) {, +                    throw new FacetPhaseExecutionException(facetName, "field [" + field + "] isn't a number field, but a " + fieldMapper.fieldDataType().getType());, +                }, +            if (!(fieldMapper instanceof NumberFieldMapper)) {, +                throw new FacetPhaseExecutionException(facetName, "field [" + field + "] isn't a number field, but a " + fieldMapper.fieldDataType().getType());, +            }, +++ b/src/main/java/org/elasticsearch/search/facet/statistical/StatisticalFacetParser.java, +import org.elasticsearch.index.mapper.core.NumberFieldMapper;, +                if (!(fieldMapper instanceof NumberFieldMapper)) {, +                    throw new FacetPhaseExecutionException(facetName, "field [" + field + "] isn't a number field, but a " + fieldMapper.fieldDataType().getType());, +                }, +            if (!(fieldMapper instanceof NumberFieldMapper)) {, +                throw new FacetPhaseExecutionException(facetName, "field [" + field + "] isn't a number field, but a " + fieldMapper.fieldDataType().getType());, +            }, +++ b/src/main/java/org/elasticsearch/search/facet/termsstats/TermsStatsFacetParser.java, +import org.elasticsearch.index.mapper.core.NumberFieldMapper;, +            FieldMapper fieldMapper = context.smartNameFieldMapper(valueField);, +            if (!(fieldMapper instanceof NumberFieldMapper)) {, +                throw new FacetPhaseExecutionException(facetName, "value_field [" + valueField + "] isn't a number field, but a " + fieldMapper.fieldDataType().getType());, +            }, +            valueIndexFieldData = context.fieldData().getForField(fieldMapper);]
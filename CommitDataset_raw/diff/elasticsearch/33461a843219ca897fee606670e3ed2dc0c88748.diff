[+++ b/core/src/main/java/org/elasticsearch/index/query/InnerHitBuilder.java, +import org.elasticsearch.search.fetch.docvalues.DocValueFieldsContext;, +import org.elasticsearch.search.fetch.docvalues.DocValueFieldsFetchSubPhase;, +            DocValueFieldsContext docValueFieldsContext = innerHitsContext, +                    .getFetchSubPhaseContext(DocValueFieldsFetchSubPhase.CONTEXT_FACTORY);, +                docValueFieldsContext.add(new DocValueFieldsContext.DocValueField(field));, +            docValueFieldsContext.setHitExecutionNeeded(true);, +++ b/core/src/main/java/org/elasticsearch/index/query/InnerHitBuilder.java, +import org.elasticsearch.search.fetch.docvalues.DocValueFieldsContext;, +import org.elasticsearch.search.fetch.docvalues.DocValueFieldsFetchSubPhase;, +            DocValueFieldsContext docValueFieldsContext = innerHitsContext, +                    .getFetchSubPhaseContext(DocValueFieldsFetchSubPhase.CONTEXT_FACTORY);, +                docValueFieldsContext.add(new DocValueFieldsContext.DocValueField(field));, +            docValueFieldsContext.setHitExecutionNeeded(true);, +++ b/core/src/main/java/org/elasticsearch/search/SearchModule.java, +import org.elasticsearch.search.fetch.docvalues.DocValueFieldsFetchSubPhase;, +        registerFetchSubPhase(new DocValueFieldsFetchSubPhase());, +++ b/core/src/main/java/org/elasticsearch/index/query/InnerHitBuilder.java, +import org.elasticsearch.search.fetch.docvalues.DocValueFieldsContext;, +import org.elasticsearch.search.fetch.docvalues.DocValueFieldsFetchSubPhase;, +            DocValueFieldsContext docValueFieldsContext = innerHitsContext, +                    .getFetchSubPhaseContext(DocValueFieldsFetchSubPhase.CONTEXT_FACTORY);, +                docValueFieldsContext.add(new DocValueFieldsContext.DocValueField(field));, +            docValueFieldsContext.setHitExecutionNeeded(true);, +++ b/core/src/main/java/org/elasticsearch/search/SearchModule.java, +import org.elasticsearch.search.fetch.docvalues.DocValueFieldsFetchSubPhase;, +        registerFetchSubPhase(new DocValueFieldsFetchSubPhase());, +++ b/core/src/main/java/org/elasticsearch/search/SearchService.java, +import org.elasticsearch.search.fetch.docvalues.DocValueFieldsContext;, +import org.elasticsearch.search.fetch.docvalues.DocValueFieldsContext.DocValueField;, +import org.elasticsearch.search.fetch.docvalues.DocValueFieldsFetchSubPhase;, +            DocValueFieldsContext docValuesFieldsContext = context.getFetchSubPhaseContext(DocValueFieldsFetchSubPhase.CONTEXT_FACTORY);, +                docValuesFieldsContext.add(new DocValueField(field));, +            docValuesFieldsContext.setHitExecutionNeeded(true);, +++ b/core/src/main/java/org/elasticsearch/index/query/InnerHitBuilder.java, +import org.elasticsearch.search.fetch.docvalues.DocValueFieldsContext;, +import org.elasticsearch.search.fetch.docvalues.DocValueFieldsFetchSubPhase;, +            DocValueFieldsContext docValueFieldsContext = innerHitsContext, +                    .getFetchSubPhaseContext(DocValueFieldsFetchSubPhase.CONTEXT_FACTORY);, +                docValueFieldsContext.add(new DocValueFieldsContext.DocValueField(field));, +            docValueFieldsContext.setHitExecutionNeeded(true);, +++ b/core/src/main/java/org/elasticsearch/search/SearchModule.java, +import org.elasticsearch.search.fetch.docvalues.DocValueFieldsFetchSubPhase;, +        registerFetchSubPhase(new DocValueFieldsFetchSubPhase());, +++ b/core/src/main/java/org/elasticsearch/search/SearchService.java, +import org.elasticsearch.search.fetch.docvalues.DocValueFieldsContext;, +import org.elasticsearch.search.fetch.docvalues.DocValueFieldsContext.DocValueField;, +import org.elasticsearch.search.fetch.docvalues.DocValueFieldsFetchSubPhase;, +            DocValueFieldsContext docValuesFieldsContext = context.getFetchSubPhaseContext(DocValueFieldsFetchSubPhase.CONTEXT_FACTORY);, +                docValuesFieldsContext.add(new DocValueField(field));, +            docValuesFieldsContext.setHitExecutionNeeded(true);, +++ b/core/src/main/java/org/elasticsearch/search/aggregations/metrics/tophits/TopHitsAggregatorFactory.java, +import org.elasticsearch.search.fetch.docvalues.DocValueFieldsContext;, +import org.elasticsearch.search.fetch.docvalues.DocValueFieldsContext.DocValueField;, +import org.elasticsearch.search.fetch.docvalues.DocValueFieldsFetchSubPhase;, +    private final List<String> docValueFields;, +            List<SortBuilder<?>> sorts, HighlightBuilder highlightBuilder, List<String> fieldNames, List<String> docValueFields,, +        this.docValueFields = docValueFields;, +        if (docValueFields != null) {, +            DocValueFieldsContext docValueFieldsContext = subSearchContext, +                    .getFetchSubPhaseContext(DocValueFieldsFetchSubPhase.CONTEXT_FACTORY);, +            for (String field : docValueFields) {, +                docValueFieldsContext.add(new DocValueField(field));, +            docValueFieldsContext.setHitExecutionNeeded(true);, +++ b/core/src/main/java/org/elasticsearch/index/query/InnerHitBuilder.java, +import org.elasticsearch.search.fetch.docvalues.DocValueFieldsContext;, +import org.elasticsearch.search.fetch.docvalues.DocValueFieldsFetchSubPhase;, +            DocValueFieldsContext docValueFieldsContext = innerHitsContext, +                    .getFetchSubPhaseContext(DocValueFieldsFetchSubPhase.CONTEXT_FACTORY);, +                docValueFieldsContext.add(new DocValueFieldsContext.DocValueField(field));, +            docValueFieldsContext.setHitExecutionNeeded(true);, +++ b/core/src/main/java/org/elasticsearch/search/SearchModule.java, +import org.elasticsearch.search.fetch.docvalues.DocValueFieldsFetchSubPhase;, +        registerFetchSubPhase(new DocValueFieldsFetchSubPhase());, +++ b/core/src/main/java/org/elasticsearch/search/SearchService.java, +import org.elasticsearch.search.fetch.docvalues.DocValueFieldsContext;, +import org.elasticsearch.search.fetch.docvalues.DocValueFieldsContext.DocValueField;, +import org.elasticsearch.search.fetch.docvalues.DocValueFieldsFetchSubPhase;, +            DocValueFieldsContext docValuesFieldsContext = context.getFetchSubPhaseContext(DocValueFieldsFetchSubPhase.CONTEXT_FACTORY);, +                docValuesFieldsContext.add(new DocValueField(field));, +            docValuesFieldsContext.setHitExecutionNeeded(true);, +++ b/core/src/main/java/org/elasticsearch/search/aggregations/metrics/tophits/TopHitsAggregatorFactory.java, +import org.elasticsearch.search.fetch.docvalues.DocValueFieldsContext;, +import org.elasticsearch.search.fetch.docvalues.DocValueFieldsContext.DocValueField;, +import org.elasticsearch.search.fetch.docvalues.DocValueFieldsFetchSubPhase;, +    private final List<String> docValueFields;, +            List<SortBuilder<?>> sorts, HighlightBuilder highlightBuilder, List<String> fieldNames, List<String> docValueFields,, +        this.docValueFields = docValueFields;, +        if (docValueFields != null) {, +            DocValueFieldsContext docValueFieldsContext = subSearchContext, +                    .getFetchSubPhaseContext(DocValueFieldsFetchSubPhase.CONTEXT_FACTORY);, +            for (String field : docValueFields) {, +                docValueFieldsContext.add(new DocValueField(field));, +            docValueFieldsContext.setHitExecutionNeeded(true);, +++ b/core/src/main/java/org/elasticsearch/search/fetch/FetchSubPhaseContext.java, +import org.elasticsearch.search.fetch.docvalues.DocValueFieldsContext;, +, + * See {@link org.elasticsearch.search.fetch.FetchSubPhase.ContextFactory} and also {@link DocValueFieldsContext} for an example., +++ b/core/src/main/java/org/elasticsearch/index/query/InnerHitBuilder.java, +import org.elasticsearch.search.fetch.docvalues.DocValueFieldsContext;]
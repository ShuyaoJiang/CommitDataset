[+++ b/x-pack/plugin/ccr/src/main/java/org/elasticsearch/xpack/ccr/action/ShardFollowTasksExecutor.java, +import org.apache.lucene.store.AlreadyClosedException;, +                if (commitStats == null) {, +                    // If commitStats is null then AlreadyClosedException has been thrown: TransportIndicesStatsAction#shardOperation(...), +                    // AlreadyClosedException will be retried byShardFollowNodeTask.shouldRetry(...), +                    errorHandler.accept(new AlreadyClosedException(shardId + " commit_stats are missing"));, +                    return;, +                }, +                if (seqNoStats == null) {, +                    // If seqNoStats is null then AlreadyClosedException has been thrown at TransportIndicesStatsAction#shardOperation(...), +                    // AlreadyClosedException will be retried byShardFollowNodeTask.shouldRetry(...), +                    errorHandler.accept(new AlreadyClosedException(shardId + " seq_no_stats are missing"));, +                    return;, +                }, +, +                final String historyUUID = commitStats.getUserData().get(Engine.HISTORY_UUID_KEY);, +++ b/x-pack/plugin/ccr/src/main/java/org/elasticsearch/xpack/ccr/action/ShardFollowTasksExecutor.java, +import org.apache.lucene.store.AlreadyClosedException;, +                if (commitStats == null) {, +                    // If commitStats is null then AlreadyClosedException has been thrown: TransportIndicesStatsAction#shardOperation(...), +                    // AlreadyClosedException will be retried byShardFollowNodeTask.shouldRetry(...), +                    errorHandler.accept(new AlreadyClosedException(shardId + " commit_stats are missing"));, +                    return;, +                }, +                if (seqNoStats == null) {, +                    // If seqNoStats is null then AlreadyClosedException has been thrown at TransportIndicesStatsAction#shardOperation(...), +                    // AlreadyClosedException will be retried byShardFollowNodeTask.shouldRetry(...), +                    errorHandler.accept(new AlreadyClosedException(shardId + " seq_no_stats are missing"));, +                    return;, +                }, +, +                final String historyUUID = commitStats.getUserData().get(Engine.HISTORY_UUID_KEY);, +++ b/x-pack/plugin/ccr/src/test/java/org/elasticsearch/xpack/ccr/FollowStatsIT.java]
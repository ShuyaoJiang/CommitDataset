[+++ b/core/src/test/java/org/elasticsearch/index/shard/NewPathForShardTest.java, +import java.io.IOException;, +import java.lang.reflect.Field;, +import java.nio.file.FileStore;, +import java.nio.file.FileSystem;, +import java.nio.file.FileSystems;, +import java.nio.file.Files;, +import java.nio.file.Path;, +import java.nio.file.attribute.FileAttributeView;, +import java.nio.file.attribute.FileStoreAttributeView;, +import java.util.ArrayList;, +import java.util.Arrays;, +import java.util.List;, +import java.util.Set;, +import org.elasticsearch.env.NodeEnvironment.NodePath;, +import com.carrotsearch.randomizedtesting.annotations.Repeat;, +            return desc;, +        Path path = PathUtils.get(createTempDir().toString());, +        String[] paths = new String[] {path.resolve("a").toString(),, +                                       path.resolve("b").toString()};, +, +        // Make sure all our mocking above actually worked:, +        NodePath[] nodePaths = nodeEnv.nodePaths();, +        assertEquals(2, nodePaths.length);, +, +        assertEquals("mocka", nodePaths[0].fileStore.name());, +        assertEquals("mockb", nodePaths[1].fileStore.name());]
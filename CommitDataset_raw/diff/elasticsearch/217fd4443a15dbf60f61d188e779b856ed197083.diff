[+++ b/src/main/java/org/elasticsearch/index/engine/InternalEngine.java, +import org.elasticsearch.common.logging.ESLogger;, +import org.elasticsearch.index.shard.ShardId;, +            this.searcherFactory = new SearchFactory(logger, isClosed, engineConfig);, +    final static class SearchFactory extends EngineSearcherFactory {, +        private final IndicesWarmer warmer;, +        private final ShardId shardId;, +        private final ESLogger logger;, +        private final AtomicBoolean isEngineClosed;, +, +        SearchFactory(ESLogger logger, AtomicBoolean isEngineClosed, EngineConfig engineConfig) {, +            warmer = engineConfig.getWarmer();, +            shardId = engineConfig.getShardId();, +            this.logger = logger;, +            this.isEngineClosed = isEngineClosed;, +                    if (previousReader == null) {, +                        for (LeafReaderContext newReaderContext : reader.leaves()) {, +                            for (LeafReaderContext currentReaderContext : previousReader.leaves()) {, +                    if (isEngineClosed.get() == false) {]
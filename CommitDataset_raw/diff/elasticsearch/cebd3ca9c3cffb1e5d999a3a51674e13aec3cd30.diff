[+++ b/src/main/java/org/elasticsearch/action/support/nodes/TransportNodesOperationAction.java, +            for (int i = 0; i < nodesIds.length; i++) {, +                final String nodeId = nodesIds[i];, +                final int idx = i;, +                                    onOperation(idx, nodeOperation(newNodeRequest(clusterState.nodes().localNodeId(), request)));, +                                    onFailure(idx, clusterState.nodes().localNodeId(), e);, +                                    onOperation(idx, nodeOperation(newNodeRequest(clusterState.nodes().masterNodeId(), request)));, +                                    onFailure(idx, clusterState.nodes().masterNodeId(), e);, +                            onFailure(idx, nodeId, new NoSuchNodeException(nodeId));, +                                    onOperation(idx, response);, +                                    onFailure(idx, node.id(), exp);, +                    onFailure(idx, nodeId, t);, +        private void onOperation(int idx, NodeResponse nodeResponse) {, +            responses.set(idx, nodeResponse);, +        private void onFailure(int idx, String nodeId, Throwable t) {]
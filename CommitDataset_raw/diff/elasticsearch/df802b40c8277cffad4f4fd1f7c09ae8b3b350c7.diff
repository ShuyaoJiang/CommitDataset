[+++ b/dev-tools/ci, +            ":x-pack-elasticsearch:qa:sql:security:no-ssl:check", +            ":x-pack-elasticsearch:qa:sql:security:ssl:check", +++ b/dev-tools/ci, +            ":x-pack-elasticsearch:qa:sql:security:no-ssl:check", +            ":x-pack-elasticsearch:qa:sql:security:ssl:check", +++ b/qa/sql/build.gradle, +  if (project.name != 'security') {, +    // The security project just configures it subprojects, +    apply plugin: 'elasticsearch.rest-test', +, +}, +++ b/dev-tools/ci, +            ":x-pack-elasticsearch:qa:sql:security:no-ssl:check", +            ":x-pack-elasticsearch:qa:sql:security:ssl:check", +++ b/qa/sql/build.gradle, +  if (project.name != 'security') {, +    // The security project just configures it subprojects, +    apply plugin: 'elasticsearch.rest-test', +, +}, +++ b/qa/sql/security/build.gradle, +Project mainProject = project, +, +subprojects {, +  // Use resources from the parent project in subprojects, +  sourceSets {, +    test {, +      java {, +        srcDirs = ["${mainProject.projectDir}/src/test/java"], +      }, +      resources {, +        srcDirs = ["${mainProject.projectDir}/src/test/resources"], +      }, +    }, +  }, +, +  dependencies {, +    testCompile(project(path: ':x-pack-elasticsearch:plugin', configuration: 'runtime')) {, +      transitive = false, +    }, +  }, +, +    extraConfigFile 'x-pack/roles.yml', '../roles.yml', +    // Subprojects override the wait condition to work properly with security, +    extraConfigFile 'x-pack/roles.yml', '../roles.yml', +++ b/dev-tools/ci, +            ":x-pack-elasticsearch:qa:sql:security:no-ssl:check", +            ":x-pack-elasticsearch:qa:sql:security:ssl:check", +++ b/qa/sql/build.gradle, +  if (project.name != 'security') {, +    // The security project just configures it subprojects, +    apply plugin: 'elasticsearch.rest-test', +, +}, +++ b/qa/sql/security/build.gradle, +Project mainProject = project, +, +subprojects {, +  // Use resources from the parent project in subprojects, +  sourceSets {, +    test {, +      java {, +        srcDirs = ["${mainProject.projectDir}/src/test/java"], +      }, +      resources {, +        srcDirs = ["${mainProject.projectDir}/src/test/resources"], +      }, +    }, +  }, +, +  dependencies {, +    testCompile(project(path: ':x-pack-elasticsearch:plugin', configuration: 'runtime')) {, +      transitive = false, +    }, +  }, +, +    extraConfigFile 'x-pack/roles.yml', '../roles.yml', +    // Subprojects override the wait condition to work properly with security, +    extraConfigFile 'x-pack/roles.yml', '../roles.yml', +++ b/qa/sql/security/no-ssl/build.gradle, +integTestCluster {, +  waitCondition = { node, ant ->, +    File tmpFile = new File(node.cwd, 'wait.success'), +    ant.get(src: "http://${node.httpUri()}/_cluster/health?wait_for_nodes=>=${numNodes}&wait_for_status=yellow",, +            dest: tmpFile.toString(),, +            username: 'test_admin',, +            password: 'x-pack-test-password',, +            ignoreerrors: true,, +            retries: 10), +    return tmpFile.exists(), +  }, +}, +++ b/dev-tools/ci, +            ":x-pack-elasticsearch:qa:sql:security:no-ssl:check", +            ":x-pack-elasticsearch:qa:sql:security:ssl:check", +++ b/qa/sql/build.gradle, +  if (project.name != 'security') {, +    // The security project just configures it subprojects, +    apply plugin: 'elasticsearch.rest-test']
[+++ b/src/main/java/org/elasticsearch/search/facet/termsstats/TermsStatsFacetParser.java, +            if (fieldMapper == null) {, +                throw new FacetPhaseExecutionException(facetName, "failed to find mapping for " + valueField);, +            } else if (!(fieldMapper instanceof NumberFieldMapper)) {]
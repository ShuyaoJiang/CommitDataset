[+++ b/server/src/test/java/org/elasticsearch/index/engine/CombinedDeletionPolicyTests.java, +import static org.elasticsearch.index.seqno.SequenceNumbers.NO_OPS_PERFORMED;, +                new SoftDeletesPolicy(globalCheckpoint::get, NO_OPS_PERFORMED, extraRetainedOps, Collections::emptyList);, +        assertThat(softDeletesPolicy.getMinRetainedSeqNo(),, +            equalTo(Math.max(NO_OPS_PERFORMED,, +                Math.min(getLocalCheckpoint(commitList.get(keptIndex)) + 1, globalCheckpoint.get() + 1 - extraRetainedOps))));, +                Math.max(NO_OPS_PERFORMED, Math.min(getLocalCheckpoint(safeCommit) + 1, globalCheckpoint.get() + 1 - extraRetainedOps))));, +                Math.max(NO_OPS_PERFORMED,, +                    Math.min(getLocalCheckpoint(commitList.get(safeIndex)) + 1, globalCheckpoint.get() + 1 - extraRetainedOps))));, +            Math.max(NO_OPS_PERFORMED, Math.min(getLocalCheckpoint(safeCommit) + 1, globalCheckpoint.get() + 1 - extraRetainedOps))));]
[+++ b/core/src/main/java/org/elasticsearch/cluster/metadata/MetaDataIndexUpgradeService.java, +import org.elasticsearch.index.store.IndexStoreModule;, +import java.util.Locale;, +        newMetaData = upgradeSettings(newMetaData);, +    IndexMetaData upgradeSettings(IndexMetaData indexMetaData) {, +        final String storeType = indexMetaData.getSettings().get(IndexStoreModule.STORE_TYPE);, +        if (storeType != null) {, +            final String upgradeStoreType;, +            switch (storeType.toLowerCase(Locale.ROOT)) {, +                case "nio_fs":, +                case "niofs":, +                    upgradeStoreType = "niofs";, +                    break;, +                case "mmap_fs":, +                case "mmapfs":, +                    upgradeStoreType = "mmapfs";, +                    break;, +                case "simple_fs":, +                case "simplefs":, +                    upgradeStoreType = "simplefs";, +                    break;, +                case "default":, +                    upgradeStoreType = "default";, +                    break;, +                case "fs":, +                    upgradeStoreType = "fs";, +                    break;, +                default:, +                    upgradeStoreType = storeType;, +            }, +            if (storeType.equals(upgradeStoreType) == false) {, +                Settings indexSettings = Settings.builder().put(indexMetaData.settings()), +                        .put(IndexStoreModule.STORE_TYPE, upgradeStoreType), +                        .build();, +                return IndexMetaData.builder(indexMetaData), +                        .version(indexMetaData.version()), +                        .settings(indexSettings), +                        .build();, +            }, +        }, +        return indexMetaData;, +    }, +, +++ b/core/src/main/java/org/elasticsearch/cluster/metadata/MetaDataIndexUpgradeService.java, +import org.elasticsearch.index.store.IndexStoreModule;, +import java.util.Locale;, +        newMetaData = upgradeSettings(newMetaData);, +    IndexMetaData upgradeSettings(IndexMetaData indexMetaData) {, +        final String storeType = indexMetaData.getSettings().get(IndexStoreModule.STORE_TYPE);, +        if (storeType != null) {, +            final String upgradeStoreType;, +            switch (storeType.toLowerCase(Locale.ROOT)) {, +                case "nio_fs":, +                case "niofs":, +                    upgradeStoreType = "niofs";, +                    break;, +                case "mmap_fs":, +                case "mmapfs":, +                    upgradeStoreType = "mmapfs";, +                    break;, +                case "simple_fs":, +                case "simplefs":, +                    upgradeStoreType = "simplefs";, +                    break;, +                case "default":, +                    upgradeStoreType = "default";, +                    break;, +                case "fs":, +                    upgradeStoreType = "fs";, +                    break;, +                default:, +                    upgradeStoreType = storeType;, +            }, +            if (storeType.equals(upgradeStoreType) == false) {, +                Settings indexSettings = Settings.builder().put(indexMetaData.settings()), +                        .put(IndexStoreModule.STORE_TYPE, upgradeStoreType), +                        .build();, +                return IndexMetaData.builder(indexMetaData), +                        .version(indexMetaData.version()), +                        .settings(indexSettings), +                        .build();, +            }, +        }, +        return indexMetaData;, +    }, +, +++ b/core/src/main/java/org/elasticsearch/index/store/FsDirectoryService.java, +import java.util.Locale;, +        final String storeType = indexSettings.get(IndexStoreModule.STORE_TYPE, IndexStoreModule.Type.DEFAULT.getSettingsKey());, +++ b/core/src/main/java/org/elasticsearch/cluster/metadata/MetaDataIndexUpgradeService.java, +import org.elasticsearch.index.store.IndexStoreModule;, +import java.util.Locale;, +        newMetaData = upgradeSettings(newMetaData);, +    IndexMetaData upgradeSettings(IndexMetaData indexMetaData) {, +        final String storeType = indexMetaData.getSettings().get(IndexStoreModule.STORE_TYPE);, +        if (storeType != null) {, +            final String upgradeStoreType;, +            switch (storeType.toLowerCase(Locale.ROOT)) {, +                case "nio_fs":, +                case "niofs":]
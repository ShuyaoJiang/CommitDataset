[+++ b/client/rest/src/test/java/org/elasticsearch/client/RestClientTests.java, +import java.util.concurrent.TimeUnit;, +import static org.junit.Assert.assertTrue;, +                    throw new UnsupportedOperationException("onSuccess cannot be called when using a mocked http client");, +                    try {, +                    } finally {, +                }, +            assertTrue("time out waiting for request to return", latch.await(1000, TimeUnit.MILLISECONDS));, +                    throw new UnsupportedOperationException("onSuccess cannot be called when using a mocked http client");, +                    try {, +                    } finally {, +                }, +            assertTrue("time out waiting for request to return", latch.await(1000, TimeUnit.MILLISECONDS));, +                    throw new UnsupportedOperationException("onSuccess cannot be called when using a mocked http client");, +                    try {, +                    } finally {, +                }, +            assertTrue("time out waiting for request to return", latch.await(1000, TimeUnit.MILLISECONDS));, +                    throw new UnsupportedOperationException("onSuccess cannot be called when using a mocked http client");, +                    try {, +                    } finally {, +                }, +            assertTrue("time out waiting for request to return", latch.await(1000, TimeUnit.MILLISECONDS));, +                    throw new UnsupportedOperationException("onSuccess cannot be called when using a mocked http client");, +                    try {, +                    } finally {, +                }, +            assertTrue("time out waiting for request to return", latch.await(1000, TimeUnit.MILLISECONDS));, +                    throw new UnsupportedOperationException("onSuccess cannot be called when using a mocked http client");, +                    try {, +                    } finally {, +                }, +            assertTrue("time out waiting for request to return", latch.await(1000, TimeUnit.MILLISECONDS));]
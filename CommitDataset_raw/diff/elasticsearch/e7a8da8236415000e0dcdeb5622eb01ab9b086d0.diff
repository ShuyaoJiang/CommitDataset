[+++ b/modules/elasticsearch/src/main/java/org/elasticsearch/index/gateway/blobstore/BlobStoreIndexShardGateway.java, +            indexShard.performRecoveryFinalization(true);, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/index/gateway/blobstore/BlobStoreIndexShardGateway.java, +            indexShard.performRecoveryFinalization(true);, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/index/shard/recovery/RecoveryAction.java, +                indexShard.performRecoveryFinalization(false);, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/index/gateway/blobstore/BlobStoreIndexShardGateway.java, +            indexShard.performRecoveryFinalization(true);, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/index/shard/recovery/RecoveryAction.java, +                indexShard.performRecoveryFinalization(false);, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/index/shard/service/InternalIndexShard.java, +    public void performRecoveryFinalization(boolean withFlush) throws ElasticSearchException {, +        if (withFlush) {, +            engine.flush(new Engine.Flush());, +        }, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/index/gateway/blobstore/BlobStoreIndexShardGateway.java, +            indexShard.performRecoveryFinalization(true);, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/index/shard/recovery/RecoveryAction.java, +                indexShard.performRecoveryFinalization(false);, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/index/shard/service/InternalIndexShard.java, +    public void performRecoveryFinalization(boolean withFlush) throws ElasticSearchException {, +        if (withFlush) {, +            engine.flush(new Engine.Flush());, +        }, +++ b/plugins/cloud/src/main/java/org/elasticsearch/index/gateway/cloud/CloudIndexShardGateway.java, +            indexShard.performRecoveryFinalization(true);]
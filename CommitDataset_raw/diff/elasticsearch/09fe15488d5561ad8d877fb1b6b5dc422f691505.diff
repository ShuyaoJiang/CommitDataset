[+++ b/src/main/java/org/elasticsearch/search/scan/ScanContext.java, +import org.apache.lucene.index.AtomicReaderContext;, +import org.apache.lucene.util.Bits;, +        public void setNextReader(AtomicReaderContext context) throws IOException {, +            this.currentReader = context.reader();, +            this.docBase = context.docBase;, +        public DocIdSet getDocIdSet(AtomicReaderContext context, Bits acceptedDocs) throws IOException {, +            ReaderState readerState = readerStates.get(context.reader());, +            return new AllDocSet(context.reader().maxDoc());]
[+++ b/core/src/main/java/org/elasticsearch/cli/UserException.java, +, +    /**, +     * Constructs a new user exception with specified exit status, message, and underlying cause., +     *, +     * @param exitCode the exit code, +     * @param msg      the message, +     * @param cause    the underlying cause, +     */, +    public UserException(final int exitCode, final String msg, final Throwable cause) {, +        super(msg, cause);, +        this.exitCode = exitCode;, +    }, +, +++ b/core/src/main/java/org/elasticsearch/cli/UserException.java, +, +    /**, +     * Constructs a new user exception with specified exit status, message, and underlying cause., +     *, +     * @param exitCode the exit code, +     * @param msg      the message, +     * @param cause    the underlying cause, +     */, +    public UserException(final int exitCode, final String msg, final Throwable cause) {, +        super(msg, cause);, +        this.exitCode = exitCode;, +    }, +, +++ b/core/src/main/java/org/elasticsearch/common/settings/KeyStoreWrapper.java, +import java.nio.file.AccessDeniedException;, +import org.elasticsearch.cli.ExitCodes;, +import org.elasticsearch.cli.UserException;, +        } catch (final AccessDeniedException e) {, +            final String message = String.format(, +                    Locale.ROOT,, +                    "unable to create temporary keystore at [%s], please check filesystem permissions",, +                    configDir.resolve(tmpFile));, +            throw new UserException(ExitCodes.CONFIG, message, e);]
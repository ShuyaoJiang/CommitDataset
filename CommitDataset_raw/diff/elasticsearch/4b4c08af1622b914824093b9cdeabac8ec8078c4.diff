[+++ b/src/test/java/org/elasticsearch/watcher/test/AbstractWatcherIntegrationTests.java, +    protected void ensureLicenseEnabled()  throws Exception {, +        assertBusy(new Runnable() {, +            @Override, +            public void run() {, +                for (LicenseService service : internalTestCluster().getInstances(LicenseService.class)) {, +                    assertThat(service.enabled(), is(true));, +                }, +            }, +        });, +    }, +, +++ b/src/test/java/org/elasticsearch/watcher/test/AbstractWatcherIntegrationTests.java, +    protected void ensureLicenseEnabled()  throws Exception {, +        assertBusy(new Runnable() {, +            @Override, +            public void run() {, +                for (LicenseService service : internalTestCluster().getInstances(LicenseService.class)) {, +                    assertThat(service.enabled(), is(true));, +                }, +            }, +        });, +    }, +, +++ b/src/test/java/org/elasticsearch/watcher/test/integration/NoMasterNodeTests.java, +, +        // we first need to make sure the license is enabled, otherwise all APIs will be blocked, +        ensureLicenseEnabled();, +, +        // we first need to make sure the license is enabled, otherwise all APIs will be blocked, +        ensureLicenseEnabled();, +, +            watchService().putWatch(watchName, watchSource);, +    private WatchService watchService() {, +        return getInstanceFromMaster(WatchService.class);, +    }, +]
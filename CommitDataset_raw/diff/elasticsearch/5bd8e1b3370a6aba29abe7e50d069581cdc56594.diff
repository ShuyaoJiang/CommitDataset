[+++ b/src/main/java/org/elasticsearch/common/lucene/search/MoreLikeThisQuery.java, +import org.apache.lucene.search.similarities.DefaultSimilarity;, +import org.apache.lucene.search.similarities.Similarity;, +import org.apache.lucene.search.similarities.TFIDFSimilarity;, +import org.apache.lucene.queries.mlt.MoreLikeThis;, +    private TFIDFSimilarity similarity;, +        //LUCENE 4 UPGRADE this mapps the 3.6 behavior (only use the first field), +        BooleanQuery bq = (BooleanQuery) mlt.like(new FastStringReader(likeText), moreLikeFields[0]);, +        if (similarity == null || similarity instanceof TFIDFSimilarity) {, +            //LUCENE 4 UPGRADE we need TFIDF similarity here so I only set it if it is an instance of it, +            this.similarity = (TFIDFSimilarity) similarity;, +        }]
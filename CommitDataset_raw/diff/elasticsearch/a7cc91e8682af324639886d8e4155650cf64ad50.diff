[+++ b/core/src/main/java/org/elasticsearch/action/admin/cluster/validate/template/TransportRenderSearchTemplateAction.java, +import java.util.Collections;, +, +                ExecutableScript executable = scriptService.executable(request.template(), ScriptContext.Standard.SEARCH, request, Collections.emptyMap());, +++ b/core/src/main/java/org/elasticsearch/action/admin/cluster/validate/template/TransportRenderSearchTemplateAction.java, +import java.util.Collections;, +, +                ExecutableScript executable = scriptService.executable(request.template(), ScriptContext.Standard.SEARCH, request, Collections.emptyMap());, +++ b/core/src/main/java/org/elasticsearch/action/update/UpdateHelper.java, +import java.util.Collections;, +                ExecutableScript script = scriptService.executable(request.script, ScriptContext.Standard.UPDATE, request, Collections.emptyMap());, +++ b/core/src/main/java/org/elasticsearch/action/admin/cluster/validate/template/TransportRenderSearchTemplateAction.java, +import java.util.Collections;, +, +                ExecutableScript executable = scriptService.executable(request.template(), ScriptContext.Standard.SEARCH, request, Collections.emptyMap());, +++ b/core/src/main/java/org/elasticsearch/action/update/UpdateHelper.java, +import java.util.Collections;, +                ExecutableScript script = scriptService.executable(request.script, ScriptContext.Standard.UPDATE, request, Collections.emptyMap());, +++ b/core/src/main/java/org/elasticsearch/index/query/QueryShardContext.java, +import java.util.Collections;, +        ExecutableScript executable = getScriptService().executable(template, ScriptContext.Standard.SEARCH, searchContext, Collections.emptyMap());, +++ b/core/src/main/java/org/elasticsearch/action/admin/cluster/validate/template/TransportRenderSearchTemplateAction.java, +import java.util.Collections;, +, +                ExecutableScript executable = scriptService.executable(request.template(), ScriptContext.Standard.SEARCH, request, Collections.emptyMap());, +++ b/core/src/main/java/org/elasticsearch/action/update/UpdateHelper.java, +import java.util.Collections;, +                ExecutableScript script = scriptService.executable(request.script, ScriptContext.Standard.UPDATE, request, Collections.emptyMap());, +++ b/core/src/main/java/org/elasticsearch/index/query/QueryShardContext.java, +import java.util.Collections;, +        ExecutableScript executable = getScriptService().executable(template, ScriptContext.Standard.SEARCH, searchContext, Collections.emptyMap());, +++ b/core/src/main/java/org/elasticsearch/index/query/ScriptQueryBuilder.java, +import java.util.Collections;, +            this.searchScript = scriptService.search(searchLookup, script, ScriptContext.Standard.SEARCH, Collections.emptyMap());, +++ b/core/src/main/java/org/elasticsearch/action/admin/cluster/validate/template/TransportRenderSearchTemplateAction.java, +import java.util.Collections;, +, +                ExecutableScript executable = scriptService.executable(request.template(), ScriptContext.Standard.SEARCH, request, Collections.emptyMap());, +++ b/core/src/main/java/org/elasticsearch/action/update/UpdateHelper.java, +import java.util.Collections;, +                ExecutableScript script = scriptService.executable(request.script, ScriptContext.Standard.UPDATE, request, Collections.emptyMap());, +++ b/core/src/main/java/org/elasticsearch/index/query/QueryShardContext.java, +import java.util.Collections;, +        ExecutableScript executable = getScriptService().executable(template, ScriptContext.Standard.SEARCH, searchContext, Collections.emptyMap());, +++ b/core/src/main/java/org/elasticsearch/index/query/ScriptQueryBuilder.java, +import java.util.Collections;, +            this.searchScript = scriptService.search(searchLookup, script, ScriptContext.Standard.SEARCH, Collections.emptyMap());, +++ b/core/src/main/java/org/elasticsearch/index/query/functionscore/script/ScriptScoreFunctionBuilder.java, +import java.util.Collections;, +            SearchScript searchScript = context.getScriptService().search(context.lookup(), script, ScriptContext.Standard.SEARCH, Collections.emptyMap());, +++ b/core/src/main/java/org/elasticsearch/action/admin/cluster/validate/template/TransportRenderSearchTemplateAction.java, +import java.util.Collections;, +, +                ExecutableScript executable = scriptService.executable(request.template(), ScriptContext.Standard.SEARCH, request, Collections.emptyMap());, +++ b/core/src/main/java/org/elasticsearch/action/update/UpdateHelper.java, +import java.util.Collections;, +                ExecutableScript script = scriptService.executable(request.script, ScriptContext.Standard.UPDATE, request, Collections.emptyMap());, +++ b/core/src/main/java/org/elasticsearch/index/query/QueryShardContext.java, +import java.util.Collections;, +        ExecutableScript executable = getScriptService().executable(template, ScriptContext.Standard.SEARCH, searchContext, Collections.emptyMap());, +++ b/core/src/main/java/org/elasticsearch/index/query/ScriptQueryBuilder.java, +import java.util.Collections;, +            this.searchScript = scriptService.search(searchLookup, script, ScriptContext.Standard.SEARCH, Collections.emptyMap());, +++ b/core/src/main/java/org/elasticsearch/index/query/functionscore/script/ScriptScoreFunctionBuilder.java, +import java.util.Collections;, +            SearchScript searchScript = context.getScriptService().search(context.lookup(), script, ScriptContext.Standard.SEARCH, Collections.emptyMap());, +++ b/core/src/main/java/org/elasticsearch/script/NativeScriptEngineService.java, +    public Object compile(String script, Map<String, String> params) {, +++ b/core/src/main/java/org/elasticsearch/action/admin/cluster/validate/template/TransportRenderSearchTemplateAction.java, +import java.util.Collections;, +, +                ExecutableScript executable = scriptService.executable(request.template(), ScriptContext.Standard.SEARCH, request, Collections.emptyMap());, +++ b/core/src/main/java/org/elasticsearch/action/update/UpdateHelper.java, +import java.util.Collections;, +                ExecutableScript script = scriptService.executable(request.script, ScriptContext.Standard.UPDATE, request, Collections.emptyMap());, +++ b/core/src/main/java/org/elasticsearch/index/query/QueryShardContext.java, +import java.util.Collections;, +        ExecutableScript executable = getScriptService().executable(template, ScriptContext.Standard.SEARCH, searchContext, Collections.emptyMap());, +++ b/core/src/main/java/org/elasticsearch/index/query/ScriptQueryBuilder.java, +import java.util.Collections;, +            this.searchScript = scriptService.search(searchLookup, script, ScriptContext.Standard.SEARCH, Collections.emptyMap());, +++ b/core/src/main/java/org/elasticsearch/index/query/functionscore/script/ScriptScoreFunctionBuilder.java, +import java.util.Collections;, +            SearchScript searchScript = context.getScriptService().search(context.lookup(), script, ScriptContext.Standard.SEARCH, Collections.emptyMap());, +++ b/core/src/main/java/org/elasticsearch/script/NativeScriptEngineService.java, +    public Object compile(String script, Map<String, String> params) {, +++ b/core/src/main/java/org/elasticsearch/script/ScriptEngineService.java, +    Object compile(String script, Map<String, String> params);, +++ b/core/src/main/java/org/elasticsearch/action/admin/cluster/validate/template/TransportRenderSearchTemplateAction.java, +import java.util.Collections;, +, +                ExecutableScript executable = scriptService.executable(request.template(), ScriptContext.Standard.SEARCH, request, Collections.emptyMap());, +++ b/core/src/main/java/org/elasticsearch/action/update/UpdateHelper.java, +import java.util.Collections;, +                ExecutableScript script = scriptService.executable(request.script, ScriptContext.Standard.UPDATE, request, Collections.emptyMap());, +++ b/core/src/main/java/org/elasticsearch/index/query/QueryShardContext.java, +import java.util.Collections;, +        ExecutableScript executable = getScriptService().executable(template, ScriptContext.Standard.SEARCH, searchContext, Collections.emptyMap());, +++ b/core/src/main/java/org/elasticsearch/index/query/ScriptQueryBuilder.java, +import java.util.Collections;]
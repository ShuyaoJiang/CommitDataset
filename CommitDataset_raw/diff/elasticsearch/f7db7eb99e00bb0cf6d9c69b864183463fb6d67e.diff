[+++ b/src/main/java/org/elasticsearch/rest/action/admin/cluster/node/info/RestNodesInfoAction.java, +import com.google.common.collect.Sets;, +    private final static Set<String> ALLOWED_METRICS = Sets.newHashSet("http", "jvm", "network", "os", "plugin", "process", "settings", "thread_pool", "transport");, +, +        // special case like /_nodes/os (in this case os are metrics and not the nodeId), +        // still, /_nodes/_local (or any other node id) should work and be treated as usual, +        // this means one must differentiate between allowed metrics and arbitrary node ids in the same place, +            Set<String> metricsOrNodeIds = Strings.splitStringByCommaToSet(request.param("nodeId", "_all"));, +            boolean isMetricsOnly = ALLOWED_METRICS.containsAll(metricsOrNodeIds);, +            if (isMetricsOnly) {, +                metrics = metricsOrNodeIds;, +            } else {, +                nodeIds = metricsOrNodeIds.toArray(new String[]{});, +                metrics = Sets.newHashSet("_all");, +            }]
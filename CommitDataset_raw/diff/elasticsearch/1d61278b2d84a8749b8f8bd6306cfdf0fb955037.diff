[+++ b/shield/src/main/java/org/elasticsearch/shield/authc/esusers/FileUserPasswdStore.java, +, +import static java.util.Collections.emptyMap;, +    private volatile Map<String, char[]> users;, +    static Map<String, char[]> parseFileLenient(Path path, ESLogger logger) {, +            return emptyMap();, +    public static Map<String, char[]> parseFile(Path path, @Nullable ESLogger logger) {, +            return emptyMap();, +++ b/shield/src/main/java/org/elasticsearch/shield/authc/esusers/FileUserPasswdStore.java, +, +import static java.util.Collections.emptyMap;, +    private volatile Map<String, char[]> users;, +    static Map<String, char[]> parseFileLenient(Path path, ESLogger logger) {, +            return emptyMap();, +    public static Map<String, char[]> parseFile(Path path, @Nullable ESLogger logger) {, +            return emptyMap();, +++ b/shield/src/main/java/org/elasticsearch/shield/authc/esusers/FileUserRolesStore.java, +, +import java.util.ArrayList;, +import java.util.HashMap;, +import java.util.List;, +import java.util.Locale;, +import java.util.Map;, +import static java.util.Collections.emptyMap;, +    private volatile Map<String, String[]> userRoles;, +    static Map<String, String[]> parseFileLenient(Path path, ESLogger logger) {, +            return emptyMap();, +    public static Map<String, String[]> parseFile(Path path, @Nullable ESLogger logger) {, +            return emptyMap();, +++ b/shield/src/main/java/org/elasticsearch/shield/authc/esusers/FileUserPasswdStore.java, +, +import static java.util.Collections.emptyMap;, +    private volatile Map<String, char[]> users;, +    static Map<String, char[]> parseFileLenient(Path path, ESLogger logger) {, +            return emptyMap();, +    public static Map<String, char[]> parseFile(Path path, @Nullable ESLogger logger) {, +            return emptyMap();, +++ b/shield/src/main/java/org/elasticsearch/shield/authc/esusers/FileUserRolesStore.java, +, +import java.util.ArrayList;, +import java.util.HashMap;, +import java.util.List;, +import java.util.Locale;, +import java.util.Map;, +import static java.util.Collections.emptyMap;, +    private volatile Map<String, String[]> userRoles;, +    static Map<String, String[]> parseFileLenient(Path path, ESLogger logger) {, +            return emptyMap();, +    public static Map<String, String[]> parseFile(Path path, @Nullable ESLogger logger) {, +            return emptyMap();, +++ b/shield/src/main/java/org/elasticsearch/shield/authc/support/DnRoleMapper.java, +, +import java.util.HashMap;, +import java.util.HashSet;, +import java.util.List;, +import java.util.Map;, +import java.util.Set;, +import static java.util.Collections.emptyMap;, +import static java.util.Collections.unmodifiableMap;, +    protected volatile Map<DN, Set<String>> dnRoles;, +    public static Map<DN, Set<String>> parseFileLenient(Path path, ESLogger logger, String realmType, String realmName) {, +            return emptyMap();, +    public static Map<DN, Set<String>> parseFile(Path path, ESLogger logger, String realmType, String realmName) {, +            return emptyMap();, +            return unmodifiableMap(dnToRoles);, +++ b/shield/src/main/java/org/elasticsearch/shield/authc/esusers/FileUserPasswdStore.java, +, +import static java.util.Collections.emptyMap;, +    private volatile Map<String, char[]> users;, +    static Map<String, char[]> parseFileLenient(Path path, ESLogger logger) {, +            return emptyMap();, +    public static Map<String, char[]> parseFile(Path path, @Nullable ESLogger logger) {, +            return emptyMap();, +++ b/shield/src/main/java/org/elasticsearch/shield/authc/esusers/FileUserRolesStore.java, +, +import java.util.ArrayList;, +import java.util.HashMap;, +import java.util.List;, +import java.util.Locale;, +import java.util.Map;, +import static java.util.Collections.emptyMap;, +    private volatile Map<String, String[]> userRoles;, +    static Map<String, String[]> parseFileLenient(Path path, ESLogger logger) {, +            return emptyMap();, +    public static Map<String, String[]> parseFile(Path path, @Nullable ESLogger logger) {, +            return emptyMap();, +++ b/shield/src/main/java/org/elasticsearch/shield/authc/support/DnRoleMapper.java, +, +import java.util.HashMap;, +import java.util.HashSet;, +import java.util.List;, +import java.util.Map;, +import java.util.Set;, +import static java.util.Collections.emptyMap;, +import static java.util.Collections.unmodifiableMap;, +    protected volatile Map<DN, Set<String>> dnRoles;, +    public static Map<DN, Set<String>> parseFileLenient(Path path, ESLogger logger, String realmType, String realmName) {, +            return emptyMap();, +    public static Map<DN, Set<String>> parseFile(Path path, ESLogger logger, String realmType, String realmName) {, +            return emptyMap();]
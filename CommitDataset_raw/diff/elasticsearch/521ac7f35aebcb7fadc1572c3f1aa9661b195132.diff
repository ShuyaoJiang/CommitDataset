[+++ b/src/main/java/org/elasticsearch/index/query/ScriptFilterParser.java, +        String scriptLang;, +++ b/src/main/java/org/elasticsearch/index/query/ScriptFilterParser.java, +        String scriptLang;, +++ b/src/main/java/org/elasticsearch/index/query/TemplateQueryBuilder.java, +++ b/src/main/java/org/elasticsearch/index/query/ScriptFilterParser.java, +        String scriptLang;, +++ b/src/main/java/org/elasticsearch/index/query/TemplateQueryBuilder.java, +++ b/src/main/java/org/elasticsearch/index/query/TemplateQueryParser.java, +import org.elasticsearch.script.mustache.MustacheScriptEngineService;, +        ExecutableScript executable = this.scriptService.executable(MustacheScriptEngineService.NAME, templateContext.template(), templateContext.scriptType(), templateContext.params());, +            return context.parseInnerQuery();, +++ b/src/main/java/org/elasticsearch/index/query/ScriptFilterParser.java, +        String scriptLang;, +++ b/src/main/java/org/elasticsearch/index/query/TemplateQueryBuilder.java, +++ b/src/main/java/org/elasticsearch/index/query/TemplateQueryParser.java, +import org.elasticsearch.script.mustache.MustacheScriptEngineService;, +        ExecutableScript executable = this.scriptService.executable(MustacheScriptEngineService.NAME, templateContext.template(), templateContext.scriptType(), templateContext.params());, +            return context.parseInnerQuery();, +++ b/src/main/java/org/elasticsearch/index/query/functionscore/script/ScriptScoreFunctionParser.java, +            searchScript = parseContext.scriptService().search(parseContext.lookup(), scriptParameterParser.lang(), script, scriptType, vars);, +++ b/src/main/java/org/elasticsearch/index/query/ScriptFilterParser.java, +        String scriptLang;, +++ b/src/main/java/org/elasticsearch/index/query/TemplateQueryBuilder.java, +++ b/src/main/java/org/elasticsearch/index/query/TemplateQueryParser.java, +import org.elasticsearch.script.mustache.MustacheScriptEngineService;, +        ExecutableScript executable = this.scriptService.executable(MustacheScriptEngineService.NAME, templateContext.template(), templateContext.scriptType(), templateContext.params());, +            return context.parseInnerQuery();, +++ b/src/main/java/org/elasticsearch/index/query/functionscore/script/ScriptScoreFunctionParser.java, +            searchScript = parseContext.scriptService().search(parseContext.lookup(), scriptParameterParser.lang(), script, scriptType, vars);, +++ b/src/main/java/org/elasticsearch/rest/action/template/RestDeleteSearchTemplateAction.java, +import org.elasticsearch.script.mustache.MustacheScriptEngineService;, +        return MustacheScriptEngineService.NAME;, +++ b/src/main/java/org/elasticsearch/index/query/ScriptFilterParser.java, +        String scriptLang;, +++ b/src/main/java/org/elasticsearch/index/query/TemplateQueryBuilder.java, +++ b/src/main/java/org/elasticsearch/index/query/TemplateQueryParser.java, +import org.elasticsearch.script.mustache.MustacheScriptEngineService;, +        ExecutableScript executable = this.scriptService.executable(MustacheScriptEngineService.NAME, templateContext.template(), templateContext.scriptType(), templateContext.params());, +            return context.parseInnerQuery();, +++ b/src/main/java/org/elasticsearch/index/query/functionscore/script/ScriptScoreFunctionParser.java, +            searchScript = parseContext.scriptService().search(parseContext.lookup(), scriptParameterParser.lang(), script, scriptType, vars);, +++ b/src/main/java/org/elasticsearch/rest/action/template/RestDeleteSearchTemplateAction.java, +import org.elasticsearch.script.mustache.MustacheScriptEngineService;, +        return MustacheScriptEngineService.NAME;, +++ b/src/main/java/org/elasticsearch/rest/action/template/RestGetSearchTemplateAction.java, +import org.elasticsearch.script.mustache.MustacheScriptEngineService;, +        return MustacheScriptEngineService.NAME;, +++ b/src/main/java/org/elasticsearch/index/query/ScriptFilterParser.java, +        String scriptLang;, +++ b/src/main/java/org/elasticsearch/index/query/TemplateQueryBuilder.java, +++ b/src/main/java/org/elasticsearch/index/query/TemplateQueryParser.java, +import org.elasticsearch.script.mustache.MustacheScriptEngineService;, +        ExecutableScript executable = this.scriptService.executable(MustacheScriptEngineService.NAME, templateContext.template(), templateContext.scriptType(), templateContext.params());, +            return context.parseInnerQuery();, +++ b/src/main/java/org/elasticsearch/index/query/functionscore/script/ScriptScoreFunctionParser.java, +            searchScript = parseContext.scriptService().search(parseContext.lookup(), scriptParameterParser.lang(), script, scriptType, vars);, +++ b/src/main/java/org/elasticsearch/rest/action/template/RestDeleteSearchTemplateAction.java, +import org.elasticsearch.script.mustache.MustacheScriptEngineService;, +        return MustacheScriptEngineService.NAME;, +++ b/src/main/java/org/elasticsearch/rest/action/template/RestGetSearchTemplateAction.java, +import org.elasticsearch.script.mustache.MustacheScriptEngineService;, +        return MustacheScriptEngineService.NAME;, +++ b/src/main/java/org/elasticsearch/rest/action/template/RestPutSearchTemplateAction.java, +import org.elasticsearch.script.mustache.MustacheScriptEngineService;, +        return MustacheScriptEngineService.NAME;, +++ b/src/main/java/org/elasticsearch/index/query/ScriptFilterParser.java, +        String scriptLang;, +++ b/src/main/java/org/elasticsearch/index/query/TemplateQueryBuilder.java, +++ b/src/main/java/org/elasticsearch/index/query/TemplateQueryParser.java, +import org.elasticsearch.script.mustache.MustacheScriptEngineService;, +        ExecutableScript executable = this.scriptService.executable(MustacheScriptEngineService.NAME, templateContext.template(), templateContext.scriptType(), templateContext.params());, +            return context.parseInnerQuery();, +++ b/src/main/java/org/elasticsearch/index/query/functionscore/script/ScriptScoreFunctionParser.java, +            searchScript = parseContext.scriptService().search(parseContext.lookup(), scriptParameterParser.lang(), script, scriptType, vars);, +++ b/src/main/java/org/elasticsearch/rest/action/template/RestDeleteSearchTemplateAction.java, +import org.elasticsearch.script.mustache.MustacheScriptEngineService;, +        return MustacheScriptEngineService.NAME;, +++ b/src/main/java/org/elasticsearch/rest/action/template/RestGetSearchTemplateAction.java, +import org.elasticsearch.script.mustache.MustacheScriptEngineService;, +        return MustacheScriptEngineService.NAME;, +++ b/src/main/java/org/elasticsearch/rest/action/template/RestPutSearchTemplateAction.java, +import org.elasticsearch.script.mustache.MustacheScriptEngineService;, +        return MustacheScriptEngineService.NAME;, +++ b/src/main/java/org/elasticsearch/script/NativeScriptEngineService.java, +    public static final String NAME = "native";, +, +        return new String[]{NAME};, +++ b/src/main/java/org/elasticsearch/index/query/ScriptFilterParser.java, +        String scriptLang;, +++ b/src/main/java/org/elasticsearch/index/query/TemplateQueryBuilder.java, +++ b/src/main/java/org/elasticsearch/index/query/TemplateQueryParser.java, +import org.elasticsearch.script.mustache.MustacheScriptEngineService;, +        ExecutableScript executable = this.scriptService.executable(MustacheScriptEngineService.NAME, templateContext.template(), templateContext.scriptType(), templateContext.params());, +            return context.parseInnerQuery();, +++ b/src/main/java/org/elasticsearch/index/query/functionscore/script/ScriptScoreFunctionParser.java, +            searchScript = parseContext.scriptService().search(parseContext.lookup(), scriptParameterParser.lang(), script, scriptType, vars);, +++ b/src/main/java/org/elasticsearch/rest/action/template/RestDeleteSearchTemplateAction.java, +import org.elasticsearch.script.mustache.MustacheScriptEngineService;, +        return MustacheScriptEngineService.NAME;]
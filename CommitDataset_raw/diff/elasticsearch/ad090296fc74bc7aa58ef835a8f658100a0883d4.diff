[+++ b/core/pom.xml, +            <groupId>org.codehaus.groovy</groupId>, +            <artifactId>groovy-all</artifactId>, +            <classifier>indy</classifier>, +            <optional>true</optional>, +        </dependency>, +        <dependency>, +++ b/core/pom.xml, +            <groupId>org.codehaus.groovy</groupId>, +            <artifactId>groovy-all</artifactId>, +            <classifier>indy</classifier>, +            <optional>true</optional>, +        </dependency>, +        <dependency>, +++ b/core/src/main/java/org/elasticsearch/ElasticsearchException.java, +        GROOVY_SCRIPT_COMPILATION_EXCEPTION(org.elasticsearch.script.groovy.GroovyScriptCompilationException.class, org.elasticsearch.script.groovy.GroovyScriptCompilationException::new, 95),, +        GROOVY_SCRIPT_EXECUTION_EXCEPTION(org.elasticsearch.script.groovy.GroovyScriptExecutionException.class, org.elasticsearch.script.groovy.GroovyScriptExecutionException::new, 122),, +++ b/core/pom.xml, +            <groupId>org.codehaus.groovy</groupId>, +            <artifactId>groovy-all</artifactId>, +            <classifier>indy</classifier>, +            <optional>true</optional>, +        </dependency>, +        <dependency>, +++ b/core/src/main/java/org/elasticsearch/ElasticsearchException.java, +        GROOVY_SCRIPT_COMPILATION_EXCEPTION(org.elasticsearch.script.groovy.GroovyScriptCompilationException.class, org.elasticsearch.script.groovy.GroovyScriptCompilationException::new, 95),, +        GROOVY_SCRIPT_EXECUTION_EXCEPTION(org.elasticsearch.script.groovy.GroovyScriptExecutionException.class, org.elasticsearch.script.groovy.GroovyScriptExecutionException::new, 122),, +++ b/core/src/main/java/org/elasticsearch/bootstrap/Bootstrap.java, +    public static void initializeNatives(boolean mlockAll, boolean seccomp, boolean ctrlHandler) {, +            Natives.trySeccomp();, +        initializeNatives(settings.getAsBoolean("bootstrap.mlockall", false),, +++ b/core/pom.xml, +            <groupId>org.codehaus.groovy</groupId>, +            <artifactId>groovy-all</artifactId>, +            <classifier>indy</classifier>, +            <optional>true</optional>, +        </dependency>, +        <dependency>, +++ b/core/src/main/java/org/elasticsearch/ElasticsearchException.java, +        GROOVY_SCRIPT_COMPILATION_EXCEPTION(org.elasticsearch.script.groovy.GroovyScriptCompilationException.class, org.elasticsearch.script.groovy.GroovyScriptCompilationException::new, 95),, +        GROOVY_SCRIPT_EXECUTION_EXCEPTION(org.elasticsearch.script.groovy.GroovyScriptExecutionException.class, org.elasticsearch.script.groovy.GroovyScriptExecutionException::new, 122),, +++ b/core/src/main/java/org/elasticsearch/bootstrap/Bootstrap.java, +    public static void initializeNatives(boolean mlockAll, boolean seccomp, boolean ctrlHandler) {, +            Natives.trySeccomp();, +        initializeNatives(settings.getAsBoolean("bootstrap.mlockall", false),, +++ b/core/src/main/java/org/elasticsearch/bootstrap/JNANatives.java, +    static void trySeccomp() {, +        if (Constants.LINUX && "amd64".equals(Constants.OS_ARCH)) {, +                Seccomp.installFilter();, +            } catch (Exception e) {, +                    logger.debug("unable to install seccomp filter", e);, +                logger.warn("unable to install seccomp filter: " + e.getMessage());, +            }, +++ b/core/pom.xml, +            <groupId>org.codehaus.groovy</groupId>, +            <artifactId>groovy-all</artifactId>, +            <classifier>indy</classifier>, +            <optional>true</optional>, +        </dependency>, +        <dependency>, +++ b/core/src/main/java/org/elasticsearch/ElasticsearchException.java, +        GROOVY_SCRIPT_COMPILATION_EXCEPTION(org.elasticsearch.script.groovy.GroovyScriptCompilationException.class, org.elasticsearch.script.groovy.GroovyScriptCompilationException::new, 95),, +        GROOVY_SCRIPT_EXECUTION_EXCEPTION(org.elasticsearch.script.groovy.GroovyScriptExecutionException.class, org.elasticsearch.script.groovy.GroovyScriptExecutionException::new, 122),, +++ b/core/src/main/java/org/elasticsearch/bootstrap/Bootstrap.java, +    public static void initializeNatives(boolean mlockAll, boolean seccomp, boolean ctrlHandler) {, +            Natives.trySeccomp();, +        initializeNatives(settings.getAsBoolean("bootstrap.mlockall", false),, +++ b/core/src/main/java/org/elasticsearch/bootstrap/JNANatives.java, +    static void trySeccomp() {, +        if (Constants.LINUX && "amd64".equals(Constants.OS_ARCH)) {, +                Seccomp.installFilter();, +            } catch (Exception e) {, +                    logger.debug("unable to install seccomp filter", e);, +                logger.warn("unable to install seccomp filter: " + e.getMessage());, +            }, +++ b/core/src/main/java/org/elasticsearch/bootstrap/Natives.java, +    static void trySeccomp() {, +            logger.warn("cannot install seccomp filters because JNA is not available");, +        JNANatives.trySeccomp();, +++ b/core/pom.xml, +            <groupId>org.codehaus.groovy</groupId>, +            <artifactId>groovy-all</artifactId>, +            <classifier>indy</classifier>, +            <optional>true</optional>, +        </dependency>, +        <dependency>, +++ b/core/src/main/java/org/elasticsearch/ElasticsearchException.java, +        GROOVY_SCRIPT_COMPILATION_EXCEPTION(org.elasticsearch.script.groovy.GroovyScriptCompilationException.class, org.elasticsearch.script.groovy.GroovyScriptCompilationException::new, 95),, +        GROOVY_SCRIPT_EXECUTION_EXCEPTION(org.elasticsearch.script.groovy.GroovyScriptExecutionException.class, org.elasticsearch.script.groovy.GroovyScriptExecutionException::new, 122),, +++ b/core/src/main/java/org/elasticsearch/bootstrap/Bootstrap.java, +    public static void initializeNatives(boolean mlockAll, boolean seccomp, boolean ctrlHandler) {, +            Natives.trySeccomp();, +        initializeNatives(settings.getAsBoolean("bootstrap.mlockall", false),, +++ b/core/src/main/java/org/elasticsearch/bootstrap/JNANatives.java, +    static void trySeccomp() {, +        if (Constants.LINUX && "amd64".equals(Constants.OS_ARCH)) {, +                Seccomp.installFilter();, +            } catch (Exception e) {, +                    logger.debug("unable to install seccomp filter", e);, +                logger.warn("unable to install seccomp filter: " + e.getMessage());]
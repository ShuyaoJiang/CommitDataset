[+++ b/core/src/main/java/org/elasticsearch/common/settings/IndexScopedSettings.java, +        // this sucks but we can't really validate all the analyzers/similarity in here, +        Setting.groupSetting("index.similarity.", false, Setting.Scope.INDEX), // this allows similarity settings to be passed, +++ b/core/src/main/java/org/elasticsearch/common/settings/IndexScopedSettings.java, +        // this sucks but we can't really validate all the analyzers/similarity in here, +        Setting.groupSetting("index.similarity.", false, Setting.Scope.INDEX), // this allows similarity settings to be passed, +++ b/core/src/main/java/org/elasticsearch/common/settings/Setting.java, +    public final boolean exists(Settings settings) {, +, +                return settings.getByPrefix(getKey());, +++ b/core/src/main/java/org/elasticsearch/common/settings/IndexScopedSettings.java, +        // this sucks but we can't really validate all the analyzers/similarity in here, +        Setting.groupSetting("index.similarity.", false, Setting.Scope.INDEX), // this allows similarity settings to be passed, +++ b/core/src/main/java/org/elasticsearch/common/settings/Setting.java, +    public final boolean exists(Settings settings) {, +, +                return settings.getByPrefix(getKey());, +++ b/core/src/main/java/org/elasticsearch/index/similarity/SimilarityService.java, +        addSimilarities(similaritySettings, providers, DEFAULTS);, +        defaultSimilarity = providers.get(SimilarityService.DEFAULT_SIMILARITY).get();, +    private void addSimilarities(Map<String, Settings>  similaritySettings, Map<String, SimilarityProvider> providers, Map<String, BiFunction<String, Settings, SimilarityProvider>> similarities)  {, +++ b/core/src/main/java/org/elasticsearch/common/settings/IndexScopedSettings.java, +        // this sucks but we can't really validate all the analyzers/similarity in here, +        Setting.groupSetting("index.similarity.", false, Setting.Scope.INDEX), // this allows similarity settings to be passed, +++ b/core/src/main/java/org/elasticsearch/common/settings/Setting.java, +    public final boolean exists(Settings settings) {, +, +                return settings.getByPrefix(getKey());, +++ b/core/src/main/java/org/elasticsearch/index/similarity/SimilarityService.java, +        addSimilarities(similaritySettings, providers, DEFAULTS);, +        defaultSimilarity = providers.get(SimilarityService.DEFAULT_SIMILARITY).get();, +    private void addSimilarities(Map<String, Settings>  similaritySettings, Map<String, SimilarityProvider> providers, Map<String, BiFunction<String, Settings, SimilarityProvider>> similarities)  {, +++ b/core/src/main/java/org/elasticsearch/threadpool/ThreadPool.java, +        add(defaultExecutorTypeSettings, new ExecutorSettingsBuilder(Names.GENERIC).size(4 * availableProcessors).keepAlive("30s"));, +++ b/core/src/main/java/org/elasticsearch/common/settings/IndexScopedSettings.java, +        // this sucks but we can't really validate all the analyzers/similarity in here, +        Setting.groupSetting("index.similarity.", false, Setting.Scope.INDEX), // this allows similarity settings to be passed, +++ b/core/src/main/java/org/elasticsearch/common/settings/Setting.java, +    public final boolean exists(Settings settings) {, +, +                return settings.getByPrefix(getKey());, +++ b/core/src/main/java/org/elasticsearch/index/similarity/SimilarityService.java, +        addSimilarities(similaritySettings, providers, DEFAULTS);, +        defaultSimilarity = providers.get(SimilarityService.DEFAULT_SIMILARITY).get();, +    private void addSimilarities(Map<String, Settings>  similaritySettings, Map<String, SimilarityProvider> providers, Map<String, BiFunction<String, Settings, SimilarityProvider>> similarities)  {, +++ b/core/src/main/java/org/elasticsearch/threadpool/ThreadPool.java, +        add(defaultExecutorTypeSettings, new ExecutorSettingsBuilder(Names.GENERIC).size(4 * availableProcessors).keepAlive("30s"));, +++ b/core/src/test/java/org/elasticsearch/common/settings/ScopedSettingsTests.java, +++ b/core/src/main/java/org/elasticsearch/common/settings/IndexScopedSettings.java, +        // this sucks but we can't really validate all the analyzers/similarity in here, +        Setting.groupSetting("index.similarity.", false, Setting.Scope.INDEX), // this allows similarity settings to be passed, +++ b/core/src/main/java/org/elasticsearch/common/settings/Setting.java, +    public final boolean exists(Settings settings) {, +, +                return settings.getByPrefix(getKey());, +++ b/core/src/main/java/org/elasticsearch/index/similarity/SimilarityService.java, +        addSimilarities(similaritySettings, providers, DEFAULTS);, +        defaultSimilarity = providers.get(SimilarityService.DEFAULT_SIMILARITY).get();, +    private void addSimilarities(Map<String, Settings>  similaritySettings, Map<String, SimilarityProvider> providers, Map<String, BiFunction<String, Settings, SimilarityProvider>> similarities)  {, +++ b/core/src/main/java/org/elasticsearch/threadpool/ThreadPool.java, +        add(defaultExecutorTypeSettings, new ExecutorSettingsBuilder(Names.GENERIC).size(4 * availableProcessors).keepAlive("30s"));, +++ b/core/src/test/java/org/elasticsearch/common/settings/ScopedSettingsTests.java, +++ /dev/null]
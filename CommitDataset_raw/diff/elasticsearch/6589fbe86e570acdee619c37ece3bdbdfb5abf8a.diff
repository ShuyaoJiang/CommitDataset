[+++ b/core/src/main/java/org/elasticsearch/common/lucene/search/Queries.java, +        // Queries with a single word expanded with synonyms , +        // have their coordination factor disabled (@see org.apache.lucene.util.QueryBuilder#analyzeBoolean())., +        // minimumShouldMatch should not be applicable in such case., +        if (query.isCoordDisabled()) {, +            return query;, +        }, +++ b/core/src/main/java/org/elasticsearch/common/lucene/search/Queries.java, +        // Queries with a single word expanded with synonyms , +        // have their coordination factor disabled (@see org.apache.lucene.util.QueryBuilder#analyzeBoolean())., +        // minimumShouldMatch should not be applicable in such case., +        if (query.isCoordDisabled()) {, +            return query;, +        }, +++ b/core/src/main/java/org/elasticsearch/common/unit/DistanceUnit.java, +import org.elasticsearch.common.io.stream.Writeable;, +public enum DistanceUnit implements Writeable<DistanceUnit> {, +, +    private static final DistanceUnit PROTOTYPE = DEFAULT;, +, +    @Override, +    public DistanceUnit readFrom(StreamInput in) throws IOException {, +        int ordinal = in.readVInt();, +        if (ordinal < 0 || ordinal >= values().length) {, +            throw new IOException("Unknown DistanceUnit ordinal [" + ordinal + "]");, +        }, +        return values()[ordinal];, +    }, +, +    public static DistanceUnit readUnitFrom(StreamInput in) throws IOException {, +        return PROTOTYPE.readFrom(in);, +    }, +, +    @Override, +    public void writeTo(StreamOutput out) throws IOException {, +        out.writeVInt(this.ordinal());, +    }, +++ b/core/src/main/java/org/elasticsearch/common/lucene/search/Queries.java, +        // Queries with a single word expanded with synonyms , +        // have their coordination factor disabled (@see org.apache.lucene.util.QueryBuilder#analyzeBoolean())., +        // minimumShouldMatch should not be applicable in such case., +        if (query.isCoordDisabled()) {, +            return query;, +        }, +++ b/core/src/main/java/org/elasticsearch/common/unit/DistanceUnit.java, +import org.elasticsearch.common.io.stream.Writeable;, +public enum DistanceUnit implements Writeable<DistanceUnit> {, +, +    private static final DistanceUnit PROTOTYPE = DEFAULT;, +, +    @Override, +    public DistanceUnit readFrom(StreamInput in) throws IOException {, +        int ordinal = in.readVInt();, +        if (ordinal < 0 || ordinal >= values().length) {, +            throw new IOException("Unknown DistanceUnit ordinal [" + ordinal + "]");, +        }, +        return values()[ordinal];, +    }, +, +    public static DistanceUnit readUnitFrom(StreamInput in) throws IOException {, +        return PROTOTYPE.readFrom(in);, +    }, +, +    @Override, +    public void writeTo(StreamOutput out) throws IOException {, +        out.writeVInt(this.ordinal());, +    }, +++ /dev/null, +++ b/core/src/main/java/org/elasticsearch/common/lucene/search/Queries.java, +        // Queries with a single word expanded with synonyms , +        // have their coordination factor disabled (@see org.apache.lucene.util.QueryBuilder#analyzeBoolean())., +        // minimumShouldMatch should not be applicable in such case., +        if (query.isCoordDisabled()) {, +            return query;, +        }, +++ b/core/src/main/java/org/elasticsearch/common/unit/DistanceUnit.java, +import org.elasticsearch.common.io.stream.Writeable;, +public enum DistanceUnit implements Writeable<DistanceUnit> {, +, +    private static final DistanceUnit PROTOTYPE = DEFAULT;, +, +    @Override, +    public DistanceUnit readFrom(StreamInput in) throws IOException {, +        int ordinal = in.readVInt();, +        if (ordinal < 0 || ordinal >= values().length) {, +            throw new IOException("Unknown DistanceUnit ordinal [" + ordinal + "]");, +        }, +        return values()[ordinal];, +    }, +, +    public static DistanceUnit readUnitFrom(StreamInput in) throws IOException {, +        return PROTOTYPE.readFrom(in);, +    }, +, +    @Override, +    public void writeTo(StreamOutput out) throws IOException {, +        out.writeVInt(this.ordinal());, +    }, +++ /dev/null, +++ b/core/src/main/java/org/elasticsearch/gateway/GatewayMetaState.java]
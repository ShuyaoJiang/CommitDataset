[+++ b/src/main/java/org/elasticsearch/common/network/NetworkUtils.java, +    /**, +     * Returns all the available interfaces, including first level sub interfaces., +     */, +        List<NetworkInterface> allInterfaces = new ArrayList<NetworkInterface>();, +        for (Enumeration<NetworkInterface> interfaces = NetworkInterface.getNetworkInterfaces(); interfaces.hasMoreElements(); ) {, +            NetworkInterface intf = interfaces.nextElement();, +            allInterfaces.add(interfaces.nextElement());, +, +            Enumeration<NetworkInterface> subInterfaces = intf.getSubInterfaces();, +            if (subInterfaces != null && subInterfaces.hasMoreElements()) {, +                while (subInterfaces.hasMoreElements()) {, +                    allInterfaces.add(subInterfaces.nextElement());, +                }, +            }, +++ b/src/main/java/org/elasticsearch/common/network/NetworkUtils.java, +    /**, +     * Returns all the available interfaces, including first level sub interfaces., +     */, +        List<NetworkInterface> allInterfaces = new ArrayList<NetworkInterface>();, +        for (Enumeration<NetworkInterface> interfaces = NetworkInterface.getNetworkInterfaces(); interfaces.hasMoreElements(); ) {, +            NetworkInterface intf = interfaces.nextElement();, +            allInterfaces.add(interfaces.nextElement());, +, +            Enumeration<NetworkInterface> subInterfaces = intf.getSubInterfaces();, +            if (subInterfaces != null && subInterfaces.hasMoreElements()) {, +                while (subInterfaces.hasMoreElements()) {, +                    allInterfaces.add(subInterfaces.nextElement());, +                }, +            }, +++ b/src/main/java/org/elasticsearch/monitor/network/NetworkService.java, +                Enumeration<NetworkInterface> interfaces = NetworkInterface.getNetworkInterfaces();, +                while (interfaces.hasMoreElements()) {, +                    NetworkInterface net = interfaces.nextElement();, +, +                    Enumeration<NetworkInterface> subInterfaces = net.getSubInterfaces();, +                    if (subInterfaces != null && subInterfaces.hasMoreElements()) {, +                        netDebug.append("\t\t\tsub interfaces:\n");, +, +                        while (subInterfaces.hasMoreElements()) {, +, +                            net = subInterfaces.nextElement();, +, +                            netDebug.append("\t\t\t").append(net.getName()).append("\t").append("display_name [").append(net.getDisplayName()).append("]\n");, +                            addresses = net.getInetAddresses();, +                            netDebug.append("\t\t\t\t\taddress ");, +                            while (addresses.hasMoreElements()) {, +                                netDebug.append("[").append(addresses.nextElement()).append("] ");, +                            }, +                            netDebug.append('\n');, +                            netDebug.append("\t\t\t\t\tmtu [").append(net.getMTU()).append("] multicast [").append(net.supportsMulticast()).append("] ptp [").append(net.isPointToPoint()), +                                    .append("] loopback [").append(net.isLoopback()).append("] up [").append(net.isUp()).append("] virtual [").append(net.isVirtual()).append("]"), +                                    .append('\n');, +                        }, +                    }, +                netDebug.append("failed to get Network Interface Info [" + ex.getMessage() + "]");]
[+++ b/src/main/java/org/elasticsearch/index/search/stats/SearchStats.java, +    Stats totalStats;, +    long openContexts;, +    public SearchStats(Stats totalStats, long openContexts, @Nullable Map<String, Stats> groupStats) {, +        this.openContexts = openContexts;, +        openContexts += searchStats.openContexts;, +    public long getOpenContexts() {, +        return this.openContexts;, +    }, +, +        builder.field(Fields.OPEN, openContexts);, +        static final XContentBuilderString OPEN = new XContentBuilderString("open");, +        openContexts = in.readVLong();, +        out.writeVLong(openContexts);, +++ b/src/main/java/org/elasticsearch/index/search/stats/SearchStats.java, +    Stats totalStats;, +    long openContexts;, +    public SearchStats(Stats totalStats, long openContexts, @Nullable Map<String, Stats> groupStats) {, +        this.openContexts = openContexts;, +        openContexts += searchStats.openContexts;, +    public long getOpenContexts() {, +        return this.openContexts;, +    }, +, +        builder.field(Fields.OPEN, openContexts);, +        static final XContentBuilderString OPEN = new XContentBuilderString("open");, +        openContexts = in.readVLong();, +        out.writeVLong(openContexts);, +++ b/src/main/java/org/elasticsearch/index/search/stats/ShardSearchService.java, +    private final CounterMetric openContexts = new CounterMetric();, +        return new SearchStats(total, openContexts.count(), groupsSt);, +    public void onNewContext(SearchContext context) {, +        openContexts.inc();, +    }, +, +    public void onFreeContext(SearchContext context) {, +        openContexts.dec();, +    }, +, +++ b/src/main/java/org/elasticsearch/index/search/stats/SearchStats.java, +    Stats totalStats;, +    long openContexts;, +    public SearchStats(Stats totalStats, long openContexts, @Nullable Map<String, Stats> groupStats) {, +        this.openContexts = openContexts;, +        openContexts += searchStats.openContexts;, +    public long getOpenContexts() {, +        return this.openContexts;, +    }, +, +        builder.field(Fields.OPEN, openContexts);, +        static final XContentBuilderString OPEN = new XContentBuilderString("open");, +        openContexts = in.readVLong();, +        out.writeVLong(openContexts);, +++ b/src/main/java/org/elasticsearch/index/search/stats/ShardSearchService.java, +    private final CounterMetric openContexts = new CounterMetric();, +        return new SearchStats(total, openContexts.count(), groupsSt);, +    public void onNewContext(SearchContext context) {, +        openContexts.inc();, +    }, +, +    public void onFreeContext(SearchContext context) {, +        openContexts.dec();, +    }, +, +++ b/src/main/java/org/elasticsearch/search/SearchService.java, +        SearchContext context = createAndPutContext(request);, +        SearchContext context = createAndPutContext(request);, +        SearchContext context = createAndPutContext(request);, +        SearchContext context = createAndPutContext(request);, +    SearchContext createAndPutContext(ShardSearchRequest request) throws ElasticSearchException {, +        SearchContext context = createContext(request);, +        activeContexts.put(context.id(), context);, +        context.indexShard().searchService().onNewContext(context);, +        return context;, +    }, +, +        SearchContext removed = activeContexts.remove(context.id());, +        if (removed != null) {, +            removed.indexShard().searchService().onFreeContext(removed);, +        }]
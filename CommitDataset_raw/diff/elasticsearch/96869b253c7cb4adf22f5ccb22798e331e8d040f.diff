[+++ b/x-pack/plugin/ilm/src/main/java/org/elasticsearch/xpack/indexlifecycle/IndexLifecycleRunner.java, +    /**, +     * Conditionally updates cluster state with new step info. The new cluster state is only, +     * built if the step info has changed, otherwise the same old <code>clusterState</code> is, +     * returned, +     *, +     * @param index the index to modify, +     * @param clusterState the cluster state to modify, +     * @param stepInfo the new step info to update, +     * @return Updated cluster state with <code>stepInfo</code> if changed, otherwise the same cluster state, +     *         if no changes to step info exist, +     * @throws IOException if parsing step info fails, +     */, +        final String stepInfoString;, +        try (XContentBuilder infoXContentBuilder = JsonXContent.contentBuilder()) {, +            stepInfoString = BytesReference.bytes(infoXContentBuilder).utf8ToString();, +        }, +        if (stepInfoString.equals(LifecycleSettings.LIFECYCLE_STEP_INFO_SETTING.get(idxMeta.getSettings()))) {, +            return clusterState;, +        }, +++ b/x-pack/plugin/ilm/src/main/java/org/elasticsearch/xpack/indexlifecycle/IndexLifecycleRunner.java, +    /**, +     * Conditionally updates cluster state with new step info. The new cluster state is only, +     * built if the step info has changed, otherwise the same old <code>clusterState</code> is, +     * returned, +     *, +     * @param index the index to modify, +     * @param clusterState the cluster state to modify, +     * @param stepInfo the new step info to update, +     * @return Updated cluster state with <code>stepInfo</code> if changed, otherwise the same cluster state, +     *         if no changes to step info exist, +     * @throws IOException if parsing step info fails, +     */, +        final String stepInfoString;, +        try (XContentBuilder infoXContentBuilder = JsonXContent.contentBuilder()) {, +            stepInfoString = BytesReference.bytes(infoXContentBuilder).utf8ToString();, +        }, +        if (stepInfoString.equals(LifecycleSettings.LIFECYCLE_STEP_INFO_SETTING.get(idxMeta.getSettings()))) {, +            return clusterState;, +        }, +++ b/x-pack/plugin/ilm/src/test/java/org/elasticsearch/xpack/indexlifecycle/IndexLifecycleRunnerTests.java, +        ClusterState runAgainClusterState = IndexLifecycleRunner.addStepInfoToClusterState(index, newClusterState, stepInfo);, +        assertSame(newClusterState, runAgainClusterState);]
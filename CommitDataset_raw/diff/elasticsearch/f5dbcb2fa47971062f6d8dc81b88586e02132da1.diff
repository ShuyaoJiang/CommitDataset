[+++ b/modules/elasticsearch/src/main/java/org/elasticsearch/index/gateway/local/LocalIndexShardGateway.java, +                Translog.Operation operation;, +                try {, +                    operation = TranslogStreams.readTranslogOperation(si);, +                } catch (EOFException e) {, +                    // ignore, not properly written the last op, +                    break;, +                } catch (IOException e) {, +                    // ignore, not properly written last op, +                    break;, +                }, +        } catch (Throwable e) {, +            // we failed to recovery, make sure to delete the translog file (and keep the recovering one), +            indexShard.translog().close(true);, +            throw new IndexShardGatewayRecoveryException(shardId, "failed to recover shard", e);, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/index/gateway/local/LocalIndexShardGateway.java, +                Translog.Operation operation;, +                try {, +                    operation = TranslogStreams.readTranslogOperation(si);, +                } catch (EOFException e) {, +                    // ignore, not properly written the last op, +                    break;, +                } catch (IOException e) {, +                    // ignore, not properly written last op, +                    break;, +                }, +        } catch (Throwable e) {, +            // we failed to recovery, make sure to delete the translog file (and keep the recovering one), +            indexShard.translog().close(true);, +            throw new IndexShardGatewayRecoveryException(shardId, "failed to recover shard", e);, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/indices/cluster/IndicesClusterStateService.java, +                    indexService.removeShard(shardRouting.shardId().id(), "recovery failure [" + ExceptionsHelper.detailedMessage(failure) + "]");, +                                indexService.removeShard(shardId.id(), "engine failure [" + ExceptionsHelper.detailedMessage(failure) + "]");]
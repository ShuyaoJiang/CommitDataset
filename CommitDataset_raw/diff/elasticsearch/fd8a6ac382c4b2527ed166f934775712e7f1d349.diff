[+++ b/src/test/java/org/elasticsearch/document/BulkTests.java, +        final AtomicReference<BulkResponse> responseRef = new AtomicReference<>();, +        final AtomicReference<Throwable> failureRef = new AtomicReference<>();, +        final CountDownLatch latch = new CountDownLatch(1);, +                responseRef.set(response);, +                latch.countDown();, +            public void afterBulk(long executionId, BulkRequest request, Throwable failure) {, +                failureRef.set(failure);, +                latch.countDown();, +            }, +, +            latch.await();, +            BulkResponse response = responseRef.get();, +            Throwable error = failureRef.get();, +            assertThat(error, nullValue());, +            assertThat("Could not get a bulk response even after an explicit flush.", response, notNullValue());]
[+++ b/modules/elasticsearch/src/main/java/org/elasticsearch/index/field/FieldData.java, +    public abstract void forEachValueInDoc(int docId, StringValueInDocProc proc);, +, +    public static interface StringValueInDocProc {, +        void onValue(String value, int docId);, +    }, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/index/field/FieldData.java, +    public abstract void forEachValueInDoc(int docId, StringValueInDocProc proc);, +, +    public static interface StringValueInDocProc {, +        void onValue(String value, int docId);, +    }, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/index/field/doubles/MultiValueDoubleFieldData.java, +    @Override public void forEachValueInDoc(int docId, StringValueInDocProc proc) {, +        int[] docOrders = order[docId];, +        if (docOrders == null) {, +            return;, +        }, +        for (int docOrder : docOrders) {, +            proc.onValue(Double.toString(values[docOrder]), docId);, +        }, +    }, +, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/index/field/FieldData.java, +    public abstract void forEachValueInDoc(int docId, StringValueInDocProc proc);, +, +    public static interface StringValueInDocProc {, +        void onValue(String value, int docId);, +    }, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/index/field/doubles/MultiValueDoubleFieldData.java, +    @Override public void forEachValueInDoc(int docId, StringValueInDocProc proc) {, +        int[] docOrders = order[docId];, +        if (docOrders == null) {, +            return;, +        }, +        for (int docOrder : docOrders) {, +            proc.onValue(Double.toString(values[docOrder]), docId);, +        }, +    }, +, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/index/field/doubles/SingleValueDoubleFieldData.java, +    @Override public void forEachValueInDoc(int docId, StringValueInDocProc proc) {, +        int loc = order[docId];, +        if (loc == 0) {, +            return;, +        }, +        proc.onValue(Double.toString(values[loc]), docId);, +    }, +, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/index/field/FieldData.java, +    public abstract void forEachValueInDoc(int docId, StringValueInDocProc proc);, +, +    public static interface StringValueInDocProc {, +        void onValue(String value, int docId);, +    }, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/index/field/doubles/MultiValueDoubleFieldData.java, +    @Override public void forEachValueInDoc(int docId, StringValueInDocProc proc) {, +        int[] docOrders = order[docId];, +        if (docOrders == null) {, +            return;, +        }, +        for (int docOrder : docOrders) {, +            proc.onValue(Double.toString(values[docOrder]), docId);, +        }, +    }, +, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/index/field/doubles/SingleValueDoubleFieldData.java, +    @Override public void forEachValueInDoc(int docId, StringValueInDocProc proc) {, +        int loc = order[docId];, +        if (loc == 0) {, +            return;, +        }, +        proc.onValue(Double.toString(values[loc]), docId);, +    }, +, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/index/field/floats/MultiValueFloatFieldData.java, +    @Override public void forEachValueInDoc(int docId, StringValueInDocProc proc) {, +        int[] docOrders = order[docId];, +        if (docOrders == null) {, +            return;, +        }, +        for (int docOrder : docOrders) {, +            proc.onValue(Float.toString(values[docOrder]), docId);, +        }, +    }, +, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/index/field/FieldData.java, +    public abstract void forEachValueInDoc(int docId, StringValueInDocProc proc);, +, +    public static interface StringValueInDocProc {, +        void onValue(String value, int docId);, +    }, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/index/field/doubles/MultiValueDoubleFieldData.java, +    @Override public void forEachValueInDoc(int docId, StringValueInDocProc proc) {, +        int[] docOrders = order[docId];, +        if (docOrders == null) {, +            return;, +        }, +        for (int docOrder : docOrders) {, +            proc.onValue(Double.toString(values[docOrder]), docId);]
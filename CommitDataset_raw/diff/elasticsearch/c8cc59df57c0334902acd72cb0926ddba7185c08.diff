[+++ b/src/main/java/org/elasticsearch/index/fielddata/IndexFieldDataService.java, +import org.elasticsearch.indices.breaker.CircuitBreakerService;, +++ b/src/main/java/org/elasticsearch/index/fielddata/IndexFieldDataService.java, +import org.elasticsearch.indices.breaker.CircuitBreakerService;, +++ b/src/main/java/org/elasticsearch/index/query/QueryParseContext.java, +    private final boolean disableFilterCaching;, +    public QueryParseContext(Index index, IndexQueryParserService indexQueryParser, boolean disableFilterCaching) {, +        this.propagateNoCache = disableFilterCaching;, +        this.disableFilterCaching = disableFilterCaching;, +        if (this.disableFilterCaching || this.propagateNoCache || filter instanceof NoCacheFilter) {, +++ b/src/main/java/org/elasticsearch/index/fielddata/IndexFieldDataService.java, +import org.elasticsearch.indices.breaker.CircuitBreakerService;, +++ b/src/main/java/org/elasticsearch/index/query/QueryParseContext.java, +    private final boolean disableFilterCaching;, +    public QueryParseContext(Index index, IndexQueryParserService indexQueryParser, boolean disableFilterCaching) {, +        this.propagateNoCache = disableFilterCaching;, +        this.disableFilterCaching = disableFilterCaching;, +        if (this.disableFilterCaching || this.propagateNoCache || filter instanceof NoCacheFilter) {, +++ b/src/test/java/org/elasticsearch/test/ExternalTestCluster.java, +                    .clear().setBreaker(true).setIndices(true).execute().actionGet();, +, +                assertThat("Fielddata size must be 0 on node: " + stats.getNode(), stats.getIndices().getFieldData().getMemorySizeInBytes(), equalTo(0l));, +                assertThat("Filter cache size must be 0 on node: " + stats.getNode(), stats.getIndices().getFilterCache().getMemorySizeInBytes(), equalTo(0l));, +++ b/src/main/java/org/elasticsearch/index/fielddata/IndexFieldDataService.java, +import org.elasticsearch.indices.breaker.CircuitBreakerService;, +++ b/src/main/java/org/elasticsearch/index/query/QueryParseContext.java, +    private final boolean disableFilterCaching;, +    public QueryParseContext(Index index, IndexQueryParserService indexQueryParser, boolean disableFilterCaching) {, +        this.propagateNoCache = disableFilterCaching;, +        this.disableFilterCaching = disableFilterCaching;, +        if (this.disableFilterCaching || this.propagateNoCache || filter instanceof NoCacheFilter) {, +++ b/src/test/java/org/elasticsearch/test/ExternalTestCluster.java, +                    .clear().setBreaker(true).setIndices(true).execute().actionGet();, +, +                assertThat("Fielddata size must be 0 on node: " + stats.getNode(), stats.getIndices().getFieldData().getMemorySizeInBytes(), equalTo(0l));, +                assertThat("Filter cache size must be 0 on node: " + stats.getNode(), stats.getIndices().getFilterCache().getMemorySizeInBytes(), equalTo(0l));, +++ b/src/test/java/org/elasticsearch/test/InternalTestCluster.java, +import org.elasticsearch.action.admin.cluster.node.stats.NodeStats;, +import org.elasticsearch.action.admin.indices.stats.CommonStatsFlags;, +import org.elasticsearch.node.service.NodeService;, +, +                NodeService nodeService = getInstanceFromNode(NodeService.class, nodeAndClient.node);, +                NodeStats stats = nodeService.stats(CommonStatsFlags.ALL, false, false, false, false, false, false, false, false, false);, +                assertThat("Fielddata size must be 0 on node: " + stats.getNode(), stats.getIndices().getFieldData().getMemorySizeInBytes(), equalTo(0l));, +                assertThat("Filter cache size must be 0 on node: " + stats.getNode(), stats.getIndices().getFilterCache().getMemorySizeInBytes(), equalTo(0l));]
[+++ b/core/src/main/java/org/elasticsearch/bootstrap/Spawner.java, +import org.elasticsearch.common.io.FileSystemUtils;, +                if (FileSystemUtils.isDesktopServicesStore(plugin)) {, +                    continue;, +                }, +++ b/core/src/main/java/org/elasticsearch/bootstrap/Spawner.java, +import org.elasticsearch.common.io.FileSystemUtils;, +                if (FileSystemUtils.isDesktopServicesStore(plugin)) {, +                    continue;, +                }, +++ b/core/src/main/java/org/elasticsearch/common/io/FileSystemUtils.java, +import org.apache.lucene.util.Constants;, +     * Check whether the file denoted by the given path is a desktop services store created by Finder on macOS., +     *, +     * @param path the path, +     * @return true if the current system is macOS and the specified file appears to be a desktop services store file, +     */, +    public static boolean isDesktopServicesStore(final Path path) {, +        return Constants.MAC_OS_X && Files.isRegularFile(path) && ".DS_Store".equals(path.getFileName().toString());, +    }, +, +    /**, +++ b/core/src/main/java/org/elasticsearch/bootstrap/Spawner.java, +import org.elasticsearch.common.io.FileSystemUtils;, +                if (FileSystemUtils.isDesktopServicesStore(plugin)) {, +                    continue;, +                }, +++ b/core/src/main/java/org/elasticsearch/common/io/FileSystemUtils.java, +import org.apache.lucene.util.Constants;, +     * Check whether the file denoted by the given path is a desktop services store created by Finder on macOS., +     *, +     * @param path the path, +     * @return true if the current system is macOS and the specified file appears to be a desktop services store file, +     */, +    public static boolean isDesktopServicesStore(final Path path) {, +        return Constants.MAC_OS_X && Files.isRegularFile(path) && ".DS_Store".equals(path.getFileName().toString());, +    }, +, +    /**, +++ b/core/src/main/java/org/elasticsearch/plugins/PluginsService.java, +import org.elasticsearch.common.io.FileSystemUtils;, +                if (FileSystemUtils.isDesktopServicesStore(plugin)) {, +                    continue;, +                }, +++ b/core/src/main/java/org/elasticsearch/bootstrap/Spawner.java, +import org.elasticsearch.common.io.FileSystemUtils;, +                if (FileSystemUtils.isDesktopServicesStore(plugin)) {, +                    continue;, +                }, +++ b/core/src/main/java/org/elasticsearch/common/io/FileSystemUtils.java, +import org.apache.lucene.util.Constants;, +     * Check whether the file denoted by the given path is a desktop services store created by Finder on macOS., +     *, +     * @param path the path, +     * @return true if the current system is macOS and the specified file appears to be a desktop services store file, +     */, +    public static boolean isDesktopServicesStore(final Path path) {, +        return Constants.MAC_OS_X && Files.isRegularFile(path) && ".DS_Store".equals(path.getFileName().toString());, +    }, +, +    /**, +++ b/core/src/main/java/org/elasticsearch/plugins/PluginsService.java, +import org.elasticsearch.common.io.FileSystemUtils;, +                if (FileSystemUtils.isDesktopServicesStore(plugin)) {, +                    continue;, +                }, +++ b/core/src/test/java/org/elasticsearch/common/io/FileSystemUtilsTests.java, +import org.apache.lucene.util.Constants;, +import static org.hamcrest.Matchers.equalTo;, +, +, +    public void testIsDesktopServicesStoreFile() throws IOException {, +        final Path path = createTempDir();, +        final Path desktopServicesStore = path.resolve(".DS_Store");, +        Files.createFile(desktopServicesStore);, +        assertThat(FileSystemUtils.isDesktopServicesStore(desktopServicesStore), equalTo(Constants.MAC_OS_X));, +, +        Files.delete(desktopServicesStore);, +        Files.createDirectory(desktopServicesStore);, +        assertFalse(FileSystemUtils.isDesktopServicesStore(desktopServicesStore));, +    }, +, +++ b/core/src/main/java/org/elasticsearch/bootstrap/Spawner.java, +import org.elasticsearch.common.io.FileSystemUtils;, +                if (FileSystemUtils.isDesktopServicesStore(plugin)) {, +                    continue;, +                }, +++ b/core/src/main/java/org/elasticsearch/common/io/FileSystemUtils.java, +import org.apache.lucene.util.Constants;, +     * Check whether the file denoted by the given path is a desktop services store created by Finder on macOS., +     *, +     * @param path the path, +     * @return true if the current system is macOS and the specified file appears to be a desktop services store file, +     */, +    public static boolean isDesktopServicesStore(final Path path) {, +        return Constants.MAC_OS_X && Files.isRegularFile(path) && ".DS_Store".equals(path.getFileName().toString());, +    }, +, +    /**, +++ b/core/src/main/java/org/elasticsearch/plugins/PluginsService.java]
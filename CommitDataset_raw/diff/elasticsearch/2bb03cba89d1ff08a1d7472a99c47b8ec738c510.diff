[+++ b/src/test/java/org/elasticsearch/watcher/test/rest/WatcherRestTests.java, +import com.carrotsearch.randomizedtesting.annotations.ParametersFactory;, +import org.elasticsearch.plugins.PluginsService;, +import org.elasticsearch.shield.authc.support.Hasher;, +import org.elasticsearch.test.rest.parser.RestTestParseException;, +    @ParametersFactory, +    public static Iterable<Object[]> parameters() throws IOException, RestTestParseException {, +        return ElasticsearchRestTestCase.createParameters(0, 1);, +    }, +, +                .put(PluginsService.LOAD_PLUGIN_FROM_CLASSPATH, false), +                    .put(PluginsService.LOAD_PLUGIN_FROM_CLASSPATH, false), +                .put(PluginsService.LOAD_PLUGIN_FROM_CLASSPATH, false), +        private static final String TEST_PASSWORD =  "changeme";, +        private static final String TEST_PASSWORD_HASHED =  new String(Hasher.BCRYPT.hash(new SecuredString(TEST_PASSWORD.toCharArray())));, +, +                "admin: " + TEST_PASSWORD_HASHED + "\n" +, +                "monitor:" + TEST_PASSWORD_HASHED;, +                "  cluster: cluster:monitor/state, cluster:monitor/health, indices:admin/template/delete, cluster:admin/repository/delete, cluster:monitor/nodes/liveness, indices:admin/template/put\n" +, +                "  cluster: manage_watcher, cluster:monitor/nodes/info, cluster:monitor/state, cluster:monitor/nodes/liveness, cluster:monitor/health, cluster:admin/repository/delete\n" +, +                "  cluster: monitor_watcher, cluster:monitor/nodes/info, cluster:monitor/nodes/liveness\n" +]
[+++ b/core/src/main/java/org/elasticsearch/cluster/routing/allocation/RerouteExplanation.java, +        AllocationCommand command = in.readNamedWriteable(AllocationCommand.class);, +        out.writeNamedWriteable(explanation.command);, +++ b/core/src/main/java/org/elasticsearch/cluster/routing/allocation/RerouteExplanation.java, +        AllocationCommand command = in.readNamedWriteable(AllocationCommand.class);, +        out.writeNamedWriteable(explanation.command);, +++ b/core/src/main/java/org/elasticsearch/cluster/routing/allocation/command/AllocationCommands.java, +            commands.add(in.readNamedWriteable(AllocationCommand.class));, +            out.writeNamedWriteable(command);, +++ b/core/src/main/java/org/elasticsearch/cluster/routing/allocation/RerouteExplanation.java, +        AllocationCommand command = in.readNamedWriteable(AllocationCommand.class);, +        out.writeNamedWriteable(explanation.command);, +++ b/core/src/main/java/org/elasticsearch/cluster/routing/allocation/command/AllocationCommands.java, +            commands.add(in.readNamedWriteable(AllocationCommand.class));, +            out.writeNamedWriteable(command);, +++ b/core/src/main/java/org/elasticsearch/common/io/stream/StreamInput.java, +++ b/core/src/main/java/org/elasticsearch/cluster/routing/allocation/RerouteExplanation.java, +        AllocationCommand command = in.readNamedWriteable(AllocationCommand.class);, +        out.writeNamedWriteable(explanation.command);, +++ b/core/src/main/java/org/elasticsearch/cluster/routing/allocation/command/AllocationCommands.java, +            commands.add(in.readNamedWriteable(AllocationCommand.class));, +            out.writeNamedWriteable(command);, +++ b/core/src/main/java/org/elasticsearch/common/io/stream/StreamInput.java, +++ b/core/src/main/java/org/elasticsearch/common/io/stream/StreamOutput.java, +++ b/core/src/main/java/org/elasticsearch/cluster/routing/allocation/RerouteExplanation.java, +        AllocationCommand command = in.readNamedWriteable(AllocationCommand.class);, +        out.writeNamedWriteable(explanation.command);, +++ b/core/src/main/java/org/elasticsearch/cluster/routing/allocation/command/AllocationCommands.java, +            commands.add(in.readNamedWriteable(AllocationCommand.class));, +            out.writeNamedWriteable(command);, +++ b/core/src/main/java/org/elasticsearch/common/io/stream/StreamInput.java, +++ b/core/src/main/java/org/elasticsearch/common/io/stream/StreamOutput.java, +++ b/core/src/main/java/org/elasticsearch/search/aggregations/bucket/BucketStreamContext.java, +        format = in.readNamedWriteable(DocValueFormat.class);, +        out.writeNamedWriteable(format);, +++ b/core/src/main/java/org/elasticsearch/cluster/routing/allocation/RerouteExplanation.java, +        AllocationCommand command = in.readNamedWriteable(AllocationCommand.class);, +        out.writeNamedWriteable(explanation.command);, +++ b/core/src/main/java/org/elasticsearch/cluster/routing/allocation/command/AllocationCommands.java, +            commands.add(in.readNamedWriteable(AllocationCommand.class));, +            out.writeNamedWriteable(command);, +++ b/core/src/main/java/org/elasticsearch/common/io/stream/StreamInput.java, +++ b/core/src/main/java/org/elasticsearch/common/io/stream/StreamOutput.java, +++ b/core/src/main/java/org/elasticsearch/search/aggregations/bucket/BucketStreamContext.java, +        format = in.readNamedWriteable(DocValueFormat.class);, +        out.writeNamedWriteable(format);, +++ b/core/src/main/java/org/elasticsearch/search/aggregations/bucket/histogram/InternalHistogram.java, +        format = in.readNamedWriteable(DocValueFormat.class);, +        out.writeNamedWriteable(format);, +++ b/core/src/main/java/org/elasticsearch/cluster/routing/allocation/RerouteExplanation.java, +        AllocationCommand command = in.readNamedWriteable(AllocationCommand.class);, +        out.writeNamedWriteable(explanation.command);, +++ b/core/src/main/java/org/elasticsearch/cluster/routing/allocation/command/AllocationCommands.java, +            commands.add(in.readNamedWriteable(AllocationCommand.class));, +            out.writeNamedWriteable(command);, +++ b/core/src/main/java/org/elasticsearch/common/io/stream/StreamInput.java, +++ b/core/src/main/java/org/elasticsearch/common/io/stream/StreamOutput.java, +++ b/core/src/main/java/org/elasticsearch/search/aggregations/bucket/BucketStreamContext.java, +        format = in.readNamedWriteable(DocValueFormat.class);, +        out.writeNamedWriteable(format);, +++ b/core/src/main/java/org/elasticsearch/search/aggregations/bucket/histogram/InternalHistogram.java, +        format = in.readNamedWriteable(DocValueFormat.class);, +        out.writeNamedWriteable(format);, +++ b/core/src/main/java/org/elasticsearch/search/aggregations/bucket/range/InternalRange.java, +        format = in.readNamedWriteable(DocValueFormat.class);, +        out.writeNamedWriteable(format);, +++ b/core/src/main/java/org/elasticsearch/cluster/routing/allocation/RerouteExplanation.java, +        AllocationCommand command = in.readNamedWriteable(AllocationCommand.class);, +        out.writeNamedWriteable(explanation.command);, +++ b/core/src/main/java/org/elasticsearch/cluster/routing/allocation/command/AllocationCommands.java, +            commands.add(in.readNamedWriteable(AllocationCommand.class));, +            out.writeNamedWriteable(command);, +++ b/core/src/main/java/org/elasticsearch/common/io/stream/StreamInput.java, +++ b/core/src/main/java/org/elasticsearch/common/io/stream/StreamOutput.java, +++ b/core/src/main/java/org/elasticsearch/search/aggregations/bucket/BucketStreamContext.java, +        format = in.readNamedWriteable(DocValueFormat.class);, +        out.writeNamedWriteable(format);, +++ b/core/src/main/java/org/elasticsearch/search/aggregations/bucket/histogram/InternalHistogram.java, +        format = in.readNamedWriteable(DocValueFormat.class);, +        out.writeNamedWriteable(format);, +++ b/core/src/main/java/org/elasticsearch/search/aggregations/bucket/range/InternalRange.java, +        format = in.readNamedWriteable(DocValueFormat.class);, +        out.writeNamedWriteable(format);, +++ b/core/src/main/java/org/elasticsearch/search/aggregations/bucket/significant/SignificantLongTerms.java, +        this.format = in.readNamedWriteable(DocValueFormat.class);, +        out.writeNamedWriteable(format);, +++ b/core/src/main/java/org/elasticsearch/cluster/routing/allocation/RerouteExplanation.java, +        AllocationCommand command = in.readNamedWriteable(AllocationCommand.class);, +        out.writeNamedWriteable(explanation.command);, +++ b/core/src/main/java/org/elasticsearch/cluster/routing/allocation/command/AllocationCommands.java, +            commands.add(in.readNamedWriteable(AllocationCommand.class));, +            out.writeNamedWriteable(command);, +++ b/core/src/main/java/org/elasticsearch/common/io/stream/StreamInput.java, +++ b/core/src/main/java/org/elasticsearch/common/io/stream/StreamOutput.java, +++ b/core/src/main/java/org/elasticsearch/search/aggregations/bucket/BucketStreamContext.java, +        format = in.readNamedWriteable(DocValueFormat.class);, +        out.writeNamedWriteable(format);, +++ b/core/src/main/java/org/elasticsearch/search/aggregations/bucket/histogram/InternalHistogram.java, +        format = in.readNamedWriteable(DocValueFormat.class);, +        out.writeNamedWriteable(format);]
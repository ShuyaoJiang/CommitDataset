[+++ b/x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/security/authc/support/TokensInvalidationResult.java, +        if (in.getVersion().before(Version.V_7_1_0)) {, +        if (out.getVersion().before(Version.V_7_1_0)) {, +++ b/x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/security/authc/support/TokensInvalidationResult.java, +        if (in.getVersion().before(Version.V_7_1_0)) {, +        if (out.getVersion().before(Version.V_7_1_0)) {, +++ b/x-pack/plugin/security/src/main/java/org/elasticsearch/xpack/security/authc/TokenService.java, +        if (version.onOrAfter(Version.V_7_1_0)) {, +            if (authVersion.onOrAfter(Version.V_7_1_0)) {, +        return authVersion.onOrAfter(Version.V_7_1_0), +     * either an encrypted representation of the token id for versions earlier to 7.1.0 or the token ie, +     * itself for versions after 7.1.0, +        if (clusterService.state().nodes().getMinNodeVersion().onOrAfter(Version.V_7_1_0)) {, +++ b/x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/security/authc/support/TokensInvalidationResult.java, +        if (in.getVersion().before(Version.V_7_1_0)) {, +        if (out.getVersion().before(Version.V_7_1_0)) {, +++ b/x-pack/plugin/security/src/main/java/org/elasticsearch/xpack/security/authc/TokenService.java, +        if (version.onOrAfter(Version.V_7_1_0)) {, +            if (authVersion.onOrAfter(Version.V_7_1_0)) {, +        return authVersion.onOrAfter(Version.V_7_1_0), +     * either an encrypted representation of the token id for versions earlier to 7.1.0 or the token ie, +     * itself for versions after 7.1.0, +        if (clusterService.state().nodes().getMinNodeVersion().onOrAfter(Version.V_7_1_0)) {, +++ b/x-pack/qa/rolling-upgrade/src/test/java/org/elasticsearch/upgrades/TokenBackwardsCompatibilityIT.java, +++ b/x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/security/authc/support/TokensInvalidationResult.java, +        if (in.getVersion().before(Version.V_7_1_0)) {, +        if (out.getVersion().before(Version.V_7_1_0)) {, +++ b/x-pack/plugin/security/src/main/java/org/elasticsearch/xpack/security/authc/TokenService.java, +        if (version.onOrAfter(Version.V_7_1_0)) {, +            if (authVersion.onOrAfter(Version.V_7_1_0)) {, +        return authVersion.onOrAfter(Version.V_7_1_0), +     * either an encrypted representation of the token id for versions earlier to 7.1.0 or the token ie, +     * itself for versions after 7.1.0, +        if (clusterService.state().nodes().getMinNodeVersion().onOrAfter(Version.V_7_1_0)) {, +++ b/x-pack/qa/rolling-upgrade/src/test/java/org/elasticsearch/upgrades/TokenBackwardsCompatibilityIT.java, +++ b/x-pack/qa/rolling-upgrade/src/test/resources/rest-api-spec/test/mixed_cluster/50_token_auth.yml, +++ b/x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/security/authc/support/TokensInvalidationResult.java, +        if (in.getVersion().before(Version.V_7_1_0)) {, +        if (out.getVersion().before(Version.V_7_1_0)) {, +++ b/x-pack/plugin/security/src/main/java/org/elasticsearch/xpack/security/authc/TokenService.java, +        if (version.onOrAfter(Version.V_7_1_0)) {, +            if (authVersion.onOrAfter(Version.V_7_1_0)) {, +        return authVersion.onOrAfter(Version.V_7_1_0), +     * either an encrypted representation of the token id for versions earlier to 7.1.0 or the token ie, +     * itself for versions after 7.1.0, +        if (clusterService.state().nodes().getMinNodeVersion().onOrAfter(Version.V_7_1_0)) {, +++ b/x-pack/qa/rolling-upgrade/src/test/java/org/elasticsearch/upgrades/TokenBackwardsCompatibilityIT.java, +++ b/x-pack/qa/rolling-upgrade/src/test/resources/rest-api-spec/test/mixed_cluster/50_token_auth.yml, +++ b/x-pack/qa/rolling-upgrade/src/test/resources/rest-api-spec/test/old_cluster/50_token_auth.yml, +++ b/x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/security/authc/support/TokensInvalidationResult.java, +        if (in.getVersion().before(Version.V_7_1_0)) {, +        if (out.getVersion().before(Version.V_7_1_0)) {, +++ b/x-pack/plugin/security/src/main/java/org/elasticsearch/xpack/security/authc/TokenService.java, +        if (version.onOrAfter(Version.V_7_1_0)) {, +            if (authVersion.onOrAfter(Version.V_7_1_0)) {, +        return authVersion.onOrAfter(Version.V_7_1_0), +     * either an encrypted representation of the token id for versions earlier to 7.1.0 or the token ie, +     * itself for versions after 7.1.0, +        if (clusterService.state().nodes().getMinNodeVersion().onOrAfter(Version.V_7_1_0)) {, +++ b/x-pack/qa/rolling-upgrade/src/test/java/org/elasticsearch/upgrades/TokenBackwardsCompatibilityIT.java, +++ b/x-pack/qa/rolling-upgrade/src/test/resources/rest-api-spec/test/mixed_cluster/50_token_auth.yml, +++ b/x-pack/qa/rolling-upgrade/src/test/resources/rest-api-spec/test/old_cluster/50_token_auth.yml, +++ b/x-pack/qa/rolling-upgrade/src/test/resources/rest-api-spec/test/upgraded_cluster/50_token_auth.yml]
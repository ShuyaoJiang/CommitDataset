[+++ b/src/test/java/org/elasticsearch/search/query/ExistsMissingTests.java, +import static org.elasticsearch.test.hamcrest.ElasticsearchAssertions.*;, +        final Map<String, Object>[] sources = new Map[] {, +        final long numDocs = sources.length;, +        SearchResponse resp = client().prepareSearch("idx").get();, +        assertSearchResponse(resp);, +        assertHitCount(resp, numDocs);, +            resp = client().prepareSearch("idx").setQuery(QueryBuilders.filteredQuery(QueryBuilders.matchAllQuery(), FilterBuilders.existsFilter(fieldName))).execute().actionGet();, +            assertEquals(String.format(Locale.ROOT, "exists(%s, %d) mapping: %s response: %s", fieldName, count, mapping.string(), resp), count, resp.getHits().totalHits());, +            assertEquals(String.format(Locale.ROOT, "missing(%s, %d) mapping: %s response: %s", fieldName, count, mapping.string(), resp), numDocs - count, resp.getHits().totalHits());]
[+++ b/src/main/java/org/elasticsearch/cluster/metadata/MetaDataCreateIndexService.java, +import org.elasticsearch.indices.*;, +                    indexService.indicesLifecycle().beforeIndexAddedToCluster(new Index(request.index()),, +                            indexMetaData.settings());, +, +++ b/src/main/java/org/elasticsearch/cluster/metadata/MetaDataCreateIndexService.java, +import org.elasticsearch.indices.*;, +                    indexService.indicesLifecycle().beforeIndexAddedToCluster(new Index(request.index()),, +                            indexMetaData.settings());, +, +++ b/src/main/java/org/elasticsearch/index/IndexService.java, +    public InternalIndicesLifecycle indicesLifecycle() {, +        return this.indicesLifecycle;, +    }, +, +++ b/src/main/java/org/elasticsearch/cluster/metadata/MetaDataCreateIndexService.java, +import org.elasticsearch.indices.*;, +                    indexService.indicesLifecycle().beforeIndexAddedToCluster(new Index(request.index()),, +                            indexMetaData.settings());, +, +++ b/src/main/java/org/elasticsearch/index/IndexService.java, +    public InternalIndicesLifecycle indicesLifecycle() {, +        return this.indicesLifecycle;, +    }, +, +++ b/src/main/java/org/elasticsearch/indices/IndicesLifecycle.java, +         * Called on the Master node only before the index is created, +         */, +        public void beforeIndexAddedToCluster(Index index, @IndexSettings Settings indexSettings) {, +, +        }, +, +        /**, +         * Called before the index gets created. Note that this is also called, +         * when the index is created on data nodes, +++ b/src/main/java/org/elasticsearch/cluster/metadata/MetaDataCreateIndexService.java, +import org.elasticsearch.indices.*;, +                    indexService.indicesLifecycle().beforeIndexAddedToCluster(new Index(request.index()),, +                            indexMetaData.settings());, +, +++ b/src/main/java/org/elasticsearch/index/IndexService.java, +    public InternalIndicesLifecycle indicesLifecycle() {, +        return this.indicesLifecycle;, +    }, +, +++ b/src/main/java/org/elasticsearch/indices/IndicesLifecycle.java, +         * Called on the Master node only before the index is created, +         */, +        public void beforeIndexAddedToCluster(Index index, @IndexSettings Settings indexSettings) {, +, +        }, +, +        /**, +         * Called before the index gets created. Note that this is also called, +         * when the index is created on data nodes, +++ b/src/main/java/org/elasticsearch/indices/InternalIndicesLifecycle.java, +    public void beforeIndexAddedToCluster(Index index, @IndexSettings Settings indexSettings) {, +        for (Listener listener : listeners) {, +            try {, +                listener.beforeIndexAddedToCluster(index, indexSettings);, +            } catch (Throwable t) {, +                logger.warn("[{}] failed to invoke before index added to cluster callback", t, index.name());, +                throw t;, +            }, +        }, +    }, +, +++ b/src/main/java/org/elasticsearch/cluster/metadata/MetaDataCreateIndexService.java, +import org.elasticsearch.indices.*;, +                    indexService.indicesLifecycle().beforeIndexAddedToCluster(new Index(request.index()),, +                            indexMetaData.settings());, +, +++ b/src/main/java/org/elasticsearch/index/IndexService.java, +    public InternalIndicesLifecycle indicesLifecycle() {, +        return this.indicesLifecycle;, +    }, +, +++ b/src/main/java/org/elasticsearch/indices/IndicesLifecycle.java, +         * Called on the Master node only before the index is created, +         */, +        public void beforeIndexAddedToCluster(Index index, @IndexSettings Settings indexSettings) {, +, +        }, +, +        /**, +         * Called before the index gets created. Note that this is also called, +         * when the index is created on data nodes, +++ b/src/main/java/org/elasticsearch/indices/InternalIndicesLifecycle.java, +    public void beforeIndexAddedToCluster(Index index, @IndexSettings Settings indexSettings) {, +        for (Listener listener : listeners) {, +            try {, +                listener.beforeIndexAddedToCluster(index, indexSettings);, +            } catch (Throwable t) {, +                logger.warn("[{}] failed to invoke before index added to cluster callback", t, index.name());, +                throw t;, +            }, +        }, +    }, +, +++ b/src/main/java/org/elasticsearch/indices/cluster/IndicesClusterStateService.java]
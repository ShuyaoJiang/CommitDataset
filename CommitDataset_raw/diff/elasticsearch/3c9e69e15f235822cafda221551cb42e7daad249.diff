[+++ b/plugins/delete-by-query/src/main/java/org/elasticsearch/rest/action/deletebyquery/RestDeleteByQueryAction.java, +import org.elasticsearch.common.xcontent.XContentFactory;, +import org.elasticsearch.common.xcontent.XContentParser;, +import org.elasticsearch.index.query.QueryParseContext;, +import org.elasticsearch.indices.query.IndicesQueriesRegistry;, +import java.io.IOException;, +, +    private IndicesQueriesRegistry indicesQueriesRegistry;, +, +    public RestDeleteByQueryAction(Settings settings, RestController controller, Client client,, +            IndicesQueriesRegistry indicesQueriesRegistry) {, +        this.indicesQueriesRegistry = indicesQueriesRegistry;, +    public void handleRequest(final RestRequest request, final RestChannel channel, final Client client) throws IOException {, +            XContentParser requestParser = XContentFactory.xContent(request.content()).createParser(request.content());, +            QueryParseContext context = new QueryParseContext(indicesQueriesRegistry);, +            context.reset(requestParser);, +            final QueryBuilder<?> builder = context.parseInnerQueryBuilder();, +            delete.query(builder);, +                XContentParser requestParser = XContentFactory.xContent(source).createParser(source);, +                QueryParseContext context = new QueryParseContext(indicesQueriesRegistry);, +                context.reset(requestParser);, +                final QueryBuilder<?> builder = context.parseInnerQueryBuilder();, +                delete.query(builder);]
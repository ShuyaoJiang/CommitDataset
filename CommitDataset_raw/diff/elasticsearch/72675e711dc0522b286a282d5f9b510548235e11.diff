[+++ b/marvel/src/main/java/org/elasticsearch/marvel/MarvelPlugin.java, +import org.elasticsearch.cluster.settings.Validator;, +import java.util.Map;, +        for (Map.Entry<String, Validator> setting : MarvelSettings.dynamicSettings().entrySet()) {, +            module.registerClusterDynamicSetting(setting.getKey(), setting.getValue());, +++ b/marvel/src/main/java/org/elasticsearch/marvel/MarvelPlugin.java, +import org.elasticsearch.cluster.settings.Validator;, +import java.util.Map;, +        for (Map.Entry<String, Validator> setting : MarvelSettings.dynamicSettings().entrySet()) {, +            module.registerClusterDynamicSetting(setting.getKey(), setting.getValue());, +++ b/marvel/src/main/java/org/elasticsearch/marvel/agent/settings/MarvelSetting.java, +    private final V defaultValue;, +    MarvelSetting(String name, String description, V defaultValue) {, +        this.defaultValue = defaultValue;, +    public V getDefaultValue() {, +        return defaultValue;, +    }, +, +    public static BooleanSetting booleanSetting(String name, Boolean defaultValue, String description) {, +        return new BooleanSetting(name, description, defaultValue);, +    public static StringSetting stringSetting(String name, String defaultValue, String description) {, +        return new StringSetting(name, description, defaultValue);, +    public static StringArraySetting arraySetting(String name, String[] defaultValue, String description) {, +        return new StringArraySetting(name, description, defaultValue);, +    public static TimeValueSetting timeSetting(String name, TimeValue defaultValue, String description) {, +        return new TimeValueSetting(name, description, defaultValue);, +    public static TimeoutValueSetting timeoutSetting(String name, TimeValue defaultTimeoutValue, String description) {, +        return new TimeoutValueSetting(name, description, defaultTimeoutValue);, +        BooleanSetting(String name, String description, Boolean defaultValue) {, +            super(name, description, defaultValue);, +        StringSetting(String name, String description, String defaultValue) {, +            super(name, description, defaultValue);, +        StringArraySetting(String name, String description, String[] defaultValue) {, +            super(name, description, defaultValue);, +        TimeValueSetting(String name, String description, TimeValue defaultValue) {, +            super(name, description, defaultValue);, +        TimeoutValueSetting(String name, String description, TimeValue defaultValue) {, +            super(name, description, defaultValue);, +++ b/marvel/src/main/java/org/elasticsearch/marvel/MarvelPlugin.java, +import org.elasticsearch.cluster.settings.Validator;, +import java.util.Map;, +        for (Map.Entry<String, Validator> setting : MarvelSettings.dynamicSettings().entrySet()) {, +            module.registerClusterDynamicSetting(setting.getKey(), setting.getValue());, +++ b/marvel/src/main/java/org/elasticsearch/marvel/agent/settings/MarvelSetting.java, +    private final V defaultValue;, +    MarvelSetting(String name, String description, V defaultValue) {, +        this.defaultValue = defaultValue;, +    public V getDefaultValue() {, +        return defaultValue;, +    }, +, +    public static BooleanSetting booleanSetting(String name, Boolean defaultValue, String description) {, +        return new BooleanSetting(name, description, defaultValue);, +    public static StringSetting stringSetting(String name, String defaultValue, String description) {, +        return new StringSetting(name, description, defaultValue);, +    public static StringArraySetting arraySetting(String name, String[] defaultValue, String description) {, +        return new StringArraySetting(name, description, defaultValue);, +    public static TimeValueSetting timeSetting(String name, TimeValue defaultValue, String description) {, +        return new TimeValueSetting(name, description, defaultValue);, +    public static TimeoutValueSetting timeoutSetting(String name, TimeValue defaultTimeoutValue, String description) {, +        return new TimeoutValueSetting(name, description, defaultTimeoutValue);, +        BooleanSetting(String name, String description, Boolean defaultValue) {, +            super(name, description, defaultValue);, +        StringSetting(String name, String description, String defaultValue) {, +            super(name, description, defaultValue);, +        StringArraySetting(String name, String description, String[] defaultValue) {, +            super(name, description, defaultValue);, +        TimeValueSetting(String name, String description, TimeValue defaultValue) {, +            super(name, description, defaultValue);, +        TimeoutValueSetting(String name, String description, TimeValue defaultValue) {, +            super(name, description, defaultValue);, +++ b/marvel/src/main/java/org/elasticsearch/marvel/agent/settings/MarvelSettings.java, +import org.elasticsearch.cluster.settings.Validator;, +import java.util.Collection;, +import java.util.Collections;, +import java.util.HashMap;, +import java.util.Map;, +    private Map<String, ? extends MarvelSetting> settings = Collections.EMPTY_MAP;, +        logger.trace("initializing marvel settings");, +        this.settings = defaultSettings();, +, +        logger.trace("updating marvel settings with cluster settings");, +        updateSettings(clusterSettings);, +    private Map<String, MarvelSetting> defaultSettings() {, +        Map<String, MarvelSetting> map = new HashMap<>();, +        map.put(INTERVAL, timeSetting(INTERVAL, TimeValue.timeValueSeconds(10),, +                "Sampling interval between two collections (default to 10s)"));, +        map.put(STARTUP_DELAY, timeSetting(STARTUP_DELAY, null,, +                "Waiting time before the agent start to collect data (default to sampling interval)"));, +        map.put(INDEX_STATS_TIMEOUT, timeoutSetting(INDEX_STATS_TIMEOUT, TimeValue.timeValueMinutes(10),, +                "Timeout value when collecting index statistics (default to 10m)"));, +        map.put(INDICES_STATS_TIMEOUT, timeoutSetting(INDICES_STATS_TIMEOUT, TimeValue.timeValueMinutes(10),, +                "Timeout value when collecting total indices statistics (default to 10m)"));, +        map.put(INDICES, arraySetting(INDICES, Strings.EMPTY_ARRAY,, +                "List of indices names whose stats will be exported (default to all indices)"));, +        map.put(CLUSTER_STATE_TIMEOUT, timeoutSetting(CLUSTER_STATE_TIMEOUT, TimeValue.timeValueMinutes(10),, +                "Timeout value when collecting the cluster state (default to 10m)"));, +        map.put(CLUSTER_STATS_TIMEOUT, timeoutSetting(CLUSTER_STATS_TIMEOUT, TimeValue.timeValueMinutes(10),, +                "Timeout value when collecting the cluster statistics (default to 10m)"));, +        map.put(INDEX_RECOVERY_TIMEOUT, timeoutSetting(INDEX_RECOVERY_TIMEOUT, TimeValue.timeValueMinutes(10),]
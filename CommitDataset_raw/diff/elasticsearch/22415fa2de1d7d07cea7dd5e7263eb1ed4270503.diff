[+++ b/x-pack/plugin/ml/log-structure-finder/src/main/java/org/elasticsearch/xpack/ml/logstructurefinder/LogStructureFinderManager.java, +                Charset charset = Charset.forName(name);, +                // Some character sets cannot be encoded.  These are extremely rare so it's likely that, +                // they've been chosen based on incorrectly provided binary data.  Therefore, err on, +                // the side of rejecting binary data., +                if (charset.canEncode()) {, +                    byte[] spaceBytes = " ".getBytes(charset);, +                }]
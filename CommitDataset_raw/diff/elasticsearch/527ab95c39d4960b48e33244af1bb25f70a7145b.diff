[+++ b/core/src/main/java/org/elasticsearch/cluster/routing/RoutingNodes.java, +import java.util.*;, +                unassigned().forEach(shards::add);, +++ b/core/src/main/java/org/elasticsearch/cluster/routing/RoutingNodes.java, +import java.util.*;, +                unassigned().forEach(shards::add);, +++ b/core/src/main/java/org/elasticsearch/cluster/routing/RoutingTable.java, +import org.elasticsearch.common.util.iterable.Iterables;, +import java.util.*;, +, +            Iterable<ShardRouting> shardRoutingEntries = Iterables.concat(routingNodes.unassigned(), routingNodes.unassigned().ignored());, +, +            for (ShardRouting shardRoutingEntry : shardRoutingEntries) {, +++ b/core/src/main/java/org/elasticsearch/cluster/routing/RoutingNodes.java, +import java.util.*;, +                unassigned().forEach(shards::add);, +++ b/core/src/main/java/org/elasticsearch/cluster/routing/RoutingTable.java, +import org.elasticsearch.common.util.iterable.Iterables;, +import java.util.*;, +, +            Iterable<ShardRouting> shardRoutingEntries = Iterables.concat(routingNodes.unassigned(), routingNodes.unassigned().ignored());, +, +            for (ShardRouting shardRoutingEntry : shardRoutingEntries) {, +++ b/core/src/main/java/org/elasticsearch/cluster/service/InternalClusterService.java, +import org.elasticsearch.common.util.iterable.Iterables;, +    private final Iterable<ClusterStateListener> preAppliedListeners = Iterables.concat(priorityClusterStateListeners, clusterStateListeners, lastClusterStateListeners);, +++ b/core/src/main/java/org/elasticsearch/cluster/routing/RoutingNodes.java, +import java.util.*;, +                unassigned().forEach(shards::add);, +++ b/core/src/main/java/org/elasticsearch/cluster/routing/RoutingTable.java, +import org.elasticsearch.common.util.iterable.Iterables;, +import java.util.*;, +, +            Iterable<ShardRouting> shardRoutingEntries = Iterables.concat(routingNodes.unassigned(), routingNodes.unassigned().ignored());, +, +            for (ShardRouting shardRoutingEntry : shardRoutingEntries) {, +++ b/core/src/main/java/org/elasticsearch/cluster/service/InternalClusterService.java, +import org.elasticsearch.common.util.iterable.Iterables;, +    private final Iterable<ClusterStateListener> preAppliedListeners = Iterables.concat(priorityClusterStateListeners, clusterStateListeners, lastClusterStateListeners);, +++ b/core/src/main/java/org/elasticsearch/common/Strings.java, +import java.util.*;, +++ b/core/src/main/java/org/elasticsearch/cluster/routing/RoutingNodes.java, +import java.util.*;, +                unassigned().forEach(shards::add);, +++ b/core/src/main/java/org/elasticsearch/cluster/routing/RoutingTable.java, +import org.elasticsearch.common.util.iterable.Iterables;, +import java.util.*;, +, +            Iterable<ShardRouting> shardRoutingEntries = Iterables.concat(routingNodes.unassigned(), routingNodes.unassigned().ignored());, +, +            for (ShardRouting shardRoutingEntry : shardRoutingEntries) {, +++ b/core/src/main/java/org/elasticsearch/cluster/service/InternalClusterService.java, +import org.elasticsearch.common.util.iterable.Iterables;, +    private final Iterable<ClusterStateListener> preAppliedListeners = Iterables.concat(priorityClusterStateListeners, clusterStateListeners, lastClusterStateListeners);, +++ b/core/src/main/java/org/elasticsearch/common/Strings.java, +import java.util.*;, +++ b/core/src/main/java/org/elasticsearch/common/inject/InjectorBuilder.java, +import org.elasticsearch.common.util.iterable.Iterables;, +++ b/core/src/main/java/org/elasticsearch/cluster/routing/RoutingNodes.java, +import java.util.*;, +                unassigned().forEach(shards::add);, +++ b/core/src/main/java/org/elasticsearch/cluster/routing/RoutingTable.java, +import org.elasticsearch.common.util.iterable.Iterables;, +import java.util.*;, +, +            Iterable<ShardRouting> shardRoutingEntries = Iterables.concat(routingNodes.unassigned(), routingNodes.unassigned().ignored());, +, +            for (ShardRouting shardRoutingEntry : shardRoutingEntries) {, +++ b/core/src/main/java/org/elasticsearch/cluster/service/InternalClusterService.java, +import org.elasticsearch.common.util.iterable.Iterables;, +    private final Iterable<ClusterStateListener> preAppliedListeners = Iterables.concat(priorityClusterStateListeners, clusterStateListeners, lastClusterStateListeners);, +++ b/core/src/main/java/org/elasticsearch/common/Strings.java, +import java.util.*;, +++ b/core/src/main/java/org/elasticsearch/common/inject/InjectorBuilder.java, +import org.elasticsearch.common.util.iterable.Iterables;, +++ b/core/src/main/java/org/elasticsearch/common/inject/assistedinject/FactoryProvider2.java, +                Message onlyError = e.getErrorMessages().iterator().next();, +++ b/core/src/main/java/org/elasticsearch/cluster/routing/RoutingNodes.java, +import java.util.*;, +                unassigned().forEach(shards::add);, +++ b/core/src/main/java/org/elasticsearch/cluster/routing/RoutingTable.java, +import org.elasticsearch.common.util.iterable.Iterables;, +import java.util.*;, +, +            Iterable<ShardRouting> shardRoutingEntries = Iterables.concat(routingNodes.unassigned(), routingNodes.unassigned().ignored());, +, +            for (ShardRouting shardRoutingEntry : shardRoutingEntries) {, +++ b/core/src/main/java/org/elasticsearch/cluster/service/InternalClusterService.java, +import org.elasticsearch.common.util.iterable.Iterables;, +    private final Iterable<ClusterStateListener> preAppliedListeners = Iterables.concat(priorityClusterStateListeners, clusterStateListeners, lastClusterStateListeners);, +++ b/core/src/main/java/org/elasticsearch/common/Strings.java, +import java.util.*;, +++ b/core/src/main/java/org/elasticsearch/common/inject/InjectorBuilder.java, +import org.elasticsearch.common.util.iterable.Iterables;, +++ b/core/src/main/java/org/elasticsearch/common/inject/assistedinject/FactoryProvider2.java, +                Message onlyError = e.getErrorMessages().iterator().next();, +++ b/core/src/main/java/org/elasticsearch/common/inject/internal/SourceProvider.java, +import org.elasticsearch.common.util.iterable.Iterables;, +++ b/core/src/main/java/org/elasticsearch/cluster/routing/RoutingNodes.java, +import java.util.*;]
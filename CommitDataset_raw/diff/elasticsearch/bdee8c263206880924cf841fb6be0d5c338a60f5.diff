[+++ b/core/src/main/java/org/elasticsearch/action/admin/cluster/node/tasks/list/ListTasksResponse.java, +            builder.endObject();, +++ b/core/src/main/java/org/elasticsearch/action/admin/cluster/node/tasks/list/ListTasksResponse.java, +            builder.endObject();, +++ b/core/src/main/java/org/elasticsearch/common/xcontent/XContentBuilder.java, +            throw new IllegalStateException("failed to close the XContentBuilder", e);, +++ b/core/src/main/java/org/elasticsearch/action/admin/cluster/node/tasks/list/ListTasksResponse.java, +            builder.endObject();, +++ b/core/src/main/java/org/elasticsearch/common/xcontent/XContentBuilder.java, +            throw new IllegalStateException("failed to close the XContentBuilder", e);, +++ b/core/src/main/java/org/elasticsearch/common/xcontent/cbor/CborXContent.java, +import com.fasterxml.jackson.core.JsonGenerator;, +        // Do not automatically close unclosed objects/arrays in com.fasterxml.jackson.dataformat.cbor.CBORGenerator#close() method, +        cborFactory.configure(JsonGenerator.Feature.AUTO_CLOSE_JSON_CONTENT, false);, +++ b/core/src/main/java/org/elasticsearch/action/admin/cluster/node/tasks/list/ListTasksResponse.java, +            builder.endObject();, +++ b/core/src/main/java/org/elasticsearch/common/xcontent/XContentBuilder.java, +            throw new IllegalStateException("failed to close the XContentBuilder", e);, +++ b/core/src/main/java/org/elasticsearch/common/xcontent/cbor/CborXContent.java, +import com.fasterxml.jackson.core.JsonGenerator;, +        // Do not automatically close unclosed objects/arrays in com.fasterxml.jackson.dataformat.cbor.CBORGenerator#close() method, +        cborFactory.configure(JsonGenerator.Feature.AUTO_CLOSE_JSON_CONTENT, false);, +++ b/core/src/main/java/org/elasticsearch/common/xcontent/json/JsonXContent.java, +        // Do not automatically close unclosed objects/arrays in com.fasterxml.jackson.core.json.UTF8JsonGenerator#close() method, +        jsonFactory.configure(JsonGenerator.Feature.AUTO_CLOSE_JSON_CONTENT, false);, +++ b/core/src/main/java/org/elasticsearch/action/admin/cluster/node/tasks/list/ListTasksResponse.java, +            builder.endObject();, +++ b/core/src/main/java/org/elasticsearch/common/xcontent/XContentBuilder.java, +            throw new IllegalStateException("failed to close the XContentBuilder", e);, +++ b/core/src/main/java/org/elasticsearch/common/xcontent/cbor/CborXContent.java, +import com.fasterxml.jackson.core.JsonGenerator;, +        // Do not automatically close unclosed objects/arrays in com.fasterxml.jackson.dataformat.cbor.CBORGenerator#close() method, +        cborFactory.configure(JsonGenerator.Feature.AUTO_CLOSE_JSON_CONTENT, false);, +++ b/core/src/main/java/org/elasticsearch/common/xcontent/json/JsonXContent.java, +        // Do not automatically close unclosed objects/arrays in com.fasterxml.jackson.core.json.UTF8JsonGenerator#close() method, +        jsonFactory.configure(JsonGenerator.Feature.AUTO_CLOSE_JSON_CONTENT, false);, +++ b/core/src/main/java/org/elasticsearch/common/xcontent/json/JsonXContentGenerator.java, +        JsonStreamContext context = generator.getOutputContext();, +        if ((context != null) && (context.inRoot() ==  false)) {, +            throw new IOException("unclosed object or array found");, +        }, +++ b/core/src/main/java/org/elasticsearch/action/admin/cluster/node/tasks/list/ListTasksResponse.java, +            builder.endObject();, +++ b/core/src/main/java/org/elasticsearch/common/xcontent/XContentBuilder.java, +            throw new IllegalStateException("failed to close the XContentBuilder", e);, +++ b/core/src/main/java/org/elasticsearch/common/xcontent/cbor/CborXContent.java, +import com.fasterxml.jackson.core.JsonGenerator;, +        // Do not automatically close unclosed objects/arrays in com.fasterxml.jackson.dataformat.cbor.CBORGenerator#close() method, +        cborFactory.configure(JsonGenerator.Feature.AUTO_CLOSE_JSON_CONTENT, false);, +++ b/core/src/main/java/org/elasticsearch/common/xcontent/json/JsonXContent.java, +        // Do not automatically close unclosed objects/arrays in com.fasterxml.jackson.core.json.UTF8JsonGenerator#close() method, +        jsonFactory.configure(JsonGenerator.Feature.AUTO_CLOSE_JSON_CONTENT, false);, +++ b/core/src/main/java/org/elasticsearch/common/xcontent/json/JsonXContentGenerator.java, +        JsonStreamContext context = generator.getOutputContext();, +        if ((context != null) && (context.inRoot() ==  false)) {, +            throw new IOException("unclosed object or array found");, +        }, +++ b/core/src/main/java/org/elasticsearch/common/xcontent/smile/SmileXContent.java, +import com.fasterxml.jackson.core.JsonGenerator;, +        // Do not automatically close unclosed objects/arrays in com.fasterxml.jackson.dataformat.smile.SmileGenerator#close() method, +        smileFactory.configure(JsonGenerator.Feature.AUTO_CLOSE_JSON_CONTENT, false);, +++ b/core/src/main/java/org/elasticsearch/action/admin/cluster/node/tasks/list/ListTasksResponse.java, +            builder.endObject();, +++ b/core/src/main/java/org/elasticsearch/common/xcontent/XContentBuilder.java, +            throw new IllegalStateException("failed to close the XContentBuilder", e);, +++ b/core/src/main/java/org/elasticsearch/common/xcontent/cbor/CborXContent.java, +import com.fasterxml.jackson.core.JsonGenerator;, +        // Do not automatically close unclosed objects/arrays in com.fasterxml.jackson.dataformat.cbor.CBORGenerator#close() method, +        cborFactory.configure(JsonGenerator.Feature.AUTO_CLOSE_JSON_CONTENT, false);, +++ b/core/src/main/java/org/elasticsearch/common/xcontent/json/JsonXContent.java, +        // Do not automatically close unclosed objects/arrays in com.fasterxml.jackson.core.json.UTF8JsonGenerator#close() method, +        jsonFactory.configure(JsonGenerator.Feature.AUTO_CLOSE_JSON_CONTENT, false);, +++ b/core/src/main/java/org/elasticsearch/common/xcontent/json/JsonXContentGenerator.java, +        JsonStreamContext context = generator.getOutputContext();, +        if ((context != null) && (context.inRoot() ==  false)) {, +            throw new IOException("unclosed object or array found");, +        }, +++ b/core/src/main/java/org/elasticsearch/common/xcontent/smile/SmileXContent.java, +import com.fasterxml.jackson.core.JsonGenerator;, +        // Do not automatically close unclosed objects/arrays in com.fasterxml.jackson.dataformat.smile.SmileGenerator#close() method, +        smileFactory.configure(JsonGenerator.Feature.AUTO_CLOSE_JSON_CONTENT, false);, +++ b/core/src/main/java/org/elasticsearch/rest/action/fieldstats/RestFieldStatsAction.java, +                    builder.endObject();, +                builder.endObject();, +++ b/core/src/main/java/org/elasticsearch/action/admin/cluster/node/tasks/list/ListTasksResponse.java, +            builder.endObject();, +++ b/core/src/main/java/org/elasticsearch/common/xcontent/XContentBuilder.java, +            throw new IllegalStateException("failed to close the XContentBuilder", e);, +++ b/core/src/main/java/org/elasticsearch/common/xcontent/cbor/CborXContent.java, +import com.fasterxml.jackson.core.JsonGenerator;, +        // Do not automatically close unclosed objects/arrays in com.fasterxml.jackson.dataformat.cbor.CBORGenerator#close() method, +        cborFactory.configure(JsonGenerator.Feature.AUTO_CLOSE_JSON_CONTENT, false);, +++ b/core/src/main/java/org/elasticsearch/common/xcontent/json/JsonXContent.java, +        // Do not automatically close unclosed objects/arrays in com.fasterxml.jackson.core.json.UTF8JsonGenerator#close() method, +        jsonFactory.configure(JsonGenerator.Feature.AUTO_CLOSE_JSON_CONTENT, false);, +++ b/core/src/main/java/org/elasticsearch/common/xcontent/json/JsonXContentGenerator.java, +        JsonStreamContext context = generator.getOutputContext();, +        if ((context != null) && (context.inRoot() ==  false)) {, +            throw new IOException("unclosed object or array found");, +        }]
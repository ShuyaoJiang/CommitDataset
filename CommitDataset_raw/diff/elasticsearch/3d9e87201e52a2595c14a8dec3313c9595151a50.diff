[+++ b/src/main/java/org/elasticsearch/gateway/shared/SharedStorageGateway.java, +import java.util.concurrent.ExecutorService;, +import java.util.concurrent.TimeUnit;, +, +import static java.util.concurrent.Executors.newSingleThreadExecutor;, +import static org.elasticsearch.common.util.concurrent.EsExecutors.daemonThreadFactory;, +, +    private ExecutorService writeStateExecutor;, +, +        this.writeStateExecutor = newSingleThreadExecutor(daemonThreadFactory(settings, "gateway#writeMetaData"));, +        writeStateExecutor.shutdown();, +        try {, +            writeStateExecutor.awaitTermination(10, TimeUnit.SECONDS);, +        } catch (InterruptedException e) {, +            // ignore, +        }, +            writeStateExecutor.execute(new Runnable() {]
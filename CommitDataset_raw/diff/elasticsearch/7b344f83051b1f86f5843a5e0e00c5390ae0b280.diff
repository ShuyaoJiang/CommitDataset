[+++ b/src/main/java/org/elasticsearch/cache/recycler/PageCacheRecycler.java, +        final int maxPageCount = (int) Math.min(Integer.MAX_VALUE, limit / BigArrays.PAGE_SIZE_IN_BYTES);, +        final int maxBytePageCount = (int) (bytesWeight * maxPageCount / totalWeight);, +        bytePage = build(type, maxBytePageCount, searchThreadPoolSize, availableProcessors, new AbstractRecyclerC<byte[]>() {, +, +        final int maxIntPageCount = (int) (intsWeight * maxPageCount / totalWeight);, +        intPage = build(type, maxIntPageCount, searchThreadPoolSize, availableProcessors, new AbstractRecyclerC<int[]>() {, +, +        final int maxLongPageCount = (int) (longsWeight * maxPageCount / totalWeight);, +        longPage = build(type, maxLongPageCount, searchThreadPoolSize, availableProcessors, new AbstractRecyclerC<long[]>() {, +, +        final int maxObjectPageCount = (int) (objectsWeight * maxPageCount / totalWeight);, +        objectPage = build(type, maxObjectPageCount, searchThreadPoolSize, availableProcessors, new AbstractRecyclerC<Object[]>() {, +, +        assert BigArrays.PAGE_SIZE_IN_BYTES * (maxBytePageCount + maxIntPageCount + maxLongPageCount + maxObjectPageCount) <= limit;, +++ b/src/main/java/org/elasticsearch/cache/recycler/PageCacheRecycler.java, +        final int maxPageCount = (int) Math.min(Integer.MAX_VALUE, limit / BigArrays.PAGE_SIZE_IN_BYTES);, +        final int maxBytePageCount = (int) (bytesWeight * maxPageCount / totalWeight);, +        bytePage = build(type, maxBytePageCount, searchThreadPoolSize, availableProcessors, new AbstractRecyclerC<byte[]>() {, +, +        final int maxIntPageCount = (int) (intsWeight * maxPageCount / totalWeight);, +        intPage = build(type, maxIntPageCount, searchThreadPoolSize, availableProcessors, new AbstractRecyclerC<int[]>() {, +, +        final int maxLongPageCount = (int) (longsWeight * maxPageCount / totalWeight);, +        longPage = build(type, maxLongPageCount, searchThreadPoolSize, availableProcessors, new AbstractRecyclerC<long[]>() {, +, +        final int maxObjectPageCount = (int) (objectsWeight * maxPageCount / totalWeight);, +        objectPage = build(type, maxObjectPageCount, searchThreadPoolSize, availableProcessors, new AbstractRecyclerC<Object[]>() {, +, +        assert BigArrays.PAGE_SIZE_IN_BYTES * (maxBytePageCount + maxIntPageCount + maxLongPageCount + maxObjectPageCount) <= limit;, +++ b/src/main/java/org/elasticsearch/common/rounding/TimeZoneRounding.java, +            return timeZone.convertLocalToUTC(rounded, false, utcMillis);, +            return timeZone.convertLocalToUTC(nextInLocalTime, false);, +            return timeZone.convertLocalToUTC(rounded, false);, +            return timeZone.convertLocalToUTC(next, false);, +++ b/src/main/java/org/elasticsearch/cache/recycler/PageCacheRecycler.java, +        final int maxPageCount = (int) Math.min(Integer.MAX_VALUE, limit / BigArrays.PAGE_SIZE_IN_BYTES);, +        final int maxBytePageCount = (int) (bytesWeight * maxPageCount / totalWeight);, +        bytePage = build(type, maxBytePageCount, searchThreadPoolSize, availableProcessors, new AbstractRecyclerC<byte[]>() {, +, +        final int maxIntPageCount = (int) (intsWeight * maxPageCount / totalWeight);, +        intPage = build(type, maxIntPageCount, searchThreadPoolSize, availableProcessors, new AbstractRecyclerC<int[]>() {, +, +        final int maxLongPageCount = (int) (longsWeight * maxPageCount / totalWeight);, +        longPage = build(type, maxLongPageCount, searchThreadPoolSize, availableProcessors, new AbstractRecyclerC<long[]>() {, +, +        final int maxObjectPageCount = (int) (objectsWeight * maxPageCount / totalWeight);, +        objectPage = build(type, maxObjectPageCount, searchThreadPoolSize, availableProcessors, new AbstractRecyclerC<Object[]>() {, +, +        assert BigArrays.PAGE_SIZE_IN_BYTES * (maxBytePageCount + maxIntPageCount + maxLongPageCount + maxObjectPageCount) <= limit;, +++ b/src/main/java/org/elasticsearch/common/rounding/TimeZoneRounding.java, +            return timeZone.convertLocalToUTC(rounded, false, utcMillis);, +            return timeZone.convertLocalToUTC(nextInLocalTime, false);, +            return timeZone.convertLocalToUTC(rounded, false);, +            return timeZone.convertLocalToUTC(next, false);, +++ b/src/test/java/org/elasticsearch/common/rounding/TimeZoneRoundingTests.java, +    /**, +     * test for #10025, strict local to UTC conversion can cause joda exceptions, +     * on DST start, +     */, +    @Test, +    public void testLenientConversionDST() {, +        DateTimeZone tz = DateTimeZone.forID("America/Sao_Paulo");, +        long start = time("2014-10-18T20:50:00.000", tz);, +        long end = time("2014-10-19T01:00:00.000", tz);, +        Rounding tzRounding = new TimeZoneRounding.TimeUnitRounding(DateTimeUnit.MINUTES_OF_HOUR, tz);, +        Rounding dayTzRounding = new TimeZoneRounding.TimeIntervalRounding(60000, tz);, +        for (long time = start; time < end; time = time + 60000) {, +            assertThat(tzRounding.nextRoundingValue(time), greaterThan(time));, +            assertThat(dayTzRounding.nextRoundingValue(time), greaterThan(time));, +        }, +    }, +]
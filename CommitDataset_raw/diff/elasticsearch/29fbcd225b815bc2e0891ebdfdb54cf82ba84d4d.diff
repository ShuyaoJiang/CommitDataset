[+++ b/bin/plugin, +export HOSTNAME=`hostname -s`, +, +++ b/bin/plugin, +export HOSTNAME=`hostname -s`, +, +++ b/bin/plugin.bat, +SET HOSTNAME=%COMPUTERNAME%, +, +++ b/bin/plugin, +export HOSTNAME=`hostname -s`, +, +++ b/bin/plugin.bat, +SET HOSTNAME=%COMPUTERNAME%, +, +++ b/docs/reference/indices.asciidoc, +++ b/bin/plugin, +export HOSTNAME=`hostname -s`, +, +++ b/bin/plugin.bat, +SET HOSTNAME=%COMPUTERNAME%, +, +++ b/docs/reference/indices.asciidoc, +++ b/docs/reference/indices/flush.asciidoc, +POST /twitter/_flush, +// AUTOSENSE, +POST /kimchy,elasticsearch/_flush, +POST /_flush, +// AUTOSENSE, +, +[[indices-synced-flush]], +=== Synced Flush, +, +Elasticsearch tracks the indexing activity of each shard. Shards that have not, +received any indexing operations for 30 minutes are automatically marked as inactive. This presents, +an opportunity for Elasticsearch to reduce shard resources and also perform, +a special kind of flush, called `synced flush`. A synced flush performs a normal flush, then adds, +a generated unique marker (sync_id) to all shards., +, +Since the sync id marker was added when there were no ongoing indexing operations, it can, +be used as a quick way to check if the two shards' lucene indices are identical. This quick sync id, +comparison (if present) is used during recovery or restarts to skip the first and, +most costly phase of the process. In that case, no segment files need to be copied and, +the transaction log replay phase of the recovery can start immediately. Note that since the sync id, +marker was applied together with a flush, it is very likely that the transaction log will be empty,, +speeding up recoveries even more., +, +This is particularly useful for use cases having lots of indices which are, +never or very rarely updated, such as time based data. This use case typically generates lots of indices whose, +recovery without the synced flush marker would take a long time., +, +To check whether a shard has a marker or not, look for the `commit` section of shard stats returned by, +the <<indices-stats,indices stats>> API:, +, +[source,bash], +--------------------------------------------------, +GET /twitter/_stats/commit?level=shards, +--------------------------------------------------, +// AUTOSENSE, +, +, +which returns something similar to:, +, +[source,js], +--------------------------------------------------, +{, +   ..., +   "indices": {, +      "twitter": {, +         "primaries": {},, +         "total": {},, +         "shards": {, +            "0": [, +               {, +                  "routing": {, +                     ..., +                  },, +                  "commit": {, +                     "id": "te7zF7C4UsirqvL6jp/vUg==",, +                     "generation": 2,, +                     "user_data": {, +                        "sync_id": "AU2VU0meX-VX2aNbEUsD" <1>,, +                        ..., +                     },, +                     "num_docs": 0, +                  }, +               }, +               ..., +            ],, +            ..., +         }, +      }, +   }, +}, +--------------------------------------------------, +<1> the `sync id` marker, +, +[float], +=== Synced Flush API, +]
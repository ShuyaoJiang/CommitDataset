[+++ b/modules/elasticsearch/src/main/java/org/elasticsearch/indices/memory/IndexingMemoryBufferController.java, +        ByteSizeValue indexingBuffer;, +        String indexingBufferSetting = componentSettings.get("index_buffer_size", "10%");, +        if (indexingBufferSetting.endsWith("%")) {, +            double percent = Double.parseDouble(indexingBufferSetting.substring(0, indexingBufferSetting.length() - 1));, +            indexingBuffer = new ByteSizeValue((long) (((double) JvmInfo.jvmInfo().mem().heapMax().bytes()) * (percent / 100)));, +            ByteSizeValue minIndexingBuffer = componentSettings.getAsBytesSize("min_index_buffer_size", new ByteSizeValue(48, ByteSizeUnit.MB));, +            ByteSizeValue maxIndexingBuffer = componentSettings.getAsBytesSize("max_index_buffer_size", null);, +, +            if (indexingBuffer.bytes() < minIndexingBuffer.bytes()) {, +                indexingBuffer = minIndexingBuffer;, +            if (maxIndexingBuffer != null && indexingBuffer.bytes() > maxIndexingBuffer.bytes()) {, +                indexingBuffer = maxIndexingBuffer;, +            }, +        } else {, +            indexingBuffer = ByteSizeValue.parseBytesSizeValue(indexingBufferSetting, null);, +        }, +, +        this.indexingBuffer = indexingBuffer;]
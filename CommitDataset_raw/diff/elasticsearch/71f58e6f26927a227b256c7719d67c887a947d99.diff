[+++ b/plugins/repository-gcs/src/main/java/org/elasticsearch/repositories/gcs/GoogleCloudStorageRepository.java, +        TimeValue finalConnectTimeout = connectTimeout;, +        TimeValue finalReadTimeout = readTimeout;, +        Storage client = SocketAccess.doPrivilegedIOException(() ->, +            storageService.createClient(clientName, application, finalConnectTimeout, finalReadTimeout));, +++ b/plugins/repository-gcs/src/main/java/org/elasticsearch/repositories/gcs/GoogleCloudStorageRepository.java, +        TimeValue finalConnectTimeout = connectTimeout;, +        TimeValue finalReadTimeout = readTimeout;, +        Storage client = SocketAccess.doPrivilegedIOException(() ->, +            storageService.createClient(clientName, application, finalConnectTimeout, finalReadTimeout));, +++ b/plugins/repository-gcs/src/test/java/org/elasticsearch/repositories/gcs/GoogleCloudStorageBlobStoreRepositoryTests.java, +import java.net.SocketPermission;, +import java.security.AccessController;, +            // The actual impl might open a connection. So check we have permission when this call is made., +            AccessController.checkPermission(new SocketPermission("*", "connect"));]
[+++ b/docs/reference/security/securing-communications/configuring-tls-docker.asciidoc, +[role="xpack"], +[[configuring-tls-docker]], +=== Encrypting Communications in an {es} Docker Container, +, +Starting with version 6.0.0, {security} (Gold, Platinum or Enterprise subscriptions) https://www.elastic.co/guide/en/elasticsearch/reference/6.0/breaking-6.0.0-xes.html[requires SSL/TLS], +encryption for the transport networking layer., +, +This section demonstrates an easy path to get started with SSL/TLS for both, +HTTPS and transport using the {es} Docker image. The example uses, +Docker Compose to manage the containers., +, +For further details, please refer to, +{xpack-ref}/encrypting-communications.html[Encrypting Communications] and, +https://www.elastic.co/subscriptions[available subscriptions]., +, +[float], +==== Prepare the environment, +, +<<docker,Install {es} with Docker>>., +, +Inside a new, empty directory, create the following four files:, +, +`instances.yml`:, +["source","yaml"], +----, +instances:, +  - name: es01, +    dns:, +      - es01 <1>, +      - localhost, +    ip:, +      - 127.0.0.1, +, +  - name: es02, +    dns:, +      - es02, +      - localhost, +    ip:, +      - 127.0.0.1, +----, +<1> Allow use of embedded Docker DNS server names., +, +`.env`:, +[source,yaml], +----, +CERTS_DIR=/usr/share/elasticsearch/config/certificates <1>, +ELASTIC_PASSWORD=PleaseChangeMe <2>, +----, +<1> The path, inside the Docker image, where certificates are expected to be found., +<2> Initial password for the `elastic` user., +, +[[getting-starter-tls-create-certs-composefile]], +`create-certs.yml`:, +ifeval::["{release-state}"=="unreleased"], +, +WARNING: Version {version} of {es} has not yet been released, so a, +`create-certs.yml` is not available for this version., +, +endif::[], +, +ifeval::["{release-state}"!="unreleased"], +["source","yaml",subs="attributes"], +----, +version: '2.2', +, +services:, +  create_certs:, +    container_name: create_certs, +    image: docker.elastic.co/elasticsearch/elasticsearch-platinum:{version}, +    command: >, +      bash -c ', +        if [[ ! -d config/certificates/certs ]]; then, +          mkdir config/certificates/certs;, +        fi;, +        if [[ ! -f /local/certs/bundle.zip ]]; then, +          bin/elasticsearch-certgen --silent --in config/certificates/instances.yml --out config/certificates/certs/bundle.zip;, +          unzip config/certificates/certs/bundle.zip -d config/certificates/certs; <1>, +        fi;, +        chgrp -R 0 config/certificates/certs, +      ', +    user: $\{UID:-1000\}, +    working_dir: /usr/share/elasticsearch, +    volumes: ['.:/usr/share/elasticsearch/config/certificates'], +----, +, +<1> The new node certificates and CA certificate+key are placed under the local directory `certs`., +endif::[], +, +[[getting-starter-tls-create-docker-compose]], +`docker-compose.yml`:, +ifeval::["{release-state}"=="unreleased"], +, +WARNING: Version {version} of {es} has not yet been released, so a, +`docker-compose.yml` is not available for this version., +, +endif::[], +, +ifeval::["{release-state}"!="unreleased"], +["source","yaml",subs="attributes"]]
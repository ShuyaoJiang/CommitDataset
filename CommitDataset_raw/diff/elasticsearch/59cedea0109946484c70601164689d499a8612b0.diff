[+++ b/src/main/java/org/elasticsearch/cluster/metadata/IndexTemplateMetaData.java, +                        ImmutableSettings.Builder templateSettingsBuilder = ImmutableSettings.settingsBuilder();, +                        for (Map.Entry<String, String> entry : SettingsLoader.Helper.loadNestedFromMap(parser.mapOrdered()).entrySet()) {, +                            if (!entry.getKey().startsWith("index.")) {, +                                templateSettingsBuilder.put("index." + entry.getKey(), entry.getValue());, +                            } else {, +                                templateSettingsBuilder.put(entry.getKey(), entry.getValue());, +                            }, +                        }, +                        builder.settings(templateSettingsBuilder.build());, +++ b/src/main/java/org/elasticsearch/cluster/metadata/IndexTemplateMetaData.java, +                        ImmutableSettings.Builder templateSettingsBuilder = ImmutableSettings.settingsBuilder();, +                        for (Map.Entry<String, String> entry : SettingsLoader.Helper.loadNestedFromMap(parser.mapOrdered()).entrySet()) {, +                            if (!entry.getKey().startsWith("index.")) {, +                                templateSettingsBuilder.put("index." + entry.getKey(), entry.getValue());, +                            } else {, +                                templateSettingsBuilder.put(entry.getKey(), entry.getValue());, +                            }, +                        }, +                        builder.settings(templateSettingsBuilder.build());, +++ b/src/test/java/org/elasticsearch/indices/template/IndexTemplateFileLoadingTests.java, +            // random template, one uses the 'setting.index.number_of_shards', the other 'settings.number_of_shards', +            String template = Streams.copyToStringFromClasspath("/org/elasticsearch/indices/template/template" + randomInt(1) + ".json");, +++ b/src/main/java/org/elasticsearch/cluster/metadata/IndexTemplateMetaData.java, +                        ImmutableSettings.Builder templateSettingsBuilder = ImmutableSettings.settingsBuilder();, +                        for (Map.Entry<String, String> entry : SettingsLoader.Helper.loadNestedFromMap(parser.mapOrdered()).entrySet()) {, +                            if (!entry.getKey().startsWith("index.")) {, +                                templateSettingsBuilder.put("index." + entry.getKey(), entry.getValue());, +                            } else {, +                                templateSettingsBuilder.put(entry.getKey(), entry.getValue());, +                            }, +                        }, +                        builder.settings(templateSettingsBuilder.build());, +++ b/src/test/java/org/elasticsearch/indices/template/IndexTemplateFileLoadingTests.java, +            // random template, one uses the 'setting.index.number_of_shards', the other 'settings.number_of_shards', +            String template = Streams.copyToStringFromClasspath("/org/elasticsearch/indices/template/template" + randomInt(1) + ".json");, +++ /dev/null, +++ b/src/main/java/org/elasticsearch/cluster/metadata/IndexTemplateMetaData.java, +                        ImmutableSettings.Builder templateSettingsBuilder = ImmutableSettings.settingsBuilder();, +                        for (Map.Entry<String, String> entry : SettingsLoader.Helper.loadNestedFromMap(parser.mapOrdered()).entrySet()) {, +                            if (!entry.getKey().startsWith("index.")) {, +                                templateSettingsBuilder.put("index." + entry.getKey(), entry.getValue());, +                            } else {, +                                templateSettingsBuilder.put(entry.getKey(), entry.getValue());, +                            }, +                        }, +                        builder.settings(templateSettingsBuilder.build());, +++ b/src/test/java/org/elasticsearch/indices/template/IndexTemplateFileLoadingTests.java, +            // random template, one uses the 'setting.index.number_of_shards', the other 'settings.number_of_shards', +            String template = Streams.copyToStringFromClasspath("/org/elasticsearch/indices/template/template" + randomInt(1) + ".json");, +++ /dev/null, +++ b/src/test/java/org/elasticsearch/indices/template/template0.json, +{, +    "template" : "foo*",, +    "settings" : {, +        "index.number_of_shards": 10,, +        "index.number_of_replicas": 0, +   }, +}, +++ b/src/main/java/org/elasticsearch/cluster/metadata/IndexTemplateMetaData.java, +                        ImmutableSettings.Builder templateSettingsBuilder = ImmutableSettings.settingsBuilder();, +                        for (Map.Entry<String, String> entry : SettingsLoader.Helper.loadNestedFromMap(parser.mapOrdered()).entrySet()) {, +                            if (!entry.getKey().startsWith("index.")) {, +                                templateSettingsBuilder.put("index." + entry.getKey(), entry.getValue());, +                            } else {, +                                templateSettingsBuilder.put(entry.getKey(), entry.getValue());, +                            }, +                        }, +                        builder.settings(templateSettingsBuilder.build());, +++ b/src/test/java/org/elasticsearch/indices/template/IndexTemplateFileLoadingTests.java, +            // random template, one uses the 'setting.index.number_of_shards', the other 'settings.number_of_shards', +            String template = Streams.copyToStringFromClasspath("/org/elasticsearch/indices/template/template" + randomInt(1) + ".json");, +++ /dev/null, +++ b/src/test/java/org/elasticsearch/indices/template/template0.json, +{, +    "template" : "foo*",, +    "settings" : {, +        "index.number_of_shards": 10,, +        "index.number_of_replicas": 0, +   }, +}, +++ b/src/test/java/org/elasticsearch/indices/template/template1.json, +{, +    "template" : "foo*",, +    "settings" : {, +        "number_of_shards": 10,, +        "number_of_replicas": 0, +    }, +}, +++ b/src/main/java/org/elasticsearch/cluster/metadata/IndexTemplateMetaData.java, +                        ImmutableSettings.Builder templateSettingsBuilder = ImmutableSettings.settingsBuilder();, +                        for (Map.Entry<String, String> entry : SettingsLoader.Helper.loadNestedFromMap(parser.mapOrdered()).entrySet()) {, +                            if (!entry.getKey().startsWith("index.")) {, +                                templateSettingsBuilder.put("index." + entry.getKey(), entry.getValue());, +                            } else {, +                                templateSettingsBuilder.put(entry.getKey(), entry.getValue());, +                            }, +                        }, +                        builder.settings(templateSettingsBuilder.build());, +++ b/src/test/java/org/elasticsearch/indices/template/IndexTemplateFileLoadingTests.java]
[+++ b/client/rest-high-level/src/test/java/org/elasticsearch/client/documentation/SecurityDocumentationIT.java, +            // 27 system roles plus the three we created, +            assertThat(roles.size(), equalTo(30));, +++ b/client/rest-high-level/src/test/java/org/elasticsearch/client/documentation/SecurityDocumentationIT.java, +            // 27 system roles plus the three we created, +            assertThat(roles.size(), equalTo(30));, +++ b/x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/dataframe/action/GetDataFrameTransformsStatsAction.java, +    public static final String NAME = "cluster:monitor/data_frame/stats/get";, +++ b/client/rest-high-level/src/test/java/org/elasticsearch/client/documentation/SecurityDocumentationIT.java, +            // 27 system roles plus the three we created, +            assertThat(roles.size(), equalTo(30));, +++ b/x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/dataframe/action/GetDataFrameTransformsStatsAction.java, +    public static final String NAME = "cluster:monitor/data_frame/stats/get";, +++ b/x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/security/authz/privilege/ClusterPrivilege.java, +    private static final Automaton MONITOR_DATA_FRAME_AUTOMATON = patterns("cluster:monitor/data_frame/*");, +    private static final Automaton MANAGE_DATA_FRAME_AUTOMATON = patterns("cluster:admin/data_frame/*", "cluster:monitor/data_frame/*");, +    public static final ClusterPrivilege MONITOR_DATA_FRAME =, +            new ClusterPrivilege("monitor_data_frame_transforms", MONITOR_DATA_FRAME_AUTOMATON);, +    public static final ClusterPrivilege MANAGE_DATA_FRAME =, +            new ClusterPrivilege("manage_data_frame_transforms", MANAGE_DATA_FRAME_AUTOMATON);, +            .put("monitor_data_frame_transforms", MONITOR_DATA_FRAME), +            .put("manage_data_frame_transforms", MANAGE_DATA_FRAME), +++ b/client/rest-high-level/src/test/java/org/elasticsearch/client/documentation/SecurityDocumentationIT.java, +            // 27 system roles plus the three we created, +            assertThat(roles.size(), equalTo(30));, +++ b/x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/dataframe/action/GetDataFrameTransformsStatsAction.java, +    public static final String NAME = "cluster:monitor/data_frame/stats/get";, +++ b/x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/security/authz/privilege/ClusterPrivilege.java, +    private static final Automaton MONITOR_DATA_FRAME_AUTOMATON = patterns("cluster:monitor/data_frame/*");, +    private static final Automaton MANAGE_DATA_FRAME_AUTOMATON = patterns("cluster:admin/data_frame/*", "cluster:monitor/data_frame/*");, +    public static final ClusterPrivilege MONITOR_DATA_FRAME =, +            new ClusterPrivilege("monitor_data_frame_transforms", MONITOR_DATA_FRAME_AUTOMATON);, +    public static final ClusterPrivilege MANAGE_DATA_FRAME =, +            new ClusterPrivilege("manage_data_frame_transforms", MANAGE_DATA_FRAME_AUTOMATON);, +            .put("monitor_data_frame_transforms", MONITOR_DATA_FRAME), +            .put("manage_data_frame_transforms", MANAGE_DATA_FRAME), +++ b/x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/security/authz/store/ReservedRolesStore.java, +                .put("data_frame_transforms_admin", new RoleDescriptor("data_frame_transforms_admin",, +                        new String[] { "manage_data_frame_transforms" },, +                        null, null, null, null, MetadataUtils.DEFAULT_RESERVED_METADATA, null)), +                .put("data_frame_transforms_user", new RoleDescriptor("data_frame_transforms_user",, +                        new String[] { "monitor_data_frame_transforms" },, +                        null, null, null, null, MetadataUtils.DEFAULT_RESERVED_METADATA, null)), +++ b/client/rest-high-level/src/test/java/org/elasticsearch/client/documentation/SecurityDocumentationIT.java, +            // 27 system roles plus the three we created, +            assertThat(roles.size(), equalTo(30));, +++ b/x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/dataframe/action/GetDataFrameTransformsStatsAction.java, +    public static final String NAME = "cluster:monitor/data_frame/stats/get";, +++ b/x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/security/authz/privilege/ClusterPrivilege.java, +    private static final Automaton MONITOR_DATA_FRAME_AUTOMATON = patterns("cluster:monitor/data_frame/*");, +    private static final Automaton MANAGE_DATA_FRAME_AUTOMATON = patterns("cluster:admin/data_frame/*", "cluster:monitor/data_frame/*");, +    public static final ClusterPrivilege MONITOR_DATA_FRAME =, +            new ClusterPrivilege("monitor_data_frame_transforms", MONITOR_DATA_FRAME_AUTOMATON);, +    public static final ClusterPrivilege MANAGE_DATA_FRAME =, +            new ClusterPrivilege("manage_data_frame_transforms", MANAGE_DATA_FRAME_AUTOMATON);, +            .put("monitor_data_frame_transforms", MONITOR_DATA_FRAME), +            .put("manage_data_frame_transforms", MANAGE_DATA_FRAME), +++ b/x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/security/authz/store/ReservedRolesStore.java, +                .put("data_frame_transforms_admin", new RoleDescriptor("data_frame_transforms_admin",, +                        new String[] { "manage_data_frame_transforms" },, +                        null, null, null, null, MetadataUtils.DEFAULT_RESERVED_METADATA, null)), +                .put("data_frame_transforms_user", new RoleDescriptor("data_frame_transforms_user",, +                        new String[] { "monitor_data_frame_transforms" },, +                        null, null, null, null, MetadataUtils.DEFAULT_RESERVED_METADATA, null)), +++ b/x-pack/plugin/core/src/test/java/org/elasticsearch/xpack/core/security/authz/store/ReservedRolesStoreTests.java, +import org.elasticsearch.xpack.core.dataframe.action.DeleteDataFrameTransformAction;, +import org.elasticsearch.xpack.core.dataframe.action.GetDataFrameTransformsAction;, +import org.elasticsearch.xpack.core.dataframe.action.GetDataFrameTransformsStatsAction;, +import org.elasticsearch.xpack.core.dataframe.action.PreviewDataFrameTransformAction;, +import org.elasticsearch.xpack.core.dataframe.action.PutDataFrameTransformAction;, +import org.elasticsearch.xpack.core.dataframe.action.StartDataFrameTransformAction;, +import org.elasticsearch.xpack.core.dataframe.action.StopDataFrameTransformAction;, +        assertThat(ReservedRolesStore.isReserved("data_frame_transforms_user"), is(true));, +        assertThat(ReservedRolesStore.isReserved("data_frame_transforms_admin"), is(true));, +    public void testDataFrameTransformsAdminRole() {, +        final TransportRequest request = mock(TransportRequest.class);, +, +        RoleDescriptor roleDescriptor = new ReservedRolesStore().roleDescriptor("data_frame_transforms_admin");, +        assertNotNull(roleDescriptor);, +        assertThat(roleDescriptor.getMetadata(), hasEntry("_reserved", true));, +, +        Role role = Role.builder(roleDescriptor, null).build();, +        assertThat(role.cluster().check(DeleteDataFrameTransformAction.NAME, request), is(true));, +        assertThat(role.cluster().check(GetDataFrameTransformsAction.NAME, request), is(true));, +        assertThat(role.cluster().check(GetDataFrameTransformsStatsAction.NAME, request), is(true));, +        assertThat(role.cluster().check(PreviewDataFrameTransformAction.NAME, request), is(true));, +        assertThat(role.cluster().check(PutDataFrameTransformAction.NAME, request), is(true));, +        assertThat(role.cluster().check(StartDataFrameTransformAction.NAME, request), is(true));, +        assertThat(role.cluster().check(StopDataFrameTransformAction.NAME, request), is(true));, +        assertThat(role.runAs().check(randomAlphaOfLengthBetween(1, 30)), is(false));, +, +        assertNoAccessAllowed(role, "foo");, +        assertNoAccessAllowed(role, ".data-frame-internal-1"); // internal use only, +, +        assertNoAccessAllowed(role, RestrictedIndicesNames.RESTRICTED_NAMES);, +    }, +, +    public void testDataFrameTransformsUserRole() {, +        final TransportRequest request = mock(TransportRequest.class);, +]
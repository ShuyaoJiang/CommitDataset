[+++ b/src/test/java/org/elasticsearch/search/basic/SearchWhileCreatingIndexTests.java, +                if (searchResponse.getHits().getTotalHits() != 1) {, +                    refresh();, +                    SearchResponse searchResponseAfterRefresh = client().prepareSearch("test").setPreference(randomAsciiOfLength(5)).setQuery(QueryBuilders.termQuery("field", "test")).execute().actionGet();, +                    logger.info("hits count mismatch on any shard search failed, post explicit refresh hits are {}", searchResponseAfterRefresh.getHits().getTotalHits());, +                    ensureGreen();, +                    SearchResponse searchResponseAfterGreen = client().prepareSearch("test").setPreference(randomAsciiOfLength(5)).setQuery(QueryBuilders.termQuery("field", "test")).execute().actionGet();, +                    logger.info("hits count mismatch on any shard search failed, post explicit wait for green hits are {}", searchResponseAfterGreen.getHits().getTotalHits());, +                    assertHitCount(searchResponse, 1);, +                }]
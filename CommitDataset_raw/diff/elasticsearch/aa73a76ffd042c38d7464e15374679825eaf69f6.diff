[+++ b/core/src/main/java/org/elasticsearch/cluster/service/ClusterService.java, +                entry -> new UpdateTask<>(source, entry.getKey(), config.priority(), executor, safe(entry.getValue(), logger)), +                        logger.trace("will process {}", task);, +                        logger.trace("skipping {}, already processed", task);, +                    "missing task result for " + updateTask;, +            assert batchResult.executionResults.containsKey(updateTask.task) : "missing " + updateTask;, +                                () -> new ParameterizedMessage("cluster state update task {} failed", updateTask), ex);, +        private final ClusterStateTaskExecutor<T> executor;, +        UpdateTask(String source, T task, Priority priority, ClusterStateTaskExecutor<T> executor, ClusterStateTaskListener listener) {, +            super(priority, source);, +        @Override, +        public String toString() {]
[+++ b/docs/reference/indices/segments.asciidoc, +=== Verbose mode, +, +To add additional information that can be used for debugging, use the `verbose` flag., +, +NOTE: The format of additional verbose information is experimental and can change at any time., +, +[source,js], +--------------------------------------------------, +curl -XGET 'http://localhost:9200/test/_segments?verbose=true', +--------------------------------------------------, +, +Response:, +, +[source,js], +--------------------------------------------------, +{, +    ..., +        "_3": {, +            ..., +            "ram_tree": [, +                {, +                    "description": "postings [PerFieldPostings(format=1)]",, +                    "size_in_bytes": 2696,, +                    "children": [, +                        {, +                            "description": "format 'Lucene50_0' ...",, +                            "size_in_bytes": 2608,, +                            "children" :[ ... ], +                        },, +                        ..., +                    ], +                },, +                ..., +                ], +          , +        }, +    ..., +}, +--------------------------------------------------, +++ b/docs/reference/indices/segments.asciidoc, +=== Verbose mode, +, +To add additional information that can be used for debugging, use the `verbose` flag., +, +NOTE: The format of additional verbose information is experimental and can change at any time., +, +[source,js], +--------------------------------------------------, +curl -XGET 'http://localhost:9200/test/_segments?verbose=true', +--------------------------------------------------, +, +Response:, +, +[source,js], +--------------------------------------------------, +{, +    ..., +        "_3": {, +            ..., +            "ram_tree": [, +                {, +                    "description": "postings [PerFieldPostings(format=1)]",, +                    "size_in_bytes": 2696,, +                    "children": [, +                        {, +                            "description": "format 'Lucene50_0' ...",, +                            "size_in_bytes": 2608,, +                            "children" :[ ... ], +                        },, +                        ..., +                    ], +                },, +                ..., +                ], +          , +        }, +    ..., +}, +--------------------------------------------------, +++ b/src/main/java/org/elasticsearch/action/admin/indices/segments/IndicesSegmentResponse.java, +import org.apache.lucene.util.Accountable;, +import org.elasticsearch.common.unit.ByteSizeValue;, +import java.util.Collection;, +import java.util.Iterator;, +                        if (segment.ramTree != null) {, +                            builder.startArray(Fields.RAM_TREE);, +                            for (Accountable child : segment.ramTree.getChildResources()) {, +                                toXContent(builder, child);, +                            }, +                            builder.endArray();, +                        }, +    static void toXContent(XContentBuilder builder, Accountable tree) throws IOException {, +        builder.startObject();, +        builder.field(Fields.DESCRIPTION, tree.toString());, +        builder.byteSizeField(Fields.SIZE_IN_BYTES, Fields.SIZE, new ByteSizeValue(tree.ramBytesUsed()));, +        Collection<Accountable> children = tree.getChildResources();, +        if (children.isEmpty() == false) {, +            builder.startArray(Fields.CHILDREN);, +            for (Accountable child : children) {]
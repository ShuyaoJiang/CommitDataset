[+++ b/src/main/java/org/elasticsearch/index/mapper/FieldMapper.java, +++ b/src/main/java/org/elasticsearch/index/mapper/FieldMapper.java, +++ b/src/main/java/org/elasticsearch/index/mapper/object/ObjectMapper.java, +import org.apache.lucene.util.BytesRef;, +    private final String nestedTypePathAsString;, +    private final BytesRef nestedTypePathAsBytes;, +        this.nestedTypePathAsString = "__" + fullPath;, +        this.nestedTypePathAsBytes = new BytesRef(nestedTypePathAsString);, +        this.nestedTypeFilter = new TermFilter(new Term(TypeFieldMapper.NAME, nestedTypePathAsBytes));, +    public BytesRef nestedTypePathAsBytes() {, +        return nestedTypePathAsBytes;, +    }, +, +    public String nestedTypePathAsString() {, +        return nestedTypePathAsString;, +            nestedDoc.add(new Field(TypeFieldMapper.NAME, nestedTypePathAsString, Field.Store.NO, Field.Index.NOT_ANALYZED));, +++ b/src/main/java/org/elasticsearch/index/mapper/FieldMapper.java, +++ b/src/main/java/org/elasticsearch/index/mapper/object/ObjectMapper.java, +import org.apache.lucene.util.BytesRef;, +    private final String nestedTypePathAsString;, +    private final BytesRef nestedTypePathAsBytes;, +        this.nestedTypePathAsString = "__" + fullPath;, +        this.nestedTypePathAsBytes = new BytesRef(nestedTypePathAsString);, +        this.nestedTypeFilter = new TermFilter(new Term(TypeFieldMapper.NAME, nestedTypePathAsBytes));, +    public BytesRef nestedTypePathAsBytes() {, +        return nestedTypePathAsBytes;, +    }, +, +    public String nestedTypePathAsString() {, +        return nestedTypePathAsString;, +            nestedDoc.add(new Field(TypeFieldMapper.NAME, nestedTypePathAsString, Field.Store.NO, Field.Index.NOT_ANALYZED));, +++ b/src/main/java/org/elasticsearch/index/search/nested/NestedDocsFilter.java, +import org.apache.lucene.util.BytesRef;, +    private final PrefixFilter filter = new PrefixFilter(new Term(TypeFieldMapper.NAME, new BytesRef("__")));, +++ b/src/main/java/org/elasticsearch/index/mapper/FieldMapper.java, +++ b/src/main/java/org/elasticsearch/index/mapper/object/ObjectMapper.java, +import org.apache.lucene.util.BytesRef;, +    private final String nestedTypePathAsString;, +    private final BytesRef nestedTypePathAsBytes;, +        this.nestedTypePathAsString = "__" + fullPath;, +        this.nestedTypePathAsBytes = new BytesRef(nestedTypePathAsString);, +        this.nestedTypeFilter = new TermFilter(new Term(TypeFieldMapper.NAME, nestedTypePathAsBytes));, +    public BytesRef nestedTypePathAsBytes() {, +        return nestedTypePathAsBytes;, +    }, +, +    public String nestedTypePathAsString() {, +        return nestedTypePathAsString;, +            nestedDoc.add(new Field(TypeFieldMapper.NAME, nestedTypePathAsString, Field.Store.NO, Field.Index.NOT_ANALYZED));, +++ b/src/main/java/org/elasticsearch/index/search/nested/NestedDocsFilter.java, +import org.apache.lucene.util.BytesRef;, +    private final PrefixFilter filter = new PrefixFilter(new Term(TypeFieldMapper.NAME, new BytesRef("__")));, +++ b/src/main/java/org/elasticsearch/index/search/nested/NonNestedDocsFilter.java, +import org.apache.lucene.util.BytesRef;, +    private final PrefixFilter filter = new PrefixFilter(new Term(TypeFieldMapper.NAME, new BytesRef("__")));, +++ b/src/main/java/org/elasticsearch/index/mapper/FieldMapper.java, +++ b/src/main/java/org/elasticsearch/index/mapper/object/ObjectMapper.java, +import org.apache.lucene.util.BytesRef;, +    private final String nestedTypePathAsString;, +    private final BytesRef nestedTypePathAsBytes;, +        this.nestedTypePathAsString = "__" + fullPath;, +        this.nestedTypePathAsBytes = new BytesRef(nestedTypePathAsString);, +        this.nestedTypeFilter = new TermFilter(new Term(TypeFieldMapper.NAME, nestedTypePathAsBytes));, +    public BytesRef nestedTypePathAsBytes() {, +        return nestedTypePathAsBytes;, +    }, +, +    public String nestedTypePathAsString() {, +        return nestedTypePathAsString;, +            nestedDoc.add(new Field(TypeFieldMapper.NAME, nestedTypePathAsString, Field.Store.NO, Field.Index.NOT_ANALYZED));, +++ b/src/main/java/org/elasticsearch/index/search/nested/NestedDocsFilter.java, +import org.apache.lucene.util.BytesRef;, +    private final PrefixFilter filter = new PrefixFilter(new Term(TypeFieldMapper.NAME, new BytesRef("__")));, +++ b/src/main/java/org/elasticsearch/index/search/nested/NonNestedDocsFilter.java, +import org.apache.lucene.util.BytesRef;, +    private final PrefixFilter filter = new PrefixFilter(new Term(TypeFieldMapper.NAME, new BytesRef("__")));, +++ b/src/test/java/org/elasticsearch/test/unit/index/mapper/nested/NestedMappingTests.java, +        assertThat(doc.docs().get(0).get(TypeFieldMapper.NAME), equalTo(nested1Mapper.nestedTypePathAsString()));, +        assertThat(doc.docs().get(0).get(TypeFieldMapper.NAME), equalTo(nested1Mapper.nestedTypePathAsString()));, +        assertThat(doc.docs().get(1).get(TypeFieldMapper.NAME), equalTo(nested1Mapper.nestedTypePathAsString()));]
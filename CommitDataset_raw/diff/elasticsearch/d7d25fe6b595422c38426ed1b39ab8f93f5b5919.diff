[+++ b/core/src/main/java/org/elasticsearch/bootstrap/Security.java, +        addPath(policy, environment.scriptsFile(), "read,readlink");, +++ b/core/src/main/java/org/elasticsearch/bootstrap/Security.java, +        addPath(policy, environment.scriptsFile(), "read,readlink");, +++ b/core/src/main/java/org/elasticsearch/env/Environment.java, +    private final Path scriptsFile;, +, +        if (settings.get("path.scripts") != null) {, +            scriptsFile = PathUtils.get(cleanPath(settings.get("path.scripts")));, +        } else {, +            scriptsFile = configFile.resolve("scripts");, +        }, +, +    /**, +     * Location of on-disk scripts, +     */, +    public Path scriptsFile() {, +        return scriptsFile;, +    }, +, +++ b/core/src/main/java/org/elasticsearch/bootstrap/Security.java, +        addPath(policy, environment.scriptsFile(), "read,readlink");, +++ b/core/src/main/java/org/elasticsearch/env/Environment.java, +    private final Path scriptsFile;, +, +        if (settings.get("path.scripts") != null) {, +            scriptsFile = PathUtils.get(cleanPath(settings.get("path.scripts")));, +        } else {, +            scriptsFile = configFile.resolve("scripts");, +        }, +, +    /**, +     * Location of on-disk scripts, +     */, +    public Path scriptsFile() {, +        return scriptsFile;, +    }, +, +++ b/core/src/main/java/org/elasticsearch/plugins/PluginManager.java, +                    addUrl(urls, String.format(Locale.ROOT, "http://download.elastic.co/org.elasticsearch.plugins/%1$s/%1$s-%2$s.zip", repo, version));, +++ b/core/src/main/java/org/elasticsearch/bootstrap/Security.java, +        addPath(policy, environment.scriptsFile(), "read,readlink");, +++ b/core/src/main/java/org/elasticsearch/env/Environment.java, +    private final Path scriptsFile;, +, +        if (settings.get("path.scripts") != null) {, +            scriptsFile = PathUtils.get(cleanPath(settings.get("path.scripts")));, +        } else {, +            scriptsFile = configFile.resolve("scripts");, +        }, +, +    /**, +     * Location of on-disk scripts, +     */, +    public Path scriptsFile() {, +        return scriptsFile;, +    }, +, +++ b/core/src/main/java/org/elasticsearch/plugins/PluginManager.java, +                    addUrl(urls, String.format(Locale.ROOT, "http://download.elastic.co/org.elasticsearch.plugins/%1$s/%1$s-%2$s.zip", repo, version));, +++ b/core/src/main/java/org/elasticsearch/script/ScriptService.java, +        scriptsDirectory = env.scriptsFile();, +++ b/core/src/main/java/org/elasticsearch/bootstrap/Security.java, +        addPath(policy, environment.scriptsFile(), "read,readlink");, +++ b/core/src/main/java/org/elasticsearch/env/Environment.java, +    private final Path scriptsFile;, +, +        if (settings.get("path.scripts") != null) {, +            scriptsFile = PathUtils.get(cleanPath(settings.get("path.scripts")));, +        } else {, +            scriptsFile = configFile.resolve("scripts");, +        }, +, +    /**, +     * Location of on-disk scripts, +     */, +    public Path scriptsFile() {, +        return scriptsFile;, +    }, +, +++ b/core/src/main/java/org/elasticsearch/plugins/PluginManager.java, +                    addUrl(urls, String.format(Locale.ROOT, "http://download.elastic.co/org.elasticsearch.plugins/%1$s/%1$s-%2$s.zip", repo, version));, +++ b/core/src/main/java/org/elasticsearch/script/ScriptService.java, +        scriptsDirectory = env.scriptsFile();, +++ b/core/src/test/java/org/elasticsearch/bootstrap/SecurityTests.java, +        settingsBuilder.put("path.scripts", esHome.resolve("scripts").toString());, +        // scripts file: ro, +        assertExactPermissions(new FilePermission(environment.scriptsFile().toString(), "read,readlink"), permissions);, +++ b/core/src/main/java/org/elasticsearch/bootstrap/Security.java, +        addPath(policy, environment.scriptsFile(), "read,readlink");, +++ b/core/src/main/java/org/elasticsearch/env/Environment.java, +    private final Path scriptsFile;, +, +        if (settings.get("path.scripts") != null) {, +            scriptsFile = PathUtils.get(cleanPath(settings.get("path.scripts")));, +        } else {, +            scriptsFile = configFile.resolve("scripts");, +        }, +, +    /**]
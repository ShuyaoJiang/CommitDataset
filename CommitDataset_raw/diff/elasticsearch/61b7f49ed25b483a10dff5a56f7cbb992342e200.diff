[+++ b/core/src/test/java/org/elasticsearch/index/replication/ESIndexLevelReplicationTestCase.java, +            final Future<Void> recoveryFuture = shards.asyncRecoverReplica(replica,, +                new BiFunction<IndexShard, DiscoveryNode, RecoveryTarget>() {, +        public void failShard(ShardRouting replica, ShardRouting primary, String message, Throwable throwable, Runnable onSuccess,, +                              Consumer<Throwable> onPrimaryDemoted, Consumer<Throwable> onIgnoredFailure) {]
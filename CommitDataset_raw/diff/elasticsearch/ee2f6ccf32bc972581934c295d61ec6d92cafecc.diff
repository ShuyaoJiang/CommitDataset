[+++ b/plugins/repository-azure/src/test/java/org/elasticsearch/repositories/azure/AzureRepositorySettingsTests.java, +import org.elasticsearch.common.settings.Setting;, +, +++ b/plugins/repository-azure/src/test/java/org/elasticsearch/repositories/azure/AzureRepositorySettingsTests.java, +import org.elasticsearch.common.settings.Setting;, +, +++ b/plugins/repository-s3/src/test/java/org/elasticsearch/cloud/aws/AwsS3ServiceImplTests.java, +import org.elasticsearch.common.settings.Setting;, +        assertSettingDeprecationsAndWarnings(new Setting<?>[]{AwsS3Service.KEY_SETTING, AwsS3Service.SECRET_SETTING});, +        assertSettingDeprecationsAndWarnings(new Setting<?>[]{AwsS3Service.CLOUD_S3.KEY_SETTING, AwsS3Service.CLOUD_S3.SECRET_SETTING});, +        assertSettingDeprecationsAndWarnings(new Setting<?>[]{, +                AwsS3Service.CLOUD_S3.SECRET_SETTING});, +        assertSettingDeprecationsAndWarnings(, +                new Setting<?>[]{S3Repository.Repositories.KEY_SETTING, S3Repository.Repositories.SECRET_SETTING});, +        assertSettingDeprecationsAndWarnings(new Setting<?>[]{, +                S3Repository.Repositories.SECRET_SETTING});, +        assertSettingDeprecationsAndWarnings(new Setting<?>[]{, +                S3Repository.Repositories.SECRET_SETTING});, +         assertSettingDeprecationsAndWarnings(, +                 new Setting<?>[]{S3Repository.Repository.KEY_SETTING, S3Repository.Repository.SECRET_SETTING});, +         assertSettingDeprecationsAndWarnings(, +                 new Setting<?>[]{S3Repository.Repository.KEY_SETTING, S3Repository.Repository.SECRET_SETTING});, +         assertSettingDeprecationsAndWarnings(, +                 new Setting<?>[]{S3Repository.Repository.KEY_SETTING, S3Repository.Repository.SECRET_SETTING});, +         assertSettingDeprecationsAndWarnings(new Setting<?>[]{, +                AwsS3Service.READ_TIMEOUT});, +         assertSettingDeprecationsAndWarnings(new Setting<?>[] {, +                AwsS3Service.CLOUD_S3.READ_TIMEOUT});, +         assertSettingDeprecationsAndWarnings(new Setting<?>[]{S3Repository.Repository.ENDPOINT_SETTING});, +         assertSettingDeprecationsAndWarnings(new Setting<?>[]{S3Repository.Repositories.ENDPOINT_SETTING});, +++ b/plugins/repository-azure/src/test/java/org/elasticsearch/repositories/azure/AzureRepositorySettingsTests.java, +import org.elasticsearch.common.settings.Setting;, +, +++ b/plugins/repository-s3/src/test/java/org/elasticsearch/cloud/aws/AwsS3ServiceImplTests.java, +import org.elasticsearch.common.settings.Setting;, +        assertSettingDeprecationsAndWarnings(new Setting<?>[]{AwsS3Service.KEY_SETTING, AwsS3Service.SECRET_SETTING});, +        assertSettingDeprecationsAndWarnings(new Setting<?>[]{AwsS3Service.CLOUD_S3.KEY_SETTING, AwsS3Service.CLOUD_S3.SECRET_SETTING});, +        assertSettingDeprecationsAndWarnings(new Setting<?>[]{, +                AwsS3Service.CLOUD_S3.SECRET_SETTING});, +        assertSettingDeprecationsAndWarnings(, +                new Setting<?>[]{S3Repository.Repositories.KEY_SETTING, S3Repository.Repositories.SECRET_SETTING});, +        assertSettingDeprecationsAndWarnings(new Setting<?>[]{, +                S3Repository.Repositories.SECRET_SETTING});, +        assertSettingDeprecationsAndWarnings(new Setting<?>[]{, +                S3Repository.Repositories.SECRET_SETTING});, +         assertSettingDeprecationsAndWarnings(, +                 new Setting<?>[]{S3Repository.Repository.KEY_SETTING, S3Repository.Repository.SECRET_SETTING});, +         assertSettingDeprecationsAndWarnings(, +                 new Setting<?>[]{S3Repository.Repository.KEY_SETTING, S3Repository.Repository.SECRET_SETTING});, +         assertSettingDeprecationsAndWarnings(, +                 new Setting<?>[]{S3Repository.Repository.KEY_SETTING, S3Repository.Repository.SECRET_SETTING});, +         assertSettingDeprecationsAndWarnings(new Setting<?>[]{, +                AwsS3Service.READ_TIMEOUT});, +         assertSettingDeprecationsAndWarnings(new Setting<?>[] {, +                AwsS3Service.CLOUD_S3.READ_TIMEOUT});, +         assertSettingDeprecationsAndWarnings(new Setting<?>[]{S3Repository.Repository.ENDPOINT_SETTING});, +         assertSettingDeprecationsAndWarnings(new Setting<?>[]{S3Repository.Repositories.ENDPOINT_SETTING});, +++ b/plugins/repository-s3/src/test/java/org/elasticsearch/repositories/s3/S3RepositoryTests.java, +import org.elasticsearch.common.settings.Setting;, +        assertSettingDeprecationsAndWarnings(new Setting<?>[]{Repository.KEY_SETTING, Repositories.KEY_SETTING});, +++ b/plugins/repository-azure/src/test/java/org/elasticsearch/repositories/azure/AzureRepositorySettingsTests.java, +import org.elasticsearch.common.settings.Setting;, +, +++ b/plugins/repository-s3/src/test/java/org/elasticsearch/cloud/aws/AwsS3ServiceImplTests.java, +import org.elasticsearch.common.settings.Setting;, +        assertSettingDeprecationsAndWarnings(new Setting<?>[]{AwsS3Service.KEY_SETTING, AwsS3Service.SECRET_SETTING});, +        assertSettingDeprecationsAndWarnings(new Setting<?>[]{AwsS3Service.CLOUD_S3.KEY_SETTING, AwsS3Service.CLOUD_S3.SECRET_SETTING});, +        assertSettingDeprecationsAndWarnings(new Setting<?>[]{, +                AwsS3Service.CLOUD_S3.SECRET_SETTING});, +        assertSettingDeprecationsAndWarnings(, +                new Setting<?>[]{S3Repository.Repositories.KEY_SETTING, S3Repository.Repositories.SECRET_SETTING});, +        assertSettingDeprecationsAndWarnings(new Setting<?>[]{, +                S3Repository.Repositories.SECRET_SETTING});, +        assertSettingDeprecationsAndWarnings(new Setting<?>[]{, +                S3Repository.Repositories.SECRET_SETTING});, +         assertSettingDeprecationsAndWarnings(, +                 new Setting<?>[]{S3Repository.Repository.KEY_SETTING, S3Repository.Repository.SECRET_SETTING});, +         assertSettingDeprecationsAndWarnings(, +                 new Setting<?>[]{S3Repository.Repository.KEY_SETTING, S3Repository.Repository.SECRET_SETTING});, +         assertSettingDeprecationsAndWarnings(, +                 new Setting<?>[]{S3Repository.Repository.KEY_SETTING, S3Repository.Repository.SECRET_SETTING});, +         assertSettingDeprecationsAndWarnings(new Setting<?>[]{, +                AwsS3Service.READ_TIMEOUT});, +         assertSettingDeprecationsAndWarnings(new Setting<?>[] {, +                AwsS3Service.CLOUD_S3.READ_TIMEOUT});, +         assertSettingDeprecationsAndWarnings(new Setting<?>[]{S3Repository.Repository.ENDPOINT_SETTING});, +         assertSettingDeprecationsAndWarnings(new Setting<?>[]{S3Repository.Repositories.ENDPOINT_SETTING});, +++ b/plugins/repository-s3/src/test/java/org/elasticsearch/repositories/s3/S3RepositoryTests.java, +import org.elasticsearch.common.settings.Setting;, +        assertSettingDeprecationsAndWarnings(new Setting<?>[]{Repository.KEY_SETTING, Repositories.KEY_SETTING});, +++ b/test/framework/src/main/java/org/elasticsearch/test/ESTestCase.java, +import java.util.stream.Stream;, +    /**, +     * Convenience method to assert warnings for settings deprecations and general deprecation warnings., +     *, +     * @param settings the settings that are expected to be deprecated, +     * @param warnings other expected general deprecation warnings, +     */, +    protected final void assertSettingDeprecationsAndWarnings(final Setting<?>[] settings, final String... warnings) {, +                Stream.concat(]
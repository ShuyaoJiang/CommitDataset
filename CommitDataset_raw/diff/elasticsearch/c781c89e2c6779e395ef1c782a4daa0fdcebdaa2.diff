[+++ b/core/src/main/java/org/elasticsearch/index/shard/ShardUtils.java, +                // We need to use FilterLeafReader#getDelegate and not FilterLeafReader#unwrap, because, +                // If there are multiple levels of filtered leaf readers then with the unwrap() method it immediately, +                // returns the most inner leaf reader and thus skipping of over any other filtered leaf reader that, +                // may be instance of ElasticsearchLeafReader. This can cause us to miss the shardId., +                return getElasticsearchLeafReader(((FilterLeafReader) reader).getDelegate());]
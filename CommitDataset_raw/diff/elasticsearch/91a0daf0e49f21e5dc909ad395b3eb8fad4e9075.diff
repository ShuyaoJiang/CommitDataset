[+++ b/Vagrantfile, +, +      # https://github.com/elastic/elasticsearch/issues/30295, +      config.vm.provider 'virtualbox' do |vbox|, +        vbox.customize ['storagectl', :id, '--name', 'SATA Controller', '--hostiocache', 'on'], +      end, +++ b/Vagrantfile, +, +      # https://github.com/elastic/elasticsearch/issues/30295, +      config.vm.provider 'virtualbox' do |vbox|, +        vbox.customize ['storagectl', :id, '--name', 'SATA Controller', '--hostiocache', 'on'], +      end, +++ b/benchmarks/build.gradle, +++ b/Vagrantfile, +, +      # https://github.com/elastic/elasticsearch/issues/30295, +      config.vm.provider 'virtualbox' do |vbox|, +        vbox.customize ['storagectl', :id, '--name', 'SATA Controller', '--hostiocache', 'on'], +      end, +++ b/benchmarks/build.gradle, +++ b/build.gradle, +import com.github.jengelman.gradle.plugins.shadow.ShadowPlugin, +final boolean bwc_tests_enabled = true, +final String bwc_tests_disabled_issue = "" /* place a PR link here when committing bwc changes */, +    "org.elasticsearch:elasticsearch-cli:${version}": ':libs:elasticsearch-cli',, +      Closure depJavadocClosure = { shadowed, dep ->, +        if (dep.group == null || false == dep.group.startsWith('org.elasticsearch')) {, +          return, +        }, +        if (upstreamProject == null) {, +          return, +        }, +        if (shadowed) {, +          /*, +           * Include the source of shadowed upstream projects so we don't, +           * have to publish their javadoc., +           */, +          project.evaluationDependsOn(upstreamProject.path), +          project.javadoc.source += upstreamProject.javadoc.source, +          /*, +           * Do not add those projects to the javadoc classpath because, +           * we are going to resolve them with their source instead., +           */, +          project.javadoc.classpath = project.javadoc.classpath.filter { f ->, +            false == upstreamProject.configurations.archives.artifacts.files.files.contains(f), +          }, +          /*, +           * Instead we need the upstream project's javadoc classpath so, +           * we don't barf on the classes that it references., +           */, +          project.javadoc.classpath += upstreamProject.javadoc.classpath, +        } else {, +          // Link to non-shadowed dependant projects, +      boolean hasShadow = project.plugins.hasPlugin(ShadowPlugin), +      project.configurations.compile.dependencies, +          .findAll(), +          .toSorted(sortClosure), +          .each({ c -> depJavadocClosure(hasShadow, c) }), +      project.configurations.compileOnly.dependencies, +          .findAll(), +          .toSorted(sortClosure), +          .each({ c -> depJavadocClosure(hasShadow, c) }), +      if (hasShadow) {, +        project.configurations.shadow.dependencies, +            .findAll(), +            .toSorted(sortClosure), +            .each({ c -> depJavadocClosure(false, c) }), +      onlyIf {jarTask.enabled}, +      onlyIf {jarTask.enabled}, +      onlyIf {jarTask.enabled}, +  // Having the same group and name for distinct projects causes Gradle to consider them equal when resolving, +  // dependencies leading to hard to debug failures. Run a check across all project to prevent this from happening., +  // see: https://github.com/gradle/gradle/issues/847, +  Map coordsToProject = [:], +  project.allprojects.forEach { p ->, +    String coords = "${p.group}:${p.name}", +    if (false == coordsToProject.putIfAbsent(coords, p)) {, +      throw new GradleException(, +              "Detected that two projects: ${p.path} and ${coordsToProject[coords].path} " +, +                      "have the same name and group: ${coords}. " +, +                      "This doesn't currently work correctly in Gradle, see: " +, +                      "https://github.com/gradle/gradle/issues/847", +      ), +    }, +  }, +      gradleVersion = gradle.getGradleVersion(), +++ b/Vagrantfile, +, +      # https://github.com/elastic/elasticsearch/issues/30295, +      config.vm.provider 'virtualbox' do |vbox|, +        vbox.customize ['storagectl', :id, '--name', 'SATA Controller', '--hostiocache', 'on'], +      end, +++ b/benchmarks/build.gradle, +++ b/build.gradle, +import com.github.jengelman.gradle.plugins.shadow.ShadowPlugin, +final boolean bwc_tests_enabled = true, +final String bwc_tests_disabled_issue = "" /* place a PR link here when committing bwc changes */, +    "org.elasticsearch:elasticsearch-cli:${version}": ':libs:elasticsearch-cli',, +      Closure depJavadocClosure = { shadowed, dep ->, +        if (dep.group == null || false == dep.group.startsWith('org.elasticsearch')) {]
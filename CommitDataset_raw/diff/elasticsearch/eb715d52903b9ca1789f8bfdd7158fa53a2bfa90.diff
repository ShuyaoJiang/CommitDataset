[+++ b/x-pack/plugin/ccr/qa/multi-cluster-with-security/src/test/java/org/elasticsearch/xpack/ccr/FollowIndexSecurityIT.java, +            assertBusy(() -> verifyCcrMonitoring(allowedIndex, allowedIndex));, +    private static void verifyCcrMonitoring(String expectedLeaderIndex, String expectedFollowerIndex) throws IOException {, +            assertThat(leaderIndex, endsWith(expectedLeaderIndex));, +, +            final String followerIndex = (String) XContentMapValues.extractValue("_source.ccr_stats.follower_index", hit);, +            assertThat(followerIndex, equalTo(expectedFollowerIndex));, +++ b/x-pack/plugin/ccr/qa/multi-cluster-with-security/src/test/java/org/elasticsearch/xpack/ccr/FollowIndexSecurityIT.java, +            assertBusy(() -> verifyCcrMonitoring(allowedIndex, allowedIndex));, +    private static void verifyCcrMonitoring(String expectedLeaderIndex, String expectedFollowerIndex) throws IOException {, +            assertThat(leaderIndex, endsWith(expectedLeaderIndex));, +, +            final String followerIndex = (String) XContentMapValues.extractValue("_source.ccr_stats.follower_index", hit);, +            assertThat(followerIndex, equalTo(expectedFollowerIndex));, +++ b/x-pack/plugin/ccr/qa/multi-cluster/src/test/java/org/elasticsearch/xpack/ccr/FollowIndexIT.java, +            assertBusy(() -> verifyCcrMonitoring(leaderIndexName, followIndexName));, +        assertBusy(() -> verifyCcrMonitoring("logs-20190101", "logs-20190101"));, +    private static void verifyCcrMonitoring(final String expectedLeaderIndex, final String expectedFollowerIndex) throws IOException {, +            assertThat(leaderIndex, endsWith(expectedLeaderIndex));, +, +            final String followerIndex = (String) XContentMapValues.extractValue("_source.ccr_stats.follower_index", hit);, +            assertThat(followerIndex, equalTo(expectedFollowerIndex));, +++ b/x-pack/plugin/ccr/qa/multi-cluster-with-security/src/test/java/org/elasticsearch/xpack/ccr/FollowIndexSecurityIT.java, +            assertBusy(() -> verifyCcrMonitoring(allowedIndex, allowedIndex));, +    private static void verifyCcrMonitoring(String expectedLeaderIndex, String expectedFollowerIndex) throws IOException {, +            assertThat(leaderIndex, endsWith(expectedLeaderIndex));, +, +            final String followerIndex = (String) XContentMapValues.extractValue("_source.ccr_stats.follower_index", hit);, +            assertThat(followerIndex, equalTo(expectedFollowerIndex));, +++ b/x-pack/plugin/ccr/qa/multi-cluster/src/test/java/org/elasticsearch/xpack/ccr/FollowIndexIT.java, +            assertBusy(() -> verifyCcrMonitoring(leaderIndexName, followIndexName));, +        assertBusy(() -> verifyCcrMonitoring("logs-20190101", "logs-20190101"));, +    private static void verifyCcrMonitoring(final String expectedLeaderIndex, final String expectedFollowerIndex) throws IOException {, +            assertThat(leaderIndex, endsWith(expectedLeaderIndex));, +, +            final String followerIndex = (String) XContentMapValues.extractValue("_source.ccr_stats.follower_index", hit);, +            assertThat(followerIndex, equalTo(expectedFollowerIndex));, +++ b/x-pack/plugin/ccr/src/main/java/org/elasticsearch/xpack/ccr/action/ShardFollowNodeTask.java, +                params.getFollowShardId().getIndexName(),, +++ b/x-pack/plugin/ccr/qa/multi-cluster-with-security/src/test/java/org/elasticsearch/xpack/ccr/FollowIndexSecurityIT.java, +            assertBusy(() -> verifyCcrMonitoring(allowedIndex, allowedIndex));, +    private static void verifyCcrMonitoring(String expectedLeaderIndex, String expectedFollowerIndex) throws IOException {, +            assertThat(leaderIndex, endsWith(expectedLeaderIndex));, +, +            final String followerIndex = (String) XContentMapValues.extractValue("_source.ccr_stats.follower_index", hit);, +            assertThat(followerIndex, equalTo(expectedFollowerIndex));, +++ b/x-pack/plugin/ccr/qa/multi-cluster/src/test/java/org/elasticsearch/xpack/ccr/FollowIndexIT.java, +            assertBusy(() -> verifyCcrMonitoring(leaderIndexName, followIndexName));, +        assertBusy(() -> verifyCcrMonitoring("logs-20190101", "logs-20190101"));, +    private static void verifyCcrMonitoring(final String expectedLeaderIndex, final String expectedFollowerIndex) throws IOException {, +            assertThat(leaderIndex, endsWith(expectedLeaderIndex));, +, +            final String followerIndex = (String) XContentMapValues.extractValue("_source.ccr_stats.follower_index", hit);, +            assertThat(followerIndex, equalTo(expectedFollowerIndex));, +++ b/x-pack/plugin/ccr/src/main/java/org/elasticsearch/xpack/ccr/action/ShardFollowNodeTask.java, +                params.getFollowShardId().getIndexName(),, +++ b/x-pack/plugin/ccr/src/main/java/org/elasticsearch/xpack/ccr/action/TransportCcrStatsAction.java, +        listener.onResponse(new CcrStatsAction.StatsResponse(task.getStatus()));, +++ b/x-pack/plugin/ccr/qa/multi-cluster-with-security/src/test/java/org/elasticsearch/xpack/ccr/FollowIndexSecurityIT.java, +            assertBusy(() -> verifyCcrMonitoring(allowedIndex, allowedIndex));, +    private static void verifyCcrMonitoring(String expectedLeaderIndex, String expectedFollowerIndex) throws IOException {, +            assertThat(leaderIndex, endsWith(expectedLeaderIndex));, +, +            final String followerIndex = (String) XContentMapValues.extractValue("_source.ccr_stats.follower_index", hit);, +            assertThat(followerIndex, equalTo(expectedFollowerIndex));, +++ b/x-pack/plugin/ccr/qa/multi-cluster/src/test/java/org/elasticsearch/xpack/ccr/FollowIndexIT.java, +            assertBusy(() -> verifyCcrMonitoring(leaderIndexName, followIndexName));, +        assertBusy(() -> verifyCcrMonitoring("logs-20190101", "logs-20190101"));, +    private static void verifyCcrMonitoring(final String expectedLeaderIndex, final String expectedFollowerIndex) throws IOException {, +            assertThat(leaderIndex, endsWith(expectedLeaderIndex));, +, +            final String followerIndex = (String) XContentMapValues.extractValue("_source.ccr_stats.follower_index", hit);, +            assertThat(followerIndex, equalTo(expectedFollowerIndex));, +++ b/x-pack/plugin/ccr/src/main/java/org/elasticsearch/xpack/ccr/action/ShardFollowNodeTask.java, +                params.getFollowShardId().getIndexName(),, +++ b/x-pack/plugin/ccr/src/main/java/org/elasticsearch/xpack/ccr/action/TransportCcrStatsAction.java, +        listener.onResponse(new CcrStatsAction.StatsResponse(task.getStatus()));, +++ b/x-pack/plugin/ccr/src/test/java/org/elasticsearch/xpack/ccr/action/ShardFollowNodeTaskStatusTests.java, +                randomAlphaOfLength(4),, +        assertThat(newInstance.followerIndex(), equalTo(expectedInstance.followerIndex()));, +++ b/x-pack/plugin/ccr/qa/multi-cluster-with-security/src/test/java/org/elasticsearch/xpack/ccr/FollowIndexSecurityIT.java, +            assertBusy(() -> verifyCcrMonitoring(allowedIndex, allowedIndex));, +    private static void verifyCcrMonitoring(String expectedLeaderIndex, String expectedFollowerIndex) throws IOException {, +            assertThat(leaderIndex, endsWith(expectedLeaderIndex));, +, +            final String followerIndex = (String) XContentMapValues.extractValue("_source.ccr_stats.follower_index", hit);, +            assertThat(followerIndex, equalTo(expectedFollowerIndex));, +++ b/x-pack/plugin/ccr/qa/multi-cluster/src/test/java/org/elasticsearch/xpack/ccr/FollowIndexIT.java, +            assertBusy(() -> verifyCcrMonitoring(leaderIndexName, followIndexName));, +        assertBusy(() -> verifyCcrMonitoring("logs-20190101", "logs-20190101"));, +    private static void verifyCcrMonitoring(final String expectedLeaderIndex, final String expectedFollowerIndex) throws IOException {, +            assertThat(leaderIndex, endsWith(expectedLeaderIndex));, +, +            final String followerIndex = (String) XContentMapValues.extractValue("_source.ccr_stats.follower_index", hit);, +            assertThat(followerIndex, equalTo(expectedFollowerIndex));, +++ b/x-pack/plugin/ccr/src/main/java/org/elasticsearch/xpack/ccr/action/ShardFollowNodeTask.java, +                params.getFollowShardId().getIndexName(),, +++ b/x-pack/plugin/ccr/src/main/java/org/elasticsearch/xpack/ccr/action/TransportCcrStatsAction.java, +        listener.onResponse(new CcrStatsAction.StatsResponse(task.getStatus()));, +++ b/x-pack/plugin/ccr/src/test/java/org/elasticsearch/xpack/ccr/action/ShardFollowNodeTaskStatusTests.java]
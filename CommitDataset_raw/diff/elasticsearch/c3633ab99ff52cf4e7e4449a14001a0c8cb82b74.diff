[+++ b/src/main/java/org/elasticsearch/index/shard/service/InternalIndexShard.java, +import org.apache.lucene.index.DirectoryReader;, +    //LUCENE 4 UPGRADE: currently passing 'null' codec to fixIndex, when we have proper support for a codec service, +    // we'll us that to figure out the codec that should be used, +            if (!DirectoryReader.indexExists(store.directory())) {, +                    checkIndex.fixIndex(status, null);]
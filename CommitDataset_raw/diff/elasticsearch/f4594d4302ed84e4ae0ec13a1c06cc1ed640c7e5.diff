[+++ b/core/src/main/java/org/elasticsearch/plugins/RemovePluginCommand.java, +import joptsimple.OptionSet;, +import joptsimple.OptionSpec;, +, +import org.apache.lucene.util.IOUtils;, +import org.elasticsearch.cli.ExitCodes;, +import org.elasticsearch.cli.SettingCommand;, +import org.elasticsearch.cli.Terminal;, +import org.elasticsearch.cli.UserException;, +import org.elasticsearch.common.Strings;, +import org.elasticsearch.common.settings.Settings;, +import org.elasticsearch.env.Environment;, +import org.elasticsearch.node.internal.InternalSettingsPreparer;, +, +                    ExitCodes.CONFIG,, +++ b/core/src/main/java/org/elasticsearch/plugins/RemovePluginCommand.java, +import joptsimple.OptionSet;, +import joptsimple.OptionSpec;, +, +import org.apache.lucene.util.IOUtils;, +import org.elasticsearch.cli.ExitCodes;, +import org.elasticsearch.cli.SettingCommand;, +import org.elasticsearch.cli.Terminal;, +import org.elasticsearch.cli.UserException;, +import org.elasticsearch.common.Strings;, +import org.elasticsearch.common.settings.Settings;, +import org.elasticsearch.env.Environment;, +import org.elasticsearch.node.internal.InternalSettingsPreparer;, +, +                    ExitCodes.CONFIG,, +++ b/qa/evil-tests/src/test/java/org/elasticsearch/plugins/RemovePluginCommandTests.java, +import org.elasticsearch.cli.ExitCodes;, +import java.io.BufferedReader;, +import java.io.StringReader;, +    @Override, +    public void testRemoveUninstalledPluginErrors() throws Exception {, +        UserException e = expectThrows(UserException.class, () -> removePlugin("fake", home));, +        assertEquals(ExitCodes.CONFIG, e.exitCode);, +        assertEquals("plugin fake not found; run 'elasticsearch-plugin list' to get list of installed plugins", e.getMessage());, +, +        MockTerminal terminal = new MockTerminal();, +        new RemovePluginCommand().main(new String[] { "-Epath.home=" + home, "fake" }, terminal);, +        try (BufferedReader reader = new BufferedReader(new StringReader(terminal.getOutput()))) {, +            assertEquals("-> Removing fake...", reader.readLine());, +            assertEquals("ERROR: plugin fake not found; run 'elasticsearch-plugin list' to get list of installed plugins",, +                    reader.readLine());, +            assertNull(reader.readLine());, +        }, +    }, +, +]
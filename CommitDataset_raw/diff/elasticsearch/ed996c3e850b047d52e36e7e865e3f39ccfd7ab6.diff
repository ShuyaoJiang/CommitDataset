[+++ b/modules/elasticsearch/src/main/java/org/elasticsearch/action/admin/cluster/health/TransportClusterHealthAction.java, +import org.elasticsearch.indices.IndexMissingException;, +    @Override protected ClusterHealthResponse masterOperation(ClusterHealthRequest request, ClusterState unusedState) throws ElasticSearchException {, +        int waitFor = 5;, +        if (request.indices().length == 0) { // check that they actually exists in the meta data, +            waitFor--;, +        }, +            ClusterState clusterState = clusterService.state();, +            return clusterHealth(request, clusterState);, +            ClusterState clusterState = clusterService.state();, +            ClusterHealthResponse response = clusterHealth(request, clusterState);, +            if (request.indices().length > 0) {, +                try {, +                    clusterState.metaData().concreteIndices(request.indices());, +                    waitForCounter++;, +                } catch (IndexMissingException e) {, +                    // missing indices, wait a bit more..., +                }, +            }, +    private ClusterHealthResponse clusterHealth(ClusterHealthRequest request, ClusterState clusterState) {, +        for (String index : clusterState.metaData().concreteIndicesIgnoreMissing(request.indices())) {, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/action/admin/cluster/health/TransportClusterHealthAction.java, +import org.elasticsearch.indices.IndexMissingException;, +    @Override protected ClusterHealthResponse masterOperation(ClusterHealthRequest request, ClusterState unusedState) throws ElasticSearchException {, +        int waitFor = 5;, +        if (request.indices().length == 0) { // check that they actually exists in the meta data, +            waitFor--;, +        }, +            ClusterState clusterState = clusterService.state();, +            return clusterHealth(request, clusterState);, +            ClusterState clusterState = clusterService.state();, +            ClusterHealthResponse response = clusterHealth(request, clusterState);, +            if (request.indices().length > 0) {, +                try {, +                    clusterState.metaData().concreteIndices(request.indices());, +                    waitForCounter++;, +                } catch (IndexMissingException e) {, +                    // missing indices, wait a bit more..., +                }, +            }, +    private ClusterHealthResponse clusterHealth(ClusterHealthRequest request, ClusterState clusterState) {, +        for (String index : clusterState.metaData().concreteIndicesIgnoreMissing(request.indices())) {, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/action/admin/cluster/state/TransportClusterStateAction.java, +                String[] indices = currentState.metaData().concreteIndicesIgnoreMissing(request.filteredIndices());, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/action/admin/cluster/health/TransportClusterHealthAction.java, +import org.elasticsearch.indices.IndexMissingException;, +    @Override protected ClusterHealthResponse masterOperation(ClusterHealthRequest request, ClusterState unusedState) throws ElasticSearchException {, +        int waitFor = 5;, +        if (request.indices().length == 0) { // check that they actually exists in the meta data, +            waitFor--;, +        }, +            ClusterState clusterState = clusterService.state();, +            return clusterHealth(request, clusterState);, +            ClusterState clusterState = clusterService.state();, +            ClusterHealthResponse response = clusterHealth(request, clusterState);, +            if (request.indices().length > 0) {, +                try {, +                    clusterState.metaData().concreteIndices(request.indices());, +                    waitForCounter++;, +                } catch (IndexMissingException e) {, +                    // missing indices, wait a bit more..., +                }, +            }, +    private ClusterHealthResponse clusterHealth(ClusterHealthRequest request, ClusterState clusterState) {, +        for (String index : clusterState.metaData().concreteIndicesIgnoreMissing(request.indices())) {, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/action/admin/cluster/state/TransportClusterStateAction.java, +                String[] indices = currentState.metaData().concreteIndicesIgnoreMissing(request.filteredIndices());, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/cluster/metadata/MetaData.java, +    /**, +     * Translates the provided indices (possibly aliased) into actual indices., +     */, +    public String[] concreteIndicesIgnoreMissing(String[] indices) {, +        return concreteIndices(indices, true);, +    }, +, +    /**, +     * Translates the provided indices (possibly aliased) into actual indices., +     */, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/action/admin/cluster/health/TransportClusterHealthAction.java, +import org.elasticsearch.indices.IndexMissingException;, +    @Override protected ClusterHealthResponse masterOperation(ClusterHealthRequest request, ClusterState unusedState) throws ElasticSearchException {, +        int waitFor = 5;, +        if (request.indices().length == 0) { // check that they actually exists in the meta data, +            waitFor--;, +        }, +            ClusterState clusterState = clusterService.state();, +            return clusterHealth(request, clusterState);, +            ClusterState clusterState = clusterService.state();, +            ClusterHealthResponse response = clusterHealth(request, clusterState);, +            if (request.indices().length > 0) {, +                try {, +                    clusterState.metaData().concreteIndices(request.indices());, +                    waitForCounter++;, +                } catch (IndexMissingException e) {, +                    // missing indices, wait a bit more..., +                }, +            }, +    private ClusterHealthResponse clusterHealth(ClusterHealthRequest request, ClusterState clusterState) {, +        for (String index : clusterState.metaData().concreteIndicesIgnoreMissing(request.indices())) {, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/action/admin/cluster/state/TransportClusterStateAction.java]
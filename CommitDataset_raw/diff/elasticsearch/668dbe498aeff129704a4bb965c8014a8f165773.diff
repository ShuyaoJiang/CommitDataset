[+++ b/src/main/java/org/elasticsearch/snapshots/RestoreService.java, +            private Map<ShardId, ShardRestoreStatus> shards = null;, +                            Map<ShardId, ShardRestoreStatus> shards = newHashMap(entry.shards());, +                    for (Map.Entry<ShardId, ShardRestoreStatus> shard : shards.entrySet()) {]
[+++ b/src/main/java/org/elasticsearch/index/search/child/TopChildrenQuery.java, +    private final Query childQuery;, +    public TopChildrenQuery(SearchContext searchContext, Query childQuery, String childType, String parentType, ScoreType scoreType, int factor, int incrementalFactor) {, +        this.childQuery = childQuery;, +        this.childQuery = rewrittenChildQuery;, +            TopDocs topChildDocs = searchContext.searcher().search(childQuery, numChildDocs);, +        Query rewrittenChildQuery = childQuery.rewrite(reader);, +        if (rewrittenChildQuery == childQuery) {, +        childQuery.extractTerms(terms);, +        if (parentDocs == null) {, +        return new ParentWeight(searcher, childQuery.createWeight(searcher));, +        sb.append("score_child[").append(childType).append("/").append(parentType).append("](").append(childQuery.toString(field)).append(')');]
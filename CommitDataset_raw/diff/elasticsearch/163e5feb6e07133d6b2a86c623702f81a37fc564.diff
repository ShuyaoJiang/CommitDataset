[+++ b/elasticsearch/src/main/java/org/elasticsearch/xpack/common/http/HttpRequestTemplate.java, +import org.elasticsearch.script.ScriptService;, +            return body(new TextTemplate(content.string(), content.contentType(), ScriptService.ScriptType.INLINE, null));, +++ b/elasticsearch/src/main/java/org/elasticsearch/xpack/common/http/HttpRequestTemplate.java, +import org.elasticsearch.script.ScriptService;, +            return body(new TextTemplate(content.string(), content.contentType(), ScriptService.ScriptType.INLINE, null));, +++ b/elasticsearch/src/main/java/org/elasticsearch/xpack/common/text/TextTemplate.java, +import org.elasticsearch.script.ScriptService.ScriptType;, +++ b/elasticsearch/src/main/java/org/elasticsearch/xpack/common/http/HttpRequestTemplate.java, +import org.elasticsearch.script.ScriptService;, +            return body(new TextTemplate(content.string(), content.contentType(), ScriptService.ScriptType.INLINE, null));, +++ b/elasticsearch/src/main/java/org/elasticsearch/xpack/common/text/TextTemplate.java, +import org.elasticsearch.script.ScriptService.ScriptType;, +++ b/elasticsearch/src/main/java/org/elasticsearch/xpack/security/authz/store/NativeRolesStore.java, +                        if (e instanceof IndexNotFoundException) { // if the index is not there we just claim the role is not there, +                            logger.warn((Supplier<?>) () -> new ParameterizedMessage("failed to load role [{}] index not available",, +                                    roleId), e);, +                            roleActionListener.onResponse(RoleAndVersion.NON_EXISTENT);, +                        } else {, +                    }, +++ b/elasticsearch/src/main/java/org/elasticsearch/xpack/common/http/HttpRequestTemplate.java, +import org.elasticsearch.script.ScriptService;, +            return body(new TextTemplate(content.string(), content.contentType(), ScriptService.ScriptType.INLINE, null));, +++ b/elasticsearch/src/main/java/org/elasticsearch/xpack/common/text/TextTemplate.java, +import org.elasticsearch.script.ScriptService.ScriptType;, +++ b/elasticsearch/src/main/java/org/elasticsearch/xpack/security/authz/store/NativeRolesStore.java, +                        if (e instanceof IndexNotFoundException) { // if the index is not there we just claim the role is not there, +                            logger.warn((Supplier<?>) () -> new ParameterizedMessage("failed to load role [{}] index not available",, +                                    roleId), e);, +                            roleActionListener.onResponse(RoleAndVersion.NON_EXISTENT);, +                        } else {, +                    }, +++ b/elasticsearch/src/main/java/org/elasticsearch/xpack/watcher/support/search/WatcherSearchTemplateRequest.java, +import org.elasticsearch.script.ScriptService;, +        this.template = new Script(searchSource.utf8ToString(), ScriptService.ScriptType.INLINE, TextTemplate.DEFAULT_TEMPLATE_LANG, null);, +            return new Script(searchSource.utf8ToString(), ScriptService.ScriptType.INLINE, TextTemplate.DEFAULT_TEMPLATE_LANG, null);, +++ b/elasticsearch/src/main/java/org/elasticsearch/xpack/common/http/HttpRequestTemplate.java, +import org.elasticsearch.script.ScriptService;, +            return body(new TextTemplate(content.string(), content.contentType(), ScriptService.ScriptType.INLINE, null));, +++ b/elasticsearch/src/main/java/org/elasticsearch/xpack/common/text/TextTemplate.java, +import org.elasticsearch.script.ScriptService.ScriptType;, +++ b/elasticsearch/src/main/java/org/elasticsearch/xpack/security/authz/store/NativeRolesStore.java, +                        if (e instanceof IndexNotFoundException) { // if the index is not there we just claim the role is not there, +                            logger.warn((Supplier<?>) () -> new ParameterizedMessage("failed to load role [{}] index not available",, +                                    roleId), e);, +                            roleActionListener.onResponse(RoleAndVersion.NON_EXISTENT);, +                        } else {, +                    }, +++ b/elasticsearch/src/main/java/org/elasticsearch/xpack/watcher/support/search/WatcherSearchTemplateRequest.java, +import org.elasticsearch.script.ScriptService;, +        this.template = new Script(searchSource.utf8ToString(), ScriptService.ScriptType.INLINE, TextTemplate.DEFAULT_TEMPLATE_LANG, null);, +            return new Script(searchSource.utf8ToString(), ScriptService.ScriptType.INLINE, TextTemplate.DEFAULT_TEMPLATE_LANG, null);, +++ b/elasticsearch/src/test/java/org/elasticsearch/script/SleepScriptEngine.java, +        return new Script("", ScriptService.ScriptType.INLINE, "sleep", Collections.singletonMap("millis", millis));, +++ b/elasticsearch/src/main/java/org/elasticsearch/xpack/common/http/HttpRequestTemplate.java, +import org.elasticsearch.script.ScriptService;, +            return body(new TextTemplate(content.string(), content.contentType(), ScriptService.ScriptType.INLINE, null));, +++ b/elasticsearch/src/main/java/org/elasticsearch/xpack/common/text/TextTemplate.java, +import org.elasticsearch.script.ScriptService.ScriptType;, +++ b/elasticsearch/src/main/java/org/elasticsearch/xpack/security/authz/store/NativeRolesStore.java, +                        if (e instanceof IndexNotFoundException) { // if the index is not there we just claim the role is not there, +                            logger.warn((Supplier<?>) () -> new ParameterizedMessage("failed to load role [{}] index not available",, +                                    roleId), e);, +                            roleActionListener.onResponse(RoleAndVersion.NON_EXISTENT);, +                        } else {, +                    }, +++ b/elasticsearch/src/main/java/org/elasticsearch/xpack/watcher/support/search/WatcherSearchTemplateRequest.java, +import org.elasticsearch.script.ScriptService;, +        this.template = new Script(searchSource.utf8ToString(), ScriptService.ScriptType.INLINE, TextTemplate.DEFAULT_TEMPLATE_LANG, null);, +            return new Script(searchSource.utf8ToString(), ScriptService.ScriptType.INLINE, TextTemplate.DEFAULT_TEMPLATE_LANG, null);, +++ b/elasticsearch/src/test/java/org/elasticsearch/script/SleepScriptEngine.java, +        return new Script("", ScriptService.ScriptType.INLINE, "sleep", Collections.singletonMap("millis", millis));, +++ b/elasticsearch/src/test/java/org/elasticsearch/xpack/common/text/TextTemplateTests.java, +import org.elasticsearch.script.ScriptService.ScriptType;, +++ b/elasticsearch/src/main/java/org/elasticsearch/xpack/common/http/HttpRequestTemplate.java, +import org.elasticsearch.script.ScriptService;, +            return body(new TextTemplate(content.string(), content.contentType(), ScriptService.ScriptType.INLINE, null));, +++ b/elasticsearch/src/main/java/org/elasticsearch/xpack/common/text/TextTemplate.java, +import org.elasticsearch.script.ScriptService.ScriptType;, +++ b/elasticsearch/src/main/java/org/elasticsearch/xpack/security/authz/store/NativeRolesStore.java, +                        if (e instanceof IndexNotFoundException) { // if the index is not there we just claim the role is not there, +                            logger.warn((Supplier<?>) () -> new ParameterizedMessage("failed to load role [{}] index not available",, +                                    roleId), e);, +                            roleActionListener.onResponse(RoleAndVersion.NON_EXISTENT);, +                        } else {, +                    }, +++ b/elasticsearch/src/main/java/org/elasticsearch/xpack/watcher/support/search/WatcherSearchTemplateRequest.java, +import org.elasticsearch.script.ScriptService;, +        this.template = new Script(searchSource.utf8ToString(), ScriptService.ScriptType.INLINE, TextTemplate.DEFAULT_TEMPLATE_LANG, null);, +            return new Script(searchSource.utf8ToString(), ScriptService.ScriptType.INLINE, TextTemplate.DEFAULT_TEMPLATE_LANG, null);, +++ b/elasticsearch/src/test/java/org/elasticsearch/script/SleepScriptEngine.java, +        return new Script("", ScriptService.ScriptType.INLINE, "sleep", Collections.singletonMap("millis", millis));, +++ b/elasticsearch/src/test/java/org/elasticsearch/xpack/common/text/TextTemplateTests.java, +import org.elasticsearch.script.ScriptService.ScriptType;, +++ b/elasticsearch/src/test/java/org/elasticsearch/xpack/graph/test/GraphTests.java, +import org.elasticsearch.script.ScriptService.ScriptType;, +++ b/elasticsearch/src/main/java/org/elasticsearch/xpack/common/http/HttpRequestTemplate.java, +import org.elasticsearch.script.ScriptService;, +            return body(new TextTemplate(content.string(), content.contentType(), ScriptService.ScriptType.INLINE, null));, +++ b/elasticsearch/src/main/java/org/elasticsearch/xpack/common/text/TextTemplate.java]
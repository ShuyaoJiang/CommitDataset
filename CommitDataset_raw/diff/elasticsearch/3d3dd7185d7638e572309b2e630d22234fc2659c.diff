[+++ b/core/src/main/java/org/elasticsearch/index/fielddata/ScriptDocValues.java, +, +    final class Booleans extends AbstractList<Boolean> implements ScriptDocValues<Boolean> {, +, +        private final SortedNumericDocValues values;, +, +        public Booleans(SortedNumericDocValues values) {, +            this.values = values;, +        }, +, +        @Override, +        public void setNextDocId(int docId) {, +            values.setDocument(docId);, +        }, +, +        @Override, +        public List<Boolean> getValues() {, +            return this;, +        }, +, +        public boolean getValue() {, +            return values.count() != 0 && values.valueAt(0) == 1;, +        }, +, +        @Override, +        public Boolean get(int index) {, +            return values.valueAt(index) == 1;, +        }, +, +        @Override, +        public int size() {, +            return values.count();, +        }, +, +    }, +++ b/core/src/main/java/org/elasticsearch/index/fielddata/ScriptDocValues.java, +, +    final class Booleans extends AbstractList<Boolean> implements ScriptDocValues<Boolean> {, +, +        private final SortedNumericDocValues values;, +, +        public Booleans(SortedNumericDocValues values) {, +            this.values = values;, +        }, +, +        @Override, +        public void setNextDocId(int docId) {, +            values.setDocument(docId);, +        }, +, +        @Override, +        public List<Boolean> getValues() {, +            return this;, +        }, +, +        public boolean getValue() {, +            return values.count() != 0 && values.valueAt(0) == 1;, +        }, +, +        @Override, +        public Boolean get(int index) {, +            return values.valueAt(index) == 1;, +        }, +, +        @Override, +        public int size() {, +            return values.count();, +        }, +, +    }, +++ b/core/src/main/java/org/elasticsearch/index/fielddata/plain/AtomicLongFieldData.java, +    /** True if this numeric data is for a boolean field, and so only has values 0 and 1. */, +    private final boolean isBoolean;, +    AtomicLongFieldData(long ramBytesUsed, boolean isBoolean) {, +        this.isBoolean = isBoolean;, +        if (isBoolean) {, +            return new ScriptDocValues.Booleans(getLongValues());, +        } else {, +    }, +    public void close() {}, +++ b/core/src/main/java/org/elasticsearch/index/fielddata/ScriptDocValues.java, +, +    final class Booleans extends AbstractList<Boolean> implements ScriptDocValues<Boolean> {, +, +        private final SortedNumericDocValues values;, +, +        public Booleans(SortedNumericDocValues values) {, +            this.values = values;, +        }, +, +        @Override, +        public void setNextDocId(int docId) {, +            values.setDocument(docId);, +        }, +, +        @Override, +        public List<Boolean> getValues() {, +            return this;, +        }, +]
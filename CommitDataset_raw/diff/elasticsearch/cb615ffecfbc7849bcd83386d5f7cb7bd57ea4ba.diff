[+++ b/src/test/java/org/elasticsearch/ElasticsearchExceptionTests.java, +            XContentBuilder builder = XContentFactory.jsonBuilder();, +            String expected = "{\"type\":\"search_phase_execution_exception\",\"reason\":\"all shards failed\",\"phase\":\"search\",\"grouped\":true,\"failed_shards\":[{\"shard\":1,\"index\":\"foo\",\"node\":\"node_1\",\"reason\":{\"type\":\"query_parsing_exception\",\"reason\":\"foobar\",\"index\":\"foo\"}}]}";, +            XContentBuilder builder = XContentFactory.jsonBuilder();, +            String expected = "{\"type\":\"search_phase_execution_exception\",\"reason\":\"all shards failed\",\"phase\":\"search\",\"grouped\":true,\"failed_shards\":[{\"shard\":1,\"index\":\"foo\",\"node\":\"node_1\",\"reason\":{\"type\":\"query_parsing_exception\",\"reason\":\"foobar\",\"index\":\"foo\"}},{\"shard\":1,\"index\":\"foo1\",\"node\":\"node_1\",\"reason\":{\"type\":\"query_parsing_exception\",\"reason\":\"foobar\",\"index\":\"foo1\"}}]}";, +            XContentBuilder builder = XContentFactory.jsonBuilder();, +            String expected = "{\"type\":\"exception\",\"reason\":\"foo\",\"caused_by\":{\"type\":\"exception\",\"reason\":\"bar\",\"caused_by\":{\"type\":\"illegal_argument_exception\",\"reason\":\"index is closed\",\"caused_by\":{\"type\":\"runtime_exception\",\"reason\":\"foobar\"}}}}";, +            XContentBuilder builder = XContentFactory.jsonBuilder();, +            String expected = "{\"type\":\"file_not_found_exception\",\"reason\":\"foo not found\"}";, +            XContentBuilder builder = XContentFactory.jsonBuilder();, +            XContentBuilder otherBuilder = XContentFactory.jsonBuilder();, +++ b/src/test/java/org/elasticsearch/ElasticsearchExceptionTests.java, +            XContentBuilder builder = XContentFactory.jsonBuilder();, +            String expected = "{\"type\":\"search_phase_execution_exception\",\"reason\":\"all shards failed\",\"phase\":\"search\",\"grouped\":true,\"failed_shards\":[{\"shard\":1,\"index\":\"foo\",\"node\":\"node_1\",\"reason\":{\"type\":\"query_parsing_exception\",\"reason\":\"foobar\",\"index\":\"foo\"}}]}";, +            XContentBuilder builder = XContentFactory.jsonBuilder();, +            String expected = "{\"type\":\"search_phase_execution_exception\",\"reason\":\"all shards failed\",\"phase\":\"search\",\"grouped\":true,\"failed_shards\":[{\"shard\":1,\"index\":\"foo\",\"node\":\"node_1\",\"reason\":{\"type\":\"query_parsing_exception\",\"reason\":\"foobar\",\"index\":\"foo\"}},{\"shard\":1,\"index\":\"foo1\",\"node\":\"node_1\",\"reason\":{\"type\":\"query_parsing_exception\",\"reason\":\"foobar\",\"index\":\"foo1\"}}]}";, +            XContentBuilder builder = XContentFactory.jsonBuilder();, +            String expected = "{\"type\":\"exception\",\"reason\":\"foo\",\"caused_by\":{\"type\":\"exception\",\"reason\":\"bar\",\"caused_by\":{\"type\":\"illegal_argument_exception\",\"reason\":\"index is closed\",\"caused_by\":{\"type\":\"runtime_exception\",\"reason\":\"foobar\"}}}}";, +            XContentBuilder builder = XContentFactory.jsonBuilder();, +            String expected = "{\"type\":\"file_not_found_exception\",\"reason\":\"foo not found\"}";, +            XContentBuilder builder = XContentFactory.jsonBuilder();, +            XContentBuilder otherBuilder = XContentFactory.jsonBuilder();, +++ b/src/test/java/org/elasticsearch/rest/BytesRestResponseTests.java, +        String expected = "{\"error\":{\"root_cause\":[{\"type\":\"query_parsing_exception\",\"reason\":\"foobar\",\"index\":\"foo\"}],\"type\":\"search_phase_execution_exception\",\"reason\":\"all shards failed\",\"phase\":\"search\",\"grouped\":true,\"failed_shards\":[{\"shard\":1,\"index\":\"foo\",\"node\":\"node_1\",\"reason\":{\"type\":\"query_parsing_exception\",\"reason\":\"foobar\",\"index\":\"foo\"}}]},\"status\":400}";]
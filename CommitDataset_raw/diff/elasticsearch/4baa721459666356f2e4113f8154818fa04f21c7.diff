[+++ b/client/rest-high-level/src/test/java/org/elasticsearch/client/IndexLifecycleIT.java, +++ b/client/rest-high-level/src/test/java/org/elasticsearch/client/IndexLifecycleIT.java, +++ b/x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/indexlifecycle/LifecyclePolicy.java, +                List<Phase> phases = (List<Phase>) a[0];, +                return new LifecyclePolicy(TimeseriesLifecycleType.INSTANCE, name, phaseMap);, +    public LifecyclePolicy(String name, Map<String, Phase> phases) {, +        this(TimeseriesLifecycleType.INSTANCE, name, phases);, +    /**, +     * @param type, +     *            the {@link LifecycleType} of the policy, +     * @param name, +     *            the name of this {@link LifecyclePolicy}, +     * @param phases, +     *            a {@link Map} of {@link Phase}s which make up this, +     *            {@link LifecyclePolicy}., +     */, +    LifecyclePolicy(LifecycleType type, String name, Map<String, Phase> phases) {, +        this.name = name;, +        this.phases = phases;, +        this.type = type;, +        this.type.validate(phases.values());, +    }, +++ b/client/rest-high-level/src/test/java/org/elasticsearch/client/IndexLifecycleIT.java, +++ b/x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/indexlifecycle/LifecyclePolicy.java, +                List<Phase> phases = (List<Phase>) a[0];, +                return new LifecyclePolicy(TimeseriesLifecycleType.INSTANCE, name, phaseMap);, +    public LifecyclePolicy(String name, Map<String, Phase> phases) {, +        this(TimeseriesLifecycleType.INSTANCE, name, phases);, +    /**, +     * @param type, +     *            the {@link LifecycleType} of the policy, +     * @param name, +     *            the name of this {@link LifecyclePolicy}, +     * @param phases, +     *            a {@link Map} of {@link Phase}s which make up this, +     *            {@link LifecyclePolicy}., +     */, +    LifecyclePolicy(LifecycleType type, String name, Map<String, Phase> phases) {, +        this.name = name;, +        this.phases = phases;, +        this.type = type;, +        this.type.validate(phases.values());, +    }, +++ b/x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/indexlifecycle/LifecyclePolicyMetadata.java, +            a -> {, +                LifecyclePolicy policy = (LifecyclePolicy) a[0];, +                return new LifecyclePolicyMetadata(policy, (Map<String, String>) a[1]);, +            });, +        PARSER.declareObject(ConstructingObjectParser.constructorArg(), LifecyclePolicy::parse, POLICY);, +        PARSER.declareField(ConstructingObjectParser.constructorArg(), XContentParser::mapStrings, HEADERS, ValueType.OBJECT);, +++ b/client/rest-high-level/src/test/java/org/elasticsearch/client/IndexLifecycleIT.java, +++ b/x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/indexlifecycle/LifecyclePolicy.java, +                List<Phase> phases = (List<Phase>) a[0];, +                return new LifecyclePolicy(TimeseriesLifecycleType.INSTANCE, name, phaseMap);, +    public LifecyclePolicy(String name, Map<String, Phase> phases) {, +        this(TimeseriesLifecycleType.INSTANCE, name, phases);, +    /**, +     * @param type, +     *            the {@link LifecycleType} of the policy, +     * @param name, +     *            the name of this {@link LifecyclePolicy}, +     * @param phases, +     *            a {@link Map} of {@link Phase}s which make up this, +     *            {@link LifecyclePolicy}., +     */, +    LifecyclePolicy(LifecycleType type, String name, Map<String, Phase> phases) {, +        this.name = name;, +        this.phases = phases;, +        this.type = type;, +        this.type.validate(phases.values());, +    }, +++ b/x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/indexlifecycle/LifecyclePolicyMetadata.java, +            a -> {, +                LifecyclePolicy policy = (LifecyclePolicy) a[0];, +                return new LifecyclePolicyMetadata(policy, (Map<String, String>) a[1]);, +            });, +        PARSER.declareObject(ConstructingObjectParser.constructorArg(), LifecyclePolicy::parse, POLICY);, +        PARSER.declareField(ConstructingObjectParser.constructorArg(), XContentParser::mapStrings, HEADERS, ValueType.OBJECT);, +++ b/x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/indexlifecycle/action/PutLifecycleAction.java, +            PARSER.declareObject(ConstructingObjectParser.constructorArg(), LifecyclePolicy::parse, POLICY_FIELD);, +++ b/client/rest-high-level/src/test/java/org/elasticsearch/client/IndexLifecycleIT.java, +++ b/x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/indexlifecycle/LifecyclePolicy.java, +                List<Phase> phases = (List<Phase>) a[0];, +                return new LifecyclePolicy(TimeseriesLifecycleType.INSTANCE, name, phaseMap);, +    public LifecyclePolicy(String name, Map<String, Phase> phases) {, +        this(TimeseriesLifecycleType.INSTANCE, name, phases);, +    /**, +     * @param type, +     *            the {@link LifecycleType} of the policy, +     * @param name, +     *            the name of this {@link LifecyclePolicy}, +     * @param phases, +     *            a {@link Map} of {@link Phase}s which make up this, +     *            {@link LifecyclePolicy}., +     */, +    LifecyclePolicy(LifecycleType type, String name, Map<String, Phase> phases) {, +        this.name = name;, +        this.phases = phases;, +        this.type = type;, +        this.type.validate(phases.values());]
[+++ b/core/src/main/java/org/elasticsearch/bootstrap/JNANatives.java, +        logger.warn("Unable to lock JVM Memory: error=" + errno + ",reason=" + errMsg + ". This can result in part of the JVM being swapped out.");, +                                "\t# allow user 'esuser' mlockall\n" +, +                                "\tesuser soft memlock unlimited\n" +, +                                "\tesuser hard memlock unlimited", +++ b/core/src/main/java/org/elasticsearch/bootstrap/JNANatives.java, +        logger.warn("Unable to lock JVM Memory: error=" + errno + ",reason=" + errMsg + ". This can result in part of the JVM being swapped out.");, +                                "\t# allow user 'esuser' mlockall\n" +, +                                "\tesuser soft memlock unlimited\n" +, +                                "\tesuser hard memlock unlimited", +++ b/core/src/main/java/org/elasticsearch/gateway/MetaDataStateFormat.java, +import java.nio.file.DirectoryStream;, +import java.nio.file.Files;, +import java.nio.file.Path;, +import java.nio.file.StandardCopyOption;, +                if (!Files.isDirectory(stateDir)) {, +                    continue;, +                }, +++ b/core/src/main/java/org/elasticsearch/bootstrap/JNANatives.java, +        logger.warn("Unable to lock JVM Memory: error=" + errno + ",reason=" + errMsg + ". This can result in part of the JVM being swapped out.");, +                                "\t# allow user 'esuser' mlockall\n" +, +                                "\tesuser soft memlock unlimited\n" +, +                                "\tesuser hard memlock unlimited", +++ b/core/src/main/java/org/elasticsearch/gateway/MetaDataStateFormat.java, +import java.nio.file.DirectoryStream;, +import java.nio.file.Files;, +import java.nio.file.Path;, +import java.nio.file.StandardCopyOption;, +                if (!Files.isDirectory(stateDir)) {, +                    continue;, +                }, +++ b/core/src/main/java/org/elasticsearch/http/HttpServer.java, +        if (request.rawPath().startsWith("/_plugin/")) {, +++ b/core/src/main/java/org/elasticsearch/bootstrap/JNANatives.java, +        logger.warn("Unable to lock JVM Memory: error=" + errno + ",reason=" + errMsg + ". This can result in part of the JVM being swapped out.");, +                                "\t# allow user 'esuser' mlockall\n" +, +                                "\tesuser soft memlock unlimited\n" +, +                                "\tesuser hard memlock unlimited", +++ b/core/src/main/java/org/elasticsearch/gateway/MetaDataStateFormat.java, +import java.nio.file.DirectoryStream;, +import java.nio.file.Files;, +import java.nio.file.Path;, +import java.nio.file.StandardCopyOption;, +                if (!Files.isDirectory(stateDir)) {, +                    continue;, +                }, +++ b/core/src/main/java/org/elasticsearch/http/HttpServer.java, +        if (request.rawPath().startsWith("/_plugin/")) {, +++ b/core/src/main/java/org/elasticsearch/index/query/MatchQueryBuilder.java, +    private String rewrite = null;, +, +    public MatchQueryBuilder rewrite(String rewrite) {, +        this.rewrite = rewrite;, +        return this;, +    }, +, +        if (rewrite != null) {, +            builder.field("rewrite", rewrite);, +        }, +++ b/core/src/main/java/org/elasticsearch/bootstrap/JNANatives.java, +        logger.warn("Unable to lock JVM Memory: error=" + errno + ",reason=" + errMsg + ". This can result in part of the JVM being swapped out.");, +                                "\t# allow user 'esuser' mlockall\n" +, +                                "\tesuser soft memlock unlimited\n" +, +                                "\tesuser hard memlock unlimited", +++ b/core/src/main/java/org/elasticsearch/gateway/MetaDataStateFormat.java, +import java.nio.file.DirectoryStream;, +import java.nio.file.Files;, +import java.nio.file.Path;, +import java.nio.file.StandardCopyOption;, +                if (!Files.isDirectory(stateDir)) {, +                    continue;, +                }, +++ b/core/src/main/java/org/elasticsearch/http/HttpServer.java, +        if (request.rawPath().startsWith("/_plugin/")) {, +++ b/core/src/main/java/org/elasticsearch/index/query/MatchQueryBuilder.java, +    private String rewrite = null;, +, +    public MatchQueryBuilder rewrite(String rewrite) {, +        this.rewrite = rewrite;, +        return this;, +    }, +, +        if (rewrite != null) {, +            builder.field("rewrite", rewrite);, +        }, +++ b/core/src/main/java/org/elasticsearch/index/query/MultiMatchQueryBuilder.java, +    private String rewrite = null;, +, +    public MultiMatchQueryBuilder rewrite(String rewrite) {, +        this.rewrite = rewrite;, +        return this;, +    }, +, +        if (rewrite != null) {, +            builder.field("rewrite", rewrite);, +        }, +++ b/core/src/main/java/org/elasticsearch/bootstrap/JNANatives.java, +        logger.warn("Unable to lock JVM Memory: error=" + errno + ",reason=" + errMsg + ". This can result in part of the JVM being swapped out.");, +                                "\t# allow user 'esuser' mlockall\n" +, +                                "\tesuser soft memlock unlimited\n" +]
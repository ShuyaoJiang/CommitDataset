[+++ b/docs/reference/migration/migrate_5_0.asciidoc, +[IMPORTANT], +.Known networking bug in 5.0.0-alpha5, +======================================================, +, +There is a major bug in the new Netty4 implementation in this release which, +affects any REST requests greater than 1024 bytes in size, and which will, +generate an exception similar to the following:, +, +[source,txt], +----, +[WARN ][http.netty4] [wtOV9Vb] caught exception while handling client http traffic, closing connection [id: 0x1320b717, L:/0:0:0:0:0:0:0:1:9200 - R:/0:0:0:0:0:0:0:1:54732], +java.lang.UnsupportedOperationException: unsupported message type: DefaultFullHttpResponse (expected: ByteBuf, FileRegion), +----, +, +This is due to incorrect handling of the `Expect` HTTP header, and it can be, +worked around in one of three ways:, +, +* Use a client which does not add `Expect` headers (including the official clients)., +, +* Pass a blank `Except` header, e.g., ++, +[source,sh], +----, +curl -H 'Expect:' ..., +----, +, +* Use Netty3 for the HTTP layer by passing the following setting at startup:, ++, +[source,sh], +----, +./bin/elasticsearch -Ehttp.type=netty3, +----, +, +======================================================, +, +++ b/docs/reference/migration/migrate_5_0.asciidoc, +[IMPORTANT], +.Known networking bug in 5.0.0-alpha5, +======================================================, +, +There is a major bug in the new Netty4 implementation in this release which, +affects any REST requests greater than 1024 bytes in size, and which will, +generate an exception similar to the following:, +, +[source,txt], +----, +[WARN ][http.netty4] [wtOV9Vb] caught exception while handling client http traffic, closing connection [id: 0x1320b717, L:/0:0:0:0:0:0:0:1:9200 - R:/0:0:0:0:0:0:0:1:54732], +java.lang.UnsupportedOperationException: unsupported message type: DefaultFullHttpResponse (expected: ByteBuf, FileRegion), +----, +, +This is due to incorrect handling of the `Expect` HTTP header, and it can be, +worked around in one of three ways:, +, +* Use a client which does not add `Expect` headers (including the official clients)., +, +* Pass a blank `Except` header, e.g., ++, +[source,sh], +----, +curl -H 'Expect:' ..., +----, +, +* Use Netty3 for the HTTP layer by passing the following setting at startup:, ++, +[source,sh], +----, +./bin/elasticsearch -Ehttp.type=netty3, +----, +, +======================================================, +, +++ b/docs/reference/release-notes/5.0.0-alpha5.asciidoc, +[IMPORTANT], +.Known networking bug in 5.0.0-alpha5, +======================================================, +, +There is a major bug in the new Netty4 implementation in this release which, +affects any REST requests greater than 1024 bytes in size, and which will, +generate an exception similar to the following:, +, +[source,txt], +----, +[WARN ][http.netty4] [wtOV9Vb] caught exception while handling client http traffic, closing connection [id: 0x1320b717, L:/0:0:0:0:0:0:0:1:9200 - R:/0:0:0:0:0:0:0:1:54732], +java.lang.UnsupportedOperationException: unsupported message type: DefaultFullHttpResponse (expected: ByteBuf, FileRegion), +----, +, +This is due to incorrect handling of the `Expect` HTTP header, and it can be, +worked around in one of three ways:, +, +* Use a client which does not add `Expect` headers (including the official clients)., +, +* Pass a blank `Except` header, e.g., ++, +[source,sh], +----, +curl -H 'Expect:' ..., +----, +, +* Use Netty3 for the HTTP layer by passing the following setting at startup:]
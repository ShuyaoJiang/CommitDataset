[+++ b/core/src/main/java/org/elasticsearch/action/admin/indices/rollover/TransportRolloverAction.java, +            return String.join("-", sourceIndexName.substring(0, numberIndex), String.valueOf(++counter));, +++ b/core/src/main/java/org/elasticsearch/action/admin/indices/rollover/TransportRolloverAction.java, +            return String.join("-", sourceIndexName.substring(0, numberIndex), String.valueOf(++counter));, +++ b/core/src/main/java/org/elasticsearch/action/ingest/WriteableIngestDocument.java, +        Map<String, Object> ingestMetadata = in.readMap();, +        out.writeMap(ingestDocument.getIngestMetadata());, +        builder.field("_ingest", ingestDocument.getIngestMetadata());, +++ b/core/src/main/java/org/elasticsearch/action/admin/indices/rollover/TransportRolloverAction.java, +            return String.join("-", sourceIndexName.substring(0, numberIndex), String.valueOf(++counter));, +++ b/core/src/main/java/org/elasticsearch/action/ingest/WriteableIngestDocument.java, +        Map<String, Object> ingestMetadata = in.readMap();, +        out.writeMap(ingestDocument.getIngestMetadata());, +        builder.field("_ingest", ingestDocument.getIngestMetadata());, +++ b/core/src/main/java/org/elasticsearch/cluster/metadata/MetaDataCreateIndexService.java, +                        if (shardsAcked == false) {, +                        }, +++ b/core/src/main/java/org/elasticsearch/action/admin/indices/rollover/TransportRolloverAction.java, +            return String.join("-", sourceIndexName.substring(0, numberIndex), String.valueOf(++counter));, +++ b/core/src/main/java/org/elasticsearch/action/ingest/WriteableIngestDocument.java, +        Map<String, Object> ingestMetadata = in.readMap();, +        out.writeMap(ingestDocument.getIngestMetadata());, +        builder.field("_ingest", ingestDocument.getIngestMetadata());, +++ b/core/src/main/java/org/elasticsearch/cluster/metadata/MetaDataCreateIndexService.java, +                        if (shardsAcked == false) {, +                        }, +++ b/core/src/main/java/org/elasticsearch/ingest/CompoundProcessor.java, +        Map<String, Object> ingestMetadata = ingestDocument.getIngestMetadata();, +        Map<String, Object> ingestMetadata = ingestDocument.getIngestMetadata();, +++ b/core/src/main/java/org/elasticsearch/action/admin/indices/rollover/TransportRolloverAction.java, +            return String.join("-", sourceIndexName.substring(0, numberIndex), String.valueOf(++counter));, +++ b/core/src/main/java/org/elasticsearch/action/ingest/WriteableIngestDocument.java, +        Map<String, Object> ingestMetadata = in.readMap();, +        out.writeMap(ingestDocument.getIngestMetadata());, +        builder.field("_ingest", ingestDocument.getIngestMetadata());, +++ b/core/src/main/java/org/elasticsearch/cluster/metadata/MetaDataCreateIndexService.java, +                        if (shardsAcked == false) {, +                        }, +++ b/core/src/main/java/org/elasticsearch/ingest/CompoundProcessor.java, +        Map<String, Object> ingestMetadata = ingestDocument.getIngestMetadata();, +        Map<String, Object> ingestMetadata = ingestDocument.getIngestMetadata();, +++ b/core/src/main/java/org/elasticsearch/ingest/IngestDocument.java, +    private final Map<String, Object> ingestMetadata;, +    public IngestDocument(Map<String, Object> sourceAndMetadata, Map<String, Object> ingestMetadata) {, +    public Map<String, Object> getIngestMetadata() {, +++ b/core/src/main/java/org/elasticsearch/action/admin/indices/rollover/TransportRolloverAction.java, +            return String.join("-", sourceIndexName.substring(0, numberIndex), String.valueOf(++counter));, +++ b/core/src/main/java/org/elasticsearch/action/ingest/WriteableIngestDocument.java, +        Map<String, Object> ingestMetadata = in.readMap();, +        out.writeMap(ingestDocument.getIngestMetadata());, +        builder.field("_ingest", ingestDocument.getIngestMetadata());, +++ b/core/src/main/java/org/elasticsearch/cluster/metadata/MetaDataCreateIndexService.java, +                        if (shardsAcked == false) {, +                        }, +++ b/core/src/main/java/org/elasticsearch/ingest/CompoundProcessor.java, +        Map<String, Object> ingestMetadata = ingestDocument.getIngestMetadata();, +        Map<String, Object> ingestMetadata = ingestDocument.getIngestMetadata();, +++ b/core/src/main/java/org/elasticsearch/ingest/IngestDocument.java, +    private final Map<String, Object> ingestMetadata;, +    public IngestDocument(Map<String, Object> sourceAndMetadata, Map<String, Object> ingestMetadata) {, +    public Map<String, Object> getIngestMetadata() {, +++ b/core/src/test/java/org/elasticsearch/action/admin/indices/rollover/RolloverIT.java, +        assertThat(response.getNewIndex(), equalTo("test_index-2"));, +        final IndexMetaData newIndex = state.metaData().index("test_index-2");, +        assertThat(response.getNewIndex(), equalTo("test_index-3"));, +        final IndexMetaData newIndex = state.metaData().index("test_index-3");, +        assertThat(response.getNewIndex(), equalTo("test_index-3"));, +        final IndexMetaData newIndex = state.metaData().index("test_index-3");, +        assertThat(response.getNewIndex(), equalTo("test_index-2"));, +        final IndexMetaData newIndex = state.metaData().index("test_index-2");, +        final IndexMetaData newIndex = state.metaData().index("test_index-1");, +        assertAcked(prepareCreate("test_index-1").get());, +        index("test_index-1", "type1", "1", "field", "value");, +        flush("test_index-0", "test_index-1");, +            assertThat(e.getIndex().getName(), equalTo("test_index-1"));, +++ b/core/src/main/java/org/elasticsearch/action/admin/indices/rollover/TransportRolloverAction.java, +            return String.join("-", sourceIndexName.substring(0, numberIndex), String.valueOf(++counter));, +++ b/core/src/main/java/org/elasticsearch/action/ingest/WriteableIngestDocument.java, +        Map<String, Object> ingestMetadata = in.readMap();, +        out.writeMap(ingestDocument.getIngestMetadata());, +        builder.field("_ingest", ingestDocument.getIngestMetadata());, +++ b/core/src/main/java/org/elasticsearch/cluster/metadata/MetaDataCreateIndexService.java, +                        if (shardsAcked == false) {, +                        }, +++ b/core/src/main/java/org/elasticsearch/ingest/CompoundProcessor.java, +        Map<String, Object> ingestMetadata = ingestDocument.getIngestMetadata();, +        Map<String, Object> ingestMetadata = ingestDocument.getIngestMetadata();, +++ b/core/src/main/java/org/elasticsearch/ingest/IngestDocument.java, +    private final Map<String, Object> ingestMetadata;, +    public IngestDocument(Map<String, Object> sourceAndMetadata, Map<String, Object> ingestMetadata) {, +    public Map<String, Object> getIngestMetadata() {, +++ b/core/src/test/java/org/elasticsearch/action/admin/indices/rollover/RolloverIT.java, +        assertThat(response.getNewIndex(), equalTo("test_index-2"));, +        final IndexMetaData newIndex = state.metaData().index("test_index-2");, +        assertThat(response.getNewIndex(), equalTo("test_index-3"));, +        final IndexMetaData newIndex = state.metaData().index("test_index-3");, +        assertThat(response.getNewIndex(), equalTo("test_index-3"));, +        final IndexMetaData newIndex = state.metaData().index("test_index-3");, +        assertThat(response.getNewIndex(), equalTo("test_index-2"));, +        final IndexMetaData newIndex = state.metaData().index("test_index-2");]
[+++ b/modules/elasticsearch/src/main/java/org/elasticsearch/transport/netty/NettyTransport.java, +        final CountDownLatch latch = new CountDownLatch(1);, +        // make sure we run it on another thread than a possible IO handler thread, +        threadPool.cached().execute(new Runnable() {, +            @Override public void run() {, +                try {, +                    for (Iterator<NodeChannels> it = connectedNodes.values().iterator(); it.hasNext();) {, +                        NodeChannels nodeChannels = it.next();, +                        it.remove();, +                        nodeChannels.close();, +                    }, +, +                        clientBootstrap = null;, +                    }, +]
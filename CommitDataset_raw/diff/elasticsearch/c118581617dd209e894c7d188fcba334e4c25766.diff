[+++ b/x-pack/plugin/core/src/test/java/org/elasticsearch/protocol/xpack/graph/GraphExploreResponseTests.java, +import java.util.Arrays;, +import java.util.Comparator;, +        Comparator<Connection> connComparator = new Comparator<Connection>() {, +            @Override, +            public int compare(Connection o1, Connection o2) {, +                return o1.getId().toString().compareTo(o2.getId().toString());, +            }, +        };, +        Arrays.sort(newConns, connComparator);, +        Arrays.sort(expectedConns, connComparator);, +        //Sort the vertices lists before equality test (map insertion sequences can cause order differences), +        Comparator<Vertex> comparator = new Comparator<Vertex>() {, +            @Override, +            public int compare(Vertex o1, Vertex o2) {, +                return o1.getId().toString().compareTo(o2.getId().toString());, +            }, +        };, +        Arrays.sort(newVertices, comparator);, +        Arrays.sort(expectedVertices, comparator);, +++ b/x-pack/plugin/core/src/test/java/org/elasticsearch/protocol/xpack/graph/GraphExploreResponseTests.java, +import java.util.Arrays;, +import java.util.Comparator;, +        Comparator<Connection> connComparator = new Comparator<Connection>() {, +            @Override, +            public int compare(Connection o1, Connection o2) {, +                return o1.getId().toString().compareTo(o2.getId().toString());, +            }, +        };, +        Arrays.sort(newConns, connComparator);, +        Arrays.sort(expectedConns, connComparator);, +        //Sort the vertices lists before equality test (map insertion sequences can cause order differences), +        Comparator<Vertex> comparator = new Comparator<Vertex>() {, +            @Override, +            public int compare(Vertex o1, Vertex o2) {, +                return o1.getId().toString().compareTo(o2.getId().toString());, +            }, +        };, +        Arrays.sort(newVertices, comparator);, +        Arrays.sort(expectedVertices, comparator);, +++ b/x-pack/protocol/src/test/java/org/elasticsearch/protocol/xpack/graph/GraphExploreResponseTests.java, +        Comparator<Connection> connComparator = new Comparator<Connection>() {, +            @Override, +            public int compare(Connection o1, Connection o2) {, +                return o1.getId().toString().compareTo(o2.getId().toString());, +            }, +        };, +        Arrays.sort(newConns, connComparator);, +        Arrays.sort(expectedConns, connComparator);]
[+++ b/src/main/java/org/elasticsearch/search/aggregations/bucket/terms/GlobalOrdinalsStringTermsAggregator.java, +    protected final ValuesSource.Bytes.WithOrdinals.FieldData valuesSource;, +    protected BytesValues.WithOrdinals globalValues;, +    protected Ordinals.Docs globalOrdinals;, +            collectExistingBucket(doc, globalOrd);, +        public void setNextReader(AtomicReaderContext reader) {, +            globalValues = valuesSource.globalBytesValues();, +            globalOrdinals = globalValues.ordinals();, +        }, +, +        @Override, +        public void collect(int doc, long owningBucketOrdinal) throws IOException {, +            final int numOrds = globalOrdinals.setDocument(doc);, +            for (int i = 0; i < numOrds; i++) {, +                final long globalOrd = globalOrdinals.nextOrd();, +                long bucketOrd = bucketOrds.add(globalOrd);, +                collectBucket(doc, bucketOrd);, +            }]
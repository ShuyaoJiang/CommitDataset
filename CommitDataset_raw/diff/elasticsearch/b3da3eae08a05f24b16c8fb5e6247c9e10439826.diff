[+++ b/x-pack/plugin/ilm/src/test/java/org/elasticsearch/xpack/indexlifecycle/IndexLifecycleRunnerTests.java, +        long stepTime = randomLong();, +        IndexLifecycleRunner runner = new IndexLifecycleRunner(stepRegistry, clusterService, () -> stepTime);, +        nextStep.setLatch(latch);, +        assertTrue(latch.await(5, TimeUnit.SECONDS));, +        // The cluster state can take a few extra milliseconds to update after the steps are executed, +        assertBusy(() -> assertNotEquals(before, clusterService.state()));, +        LifecycleExecutionState newExecutionState = LifecycleExecutionState, +            .fromIndexMetadata(clusterService.state().metaData().index(indexMetaData.getIndex()));, +        assertThat(newExecutionState.getPhase(), equalTo("phase"));, +        assertThat(newExecutionState.getAction(), equalTo("action"));, +        assertThat(newExecutionState.getStep(), equalTo("next_cluster_state_action_step"));, +        assertThat(newExecutionState.getStepTime(), equalTo(stepTime));, +        assertThat(nextStep.getExecuteCount(), equalTo(1L));]
[+++ b/x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/security/authc/support/TokensInvalidationResult.java, +import org.elasticsearch.Version;, +                                    @Nullable List<ElasticsearchException> errors) {, +        if (in.getVersion().before(Version.V_8_0_0)) {, +            in.readVInt();, +        }, +        return new TokensInvalidationResult(Collections.emptyList(), Collections.emptyList(), Collections.emptyList());, +        if (out.getVersion().before(Version.V_8_0_0)) {, +            out.writeVInt(5);, +        }, +++ b/x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/security/authc/support/TokensInvalidationResult.java, +import org.elasticsearch.Version;, +                                    @Nullable List<ElasticsearchException> errors) {, +        if (in.getVersion().before(Version.V_8_0_0)) {, +            in.readVInt();, +        }, +        return new TokensInvalidationResult(Collections.emptyList(), Collections.emptyList(), Collections.emptyList());, +        if (out.getVersion().before(Version.V_8_0_0)) {, +            out.writeVInt(5);, +        }, +++ b/x-pack/plugin/core/src/main/resources/security-index-template.json, +            "refresh_time": {, +              "type": "date",, +              "format": "epoch_millis", +            },, +            "superseded_by": {, +              "type": "keyword", +            },, +++ b/x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/security/authc/support/TokensInvalidationResult.java, +import org.elasticsearch.Version;, +                                    @Nullable List<ElasticsearchException> errors) {, +        if (in.getVersion().before(Version.V_8_0_0)) {, +            in.readVInt();, +        }, +        return new TokensInvalidationResult(Collections.emptyList(), Collections.emptyList(), Collections.emptyList());, +        if (out.getVersion().before(Version.V_8_0_0)) {, +            out.writeVInt(5);, +        }, +++ b/x-pack/plugin/core/src/main/resources/security-index-template.json, +            "refresh_time": {, +              "type": "date",, +              "format": "epoch_millis", +            },, +            "superseded_by": {, +              "type": "keyword", +            },, +++ b/x-pack/plugin/core/src/test/java/org/elasticsearch/xpack/core/security/action/token/InvalidateTokenResponseTests.java, +                new ElasticsearchException("bar", new IllegalArgumentException("this is an error message2"))));, +            Arrays.asList(generateRandomStringArray(20, 15, false)), Collections.emptyList());, +                new ElasticsearchException("bar", new IllegalArgumentException("this is an error message2"))));, +++ b/x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/security/authc/support/TokensInvalidationResult.java, +import org.elasticsearch.Version;, +                                    @Nullable List<ElasticsearchException> errors) {, +        if (in.getVersion().before(Version.V_8_0_0)) {, +            in.readVInt();, +        }, +        return new TokensInvalidationResult(Collections.emptyList(), Collections.emptyList(), Collections.emptyList());, +        if (out.getVersion().before(Version.V_8_0_0)) {, +            out.writeVInt(5);, +        }, +++ b/x-pack/plugin/core/src/main/resources/security-index-template.json, +            "refresh_time": {, +              "type": "date",, +              "format": "epoch_millis", +            },, +            "superseded_by": {, +              "type": "keyword", +            },, +++ b/x-pack/plugin/core/src/test/java/org/elasticsearch/xpack/core/security/action/token/InvalidateTokenResponseTests.java, +                new ElasticsearchException("bar", new IllegalArgumentException("this is an error message2"))));, +            Arrays.asList(generateRandomStringArray(20, 15, false)), Collections.emptyList());, +                new ElasticsearchException("bar", new IllegalArgumentException("this is an error message2"))));, +++ b/x-pack/plugin/security/src/main/java/org/elasticsearch/xpack/security/action/saml/TransportSamlAuthenticateAction.java, +                            final String tokenString = tokenService.getAccessTokenAsString(tuple.v1());, +++ b/x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/security/authc/support/TokensInvalidationResult.java, +import org.elasticsearch.Version;, +                                    @Nullable List<ElasticsearchException> errors) {, +        if (in.getVersion().before(Version.V_8_0_0)) {, +            in.readVInt();, +        }, +        return new TokensInvalidationResult(Collections.emptyList(), Collections.emptyList(), Collections.emptyList());, +        if (out.getVersion().before(Version.V_8_0_0)) {, +            out.writeVInt(5);, +        }, +++ b/x-pack/plugin/core/src/main/resources/security-index-template.json, +            "refresh_time": {, +              "type": "date",, +              "format": "epoch_millis", +            },, +            "superseded_by": {, +              "type": "keyword", +            },, +++ b/x-pack/plugin/core/src/test/java/org/elasticsearch/xpack/core/security/action/token/InvalidateTokenResponseTests.java, +                new ElasticsearchException("bar", new IllegalArgumentException("this is an error message2"))));, +            Arrays.asList(generateRandomStringArray(20, 15, false)), Collections.emptyList());, +                new ElasticsearchException("bar", new IllegalArgumentException("this is an error message2"))));, +++ b/x-pack/plugin/security/src/main/java/org/elasticsearch/xpack/security/action/saml/TransportSamlAuthenticateAction.java, +                            final String tokenString = tokenService.getAccessTokenAsString(tuple.v1());, +++ b/x-pack/plugin/security/src/main/java/org/elasticsearch/xpack/security/action/token/TransportCreateTokenAction.java, +                final String tokenStr = tokenService.getAccessTokenAsString(tuple.v1());]
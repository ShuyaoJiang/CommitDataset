[+++ b/core/src/main/java/org/elasticsearch/client/transport/TransportClient.java, +        private Settings providedSettings = Settings.EMPTY;, +            this.providedSettings = settings;, +        private PluginsService newPluginService(final Settings settings) {, +            final Settings.Builder settingsBuilder = settingsBuilder(), +                .put(NettyTransport.PING_SCHEDULE, "5s") // enable by default the transport schedule ping interval, +                .put( InternalSettingsPreparer.prepareSettings(settings)), +                .put("network.server", false), +                .put("node.client", true), +                .put(CLIENT_TYPE_SETTING, CLIENT_TYPE);, +            return new PluginsService(settingsBuilder.build(), null, null, pluginClasses);, +        };, +, +            final PluginsService pluginsService = newPluginService(providedSettings);, +            final Settings settings = pluginsService.updatedSettings();, +                modules.add(new SettingsModule(settings, settingsFilter ));, +                modules.add(new NetworkModule(networkService, settings, true, namedWriteableRegistry));, +                modules.add(new ClusterNameModule(settings));, +                modules.add(new CircuitBreakerModule(settings));]
[+++ b/sql/cli/src/main/java/org/elasticsearch/xpack/sql/cli/net/client/HttpClient.java, +import org.elasticsearch.xpack.sql.net.client.JreHttpUrlConnection;, +import org.elasticsearch.xpack.sql.net.client.util.CheckedConsumer;, +import java.io.DataOutput;, +import java.io.IOException;, +    Bytes put(CheckedConsumer<DataOutput, IOException> os) {, +    Bytes put(String path, CheckedConsumer<DataOutput, IOException> os) {, +++ b/sql/cli/src/main/java/org/elasticsearch/xpack/sql/cli/net/client/HttpClient.java, +import org.elasticsearch.xpack.sql.net.client.JreHttpUrlConnection;, +import org.elasticsearch.xpack.sql.net.client.util.CheckedConsumer;, +import java.io.DataOutput;, +import java.io.IOException;, +    Bytes put(CheckedConsumer<DataOutput, IOException> os) {, +    Bytes put(String path, CheckedConsumer<DataOutput, IOException> os) {, +++ b/sql/jdbc/src/main/java/org/elasticsearch/xpack/sql/jdbc/net/client/HttpClient.java, +import org.elasticsearch.xpack.sql.net.client.JreHttpUrlConnection;, +import org.elasticsearch.xpack.sql.net.client.util.CheckedConsumer;, +import java.io.DataOutput;, +import java.io.IOException;, +    BytesArray put(CheckedConsumer<DataOutput, IOException> os) throws SQLException {, +    BytesArray put(String path, CheckedConsumer<DataOutput, IOException> os) throws SQLException { // NOCOMMIT remove path?, +++ b/sql/cli/src/main/java/org/elasticsearch/xpack/sql/cli/net/client/HttpClient.java, +import org.elasticsearch.xpack.sql.net.client.JreHttpUrlConnection;, +import org.elasticsearch.xpack.sql.net.client.util.CheckedConsumer;, +import java.io.DataOutput;, +import java.io.IOException;, +    Bytes put(CheckedConsumer<DataOutput, IOException> os) {, +    Bytes put(String path, CheckedConsumer<DataOutput, IOException> os) {, +++ b/sql/jdbc/src/main/java/org/elasticsearch/xpack/sql/jdbc/net/client/HttpClient.java, +import org.elasticsearch.xpack.sql.net.client.JreHttpUrlConnection;, +import org.elasticsearch.xpack.sql.net.client.util.CheckedConsumer;, +import java.io.DataOutput;, +import java.io.IOException;, +    BytesArray put(CheckedConsumer<DataOutput, IOException> os) throws SQLException {, +    BytesArray put(String path, CheckedConsumer<DataOutput, IOException> os) throws SQLException { // NOCOMMIT remove path?, +++ b/sql/jdbc/src/main/java/org/elasticsearch/xpack/sql/jdbc/util/BytesArray.java, +import java.nio.charset.StandardCharsets;, +        add(string.getBytes(StandardCharsets.UTF_8));, +++ b/sql/cli/src/main/java/org/elasticsearch/xpack/sql/cli/net/client/HttpClient.java, +import org.elasticsearch.xpack.sql.net.client.JreHttpUrlConnection;, +import org.elasticsearch.xpack.sql.net.client.util.CheckedConsumer;, +import java.io.DataOutput;, +import java.io.IOException;, +    Bytes put(CheckedConsumer<DataOutput, IOException> os) {, +    Bytes put(String path, CheckedConsumer<DataOutput, IOException> os) {, +++ b/sql/jdbc/src/main/java/org/elasticsearch/xpack/sql/jdbc/net/client/HttpClient.java, +import org.elasticsearch.xpack.sql.net.client.JreHttpUrlConnection;, +import org.elasticsearch.xpack.sql.net.client.util.CheckedConsumer;, +import java.io.DataOutput;, +import java.io.IOException;, +    BytesArray put(CheckedConsumer<DataOutput, IOException> os) throws SQLException {, +    BytesArray put(String path, CheckedConsumer<DataOutput, IOException> os) throws SQLException { // NOCOMMIT remove path?, +++ b/sql/jdbc/src/main/java/org/elasticsearch/xpack/sql/jdbc/util/BytesArray.java, +import java.nio.charset.StandardCharsets;, +        add(string.getBytes(StandardCharsets.UTF_8));, +++ /dev/null, +++ b/sql/cli/src/main/java/org/elasticsearch/xpack/sql/cli/net/client/HttpClient.java, +import org.elasticsearch.xpack.sql.net.client.JreHttpUrlConnection;, +import org.elasticsearch.xpack.sql.net.client.util.CheckedConsumer;, +import java.io.DataOutput;, +import java.io.IOException;, +    Bytes put(CheckedConsumer<DataOutput, IOException> os) {, +    Bytes put(String path, CheckedConsumer<DataOutput, IOException> os) {, +++ b/sql/jdbc/src/main/java/org/elasticsearch/xpack/sql/jdbc/net/client/HttpClient.java, +import org.elasticsearch.xpack.sql.net.client.JreHttpUrlConnection;, +import org.elasticsearch.xpack.sql.net.client.util.CheckedConsumer;, +import java.io.DataOutput;, +import java.io.IOException;, +    BytesArray put(CheckedConsumer<DataOutput, IOException> os) throws SQLException {, +    BytesArray put(String path, CheckedConsumer<DataOutput, IOException> os) throws SQLException { // NOCOMMIT remove path?, +++ b/sql/jdbc/src/main/java/org/elasticsearch/xpack/sql/jdbc/util/BytesArray.java, +import java.nio.charset.StandardCharsets;, +        add(string.getBytes(StandardCharsets.UTF_8));, +++ /dev/null, +++ b/sql/net-client/src/main/java/org/elasticsearch/xpack/sql/net/client/JreHttpUrlConnection.java, +/*, + * Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one, + * or more contributor license agreements. Licensed under the Elastic License;, + * you may not use this file except in compliance with the Elastic License., + */, +package org.elasticsearch.xpack.sql.net.client;, +, +import org.elasticsearch.xpack.sql.net.client.util.Bytes;, +import org.elasticsearch.xpack.sql.net.client.util.CheckedConsumer;, +import org.elasticsearch.xpack.sql.net.client.util.IOUtils;, +, +import java.io.Closeable;, +import java.io.DataOutput;, +import java.io.DataOutputStream;, +import java.io.IOException;, +import java.io.InputStream;, +import java.io.OutputStream;, +import java.net.HttpURLConnection;, +import java.net.URL;, +import java.util.function.Function;, +import java.util.zip.GZIPInputStream;, +, +public class JreHttpUrlConnection implements Closeable {, +, +    private boolean closed = false;]
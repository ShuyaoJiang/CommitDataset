[+++ b/build.gradle, +    "org.elasticsearch.distribution.integ-test-zip:elasticsearch:${version}": ':distribution:integ-test-zip',, +++ b/build.gradle, +    "org.elasticsearch.distribution.integ-test-zip:elasticsearch:${version}": ':distribution:integ-test-zip',, +++ b/buildSrc/src/main/groovy/org/elasticsearch/gradle/plugin/PluginBuildPlugin.groovy, +import org.gradle.api.file.FileCollection, +, +            if (project.path.startsWith(':modules:')) {, +                project.integTest.clusterConfig.module(project), +                project.tasks.run.clusterConfig.module(project), +            } else {, +                project.integTest.clusterConfig.plugin(name, project.bundlePlugin.outputs.files), +        }, +++ b/build.gradle, +    "org.elasticsearch.distribution.integ-test-zip:elasticsearch:${version}": ':distribution:integ-test-zip',, +++ b/buildSrc/src/main/groovy/org/elasticsearch/gradle/plugin/PluginBuildPlugin.groovy, +import org.gradle.api.file.FileCollection, +, +            if (project.path.startsWith(':modules:')) {, +                project.integTest.clusterConfig.module(project), +                project.tasks.run.clusterConfig.module(project), +            } else {, +                project.integTest.clusterConfig.plugin(name, project.bundlePlugin.outputs.files), +        }, +++ b/buildSrc/src/main/groovy/org/elasticsearch/gradle/precommit/DependencyLicensesTask.groovy, +    private static final String SHA_EXTENSION = '.sha1', +++ b/build.gradle, +    "org.elasticsearch.distribution.integ-test-zip:elasticsearch:${version}": ':distribution:integ-test-zip',, +++ b/buildSrc/src/main/groovy/org/elasticsearch/gradle/plugin/PluginBuildPlugin.groovy, +import org.gradle.api.file.FileCollection, +, +            if (project.path.startsWith(':modules:')) {, +                project.integTest.clusterConfig.module(project), +                project.tasks.run.clusterConfig.module(project), +            } else {, +                project.integTest.clusterConfig.plugin(name, project.bundlePlugin.outputs.files), +        }, +++ b/buildSrc/src/main/groovy/org/elasticsearch/gradle/precommit/DependencyLicensesTask.groovy, +    private static final String SHA_EXTENSION = '.sha1', +++ b/buildSrc/src/main/groovy/org/elasticsearch/gradle/precommit/UpdateShasTask.groovy, +            if (name.endsWith(SHA_EXTENSION)) {, +            File shaFile = new File(parentTask.licensesDir, jarName + SHA_EXTENSION), +++ b/build.gradle, +    "org.elasticsearch.distribution.integ-test-zip:elasticsearch:${version}": ':distribution:integ-test-zip',, +++ b/buildSrc/src/main/groovy/org/elasticsearch/gradle/plugin/PluginBuildPlugin.groovy, +import org.gradle.api.file.FileCollection, +, +            if (project.path.startsWith(':modules:')) {, +                project.integTest.clusterConfig.module(project), +                project.tasks.run.clusterConfig.module(project), +            } else {, +                project.integTest.clusterConfig.plugin(name, project.bundlePlugin.outputs.files), +        }, +++ b/buildSrc/src/main/groovy/org/elasticsearch/gradle/precommit/DependencyLicensesTask.groovy, +    private static final String SHA_EXTENSION = '.sha1', +++ b/buildSrc/src/main/groovy/org/elasticsearch/gradle/precommit/UpdateShasTask.groovy, +            if (name.endsWith(SHA_EXTENSION)) {, +            File shaFile = new File(parentTask.licensesDir, jarName + SHA_EXTENSION), +++ b/buildSrc/src/main/groovy/org/elasticsearch/gradle/test/ClusterConfiguration.groovy, +    String distribution = 'integ-test-zip', +    List<Project> modules = new ArrayList<>(), +, +    /** Add a module to the cluster. The project must be an esplugin and have a single zip default artifact. */, +    @Input, +    void module(Project moduleProject) {, +        modules.add(moduleProject), +    }, +, +++ b/build.gradle, +    "org.elasticsearch.distribution.integ-test-zip:elasticsearch:${version}": ':distribution:integ-test-zip',, +++ b/buildSrc/src/main/groovy/org/elasticsearch/gradle/plugin/PluginBuildPlugin.groovy, +import org.gradle.api.file.FileCollection, +, +            if (project.path.startsWith(':modules:')) {, +                project.integTest.clusterConfig.module(project), +                project.tasks.run.clusterConfig.module(project), +            } else {, +                project.integTest.clusterConfig.plugin(name, project.bundlePlugin.outputs.files), +        }, +++ b/buildSrc/src/main/groovy/org/elasticsearch/gradle/precommit/DependencyLicensesTask.groovy, +    private static final String SHA_EXTENSION = '.sha1', +++ b/buildSrc/src/main/groovy/org/elasticsearch/gradle/precommit/UpdateShasTask.groovy, +            if (name.endsWith(SHA_EXTENSION)) {, +            File shaFile = new File(parentTask.licensesDir, jarName + SHA_EXTENSION), +++ b/buildSrc/src/main/groovy/org/elasticsearch/gradle/test/ClusterConfiguration.groovy, +    String distribution = 'integ-test-zip', +    List<Project> modules = new ArrayList<>(), +, +    /** Add a module to the cluster. The project must be an esplugin and have a single zip default artifact. */, +    @Input, +    void module(Project moduleProject) {, +        modules.add(moduleProject), +    }, +, +++ b/buildSrc/src/main/groovy/org/elasticsearch/gradle/test/ClusterFormationTasks.groovy, +        String packaging = distro, +        if (distro == 'tar') {, +            packaging = 'tar.gz', +        } else if (distro == 'integ-test-zip') {, +            packaging = 'zip']
[+++ b/buildSrc/src/main/resources/checkstyle_suppressions.xml, +++ b/buildSrc/src/main/resources/checkstyle_suppressions.xml, +++ b/docs/plugins/mapper-size.asciidoc, +The value of the `_size` field is accessible in queries, aggregations, scripts,, +and when sorting:, +  },, +  "aggs": {, +    "sizes": {, +      "terms": {, +        "field": "_size", <2>, +        "size": 10, +      }, +    }, +  },, +  "sort": [, +    {, +      "_size": { <3>, +        "order": "desc", +      }, +    }, +  ],, +  "script_fields": {, +    "size": {, +      "script": "doc['_size']"  <4>, +    }, +++ b/buildSrc/src/main/resources/checkstyle_suppressions.xml, +++ b/docs/plugins/mapper-size.asciidoc, +The value of the `_size` field is accessible in queries, aggregations, scripts,, +and when sorting:, +  },, +  "aggs": {, +    "sizes": {, +      "terms": {, +        "field": "_size", <2>, +        "size": 10, +      }, +    }, +  },, +  "sort": [, +    {, +      "_size": { <3>, +        "order": "desc", +      }, +    }, +  ],, +  "script_fields": {, +    "size": {, +      "script": "doc['_size']"  <4>, +    }, +++ b/docs/reference/migration/migrate_5_0/plugins.asciidoc, +, +==== Mapper-Size plugin, +, +The metadata field `_size` is not accessible in aggregations, scripts and when, +sorting for indices created in 2.x even if the index has been upgraded using the <<indices-upgrade,`upgrade`>> API., +If these features are needed in your application it is required to reindex the data with Elasticsearch 5.x., +The easiest way to reindex old indices is to use the `reindex` API, or the reindex UI provided by, +the <<migration-plugin,Migration Plugin>>., +++ b/buildSrc/src/main/resources/checkstyle_suppressions.xml, +++ b/docs/plugins/mapper-size.asciidoc, +The value of the `_size` field is accessible in queries, aggregations, scripts,, +and when sorting:, +  },, +  "aggs": {, +    "sizes": {, +      "terms": {, +        "field": "_size", <2>, +        "size": 10, +      }, +    }, +  },, +  "sort": [, +    {, +      "_size": { <3>, +        "order": "desc", +      }, +    }, +  ],, +  "script_fields": {, +    "size": {, +      "script": "doc['_size']"  <4>, +    }, +++ b/docs/reference/migration/migrate_5_0/plugins.asciidoc, +, +==== Mapper-Size plugin, +, +The metadata field `_size` is not accessible in aggregations, scripts and when, +sorting for indices created in 2.x even if the index has been upgraded using the <<indices-upgrade,`upgrade`>> API., +If these features are needed in your application it is required to reindex the data with Elasticsearch 5.x., +The easiest way to reindex old indices is to use the `reindex` API, or the reindex UI provided by, +the <<migration-plugin,Migration Plugin>>., +++ b/plugins/mapper-size/src/main/java/org/elasticsearch/index/mapper/size/SizeFieldMapper.java, +        public static final MappedFieldType SIZE_FIELD_TYPE =, +            new NumberFieldMapper.NumberFieldType(NumberFieldMapper.NumberType.INTEGER);, +        public static final MappedFieldType LEGACY_SIZE_FIELD_TYPE =, +            LegacyIntegerFieldMapper.Defaults.FIELD_TYPE.clone();, +    private static MappedFieldType defaultFieldType(Version indexCreated) {, +        MappedFieldType defaultFieldType;, +        if (indexCreated.before(Version.V_5_0_0_alpha2)) {, +            defaultFieldType = Defaults.LEGACY_SIZE_FIELD_TYPE.clone();]
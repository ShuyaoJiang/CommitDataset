[+++ b/x-pack/plugin/sql/src/test/java/org/elasticsearch/xpack/sql/TestUtils.java, +import java.time.Clock;, +import java.time.Duration;, +import java.time.ZonedDateTime;, +, +    /**, +     * Returns the current UTC date-time with milliseconds precision., +     * In Java 9+ (as opposed to Java 8) the {@code Clock} implementation uses system's best clock implementation (which could mean, +     * that the precision of the clock can be milliseconds, microseconds or nanoseconds), whereas in Java 8, +     * {@code System.currentTimeMillis()} is always used. To account for these differences, this method defines a new {@code Clock}, +     * which will offer a value for {@code ZonedDateTime.now()} set to always have milliseconds precision., +     * , +     * @return {@link ZonedDateTime} instance for the current date-time with milliseconds precision in UTC, +     */, +    public static final ZonedDateTime now() {, +        return ZonedDateTime.now(Clock.tick(Clock.system(DateUtils.UTC), Duration.ofMillis(1)));, +    }, +++ b/x-pack/plugin/sql/src/test/java/org/elasticsearch/xpack/sql/TestUtils.java, +import java.time.Clock;, +import java.time.Duration;, +import java.time.ZonedDateTime;, +, +    /**, +     * Returns the current UTC date-time with milliseconds precision., +     * In Java 9+ (as opposed to Java 8) the {@code Clock} implementation uses system's best clock implementation (which could mean, +     * that the precision of the clock can be milliseconds, microseconds or nanoseconds), whereas in Java 8, +     * {@code System.currentTimeMillis()} is always used. To account for these differences, this method defines a new {@code Clock}, +     * which will offer a value for {@code ZonedDateTime.now()} set to always have milliseconds precision., +     * , +     * @return {@link ZonedDateTime} instance for the current date-time with milliseconds precision in UTC, +     */, +    public static final ZonedDateTime now() {, +        return ZonedDateTime.now(Clock.tick(Clock.system(DateUtils.UTC), Duration.ofMillis(1)));, +    }, +++ b/x-pack/plugin/sql/src/test/java/org/elasticsearch/xpack/sql/type/DataTypeConversionTests.java, +import org.elasticsearch.xpack.sql.TestUtils;, +        ZonedDateTime dt = TestUtils.now();]
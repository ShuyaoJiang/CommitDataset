[+++ b/core/src/main/java/org/elasticsearch/bootstrap/BootstrapCheck.java, +import java.util.function.Predicate;, +        Predicate<TransportAddress> isLoopbackOrLinkLocalAddress = t -> t.address().getAddress().isLinkLocalAddress(), +            || t.address().getAddress().isLoopbackAddress();, +        return !(Arrays.stream(boundTransportAddress.boundAddresses()).allMatch(isLoopbackOrLinkLocalAddress) &&, +                isLoopbackOrLinkLocalAddress.test(boundTransportAddress.publishAddress()));, +++ b/core/src/main/java/org/elasticsearch/bootstrap/BootstrapCheck.java, +import java.util.function.Predicate;, +        Predicate<TransportAddress> isLoopbackOrLinkLocalAddress = t -> t.address().getAddress().isLinkLocalAddress(), +            || t.address().getAddress().isLoopbackAddress();, +        return !(Arrays.stream(boundTransportAddress.boundAddresses()).allMatch(isLoopbackOrLinkLocalAddress) &&, +                isLoopbackOrLinkLocalAddress.test(boundTransportAddress.publishAddress()));, +++ b/core/src/main/java/org/elasticsearch/cluster/node/DiscoveryNode.java, +        this(nodeName, nodeId, UUIDs.randomBase64UUID(), address.getAddress(), address.getAddress(), address, attributes, roles, version);, +++ b/core/src/main/java/org/elasticsearch/bootstrap/BootstrapCheck.java, +import java.util.function.Predicate;, +        Predicate<TransportAddress> isLoopbackOrLinkLocalAddress = t -> t.address().getAddress().isLinkLocalAddress(), +            || t.address().getAddress().isLoopbackAddress();, +        return !(Arrays.stream(boundTransportAddress.boundAddresses()).allMatch(isLoopbackOrLinkLocalAddress) &&, +                isLoopbackOrLinkLocalAddress.test(boundTransportAddress.publishAddress()));, +++ b/core/src/main/java/org/elasticsearch/cluster/node/DiscoveryNode.java, +        this(nodeName, nodeId, UUIDs.randomBase64UUID(), address.getAddress(), address.getAddress(), address, attributes, roles, version);, +++ b/core/src/main/java/org/elasticsearch/common/transport/TransportAddress.java, +        byte[] bytes = address.getAddress().getAddress();  // 4 bytes (IPv4) or 16 bytes (IPv6), +    /**, +     * Returns a string representation of the enclosed {@link InetSocketAddress}, +     * @see NetworkAddress#format(InetAddress), +     */, +    /**, +     * Returns the addresses port, +     */, +    /**, +     * Returns the enclosed {@link InetSocketAddress}, +     */, +++ b/core/src/main/java/org/elasticsearch/bootstrap/BootstrapCheck.java, +import java.util.function.Predicate;, +        Predicate<TransportAddress> isLoopbackOrLinkLocalAddress = t -> t.address().getAddress().isLinkLocalAddress(), +            || t.address().getAddress().isLoopbackAddress();, +        return !(Arrays.stream(boundTransportAddress.boundAddresses()).allMatch(isLoopbackOrLinkLocalAddress) &&, +                isLoopbackOrLinkLocalAddress.test(boundTransportAddress.publishAddress()));, +++ b/core/src/main/java/org/elasticsearch/cluster/node/DiscoveryNode.java, +        this(nodeName, nodeId, UUIDs.randomBase64UUID(), address.getAddress(), address.getAddress(), address, attributes, roles, version);, +++ b/core/src/main/java/org/elasticsearch/common/transport/TransportAddress.java, +        byte[] bytes = address.getAddress().getAddress();  // 4 bytes (IPv4) or 16 bytes (IPv6), +    /**, +     * Returns a string representation of the enclosed {@link InetSocketAddress}, +     * @see NetworkAddress#format(InetAddress), +     */, +    /**, +     * Returns the addresses port, +     */, +    /**, +     * Returns the enclosed {@link InetSocketAddress}, +     */, +++ b/core/src/test/java/org/elasticsearch/tribe/TribeIT.java, +                hosts.add(address.getAddress() + ":" + address.getPort());, +++ b/core/src/main/java/org/elasticsearch/bootstrap/BootstrapCheck.java, +import java.util.function.Predicate;, +        Predicate<TransportAddress> isLoopbackOrLinkLocalAddress = t -> t.address().getAddress().isLinkLocalAddress(), +            || t.address().getAddress().isLoopbackAddress();, +        return !(Arrays.stream(boundTransportAddress.boundAddresses()).allMatch(isLoopbackOrLinkLocalAddress) &&, +                isLoopbackOrLinkLocalAddress.test(boundTransportAddress.publishAddress()));, +++ b/core/src/main/java/org/elasticsearch/cluster/node/DiscoveryNode.java, +        this(nodeName, nodeId, UUIDs.randomBase64UUID(), address.getAddress(), address.getAddress(), address, attributes, roles, version);, +++ b/core/src/main/java/org/elasticsearch/common/transport/TransportAddress.java, +        byte[] bytes = address.getAddress().getAddress();  // 4 bytes (IPv4) or 16 bytes (IPv6), +    /**, +     * Returns a string representation of the enclosed {@link InetSocketAddress}, +     * @see NetworkAddress#format(InetAddress), +     */, +    /**, +     * Returns the addresses port, +     */, +    /**, +     * Returns the enclosed {@link InetSocketAddress}, +     */, +++ b/core/src/test/java/org/elasticsearch/tribe/TribeIT.java, +                hosts.add(address.getAddress() + ":" + address.getPort());, +++ b/modules/reindex/src/test/java/org/elasticsearch/index/reindex/ReindexFromRemoteWithAuthTests.java, +        RemoteInfo remote = new RemoteInfo("http", address.getAddress(), address.getPort(), new BytesArray("{\"match_all\":{}}"), "Aladdin",, +        RemoteInfo remote = new RemoteInfo("http", address.getAddress(), address.getPort(), new BytesArray("{\"match_all\":{}}"), null,, +            null, singletonMap(TestFilter.EXAMPLE_HEADER, "doesn't matter"));, +        RemoteInfo remote = new RemoteInfo("http", address.getAddress(), address.getPort(), new BytesArray("{\"match_all\":{}}"), null,, +            null, emptyMap());, +        RemoteInfo remote = new RemoteInfo("http", address.getAddress(), address.getPort(), new BytesArray("{\"match_all\":{}}"), "junk",, +++ b/core/src/main/java/org/elasticsearch/bootstrap/BootstrapCheck.java, +import java.util.function.Predicate;, +        Predicate<TransportAddress> isLoopbackOrLinkLocalAddress = t -> t.address().getAddress().isLinkLocalAddress(), +            || t.address().getAddress().isLoopbackAddress();, +        return !(Arrays.stream(boundTransportAddress.boundAddresses()).allMatch(isLoopbackOrLinkLocalAddress) &&, +                isLoopbackOrLinkLocalAddress.test(boundTransportAddress.publishAddress()));, +++ b/core/src/main/java/org/elasticsearch/cluster/node/DiscoveryNode.java, +        this(nodeName, nodeId, UUIDs.randomBase64UUID(), address.getAddress(), address.getAddress(), address, attributes, roles, version);, +++ b/core/src/main/java/org/elasticsearch/common/transport/TransportAddress.java, +        byte[] bytes = address.getAddress().getAddress();  // 4 bytes (IPv4) or 16 bytes (IPv6), +    /**, +     * Returns a string representation of the enclosed {@link InetSocketAddress}, +     * @see NetworkAddress#format(InetAddress), +     */, +    /**]
[+++ b/src/main/java/org/elasticsearch/common/io/stream/StreamInput.java, +    @Nullable, +    public Text readOptionalText() throws IOException {, +        int length = readInt();, +        if (length == -1) {, +            return null;, +        }, +        return new StringAndBytesText(readBytesReference(length));, +    }, +, +++ b/src/main/java/org/elasticsearch/common/io/stream/StreamInput.java, +    @Nullable, +    public Text readOptionalText() throws IOException {, +        int length = readInt();, +        if (length == -1) {, +            return null;, +        }, +        return new StringAndBytesText(readBytesReference(length));, +    }, +, +++ b/src/main/java/org/elasticsearch/common/io/stream/StreamOutput.java, +    public void writeOptionalText(@Nullable Text text) throws IOException {, +        if (text == null) {, +            writeInt(-1);, +        } else {, +            writeText(text);, +        }, +    }, +]
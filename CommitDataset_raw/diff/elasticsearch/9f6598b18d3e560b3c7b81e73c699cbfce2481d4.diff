[+++ b/buildSrc/src/main/groovy/org/elasticsearch/gradle/test/ClusterFormationTasks.groovy, +            copyConfig.from(srcConfigFile), +++ b/buildSrc/src/main/groovy/org/elasticsearch/gradle/test/ClusterFormationTasks.groovy, +            copyConfig.from(srcConfigFile), +++ b/core/src/main/java/org/elasticsearch/client/transport/TransportClient.java, +import org.elasticsearch.common.network.NetworkService;, +import org.elasticsearch.common.settings.SettingsFilter;, +import org.elasticsearch.node.settings.NodeSettingsService;, +            final NetworkService networkService = new NetworkService(settings);, +            final SettingsFilter settingsFilter = new SettingsFilter(settings);, +                modules.add(new SettingsModule(this.settings, settingsFilter ));, +                modules.add(new NetworkModule(networkService));, +++ b/buildSrc/src/main/groovy/org/elasticsearch/gradle/test/ClusterFormationTasks.groovy, +            copyConfig.from(srcConfigFile), +++ b/core/src/main/java/org/elasticsearch/client/transport/TransportClient.java, +import org.elasticsearch.common.network.NetworkService;, +import org.elasticsearch.common.settings.SettingsFilter;, +import org.elasticsearch.node.settings.NodeSettingsService;, +            final NetworkService networkService = new NetworkService(settings);, +            final SettingsFilter settingsFilter = new SettingsFilter(settings);, +                modules.add(new SettingsModule(this.settings, settingsFilter ));, +                modules.add(new NetworkModule(networkService));, +++ b/core/src/main/java/org/elasticsearch/common/network/NetworkModule.java, +    private final NetworkService networkService;, +, +    public NetworkModule(NetworkService networkService) {, +        this.networkService = networkService;, +    }, +, +        bind(NetworkService.class).toInstance(networkService);, +++ b/buildSrc/src/main/groovy/org/elasticsearch/gradle/test/ClusterFormationTasks.groovy, +            copyConfig.from(srcConfigFile), +++ b/core/src/main/java/org/elasticsearch/client/transport/TransportClient.java, +import org.elasticsearch.common.network.NetworkService;, +import org.elasticsearch.common.settings.SettingsFilter;, +import org.elasticsearch.node.settings.NodeSettingsService;, +            final NetworkService networkService = new NetworkService(settings);, +            final SettingsFilter settingsFilter = new SettingsFilter(settings);, +                modules.add(new SettingsModule(this.settings, settingsFilter ));, +                modules.add(new NetworkModule(networkService));, +++ b/core/src/main/java/org/elasticsearch/common/network/NetworkModule.java, +    private final NetworkService networkService;, +, +    public NetworkModule(NetworkService networkService) {, +        this.networkService = networkService;, +    }, +, +        bind(NetworkService.class).toInstance(networkService);, +++ b/core/src/main/java/org/elasticsearch/common/network/NetworkService.java, +public final class NetworkService extends AbstractComponent {, +++ b/buildSrc/src/main/groovy/org/elasticsearch/gradle/test/ClusterFormationTasks.groovy, +            copyConfig.from(srcConfigFile), +++ b/core/src/main/java/org/elasticsearch/client/transport/TransportClient.java, +import org.elasticsearch.common.network.NetworkService;, +import org.elasticsearch.common.settings.SettingsFilter;, +import org.elasticsearch.node.settings.NodeSettingsService;, +            final NetworkService networkService = new NetworkService(settings);, +            final SettingsFilter settingsFilter = new SettingsFilter(settings);, +                modules.add(new SettingsModule(this.settings, settingsFilter ));, +                modules.add(new NetworkModule(networkService));, +++ b/core/src/main/java/org/elasticsearch/common/network/NetworkModule.java, +    private final NetworkService networkService;, +, +    public NetworkModule(NetworkService networkService) {, +        this.networkService = networkService;, +    }, +, +        bind(NetworkService.class).toInstance(networkService);, +++ b/core/src/main/java/org/elasticsearch/common/network/NetworkService.java, +public final class NetworkService extends AbstractComponent {, +++ b/core/src/main/java/org/elasticsearch/common/settings/SettingsFilter.java, +public final class SettingsFilter extends AbstractComponent {, +++ b/buildSrc/src/main/groovy/org/elasticsearch/gradle/test/ClusterFormationTasks.groovy, +            copyConfig.from(srcConfigFile), +++ b/core/src/main/java/org/elasticsearch/client/transport/TransportClient.java, +import org.elasticsearch.common.network.NetworkService;, +import org.elasticsearch.common.settings.SettingsFilter;, +import org.elasticsearch.node.settings.NodeSettingsService;, +            final NetworkService networkService = new NetworkService(settings);, +            final SettingsFilter settingsFilter = new SettingsFilter(settings);, +                modules.add(new SettingsModule(this.settings, settingsFilter ));, +                modules.add(new NetworkModule(networkService));, +++ b/core/src/main/java/org/elasticsearch/common/network/NetworkModule.java, +    private final NetworkService networkService;, +, +    public NetworkModule(NetworkService networkService) {, +        this.networkService = networkService;, +    }, +, +        bind(NetworkService.class).toInstance(networkService);, +++ b/core/src/main/java/org/elasticsearch/common/network/NetworkService.java, +public final class NetworkService extends AbstractComponent {, +++ b/core/src/main/java/org/elasticsearch/common/settings/SettingsFilter.java, +public final class SettingsFilter extends AbstractComponent {, +++ b/core/src/main/java/org/elasticsearch/common/settings/SettingsModule.java, +    private final SettingsFilter settingsFilter;, +    public SettingsModule(Settings settings, SettingsFilter settingsFilter) {, +        this.settingsFilter = settingsFilter;, +        bind(SettingsFilter.class).toInstance(settingsFilter);, +++ b/buildSrc/src/main/groovy/org/elasticsearch/gradle/test/ClusterFormationTasks.groovy]
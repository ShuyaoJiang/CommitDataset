[+++ b/src/main/java/org/elasticsearch/action/count/CountResponse.java, +import org.elasticsearch.rest.RestStatus;, +    public RestStatus status() {, +        if (getFailedShards() == 0) {, +            if (getSuccessfulShards() == 0 && getTotalShards() > 0) {, +                return RestStatus.SERVICE_UNAVAILABLE;, +            }, +            return RestStatus.OK;, +        }, +        // if total failure, bubble up the status code to the response level, +        if (getSuccessfulShards() == 0 && getTotalShards() > 0) {, +            RestStatus status = RestStatus.OK;, +            for (ShardOperationFailedException shardFailure : getShardFailures()) {, +                RestStatus shardStatus = shardFailure.status();, +                if (shardStatus.getStatus() >= status.getStatus()) {, +                    status = shardStatus;, +                }, +            }, +            return status;, +        }, +        return RestStatus.OK;, +    }, +, +++ b/src/main/java/org/elasticsearch/action/count/CountResponse.java, +import org.elasticsearch.rest.RestStatus;, +    public RestStatus status() {, +        if (getFailedShards() == 0) {, +            if (getSuccessfulShards() == 0 && getTotalShards() > 0) {, +                return RestStatus.SERVICE_UNAVAILABLE;, +            }, +            return RestStatus.OK;, +        }, +        // if total failure, bubble up the status code to the response level, +        if (getSuccessfulShards() == 0 && getTotalShards() > 0) {, +            RestStatus status = RestStatus.OK;, +            for (ShardOperationFailedException shardFailure : getShardFailures()) {, +                RestStatus shardStatus = shardFailure.status();, +                if (shardStatus.getStatus() >= status.getStatus()) {, +                    status = shardStatus;, +                }, +            }, +            return status;, +        }, +        return RestStatus.OK;, +    }, +, +++ b/src/main/java/org/elasticsearch/rest/action/count/RestCountAction.java, +                    channel.sendResponse(new XContentRestResponse(request, response.status(), builder));]
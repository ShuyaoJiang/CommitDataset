[+++ b/modules/elasticsearch/src/main/java/org/elasticsearch/indices/memory/IndexingMemoryBufferController.java, +import org.elasticsearch.index.engine.EngineClosedException;, +import org.elasticsearch.index.engine.FlushNotAllowedEngineException;, +                        long time = threadPool.estimatedTimeInMillis();, +                                    try {, +                                        ((InternalIndexShard) indexShard).engine().updateIndexingBufferSize(Engine.INACTIVE_SHARD_INDEXING_BUFFER);, +                                    } catch (EngineClosedException e) {, +                                        // ignore, +                                        continue;, +                                    } catch (FlushNotAllowedEngineException e) {, +                                        // ignore, +                                        continue;, +                                    }, +                    try {, +                    } catch (EngineClosedException e) {, +                        // ignore, +                        continue;, +                    } catch (FlushNotAllowedEngineException e) {, +                        // ignore, +                        continue;, +                    } catch (Exception e) {, +                        logger.warn("failed to set shard [{}][{}] index buffer to [{}]", indexShard.shardId().index().name(), indexShard.shardId().id(), shardIndexingBufferSize);, +                    }]
[+++ b/modules/lang-painless/src/main/java/org/elasticsearch/painless/Analyzer.java, +        // document's score as a read-only double., +        metadata.scoreValueSlot = utility.addVariable(null, "_score", definition.doubleType).slot;, +++ b/modules/lang-painless/src/main/java/org/elasticsearch/painless/Analyzer.java, +        // document's score as a read-only double., +        metadata.scoreValueSlot = utility.addVariable(null, "_score", definition.doubleType).slot;, +++ b/modules/lang-painless/src/main/java/org/elasticsearch/painless/Writer.java, +            //   final double _score = scorer.score();, +            execute.visitInsn(Opcodes.F2D);, +            execute.visitVarInsn(Opcodes.DSTORE, metadata.scoreValueSlot);, +            //   final Map<String,Object> ctx = input.get("ctx");]
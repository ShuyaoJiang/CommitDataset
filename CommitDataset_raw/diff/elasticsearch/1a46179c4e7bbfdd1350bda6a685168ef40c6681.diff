[+++ b/src/main/java/org/elasticsearch/common/lucene/search/AndFilter.java, +import org.apache.lucene.index.AtomicReaderContext;, +import org.apache.lucene.util.Bits;, +    public DocIdSet getDocIdSet(AtomicReaderContext context, Bits acceptDocs) throws IOException {, +            return filters.get(0).getDocIdSet(context, acceptDocs);, +            DocIdSet set = filter.getDocIdSet(context, acceptDocs);, +++ b/src/main/java/org/elasticsearch/common/lucene/search/AndFilter.java, +import org.apache.lucene.index.AtomicReaderContext;, +import org.apache.lucene.util.Bits;, +    public DocIdSet getDocIdSet(AtomicReaderContext context, Bits acceptDocs) throws IOException {, +            return filters.get(0).getDocIdSet(context, acceptDocs);, +            DocIdSet set = filter.getDocIdSet(context, acceptDocs);, +++ b/src/main/java/org/elasticsearch/common/lucene/search/FilteredCollector.java, +        docSet = DocSets.convert(context.reader(), filter.getDocIdSet(context, null));, +++ b/src/main/java/org/elasticsearch/common/lucene/search/AndFilter.java, +import org.apache.lucene.index.AtomicReaderContext;, +import org.apache.lucene.util.Bits;, +    public DocIdSet getDocIdSet(AtomicReaderContext context, Bits acceptDocs) throws IOException {, +            return filters.get(0).getDocIdSet(context, acceptDocs);, +            DocIdSet set = filter.getDocIdSet(context, acceptDocs);, +++ b/src/main/java/org/elasticsearch/common/lucene/search/FilteredCollector.java, +        docSet = DocSets.convert(context.reader(), filter.getDocIdSet(context, null));, +++ b/src/main/java/org/elasticsearch/common/lucene/search/LimitFilter.java, +import org.apache.lucene.index.AtomicReaderContext;, +import org.apache.lucene.util.Bits;, +    public DocIdSet getDocIdSet(AtomicReaderContext context, Bits acceptDocs) throws IOException {, +        return new LimitDocSet(context.reader().maxDoc(), limit);, +++ b/src/main/java/org/elasticsearch/common/lucene/search/AndFilter.java, +import org.apache.lucene.index.AtomicReaderContext;, +import org.apache.lucene.util.Bits;, +    public DocIdSet getDocIdSet(AtomicReaderContext context, Bits acceptDocs) throws IOException {, +            return filters.get(0).getDocIdSet(context, acceptDocs);, +            DocIdSet set = filter.getDocIdSet(context, acceptDocs);, +++ b/src/main/java/org/elasticsearch/common/lucene/search/FilteredCollector.java, +        docSet = DocSets.convert(context.reader(), filter.getDocIdSet(context, null));, +++ b/src/main/java/org/elasticsearch/common/lucene/search/LimitFilter.java, +import org.apache.lucene.index.AtomicReaderContext;, +import org.apache.lucene.util.Bits;, +    public DocIdSet getDocIdSet(AtomicReaderContext context, Bits acceptDocs) throws IOException {, +        return new LimitDocSet(context.reader().maxDoc(), limit);, +++ b/src/main/java/org/elasticsearch/common/lucene/search/MatchAllDocsFilter.java, +import org.apache.lucene.index.AtomicReaderContext;, +import org.apache.lucene.util.Bits;, +    public DocIdSet getDocIdSet(AtomicReaderContext context, Bits acceptDocs) throws IOException {, +        return new AllDocSet(context.reader().maxDoc());, +++ b/src/main/java/org/elasticsearch/common/lucene/search/AndFilter.java, +import org.apache.lucene.index.AtomicReaderContext;, +import org.apache.lucene.util.Bits;, +    public DocIdSet getDocIdSet(AtomicReaderContext context, Bits acceptDocs) throws IOException {, +            return filters.get(0).getDocIdSet(context, acceptDocs);, +            DocIdSet set = filter.getDocIdSet(context, acceptDocs);, +++ b/src/main/java/org/elasticsearch/common/lucene/search/FilteredCollector.java, +        docSet = DocSets.convert(context.reader(), filter.getDocIdSet(context, null));, +++ b/src/main/java/org/elasticsearch/common/lucene/search/LimitFilter.java, +import org.apache.lucene.index.AtomicReaderContext;, +import org.apache.lucene.util.Bits;, +    public DocIdSet getDocIdSet(AtomicReaderContext context, Bits acceptDocs) throws IOException {, +        return new LimitDocSet(context.reader().maxDoc(), limit);, +++ b/src/main/java/org/elasticsearch/common/lucene/search/MatchAllDocsFilter.java, +import org.apache.lucene.index.AtomicReaderContext;, +import org.apache.lucene.util.Bits;, +    public DocIdSet getDocIdSet(AtomicReaderContext context, Bits acceptDocs) throws IOException {, +        return new AllDocSet(context.reader().maxDoc());, +++ b/src/main/java/org/elasticsearch/common/lucene/search/MatchNoDocsFilter.java, +import org.apache.lucene.index.AtomicReaderContext;, +import org.apache.lucene.util.Bits;, +    public DocIdSet getDocIdSet(AtomicReaderContext context, Bits acceptDocs) throws IOException {]
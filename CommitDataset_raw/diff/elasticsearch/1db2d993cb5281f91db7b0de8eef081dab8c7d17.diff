[+++ b/modules/elasticsearch/src/main/java/org/elasticsearch/index/cache/bloom/simple/SimpleBloomCache.java, +import org.elasticsearch.common.unit.SizeUnit;, +import org.elasticsearch.common.unit.SizeValue;, +    private final long maxSize;, +, +, +        this.maxSize = indexSettings.getAsSize("index.cache.bloom.max_size", new SizeValue(500, SizeUnit.MEGA)).singles();, +, +                    filter = new BloomFilterEntry(currentNumDocs, BloomFilter.NONE);, +                    if (currentNumDocs < maxSize) {, +        }, +        if (filter.numDocs > 1000 && filter.numDocs < maxSize && (currentNumDocs / filter.numDocs) < 0.6) {]
[+++ b/core/src/main/java/org/elasticsearch/transport/TcpTransport.java, +    protected final void doClose() {, +++ b/core/src/main/java/org/elasticsearch/transport/TcpTransport.java, +    protected final void doClose() {, +++ b/test/framework/src/main/java/org/elasticsearch/transport/MockTcpTransport.java, +        synchronized (openChannels) {, +            assert openChannels.isEmpty() : "there are still open channels: " + openChannels;, +        }]
[+++ b/server/src/test/java/org/elasticsearch/discovery/SnapshotDisruptionIT.java, +import org.elasticsearch.cluster.ClusterState;, +import org.elasticsearch.cluster.SnapshotDeletionsInProgress;, +            ClusterState state = dataNodeClient().admin().cluster().prepareState().get().getState();, +            SnapshotsInProgress snapshots = state.custom(SnapshotsInProgress.TYPE);, +            SnapshotDeletionsInProgress snapshotDeletionsInProgress = state.custom(SnapshotDeletionsInProgress.TYPE);, +            } else if (snapshotDeletionsInProgress != null && snapshotDeletionsInProgress.hasDeletionsInProgress()) {, +                logger.info("Current snapshot deletion state [{}]", snapshotDeletionsInProgress);, +                fail("Snapshot deletion is still running");]
[+++ b/src/main/java/org/elasticsearch/common/lucene/Lucene.java, +     * Returns the number of documents in the index referenced by this {@link SegmentInfos}, +++ b/src/main/java/org/elasticsearch/common/lucene/Lucene.java, +     * Returns the number of documents in the index referenced by this {@link SegmentInfos}, +++ b/src/main/java/org/elasticsearch/index/engine/CommitStats.java, +import org.elasticsearch.common.lucene.Lucene;, +    private int numDocs;, +        numDocs = Lucene.getNumDocs(segmentInfos);, +    /**, +     * Returns the number of documents in the in this commit, +     */, +    public int getNumDocs() {, +        return numDocs;, +    }, +, +        numDocs = in.readInt();, +        out.writeInt(numDocs);, +        static final XContentBuilderString NUM_DOCS = new XContentBuilderString("num_docs");, +, +        builder.field(Fields.NUM_DOCS, numDocs);, +++ b/src/main/java/org/elasticsearch/common/lucene/Lucene.java, +     * Returns the number of documents in the index referenced by this {@link SegmentInfos}, +++ b/src/main/java/org/elasticsearch/index/engine/CommitStats.java, +import org.elasticsearch.common.lucene.Lucene;, +    private int numDocs;, +        numDocs = Lucene.getNumDocs(segmentInfos);, +    /**, +     * Returns the number of documents in the in this commit, +     */, +    public int getNumDocs() {, +        return numDocs;, +    }, +, +        numDocs = in.readInt();, +        out.writeInt(numDocs);, +        static final XContentBuilderString NUM_DOCS = new XContentBuilderString("num_docs");, +, +        builder.field(Fields.NUM_DOCS, numDocs);, +++ b/src/main/java/org/elasticsearch/index/engine/InternalEngine.java, +, +++ b/src/main/java/org/elasticsearch/common/lucene/Lucene.java, +     * Returns the number of documents in the index referenced by this {@link SegmentInfos}, +++ b/src/main/java/org/elasticsearch/index/engine/CommitStats.java, +import org.elasticsearch.common.lucene.Lucene;, +    private int numDocs;, +        numDocs = Lucene.getNumDocs(segmentInfos);, +    /**, +     * Returns the number of documents in the in this commit, +     */, +    public int getNumDocs() {, +        return numDocs;, +    }, +, +        numDocs = in.readInt();, +        out.writeInt(numDocs);, +        static final XContentBuilderString NUM_DOCS = new XContentBuilderString("num_docs");, +, +        builder.field(Fields.NUM_DOCS, numDocs);, +++ b/src/main/java/org/elasticsearch/index/engine/InternalEngine.java, +, +++ b/src/test/java/org/elasticsearch/test/InternalTestCluster.java, +import org.elasticsearch.index.engine.CommitStats;, +                        CommitStats commitStats = indexShard.engine().commitStats();, +                        String syncId = commitStats.getUserData().get(Engine.SYNC_COMMIT_ID);, +                            long liveDocsOnShard = commitStats.getNumDocs();]
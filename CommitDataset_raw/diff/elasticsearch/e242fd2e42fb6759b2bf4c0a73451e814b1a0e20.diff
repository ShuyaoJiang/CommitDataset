[+++ b/x-pack/plugin/ccr/src/main/java/org/elasticsearch/xpack/ccr/action/ShardFollowNodeTask.java, +import org.elasticsearch.transport.NodeDisconnectedException;, +import org.elasticsearch.transport.NodeNotConnectedException;, +            LOGGER.warn("shard follow task encounter non-retryable error", e);, +            actual instanceof IndexClosedException || // If follow index is closed, +            actual instanceof NodeDisconnectedException ||, +            actual instanceof NodeNotConnectedException ||, +            (actual.getMessage() != null && actual.getMessage().contains("TransportService is closed"));, +++ b/x-pack/plugin/ccr/src/main/java/org/elasticsearch/xpack/ccr/action/ShardFollowNodeTask.java, +import org.elasticsearch.transport.NodeDisconnectedException;, +import org.elasticsearch.transport.NodeNotConnectedException;, +            LOGGER.warn("shard follow task encounter non-retryable error", e);, +            actual instanceof IndexClosedException || // If follow index is closed, +            actual instanceof NodeDisconnectedException ||, +            actual instanceof NodeNotConnectedException ||, +            (actual.getMessage() != null && actual.getMessage().contains("TransportService is closed"));, +++ b/x-pack/plugin/ccr/src/test/java/org/elasticsearch/xpack/ccr/IndexFollowingIT.java]
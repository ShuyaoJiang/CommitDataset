[+++ b/src/test/java/org/elasticsearch/test/InternalTestCluster.java, +import com.google.common.collect.*;, +import java.util.*;, +import static org.apache.lucene.util.LuceneTestCase.*;, +import static org.hamcrest.Matchers.*;, +            int historySize = 3 + random.nextInt(100);, +            historySize = Math.max(historySize, freqCacheable);, +            historySize = Math.max(historySize, freqCostly);, +            historySize = Math.max(historySize, freqOther);, +            builder.put(AutoFilterCachingPolicy.HISTORY_SIZE, historySize);]
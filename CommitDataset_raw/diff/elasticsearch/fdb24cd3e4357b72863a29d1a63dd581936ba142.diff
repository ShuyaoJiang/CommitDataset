[+++ b/modules/rank-eval/src/main/java/org/elasticsearch/index/rankeval/RankEvalSpec.java, +                Objects.equals(templates, other.templates) &&, +                Objects.equals(indices, other.indices);, +        return Objects.hash(ratedRequests, metric, templates, maxConcurrentSearches, indices);, +++ b/modules/rank-eval/src/main/java/org/elasticsearch/index/rankeval/RankEvalSpec.java, +                Objects.equals(templates, other.templates) &&, +                Objects.equals(indices, other.indices);, +        return Objects.hash(ratedRequests, metric, templates, maxConcurrentSearches, indices);, +++ b/modules/rank-eval/src/test/java/org/elasticsearch/index/rankeval/RankEvalSpecTests.java, +            // indices, come from URL parameters, so they don't survive xContent roundtrip, +            // for the sake of being able to use equals() next, we add it to the parsed object, +            parsedItem.addIndices(testItem.getIndices());, +        Map<String, Script> templates = new HashMap<>(original.getTemplates());]
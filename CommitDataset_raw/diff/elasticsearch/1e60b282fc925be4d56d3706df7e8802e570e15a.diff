[+++ b/x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/security/authz/store/ReservedRolesStore.java, +                                        .indices(".management-beats").privileges("create_index", "read", "write").build(),, +                                RoleDescriptor.IndicesPrivileges.builder(), +                                        .indices(".tasks").privileges("create_index", "read", "create").build(), +++ b/x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/security/authz/store/ReservedRolesStore.java, +                                        .indices(".management-beats").privileges("create_index", "read", "write").build(),, +                                RoleDescriptor.IndicesPrivileges.builder(), +                                        .indices(".tasks").privileges("create_index", "read", "create").build(), +++ b/x-pack/plugin/core/src/test/java/org/elasticsearch/xpack/core/security/authz/store/ReservedRolesStoreTests.java, +import org.elasticsearch.action.admin.indices.close.CloseIndexAction;, +import org.elasticsearch.action.admin.indices.mapping.put.PutMappingAction;, +, +        // Tasks index, +        final String taskIndex = org.elasticsearch.tasks.TaskResultsService.TASK_INDEX;, +        // Things that kibana_system *should* be able to do, +        assertThat(kibanaRole.indices().allowedIndicesMatcher(CreateIndexAction.NAME).test(taskIndex), is(true));, +        assertThat(kibanaRole.indices().allowedIndicesMatcher(PutMappingAction.NAME).test(taskIndex), is(true));, +        assertThat(kibanaRole.indices().allowedIndicesMatcher(IndexAction.NAME).test(taskIndex), is(true));, +        assertThat(kibanaRole.indices().allowedIndicesMatcher(GetAction.NAME).test(taskIndex), is(true));, +        // Things that kibana_system *should not* be able to do, +        assertThat(kibanaRole.indices().allowedIndicesMatcher(DeleteIndexAction.NAME).test(taskIndex), is(false));, +        assertThat(kibanaRole.indices().allowedIndicesMatcher(DeleteAction.NAME).test(taskIndex), is(false));, +        assertThat(kibanaRole.indices().allowedIndicesMatcher(CloseIndexAction.NAME).test(taskIndex), is(false));]
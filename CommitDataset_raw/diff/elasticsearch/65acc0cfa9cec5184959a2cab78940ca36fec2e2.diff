[+++ b/modules/elasticsearch/src/main/java/org/elasticsearch/util/component/AbstractLifecycleComponent.java, +        if (!lifecycle.canMoveToStarted()) {, +        lifecycle.moveToStarted();, +        if (!lifecycle.canMoveToStopped()) {, +        lifecycle.moveToStopped();, +        if (!lifecycle.canMoveToClosed()) {, +        lifecycle.moveToClosed();, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/util/component/AbstractLifecycleComponent.java, +        if (!lifecycle.canMoveToStarted()) {, +        lifecycle.moveToStarted();, +        if (!lifecycle.canMoveToStopped()) {, +        lifecycle.moveToStopped();, +        if (!lifecycle.canMoveToClosed()) {, +        lifecycle.moveToClosed();, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/util/component/Lifecycle.java, +    public boolean canMoveToStarted() throws ElasticSearchIllegalStateException {, +        State localState = this.state;, +        if (localState == State.INITIALIZED || localState == State.STOPPED) {, +            return true;, +        }, +        if (localState == State.STARTED) {, +            return false;, +        }, +        if (localState == State.CLOSED) {, +            throw new ElasticSearchIllegalStateException("Can't move to started state when closed");, +        }, +        throw new ElasticSearchIllegalStateException("Can't move to started with unknown state");, +    }, +, +, +    public boolean canMoveToStopped() throws ElasticSearchIllegalStateException {, +        State localState = state;, +        if (localState == State.STARTED) {, +            return true;, +        }, +        if (localState == State.INITIALIZED || localState == State.STOPPED) {, +            return false;, +        }, +        if (localState == State.CLOSED) {, +            throw new ElasticSearchIllegalStateException("Can't move to started state when closed");, +        }, +        throw new ElasticSearchIllegalStateException("Can't move to started with unknown state");, +    }, +, +    public boolean canMoveToClosed() throws ElasticSearchIllegalStateException {, +        State localState = state;, +        if (localState == State.CLOSED) {, +            return false;, +        }, +        if (localState == State.STARTED) {, +            throw new ElasticSearchIllegalStateException("Can't move to closed before moving to stopped mode");, +        }, +        return true;, +    }, +, +]
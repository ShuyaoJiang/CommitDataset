[+++ b/plugin/src/main/java/org/elasticsearch/license/License.java, +, +    /**, +     * Returns <code>true</code> iff the license is a production licnese, +     */, +    public boolean isProductionLicense() {, +        switch (operationMode()) {, +            case MISSING:, +            case TRIAL:, +            case BASIC:, +                return false;, +            case STANDARD:, +            case GOLD:, +            case PLATINUM:, +                return true;, +            default:, +                throw new AssertionError("unknown operation mode: " + operationMode());, +, +        }, +    }, +++ b/plugin/src/main/java/org/elasticsearch/license/License.java, +, +    /**, +     * Returns <code>true</code> iff the license is a production licnese, +     */, +    public boolean isProductionLicense() {, +        switch (operationMode()) {, +            case MISSING:, +            case TRIAL:, +            case BASIC:, +                return false;, +            case STANDARD:, +            case GOLD:, +            case PLATINUM:, +                return true;, +            default:, +                throw new AssertionError("unknown operation mode: " + operationMode());, +, +        }, +    }, +++ b/plugin/src/main/java/org/elasticsearch/license/LicenseService.java, +        final License license = getLicense(clusterService.state().metaData());, +    public static License getLicense(final MetaData metaData) {, +        final LicensesMetaData licensesMetaData = metaData.custom(LicensesMetaData.TYPE);, +        return getLicense(licensesMetaData);, +    }, +, +    static License getLicense(final LicensesMetaData metaData) {, +++ b/plugin/src/main/java/org/elasticsearch/license/License.java, +, +    /**, +     * Returns <code>true</code> iff the license is a production licnese, +     */, +    public boolean isProductionLicense() {, +        switch (operationMode()) {, +            case MISSING:, +            case TRIAL:, +            case BASIC:, +                return false;, +            case STANDARD:, +            case GOLD:, +            case PLATINUM:, +                return true;, +            default:, +                throw new AssertionError("unknown operation mode: " + operationMode());, +, +        }, +    }, +++ b/plugin/src/main/java/org/elasticsearch/license/LicenseService.java, +        final License license = getLicense(clusterService.state().metaData());, +    public static License getLicense(final MetaData metaData) {, +        final LicensesMetaData licensesMetaData = metaData.custom(LicensesMetaData.TYPE);, +        return getLicense(licensesMetaData);, +    }, +, +    static License getLicense(final LicensesMetaData metaData) {, +++ b/plugin/src/main/java/org/elasticsearch/xpack/XPackPlugin.java, +import org.elasticsearch.cluster.node.DiscoveryNode;, +import org.elasticsearch.plugins.DiscoveryPlugin;, +import java.util.function.BiConsumer;, +public class XPackPlugin extends Plugin implements ScriptPlugin, ActionPlugin, IngestPlugin, NetworkPlugin, ClusterPlugin, DiscoveryPlugin {, +, +    @Override, +    public BiConsumer<DiscoveryNode, ClusterState> getJoinValidator() {, +        return security.getJoinValidator();, +    }, +++ b/plugin/src/main/java/org/elasticsearch/license/License.java, +, +    /**, +     * Returns <code>true</code> iff the license is a production licnese, +     */, +    public boolean isProductionLicense() {, +        switch (operationMode()) {, +            case MISSING:, +            case TRIAL:, +            case BASIC:, +                return false;, +            case STANDARD:, +            case GOLD:, +            case PLATINUM:]
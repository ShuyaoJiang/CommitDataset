[+++ b/server/src/test/java/org/elasticsearch/action/bulk/BulkWithUpdatesIT.java, +import org.elasticsearch.indices.IndexClosedException;, +import static org.hamcrest.Matchers.instanceOf;, +        assertBusy(() -> assertAcked(client().admin().indices().prepareClose("bulkindex2")));, +        assertBusy(() -> assertAcked(client().admin().indices().prepareClose("bulkindex1")));, +        assertThat(responseItems[0].getFailure().getCause(), instanceOf(IndexClosedException.class));, +        assertThat(responseItems[1].getFailure().getCause(), instanceOf(IndexClosedException.class));, +        assertThat(responseItems[2].getFailure().getCause(), instanceOf(IndexClosedException.class));, +++ b/server/src/test/java/org/elasticsearch/action/bulk/BulkWithUpdatesIT.java, +import org.elasticsearch.indices.IndexClosedException;, +import static org.hamcrest.Matchers.instanceOf;, +        assertBusy(() -> assertAcked(client().admin().indices().prepareClose("bulkindex2")));, +        assertBusy(() -> assertAcked(client().admin().indices().prepareClose("bulkindex1")));, +        assertThat(responseItems[0].getFailure().getCause(), instanceOf(IndexClosedException.class));, +        assertThat(responseItems[1].getFailure().getCause(), instanceOf(IndexClosedException.class));, +        assertThat(responseItems[2].getFailure().getCause(), instanceOf(IndexClosedException.class));, +++ b/server/src/test/java/org/elasticsearch/indices/state/CloseIndexIT.java, +import static org.elasticsearch.action.support.IndicesOptions.lenientExpandOpen;, +    public void testCloseOneMissingIndexIgnoreMissing() throws Exception {, +        assertBusy(() -> assertAcked(client().admin().indices().prepareClose("test1", "test2").setIndicesOptions(lenientExpandOpen())));, +        assertBusy(() -> assertAcked(client().admin().indices().prepareClose(indexName)));, +        assertBusy(() -> assertAcked(client().admin().indices().prepareClose(indexName)));, +        assertBusy(() -> assertAcked(client().admin().indices().prepareClose(indexName)));, +    public void testCloseUnassignedIndex() throws Exception {, +        assertBusy(() -> assertAcked(client().admin().indices().prepareClose(indexName)));, +            assertBusy(() -> assertAcked(client().admin().indices().prepareClose(indexName)));]
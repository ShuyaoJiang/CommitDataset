[+++ b/docs/build.gradle, +  // Broken code snippet tests, +  exclude 'reference/rollup/rollup-getting-started.asciidoc', +  exclude 'reference/rollup/apis/rollup-job-config.asciidoc', +  exclude 'reference/rollup/apis/rollup-index-caps.asciidoc', +  exclude 'reference/rollup/apis/put-job.asciidoc', +  exclude 'reference/rollup/apis/stop-job.asciidoc', +  exclude 'reference/rollup/apis/start-job.asciidoc', +  exclude 'reference/rollup/apis/rollup-search.asciidoc', +  exclude 'reference/rollup/apis/delete-job.asciidoc', +  exclude 'reference/rollup/apis/get-job.asciidoc', +  exclude 'reference/rollup/apis/rollup-caps.asciidoc', +buildRestTests.setups['sensor_rollup_job'] = ''', +  - do:, +      indices.create:, +        index: sensor-1, +        body:, +          settings:, +            number_of_shards: 1, +            number_of_replicas: 0, +          mappings:, +            _doc:, +              properties:, +                timestamp:, +                  type: date, +                temperature:, +                  type: long, +                voltage:, +                  type: float, +                node:, +                  type: keyword, +  - do:, +      xpack.rollup.put_job:, +        id: "sensor", +        body:  >, +            {, +                "index_pattern": "sensor-*",, +                "rollup_index": "sensor_rollup",, +                "cron": "*/30 * * * * ?",, +                "page_size" :1000,, +                "groups" : {, +                  "date_histogram": {, +                    "field": "timestamp",, +                    "interval": "1h",, +                    "delay": "7d", +                  },, +                  "terms": {, +                    "fields": ["node"], +                  }, +                },, +                "metrics": [, +                    {, +                        "field": "temperature",, +                        "metrics": ["min", "max", "sum"], +                    },, +                    {, +                        "field": "voltage",, +                        "metrics": ["avg"], +                    }, +                ], +            }, +''', +buildRestTests.setups['sensor_started_rollup_job'] = ''', +  - do:, +      indices.create:, +        index: sensor-1, +        body:, +          settings:, +            number_of_shards: 1, +            number_of_replicas: 0, +          mappings:, +            _doc:, +              properties:, +                timestamp:, +                  type: date, +                temperature:, +                  type: long, +                voltage:, +                  type: float, +                node:, +                  type: keyword, +, +  - do:, +      bulk:, +        index: sensor-1, +        type: _doc, +        refresh: true, +        body: |, +          {"index":{}}, +          {"timestamp": 1516729294000, "temperature": 200, "voltage": 5.2, "node": "a"}, +          {"index":{}}, +          {"timestamp": 1516642894000, "temperature": 201, "voltage": 5.8, "node": "b"}, +          {"index":{}}, +          {"timestamp": 1516556494000, "temperature": 202, "voltage": 5.1, "node": "a"}, +          {"index":{}}, +          {"timestamp": 1516470094000, "temperature": 198, "voltage": 5.6, "node": "b"}, +          {"index":{}}, +          {"timestamp": 1516383694000, "temperature": 200, "voltage": 4.2, "node": "c"}, +          {"index":{}}, +          {"timestamp": 1516297294000, "temperature": 202, "voltage": 4.0, "node": "c"}]
[+++ b/src/main/java/org/elasticsearch/cluster/service/InternalClusterService.java, +import org.elasticsearch.common.logging.ESLogger;, +import org.elasticsearch.common.logging.Loggers;, +                                ackListener = new AckCountDownListener(ackedUpdateTask, newClusterState.version(), newClusterState.nodes(), threadPool);, +    private static class AckCountDownListener implements Discovery.AckListener {, +, +        private static final ESLogger logger = Loggers.getLogger(AckCountDownListener.class);, +, +        private final DiscoveryNodes nodes;, +        private final long clusterStateVersion;, +        AckCountDownListener(AckedClusterStateUpdateTask ackedUpdateTask, long clusterStateVersion, DiscoveryNodes nodes, ThreadPool threadPool) {, +            this.clusterStateVersion = clusterStateVersion;, +            this.nodes = nodes;, +            for (DiscoveryNode node : nodes) {, +            logger.trace("expecting {} acknowledgements for cluster_state update (version: {})", countDown, clusterStateVersion);, +                if (!node.equals(nodes.masterNode())) {, +                logger.trace("ack received from node [{}], cluster_state update (version: {})", node, clusterStateVersion);, +                logger.debug("ack received from node [{}], cluster_state update (version: {})", t, node, clusterStateVersion);, +                logger.trace("all expected nodes acknowledged cluster_state update (version: {})", clusterStateVersion);, +                logger.trace("timeout waiting for acknowledgement for cluster_state update (version: {})", clusterStateVersion);]
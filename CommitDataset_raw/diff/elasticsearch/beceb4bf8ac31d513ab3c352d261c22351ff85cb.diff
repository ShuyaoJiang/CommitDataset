[+++ b/TESTING.asciidoc, +or to attach a remote debugger, run it as:, +, +-------------------------------------, +gradle run --debug-jvm, +-------------------------------------, +, +== Debugging from an IDE, +++ b/TESTING.asciidoc, +or to attach a remote debugger, run it as:, +, +-------------------------------------, +gradle run --debug-jvm, +-------------------------------------, +, +== Debugging from an IDE, +++ b/core/src/main/java/org/elasticsearch/action/admin/indices/analyze/AnalyzeRequestBuilder.java, +    public AnalyzeRequestBuilder setAttributes(String... attributes){, +++ b/TESTING.asciidoc, +or to attach a remote debugger, run it as:, +, +-------------------------------------, +gradle run --debug-jvm, +-------------------------------------, +, +== Debugging from an IDE, +++ b/core/src/main/java/org/elasticsearch/action/admin/indices/analyze/AnalyzeRequestBuilder.java, +    public AnalyzeRequestBuilder setAttributes(String... attributes){, +++ b/core/src/main/java/org/elasticsearch/action/admin/indices/analyze/AnalyzeResponse.java, +        private int positionLength = 1;, +        public AnalyzeToken(String term, int position, int startOffset, int endOffset, int positionLength,, +                            String type, Map<String, Object> attributes) {, +            this.positionLength = positionLength;, +        public int getPositionLength() {, +            return this.positionLength;, +        }, +, +            if (positionLength > 1) {, +                builder.field(Fields.POSITION_LENGTH, positionLength);, +            }, +            if (in.getVersion().onOrAfter(Version.V_5_2_0_UNRELEASED)) {, +                Integer len = in.readOptionalVInt();, +                if (len != null) {, +                    positionLength = len;, +                } else {, +                    positionLength = 1;, +                }, +            }, +            if (out.getVersion().onOrAfter(Version.V_5_2_0_UNRELEASED)) {, +                out.writeOptionalVInt(positionLength > 1 ? positionLength : null);, +            }, +        static final String POSITION_LENGTH = "positionLength";, +++ b/TESTING.asciidoc, +or to attach a remote debugger, run it as:, +, +-------------------------------------, +gradle run --debug-jvm, +-------------------------------------, +, +== Debugging from an IDE, +++ b/core/src/main/java/org/elasticsearch/action/admin/indices/analyze/AnalyzeRequestBuilder.java, +    public AnalyzeRequestBuilder setAttributes(String... attributes){, +++ b/core/src/main/java/org/elasticsearch/action/admin/indices/analyze/AnalyzeResponse.java, +        private int positionLength = 1;, +        public AnalyzeToken(String term, int position, int startOffset, int endOffset, int positionLength,, +                            String type, Map<String, Object> attributes) {, +            this.positionLength = positionLength;, +        public int getPositionLength() {, +            return this.positionLength;, +        }, +, +            if (positionLength > 1) {, +                builder.field(Fields.POSITION_LENGTH, positionLength);, +            }, +            if (in.getVersion().onOrAfter(Version.V_5_2_0_UNRELEASED)) {, +                Integer len = in.readOptionalVInt();, +                if (len != null) {, +                    positionLength = len;, +                } else {, +                    positionLength = 1;, +                }, +            }, +            if (out.getVersion().onOrAfter(Version.V_5_2_0_UNRELEASED)) {, +                out.writeOptionalVInt(positionLength > 1 ? positionLength : null);, +            }, +        static final String POSITION_LENGTH = "positionLength";, +++ b/core/src/main/java/org/elasticsearch/action/admin/indices/analyze/TransportAnalyzeAction.java, +import org.apache.lucene.analysis.tokenattributes.PositionLengthAttribute;, +                PositionLengthAttribute posLen = stream.addAttribute(PositionLengthAttribute.class);, +                    tokens.add(new AnalyzeResponse.AnalyzeToken(term.toString(), lastPosition, lastOffset + offset.startOffset(),, +                        lastOffset + offset.endOffset(), posLen.getPositionLength(), type.type(), null));, +                PositionLengthAttribute posLen = stream.addAttribute(PositionLengthAttribute.class);, +                        lastOffset + offset.endOffset(), posLen.getPositionLength(), type.type(), extractExtendedAttributes(stream, includeAttributes)));, +++ b/TESTING.asciidoc, +or to attach a remote debugger, run it as:, +, +-------------------------------------, +gradle run --debug-jvm, +-------------------------------------, +]
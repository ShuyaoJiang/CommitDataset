[+++ b/modules/elasticsearch/src/main/java/org/elasticsearch/index/query/xcontent/BoolQueryBuilder.java, +        List<Clause> musts = new ArrayList<Clause>();, +        List<Clause> mustNots = new ArrayList<Clause>();, +        List<Clause> shoulds = new ArrayList<Clause>();, +                musts.add(clause);, +                mustNots.add(clause);, +                shoulds.add(clause);, +        doXArrayContent("must", musts, builder, params);, +        doXArrayContent("must_not", mustNots, builder, params);, +        doXArrayContent("should", shoulds, builder, params);, +    private void doXArrayContent(String field, List<Clause> clauses, XContentBuilder builder, Params params) throws IOException {, +        if (clauses.isEmpty()) {, +            return;, +        }, +        if (clauses.size() == 1) {, +            builder.field(field);, +            clauses.get(0).queryBuilder.toXContent(builder, params);, +        } else {, +            builder.startArray(field);, +            for (Clause clause : clauses) {, +                clause.queryBuilder.toXContent(builder, params);, +            }, +            builder.endArray();, +        }, +    }, +]
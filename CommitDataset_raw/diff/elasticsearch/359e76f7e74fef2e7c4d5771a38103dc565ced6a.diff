[+++ b/buildSrc/src/main/resources/checkstyle_suppressions.xml, +  <suppress files="core[/\\]src[/\\]test[/\\]java[/\\]org[/\\]elasticsearch[/\\]action[/\\]support[/\\]IndicesOptionsTests.java" checks="LineLength" />, +++ b/buildSrc/src/main/resources/checkstyle_suppressions.xml, +  <suppress files="core[/\\]src[/\\]test[/\\]java[/\\]org[/\\]elasticsearch[/\\]action[/\\]support[/\\]IndicesOptionsTests.java" checks="LineLength" />, +++ b/core/src/main/java/org/elasticsearch/Version.java, +    public static final int V_2_4_0_ID = 2040099;, +    public static final Version V_2_4_0 = new Version(V_2_4_0_ID, org.apache.lucene.util.Version.LUCENE_5_5_2);, +            case V_2_4_0_ID:, +                return V_2_4_0;, +++ b/buildSrc/src/main/resources/checkstyle_suppressions.xml, +  <suppress files="core[/\\]src[/\\]test[/\\]java[/\\]org[/\\]elasticsearch[/\\]action[/\\]support[/\\]IndicesOptionsTests.java" checks="LineLength" />, +++ b/core/src/main/java/org/elasticsearch/Version.java, +    public static final int V_2_4_0_ID = 2040099;, +    public static final Version V_2_4_0 = new Version(V_2_4_0_ID, org.apache.lucene.util.Version.LUCENE_5_5_2);, +            case V_2_4_0_ID:, +                return V_2_4_0;, +++ b/core/src/main/java/org/elasticsearch/action/ActionModule.java, +        autoCreateIndex = transportClient ? null : new AutoCreateIndex(settings, clusterSettings, resolver);, +++ b/buildSrc/src/main/resources/checkstyle_suppressions.xml, +  <suppress files="core[/\\]src[/\\]test[/\\]java[/\\]org[/\\]elasticsearch[/\\]action[/\\]support[/\\]IndicesOptionsTests.java" checks="LineLength" />, +++ b/core/src/main/java/org/elasticsearch/Version.java, +    public static final int V_2_4_0_ID = 2040099;, +    public static final Version V_2_4_0 = new Version(V_2_4_0_ID, org.apache.lucene.util.Version.LUCENE_5_5_2);, +            case V_2_4_0_ID:, +                return V_2_4_0;, +++ b/core/src/main/java/org/elasticsearch/action/ActionModule.java, +        autoCreateIndex = transportClient ? null : new AutoCreateIndex(settings, clusterSettings, resolver);, +++ b/core/src/main/java/org/elasticsearch/action/admin/cluster/node/stats/NodeStats.java, +            os = OsStats.readOsStats(in);, +++ b/buildSrc/src/main/resources/checkstyle_suppressions.xml, +  <suppress files="core[/\\]src[/\\]test[/\\]java[/\\]org[/\\]elasticsearch[/\\]action[/\\]support[/\\]IndicesOptionsTests.java" checks="LineLength" />, +++ b/core/src/main/java/org/elasticsearch/Version.java, +    public static final int V_2_4_0_ID = 2040099;, +    public static final Version V_2_4_0 = new Version(V_2_4_0_ID, org.apache.lucene.util.Version.LUCENE_5_5_2);, +            case V_2_4_0_ID:, +                return V_2_4_0;, +++ b/core/src/main/java/org/elasticsearch/action/ActionModule.java, +        autoCreateIndex = transportClient ? null : new AutoCreateIndex(settings, clusterSettings, resolver);, +++ b/core/src/main/java/org/elasticsearch/action/admin/cluster/node/stats/NodeStats.java, +            os = OsStats.readOsStats(in);, +++ b/core/src/main/java/org/elasticsearch/action/admin/cluster/stats/ClusterStatsNodes.java, +        this.os = new OsStats(nodeInfos);, +        private OsStats(List<NodeInfo> nodeInfos) {, +++ b/buildSrc/src/main/resources/checkstyle_suppressions.xml, +  <suppress files="core[/\\]src[/\\]test[/\\]java[/\\]org[/\\]elasticsearch[/\\]action[/\\]support[/\\]IndicesOptionsTests.java" checks="LineLength" />, +++ b/core/src/main/java/org/elasticsearch/Version.java, +    public static final int V_2_4_0_ID = 2040099;, +    public static final Version V_2_4_0 = new Version(V_2_4_0_ID, org.apache.lucene.util.Version.LUCENE_5_5_2);, +            case V_2_4_0_ID:, +                return V_2_4_0;, +++ b/core/src/main/java/org/elasticsearch/action/ActionModule.java, +        autoCreateIndex = transportClient ? null : new AutoCreateIndex(settings, clusterSettings, resolver);, +++ b/core/src/main/java/org/elasticsearch/action/admin/cluster/node/stats/NodeStats.java, +            os = OsStats.readOsStats(in);, +++ b/core/src/main/java/org/elasticsearch/action/admin/cluster/stats/ClusterStatsNodes.java, +        this.os = new OsStats(nodeInfos);, +        private OsStats(List<NodeInfo> nodeInfos) {, +++ b/core/src/main/java/org/elasticsearch/action/admin/cluster/stats/TransportClusterStatsAction.java, +        NodeStats nodeStats = nodeService.stats(CommonStatsFlags.NONE, false, true, true, false, true, false, false, false, false, false, false);, +++ b/buildSrc/src/main/resources/checkstyle_suppressions.xml, +  <suppress files="core[/\\]src[/\\]test[/\\]java[/\\]org[/\\]elasticsearch[/\\]action[/\\]support[/\\]IndicesOptionsTests.java" checks="LineLength" />, +++ b/core/src/main/java/org/elasticsearch/Version.java, +    public static final int V_2_4_0_ID = 2040099;, +    public static final Version V_2_4_0 = new Version(V_2_4_0_ID, org.apache.lucene.util.Version.LUCENE_5_5_2);, +            case V_2_4_0_ID:, +                return V_2_4_0;, +++ b/core/src/main/java/org/elasticsearch/action/ActionModule.java, +        autoCreateIndex = transportClient ? null : new AutoCreateIndex(settings, clusterSettings, resolver);, +++ b/core/src/main/java/org/elasticsearch/action/admin/cluster/node/stats/NodeStats.java, +            os = OsStats.readOsStats(in);, +++ b/core/src/main/java/org/elasticsearch/action/admin/cluster/stats/ClusterStatsNodes.java, +        this.os = new OsStats(nodeInfos);, +        private OsStats(List<NodeInfo> nodeInfos) {, +++ b/core/src/main/java/org/elasticsearch/action/admin/cluster/stats/TransportClusterStatsAction.java, +        NodeStats nodeStats = nodeService.stats(CommonStatsFlags.NONE, false, true, true, false, true, false, false, false, false, false, false);, +++ b/core/src/main/java/org/elasticsearch/action/support/AutoCreateIndex.java, +import org.elasticsearch.common.settings.ClusterSettings;, +        new Setting<>("action.auto_create_index", "true", AutoCreate::new, Property.NodeScope, Setting.Property.Dynamic);, +    private volatile AutoCreate autoCreate;, +    public AutoCreateIndex(Settings settings, ClusterSettings clusterSettings, IndexNameExpressionResolver resolver) {, +        clusterSettings.addSettingsUpdateConsumer(AUTO_CREATE_INDEX_SETTING, this::setAutoCreate);, +        // One volatile read, so that all checks are done against the same instance:, +        final AutoCreate autoCreate = this.autoCreate;, +    AutoCreate getAutoCreate() {, +        return autoCreate;, +    }, +, +    void setAutoCreate(AutoCreate autoCreate) {, +        this.autoCreate = autoCreate;, +    }, +, +    static class AutoCreate {, +, +        boolean isAutoCreateIndex() {, +            return autoCreateIndex;, +        }, +, +        List<Tuple<String, Boolean>> getExpressions() {, +            return expressions;, +        }]
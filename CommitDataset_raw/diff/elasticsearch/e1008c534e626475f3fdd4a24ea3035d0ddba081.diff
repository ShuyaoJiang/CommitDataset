[+++ b/docs/en/security/authorization/field-and-document-access-control.asciidoc, +Access to the following meta fields is always allowed: `_id`,, +++ b/docs/en/security/authorization/field-and-document-access-control.asciidoc, +Access to the following meta fields is always allowed: `_id`,, +++ b/plugin/src/main/java/org/elasticsearch/xpack/deprecation/DeprecationChecks.java, +++ b/docs/en/security/authorization/field-and-document-access-control.asciidoc, +Access to the following meta fields is always allowed: `_id`,, +++ b/plugin/src/main/java/org/elasticsearch/xpack/deprecation/DeprecationChecks.java, +++ b/plugin/src/main/java/org/elasticsearch/xpack/deprecation/IndexDeprecationChecks.java, +++ b/docs/en/security/authorization/field-and-document-access-control.asciidoc, +Access to the following meta fields is always allowed: `_id`,, +++ b/plugin/src/main/java/org/elasticsearch/xpack/deprecation/DeprecationChecks.java, +++ b/plugin/src/main/java/org/elasticsearch/xpack/deprecation/IndexDeprecationChecks.java, +++ b/plugin/src/main/java/org/elasticsearch/xpack/security/authz/permission/FieldPermissions.java, +++ b/docs/en/security/authorization/field-and-document-access-control.asciidoc, +Access to the following meta fields is always allowed: `_id`,, +++ b/plugin/src/main/java/org/elasticsearch/xpack/deprecation/DeprecationChecks.java, +++ b/plugin/src/main/java/org/elasticsearch/xpack/deprecation/IndexDeprecationChecks.java, +++ b/plugin/src/main/java/org/elasticsearch/xpack/security/authz/permission/FieldPermissions.java, +++ b/plugin/src/test/java/org/elasticsearch/xpack/deprecation/IndexDeprecationChecksTests.java, +++ b/docs/en/security/authorization/field-and-document-access-control.asciidoc, +Access to the following meta fields is always allowed: `_id`,, +++ b/plugin/src/main/java/org/elasticsearch/xpack/deprecation/DeprecationChecks.java, +++ b/plugin/src/main/java/org/elasticsearch/xpack/deprecation/IndexDeprecationChecks.java, +++ b/plugin/src/main/java/org/elasticsearch/xpack/security/authz/permission/FieldPermissions.java, +++ b/plugin/src/test/java/org/elasticsearch/xpack/deprecation/IndexDeprecationChecksTests.java, +++ b/plugin/src/test/java/org/elasticsearch/xpack/security/authz/accesscontrol/SecurityIndexSearcherWrapperUnitTests.java, +    private static final Set<String> META_FIELDS;, +        final Set<String> metaFields = new HashSet<>(Arrays.asList(MapperService.getAllMetaFields()));, +        metaFields.add(SourceFieldMapper.NAME);, +        metaFields.add(FieldNamesFieldMapper.NAME);, +        metaFields.add(SeqNoFieldMapper.NAME);, +        META_FIELDS = Collections.unmodifiableSet(metaFields);, +        Set<String> expected = new HashSet<>(META_FIELDS);, +        Set<String> expected = new HashSet<>(META_FIELDS);, +        expected = new HashSet<>(META_FIELDS);, +        Set<String> expected = new HashSet<>(META_FIELDS);, +        Set<String> expected = new HashSet<>(META_FIELDS);, +        deniedFields = META_FIELDS.toArray(new String[0]);, +        expected = new HashSet<>(META_FIELDS);, +        expected = new HashSet<>(META_FIELDS);, +        assertResolved(new FieldPermissions(fieldPermissionDef(grantedFields, deniedFields)), expected, "xfield");, +        assertResolved(new FieldPermissions(fieldPermissionDef(grantedFields, deniedFields)), expected, "xfield");, +        expected = new HashSet<>(META_FIELDS);, +        assertResolved(new FieldPermissions(fieldPermissionDef(grantedFields, deniedFields)), expected, "field1", "field2");, +        expected = new HashSet<>(META_FIELDS);, +        assertResolved(new FieldPermissions(fieldPermissionDef(grantedFields, deniedFields)), expected, "field1", "field2");, +        expected = new HashSet<>(META_FIELDS);, +        assertResolved(new FieldPermissions(fieldPermissionDef(grantedFields, deniedFields)), expected, "field2");, +                META_FIELDS, "field1", "field2");, +                META_FIELDS, "field1", "field2");, +        grantedFields = new String[]{"*"};, +        expected = new HashSet<>(META_FIELDS);, +++ b/docs/en/security/authorization/field-and-document-access-control.asciidoc, +Access to the following meta fields is always allowed: `_id`,, +++ b/plugin/src/main/java/org/elasticsearch/xpack/deprecation/DeprecationChecks.java, +++ b/plugin/src/main/java/org/elasticsearch/xpack/deprecation/IndexDeprecationChecks.java, +++ b/plugin/src/main/java/org/elasticsearch/xpack/security/authz/permission/FieldPermissions.java, +++ b/plugin/src/test/java/org/elasticsearch/xpack/deprecation/IndexDeprecationChecksTests.java, +++ b/plugin/src/test/java/org/elasticsearch/xpack/security/authz/accesscontrol/SecurityIndexSearcherWrapperUnitTests.java, +    private static final Set<String> META_FIELDS;, +        final Set<String> metaFields = new HashSet<>(Arrays.asList(MapperService.getAllMetaFields()));, +        metaFields.add(SourceFieldMapper.NAME);, +        metaFields.add(FieldNamesFieldMapper.NAME);, +        metaFields.add(SeqNoFieldMapper.NAME);, +        META_FIELDS = Collections.unmodifiableSet(metaFields);, +        Set<String> expected = new HashSet<>(META_FIELDS);, +        Set<String> expected = new HashSet<>(META_FIELDS);, +        expected = new HashSet<>(META_FIELDS);, +        Set<String> expected = new HashSet<>(META_FIELDS);, +        Set<String> expected = new HashSet<>(META_FIELDS);, +        deniedFields = META_FIELDS.toArray(new String[0]);, +        expected = new HashSet<>(META_FIELDS);, +        expected = new HashSet<>(META_FIELDS);, +        assertResolved(new FieldPermissions(fieldPermissionDef(grantedFields, deniedFields)), expected, "xfield");, +        assertResolved(new FieldPermissions(fieldPermissionDef(grantedFields, deniedFields)), expected, "xfield");, +        expected = new HashSet<>(META_FIELDS);, +        assertResolved(new FieldPermissions(fieldPermissionDef(grantedFields, deniedFields)), expected, "field1", "field2");, +        expected = new HashSet<>(META_FIELDS);, +        assertResolved(new FieldPermissions(fieldPermissionDef(grantedFields, deniedFields)), expected, "field1", "field2");, +        expected = new HashSet<>(META_FIELDS);, +        assertResolved(new FieldPermissions(fieldPermissionDef(grantedFields, deniedFields)), expected, "field2");, +                META_FIELDS, "field1", "field2");, +                META_FIELDS, "field1", "field2");, +        grantedFields = new String[]{"*"};, +        expected = new HashSet<>(META_FIELDS);, +++ b/plugin/src/test/java/org/elasticsearch/xpack/security/authz/permission/FieldPermissionsCacheTests.java, +++ b/docs/en/security/authorization/field-and-document-access-control.asciidoc, +Access to the following meta fields is always allowed: `_id`,, +++ b/plugin/src/main/java/org/elasticsearch/xpack/deprecation/DeprecationChecks.java, +++ b/plugin/src/main/java/org/elasticsearch/xpack/deprecation/IndexDeprecationChecks.java, +++ b/plugin/src/main/java/org/elasticsearch/xpack/security/authz/permission/FieldPermissions.java, +++ b/plugin/src/test/java/org/elasticsearch/xpack/deprecation/IndexDeprecationChecksTests.java, +++ b/plugin/src/test/java/org/elasticsearch/xpack/security/authz/accesscontrol/SecurityIndexSearcherWrapperUnitTests.java, +    private static final Set<String> META_FIELDS;, +        final Set<String> metaFields = new HashSet<>(Arrays.asList(MapperService.getAllMetaFields()));, +        metaFields.add(SourceFieldMapper.NAME);, +        metaFields.add(FieldNamesFieldMapper.NAME);, +        metaFields.add(SeqNoFieldMapper.NAME);, +        META_FIELDS = Collections.unmodifiableSet(metaFields);]
[+++ b/plugin/src/main/java/org/elasticsearch/xpack/XPackPlugin.java, +        components.addAll(watcher.createComponents(getClock(), scriptService, internalClient, licenseState, threadPool, clusterService,, +                xContentRegistry, sslService));, +        return watcher.getContexts();, +        filters.addAll(watcher.getSettingsFilter());, +        entries.addAll(Monitoring.getNamedWriteables());, +        entries.addAll(Graph.getNamedWriteables());, +++ b/plugin/src/main/java/org/elasticsearch/xpack/XPackPlugin.java, +        components.addAll(watcher.createComponents(getClock(), scriptService, internalClient, licenseState, threadPool, clusterService,, +                xContentRegistry, sslService));, +        return watcher.getContexts();, +        filters.addAll(watcher.getSettingsFilter());, +        entries.addAll(Monitoring.getNamedWriteables());, +        entries.addAll(Graph.getNamedWriteables());, +++ b/plugin/src/main/java/org/elasticsearch/xpack/graph/Graph.java, +import org.elasticsearch.common.io.stream.NamedWriteableRegistry;, +import org.elasticsearch.xpack.XPackFeatureSet;, +import java.util.Arrays;, +import static org.elasticsearch.xpack.XPackPlugin.GRAPH;, +public class Graph implements ActionPlugin {, +, +    public static Collection<? extends NamedWriteableRegistry.Entry> getNamedWriteables() {, +        return Arrays.asList(new NamedWriteableRegistry.Entry(XPackFeatureSet.Usage.class, GRAPH, GraphFeatureSet.Usage::new));, +    }, +++ b/plugin/src/main/java/org/elasticsearch/xpack/XPackPlugin.java, +        components.addAll(watcher.createComponents(getClock(), scriptService, internalClient, licenseState, threadPool, clusterService,, +                xContentRegistry, sslService));, +        return watcher.getContexts();, +        filters.addAll(watcher.getSettingsFilter());, +        entries.addAll(Monitoring.getNamedWriteables());, +        entries.addAll(Graph.getNamedWriteables());, +++ b/plugin/src/main/java/org/elasticsearch/xpack/graph/Graph.java, +import org.elasticsearch.common.io.stream.NamedWriteableRegistry;, +import org.elasticsearch.xpack.XPackFeatureSet;, +import java.util.Arrays;, +import static org.elasticsearch.xpack.XPackPlugin.GRAPH;, +public class Graph implements ActionPlugin {, +, +    public static Collection<? extends NamedWriteableRegistry.Entry> getNamedWriteables() {, +        return Arrays.asList(new NamedWriteableRegistry.Entry(XPackFeatureSet.Usage.class, GRAPH, GraphFeatureSet.Usage::new));, +    }, +++ b/plugin/src/main/java/org/elasticsearch/xpack/ml/MachineLearning.java, +import org.elasticsearch.xpack.XPackFeatureSet;, +import static org.elasticsearch.xpack.XPackPlugin.MACHINE_LEARNING;, +                new NamedWriteableRegistry.Entry(Task.Status.class, DatafeedState.NAME, DatafeedState::fromStream),, +, +                // feature set, +                new NamedWriteableRegistry.Entry(XPackFeatureSet.Usage.class, MACHINE_LEARNING, MachineLearningFeatureSet.Usage::new), +++ b/plugin/src/main/java/org/elasticsearch/xpack/XPackPlugin.java, +        components.addAll(watcher.createComponents(getClock(), scriptService, internalClient, licenseState, threadPool, clusterService,, +                xContentRegistry, sslService));, +        return watcher.getContexts();, +        filters.addAll(watcher.getSettingsFilter());, +        entries.addAll(Monitoring.getNamedWriteables());, +        entries.addAll(Graph.getNamedWriteables());, +++ b/plugin/src/main/java/org/elasticsearch/xpack/graph/Graph.java, +import org.elasticsearch.common.io.stream.NamedWriteableRegistry;, +import org.elasticsearch.xpack.XPackFeatureSet;, +import java.util.Arrays;, +import static org.elasticsearch.xpack.XPackPlugin.GRAPH;, +public class Graph implements ActionPlugin {, +, +    public static Collection<? extends NamedWriteableRegistry.Entry> getNamedWriteables() {, +        return Arrays.asList(new NamedWriteableRegistry.Entry(XPackFeatureSet.Usage.class, GRAPH, GraphFeatureSet.Usage::new));, +    }, +++ b/plugin/src/main/java/org/elasticsearch/xpack/ml/MachineLearning.java, +import org.elasticsearch.xpack.XPackFeatureSet;, +import static org.elasticsearch.xpack.XPackPlugin.MACHINE_LEARNING;, +                new NamedWriteableRegistry.Entry(Task.Status.class, DatafeedState.NAME, DatafeedState::fromStream),, +, +                // feature set, +                new NamedWriteableRegistry.Entry(XPackFeatureSet.Usage.class, MACHINE_LEARNING, MachineLearningFeatureSet.Usage::new), +++ b/plugin/src/main/java/org/elasticsearch/xpack/monitoring/Monitoring.java, +import org.elasticsearch.common.io.stream.NamedWriteableRegistry;, +import org.elasticsearch.xpack.XPackFeatureSet;, +import static org.elasticsearch.xpack.XPackPlugin.MONITORING;, +    public static Collection<? extends NamedWriteableRegistry.Entry> getNamedWriteables() {, +        return Arrays.asList(new NamedWriteableRegistry.Entry(XPackFeatureSet.Usage.class, MONITORING, MonitoringFeatureSet.Usage::new));, +    }, +, +++ b/plugin/src/main/java/org/elasticsearch/xpack/XPackPlugin.java, +        components.addAll(watcher.createComponents(getClock(), scriptService, internalClient, licenseState, threadPool, clusterService,, +                xContentRegistry, sslService));, +        return watcher.getContexts();, +        filters.addAll(watcher.getSettingsFilter());, +        entries.addAll(Monitoring.getNamedWriteables());, +        entries.addAll(Graph.getNamedWriteables());, +++ b/plugin/src/main/java/org/elasticsearch/xpack/graph/Graph.java, +import org.elasticsearch.common.io.stream.NamedWriteableRegistry;, +import org.elasticsearch.xpack.XPackFeatureSet;, +import java.util.Arrays;, +import static org.elasticsearch.xpack.XPackPlugin.GRAPH;, +public class Graph implements ActionPlugin {, +, +    public static Collection<? extends NamedWriteableRegistry.Entry> getNamedWriteables() {, +        return Arrays.asList(new NamedWriteableRegistry.Entry(XPackFeatureSet.Usage.class, GRAPH, GraphFeatureSet.Usage::new));, +    }, +++ b/plugin/src/main/java/org/elasticsearch/xpack/ml/MachineLearning.java, +import org.elasticsearch.xpack.XPackFeatureSet;, +import static org.elasticsearch.xpack.XPackPlugin.MACHINE_LEARNING;]
[+++ b/docs/java-api/aggregations/metrics/scripted-metric-aggregation.asciidoc, +    .initScript(new Script("params._agg.heights = []")), +    .mapScript(new Script("params._agg.heights.add(doc.gender.value == 'male' ? doc.height.value : -1.0 * doc.height.value)"));, +ScriptedMetricAggregationBuilder aggregation = AggregationBuilders, +    .initScript(new Script("params._agg.heights = []")), +    .mapScript(new Script("params._agg.heights.add(doc.gender.value == 'male' ? doc.height.value : -1.0 * doc.height.value)")), +    .combineScript(new Script("double heights_sum = 0.0; for (t in params._agg.heights) { heights_sum += t } return heights_sum"));, +ScriptedMetricAggregationBuilder aggregation = AggregationBuilders, +    .initScript(new Script("params._agg.heights = []")), +    .mapScript(new Script("params._agg.heights.add(doc.gender.value == 'male' ? doc.height.value : -1.0 * doc.height.value)")), +    .combineScript(new Script("double heights_sum = 0.0; for (t in params._agg.heights) { heights_sum += t } return heights_sum")), +    .reduceScript(new Script("double heights_sum = 0.0; for (a in params._aggs) { heights_sum += a } return heights_sum"));]
[+++ b/modules/elasticsearch/src/main/java/org/elasticsearch/index/field/data/strings/StringOrdValFieldDataComparator.java, +        FieldData cleanFieldData = fieldDataCache.cache(FieldData.Type.STRING, reader, field);, +        if (cleanFieldData instanceof MultiValueStringFieldData) {, +            throw new IOException("Can't sort on string types with more than one value per doc, or more than one token per field");, +        }, +        SingleValueStringFieldData fieldData = (SingleValueStringFieldData) cleanFieldData;]
[+++ b/src/main/java/org/elasticsearch/index/mapper/DocumentMapper.java, +import com.google.common.collect.Sets;, +import java.util.*;, +            Set<String> encounteredFields = Sets.newHashSet();, +                encounteredFields.clear();, +                        if (!encounteredFields.contains(field.name())) {, +                            encounteredFields.add(field.name());, +                        }]
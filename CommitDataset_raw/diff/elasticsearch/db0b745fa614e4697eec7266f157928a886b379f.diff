[+++ b/shield/src/main/java/org/elasticsearch/shield/action/ShieldActionFilter.java, +import java.io.IOException;, +    <Response extends ActionResponse> Response sign(Response response) throws IOException {, +            try {, +            } catch (IOException e) {, +                onFailure(e);, +            }, +++ b/shield/src/main/java/org/elasticsearch/shield/action/ShieldActionFilter.java, +import java.io.IOException;, +    <Response extends ActionResponse> Response sign(Response response) throws IOException {, +            try {, +            } catch (IOException e) {, +                onFailure(e);, +            }, +++ b/shield/src/main/java/org/elasticsearch/shield/audit/index/IndexAuditTrail.java, +                try {, +                } catch (IOException e) {, +                    throw new ElasticsearchException("failed to attach user header", e);, +                }, +++ b/shield/src/main/java/org/elasticsearch/shield/action/ShieldActionFilter.java, +import java.io.IOException;, +    <Response extends ActionResponse> Response sign(Response response) throws IOException {, +            try {, +            } catch (IOException e) {, +                onFailure(e);, +            }, +++ b/shield/src/main/java/org/elasticsearch/shield/audit/index/IndexAuditTrail.java, +                try {, +                } catch (IOException e) {, +                    throw new ElasticsearchException("failed to attach user header", e);, +                }, +++ b/shield/src/main/java/org/elasticsearch/shield/authc/AuthenticationService.java, +import java.io.IOException;, +, +    User authenticate(String action, TransportMessage message, User fallbackUser) throws IOException;, +    void attachUserHeaderIfMissing(TransportMessage message, User user) throws IOException;, +++ b/shield/src/main/java/org/elasticsearch/shield/action/ShieldActionFilter.java, +import java.io.IOException;, +    <Response extends ActionResponse> Response sign(Response response) throws IOException {, +            try {, +            } catch (IOException e) {, +                onFailure(e);, +            }, +++ b/shield/src/main/java/org/elasticsearch/shield/audit/index/IndexAuditTrail.java, +                try {, +                } catch (IOException e) {, +                    throw new ElasticsearchException("failed to attach user header", e);, +                }, +++ b/shield/src/main/java/org/elasticsearch/shield/authc/AuthenticationService.java, +import java.io.IOException;, +, +    User authenticate(String action, TransportMessage message, User fallbackUser) throws IOException;, +    void attachUserHeaderIfMissing(TransportMessage message, User user) throws IOException;, +++ b/shield/src/main/java/org/elasticsearch/shield/authc/InternalAuthenticationService.java, +    public User authenticate(String action, TransportMessage message, User fallbackUser) throws IOException {, +    public void attachUserHeaderIfMissing(TransportMessage message, User user) throws IOException {, +++ b/shield/src/main/java/org/elasticsearch/shield/action/ShieldActionFilter.java, +import java.io.IOException;, +    <Response extends ActionResponse> Response sign(Response response) throws IOException {, +            try {, +            } catch (IOException e) {, +                onFailure(e);, +            }, +++ b/shield/src/main/java/org/elasticsearch/shield/audit/index/IndexAuditTrail.java, +                try {, +                } catch (IOException e) {, +                    throw new ElasticsearchException("failed to attach user header", e);, +                }, +++ b/shield/src/main/java/org/elasticsearch/shield/authc/AuthenticationService.java, +import java.io.IOException;, +, +    User authenticate(String action, TransportMessage message, User fallbackUser) throws IOException;, +    void attachUserHeaderIfMissing(TransportMessage message, User user) throws IOException;, +++ b/shield/src/main/java/org/elasticsearch/shield/authc/InternalAuthenticationService.java, +    public User authenticate(String action, TransportMessage message, User fallbackUser) throws IOException {, +    public void attachUserHeaderIfMissing(TransportMessage message, User user) throws IOException {, +++ b/shield/src/main/java/org/elasticsearch/shield/authc/activedirectory/ActiveDirectorySessionFactory.java, +++ b/shield/src/main/java/org/elasticsearch/shield/action/ShieldActionFilter.java, +import java.io.IOException;, +    <Response extends ActionResponse> Response sign(Response response) throws IOException {, +            try {, +            } catch (IOException e) {, +                onFailure(e);, +            }, +++ b/shield/src/main/java/org/elasticsearch/shield/audit/index/IndexAuditTrail.java, +                try {, +                } catch (IOException e) {, +                    throw new ElasticsearchException("failed to attach user header", e);, +                }, +++ b/shield/src/main/java/org/elasticsearch/shield/authc/AuthenticationService.java, +import java.io.IOException;, +, +    User authenticate(String action, TransportMessage message, User fallbackUser) throws IOException;, +    void attachUserHeaderIfMissing(TransportMessage message, User user) throws IOException;, +++ b/shield/src/main/java/org/elasticsearch/shield/authc/InternalAuthenticationService.java, +    public User authenticate(String action, TransportMessage message, User fallbackUser) throws IOException {, +    public void attachUserHeaderIfMissing(TransportMessage message, User user) throws IOException {, +++ b/shield/src/main/java/org/elasticsearch/shield/authc/activedirectory/ActiveDirectorySessionFactory.java, +++ b/shield/src/main/java/org/elasticsearch/shield/authc/ldap/LdapRealm.java, +import org.elasticsearch.ElasticsearchException;]
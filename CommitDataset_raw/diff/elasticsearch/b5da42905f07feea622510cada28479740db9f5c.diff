[+++ b/modules/reindex/src/main/java/org/elasticsearch/index/reindex/TransportReindexAction.java, +            AutoCreateIndex autoCreateIndex, Client client, TransportService transportService) {, +        checkRemoteWhitelist(remoteWhitelist, request.getRemoteInfo());, +    static void checkRemoteWhitelist(CharacterRunAutomaton whitelist, RemoteInfo remoteInfo) {, +++ b/modules/reindex/src/main/java/org/elasticsearch/index/reindex/TransportReindexAction.java, +            AutoCreateIndex autoCreateIndex, Client client, TransportService transportService) {, +        checkRemoteWhitelist(remoteWhitelist, request.getRemoteInfo());, +    static void checkRemoteWhitelist(CharacterRunAutomaton whitelist, RemoteInfo remoteInfo) {, +++ b/modules/reindex/src/test/java/org/elasticsearch/index/reindex/ReindexFromRemoteWhitelistTests.java, +        checkRemoteWhitelist(buildRemoteWhitelist(emptyList()), null);, +        checkRemoteWhitelist(buildRemoteWhitelist(randomWhitelist()), null);, +                new RemoteInfo(randomAsciiOfLength(5), host, port, new BytesArray("test"), null, null, emptyMap()));, +                new RemoteInfo(randomAsciiOfLength(5), "es.example.com", 9200, new BytesArray("test"), null, null, emptyMap()));, +                        new BytesArray("test"), null, null, emptyMap()));, +                new RemoteInfo(randomAsciiOfLength(5), "es.example.com", 9200, new BytesArray("test"), null, null, emptyMap()));, +                new RemoteInfo(randomAsciiOfLength(5), "es1.example.com", 9200, new BytesArray("test"), null, null, emptyMap()));, +                new RemoteInfo(randomAsciiOfLength(5), "127.0.0.1", 9200, new BytesArray("test"), null, null, emptyMap()));, +                () -> checkRemoteWhitelist(buildRemoteWhitelist(whitelist), remoteInfo));]
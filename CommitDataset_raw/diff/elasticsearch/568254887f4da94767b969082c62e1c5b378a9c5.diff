[+++ b/modules/elasticsearch/src/main/java/org/elasticsearch/index/mapper/FieldMapper.java, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/index/mapper/FieldMapper.java, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/index/mapper/MergeMappingException.java, +import java.util.Arrays;, +, +    private final String[] failures;, +, +    public MergeMappingException(String[] failures) {, +        super("Merge failed with failures [" + Arrays.toString(failures) + "]");, +        this.failures = failures;, +    public String[] failures() {, +        return failures;, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/index/mapper/FieldMapper.java, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/index/mapper/MergeMappingException.java, +import java.util.Arrays;, +, +    private final String[] failures;, +, +    public MergeMappingException(String[] failures) {, +        super("Merge failed with failures [" + Arrays.toString(failures) + "]");, +        this.failures = failures;, +    public String[] failures() {, +        return failures;, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/index/mapper/json/JsonBoostFieldMapper.java, +    @Override public void merge(JsonMapper mergeWith, JsonMergeContext mergeContext) throws MergeMappingException {, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/index/mapper/FieldMapper.java, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/index/mapper/MergeMappingException.java, +import java.util.Arrays;, +, +    private final String[] failures;, +, +    public MergeMappingException(String[] failures) {, +        super("Merge failed with failures [" + Arrays.toString(failures) + "]");, +        this.failures = failures;, +    public String[] failures() {, +        return failures;, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/index/mapper/json/JsonBoostFieldMapper.java, +    @Override public void merge(JsonMapper mergeWith, JsonMergeContext mergeContext) throws MergeMappingException {, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/index/mapper/json/JsonDocumentMapper.java, +        JsonMergeContext mergeContext = new JsonMergeContext(this, mergeFlags);, +        rootObjectMapper.merge(jsonMergeWith.rootObjectMapper, mergeContext);, +        if (mergeContext.hasFailures()) {, +            throw new MergeMappingException(mergeContext.buildFailures());, +        }, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/index/mapper/FieldMapper.java, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/index/mapper/MergeMappingException.java, +import java.util.Arrays;, +, +    private final String[] failures;, +, +    public MergeMappingException(String[] failures) {, +        super("Merge failed with failures [" + Arrays.toString(failures) + "]");, +        this.failures = failures;, +    public String[] failures() {, +        return failures;, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/index/mapper/json/JsonBoostFieldMapper.java, +    @Override public void merge(JsonMapper mergeWith, JsonMergeContext mergeContext) throws MergeMappingException {, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/index/mapper/json/JsonDocumentMapper.java, +        JsonMergeContext mergeContext = new JsonMergeContext(this, mergeFlags);, +        rootObjectMapper.merge(jsonMergeWith.rootObjectMapper, mergeContext);, +        if (mergeContext.hasFailures()) {, +            throw new MergeMappingException(mergeContext.buildFailures());, +        }, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/index/mapper/json/JsonFieldMapper.java, +    @Override public void merge(JsonMapper mergeWith, JsonMergeContext mergeContext) throws MergeMappingException {, +        if (mergeContext.mergeFlags().ignoreDuplicates()) {, +        mergeContext.addFailure("Mapper [" + names.fullName() + "] exists, can't merge");, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/index/mapper/FieldMapper.java, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/index/mapper/MergeMappingException.java, +import java.util.Arrays;, +, +    private final String[] failures;, +, +    public MergeMappingException(String[] failures) {, +        super("Merge failed with failures [" + Arrays.toString(failures) + "]");, +        this.failures = failures;, +    public String[] failures() {, +        return failures;, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/index/mapper/json/JsonBoostFieldMapper.java, +    @Override public void merge(JsonMapper mergeWith, JsonMergeContext mergeContext) throws MergeMappingException {, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/index/mapper/json/JsonDocumentMapper.java, +        JsonMergeContext mergeContext = new JsonMergeContext(this, mergeFlags);, +        rootObjectMapper.merge(jsonMergeWith.rootObjectMapper, mergeContext);, +        if (mergeContext.hasFailures()) {, +            throw new MergeMappingException(mergeContext.buildFailures());, +        }, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/index/mapper/json/JsonFieldMapper.java, +    @Override public void merge(JsonMapper mergeWith, JsonMergeContext mergeContext) throws MergeMappingException {, +        if (mergeContext.mergeFlags().ignoreDuplicates()) {, +        mergeContext.addFailure("Mapper [" + names.fullName() + "] exists, can't merge");, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/index/mapper/json/JsonIdFieldMapper.java, +import org.elasticsearch.index.mapper.FieldMapperListener;, +import org.elasticsearch.index.mapper.IdFieldMapper;, +import org.elasticsearch.index.mapper.MapperParsingException;, +import org.elasticsearch.index.mapper.MergeMappingException;, +    @Override public void merge(JsonMapper mergeWith, JsonMergeContext mergeContext) throws MergeMappingException {, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/index/mapper/FieldMapper.java, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/index/mapper/MergeMappingException.java, +import java.util.Arrays;, +]
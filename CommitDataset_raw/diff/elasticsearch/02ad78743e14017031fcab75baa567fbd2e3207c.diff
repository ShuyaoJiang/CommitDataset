[+++ b/src/main/java/org/elasticsearch/watcher/rest/action/RestPutWatchAction.java, +        PutWatchRequest putWatchRequest = new PutWatchRequest(request.param("id"), request.content());, +++ b/src/main/java/org/elasticsearch/watcher/rest/action/RestPutWatchAction.java, +        PutWatchRequest putWatchRequest = new PutWatchRequest(request.param("id"), request.content());, +++ b/src/main/java/org/elasticsearch/watcher/transport/actions/put/PutWatchRequest.java, +        this(id, source.buildAsBytes(XContentType.JSON));, +    public PutWatchRequest(String id, BytesReference source) {, +++ b/src/main/java/org/elasticsearch/watcher/rest/action/RestPutWatchAction.java, +        PutWatchRequest putWatchRequest = new PutWatchRequest(request.param("id"), request.content());, +++ b/src/main/java/org/elasticsearch/watcher/transport/actions/put/PutWatchRequest.java, +        this(id, source.buildAsBytes(XContentType.JSON));, +    public PutWatchRequest(String id, BytesReference source) {, +++ b/src/main/java/org/elasticsearch/watcher/transport/actions/put/TransportPutWatchAction.java, +++ b/src/main/java/org/elasticsearch/watcher/rest/action/RestPutWatchAction.java, +        PutWatchRequest putWatchRequest = new PutWatchRequest(request.param("id"), request.content());, +++ b/src/main/java/org/elasticsearch/watcher/transport/actions/put/PutWatchRequest.java, +        this(id, source.buildAsBytes(XContentType.JSON));, +    public PutWatchRequest(String id, BytesReference source) {, +++ b/src/main/java/org/elasticsearch/watcher/transport/actions/put/TransportPutWatchAction.java, +++ b/src/test/java/org/elasticsearch/watcher/input/search/SearchInputTests.java, +import org.elasticsearch.script.ScriptService;, +import org.elasticsearch.watcher.support.init.proxy.ScriptServiceProxy;, +import java.util.*;, +import static org.hamcrest.Matchers.equalTo;, +import static org.hamcrest.Matchers.is;, +import static org.hamcrest.Matchers.startsWith;, +        assertThat(executedResult.executedRequest().templateSource().toUtf8(), equalTo(expectedQuery));, +++ b/src/main/java/org/elasticsearch/watcher/rest/action/RestPutWatchAction.java, +        PutWatchRequest putWatchRequest = new PutWatchRequest(request.param("id"), request.content());, +++ b/src/main/java/org/elasticsearch/watcher/transport/actions/put/PutWatchRequest.java, +        this(id, source.buildAsBytes(XContentType.JSON));, +    public PutWatchRequest(String id, BytesReference source) {, +++ b/src/main/java/org/elasticsearch/watcher/transport/actions/put/TransportPutWatchAction.java, +++ b/src/test/java/org/elasticsearch/watcher/input/search/SearchInputTests.java, +import org.elasticsearch.script.ScriptService;, +import org.elasticsearch.watcher.support.init.proxy.ScriptServiceProxy;, +import java.util.*;, +import static org.hamcrest.Matchers.equalTo;, +import static org.hamcrest.Matchers.is;, +import static org.hamcrest.Matchers.startsWith;, +        assertThat(executedResult.executedRequest().templateSource().toUtf8(), equalTo(expectedQuery));, +++ b/src/test/java/org/elasticsearch/watcher/test/WatcherTestUtils.java, +++ b/src/main/java/org/elasticsearch/watcher/rest/action/RestPutWatchAction.java, +        PutWatchRequest putWatchRequest = new PutWatchRequest(request.param("id"), request.content());, +++ b/src/main/java/org/elasticsearch/watcher/transport/actions/put/PutWatchRequest.java, +        this(id, source.buildAsBytes(XContentType.JSON));, +    public PutWatchRequest(String id, BytesReference source) {, +++ b/src/main/java/org/elasticsearch/watcher/transport/actions/put/TransportPutWatchAction.java, +++ b/src/test/java/org/elasticsearch/watcher/input/search/SearchInputTests.java, +import org.elasticsearch.script.ScriptService;, +import org.elasticsearch.watcher.support.init.proxy.ScriptServiceProxy;, +import java.util.*;, +import static org.hamcrest.Matchers.equalTo;, +import static org.hamcrest.Matchers.is;, +import static org.hamcrest.Matchers.startsWith;, +        assertThat(executedResult.executedRequest().templateSource().toUtf8(), equalTo(expectedQuery));, +++ b/src/test/java/org/elasticsearch/watcher/test/WatcherTestUtils.java, +++ b/src/test/java/org/elasticsearch/watcher/transform/search/SearchTransformTests.java, +import org.elasticsearch.script.ScriptService;, +import org.elasticsearch.watcher.test.AbstractWatcherIntegrationTests;, +import java.util.*;, +        assertThat(executedResult.executedRequest().templateSource().toUtf8(), equalTo(expectedQuery));]
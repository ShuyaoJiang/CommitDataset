[+++ b/src/main/java/org/elasticsearch/cluster/service/InternalClusterService.java, +, +        private ConcurrentMap<DiscoveryNode, Integer> failureCount = ConcurrentCollections.newConcurrentMap();, +, +                                Integer nodeFailureCount = failureCount.get(node);, +                                if (nodeFailureCount == null) {, +                                    nodeFailureCount = 1;, +                                } else {, +                                    nodeFailureCount = nodeFailureCount + 1;, +                                }, +                                // log every 6th failure, +                                if ((nodeFailureCount % 6) == 0) {, +                                    // reset the failure count..., +                                    nodeFailureCount = 0;, +                                failureCount.put(node, nodeFailureCount);, +            }, +            // go over and remove failed nodes that have been removed, +            DiscoveryNodes nodes = clusterState.nodes();, +            for (Iterator<DiscoveryNode> failedNodesIt = failureCount.keySet().iterator(); failedNodesIt.hasNext(); ) {, +                DiscoveryNode failedNode = failedNodesIt.next();, +                if (!nodes.nodeExists(failedNode.id())) {, +                    failedNodesIt.remove();, +                }, +            }]
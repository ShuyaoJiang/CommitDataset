[+++ b/client/rest-high-level/src/main/java/org/elasticsearch/client/Request.java, +                BytesRef metadataSource = BytesReference.bytes(metadata).toBytesRef();, +                        source = BytesReference.bytes(builder).toBytesRef();, +++ b/client/rest-high-level/src/main/java/org/elasticsearch/client/Request.java, +                BytesRef metadataSource = BytesReference.bytes(metadata).toBytesRef();, +                        source = BytesReference.bytes(builder).toBytesRef();, +++ b/client/rest-high-level/src/test/java/org/elasticsearch/client/CrudIT.java, +                BytesReference source = BytesReference.bytes(XContentBuilder.builder(xContentType.xContent()), +                        .startObject().field("id", i).endObject());, +++ b/client/rest-high-level/src/main/java/org/elasticsearch/client/Request.java, +                BytesRef metadataSource = BytesReference.bytes(metadata).toBytesRef();, +                        source = BytesReference.bytes(builder).toBytesRef();, +++ b/client/rest-high-level/src/test/java/org/elasticsearch/client/CrudIT.java, +                BytesReference source = BytesReference.bytes(XContentBuilder.builder(xContentType.xContent()), +                        .startObject().field("id", i).endObject());, +++ b/client/rest-high-level/src/test/java/org/elasticsearch/client/RestHighLevelClientTests.java, +import org.elasticsearch.common.bytes.BytesReference;, +            return new ByteArrayEntity(BytesReference.bytes(builder).toBytesRef().bytes, contentType);, +++ b/client/rest-high-level/src/main/java/org/elasticsearch/client/Request.java, +                BytesRef metadataSource = BytesReference.bytes(metadata).toBytesRef();, +                        source = BytesReference.bytes(builder).toBytesRef();, +++ b/client/rest-high-level/src/test/java/org/elasticsearch/client/CrudIT.java, +                BytesReference source = BytesReference.bytes(XContentBuilder.builder(xContentType.xContent()), +                        .startObject().field("id", i).endObject());, +++ b/client/rest-high-level/src/test/java/org/elasticsearch/client/RestHighLevelClientTests.java, +import org.elasticsearch.common.bytes.BytesReference;, +            return new ByteArrayEntity(BytesReference.bytes(builder).toBytesRef().bytes, contentType);, +++ b/client/rest-high-level/src/test/java/org/elasticsearch/client/SearchIT.java, +import org.elasticsearch.common.Strings;, +            HttpEntity entity = new NStringEntity(Strings.toString(builder), ContentType.APPLICATION_JSON);, +++ b/client/rest-high-level/src/main/java/org/elasticsearch/client/Request.java, +                BytesRef metadataSource = BytesReference.bytes(metadata).toBytesRef();, +                        source = BytesReference.bytes(builder).toBytesRef();, +++ b/client/rest-high-level/src/test/java/org/elasticsearch/client/CrudIT.java, +                BytesReference source = BytesReference.bytes(XContentBuilder.builder(xContentType.xContent()), +                        .startObject().field("id", i).endObject());, +++ b/client/rest-high-level/src/test/java/org/elasticsearch/client/RestHighLevelClientTests.java, +import org.elasticsearch.common.bytes.BytesReference;, +            return new ByteArrayEntity(BytesReference.bytes(builder).toBytesRef().bytes, contentType);, +++ b/client/rest-high-level/src/test/java/org/elasticsearch/client/SearchIT.java, +import org.elasticsearch.common.Strings;, +            HttpEntity entity = new NStringEntity(Strings.toString(builder), ContentType.APPLICATION_JSON);, +++ b/client/rest-high-level/src/test/java/org/elasticsearch/client/documentation/CRUDDocumentationIT.java, +            String script = Strings.toString(XContentBuilder.builder(xContentType.xContent()), +                    .endObject());, +++ b/client/rest-high-level/src/main/java/org/elasticsearch/client/Request.java, +                BytesRef metadataSource = BytesReference.bytes(metadata).toBytesRef();, +                        source = BytesReference.bytes(builder).toBytesRef();, +++ b/client/rest-high-level/src/test/java/org/elasticsearch/client/CrudIT.java, +                BytesReference source = BytesReference.bytes(XContentBuilder.builder(xContentType.xContent()), +                        .startObject().field("id", i).endObject());, +++ b/client/rest-high-level/src/test/java/org/elasticsearch/client/RestHighLevelClientTests.java, +import org.elasticsearch.common.bytes.BytesReference;, +            return new ByteArrayEntity(BytesReference.bytes(builder).toBytesRef().bytes, contentType);, +++ b/client/rest-high-level/src/test/java/org/elasticsearch/client/SearchIT.java, +import org.elasticsearch.common.Strings;, +            HttpEntity entity = new NStringEntity(Strings.toString(builder), ContentType.APPLICATION_JSON);, +++ b/client/rest-high-level/src/test/java/org/elasticsearch/client/documentation/CRUDDocumentationIT.java, +            String script = Strings.toString(XContentBuilder.builder(xContentType.xContent()), +                    .endObject());, +++ b/client/rest-high-level/src/test/java/org/elasticsearch/client/documentation/MigrationDocumentationIT.java, +import org.elasticsearch.common.Strings;, +            String payload = Strings.toString(XContentFactory.jsonBuilder() // <2>, +                    .endObject());, +++ b/client/rest-high-level/src/main/java/org/elasticsearch/client/Request.java, +                BytesRef metadataSource = BytesReference.bytes(metadata).toBytesRef();, +                        source = BytesReference.bytes(builder).toBytesRef();, +++ b/client/rest-high-level/src/test/java/org/elasticsearch/client/CrudIT.java, +                BytesReference source = BytesReference.bytes(XContentBuilder.builder(xContentType.xContent()), +                        .startObject().field("id", i).endObject());, +++ b/client/rest-high-level/src/test/java/org/elasticsearch/client/RestHighLevelClientTests.java, +import org.elasticsearch.common.bytes.BytesReference;, +            return new ByteArrayEntity(BytesReference.bytes(builder).toBytesRef().bytes, contentType);, +++ b/client/rest-high-level/src/test/java/org/elasticsearch/client/SearchIT.java, +import org.elasticsearch.common.Strings;, +            HttpEntity entity = new NStringEntity(Strings.toString(builder), ContentType.APPLICATION_JSON);, +++ b/client/rest-high-level/src/test/java/org/elasticsearch/client/documentation/CRUDDocumentationIT.java, +            String script = Strings.toString(XContentBuilder.builder(xContentType.xContent()), +                    .endObject());, +++ b/client/rest-high-level/src/test/java/org/elasticsearch/client/documentation/MigrationDocumentationIT.java, +import org.elasticsearch.common.Strings;, +            String payload = Strings.toString(XContentFactory.jsonBuilder() // <2>, +                    .endObject());, +++ b/modules/ingest-common/src/main/java/org/elasticsearch/ingest/common/ScriptProcessor.java, +import org.elasticsearch.common.bytes.BytesReference;, +                 InputStream stream = BytesReference.bytes(builder).streamInput();, +++ b/client/rest-high-level/src/main/java/org/elasticsearch/client/Request.java, +                BytesRef metadataSource = BytesReference.bytes(metadata).toBytesRef();, +                        source = BytesReference.bytes(builder).toBytesRef();, +++ b/client/rest-high-level/src/test/java/org/elasticsearch/client/CrudIT.java, +                BytesReference source = BytesReference.bytes(XContentBuilder.builder(xContentType.xContent()), +                        .startObject().field("id", i).endObject());, +++ b/client/rest-high-level/src/test/java/org/elasticsearch/client/RestHighLevelClientTests.java, +import org.elasticsearch.common.bytes.BytesReference;, +            return new ByteArrayEntity(BytesReference.bytes(builder).toBytesRef().bytes, contentType);, +++ b/client/rest-high-level/src/test/java/org/elasticsearch/client/SearchIT.java, +import org.elasticsearch.common.Strings;, +            HttpEntity entity = new NStringEntity(Strings.toString(builder), ContentType.APPLICATION_JSON);, +++ b/client/rest-high-level/src/test/java/org/elasticsearch/client/documentation/CRUDDocumentationIT.java, +            String script = Strings.toString(XContentBuilder.builder(xContentType.xContent())]
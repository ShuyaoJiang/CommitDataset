[+++ b/src/test/java/org/elasticsearch/test/integration/nested/SimpleNestedTests.java, +import org.elasticsearch.search.facet.statistical.StatisticalFacet;, +                .addFacet(FacetBuilders.statisticalFacet("facet2").field("field2_2").nested("nested1.nested2")), +                .addFacet(FacetBuilders.statisticalFacet("facet2_blue").field("field2_2").nested("nested1.nested2"), +                .facetFilter(boolFilter().must(termFilter("field2_1", "blue")))), +        StatisticalFacet statsFacet = searchResponse.getFacets().facet("facet2");, +        assertThat(statsFacet.getCount(), equalTo(8l));, +        assertThat(statsFacet.getMin(), equalTo(1d));, +        assertThat(statsFacet.getMax(), equalTo(12d));, +        assertThat(statsFacet.getTotal(), equalTo(47d));, +, +        StatisticalFacet blueFacet = searchResponse.getFacets().facet("facet2_blue");, +        assertThat(blueFacet.getCount(), equalTo(3l));, +        assertThat(blueFacet.getMin(), equalTo(1d));, +        assertThat(blueFacet.getMax(), equalTo(5d));, +        assertThat(blueFacet.getTotal(), equalTo(8d));, +, +        // TODO: needed?, +        refresh();, +]
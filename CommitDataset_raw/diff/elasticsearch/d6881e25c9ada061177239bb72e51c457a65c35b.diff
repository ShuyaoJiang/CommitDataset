[+++ b/qa/sql/src/main/java/org/elasticsearch/xpack/qa/sql/embed/CliProtoHandler.java, +        super(client);, +++ b/qa/sql/src/main/java/org/elasticsearch/xpack/qa/sql/embed/CliProtoHandler.java, +        super(client);, +++ b/qa/sql/src/main/java/org/elasticsearch/xpack/qa/sql/embed/EmbeddedModeFilterClient.java, +import java.util.Objects;, +, +    private PlanExecutor planExecutor;, +    public EmbeddedModeFilterClient(Client in) {, +    }, +, +    public void setPlanExecutor(PlanExecutor executor) {, +        this.planExecutor = executor;, +        Objects.requireNonNull(planExecutor, "plan executor not set on EmbeddedClient");, +        , +++ b/qa/sql/src/main/java/org/elasticsearch/xpack/qa/sql/embed/CliProtoHandler.java, +        super(client);, +++ b/qa/sql/src/main/java/org/elasticsearch/xpack/qa/sql/embed/EmbeddedModeFilterClient.java, +import java.util.Objects;, +, +    private PlanExecutor planExecutor;, +    public EmbeddedModeFilterClient(Client in) {, +    }, +, +    public void setPlanExecutor(PlanExecutor executor) {, +        this.planExecutor = executor;, +        Objects.requireNonNull(planExecutor, "plan executor not set on EmbeddedClient");, +        , +++ b/qa/sql/src/main/java/org/elasticsearch/xpack/qa/sql/embed/JdbcProtoHandler.java, +        super(client);, +++ b/qa/sql/src/main/java/org/elasticsearch/xpack/qa/sql/embed/CliProtoHandler.java, +        super(client);, +++ b/qa/sql/src/main/java/org/elasticsearch/xpack/qa/sql/embed/EmbeddedModeFilterClient.java, +import java.util.Objects;, +, +    private PlanExecutor planExecutor;, +    public EmbeddedModeFilterClient(Client in) {, +    }, +, +    public void setPlanExecutor(PlanExecutor executor) {, +        this.planExecutor = executor;, +        Objects.requireNonNull(planExecutor, "plan executor not set on EmbeddedClient");, +        , +++ b/qa/sql/src/main/java/org/elasticsearch/xpack/qa/sql/embed/JdbcProtoHandler.java, +        super(client);, +++ b/qa/sql/src/main/java/org/elasticsearch/xpack/qa/sql/embed/ProtoHandler.java, +    private static PlanExecutor planExecutor(EmbeddedModeFilterClient client) {, +    protected final EmbeddedModeFilterClient client;, +        this.client = !(client instanceof EmbeddedModeFilterClient) ? new EmbeddedModeFilterClient(client) : (EmbeddedModeFilterClient) client;, +        this.client.setPlanExecutor(planExecutor(this.client));]
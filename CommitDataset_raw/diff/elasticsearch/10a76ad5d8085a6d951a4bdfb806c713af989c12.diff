[+++ b/src/main/java/org/elasticsearch/index/cache/filter/weighted/WeightedFilterCache.java, +                    if (previous == null) {, +                        // we add a core closed listener only, for non core IndexReaders we rely on clear being called (percolator for example), +                        if (context.reader() instanceof SegmentReader) {, +                            ((SegmentReader) context.reader()).addCoreClosedListener(cache);, +                        }]
[+++ b/core/src/main/java/org/elasticsearch/common/settings/IndexScopedSettings.java, +        IndexSettings.MAX_SLICES_PER_SCROLL,, +++ b/core/src/main/java/org/elasticsearch/common/settings/IndexScopedSettings.java, +        IndexSettings.MAX_SLICES_PER_SCROLL,, +++ b/core/src/main/java/org/elasticsearch/index/IndexSettings.java, +    /**, +     * The maximum number of slices allowed in a scroll request, +     */, +    public static final Setting<Integer> MAX_SLICES_PER_SCROLL = Setting.intSetting("index.max_slices_per_scroll",, +        1024, 1, Property.Dynamic, Property.IndexScope);, +, +    /**, +     * The maximum number of slices allowed in a scroll request., +     */, +    private volatile int maxSlicesPerScroll;, +, +        maxSlicesPerScroll = scopedSettings.get(MAX_SLICES_PER_SCROLL);, +        scopedSettings.addSettingsUpdateConsumer(MAX_SLICES_PER_SCROLL, this::setMaxSlicesPerScroll);, +    /**, +     * The maximum number of slices allowed in a scroll request., +     */, +    public int getMaxSlicesPerScroll() {, +        return maxSlicesPerScroll;, +    }, +, +    private void setMaxSlicesPerScroll(int value) {, +        this.maxSlicesPerScroll = value;, +    }, +, +++ b/core/src/main/java/org/elasticsearch/common/settings/IndexScopedSettings.java, +        IndexSettings.MAX_SLICES_PER_SCROLL,, +++ b/core/src/main/java/org/elasticsearch/index/IndexSettings.java, +    /**, +     * The maximum number of slices allowed in a scroll request, +     */, +    public static final Setting<Integer> MAX_SLICES_PER_SCROLL = Setting.intSetting("index.max_slices_per_scroll",, +        1024, 1, Property.Dynamic, Property.IndexScope);, +, +    /**, +     * The maximum number of slices allowed in a scroll request., +     */, +    private volatile int maxSlicesPerScroll;, +, +        maxSlicesPerScroll = scopedSettings.get(MAX_SLICES_PER_SCROLL);, +        scopedSettings.addSettingsUpdateConsumer(MAX_SLICES_PER_SCROLL, this::setMaxSlicesPerScroll);, +    /**, +     * The maximum number of slices allowed in a scroll request., +     */, +    public int getMaxSlicesPerScroll() {, +        return maxSlicesPerScroll;, +    }, +, +    private void setMaxSlicesPerScroll(int value) {, +        this.maxSlicesPerScroll = value;, +    }, +, +++ b/core/src/main/java/org/elasticsearch/search/SearchService.java, +            context.sliceBuilder(source.slice());, +++ b/core/src/main/java/org/elasticsearch/common/settings/IndexScopedSettings.java, +        IndexSettings.MAX_SLICES_PER_SCROLL,, +++ b/core/src/main/java/org/elasticsearch/index/IndexSettings.java, +    /**, +     * The maximum number of slices allowed in a scroll request, +     */, +    public static final Setting<Integer> MAX_SLICES_PER_SCROLL = Setting.intSetting("index.max_slices_per_scroll",, +        1024, 1, Property.Dynamic, Property.IndexScope);, +, +    /**, +     * The maximum number of slices allowed in a scroll request., +     */, +    private volatile int maxSlicesPerScroll;, +, +        maxSlicesPerScroll = scopedSettings.get(MAX_SLICES_PER_SCROLL);, +        scopedSettings.addSettingsUpdateConsumer(MAX_SLICES_PER_SCROLL, this::setMaxSlicesPerScroll);, +    /**, +     * The maximum number of slices allowed in a scroll request., +     */, +    public int getMaxSlicesPerScroll() {, +        return maxSlicesPerScroll;, +    }, +, +    private void setMaxSlicesPerScroll(int value) {, +        this.maxSlicesPerScroll = value;, +    }, +, +++ b/core/src/main/java/org/elasticsearch/search/SearchService.java, +            context.sliceBuilder(source.slice());, +++ b/core/src/main/java/org/elasticsearch/search/internal/DefaultSearchContext.java, +import org.elasticsearch.search.slice.SliceBuilder;, +    private SliceBuilder sliceBuilder;, +                            + "rescored. This limit can be set by changing the [" + IndexSettings.MAX_RESCORE_WINDOW_SETTING.getKey(), +        if (sliceBuilder != null) {, +            int sliceLimit = indexService.getIndexSettings().getMaxSlicesPerScroll();, +            int numSlices = sliceBuilder.getMax();, +            if (numSlices > sliceLimit) {, +                throw new QueryPhaseExecutionException(this, "The number of slices [" + numSlices + "] is too large. It must ", +                    + "be less than [" + sliceLimit + "]. This limit can be set by changing the [" +, +                    IndexSettings.MAX_SLICES_PER_SCROLL.getKey() + "] index level setting.");, +            }, +        }]
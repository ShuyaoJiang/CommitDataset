[+++ b/core/src/main/java/org/elasticsearch/bootstrap/ESPolicy.java, +    /** limited policy for groovy scripts */, +    static final String GROOVY_RESOURCE = "groovy.policy";, +    final Policy groovy;, +        URI policyUri = getClass().getResource(POLICY_RESOURCE).toURI();, +        URI groovyUri = getClass().getResource(GROOVY_RESOURCE).toURI();, +        this.template = Policy.getInstance("JavaPolicy", new URIParameter(policyUri));, +        this.groovy = Policy.getInstance("JavaPolicy", new URIParameter(groovyUri));, +                    return groovy.implies(domain, permission);, +++ b/core/src/main/java/org/elasticsearch/bootstrap/ESPolicy.java, +    /** limited policy for groovy scripts */, +    static final String GROOVY_RESOURCE = "groovy.policy";, +    final Policy groovy;, +        URI policyUri = getClass().getResource(POLICY_RESOURCE).toURI();, +        URI groovyUri = getClass().getResource(GROOVY_RESOURCE).toURI();, +        this.template = Policy.getInstance("JavaPolicy", new URIParameter(policyUri));, +        this.groovy = Policy.getInstance("JavaPolicy", new URIParameter(groovyUri));, +                    return groovy.implies(domain, permission);, +++ b/core/src/main/resources/org/elasticsearch/bootstrap/groovy.policy, +/*, + * Licensed to Elasticsearch under one or more contributor, + * license agreements. See the NOTICE file distributed with, + * this work for additional information regarding copyright, + * ownership. Elasticsearch licenses this file to you under, + * the Apache License, Version 2.0 (the "License"); you may, + * not use this file except in compliance with the License., + * You may obtain a copy of the License at, + *, + *    http://www.apache.org/licenses/LICENSE-2.0, + *, + * Unless required by applicable law or agreed to in writing,, + * software distributed under the License is distributed on an, + * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY, + * KIND, either express or implied.  See the License for the, + * specific language governing permissions and limitations, + * under the License., + */, + , +/*, + * Limited security policy for groovy scripts., + * This is what is needed for its invokeDynamic functionality to work., + */, +grant {, +  , +  // groovy IndyInterface bootstrap requires this property for indy logging, +  permission java.util.PropertyPermission "groovy.indy.logging", "read";, +  , +  // needed IndyInterface selectMethod (setCallSiteTarget), +  permission java.lang.RuntimePermission "getClassLoader";, +};]
[+++ b/src/main/java/org/elasticsearch/index/search/child/ChildrenQuery.java, +// TODO We use a score of 0 to indicate a doc was not scored in uidToScore, this means score of 0 can be problematic, if we move to HPCC, we can use lset/..., +                if (currentScore != 0) {, +            if (currentScore != 0) {, +                if (currentScore != 0) {, +, +        @Override, +        public int advance(int target) throws IOException {, +            currentDocId = parentsIterator.advance(target);, +            if (currentDocId == DocIdSetIterator.NO_MORE_DOCS) {, +                return currentDocId;, +            }, +, +            HashedBytesArray uid = idTypeCache.idByDoc(currentDocId);, +            currentScore = uidToScore.get(uid);, +            if (currentScore != 0) {, +                currentScore /= uidToCount.get(currentUid);, +                return currentDocId;, +            } else {, +                return nextDoc();, +            }, +        }, +            if (previousScore == 0) {, +                        if (currentScore > previousScore) {, +            if (previousScore == 0) {, +++ b/src/main/java/org/elasticsearch/index/search/child/ChildrenQuery.java, +// TODO We use a score of 0 to indicate a doc was not scored in uidToScore, this means score of 0 can be problematic, if we move to HPCC, we can use lset/..., +                if (currentScore != 0) {, +            if (currentScore != 0) {, +                if (currentScore != 0) {, +, +        @Override, +        public int advance(int target) throws IOException {, +            currentDocId = parentsIterator.advance(target);, +            if (currentDocId == DocIdSetIterator.NO_MORE_DOCS) {, +                return currentDocId;, +            }, +, +            HashedBytesArray uid = idTypeCache.idByDoc(currentDocId);, +            currentScore = uidToScore.get(uid);, +            if (currentScore != 0) {, +                currentScore /= uidToCount.get(currentUid);, +                return currentDocId;, +            } else {, +                return nextDoc();, +            }, +        }, +            if (previousScore == 0) {, +                        if (currentScore > previousScore) {, +            if (previousScore == 0) {, +++ b/src/main/java/org/elasticsearch/index/search/child/ParentQuery.java, +// TODO We use a score of 0 to indicate a doc was not scored in uidToScore, this means score of 0 can be problematic, if we move to HPCC, we can use lset/..., +                if (currentScore != 0) {, +            if (currentScore == 0) {]
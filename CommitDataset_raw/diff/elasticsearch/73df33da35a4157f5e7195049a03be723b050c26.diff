[+++ b/x-pack/plugin/data-frame/src/test/java/org/elasticsearch/xpack/dataframe/checkpoint/DataFrameTransformsCheckpointServiceTests.java, +                int primaryShard = 0;, +                if (skipPrimaries) {, +                    primaryShard = randomInt(numShardCopies - 1);, +                }, +                    List<Integer> replicas = new ArrayList<>(numShardCopies - 1);, +                    for (int i = 0; i < numShardCopies; i++) {, +                        if (primaryShard != i) {, +                            replicas.add(i);, +                        }, +                    }, +                    inconsistentReplica = randomFrom(replicas);, +                    boolean primary = (replica == primaryShard);]
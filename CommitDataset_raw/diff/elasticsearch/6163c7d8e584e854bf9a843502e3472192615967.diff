[+++ b/src/main/java/org/elasticsearch/index/shard/IndexShardState.java, +    private static final IndexShardState[] IDS = new IndexShardState[IndexShardState.values().length];, +            assert state.id() < IDS.length && state.id() >= 0;, +            IDS[state.id()] = state;, +        if (id < 0 || id >= IDS.length) {, +        return IDS[id];]
[+++ b/core/src/main/java/org/elasticsearch/indices/IndexingMemoryController.java, +import org.elasticsearch.index.translog.Translog;, +        recordOperationBytes(index);, +        recordOperationBytes(delete);, +    }, +, +    private void recordOperationBytes(Engine.Operation op) {, +        Translog.Location loc = op.getTranslogLocation();, +        // This can be null on (harmless) version conflict during recovery:, +        if (loc != null) {, +            bytesWritten(loc.size);, +        }, +++ b/core/src/main/java/org/elasticsearch/indices/IndexingMemoryController.java, +import org.elasticsearch.index.translog.Translog;, +        recordOperationBytes(index);, +        recordOperationBytes(delete);, +    }, +, +    private void recordOperationBytes(Engine.Operation op) {, +        Translog.Location loc = op.getTranslogLocation();, +        // This can be null on (harmless) version conflict during recovery:, +        if (loc != null) {, +            bytesWritten(loc.size);, +        }, +++ b/core/src/test/java/org/elasticsearch/search/query/SimpleQueryStringIT.java, +, +    public void testSimpleQueryStringUsesFieldAnalyzer() throws Exception {, +        client().prepareIndex("test", "type1", "1").setSource("foo", 123, "bar", "abc").get();, +        client().prepareIndex("test", "type1", "2").setSource("foo", 234, "bar", "bcd").get();, +, +        refresh();, +, +        SearchResponse searchResponse = client().prepareSearch().setQuery(, +                simpleQueryStringQuery("123").field("foo").field("bar")).get();, +        assertHitCount(searchResponse, 1L);, +        assertSearchHits(searchResponse, "1");, +    }]
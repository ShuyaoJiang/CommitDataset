[+++ b/src/test/java/org/elasticsearch/test/InternalTestCluster.java, +        void closeNode() {, +            registerDataPath();, +            node.close();, +        }, +, +                closeNode();, +                    IOUtils.rm(nodeEnv.nodeDataPaths());, +        void registerDataPath() {, +            NodeEnvironment nodeEnv = getInstanceFromNode(NodeEnvironment.class, node);, +            if (nodeEnv.hasNodeFile()) {, +                dataDirToClean.addAll(Arrays.asList(nodeEnv.nodeDataPaths()));, +            }, +        }, +, +            closeNode();, +                nodeAndClient.closeNode();, +            dataDirToClean.addAll(Arrays.asList(nodeEnv.nodeDataPaths()));]
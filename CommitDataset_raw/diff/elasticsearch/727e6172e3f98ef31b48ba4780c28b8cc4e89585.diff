[+++ b/src/main/java/org/elasticsearch/cluster/routing/PlainShardsIterator.java, +    // Calls to nextOrNull might be performed on different threads in the transport actions so we need the volatile, +    // keyword in order to ensure visibility. Note that it is fine to use `volatile` for a counter in that case given, +    // that although nextOrNull might be called from different threads, it can never happen concurrently., +    private volatile int index;, +        reset();, +        index = 0;, +        return shards.size() - index;, +        if (index == shards.size()) {, +        } else {, +            return shards.get(index++);]
[+++ b/rest-api-spec/src/main/resources/rest-api-spec/api/delete.json, +        "if_seq_no" : {, +        "if_primary_term" : {, +++ b/rest-api-spec/src/main/resources/rest-api-spec/api/delete.json, +        "if_seq_no" : {, +        "if_primary_term" : {, +++ b/rest-api-spec/src/main/resources/rest-api-spec/api/index.json, +        "if_seq_no" : {, +        "if_primary_term" : {, +++ b/rest-api-spec/src/main/resources/rest-api-spec/api/delete.json, +        "if_seq_no" : {, +        "if_primary_term" : {, +++ b/rest-api-spec/src/main/resources/rest-api-spec/api/index.json, +        "if_seq_no" : {, +        "if_primary_term" : {, +++ b/rest-api-spec/src/main/resources/rest-api-spec/test/index/30_cas.yml, +          if_seq_no:       10000, +          if_primary_term: $primary_term, +          if_seq_no:       $seqno, +          if_primary_term: 1000, +          if_seq_no:       $seqno, +          if_primary_term: $primary_term, +++ b/rest-api-spec/src/main/resources/rest-api-spec/api/delete.json, +        "if_seq_no" : {, +        "if_primary_term" : {, +++ b/rest-api-spec/src/main/resources/rest-api-spec/api/index.json, +        "if_seq_no" : {, +        "if_primary_term" : {, +++ b/rest-api-spec/src/main/resources/rest-api-spec/test/index/30_cas.yml, +          if_seq_no:       10000, +          if_primary_term: $primary_term, +          if_seq_no:       $seqno, +          if_primary_term: 1000, +          if_seq_no:       $seqno, +          if_primary_term: $primary_term, +++ b/server/src/main/java/org/elasticsearch/action/bulk/BulkRequest.java, +    private static final ParseField IF_SEQ_NO = new ParseField("if_seq_no");, +    private static final ParseField IF_PRIMARY_TERM = new ParseField("if_primary_term");, +                long ifSeqNo = SequenceNumbers.UNASSIGNED_SEQ_NO;, +                long ifPrimaryTerm = 0;, +                            } else if (IF_SEQ_NO.match(currentFieldName, parser.getDeprecationHandler())) {, +                                ifSeqNo = parser.longValue();, +                            } else if (IF_PRIMARY_TERM.match(currentFieldName, parser.getDeprecationHandler())) {, +                                ifPrimaryTerm = parser.longValue();, +                        .version(version).versionType(versionType).setIfSeqNo(ifSeqNo).setIfPrimaryTerm(ifPrimaryTerm), payload);, +                                    .setPipeline(pipeline).setIfSeqNo(ifSeqNo).setIfPrimaryTerm(ifPrimaryTerm), +                                    .create("create".equals(opType)).setPipeline(pipeline), +                                    .setIfSeqNo(ifSeqNo).setIfPrimaryTerm(ifPrimaryTerm), +                                .create(true).setPipeline(pipeline).setIfSeqNo(ifSeqNo).setIfPrimaryTerm(ifPrimaryTerm), +++ b/rest-api-spec/src/main/resources/rest-api-spec/api/delete.json, +        "if_seq_no" : {, +        "if_primary_term" : {, +++ b/rest-api-spec/src/main/resources/rest-api-spec/api/index.json, +        "if_seq_no" : {, +        "if_primary_term" : {, +++ b/rest-api-spec/src/main/resources/rest-api-spec/test/index/30_cas.yml, +          if_seq_no:       10000, +          if_primary_term: $primary_term, +          if_seq_no:       $seqno, +          if_primary_term: 1000, +          if_seq_no:       $seqno, +          if_primary_term: $primary_term, +++ b/server/src/main/java/org/elasticsearch/action/bulk/BulkRequest.java, +    private static final ParseField IF_SEQ_NO = new ParseField("if_seq_no");, +    private static final ParseField IF_PRIMARY_TERM = new ParseField("if_primary_term");, +                long ifSeqNo = SequenceNumbers.UNASSIGNED_SEQ_NO;, +                long ifPrimaryTerm = 0;, +                            } else if (IF_SEQ_NO.match(currentFieldName, parser.getDeprecationHandler())) {, +                                ifSeqNo = parser.longValue();, +                            } else if (IF_PRIMARY_TERM.match(currentFieldName, parser.getDeprecationHandler())) {, +                                ifPrimaryTerm = parser.longValue();, +                        .version(version).versionType(versionType).setIfSeqNo(ifSeqNo).setIfPrimaryTerm(ifPrimaryTerm), payload);, +                                    .setPipeline(pipeline).setIfSeqNo(ifSeqNo).setIfPrimaryTerm(ifPrimaryTerm), +                                    .create("create".equals(opType)).setPipeline(pipeline), +                                    .setIfSeqNo(ifSeqNo).setIfPrimaryTerm(ifPrimaryTerm), +                                .create(true).setPipeline(pipeline).setIfSeqNo(ifSeqNo).setIfPrimaryTerm(ifPrimaryTerm), +++ b/server/src/main/java/org/elasticsearch/action/bulk/TransportShardBulkAction.java, +                    request.ifSeqNo(), request.ifPrimaryTerm(), request.getAutoGeneratedTimestamp(), request.isRetry()),, +                request.ifSeqNo(), request.ifPrimaryTerm()),, +++ b/rest-api-spec/src/main/resources/rest-api-spec/api/delete.json, +        "if_seq_no" : {, +        "if_primary_term" : {, +++ b/rest-api-spec/src/main/resources/rest-api-spec/api/index.json, +        "if_seq_no" : {, +        "if_primary_term" : {, +++ b/rest-api-spec/src/main/resources/rest-api-spec/test/index/30_cas.yml, +          if_seq_no:       10000, +          if_primary_term: $primary_term, +          if_seq_no:       $seqno, +          if_primary_term: 1000, +          if_seq_no:       $seqno, +          if_primary_term: $primary_term, +++ b/server/src/main/java/org/elasticsearch/action/bulk/BulkRequest.java, +    private static final ParseField IF_SEQ_NO = new ParseField("if_seq_no");, +    private static final ParseField IF_PRIMARY_TERM = new ParseField("if_primary_term");, +                long ifSeqNo = SequenceNumbers.UNASSIGNED_SEQ_NO;, +                long ifPrimaryTerm = 0;, +                            } else if (IF_SEQ_NO.match(currentFieldName, parser.getDeprecationHandler())) {, +                                ifSeqNo = parser.longValue();, +                            } else if (IF_PRIMARY_TERM.match(currentFieldName, parser.getDeprecationHandler())) {]
[+++ b/src/main/java/org/elasticsearch/index/search/nested/NestedChildrenCollector.java, +import org.apache.lucene.search.DocIdSet;, +        DocIdSet docIdSet = parentFilter.getDocIdSet(reader);, +        if (docIdSet == null) {, +            parentDocs = null;, +        } else if (docIdSet instanceof FixedBitDocSet) {, +            parentDocs = ((FixedBitDocSet) docIdSet).set();, +        } else {, +            parentDocs = (FixedBitSet) docIdSet;, +        }, +        if (parentDoc == 0 || parentDocs == null) {]
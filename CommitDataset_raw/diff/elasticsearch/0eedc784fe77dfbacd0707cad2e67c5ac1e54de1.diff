[+++ b/core/src/main/java/org/elasticsearch/index/mapper/DocumentParser.java, +                builder = new TextFieldMapper.Builder(currentFieldName), +                        .addMultiField(new KeywordFieldMapper.Builder("keyword").ignoreAbove(256));, +                builder = new TextFieldMapper.Builder(currentFieldName), +                        .addMultiField(new KeywordFieldMapper.Builder("keyword").ignoreAbove(256));, +++ b/core/src/main/java/org/elasticsearch/index/mapper/DocumentParser.java, +                builder = new TextFieldMapper.Builder(currentFieldName), +                        .addMultiField(new KeywordFieldMapper.Builder("keyword").ignoreAbove(256));, +                builder = new TextFieldMapper.Builder(currentFieldName), +                        .addMultiField(new KeywordFieldMapper.Builder("keyword").ignoreAbove(256));, +++ b/core/src/test/java/org/elasticsearch/index/mapper/DynamicMappingTests.java, +        assertEquals(XContentFactory.jsonBuilder().startObject().startObject("type").startObject("properties"), +                .startObject("foo"), +                    .field("type", "text"), +                    .startObject("fields"), +                        .startObject("keyword"), +                        .field("type", "keyword"), +                            .field("ignore_above", 256), +                        .endObject(), +                    .endObject(), +                .endObject(), +                .endObject().endObject().endObject().string(), serialize(update));, +                .startObject("bar").field("type", "text"), +                    .startObject("fields"), +                        .startObject("keyword"), +                            .field("type", "keyword"), +                            .field("ignore_above", 256), +                        .endObject(), +                    .endObject(), +                .endObject(), +                .startObject("bar").field("type", "text"), +                    .startObject("fields"), +                        .startObject("keyword"), +                            .field("type", "keyword"), +                            .field("ignore_above", 256), +                        .endObject(), +                    .endObject(), +                .endObject(), +                .startObject("foo").field("type", "text"), +                    .startObject("fields"), +                        .startObject("keyword"), +                            .field("type", "keyword"), +                            .field("ignore_above", 256), +                        .endObject(), +                    .endObject(), +                .endObject(), +                .startObject("foo").startObject("properties").startObject("bar").startObject("properties").startObject("baz").field("type", "text"), +                .startObject("fields").startObject("keyword").field("type", "keyword").field("ignore_above", 256).endObject(), +                .endObject().endObject().endObject().endObject().endObject().endObject(), +                .startObject("foo"), +                    .field("type", "text"), +                    .startObject("fields"), +                        .startObject("keyword"), +                        .field("type", "keyword"), +                            .field("ignore_above", 256), +                        .endObject(), +                    .endObject(), +                .endObject(), +                .startObject("foo").startObject("properties").startObject("bar").startObject("properties").startObject("baz").field("type", "text").startObject("fields"), +                .startObject("keyword").field("type", "keyword").field("ignore_above", 256).endObject(), +                .endObject().endObject().endObject().endObject().endObject().endObject(), +                .startObject("bar").field("type", "text"), +                    .startObject("fields"), +                        .startObject("keyword"), +                            .field("type", "keyword"), +                            .field("ignore_above", 256), +                        .endObject(), +                    .endObject(), +                .endObject(), +++ b/core/src/main/java/org/elasticsearch/index/mapper/DocumentParser.java, +                builder = new TextFieldMapper.Builder(currentFieldName), +                        .addMultiField(new KeywordFieldMapper.Builder("keyword").ignoreAbove(256));, +                builder = new TextFieldMapper.Builder(currentFieldName), +                        .addMultiField(new KeywordFieldMapper.Builder("keyword").ignoreAbove(256));, +++ b/core/src/test/java/org/elasticsearch/index/mapper/DynamicMappingTests.java, +        assertEquals(XContentFactory.jsonBuilder().startObject().startObject("type").startObject("properties"), +                .startObject("foo"), +                    .field("type", "text"), +                    .startObject("fields"), +                        .startObject("keyword"), +                        .field("type", "keyword"), +                            .field("ignore_above", 256), +                        .endObject(), +                    .endObject(), +                .endObject(), +                .endObject().endObject().endObject().string(), serialize(update));, +                .startObject("bar").field("type", "text"), +                    .startObject("fields"), +                        .startObject("keyword"), +                            .field("type", "keyword"), +                            .field("ignore_above", 256), +                        .endObject(), +                    .endObject(), +                .endObject(), +                .startObject("bar").field("type", "text"), +                    .startObject("fields"), +                        .startObject("keyword"), +                            .field("type", "keyword"), +                            .field("ignore_above", 256), +                        .endObject()]
[+++ b/src/main/java/org/elasticsearch/cluster/action/shard/ShardStateAction.java, +                if (shardRoutingEntry.processed) {, +                    return currentState;, +                }, +                    shardRoutingEntry.processed = true;, +                        if (shardRoutingEntry.processed) {, +                            return currentState;, +                        }, +, +                            shardRoutingEntry.processed = true;, +        volatile boolean processed; // state field, no need to serialize, +]
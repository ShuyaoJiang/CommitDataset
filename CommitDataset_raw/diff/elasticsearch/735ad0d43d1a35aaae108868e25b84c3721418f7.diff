[+++ b/plugins/river/couchdb/src/main/java/org/elasticsearch/river/couchdb/CouchdbRiver.java, +import java.io.*;, +import java.net.URLEncoder;, +    private final String couchFilterParamsUrl;, +            if (couchSettings.containsKey("filter_params")) {, +                Map<String, Object> filterParams = (Map<String, Object>) couchSettings.get("filter_params");, +                StringBuilder sb = new StringBuilder();, +                for (Map.Entry<String, Object> entry : filterParams.entrySet()) {, +                    try {, +                        sb.append("&").append(URLEncoder.encode(entry.getKey(), "UTF-8")).append(URLEncoder.encode(entry.getValue().toString(), "UTF-8"));, +                    } catch (UnsupportedEncodingException e) {, +                        // should not happen..., +                    }, +                }, +                couchFilterParamsUrl = sb.toString();, +            } else {, +                couchFilterParamsUrl = null;, +            }, +            couchFilterParamsUrl = null;, +                    try {, +                        file = file + "&filter=" + URLEncoder.encode(couchFilter, "UTF-8");, +                    } catch (UnsupportedEncodingException e) {, +                        // should not happen!, +                    }, +                    if (couchFilterParamsUrl != null) {, +                        file = file + couchFilterParamsUrl;, +                    }]
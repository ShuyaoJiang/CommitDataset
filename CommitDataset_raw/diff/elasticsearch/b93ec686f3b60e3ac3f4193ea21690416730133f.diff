[+++ b/elasticsearch/src/main/java/org/elasticsearch/xpack/ml/job/process/autodetect/writer/AbstractDataToProcessWriter.java, +, +++ b/elasticsearch/src/main/java/org/elasticsearch/xpack/ml/job/process/autodetect/writer/AbstractDataToProcessWriter.java, +, +++ b/elasticsearch/src/main/java/org/elasticsearch/xpack/ml/scheduler/extractor/scroll/ScrollDataExtractor.java, +++ b/elasticsearch/src/main/java/org/elasticsearch/xpack/ml/job/process/autodetect/writer/AbstractDataToProcessWriter.java, +, +++ b/elasticsearch/src/main/java/org/elasticsearch/xpack/ml/scheduler/extractor/scroll/ScrollDataExtractor.java, +++ b/elasticsearch/src/test/java/org/elasticsearch/xpack/ml/action/ScheduledJobsIT.java, +        client().admin().indices().prepareCreate("data-1"), +        long oneWeekAgo = now - 604800000;, +        long twoWeeksAgo = oneWeekAgo - 604800000;, +        indexDocs("data-1", numDocs, twoWeeksAgo, oneWeekAgo);, +, +        client().admin().indices().prepareCreate("data-2"), +                .addMapping("type", "time", "type=date"), +                .get();, +        long numDocs2 = randomIntBetween(32, 2048);, +        indexDocs("data-2", numDocs2, oneWeekAgo, now);, +            assertThat(dataCounts.getInputRecordCount(), equalTo(numDocs + numDocs2));, +            assertThat(dataCounts.getOutOfOrderTimeStampCount(), equalTo(0L));, +        indexDocs("data", numDocs1, lastWeek, now);, +            assertThat(dataCounts.getOutOfOrderTimeStampCount(), equalTo(0L));, +        indexDocs("data", numDocs2, now + 5000, now + 6000);, +            assertThat(dataCounts.getOutOfOrderTimeStampCount(), equalTo(0L));, +    private void indexDocs(String index, long numDocs, long start, long end) {, +            IndexRequest indexRequest = new IndexRequest(index, "type");, +        builder.setIndexes(Collections.singletonList("data-*"));]
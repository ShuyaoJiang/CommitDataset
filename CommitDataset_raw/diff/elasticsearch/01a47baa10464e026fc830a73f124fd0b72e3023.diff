[+++ b/core/src/main/java/org/elasticsearch/action/fieldcaps/FieldCapabilitiesIndexRequest.java, +import org.elasticsearch.Version;, +import org.elasticsearch.action.OriginalIndices;, +import org.elasticsearch.action.support.IndicesOptions;, +    private OriginalIndices originalIndices;, +    FieldCapabilitiesIndexRequest(String[] fields, String index, OriginalIndices originalIndices) {, +        assert index != null;, +        this.index(index);, +        this.originalIndices = originalIndices;, +    public String[] indices() {, +        return originalIndices.indices();, +    }, +, +    @Override, +    public IndicesOptions indicesOptions() {, +        return originalIndices.indicesOptions();, +    }, +, +    @Override, +        if (in.getVersion().onOrAfter(Version.V_6_2_0)) {, +            originalIndices = OriginalIndices.readOriginalIndices(in);, +        } else {, +            originalIndices = OriginalIndices.NONE;, +        }, +        if (out.getVersion().onOrAfter(Version.V_6_2_0)) {, +            OriginalIndices.writeOriginalIndices(originalIndices, out);, +        }, +++ b/core/src/main/java/org/elasticsearch/action/fieldcaps/FieldCapabilitiesIndexRequest.java, +import org.elasticsearch.Version;, +import org.elasticsearch.action.OriginalIndices;, +import org.elasticsearch.action.support.IndicesOptions;, +    private OriginalIndices originalIndices;, +    FieldCapabilitiesIndexRequest(String[] fields, String index, OriginalIndices originalIndices) {, +        assert index != null;, +        this.index(index);, +        this.originalIndices = originalIndices;, +    public String[] indices() {, +        return originalIndices.indices();, +    }, +, +    @Override, +    public IndicesOptions indicesOptions() {, +        return originalIndices.indicesOptions();, +    }, +, +    @Override, +        if (in.getVersion().onOrAfter(Version.V_6_2_0)) {, +            originalIndices = OriginalIndices.readOriginalIndices(in);, +        } else {, +            originalIndices = OriginalIndices.NONE;, +        }, +        if (out.getVersion().onOrAfter(Version.V_6_2_0)) {, +            OriginalIndices.writeOriginalIndices(originalIndices, out);, +        }, +++ b/core/src/main/java/org/elasticsearch/action/fieldcaps/TransportFieldCapabilitiesAction.java, +                shardAction.execute(new FieldCapabilitiesIndexRequest(request.fields(), index, localIndices), innerListener);, +++ b/core/src/main/java/org/elasticsearch/action/fieldcaps/FieldCapabilitiesIndexRequest.java, +import org.elasticsearch.Version;, +import org.elasticsearch.action.OriginalIndices;, +import org.elasticsearch.action.support.IndicesOptions;, +    private OriginalIndices originalIndices;, +    FieldCapabilitiesIndexRequest(String[] fields, String index, OriginalIndices originalIndices) {, +        assert index != null;, +        this.index(index);, +        this.originalIndices = originalIndices;, +    public String[] indices() {, +        return originalIndices.indices();, +    }, +, +    @Override, +    public IndicesOptions indicesOptions() {, +        return originalIndices.indicesOptions();, +    }, +, +    @Override, +        if (in.getVersion().onOrAfter(Version.V_6_2_0)) {, +            originalIndices = OriginalIndices.readOriginalIndices(in);, +        } else {, +            originalIndices = OriginalIndices.NONE;, +        }, +        if (out.getVersion().onOrAfter(Version.V_6_2_0)) {, +            OriginalIndices.writeOriginalIndices(originalIndices, out);, +        }, +++ b/core/src/main/java/org/elasticsearch/action/fieldcaps/TransportFieldCapabilitiesAction.java, +                shardAction.execute(new FieldCapabilitiesIndexRequest(request.fields(), index, localIndices), innerListener);, +++ b/core/src/main/java/org/elasticsearch/action/support/replication/ReplicationOperation.java, +         * The local checkpoint for the shard., +         * The global checkpoint for the shard., +++ b/core/src/main/java/org/elasticsearch/action/fieldcaps/FieldCapabilitiesIndexRequest.java, +import org.elasticsearch.Version;, +import org.elasticsearch.action.OriginalIndices;, +import org.elasticsearch.action.support.IndicesOptions;, +    private OriginalIndices originalIndices;, +    FieldCapabilitiesIndexRequest(String[] fields, String index, OriginalIndices originalIndices) {, +        assert index != null;, +        this.index(index);, +        this.originalIndices = originalIndices;, +    public String[] indices() {, +        return originalIndices.indices();, +    }]
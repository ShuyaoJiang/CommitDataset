[+++ b/modules/elasticsearch/src/main/java/org/elasticsearch/cluster/ClusterState.java, +        return routingTable.routingNodes(metaData, blocks);, +        routingNodes = routingTable.routingNodes(metaData, blocks);, +        public Builder version(long version) {, +            this.version = version;, +            return this;, +        }, +, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/cluster/ClusterState.java, +        return routingTable.routingNodes(metaData, blocks);, +        routingNodes = routingTable.routingNodes(metaData, blocks);, +        public Builder version(long version) {, +            this.version = version;, +            return this;, +        }, +, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/cluster/block/ClusterBlocks.java, +    public boolean hasIndexBlock(String index, ClusterBlock block) {, +        return indicesBlocks.containsKey(index) && indicesBlocks.get(index).contains(block);, +    }, +, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/cluster/ClusterState.java, +        return routingTable.routingNodes(metaData, blocks);, +        routingNodes = routingTable.routingNodes(metaData, blocks);, +        public Builder version(long version) {, +            this.version = version;, +            return this;, +        }, +, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/cluster/block/ClusterBlocks.java, +    public boolean hasIndexBlock(String index, ClusterBlock block) {, +        return indicesBlocks.containsKey(index) && indicesBlocks.get(index).contains(block);, +    }, +, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/cluster/metadata/MetaData.java, +            XContentParser.Token token = parser.currentToken();, +            String currentFieldName = parser.currentName();, +            if (!"meta-data".equals(currentFieldName)) {, +                token = parser.nextToken();, +                currentFieldName = parser.currentName();, +            }, +, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/cluster/ClusterState.java, +        return routingTable.routingNodes(metaData, blocks);, +        routingNodes = routingTable.routingNodes(metaData, blocks);, +        public Builder version(long version) {, +            this.version = version;, +            return this;, +        }, +, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/cluster/block/ClusterBlocks.java, +    public boolean hasIndexBlock(String index, ClusterBlock block) {, +        return indicesBlocks.containsKey(index) && indicesBlocks.get(index).contains(block);, +    }, +, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/cluster/metadata/MetaData.java, +            XContentParser.Token token = parser.currentToken();, +            String currentFieldName = parser.currentName();, +            if (!"meta-data".equals(currentFieldName)) {, +                token = parser.nextToken();, +                currentFieldName = parser.currentName();, +            }, +, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/cluster/metadata/MetaDataCreateIndexService.java, +import org.elasticsearch.cluster.block.ClusterBlock;, +import org.elasticsearch.cluster.block.ClusterBlocks;, +import org.elasticsearch.common.collect.Sets;, +import java.util.Set;, +                    ClusterBlocks.Builder blocks = ClusterBlocks.builder().blocks(currentState.blocks());, +                    if (!request.blocks.isEmpty()) {, +                        for (ClusterBlock block : request.blocks) {, +                            blocks.addIndexBlock(request.index, block);, +                        }, +                    }, +, +                    return newClusterStateBuilder().state(currentState).blocks(blocks).metaData(newMetaData).build();, +        Set<ClusterBlock> blocks = Sets.newHashSet();, +, +        public Request blocks(Set<ClusterBlock> blocks) {, +            this.blocks.addAll(blocks);, +            return this;, +        }, +, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/cluster/ClusterState.java, +        return routingTable.routingNodes(metaData, blocks);, +        routingNodes = routingTable.routingNodes(metaData, blocks);, +        public Builder version(long version) {, +            this.version = version;, +            return this;, +        }, +, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/cluster/block/ClusterBlocks.java, +    public boolean hasIndexBlock(String index, ClusterBlock block) {, +        return indicesBlocks.containsKey(index) && indicesBlocks.get(index).contains(block);, +    }, +, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/cluster/metadata/MetaData.java, +            XContentParser.Token token = parser.currentToken();, +            String currentFieldName = parser.currentName();, +            if (!"meta-data".equals(currentFieldName)) {]
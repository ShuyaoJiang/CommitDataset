[+++ b/modules/ingest-common/src/test/resources/rest-api-spec/test/ingest/220_drop_processor.yml, +, +---, +"Test Drop Processor On Failure":, +- do:, +    ingest.put_pipeline:, +      id: "my_pipeline_with_failure", +      body:  >, +        {, +          "description" : "pipeline with on failure drop",, +          "processors": [, +              {, +                "fail": {, +                  "message": "failed",, +                  "on_failure": [, +                    {, +                      "drop": {}, +                    }, +                  ], +                }, +              }, +            ], +        }, +- match: { acknowledged: true }, +, +- do:, +    index:, +      index: test, +      type: test, +      id: 3, +      pipeline: "my_pipeline_with_failure", +      body: {, +        foo: "bar", +      }, +, +- do:, +    catch: missing, +    get:, +      index: test, +      type: test, +      id: 3, +- match: { found: false }, +++ b/modules/ingest-common/src/test/resources/rest-api-spec/test/ingest/220_drop_processor.yml, +, +---, +"Test Drop Processor On Failure":, +- do:, +    ingest.put_pipeline:, +      id: "my_pipeline_with_failure", +      body:  >, +        {, +          "description" : "pipeline with on failure drop",, +          "processors": [, +              {, +                "fail": {, +                  "message": "failed",, +                  "on_failure": [, +                    {, +                      "drop": {}, +                    }, +                  ], +                }, +              }, +            ], +        }, +- match: { acknowledged: true }, +, +- do:, +    index:, +      index: test, +      type: test, +      id: 3, +      pipeline: "my_pipeline_with_failure", +      body: {, +        foo: "bar", +      }, +, +- do:, +    catch: missing, +    get:, +      index: test, +      type: test, +      id: 3, +- match: { found: false }, +++ b/server/src/main/java/org/elasticsearch/ingest/CompoundProcessor.java, +                    if (executeOnFailure(ingestDocument, compoundProcessorException) == false) {, +                        return null;, +                    }, +    /**, +     * @return true if execution should continue, false if document is dropped., +     */, +    boolean executeOnFailure(IngestDocument ingestDocument, ElasticsearchException exception) throws Exception {, +                    if (processor.execute(ingestDocument) == null) {, +                        return false;, +                    }, +        return true;, +++ b/modules/ingest-common/src/test/resources/rest-api-spec/test/ingest/220_drop_processor.yml, +, +---, +"Test Drop Processor On Failure":]
[+++ b/client/sniffer/src/main/java/org/elasticsearch/client/sniff/HostsSniffer.java, +        private Scheme scheme = Scheme.HTTP;, +++ b/client/sniffer/src/main/java/org/elasticsearch/client/sniff/HostsSniffer.java, +        private Scheme scheme = Scheme.HTTP;, +++ b/client/sniffer/src/test/java/org/elasticsearch/client/sniff/HostsSnifferTests.java, +            HostsSniffer.Builder builder = HostsSniffer.builder(restClient).setSniffRequestTimeoutMillis(sniffRequestTimeout);, +            if (scheme != HostsSniffer.Scheme.HTTP || randomBoolean()) {, +                builder.setScheme(scheme);, +            }, +            HostsSniffer sniffer = builder.build();]
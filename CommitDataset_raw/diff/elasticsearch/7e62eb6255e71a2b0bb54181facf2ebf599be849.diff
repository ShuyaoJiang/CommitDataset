[+++ b/plugin/src/test/java/org/elasticsearch/xpack/ml/action/DatafeedJobsIT.java, +, +        waitUntilJobIsClosed(job.getId());, +    private void waitUntilJobIsClosed(String jobId) throws Exception {, +        assertBusy(() -> {, +            try {, +                GetJobsStatsAction.Request request = new GetJobsStatsAction.Request(jobId);, +                GetJobsStatsAction.Response response = client().execute(GetJobsStatsAction.INSTANCE, request).get();, +                assertThat(response.getResponse().results().get(0).getState(), equalTo(JobState.CLOSED));, +            } catch (Exception e) {, +                throw new RuntimeException(e);, +            }, +        }, 30, TimeUnit.SECONDS);, +    }]
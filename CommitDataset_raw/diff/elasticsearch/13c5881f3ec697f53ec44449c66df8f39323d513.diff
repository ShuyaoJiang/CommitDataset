[+++ b/build.gradle, +++ b/build.gradle, +++ b/core/src/main/java/org/elasticsearch/discovery/zen/UnicastZenPing.java, +                    ensureOpen();, +                            // acquire lock and check if closed, to prevent leaving an open connection after closing, +                            ensureOpen();, +++ b/build.gradle, +++ b/core/src/main/java/org/elasticsearch/discovery/zen/UnicastZenPing.java, +                    ensureOpen();, +                            // acquire lock and check if closed, to prevent leaving an open connection after closing, +                            ensureOpen();, +++ b/core/src/main/java/org/elasticsearch/ingest/ConfigurationUtils.java, +        String tag = ConfigurationUtils.readOptionalStringProperty(null, null, config, TAG_KEY);, +        throw newConfigurationException(type, tag, null, "No processor type exists with name [" + type + "]");, +++ b/build.gradle, +++ b/core/src/main/java/org/elasticsearch/discovery/zen/UnicastZenPing.java, +                    ensureOpen();, +                            // acquire lock and check if closed, to prevent leaving an open connection after closing, +                            ensureOpen();, +++ b/core/src/main/java/org/elasticsearch/ingest/ConfigurationUtils.java, +        String tag = ConfigurationUtils.readOptionalStringProperty(null, null, config, TAG_KEY);, +        throw newConfigurationException(type, tag, null, "No processor type exists with name [" + type + "]");, +++ b/core/src/test/java/org/elasticsearch/ExceptionSerializationTests.java, +++ b/build.gradle, +++ b/core/src/main/java/org/elasticsearch/discovery/zen/UnicastZenPing.java, +                    ensureOpen();, +                            // acquire lock and check if closed, to prevent leaving an open connection after closing, +                            ensureOpen();, +++ b/core/src/main/java/org/elasticsearch/ingest/ConfigurationUtils.java, +        String tag = ConfigurationUtils.readOptionalStringProperty(null, null, config, TAG_KEY);, +        throw newConfigurationException(type, tag, null, "No processor type exists with name [" + type + "]");, +++ b/core/src/test/java/org/elasticsearch/ExceptionSerializationTests.java, +++ b/core/src/test/java/org/elasticsearch/discovery/zen/UnicastZenPingTests.java, +import org.elasticsearch.test.junit.annotations.TestLogging;, +            logger.info("shutting down...");, +    @TestLogging("org.elasticsearch:DEBUG,org.elasticsearch.discovery:TRACE,org.elasticsearch.transport:TRACE"), +++ b/build.gradle, +++ b/core/src/main/java/org/elasticsearch/discovery/zen/UnicastZenPing.java, +                    ensureOpen();, +                            // acquire lock and check if closed, to prevent leaving an open connection after closing, +                            ensureOpen();, +++ b/core/src/main/java/org/elasticsearch/ingest/ConfigurationUtils.java, +        String tag = ConfigurationUtils.readOptionalStringProperty(null, null, config, TAG_KEY);, +        throw newConfigurationException(type, tag, null, "No processor type exists with name [" + type + "]");, +++ b/core/src/test/java/org/elasticsearch/ExceptionSerializationTests.java, +++ b/core/src/test/java/org/elasticsearch/discovery/zen/UnicastZenPingTests.java, +import org.elasticsearch.test.junit.annotations.TestLogging;, +            logger.info("shutting down...");, +    @TestLogging("org.elasticsearch:DEBUG,org.elasticsearch.discovery:TRACE,org.elasticsearch.transport:TRACE"), +++ b/core/src/test/java/org/elasticsearch/ingest/ConfigurationUtilsTests.java, +import static org.hamcrest.Matchers.is;, +import static org.hamcrest.Matchers.nullValue;, +        Map<String, Object> unknownTaggedConfig = new HashMap<>();, +        unknownTaggedConfig.put("tag", "my_unknown");, +        config.add(Collections.singletonMap("unknown_processor", unknownTaggedConfig));, +            assertThat(e.getHeader("processor_tag"), equalTo(Collections.singletonList("my_unknown")));, +            assertThat(e.getHeader("processor_type"), equalTo(Collections.singletonList("unknown_processor")));, +            assertThat(e.getHeader("property_name"), is(nullValue()));, +++ b/build.gradle, +++ b/core/src/main/java/org/elasticsearch/discovery/zen/UnicastZenPing.java, +                    ensureOpen();, +                            // acquire lock and check if closed, to prevent leaving an open connection after closing, +                            ensureOpen();, +++ b/core/src/main/java/org/elasticsearch/ingest/ConfigurationUtils.java, +        String tag = ConfigurationUtils.readOptionalStringProperty(null, null, config, TAG_KEY);, +        throw newConfigurationException(type, tag, null, "No processor type exists with name [" + type + "]");, +++ b/core/src/test/java/org/elasticsearch/ExceptionSerializationTests.java, +++ b/core/src/test/java/org/elasticsearch/discovery/zen/UnicastZenPingTests.java, +import org.elasticsearch.test.junit.annotations.TestLogging;, +            logger.info("shutting down...");, +    @TestLogging("org.elasticsearch:DEBUG,org.elasticsearch.discovery:TRACE,org.elasticsearch.transport:TRACE"), +++ b/core/src/test/java/org/elasticsearch/ingest/ConfigurationUtilsTests.java, +import static org.hamcrest.Matchers.is;, +import static org.hamcrest.Matchers.nullValue;, +        Map<String, Object> unknownTaggedConfig = new HashMap<>();, +        unknownTaggedConfig.put("tag", "my_unknown");, +        config.add(Collections.singletonMap("unknown_processor", unknownTaggedConfig));, +            assertThat(e.getHeader("processor_tag"), equalTo(Collections.singletonList("my_unknown")));, +            assertThat(e.getHeader("processor_type"), equalTo(Collections.singletonList("unknown_processor")));, +            assertThat(e.getHeader("property_name"), is(nullValue()));, +++ b/distribution/deb/src/test/java/org/elasticsearch/test/rest/DebClientYamlTestSuiteIT.java, +    public static Iterable<Object[]> parameters() throws IOException {, +++ b/build.gradle, +++ b/core/src/main/java/org/elasticsearch/discovery/zen/UnicastZenPing.java, +                    ensureOpen();, +                            // acquire lock and check if closed, to prevent leaving an open connection after closing, +                            ensureOpen();, +++ b/core/src/main/java/org/elasticsearch/ingest/ConfigurationUtils.java, +        String tag = ConfigurationUtils.readOptionalStringProperty(null, null, config, TAG_KEY);, +        throw newConfigurationException(type, tag, null, "No processor type exists with name [" + type + "]");, +++ b/core/src/test/java/org/elasticsearch/ExceptionSerializationTests.java, +++ b/core/src/test/java/org/elasticsearch/discovery/zen/UnicastZenPingTests.java, +import org.elasticsearch.test.junit.annotations.TestLogging;, +            logger.info("shutting down...");, +    @TestLogging("org.elasticsearch:DEBUG,org.elasticsearch.discovery:TRACE,org.elasticsearch.transport:TRACE"), +++ b/core/src/test/java/org/elasticsearch/ingest/ConfigurationUtilsTests.java, +import static org.hamcrest.Matchers.is;, +import static org.hamcrest.Matchers.nullValue;, +        Map<String, Object> unknownTaggedConfig = new HashMap<>();, +        unknownTaggedConfig.put("tag", "my_unknown");]
[+++ b/src/test/java/org/elasticsearch/test/client/RandomizingClient.java, +import org.apache.lucene.util.TestUtil;, +import org.elasticsearch.cluster.routing.operation.plain.Preference;, +import java.util.EnumSet;, +    private final String defaultPreference;, +, +        if (random.nextInt(10) == 0) {, +            defaultPreference = RandomPicks.randomFrom(random, EnumSet.of(Preference.PRIMARY_FIRST, Preference.PRIMARY, Preference.LOCAL)).type();, +        } else if (random.nextInt(10) == 0) {, +            String s = TestUtil.randomRealisticUnicodeString(random, 1, 10);, +            defaultPreference = s.startsWith("_") ? null : s; // '_' is a reserved character, +        } else {, +            defaultPreference = null;, +        }, +, +        return in.prepareSearch(indices).setSearchType(defaultSearchType).setPreference(defaultPreference);]
[+++ b/src/test/java/org/elasticsearch/test/integration/indices/store/IndicesStoreTests.java, +import com.google.common.base.Predicate;, +        assertThat(waitForShardDeletion("server3", "test", 0), equalTo(false));, +        assertThat(waitForShardDeletion("server2", "test", 0), equalTo(false));, +    private boolean waitForShardDeletion(final String server, final  String index, final int shard) throws InterruptedException {, +        awaitBusy(new Predicate<Object>() {, +            public boolean apply(Object o) {, +                return !shardDirectory(server, index, shard).exists();, +        });, +        return shardDirectory(server, index, shard).exists();]
[+++ b/modules/test/integration/src/test/java/org/elasticsearch/test/integration/search/facet/SimpleFacetsTests.java, +    @Test public void testTermsFacetsNoHint() throws Exception {, +        testTermsFacets(null);, +    }, +, +    @Test public void testTermsFacetsMapHint() throws Exception {, +        testTermsFacets("map");, +    }, +, +    private void testTermsFacets(String executionHint) throws Exception {, +                    .addFacet(termsFacet("facet1").field("stag").size(10).executionHint(executionHint)), +                    .addFacet(termsFacet("facet2").field("tag").size(10).executionHint(executionHint)), +                    .addFacet(termsFacet("facet1").field("lstag").size(10).executionHint(executionHint)), +                    .addFacet(termsFacet("facet2").field("ltag").size(10).executionHint(executionHint)), +                    .addFacet(termsFacet("facet3").field("ltag").size(10).exclude(3000).executionHint(executionHint)), +                    .addFacet(termsFacet("facet1").field("dstag").size(10).executionHint(executionHint)), +                    .addFacet(termsFacet("facet2").field("dtag").size(10).executionHint(executionHint)), +                    .addFacet(termsFacet("facet1").field("bstag").size(10).executionHint(executionHint)), +                    .addFacet(termsFacet("facet1").field("istag").size(10).executionHint(executionHint)), +                    .addFacet(termsFacet("facet1").field("shstag").size(10).executionHint(executionHint)), +                    .addFacet(termsFacet("facet1").field("stag").size(10).facetFilter(termFilter("tag", "xxx")).executionHint(executionHint)), +                    .addFacet(termsFacet("facet1").field("type1.stag").size(10).facetFilter(termFilter("tag", "xxx")).executionHint(executionHint)), +                    .addFacet(termsFacet("facet1").field("tag").size(10).executionHint(executionHint)), +                    .addFacet(termsFacet("facet1").field("tag").size(2).executionHint(executionHint)), +                    .addFacet(termsFacet("facet1").field("tag").size(10).exclude("yyy").executionHint(executionHint)), +                    .addFacet(termsFacet("facet1").field("tag").size(10).order(TermsFacet.ComparatorType.TERM).executionHint(executionHint)), +                    .addFacet(termsFacet("facet1").field("tag").size(10).order(TermsFacet.ComparatorType.REVERSE_TERM).executionHint(executionHint)), +                    .addFacet(termsFacet("facet1").field("tag").size(10).script("term + param1").param("param1", "a").order(TermsFacet.ComparatorType.TERM).executionHint(executionHint)), +                    .addFacet(termsFacet("facet1").field("tag").size(10).script("term == 'xxx' ? false : true").order(TermsFacet.ComparatorType.TERM).executionHint(executionHint)), +                    .addFacet(termsFacet("facet1").fields("stag", "tag").size(10).executionHint(executionHint)), +                    .addFacet(termsFacet("facet1").field("tag").size(10).allTerms(true).executionHint(executionHint)), +                    .addFacet(termsFacet("facet1").scriptField("_source.stag").size(10).executionHint(executionHint)), +                    .addFacet(termsFacet("facet2").scriptField("_source.tag").size(10).executionHint(executionHint))]
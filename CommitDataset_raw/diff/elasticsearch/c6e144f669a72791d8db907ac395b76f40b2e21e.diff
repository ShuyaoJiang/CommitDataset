[+++ b/buildSrc/version.properties, +elasticsearch     = 5.0.0, +++ b/buildSrc/version.properties, +elasticsearch     = 5.0.0, +++ b/core/src/main/java/org/elasticsearch/Version.java, +    public static final int V_5_0_0_ID = 5000099;, +    public static final Version V_5_0_0 = new Version(V_5_0_0_ID, org.apache.lucene.util.Version.LUCENE_6_1_0);, +    public static final Version CURRENT = V_5_0_0;, +            case V_5_0_0_ID:, +                return V_5_0_0;, +++ b/buildSrc/version.properties, +elasticsearch     = 5.0.0, +++ b/core/src/main/java/org/elasticsearch/Version.java, +    public static final int V_5_0_0_ID = 5000099;, +    public static final Version V_5_0_0 = new Version(V_5_0_0_ID, org.apache.lucene.util.Version.LUCENE_6_1_0);, +    public static final Version CURRENT = V_5_0_0;, +            case V_5_0_0_ID:, +                return V_5_0_0;, +++ b/core/src/main/java/org/elasticsearch/action/search/MultiSearchRequest.java, +++ b/buildSrc/version.properties, +elasticsearch     = 5.0.0, +++ b/core/src/main/java/org/elasticsearch/Version.java, +    public static final int V_5_0_0_ID = 5000099;, +    public static final Version V_5_0_0 = new Version(V_5_0_0_ID, org.apache.lucene.util.Version.LUCENE_6_1_0);, +    public static final Version CURRENT = V_5_0_0;, +            case V_5_0_0_ID:, +                return V_5_0_0;, +++ b/core/src/main/java/org/elasticsearch/action/search/MultiSearchRequest.java, +++ b/core/src/main/java/org/elasticsearch/action/search/MultiSearchRequestBuilder.java, +++ b/buildSrc/version.properties, +elasticsearch     = 5.0.0, +++ b/core/src/main/java/org/elasticsearch/Version.java, +    public static final int V_5_0_0_ID = 5000099;, +    public static final Version V_5_0_0 = new Version(V_5_0_0_ID, org.apache.lucene.util.Version.LUCENE_6_1_0);, +    public static final Version CURRENT = V_5_0_0;, +            case V_5_0_0_ID:, +                return V_5_0_0;, +++ b/core/src/main/java/org/elasticsearch/action/search/MultiSearchRequest.java, +++ b/core/src/main/java/org/elasticsearch/action/search/MultiSearchRequestBuilder.java, +++ b/core/src/main/java/org/elasticsearch/action/search/TransportMultiSearchAction.java, +/**, + */, +    private final TransportSearchAction searchAction;, +    protected void doExecute(final MultiSearchRequest request, final ActionListener<MultiSearchResponse> listener) {, +        final AtomicArray<MultiSearchResponse.Item> responses = new AtomicArray<>(request.requests().size());, +        final AtomicInteger counter = new AtomicInteger(responses.length());, +        for (int i = 0; i < responses.length(); i++) {, +            final int index = i;, +            searchAction.execute(request.requests().get(i), new ActionListener<SearchResponse>() {, +                    responses.set(index, new MultiSearchResponse.Item(searchResponse, null));, +                    if (counter.decrementAndGet() == 0) {, +                        finishHim();, +                    }, +                    responses.set(index, new MultiSearchResponse.Item(null, e));, +                    if (counter.decrementAndGet() == 0) {, +                        finishHim();, +                    }, +                private void finishHim() {, +++ b/buildSrc/version.properties, +elasticsearch     = 5.0.0, +++ b/core/src/main/java/org/elasticsearch/Version.java, +    public static final int V_5_0_0_ID = 5000099;, +    public static final Version V_5_0_0 = new Version(V_5_0_0_ID, org.apache.lucene.util.Version.LUCENE_6_1_0);, +    public static final Version CURRENT = V_5_0_0;, +            case V_5_0_0_ID:, +                return V_5_0_0;, +++ b/core/src/main/java/org/elasticsearch/action/search/MultiSearchRequest.java, +++ b/core/src/main/java/org/elasticsearch/action/search/MultiSearchRequestBuilder.java, +++ b/core/src/main/java/org/elasticsearch/action/search/TransportMultiSearchAction.java, +/**, + */, +    private final TransportSearchAction searchAction;, +    protected void doExecute(final MultiSearchRequest request, final ActionListener<MultiSearchResponse> listener) {, +        final AtomicArray<MultiSearchResponse.Item> responses = new AtomicArray<>(request.requests().size());, +        final AtomicInteger counter = new AtomicInteger(responses.length());, +        for (int i = 0; i < responses.length(); i++) {, +            final int index = i;, +            searchAction.execute(request.requests().get(i), new ActionListener<SearchResponse>() {, +                    responses.set(index, new MultiSearchResponse.Item(searchResponse, null));, +                    if (counter.decrementAndGet() == 0) {, +                        finishHim();, +                    }, +                    responses.set(index, new MultiSearchResponse.Item(null, e));, +                    if (counter.decrementAndGet() == 0) {, +                        finishHim();, +                    }, +                private void finishHim() {, +++ b/core/src/main/java/org/elasticsearch/common/RandomBasedUUIDGenerator.java, +        return getBase64UUID(Randomness.getSecure());, +, +++ b/buildSrc/version.properties, +elasticsearch     = 5.0.0, +++ b/core/src/main/java/org/elasticsearch/Version.java, +    public static final int V_5_0_0_ID = 5000099;, +    public static final Version V_5_0_0 = new Version(V_5_0_0_ID, org.apache.lucene.util.Version.LUCENE_6_1_0);, +    public static final Version CURRENT = V_5_0_0;, +            case V_5_0_0_ID:, +                return V_5_0_0;, +++ b/core/src/main/java/org/elasticsearch/action/search/MultiSearchRequest.java, +++ b/core/src/main/java/org/elasticsearch/action/search/MultiSearchRequestBuilder.java]
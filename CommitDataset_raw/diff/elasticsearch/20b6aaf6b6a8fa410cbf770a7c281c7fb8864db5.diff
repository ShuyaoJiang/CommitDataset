[+++ b/x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/indexlifecycle/TerminalPolicyStep.java, +    TerminalPolicyStep(StepKey key, StepKey nextStepKey) {, +++ b/x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/indexlifecycle/TerminalPolicyStep.java, +    TerminalPolicyStep(StepKey key, StepKey nextStepKey) {, +++ b/x-pack/plugin/core/src/test/java/org/elasticsearch/xpack/core/indexlifecycle/AbstractStepTestCase.java, +/*, + * Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one, + * or more contributor license agreements. Licensed under the Elastic License;, + * you may not use this file except in compliance with the Elastic License., + */, +package org.elasticsearch.xpack.core.indexlifecycle;, +, +import org.elasticsearch.test.ESTestCase;, +import org.elasticsearch.test.EqualsHashCodeTestUtils;, +, +public abstract class AbstractStepTestCase<T extends Step> extends ESTestCase {, +, +    protected abstract T createRandomInstance();, +    protected abstract T mutateInstance(T instance);, +    protected abstract T copyInstance(T instance);, +, +    public void testHashcodeAndEquals() {, +        EqualsHashCodeTestUtils.checkEqualsAndHashCode(createRandomInstance(), this::copyInstance, this::mutateInstance);, +    }, +}, +++ b/x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/indexlifecycle/TerminalPolicyStep.java, +    TerminalPolicyStep(StepKey key, StepKey nextStepKey) {, +++ b/x-pack/plugin/core/src/test/java/org/elasticsearch/xpack/core/indexlifecycle/AbstractStepTestCase.java, +/*, + * Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one, + * or more contributor license agreements. Licensed under the Elastic License;, + * you may not use this file except in compliance with the Elastic License., + */, +package org.elasticsearch.xpack.core.indexlifecycle;, +, +import org.elasticsearch.test.ESTestCase;, +import org.elasticsearch.test.EqualsHashCodeTestUtils;, +, +public abstract class AbstractStepTestCase<T extends Step> extends ESTestCase {, +, +    protected abstract T createRandomInstance();, +    protected abstract T mutateInstance(T instance);, +    protected abstract T copyInstance(T instance);, +, +    public void testHashcodeAndEquals() {, +        EqualsHashCodeTestUtils.checkEqualsAndHashCode(createRandomInstance(), this::copyInstance, this::mutateInstance);, +    }, +}, +++ b/x-pack/plugin/core/src/test/java/org/elasticsearch/xpack/core/indexlifecycle/AliasStepTests.java, +public class AliasStepTests extends AbstractStepTestCase<AliasStep> {, +    @Override, +    @Override, +    @Override, +    public AliasStep copyInstance(AliasStep instance) {, +        return new AliasStep(instance.getKey(), instance.getNextStepKey(), instance.getClient());, +    public void testPerformAction() {, +    public void testPerformActionFailure() {, +++ b/x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/indexlifecycle/TerminalPolicyStep.java, +    TerminalPolicyStep(StepKey key, StepKey nextStepKey) {, +++ b/x-pack/plugin/core/src/test/java/org/elasticsearch/xpack/core/indexlifecycle/AbstractStepTestCase.java, +/*, + * Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one, + * or more contributor license agreements. Licensed under the Elastic License;, + * you may not use this file except in compliance with the Elastic License., + */, +package org.elasticsearch.xpack.core.indexlifecycle;, +, +import org.elasticsearch.test.ESTestCase;, +import org.elasticsearch.test.EqualsHashCodeTestUtils;, +, +public abstract class AbstractStepTestCase<T extends Step> extends ESTestCase {, +, +    protected abstract T createRandomInstance();, +    protected abstract T mutateInstance(T instance);, +    protected abstract T copyInstance(T instance);, +, +    public void testHashcodeAndEquals() {, +        EqualsHashCodeTestUtils.checkEqualsAndHashCode(createRandomInstance(), this::copyInstance, this::mutateInstance);, +    }, +}, +++ b/x-pack/plugin/core/src/test/java/org/elasticsearch/xpack/core/indexlifecycle/AliasStepTests.java, +public class AliasStepTests extends AbstractStepTestCase<AliasStep> {, +    @Override, +    @Override, +    @Override, +    public AliasStep copyInstance(AliasStep instance) {, +        return new AliasStep(instance.getKey(), instance.getNextStepKey(), instance.getClient());, +    public void testPerformAction() {, +    public void testPerformActionFailure() {, +++ b/x-pack/plugin/core/src/test/java/org/elasticsearch/xpack/core/indexlifecycle/AllocationRoutedStepTests.java, +public class AllocationRoutedStepTests extends AbstractStepTestCase<AllocationRoutedStep> {, +    @Override, +    @Override, +    @Override, +    public AllocationRoutedStep copyInstance(AllocationRoutedStep instance) {, +        return new AllocationRoutedStep(instance.getKey(), instance.getNextStepKey());, +++ b/x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/indexlifecycle/TerminalPolicyStep.java, +    TerminalPolicyStep(StepKey key, StepKey nextStepKey) {, +++ b/x-pack/plugin/core/src/test/java/org/elasticsearch/xpack/core/indexlifecycle/AbstractStepTestCase.java, +/*]
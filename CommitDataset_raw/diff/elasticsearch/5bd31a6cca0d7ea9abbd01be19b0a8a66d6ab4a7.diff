[+++ b/core/src/main/java/org/elasticsearch/cluster/routing/allocation/allocator/BalancedShardsAllocator.java, +                    for (String index : buildWeightOrderedIndices(sorter)) {, +        private String[] buildWeightOrderedIndices(NodeSorter sorter) {]
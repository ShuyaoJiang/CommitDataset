[+++ b/src/test/java/org/elasticsearch/update/UpdateTests.java, +import org.elasticsearch.client.transport.NoNodeAvailableException;, +        final int numberOfUpdatesPerId = scaledRandomIntBetween(10,100);, +                    boolean hasWaitedForNoNode = false;, +                            try {, +                            } catch (NoNodeAvailableException nne) {, +                                updateRequestsOutstanding.release();, +                                synchronized (failedMap) {, +                                    incrementMapValue(j, failedMap);, +                                }, +                                if (hasWaitedForNoNode) {, +                                    throw nne;, +                                }, +                                logger.warn("Got NoNodeException waiting for 1 second for things to recover.");, +                                hasWaitedForNoNode = true;, +                                Thread.sleep(1000);, +                            }, +                            try {, +                            } catch (NoNodeAvailableException nne) {, +                                deleteRequestsOutstanding.release();, +                                synchronized (failedMap) {, +                                    incrementMapValue(j, failedMap);, +                                }, +                                if (hasWaitedForNoNode) {, +                                    throw nne;, +                                }, +                                logger.warn("Got NoNodeException waiting for 1 second for things to recover.");, +                                hasWaitedForNoNode = true;, +                                Thread.sleep(1000); //Wait for no-node to clear, +                            }]
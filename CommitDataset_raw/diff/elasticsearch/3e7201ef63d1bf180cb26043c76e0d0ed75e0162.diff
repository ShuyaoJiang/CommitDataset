[+++ b/core/src/main/java/org/elasticsearch/common/lucene/index/ElasticsearchDirectoryReader.java, +import org.apache.lucene.index.DirectoryReader;, +import org.apache.lucene.index.FilterDirectoryReader;, +import org.apache.lucene.index.FilterLeafReader;, +import org.apache.lucene.index.LeafReader;, +++ b/core/src/main/java/org/elasticsearch/common/lucene/index/ElasticsearchDirectoryReader.java, +import org.apache.lucene.index.DirectoryReader;, +import org.apache.lucene.index.FilterDirectoryReader;, +import org.apache.lucene.index.FilterLeafReader;, +import org.apache.lucene.index.LeafReader;, +++ b/core/src/main/java/org/elasticsearch/common/lucene/index/ElasticsearchLeafReader.java, +import org.apache.lucene.index.DirectoryReader;, +import org.apache.lucene.index.FilterDirectoryReader;, +import org.apache.lucene.index.FilterLeafReader;, +import org.apache.lucene.index.LeafReader;, +    ElasticsearchLeafReader(LeafReader in, ShardId shardId) {, +++ b/core/src/main/java/org/elasticsearch/common/lucene/index/ElasticsearchDirectoryReader.java, +import org.apache.lucene.index.DirectoryReader;, +import org.apache.lucene.index.FilterDirectoryReader;, +import org.apache.lucene.index.FilterLeafReader;, +import org.apache.lucene.index.LeafReader;, +++ b/core/src/main/java/org/elasticsearch/common/lucene/index/ElasticsearchLeafReader.java, +import org.apache.lucene.index.DirectoryReader;, +import org.apache.lucene.index.FilterDirectoryReader;, +import org.apache.lucene.index.FilterLeafReader;, +import org.apache.lucene.index.LeafReader;, +    ElasticsearchLeafReader(LeafReader in, ShardId shardId) {, +++ b/core/src/main/java/org/elasticsearch/common/lucene/uid/Versions.java, +++ b/core/src/main/java/org/elasticsearch/common/lucene/index/ElasticsearchDirectoryReader.java, +import org.apache.lucene.index.DirectoryReader;, +import org.apache.lucene.index.FilterDirectoryReader;, +import org.apache.lucene.index.FilterLeafReader;, +import org.apache.lucene.index.LeafReader;, +++ b/core/src/main/java/org/elasticsearch/common/lucene/index/ElasticsearchLeafReader.java, +import org.apache.lucene.index.DirectoryReader;, +import org.apache.lucene.index.FilterDirectoryReader;, +import org.apache.lucene.index.FilterLeafReader;, +import org.apache.lucene.index.LeafReader;, +    ElasticsearchLeafReader(LeafReader in, ShardId shardId) {, +++ b/core/src/main/java/org/elasticsearch/common/lucene/uid/Versions.java, +++ b/core/src/main/java/org/elasticsearch/index/engine/Engine.java, +++ b/core/src/main/java/org/elasticsearch/common/lucene/index/ElasticsearchDirectoryReader.java, +import org.apache.lucene.index.DirectoryReader;, +import org.apache.lucene.index.FilterDirectoryReader;, +import org.apache.lucene.index.FilterLeafReader;, +import org.apache.lucene.index.LeafReader;, +++ b/core/src/main/java/org/elasticsearch/common/lucene/index/ElasticsearchLeafReader.java, +import org.apache.lucene.index.DirectoryReader;, +import org.apache.lucene.index.FilterDirectoryReader;, +import org.apache.lucene.index.FilterLeafReader;, +import org.apache.lucene.index.LeafReader;, +    ElasticsearchLeafReader(LeafReader in, ShardId shardId) {, +++ b/core/src/main/java/org/elasticsearch/common/lucene/uid/Versions.java, +++ b/core/src/main/java/org/elasticsearch/index/engine/Engine.java, +++ b/core/src/main/java/org/elasticsearch/index/engine/InternalEngine.java, +                        assert isMergedSegment(reader);, +                            final Engine.Searcher searcher = new Searcher("warmer", searcherFactory.newSearcher(reader, null));, +                        IndicesWarmer.WarmerContext context = new IndicesWarmer.WarmerContext(shardId, new Searcher("warmer", newSearcher));, +                    warmer.warmTopReader(new IndicesWarmer.WarmerContext(shardId, new Searcher("warmer", searcher)));, +++ b/core/src/main/java/org/elasticsearch/common/lucene/index/ElasticsearchDirectoryReader.java, +import org.apache.lucene.index.DirectoryReader;, +import org.apache.lucene.index.FilterDirectoryReader;, +import org.apache.lucene.index.FilterLeafReader;, +import org.apache.lucene.index.LeafReader;, +++ b/core/src/main/java/org/elasticsearch/common/lucene/index/ElasticsearchLeafReader.java, +import org.apache.lucene.index.DirectoryReader;, +import org.apache.lucene.index.FilterDirectoryReader;, +import org.apache.lucene.index.FilterLeafReader;, +import org.apache.lucene.index.LeafReader;, +    ElasticsearchLeafReader(LeafReader in, ShardId shardId) {, +++ b/core/src/main/java/org/elasticsearch/common/lucene/uid/Versions.java, +++ b/core/src/main/java/org/elasticsearch/index/engine/Engine.java, +++ b/core/src/main/java/org/elasticsearch/index/engine/InternalEngine.java, +                        assert isMergedSegment(reader);, +                            final Engine.Searcher searcher = new Searcher("warmer", searcherFactory.newSearcher(reader, null));, +                        IndicesWarmer.WarmerContext context = new IndicesWarmer.WarmerContext(shardId, new Searcher("warmer", newSearcher));, +                    warmer.warmTopReader(new IndicesWarmer.WarmerContext(shardId, new Searcher("warmer", searcher)));, +++ b/core/src/main/java/org/elasticsearch/index/fielddata/IndexFieldData.java, +    public static interface Global<FD extends AtomicFieldData> extends IndexFieldData<FD> {, +        IndexFieldData<FD> loadGlobal(IndexReader indexReader);, +        IndexFieldData<FD> localGlobalDirect(IndexReader indexReader) throws Exception;, +++ b/core/src/main/java/org/elasticsearch/common/lucene/index/ElasticsearchDirectoryReader.java, +import org.apache.lucene.index.DirectoryReader;, +import org.apache.lucene.index.FilterDirectoryReader;, +import org.apache.lucene.index.FilterLeafReader;, +import org.apache.lucene.index.LeafReader;, +++ b/core/src/main/java/org/elasticsearch/common/lucene/index/ElasticsearchLeafReader.java, +import org.apache.lucene.index.DirectoryReader;, +import org.apache.lucene.index.FilterDirectoryReader;, +import org.apache.lucene.index.FilterLeafReader;, +import org.apache.lucene.index.LeafReader;, +    ElasticsearchLeafReader(LeafReader in, ShardId shardId) {, +++ b/core/src/main/java/org/elasticsearch/common/lucene/uid/Versions.java, +++ b/core/src/main/java/org/elasticsearch/index/engine/Engine.java, +++ b/core/src/main/java/org/elasticsearch/index/engine/InternalEngine.java, +                        assert isMergedSegment(reader);, +                            final Engine.Searcher searcher = new Searcher("warmer", searcherFactory.newSearcher(reader, null));, +                        IndicesWarmer.WarmerContext context = new IndicesWarmer.WarmerContext(shardId, new Searcher("warmer", newSearcher));, +                    warmer.warmTopReader(new IndicesWarmer.WarmerContext(shardId, new Searcher("warmer", searcher)));, +++ b/core/src/main/java/org/elasticsearch/index/fielddata/IndexFieldData.java]
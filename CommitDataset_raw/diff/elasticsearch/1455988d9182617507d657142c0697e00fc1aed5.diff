[+++ b/dev-tools/es_release_notes.pl, +my $Issue_URL = "http://github.com/${User_Repo}issues/";, +        print "<h2>$Group_Labels{$group}</h2>\n\n<ul>\n";, +            if ($header) {, +                $title =~ s{`([^`]+)`}{<code>$1</code>}g;, +                unless ( $issue->{pull_request} ) {, +                    $title .= " [ISSUE]";, +                }, +, +                print encode_utf8( $prefix, +                        . qq[ <a href="${Issue_URL}${number}">#${number}</a>] );, +, +                if ( my $related = $issue->{related_issues} ) {, +                    my %uniq = map { $_ => 1 } @$related;, +                    print keys %uniq > 1, +                        ? " (issues: ", +                        : " (issue: ";, +                    print join ", ",, +                        map {qq[<a href="${Issue_URL}${_}">#${_}</a>]}, +                        sort keys %uniq;, +                    print ")";, +                print "</li>\n";, +            }, +            if ($header) {, +                print "</ul></li>\n";, +        print "</ul>";, +        print "\n\n";, +    my %seen;, +, +            for my $issue (@$tranche) {, +                next unless $issue->{pull_request};, +                for ( $issue->{body} =~ m{(?:#|${User_Repo}issues/)(\d+)}g ) {, +                    $seen{$_}++;, +                    $issue->{related_issues} ||= [];, +                    push @{$issue}{related_issues}, $_;, +                }, +            }, +            last unless @$tranche;, +        next if $seen{ $issue->{number} } && !$issue->{pull_request};]
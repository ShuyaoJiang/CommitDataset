[+++ b/plugin/src/test/java/org/elasticsearch/xpack/common/http/HttpClientTests.java, +import org.elasticsearch.env.TestEnvironment;, +    private Environment environment = TestEnvironment.newEnvironment(Settings.builder().put("path.home", createTempDir()).build());, +++ b/plugin/src/test/java/org/elasticsearch/xpack/common/http/HttpClientTests.java, +import org.elasticsearch.env.TestEnvironment;, +    private Environment environment = TestEnvironment.newEnvironment(Settings.builder().put("path.home", createTempDir()).build());, +++ b/plugin/src/test/java/org/elasticsearch/xpack/common/http/HttpConnectionTimeoutTests.java, +import org.elasticsearch.env.TestEnvironment;, +        Environment environment = TestEnvironment.newEnvironment(Settings.builder().put("path.home", createTempDir()).build());, +        Environment environment = TestEnvironment.newEnvironment(Settings.builder().put("path.home", createTempDir()).build());, +        Environment environment = TestEnvironment.newEnvironment(Settings.builder().put("path.home", createTempDir()).build());, +++ b/plugin/src/test/java/org/elasticsearch/xpack/common/http/HttpClientTests.java, +import org.elasticsearch.env.TestEnvironment;, +    private Environment environment = TestEnvironment.newEnvironment(Settings.builder().put("path.home", createTempDir()).build());, +++ b/plugin/src/test/java/org/elasticsearch/xpack/common/http/HttpConnectionTimeoutTests.java, +import org.elasticsearch.env.TestEnvironment;, +        Environment environment = TestEnvironment.newEnvironment(Settings.builder().put("path.home", createTempDir()).build());, +        Environment environment = TestEnvironment.newEnvironment(Settings.builder().put("path.home", createTempDir()).build());, +        Environment environment = TestEnvironment.newEnvironment(Settings.builder().put("path.home", createTempDir()).build());, +++ b/plugin/src/test/java/org/elasticsearch/xpack/common/http/HttpReadTimeoutTests.java, +import org.elasticsearch.env.TestEnvironment;, +        Environment environment = TestEnvironment.newEnvironment(Settings.builder().put("path.home", createTempDir()).build());, +        Environment environment = TestEnvironment.newEnvironment(Settings.builder().put("path.home", createTempDir()).build());, +        Environment environment = TestEnvironment.newEnvironment(Settings.builder().put("path.home", createTempDir()).build());, +++ b/plugin/src/test/java/org/elasticsearch/xpack/common/http/HttpClientTests.java, +import org.elasticsearch.env.TestEnvironment;, +    private Environment environment = TestEnvironment.newEnvironment(Settings.builder().put("path.home", createTempDir()).build());, +++ b/plugin/src/test/java/org/elasticsearch/xpack/common/http/HttpConnectionTimeoutTests.java, +import org.elasticsearch.env.TestEnvironment;, +        Environment environment = TestEnvironment.newEnvironment(Settings.builder().put("path.home", createTempDir()).build());, +        Environment environment = TestEnvironment.newEnvironment(Settings.builder().put("path.home", createTempDir()).build());, +        Environment environment = TestEnvironment.newEnvironment(Settings.builder().put("path.home", createTempDir()).build());, +++ b/plugin/src/test/java/org/elasticsearch/xpack/common/http/HttpReadTimeoutTests.java, +import org.elasticsearch.env.TestEnvironment;, +        Environment environment = TestEnvironment.newEnvironment(Settings.builder().put("path.home", createTempDir()).build());, +        Environment environment = TestEnvironment.newEnvironment(Settings.builder().put("path.home", createTempDir()).build());, +        Environment environment = TestEnvironment.newEnvironment(Settings.builder().put("path.home", createTempDir()).build());, +++ b/plugin/src/test/java/org/elasticsearch/xpack/extensions/InstallXPackExtensionCommandTests.java, +import org.elasticsearch.env.TestEnvironment;, +        env = TestEnvironment.newEnvironment(Settings.builder().put("path.home", home.toString()).build());, +        Environment env = TestEnvironment.newEnvironment(Settings.builder().put("path.home", home).build());, +++ b/plugin/src/test/java/org/elasticsearch/xpack/common/http/HttpClientTests.java, +import org.elasticsearch.env.TestEnvironment;, +    private Environment environment = TestEnvironment.newEnvironment(Settings.builder().put("path.home", createTempDir()).build());, +++ b/plugin/src/test/java/org/elasticsearch/xpack/common/http/HttpConnectionTimeoutTests.java, +import org.elasticsearch.env.TestEnvironment;, +        Environment environment = TestEnvironment.newEnvironment(Settings.builder().put("path.home", createTempDir()).build());, +        Environment environment = TestEnvironment.newEnvironment(Settings.builder().put("path.home", createTempDir()).build());, +        Environment environment = TestEnvironment.newEnvironment(Settings.builder().put("path.home", createTempDir()).build());, +++ b/plugin/src/test/java/org/elasticsearch/xpack/common/http/HttpReadTimeoutTests.java, +import org.elasticsearch.env.TestEnvironment;, +        Environment environment = TestEnvironment.newEnvironment(Settings.builder().put("path.home", createTempDir()).build());, +        Environment environment = TestEnvironment.newEnvironment(Settings.builder().put("path.home", createTempDir()).build());, +        Environment environment = TestEnvironment.newEnvironment(Settings.builder().put("path.home", createTempDir()).build());, +++ b/plugin/src/test/java/org/elasticsearch/xpack/extensions/InstallXPackExtensionCommandTests.java, +import org.elasticsearch.env.TestEnvironment;, +        env = TestEnvironment.newEnvironment(Settings.builder().put("path.home", home.toString()).build());, +        Environment env = TestEnvironment.newEnvironment(Settings.builder().put("path.home", home).build());, +++ b/plugin/src/test/java/org/elasticsearch/xpack/extensions/ListXPackExtensionCommandTests.java, +import org.elasticsearch.env.TestEnvironment;, +        env = TestEnvironment.newEnvironment(settings);, +++ b/plugin/src/test/java/org/elasticsearch/xpack/common/http/HttpClientTests.java, +import org.elasticsearch.env.TestEnvironment;, +    private Environment environment = TestEnvironment.newEnvironment(Settings.builder().put("path.home", createTempDir()).build());, +++ b/plugin/src/test/java/org/elasticsearch/xpack/common/http/HttpConnectionTimeoutTests.java, +import org.elasticsearch.env.TestEnvironment;, +        Environment environment = TestEnvironment.newEnvironment(Settings.builder().put("path.home", createTempDir()).build());, +        Environment environment = TestEnvironment.newEnvironment(Settings.builder().put("path.home", createTempDir()).build());, +        Environment environment = TestEnvironment.newEnvironment(Settings.builder().put("path.home", createTempDir()).build());, +++ b/plugin/src/test/java/org/elasticsearch/xpack/common/http/HttpReadTimeoutTests.java, +import org.elasticsearch.env.TestEnvironment;, +        Environment environment = TestEnvironment.newEnvironment(Settings.builder().put("path.home", createTempDir()).build());, +        Environment environment = TestEnvironment.newEnvironment(Settings.builder().put("path.home", createTempDir()).build());, +        Environment environment = TestEnvironment.newEnvironment(Settings.builder().put("path.home", createTempDir()).build());, +++ b/plugin/src/test/java/org/elasticsearch/xpack/extensions/InstallXPackExtensionCommandTests.java, +import org.elasticsearch.env.TestEnvironment;, +        env = TestEnvironment.newEnvironment(Settings.builder().put("path.home", home.toString()).build());, +        Environment env = TestEnvironment.newEnvironment(Settings.builder().put("path.home", home).build());, +++ b/plugin/src/test/java/org/elasticsearch/xpack/extensions/ListXPackExtensionCommandTests.java, +import org.elasticsearch.env.TestEnvironment;, +        env = TestEnvironment.newEnvironment(settings);, +++ b/plugin/src/test/java/org/elasticsearch/xpack/extensions/RemoveXPackExtensionCommandTests.java, +import org.elasticsearch.env.TestEnvironment;, +        env = TestEnvironment.newEnvironment(Settings.builder().put("path.home", home.toString()).build());, +        Environment env = TestEnvironment.newEnvironment(Settings.builder().put("path.home", home).build());, +++ b/plugin/src/test/java/org/elasticsearch/xpack/common/http/HttpClientTests.java, +import org.elasticsearch.env.TestEnvironment;, +    private Environment environment = TestEnvironment.newEnvironment(Settings.builder().put("path.home", createTempDir()).build());, +++ b/plugin/src/test/java/org/elasticsearch/xpack/common/http/HttpConnectionTimeoutTests.java, +import org.elasticsearch.env.TestEnvironment;, +        Environment environment = TestEnvironment.newEnvironment(Settings.builder().put("path.home", createTempDir()).build());, +        Environment environment = TestEnvironment.newEnvironment(Settings.builder().put("path.home", createTempDir()).build());, +        Environment environment = TestEnvironment.newEnvironment(Settings.builder().put("path.home", createTempDir()).build());, +++ b/plugin/src/test/java/org/elasticsearch/xpack/common/http/HttpReadTimeoutTests.java, +import org.elasticsearch.env.TestEnvironment;, +        Environment environment = TestEnvironment.newEnvironment(Settings.builder().put("path.home", createTempDir()).build());, +        Environment environment = TestEnvironment.newEnvironment(Settings.builder().put("path.home", createTempDir()).build());, +        Environment environment = TestEnvironment.newEnvironment(Settings.builder().put("path.home", createTempDir()).build());, +++ b/plugin/src/test/java/org/elasticsearch/xpack/extensions/InstallXPackExtensionCommandTests.java, +import org.elasticsearch.env.TestEnvironment;]
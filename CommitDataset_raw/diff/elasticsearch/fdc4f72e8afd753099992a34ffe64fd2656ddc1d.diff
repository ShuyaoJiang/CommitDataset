[+++ b/src/main/java/org/elasticsearch/common/jna/Natives.java, +import java.util.Locale;, +, +    // Set to true, in case native mlockall call was successful, +    public static boolean LOCAL_MLOCKALL = false;, +            if (result != 0) {, +            } else {, +                LOCAL_MLOCKALL = true;, +            }, +++ b/src/main/java/org/elasticsearch/common/jna/Natives.java, +import java.util.Locale;, +, +    // Set to true, in case native mlockall call was successful, +    public static boolean LOCAL_MLOCKALL = false;, +            if (result != 0) {, +            } else {, +                LOCAL_MLOCKALL = true;, +            }, +++ b/src/main/java/org/elasticsearch/monitor/process/ProcessInfo.java, +import org.elasticsearch.Version;, +import org.elasticsearch.common.jna.Natives;, +    private boolean mlockall;, +, +        this.mlockall = Natives.LOCAL_MLOCKALL;, +    public boolean mlockAll() {, +        return mlockall;, +    }, +, +    public boolean isMlockall() {, +        return mlockall;, +    }, +, +        static final XContentBuilderString MLOCKALL = new XContentBuilderString("mlockall");, +        builder.field(Fields.MLOCKALL, mlockall);, +        if (in.getVersion().after(Version.V_0_90_7)) {, +            mlockall = in.readBoolean();, +        }, +        if (out.getVersion().after(Version.V_0_90_7)) {, +            out.writeBoolean(mlockall);, +        }]
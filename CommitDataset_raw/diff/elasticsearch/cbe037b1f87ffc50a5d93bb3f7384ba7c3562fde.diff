[+++ b/server/src/test/java/org/elasticsearch/index/shard/IndexShardIT.java, +import org.elasticsearch.threadpool.ThreadPool;, +import org.elasticsearch.threadpool.ThreadPoolStats;, +    public void testPendingRefreshWithIntervalChange() throws Exception {, +        // ensure no scheduled refresh to compete with the scheduleRefresh we are going to verify., +        assertBusy(() -> {, +            for (ThreadPoolStats.Stats stat : indexService.getThreadPool().stats()) {, +                if (stat.getName().equals(ThreadPool.Names.REFRESH) && (stat.getQueue() > 0 || stat.getActive() > 0)) {, +                    throw new AssertionError(); // cause assert busy to retry, +                }, +            }, +        });]
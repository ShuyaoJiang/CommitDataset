[+++ b/src/test/java/org/elasticsearch/search/facet/SimpleFacetsTests.java, +import org.elasticsearch.common.joda.Joda;, +import org.joda.time.format.DateTimeFormatter;, +                .startObject("date_in_seconds").field("type", "long").endObject(), +        DateTimeFormatter parser = Joda.forPattern("dateOptionalTime").parser();, +                .field("date_in_seconds", TimeUnit.SECONDS.convert(parser.parseMillis("2009-03-05T01:01:01"), TimeUnit.MILLISECONDS)), +                .field("date_in_seconds", TimeUnit.SECONDS.convert(parser.parseMillis("2009-03-05T04:01:01"), TimeUnit.MILLISECONDS)), +                .field("date_in_seconds", TimeUnit.SECONDS.convert(parser.parseMillis("2009-03-06T01:01:01"), TimeUnit.MILLISECONDS)), +                    .addFacet(dateHistogramFacet("stats8").field("date_in_seconds").interval("day").factor(1000f).mode(mode)), +            , +            // check date_histogram on a long field containing date in seconds - we use a factor. , +            facet = searchResponse.getFacets().facet("stats8");, +            assertThat(facet.getName(), equalTo("stats8"));, +            assertThat(facet.getEntries().size(), equalTo(2));, +            assertThat(facet.getEntries().get(0).getTime(), equalTo(utcTimeInMillis("2009-03-05")));, +            assertThat(facet.getEntries().get(0).getCount(), equalTo(2l));, +            assertThat(facet.getEntries().get(1).getTime(), equalTo(utcTimeInMillis("2009-03-06")));, +            assertThat(facet.getEntries().get(1).getCount(), equalTo(1l));]
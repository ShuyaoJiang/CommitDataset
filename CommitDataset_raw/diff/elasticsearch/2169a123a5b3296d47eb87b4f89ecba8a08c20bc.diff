[+++ b/core/src/main/java/org/elasticsearch/index/shard/IndexShard.java, +                logger.debug("shard is now inactive");, +++ b/core/src/main/java/org/elasticsearch/index/shard/IndexShard.java, +                logger.debug("shard is now inactive");, +++ b/core/src/main/java/org/elasticsearch/indices/memory/IndexingMemoryController.java, +        List<IndexShard> activeShards = new ArrayList<>();, +                    activeShards.add(shard);, +        return activeShards;, +                logger.debug("no active shards");, +            boolean idle = shard.checkIdle();, +            if (idle && logger.isDebugEnabled()) {, +                logger.debug("marking shard {} as inactive (inactive_time[{}]) indexing wise",, +                    shard.shardId(),, +                    shard.getInactiveTime());, +            }, +            return idle;, +++ b/core/src/main/java/org/elasticsearch/index/shard/IndexShard.java, +                logger.debug("shard is now inactive");, +++ b/core/src/main/java/org/elasticsearch/indices/memory/IndexingMemoryController.java, +        List<IndexShard> activeShards = new ArrayList<>();, +                    activeShards.add(shard);, +        return activeShards;, +                logger.debug("no active shards");, +            boolean idle = shard.checkIdle();, +            if (idle && logger.isDebugEnabled()) {, +                logger.debug("marking shard {} as inactive (inactive_time[{}]) indexing wise",, +                    shard.shardId(),, +                    shard.getInactiveTime());, +            }, +            return idle;, +++ b/core/src/main/java/org/elasticsearch/script/ClassPermission.java, +/*, + * Licensed to Elasticsearch under one or more contributor, + * license agreements. See the NOTICE file distributed with, + * this work for additional information regarding copyright, + * ownership. Elasticsearch licenses this file to you under, + * the Apache License, Version 2.0 (the "License"); you may, + * not use this file except in compliance with the License., + * You may obtain a copy of the License at, + *, + *    http://www.apache.org/licenses/LICENSE-2.0, + *, + * Unless required by applicable law or agreed to in writing,, + * software distributed under the License is distributed on an, + * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY, + * KIND, either express or implied.  See the License for the, + * specific language governing permissions and limitations, + * under the License., + */, +, +package org.elasticsearch.script;, +, +import java.security.BasicPermission;, +import java.security.Permission;, +import java.security.PermissionCollection;, +import java.util.Arrays;, +import java.util.Collections;, +import java.util.Enumeration;, +import java.util.HashSet;, +import java.util.Set;, +, +/**, + * Checked by scripting engines to allow loading a java class., + * <p>, + * Examples:, + * <p>, + * Allow permission to {@code java.util.List}, + * <pre>permission org.elasticsearch.script.ClassPermission "java.util.List";</pre>, + * Allow permission to classes underneath {@code java.util} (and its subpackages such as {@code java.util.zip}), + * <pre>permission org.elasticsearch.script.ClassPermission "java.util.*";</pre>, + * Allow permission to standard predefined list of basic classes (see list below), + * <pre>permission org.elasticsearch.script.ClassPermission "&lt;&lt;STANDARD&gt;&gt;";</pre>, + * Allow permission to all classes, + * <pre>permission org.elasticsearch.script.ClassPermission "*";</pre>, + * <p>, + * Set of classes (allowed by special value <code>&lt;&lt;STANDARD&gt;&gt;</code>):, + * <ul>, + *   <li>{@link java.lang.Boolean}</li>, + *   <li>{@link java.lang.Byte}</li>, + *   <li>{@link java.lang.Character}</li>, + *   <li>{@link java.lang.Double}</li>, + *   <li>{@link java.lang.Integer}</li>, + *   <li>{@link java.lang.Long}</li>, + *   <li>{@link java.lang.Math}</li>, + *   <li>{@link java.lang.Object}</li>, + *   <li>{@link java.lang.Short}</li>, + *   <li>{@link java.lang.String}</li>, + *   <li>{@link java.math.BigDecimal}</li>, + *   <li>{@link java.util.ArrayList}</li>, + *   <li>{@link java.util.Arrays}</li>, + *   <li>{@link java.util.Date}</li>, + *   <li>{@link java.util.HashMap}</li>, + *   <li>{@link java.util.HashSet}</li>, + *   <li>{@link java.util.Iterator}</li>, + *   <li>{@link java.util.List}</li>, + *   <li>{@link java.util.Map}</li>, + *   <li>{@link java.util.Set}</li>, + *   <li>{@link java.util.UUID}</li>, + *   <li>{@link org.joda.time.DateTime}</li>, + *   <li>{@link org.joda.time.DateTimeUtils}</li>]
[+++ b/server/src/main/java/org/elasticsearch/index/mapper/CompletionFieldMapper.java, +            if (input.trim().isEmpty()) {, +                context.addIgnoredField(fieldType.name());, +                continue;, +            }, +++ b/server/src/main/java/org/elasticsearch/index/mapper/CompletionFieldMapper.java, +            if (input.trim().isEmpty()) {, +                context.addIgnoredField(fieldType.name());, +                continue;, +            }, +++ b/server/src/test/java/org/elasticsearch/index/mapper/CompletionFieldMapperTests.java, +, +        // empty inputs are ignored, +        ParsedDocument doc = defaultMapper.parse(SourceToParse.source("test", "type1", "1", BytesReference, +                .bytes(XContentFactory.jsonBuilder(), +                    .startObject(), +                    .array("completion", "   ", ""), +                    .endObject()),, +            XContentType.JSON));, +        assertThat(doc.docs().size(), equalTo(1));, +        assertNull(doc.docs().get(0).get("completion"));, +        assertNotNull(doc.docs().get(0).getField("_ignored"));, +        IndexableField ignoredFields = doc.docs().get(0).getField("_ignored");, +        assertThat(ignoredFields.stringValue(), equalTo("completion"));]
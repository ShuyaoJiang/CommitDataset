[+++ b/x-pack/plugin/sql/qa/src/main/resources/datetime.csv-spec, +, +// datetime in aggregations, +doubleCastOfDateInAggs, +SELECT CAST (CAST (birth_date AS VARCHAR) AS TIMESTAMP) a FROM test_emp WHERE YEAR(birth_date) = 1965 GROUP BY a;, +    a:ts, +---------------, +1965-01-03T00:00:00Z, +;, +++ b/x-pack/plugin/sql/qa/src/main/resources/datetime.csv-spec, +, +// datetime in aggregations, +doubleCastOfDateInAggs, +SELECT CAST (CAST (birth_date AS VARCHAR) AS TIMESTAMP) a FROM test_emp WHERE YEAR(birth_date) = 1965 GROUP BY a;, +    a:ts, +---------------, +1965-01-03T00:00:00Z, +;, +++ b/x-pack/plugin/sql/src/main/java/org/elasticsearch/xpack/sql/querydsl/agg/GroupByKey.java, +                builder.valueType(ValueType.LONG);, +++ b/x-pack/plugin/sql/qa/src/main/resources/datetime.csv-spec, +, +// datetime in aggregations, +doubleCastOfDateInAggs, +SELECT CAST (CAST (birth_date AS VARCHAR) AS TIMESTAMP) a FROM test_emp WHERE YEAR(birth_date) = 1965 GROUP BY a;, +    a:ts, +---------------, +1965-01-03T00:00:00Z, +;, +++ b/x-pack/plugin/sql/src/main/java/org/elasticsearch/xpack/sql/querydsl/agg/GroupByKey.java, +                builder.valueType(ValueType.LONG);, +++ b/x-pack/plugin/sql/src/test/java/org/elasticsearch/xpack/sql/planner/QueryFolderTests.java, +                "\"value_type\":\"long\",\"order\":\"asc\"}}}]}}}"));]
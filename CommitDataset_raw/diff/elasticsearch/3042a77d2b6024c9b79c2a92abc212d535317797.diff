[+++ b/buildSrc/src/main/resources/checkstyle_suppressions.xml, +++ b/buildSrc/src/main/resources/checkstyle_suppressions.xml, +++ b/core/src/main/java/org/elasticsearch/action/admin/cluster/allocation/TransportClusterAllocationExplainAction.java, +        final RoutingAllocation allocation = new RoutingAllocation(allocationDeciders, routingNodes, state,, +++ b/buildSrc/src/main/resources/checkstyle_suppressions.xml, +++ b/core/src/main/java/org/elasticsearch/action/admin/cluster/allocation/TransportClusterAllocationExplainAction.java, +        final RoutingAllocation allocation = new RoutingAllocation(allocationDeciders, routingNodes, state,, +++ b/core/src/main/java/org/elasticsearch/cluster/routing/RoutingNodes.java, +++ b/buildSrc/src/main/resources/checkstyle_suppressions.xml, +++ b/core/src/main/java/org/elasticsearch/action/admin/cluster/allocation/TransportClusterAllocationExplainAction.java, +        final RoutingAllocation allocation = new RoutingAllocation(allocationDeciders, routingNodes, state,, +++ b/core/src/main/java/org/elasticsearch/cluster/routing/RoutingNodes.java, +++ b/core/src/main/java/org/elasticsearch/cluster/routing/allocation/AllocationService.java, +        StartedRerouteAllocation allocation = new StartedRerouteAllocation(allocationDeciders, routingNodes, clusterState, startedShards, clusterInfoService.getClusterInfo());, +        FailedRerouteAllocation allocation = new FailedRerouteAllocation(allocationDeciders, routingNodes, clusterState, failedShards, clusterInfoService.getClusterInfo());, +        RoutingAllocation allocation = new RoutingAllocation(allocationDeciders, routingNodes, clusterState, clusterInfoService.getClusterInfo(), currentNanoTime());, +        RoutingAllocation allocation = new RoutingAllocation(allocationDeciders, routingNodes, clusterState, clusterInfoService.getClusterInfo(), currentNanoTime());, +++ b/buildSrc/src/main/resources/checkstyle_suppressions.xml, +++ b/core/src/main/java/org/elasticsearch/action/admin/cluster/allocation/TransportClusterAllocationExplainAction.java, +        final RoutingAllocation allocation = new RoutingAllocation(allocationDeciders, routingNodes, state,, +++ b/core/src/main/java/org/elasticsearch/cluster/routing/RoutingNodes.java, +++ b/core/src/main/java/org/elasticsearch/cluster/routing/allocation/AllocationService.java, +        StartedRerouteAllocation allocation = new StartedRerouteAllocation(allocationDeciders, routingNodes, clusterState, startedShards, clusterInfoService.getClusterInfo());, +        FailedRerouteAllocation allocation = new FailedRerouteAllocation(allocationDeciders, routingNodes, clusterState, failedShards, clusterInfoService.getClusterInfo());, +        RoutingAllocation allocation = new RoutingAllocation(allocationDeciders, routingNodes, clusterState, clusterInfoService.getClusterInfo(), currentNanoTime());, +        RoutingAllocation allocation = new RoutingAllocation(allocationDeciders, routingNodes, clusterState, clusterInfoService.getClusterInfo(), currentNanoTime());, +++ b/core/src/main/java/org/elasticsearch/cluster/routing/allocation/FailedRerouteAllocation.java, +import org.elasticsearch.cluster.ClusterState;, +    public FailedRerouteAllocation(AllocationDeciders deciders, RoutingNodes routingNodes, ClusterState clusterState, List<FailedShard> failedShards, ClusterInfo clusterInfo) {, +        super(deciders, routingNodes, clusterState, clusterInfo, System.nanoTime());, +++ b/buildSrc/src/main/resources/checkstyle_suppressions.xml, +++ b/core/src/main/java/org/elasticsearch/action/admin/cluster/allocation/TransportClusterAllocationExplainAction.java, +        final RoutingAllocation allocation = new RoutingAllocation(allocationDeciders, routingNodes, state,, +++ b/core/src/main/java/org/elasticsearch/cluster/routing/RoutingNodes.java, +++ b/core/src/main/java/org/elasticsearch/cluster/routing/allocation/AllocationService.java, +        StartedRerouteAllocation allocation = new StartedRerouteAllocation(allocationDeciders, routingNodes, clusterState, startedShards, clusterInfoService.getClusterInfo());, +        FailedRerouteAllocation allocation = new FailedRerouteAllocation(allocationDeciders, routingNodes, clusterState, failedShards, clusterInfoService.getClusterInfo());, +        RoutingAllocation allocation = new RoutingAllocation(allocationDeciders, routingNodes, clusterState, clusterInfoService.getClusterInfo(), currentNanoTime());, +        RoutingAllocation allocation = new RoutingAllocation(allocationDeciders, routingNodes, clusterState, clusterInfoService.getClusterInfo(), currentNanoTime());, +++ b/core/src/main/java/org/elasticsearch/cluster/routing/allocation/FailedRerouteAllocation.java, +import org.elasticsearch.cluster.ClusterState;, +    public FailedRerouteAllocation(AllocationDeciders deciders, RoutingNodes routingNodes, ClusterState clusterState, List<FailedShard> failedShards, ClusterInfo clusterInfo) {, +        super(deciders, routingNodes, clusterState, clusterInfo, System.nanoTime());, +++ b/core/src/main/java/org/elasticsearch/cluster/routing/allocation/RoutingAllocation.java, +import org.elasticsearch.cluster.ClusterState;, +import org.elasticsearch.common.collect.ImmutableOpenMap;, +    private final MetaData metaData;, +, +    private final ImmutableOpenMap<String, ClusterState.Custom> customs;, +, +     * @param clusterState cluster state before rerouting, +    public RoutingAllocation(AllocationDeciders deciders, RoutingNodes routingNodes, ClusterState clusterState, ClusterInfo clusterInfo, long currentNanoTime) {, +        this.metaData = clusterState.metaData();, +        this.nodes = clusterState.nodes();, +        this.customs = clusterState.customs();, +        return metaData;, +    public <T extends ClusterState.Custom> T custom(String key) {, +        return (T)customs.get(key);, +    }, +, +++ b/buildSrc/src/main/resources/checkstyle_suppressions.xml, +++ b/core/src/main/java/org/elasticsearch/action/admin/cluster/allocation/TransportClusterAllocationExplainAction.java, +        final RoutingAllocation allocation = new RoutingAllocation(allocationDeciders, routingNodes, state,, +++ b/core/src/main/java/org/elasticsearch/cluster/routing/RoutingNodes.java, +++ b/core/src/main/java/org/elasticsearch/cluster/routing/allocation/AllocationService.java, +        StartedRerouteAllocation allocation = new StartedRerouteAllocation(allocationDeciders, routingNodes, clusterState, startedShards, clusterInfoService.getClusterInfo());, +        FailedRerouteAllocation allocation = new FailedRerouteAllocation(allocationDeciders, routingNodes, clusterState, failedShards, clusterInfoService.getClusterInfo());, +        RoutingAllocation allocation = new RoutingAllocation(allocationDeciders, routingNodes, clusterState, clusterInfoService.getClusterInfo(), currentNanoTime());, +        RoutingAllocation allocation = new RoutingAllocation(allocationDeciders, routingNodes, clusterState, clusterInfoService.getClusterInfo(), currentNanoTime());, +++ b/core/src/main/java/org/elasticsearch/cluster/routing/allocation/FailedRerouteAllocation.java, +import org.elasticsearch.cluster.ClusterState;, +    public FailedRerouteAllocation(AllocationDeciders deciders, RoutingNodes routingNodes, ClusterState clusterState, List<FailedShard> failedShards, ClusterInfo clusterInfo) {, +        super(deciders, routingNodes, clusterState, clusterInfo, System.nanoTime());, +++ b/core/src/main/java/org/elasticsearch/cluster/routing/allocation/RoutingAllocation.java, +import org.elasticsearch.cluster.ClusterState;, +import org.elasticsearch.common.collect.ImmutableOpenMap;, +    private final MetaData metaData;, +, +    private final ImmutableOpenMap<String, ClusterState.Custom> customs;, +, +     * @param clusterState cluster state before rerouting, +    public RoutingAllocation(AllocationDeciders deciders, RoutingNodes routingNodes, ClusterState clusterState, ClusterInfo clusterInfo, long currentNanoTime) {, +        this.metaData = clusterState.metaData();, +        this.nodes = clusterState.nodes();, +        this.customs = clusterState.customs();, +        return metaData;, +    public <T extends ClusterState.Custom> T custom(String key) {, +        return (T)customs.get(key);, +    }, +, +++ b/core/src/main/java/org/elasticsearch/cluster/routing/allocation/StartedRerouteAllocation.java, +import org.elasticsearch.cluster.ClusterState;, +    public StartedRerouteAllocation(AllocationDeciders deciders, RoutingNodes routingNodes, ClusterState clusterState, List<? extends ShardRouting> startedShards, ClusterInfo clusterInfo) {, +        super(deciders, routingNodes, clusterState, clusterInfo, System.nanoTime());, +++ b/buildSrc/src/main/resources/checkstyle_suppressions.xml, +++ b/core/src/main/java/org/elasticsearch/action/admin/cluster/allocation/TransportClusterAllocationExplainAction.java, +        final RoutingAllocation allocation = new RoutingAllocation(allocationDeciders, routingNodes, state,, +++ b/core/src/main/java/org/elasticsearch/cluster/routing/RoutingNodes.java, +++ b/core/src/main/java/org/elasticsearch/cluster/routing/allocation/AllocationService.java, +        StartedRerouteAllocation allocation = new StartedRerouteAllocation(allocationDeciders, routingNodes, clusterState, startedShards, clusterInfoService.getClusterInfo());]
[+++ b/x-pack/plugin/sql/src/main/java/org/elasticsearch/xpack/sql/expression/function/aggregate/Avg.java, +import java.util.List;, +, +        return DataType.DOUBLE;, +++ b/x-pack/plugin/sql/src/main/java/org/elasticsearch/xpack/sql/expression/function/aggregate/Avg.java, +import java.util.List;, +, +        return DataType.DOUBLE;, +++ b/x-pack/qa/sql/src/main/resources/agg.csv-spec, +      max:bt   |      min:bt   |      sum:bt   |      avg:d   |    percent:d  | percent_rank:d|   kurtosis:d  |   skewness:d    , +++ b/x-pack/plugin/sql/src/main/java/org/elasticsearch/xpack/sql/expression/function/aggregate/Avg.java, +import java.util.List;, +, +        return DataType.DOUBLE;, +++ b/x-pack/qa/sql/src/main/resources/agg.csv-spec, +      max:bt   |      min:bt   |      sum:bt   |      avg:d   |    percent:d  | percent_rank:d|   kurtosis:d  |   skewness:d    , +++ b/x-pack/qa/sql/src/main/resources/agg.sql-spec, +SELECT CAST(FLOOR(AVG(salary)) AS INT) AS avg FROM test_emp;, +++ b/x-pack/plugin/sql/src/main/java/org/elasticsearch/xpack/sql/expression/function/aggregate/Avg.java, +import java.util.List;, +, +        return DataType.DOUBLE;, +++ b/x-pack/qa/sql/src/main/resources/agg.csv-spec, +      max:bt   |      min:bt   |      sum:bt   |      avg:d   |    percent:d  | percent_rank:d|   kurtosis:d  |   skewness:d    , +++ b/x-pack/qa/sql/src/main/resources/agg.sql-spec, +SELECT CAST(FLOOR(AVG(salary)) AS INT) AS avg FROM test_emp;, +++ b/x-pack/qa/sql/src/main/resources/arithmetic.sql-spec, +SELECT CAST((MAX(emp_no) - MIN(emp_no)) + FLOOR(AVG(emp_no)) AS INT) AS x FROM test_emp GROUP BY gender ORDER BY gender;, +++ b/x-pack/plugin/sql/src/main/java/org/elasticsearch/xpack/sql/expression/function/aggregate/Avg.java, +import java.util.List;, +, +        return DataType.DOUBLE;, +++ b/x-pack/qa/sql/src/main/resources/agg.csv-spec, +      max:bt   |      min:bt   |      sum:bt   |      avg:d   |    percent:d  | percent_rank:d|   kurtosis:d  |   skewness:d    , +++ b/x-pack/qa/sql/src/main/resources/agg.sql-spec, +SELECT CAST(FLOOR(AVG(salary)) AS INT) AS avg FROM test_emp;, +++ b/x-pack/qa/sql/src/main/resources/arithmetic.sql-spec, +SELECT CAST((MAX(emp_no) - MIN(emp_no)) + FLOOR(AVG(emp_no)) AS INT) AS x FROM test_emp GROUP BY gender ORDER BY gender;, +++ b/x-pack/qa/sql/src/main/resources/docs.csv-spec, +      min:i    |      max:i    |      avg:d    |     count:l     , +      avg:d      , +++ b/x-pack/plugin/sql/src/main/java/org/elasticsearch/xpack/sql/expression/function/aggregate/Avg.java, +import java.util.List;, +, +        return DataType.DOUBLE;, +++ b/x-pack/qa/sql/src/main/resources/agg.csv-spec, +      max:bt   |      min:bt   |      sum:bt   |      avg:d   |    percent:d  | percent_rank:d|   kurtosis:d  |   skewness:d    , +++ b/x-pack/qa/sql/src/main/resources/agg.sql-spec, +SELECT CAST(FLOOR(AVG(salary)) AS INT) AS avg FROM test_emp;, +++ b/x-pack/qa/sql/src/main/resources/arithmetic.sql-spec, +SELECT CAST((MAX(emp_no) - MIN(emp_no)) + FLOOR(AVG(emp_no)) AS INT) AS x FROM test_emp GROUP BY gender ORDER BY gender;, +++ b/x-pack/qa/sql/src/main/resources/docs.csv-spec, +      min:i    |      max:i    |      avg:d    |     count:l     , +      avg:d      , +++ b/x-pack/qa/sql/src/main/resources/math.csv-spec, +      mi:i     |      ma:i     |       c:l     |      tr:d       , +---------------+---------------+---------------+---------------, +28336          |74999          |10             |52519.0        , +25976          |73717          |15             |50576.0        , +29175          |73578          |19             |48178.0        , +26436          |74970          |17             |52418.0        , +27215          |74572          |18             |47733.0        , +25324          |66817          |21             |41680.0  , +minMaxTruncateAndRoundOfAverageWithHavingRoundAndTruncate, +      mi:i     |      ma:i     |     year:i    |ROUND(AVG(languages),1):d|TRUNCATE(AVG(languages),1):d|   COUNT(1):l    , +---------------+---------------+---------------+-------------------------+----------------------------+---------------, +25324          |70011          |1987           |3.0                      |3.0                         |15             , +25945          |73578          |1988           |2.9                      |2.8                         |9              , +25976          |74970          |1989           |3.0                      |3.0                         |13             , +minMaxRoundWithHavingRound, +      mi:i     |      ma:i     |     year:i    |ROUND(AVG(languages),1):d|   COUNT(1):l    , +---------------+---------------+---------------+-------------------------+---------------, +25324          |70011          |1987           |3.0                      |15             , +25945          |73578          |1988           |2.9                      |9              , +25976          |74970          |1989           |3.0                      |13             , +32568          |65030          |1991           |3.3                      |6              , +TRUNCATE(AVG(salary),2):d| AVG(salary):d |   COUNT(1):l    , +74999.0                  |74999.0        |1              , +74970.0                  |74970.0        |1              , +74572.0                  |74572.0        |1              , +73851.0                  |73851.0        |1              , +73717.0                  |73717.0        |1              , +73578.0                  |73578.0        |1              , +71165.0                  |71165.0        |1              , +70011.0                  |70011.0        |1              , +69904.0                  |69904.0        |1              , +68547.0                  |68547.0        |1     , +ROUND(AVG(salary),2):d| AVG(salary):d |   COUNT(1):l    , +----------------------+---------------+---------------, +74999.0               |74999.0        |1              , +74970.0               |74970.0        |1              , +74572.0               |74572.0        |1              , +73851.0               |73851.0        |1              , +73717.0               |73717.0        |1              , +73578.0               |73578.0        |1              , +71165.0               |71165.0        |1              , +70011.0               |70011.0        |1              , +69904.0               |69904.0        |1              , +68547.0               |68547.0        |1        , +ROUND(AVG(salary),0):d|   rounded:i   | AVG(salary):d |   COUNT(1):l    ]
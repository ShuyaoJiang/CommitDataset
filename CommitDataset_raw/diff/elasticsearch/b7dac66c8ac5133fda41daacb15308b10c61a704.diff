[+++ b/src/main/java/org/elasticsearch/shield/User.java, +import java.util.Arrays;, +, +, +        @Override, +        public boolean equals(Object o) {, +            if (this == o) return true;, +            if (o == null || getClass() != o.getClass()) return false;, +, +            Simple simple = (Simple) o;, +, +            if (!Arrays.equals(roles, simple.roles)) return false;, +            if (!username.equals(simple.username)) return false;, +, +            return true;, +        }, +, +        @Override, +        public int hashCode() {, +            int result = username.hashCode();, +            result = 31 * result + Arrays.hashCode(roles);, +            return result;, +        }, +, +++ b/src/main/java/org/elasticsearch/shield/User.java, +import java.util.Arrays;, +, +, +        @Override, +        public boolean equals(Object o) {, +            if (this == o) return true;, +            if (o == null || getClass() != o.getClass()) return false;, +, +            Simple simple = (Simple) o;, +, +            if (!Arrays.equals(roles, simple.roles)) return false;, +            if (!username.equals(simple.username)) return false;, +, +            return true;, +        }, +, +        @Override, +        public int hashCode() {, +            int result = username.hashCode();, +            result = 31 * result + Arrays.hashCode(roles);, +            return result;, +        }, +, +++ b/src/main/java/org/elasticsearch/shield/authc/esusers/ESUsersModule.java, +            bind(ESUsersRealm.class).asEagerSingleton();, +++ b/src/main/java/org/elasticsearch/shield/User.java, +import java.util.Arrays;, +, +, +        @Override, +        public boolean equals(Object o) {, +            if (this == o) return true;, +            if (o == null || getClass() != o.getClass()) return false;, +, +            Simple simple = (Simple) o;, +, +            if (!Arrays.equals(roles, simple.roles)) return false;, +            if (!username.equals(simple.username)) return false;, +, +            return true;, +        }, +, +        @Override, +        public int hashCode() {, +            int result = username.hashCode();, +            result = 31 * result + Arrays.hashCode(roles);, +            return result;, +        }, +, +++ b/src/main/java/org/elasticsearch/shield/authc/esusers/ESUsersModule.java, +            bind(ESUsersRealm.class).asEagerSingleton();, +++ b/src/main/java/org/elasticsearch/shield/authc/esusers/ESUsersRealm.java, +import org.elasticsearch.shield.authc.support.CachingUsernamePasswordRealm;, +public class ESUsersRealm extends CachingUsernamePasswordRealm {, +    protected User doAuthenticate(UsernamePasswordToken token) {, +++ b/src/main/java/org/elasticsearch/shield/User.java, +import java.util.Arrays;, +, +, +        @Override, +        public boolean equals(Object o) {, +            if (this == o) return true;, +            if (o == null || getClass() != o.getClass()) return false;, +, +            Simple simple = (Simple) o;, +, +            if (!Arrays.equals(roles, simple.roles)) return false;, +            if (!username.equals(simple.username)) return false;, +, +            return true;, +        }, +, +        @Override, +        public int hashCode() {, +            int result = username.hashCode();]
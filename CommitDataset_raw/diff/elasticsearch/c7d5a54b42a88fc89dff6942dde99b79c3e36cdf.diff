[+++ b/server/src/main/java/org/elasticsearch/index/query/GeoShapeQueryBuilder.java, +                                        return;, +++ b/server/src/main/java/org/elasticsearch/index/query/GeoShapeQueryBuilder.java, +                                        return;, +++ b/server/src/test/java/org/elasticsearch/index/query/GeoShapeQueryBuilderTests.java, +            builder.field(randomAlphaOfLengthBetween(10, 20), "something");, +        GeoShapeQueryBuilder query = doCreateTestQueryBuilder(true);, +    public void testMultipleRewrite() throws IOException {, +        GeoShapeQueryBuilder shape = doCreateTestQueryBuilder(true);, +        QueryBuilder builder = new BoolQueryBuilder(), +            .should(shape), +            .should(shape);, +, +        builder = rewriteAndFetch(builder, createShardContext());, +, +        GeoShapeQueryBuilder expectedShape = new GeoShapeQueryBuilder(GEO_SHAPE_FIELD_NAME, indexedShapeToReturn);, +        expectedShape.strategy(shape.strategy());, +        expectedShape.relation(shape.relation());, +        QueryBuilder expected = new BoolQueryBuilder(), +            .should(expectedShape), +            .should(expectedShape);, +        assertEquals(expected, builder);, +    }, +]
[+++ b/modules/test/integration/src/test/java/org/elasticsearch/test/integration/search/scan/SearchScanTests.java, +    @Test public void shard1docs100size99() throws Exception {, +        testScroll(1, 100, 99);, +    }, +, +    @Test public void shard1docs100size100() throws Exception {, +        testScroll(1, 100, 100);, +    }, +, +    @Test public void shard1docs100size101() throws Exception {, +        testScroll(1, 100, 101);, +    }, +, +    @Test public void shard3docs100size3Unbalanced() throws Exception {, +        testScroll(3, 100, 3, true);, +    }, +, +    @Test public void shard3docs100size7Unbalanced() throws Exception {, +        testScroll(3, 100, 7, true);, +    }, +, +    @Test public void shard3docs100size13Unbalanced() throws Exception {, +        testScroll(3, 100, 13, true);, +    }, +, +    @Test public void shard3docs100size24Unbalanced() throws Exception {, +        testScroll(3, 100, 24, true);, +    }, +, +    @Test public void shard3docs100size45Unbalanced() throws Exception {, +        testScroll(3, 100, 45, true);, +    }, +, +    @Test public void shard3docs100size63Unbalanced() throws Exception {, +        testScroll(3, 100, 63, true);, +    }, +, +    @Test public void shard3docs100size89Unbalanced() throws Exception {, +        testScroll(3, 100, 89, true);, +    }, +, +    @Test public void shard3docs100size120Unbalanced() throws Exception {, +        testScroll(3, 100, 120);, +    }, +, +        testScroll(numberOfShards, numberOfDocs, size, false);, +    }, +, +    private void testScroll(int numberOfShards, long numberOfDocs, int size, boolean unbalanced) throws Exception {, +            String routing = null;, +            if (unbalanced) {, +                if (i < (numberOfDocs * 0.6)) {, +                    routing = "0";, +                } else if (i < (numberOfDocs * 0.9)) {, +                    routing = "1";, +                } else {, +                    routing = "2";, +                }, +            }, +            client.prepareIndex("test", "type1", id).setRouting(routing).setSource("field", i).execute().actionGet();]
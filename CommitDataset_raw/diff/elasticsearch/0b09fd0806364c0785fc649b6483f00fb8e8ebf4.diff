[+++ b/modules/elasticsearch/src/main/java/org/elasticsearch/search/facet/geodistance/GeoDistanceFacet.java, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/search/facet/geodistance/GeoDistanceFacet.java, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/search/facet/geodistance/GeoDistanceFacetCollector.java, +        return new InternalGeoDistanceFacet(facetName, entries);, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/search/facet/geodistance/GeoDistanceFacet.java, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/search/facet/geodistance/GeoDistanceFacetCollector.java, +        return new InternalGeoDistanceFacet(facetName, entries);, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/search/facet/geodistance/InternalGeoDistanceFacet.java, +    public InternalGeoDistanceFacet(String name, Entry[] entries) {, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/search/facet/geodistance/GeoDistanceFacet.java, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/search/facet/geodistance/GeoDistanceFacetCollector.java, +        return new InternalGeoDistanceFacet(facetName, entries);, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/search/facet/geodistance/InternalGeoDistanceFacet.java, +    public InternalGeoDistanceFacet(String name, Entry[] entries) {, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/search/facet/geodistance/ValueGeoDistanceFacetCollector.java, +        return new InternalGeoDistanceFacet(facetName, entries);, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/search/facet/geodistance/GeoDistanceFacet.java, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/search/facet/geodistance/GeoDistanceFacetCollector.java, +        return new InternalGeoDistanceFacet(facetName, entries);, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/search/facet/geodistance/InternalGeoDistanceFacet.java, +    public InternalGeoDistanceFacet(String name, Entry[] entries) {, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/search/facet/geodistance/ValueGeoDistanceFacetCollector.java, +        return new InternalGeoDistanceFacet(facetName, entries);, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/search/facet/histogram/CountAndTotalHistogramFacetCollector.java, +        return new InternalCountAndTotalHistogramFacet(facetName, comparatorType, histoProc.counts(), histoProc.totals());, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/search/facet/geodistance/GeoDistanceFacet.java, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/search/facet/geodistance/GeoDistanceFacetCollector.java, +        return new InternalGeoDistanceFacet(facetName, entries);, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/search/facet/geodistance/InternalGeoDistanceFacet.java, +    public InternalGeoDistanceFacet(String name, Entry[] entries) {, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/search/facet/geodistance/ValueGeoDistanceFacetCollector.java, +        return new InternalGeoDistanceFacet(facetName, entries);, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/search/facet/histogram/CountAndTotalHistogramFacetCollector.java, +        return new InternalCountAndTotalHistogramFacet(facetName, comparatorType, histoProc.counts(), histoProc.totals());, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/search/facet/histogram/CountHistogramFacetCollector.java, +        return new InternalCountHistogramFacet(facetName, comparatorType, histoProc.counts());, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/search/facet/geodistance/GeoDistanceFacet.java, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/search/facet/geodistance/GeoDistanceFacetCollector.java, +        return new InternalGeoDistanceFacet(facetName, entries);, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/search/facet/geodistance/InternalGeoDistanceFacet.java, +    public InternalGeoDistanceFacet(String name, Entry[] entries) {, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/search/facet/geodistance/ValueGeoDistanceFacetCollector.java, +        return new InternalGeoDistanceFacet(facetName, entries);, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/search/facet/histogram/CountAndTotalHistogramFacetCollector.java, +        return new InternalCountAndTotalHistogramFacet(facetName, comparatorType, histoProc.counts(), histoProc.totals());, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/search/facet/histogram/CountHistogramFacetCollector.java, +        return new InternalCountHistogramFacet(facetName, comparatorType, histoProc.counts());, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/search/facet/histogram/HistogramFacet.java, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/search/facet/geodistance/GeoDistanceFacet.java, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/search/facet/geodistance/GeoDistanceFacetCollector.java, +        return new InternalGeoDistanceFacet(facetName, entries);, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/search/facet/geodistance/InternalGeoDistanceFacet.java, +    public InternalGeoDistanceFacet(String name, Entry[] entries) {, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/search/facet/geodistance/ValueGeoDistanceFacetCollector.java, +        return new InternalGeoDistanceFacet(facetName, entries);, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/search/facet/histogram/CountAndTotalHistogramFacetCollector.java, +        return new InternalCountAndTotalHistogramFacet(facetName, comparatorType, histoProc.counts(), histoProc.totals());, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/search/facet/histogram/CountHistogramFacetCollector.java, +        return new InternalCountHistogramFacet(facetName, comparatorType, histoProc.counts());, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/search/facet/histogram/HistogramFacet.java, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/search/facet/histogram/InternalCountAndTotalHistogramFacet.java, +    public InternalCountAndTotalHistogramFacet(String name, ComparatorType comparatorType, TLongLongHashMap counts, TLongDoubleHashMap totals) {, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/search/facet/geodistance/GeoDistanceFacet.java, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/search/facet/geodistance/GeoDistanceFacetCollector.java, +        return new InternalGeoDistanceFacet(facetName, entries);, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/search/facet/geodistance/InternalGeoDistanceFacet.java, +    public InternalGeoDistanceFacet(String name, Entry[] entries) {, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/search/facet/geodistance/ValueGeoDistanceFacetCollector.java, +        return new InternalGeoDistanceFacet(facetName, entries);, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/search/facet/histogram/CountAndTotalHistogramFacetCollector.java, +        return new InternalCountAndTotalHistogramFacet(facetName, comparatorType, histoProc.counts(), histoProc.totals());, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/search/facet/histogram/CountHistogramFacetCollector.java, +        return new InternalCountHistogramFacet(facetName, comparatorType, histoProc.counts());, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/search/facet/histogram/HistogramFacet.java, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/search/facet/histogram/InternalCountAndTotalHistogramFacet.java, +    public InternalCountAndTotalHistogramFacet(String name, ComparatorType comparatorType, TLongLongHashMap counts, TLongDoubleHashMap totals) {, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/search/facet/histogram/InternalCountHistogramFacet.java, +    ComparatorType comparatorType;, +    public InternalCountHistogramFacet(String name, ComparatorType comparatorType, TLongLongHashMap counts) {, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/search/facet/geodistance/GeoDistanceFacet.java, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/search/facet/geodistance/GeoDistanceFacetCollector.java, +        return new InternalGeoDistanceFacet(facetName, entries);, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/search/facet/geodistance/InternalGeoDistanceFacet.java, +    public InternalGeoDistanceFacet(String name, Entry[] entries) {, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/search/facet/geodistance/ValueGeoDistanceFacetCollector.java, +        return new InternalGeoDistanceFacet(facetName, entries);, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/search/facet/histogram/CountAndTotalHistogramFacetCollector.java, +        return new InternalCountAndTotalHistogramFacet(facetName, comparatorType, histoProc.counts(), histoProc.totals());, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/search/facet/histogram/CountHistogramFacetCollector.java, +        return new InternalCountHistogramFacet(facetName, comparatorType, histoProc.counts());, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/search/facet/histogram/HistogramFacet.java, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/search/facet/histogram/InternalCountAndTotalHistogramFacet.java, +    public InternalCountAndTotalHistogramFacet(String name, ComparatorType comparatorType, TLongLongHashMap counts, TLongDoubleHashMap totals) {, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/search/facet/histogram/InternalCountHistogramFacet.java, +    ComparatorType comparatorType;, +    public InternalCountHistogramFacet(String name, ComparatorType comparatorType, TLongLongHashMap counts) {, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/search/facet/histogram/KeyValueHistogramFacetCollector.java, +        return new InternalCountAndTotalHistogramFacet(facetName, comparatorType, counts, totals);, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/search/facet/geodistance/GeoDistanceFacet.java, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/search/facet/geodistance/GeoDistanceFacetCollector.java]
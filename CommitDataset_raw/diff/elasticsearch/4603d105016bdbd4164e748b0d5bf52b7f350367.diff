[+++ b/modules/elasticsearch/src/main/java/org/elasticsearch/search/facet/datehistogram/ValueDateHistogramFacetCollector.java, +        final ValueAggregator valueAggregator = new ValueAggregator();, +, +                entry = new InternalFullDateHistogramFacet.FullEntry(time, 0, Double.MAX_VALUE, Double.MIN_VALUE, 0, 0);, +            valueAggregator.entry = entry;, +            valueFieldData.forEachValueInDoc(docId, valueAggregator);, +, +        public static class ValueAggregator implements NumericFieldData.DoubleValueInDocProc {, +, +            InternalFullDateHistogramFacet.FullEntry entry;, +, +            @Override public void onValue(int docId, double value) {, +                entry.total += value;, +                if (value < entry.min) {, +                    entry.min = value;, +                if (value > entry.max) {, +                    entry.max = value;, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/search/facet/datehistogram/ValueDateHistogramFacetCollector.java, +        final ValueAggregator valueAggregator = new ValueAggregator();, +, +                entry = new InternalFullDateHistogramFacet.FullEntry(time, 0, Double.MAX_VALUE, Double.MIN_VALUE, 0, 0);, +            valueAggregator.entry = entry;, +            valueFieldData.forEachValueInDoc(docId, valueAggregator);, +, +        public static class ValueAggregator implements NumericFieldData.DoubleValueInDocProc {, +, +            InternalFullDateHistogramFacet.FullEntry entry;, +, +            @Override public void onValue(int docId, double value) {, +                entry.total += value;, +                if (value < entry.min) {, +                    entry.min = value;, +                if (value > entry.max) {, +                    entry.max = value;, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/search/facet/geodistance/ValueGeoDistanceFacetCollector.java, +        final ValueAggregator valueAggregator = new ValueAggregator();, +, +                    valueAggregator.entry = entry;, +                    valueFieldData.forEachValueInDoc(docId, valueAggregator);, +        }, +    }, +, +    public static class ValueAggregator implements NumericFieldData.DoubleValueInDocProc {, +, +        GeoDistanceFacet.Entry entry;, +, +        @Override public void onValue(int docId, double value) {, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/search/facet/datehistogram/ValueDateHistogramFacetCollector.java, +        final ValueAggregator valueAggregator = new ValueAggregator();, +, +                entry = new InternalFullDateHistogramFacet.FullEntry(time, 0, Double.MAX_VALUE, Double.MIN_VALUE, 0, 0);, +            valueAggregator.entry = entry;, +            valueFieldData.forEachValueInDoc(docId, valueAggregator);, +, +        public static class ValueAggregator implements NumericFieldData.DoubleValueInDocProc {, +, +            InternalFullDateHistogramFacet.FullEntry entry;, +, +            @Override public void onValue(int docId, double value) {, +                entry.total += value;, +                if (value < entry.min) {, +                    entry.min = value;, +                if (value > entry.max) {, +                    entry.max = value;, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/search/facet/geodistance/ValueGeoDistanceFacetCollector.java, +        final ValueAggregator valueAggregator = new ValueAggregator();, +, +                    valueAggregator.entry = entry;, +                    valueFieldData.forEachValueInDoc(docId, valueAggregator);, +        }, +    }, +, +    public static class ValueAggregator implements NumericFieldData.DoubleValueInDocProc {, +, +        GeoDistanceFacet.Entry entry;, +, +        @Override public void onValue(int docId, double value) {, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/search/facet/histogram/bounded/BoundedValueHistogramFacetCollector.java, +                entry = new InternalBoundedFullHistogramFacet.FullEntry(index, 0, Double.MAX_VALUE, Double.MIN_VALUE, 0, 0);, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/search/facet/datehistogram/ValueDateHistogramFacetCollector.java, +        final ValueAggregator valueAggregator = new ValueAggregator();, +, +                entry = new InternalFullDateHistogramFacet.FullEntry(time, 0, Double.MAX_VALUE, Double.MIN_VALUE, 0, 0);, +            valueAggregator.entry = entry;, +            valueFieldData.forEachValueInDoc(docId, valueAggregator);, +, +        public static class ValueAggregator implements NumericFieldData.DoubleValueInDocProc {, +, +            InternalFullDateHistogramFacet.FullEntry entry;, +, +            @Override public void onValue(int docId, double value) {, +                entry.total += value;, +                if (value < entry.min) {, +                    entry.min = value;, +                if (value > entry.max) {, +                    entry.max = value;, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/search/facet/geodistance/ValueGeoDistanceFacetCollector.java, +        final ValueAggregator valueAggregator = new ValueAggregator();, +, +                    valueAggregator.entry = entry;]
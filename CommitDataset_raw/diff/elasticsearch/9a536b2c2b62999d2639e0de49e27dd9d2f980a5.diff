[+++ b/modules/elasticsearch/src/main/java/org/elasticsearch/common/lucene/docset/AllDocSet.java, +    public static final class AllDocIdSetIterator extends DocIdSetIterator {, +        public AllDocIdSetIterator(int maxDoc) {, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/common/lucene/docset/AllDocSet.java, +    public static final class AllDocIdSetIterator extends DocIdSetIterator {, +        public AllDocIdSetIterator(int maxDoc) {, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/common/lucene/docset/NotDocIdSet.java, +        DocIdSetIterator it = set.iterator();, +        if (it == null) {, +            return new AllDocSet.AllDocIdSetIterator(max);, +        }, +        return new NotDocIdSetIterator(max, it);, +    public static class NotDocIdSetIterator extends DocIdSetIterator {, +        private final int max;, +        private DocIdSetIterator it1;, +        NotDocIdSetIterator(int max, DocIdSetIterator it) throws IOException {, +            this.max = max;, +            this.it1 = it;]
[+++ b/plugin/src/main/java/org/elasticsearch/xpack/ml/job/process/DataCountsReporter.java, + * <li>Every 10,000 records for the first 100,000 records</li>, + * <li>Every 100,000 records until 1,000,000 records</li>, + * <li>Every 1,000,000 records until 10,000,000 records</li>, + * <li>and so on...</li>, +        reportingBoundaryFunction = this::reportEvery10000Records;, +    protected boolean logStatus(long totalRecords) {, +            return false;, +        // Start reducing the logging rate after a million records have been seen, +        if (log10TotalRecords > 5) {, +            logEvery = (int) Math.pow(10.0, log10TotalRecords - 5);, +        if (totalRecords > 100_000) {, +            lastRecordCountQuotient = totalRecords / 100_000;, +            reportingBoundaryFunction = this::reportEvery100000Records;, +            return false;, +        }, +, +        long quotient = totalRecords / 10_000;, +        if (quotient > lastRecordCountQuotient) {, +            lastRecordCountQuotient = quotient;, +            return true;, +        }, +, +        return false;, +    }, +, +    private boolean reportEvery100000Records(long totalRecords) {, +        long quotient = totalRecords / 100_000;, +++ b/plugin/src/main/java/org/elasticsearch/xpack/ml/job/process/DataCountsReporter.java, + * <li>Every 10,000 records for the first 100,000 records</li>, + * <li>Every 100,000 records until 1,000,000 records</li>, + * <li>Every 1,000,000 records until 10,000,000 records</li>, + * <li>and so on...</li>, +        reportingBoundaryFunction = this::reportEvery10000Records;, +    protected boolean logStatus(long totalRecords) {, +            return false;, +        // Start reducing the logging rate after a million records have been seen, +        if (log10TotalRecords > 5) {, +            logEvery = (int) Math.pow(10.0, log10TotalRecords - 5);, +        if (totalRecords > 100_000) {, +            lastRecordCountQuotient = totalRecords / 100_000;, +            reportingBoundaryFunction = this::reportEvery100000Records;, +            return false;, +        }, +, +        long quotient = totalRecords / 10_000;, +        if (quotient > lastRecordCountQuotient) {, +            lastRecordCountQuotient = quotient;, +            return true;, +        }, +, +        return false;, +    }, +, +    private boolean reportEvery100000Records(long totalRecords) {, +        long quotient = totalRecords / 100_000;, +++ b/plugin/src/test/java/org/elasticsearch/xpack/ml/job/process/DataCountsReporterTests.java, +    public void testReportRecordsWritten_Given9999Records() {, +        for (int i = 1; i <= 9999; i++) {, +        assertEquals(9999, dataCountsReporter.incrementalStats().getInputRecordCount());, +        assertEquals(49995, dataCountsReporter.incrementalStats().getInputFieldCount());, +        assertEquals(9999, dataCountsReporter.incrementalStats().getProcessedRecordCount());, +        assertEquals(29997, dataCountsReporter.incrementalStats().getProcessedFieldCount());, +        assertEquals(9999, dataCountsReporter.incrementalStats().getLatestRecordTimeStamp().getTime());, +        assertEquals(0, dataCountsReporter.getLogStatusCallCount());, +        assertEquals(3, dataCountsReporter.getLogStatusCallCount());, +    public void testReportRecordsWritten_Given100_000Records() {, +        DummyDataCountsReporter dataCountsReporter = new DummyDataCountsReporter();, +        dataCountsReporter.setAnalysedFieldsPerRecord(3);, +, +        for (int i = 1; i <= 100000; i++) {, +            dataCountsReporter.reportRecordWritten(5, i);, +        }, +, +        assertEquals(100000, dataCountsReporter.incrementalStats().getInputRecordCount());, +        assertEquals(500000, dataCountsReporter.incrementalStats().getInputFieldCount());, +        assertEquals(100000, dataCountsReporter.incrementalStats().getProcessedRecordCount());, +        assertEquals(300000, dataCountsReporter.incrementalStats().getProcessedFieldCount());, +        assertEquals(100000, dataCountsReporter.incrementalStats().getLatestRecordTimeStamp().getTime());, +, +        assertEquals(10, dataCountsReporter.getLogStatusCallCount());, +    }, +, +    public void testReportRecordsWritten_Given1_000_000Records() {, +        DummyDataCountsReporter dataCountsReporter = new DummyDataCountsReporter();, +        dataCountsReporter.setAnalysedFieldsPerRecord(3);, +, +        for (int i = 1; i <= 1_000_000; i++) {, +            dataCountsReporter.reportRecordWritten(5, i);, +        }, +, +        assertEquals(1_000_000, dataCountsReporter.incrementalStats().getInputRecordCount());, +        assertEquals(5_000_000, dataCountsReporter.incrementalStats().getInputFieldCount());, +        assertEquals(1_000_000, dataCountsReporter.incrementalStats().getProcessedRecordCount());, +        assertEquals(3_000_000, dataCountsReporter.incrementalStats().getProcessedFieldCount());, +        assertEquals(1_000_000, dataCountsReporter.incrementalStats().getLatestRecordTimeStamp().getTime());, +, +        assertEquals(19, dataCountsReporter.getLogStatusCallCount());, +    }, +]
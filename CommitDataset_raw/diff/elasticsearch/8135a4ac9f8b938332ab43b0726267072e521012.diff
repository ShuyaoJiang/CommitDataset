[+++ b/core/src/main/java/org/elasticsearch/cluster/ClusterModule.java, +        registerIndexDynamicSetting(IndicesRequestCache.DEPRECATED_INDEX_CACHE_REQUEST_ENABLED, Validator.BOOLEAN);, +++ b/core/src/main/java/org/elasticsearch/cluster/ClusterModule.java, +        registerIndexDynamicSetting(IndicesRequestCache.DEPRECATED_INDEX_CACHE_REQUEST_ENABLED, Validator.BOOLEAN);, +++ b/core/src/main/java/org/elasticsearch/index/engine/EngineConfig.java, +++ b/core/src/main/java/org/elasticsearch/cluster/ClusterModule.java, +        registerIndexDynamicSetting(IndicesRequestCache.DEPRECATED_INDEX_CACHE_REQUEST_ENABLED, Validator.BOOLEAN);, +++ b/core/src/main/java/org/elasticsearch/index/engine/EngineConfig.java, +++ b/core/src/main/java/org/elasticsearch/index/engine/InternalEngine.java, +            iwc.setUseCompoundFile(true); // always use compound on flush - reduces # of file-handles on refresh, +++ b/core/src/main/java/org/elasticsearch/cluster/ClusterModule.java, +        registerIndexDynamicSetting(IndicesRequestCache.DEPRECATED_INDEX_CACHE_REQUEST_ENABLED, Validator.BOOLEAN);, +++ b/core/src/main/java/org/elasticsearch/index/engine/EngineConfig.java, +++ b/core/src/main/java/org/elasticsearch/index/engine/InternalEngine.java, +            iwc.setUseCompoundFile(true); // always use compound on flush - reduces # of file-handles on refresh, +++ b/core/src/main/java/org/elasticsearch/index/shard/IndexShard.java, +++ b/core/src/main/java/org/elasticsearch/cluster/ClusterModule.java, +        registerIndexDynamicSetting(IndicesRequestCache.DEPRECATED_INDEX_CACHE_REQUEST_ENABLED, Validator.BOOLEAN);, +++ b/core/src/main/java/org/elasticsearch/index/engine/EngineConfig.java, +++ b/core/src/main/java/org/elasticsearch/index/engine/InternalEngine.java, +            iwc.setUseCompoundFile(true); // always use compound on flush - reduces # of file-handles on refresh, +++ b/core/src/main/java/org/elasticsearch/index/shard/IndexShard.java, +++ b/core/src/main/java/org/elasticsearch/indices/cache/request/IndicesRequestCache.java, +    @Deprecated, +    public static final String DEPRECATED_INDEX_CACHE_REQUEST_ENABLED = "index.cache.query.enable";, +    @Deprecated, +    public static final String DEPRECATED_INDICES_CACHE_QUERY_SIZE = "indices.cache.query.size";, +        String size = settings.get(INDICES_CACHE_QUERY_SIZE);, +        if (size == null) {, +            size = settings.get(DEPRECATED_INDICES_CACHE_QUERY_SIZE);, +            if (size != null) {, +                deprecationLogger.deprecated("The [" + DEPRECATED_INDICES_CACHE_QUERY_SIZE, +                        + "] settings is now deprecated, use [" + INDICES_CACHE_QUERY_SIZE + "] instead");, +            }, +        }, +        if (size == null) {, +            // this cache can be very small yet still be very effective, +            size = "1%";, +        }, +        this.size = size;, +        Boolean enable = settings.getAsBoolean(INDEX_CACHE_REQUEST_ENABLED, null);, +        if (enable == null) {, +            enable = settings.getAsBoolean(DEPRECATED_INDEX_CACHE_REQUEST_ENABLED, null);, +            if (enable != null) {, +                deprecationLogger.deprecated("The [" + DEPRECATED_INDEX_CACHE_REQUEST_ENABLED, +                        + "] settings is now deprecated, use [" + INDEX_CACHE_REQUEST_ENABLED + "] instead");, +            }, +        }, +        if (enable == null) {, +            enable = defaultEnable;, +        }, +        return enable;, +++ b/core/src/main/java/org/elasticsearch/cluster/ClusterModule.java, +        registerIndexDynamicSetting(IndicesRequestCache.DEPRECATED_INDEX_CACHE_REQUEST_ENABLED, Validator.BOOLEAN);, +++ b/core/src/main/java/org/elasticsearch/index/engine/EngineConfig.java, +++ b/core/src/main/java/org/elasticsearch/index/engine/InternalEngine.java, +            iwc.setUseCompoundFile(true); // always use compound on flush - reduces # of file-handles on refresh, +++ b/core/src/main/java/org/elasticsearch/index/shard/IndexShard.java, +++ b/core/src/main/java/org/elasticsearch/indices/cache/request/IndicesRequestCache.java, +    @Deprecated, +    public static final String DEPRECATED_INDEX_CACHE_REQUEST_ENABLED = "index.cache.query.enable";, +    @Deprecated, +    public static final String DEPRECATED_INDICES_CACHE_QUERY_SIZE = "indices.cache.query.size";, +        String size = settings.get(INDICES_CACHE_QUERY_SIZE);, +        if (size == null) {, +            size = settings.get(DEPRECATED_INDICES_CACHE_QUERY_SIZE);, +            if (size != null) {, +                deprecationLogger.deprecated("The [" + DEPRECATED_INDICES_CACHE_QUERY_SIZE, +                        + "] settings is now deprecated, use [" + INDICES_CACHE_QUERY_SIZE + "] instead");, +            }, +        }, +        if (size == null) {, +            // this cache can be very small yet still be very effective, +            size = "1%";, +        }, +        this.size = size;, +        Boolean enable = settings.getAsBoolean(INDEX_CACHE_REQUEST_ENABLED, null);, +        if (enable == null) {, +            enable = settings.getAsBoolean(DEPRECATED_INDEX_CACHE_REQUEST_ENABLED, null);, +            if (enable != null) {, +                deprecationLogger.deprecated("The [" + DEPRECATED_INDEX_CACHE_REQUEST_ENABLED, +                        + "] settings is now deprecated, use [" + INDEX_CACHE_REQUEST_ENABLED + "] instead");, +            }, +        }, +        if (enable == null) {, +            enable = defaultEnable;, +        }, +        return enable;, +++ /dev/null, +++ b/core/src/main/java/org/elasticsearch/cluster/ClusterModule.java, +        registerIndexDynamicSetting(IndicesRequestCache.DEPRECATED_INDEX_CACHE_REQUEST_ENABLED, Validator.BOOLEAN);, +++ b/core/src/main/java/org/elasticsearch/index/engine/EngineConfig.java, +++ b/core/src/main/java/org/elasticsearch/index/engine/InternalEngine.java, +            iwc.setUseCompoundFile(true); // always use compound on flush - reduces # of file-handles on refresh, +++ b/core/src/main/java/org/elasticsearch/index/shard/IndexShard.java, +++ b/core/src/main/java/org/elasticsearch/indices/cache/request/IndicesRequestCache.java, +    @Deprecated, +    public static final String DEPRECATED_INDEX_CACHE_REQUEST_ENABLED = "index.cache.query.enable";, +    @Deprecated, +    public static final String DEPRECATED_INDICES_CACHE_QUERY_SIZE = "indices.cache.query.size";]
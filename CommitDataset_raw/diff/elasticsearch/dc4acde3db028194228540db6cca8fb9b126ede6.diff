[+++ b/modules/elasticsearch/src/main/java/org/elasticsearch/util/network/NetworkService.java, +            address = NetworkUtils.getFirstNonLoopbackAddress(NetworkUtils.StackType.IPv4);, +            if (address == null) {, +                address = NetworkUtils.getFirstNonLoopbackAddress(NetworkUtils.getIpStackType());, +                if (address == null) {, +                    return NetworkUtils.getLocalAddress();, +                }, +            }, +            } else if (host.startsWith("non_loopback")) {, +                if (host.toLowerCase().endsWith(":ipv4")) {, +                    return NetworkUtils.getFirstNonLoopbackAddress(NetworkUtils.StackType.IPv4);, +                } else if (host.toLowerCase().endsWith(":ipv6")) {, +                    return NetworkUtils.getFirstNonLoopbackAddress(NetworkUtils.StackType.IPv6);, +                } else {, +                    return NetworkUtils.getFirstNonLoopbackAddress(NetworkUtils.getIpStackType());, +                }]
[+++ b/plugin/src/main/java/org/elasticsearch/xpack/ml/MachineLearning.java, +import org.elasticsearch.xpack.persistent.PersistentTasksClusterService;, +import org.elasticsearch.xpack.persistent.PersistentTasksExecutorRegistry;, +import org.elasticsearch.xpack.persistent.PersistentTasksNodeService;, +import org.elasticsearch.xpack.persistent.PersistentTasksService;, +                normalizerFactory, persistentTasksService, xContentRegistry);, +++ b/plugin/src/main/java/org/elasticsearch/xpack/ml/MachineLearning.java, +import org.elasticsearch.xpack.persistent.PersistentTasksClusterService;, +import org.elasticsearch.xpack.persistent.PersistentTasksExecutorRegistry;, +import org.elasticsearch.xpack.persistent.PersistentTasksNodeService;, +import org.elasticsearch.xpack.persistent.PersistentTasksService;, +                normalizerFactory, persistentTasksService, xContentRegistry);, +++ b/plugin/src/main/java/org/elasticsearch/xpack/ml/job/process/autodetect/AutodetectCommunicator.java, +import org.elasticsearch.common.xcontent.NamedXContentRegistry;, +    private NamedXContentRegistry xContentRegistry;, +    public AutodetectCommunicator(long taskId, Job job, AutodetectProcess process,, +            DataCountsReporter dataCountsReporter,, +            AutoDetectResultProcessor autoDetectResultProcessor, Consumer<Exception> handler,, +            NamedXContentRegistry xContentRegistry) {, +        this.xContentRegistry = xContentRegistry;, +        return DataToProcessWriterFactory.create(true, autodetectProcess,, +                dataDescription.orElse(job.getDataDescription()), job.getAnalysisConfig(),, +                dataCountsReporter, xContentRegistry);, +++ b/plugin/src/main/java/org/elasticsearch/xpack/ml/MachineLearning.java, +import org.elasticsearch.xpack.persistent.PersistentTasksClusterService;, +import org.elasticsearch.xpack.persistent.PersistentTasksExecutorRegistry;, +import org.elasticsearch.xpack.persistent.PersistentTasksNodeService;, +import org.elasticsearch.xpack.persistent.PersistentTasksService;, +                normalizerFactory, persistentTasksService, xContentRegistry);, +++ b/plugin/src/main/java/org/elasticsearch/xpack/ml/job/process/autodetect/AutodetectCommunicator.java, +import org.elasticsearch.common.xcontent.NamedXContentRegistry;, +    private NamedXContentRegistry xContentRegistry;, +    public AutodetectCommunicator(long taskId, Job job, AutodetectProcess process,, +            DataCountsReporter dataCountsReporter,, +            AutoDetectResultProcessor autoDetectResultProcessor, Consumer<Exception> handler,, +            NamedXContentRegistry xContentRegistry) {, +        this.xContentRegistry = xContentRegistry;, +        return DataToProcessWriterFactory.create(true, autodetectProcess,, +                dataDescription.orElse(job.getDataDescription()), job.getAnalysisConfig(),, +                dataCountsReporter, xContentRegistry);, +++ b/plugin/src/main/java/org/elasticsearch/xpack/ml/job/process/autodetect/AutodetectProcessManager.java, +import org.elasticsearch.common.xcontent.NamedXContentRegistry;, +    private NamedXContentRegistry xContentRegistry;, +, +    public AutodetectProcessManager(Settings settings, Client client, ThreadPool threadPool,, +            JobManager jobManager, JobProvider jobProvider, JobResultsPersister jobResultsPersister,, +            PersistentTasksService persistentTasksService, NamedXContentRegistry xContentRegistry) {, +        this.xContentRegistry = xContentRegistry;, +            return new AutodetectCommunicator(taskId, job, process, dataCountsReporter, processor,, +                    handler, xContentRegistry);, +++ b/plugin/src/main/java/org/elasticsearch/xpack/ml/MachineLearning.java, +import org.elasticsearch.xpack.persistent.PersistentTasksClusterService;, +import org.elasticsearch.xpack.persistent.PersistentTasksExecutorRegistry;, +import org.elasticsearch.xpack.persistent.PersistentTasksNodeService;, +import org.elasticsearch.xpack.persistent.PersistentTasksService;, +                normalizerFactory, persistentTasksService, xContentRegistry);, +++ b/plugin/src/main/java/org/elasticsearch/xpack/ml/job/process/autodetect/AutodetectCommunicator.java, +import org.elasticsearch.common.xcontent.NamedXContentRegistry;, +    private NamedXContentRegistry xContentRegistry;, +    public AutodetectCommunicator(long taskId, Job job, AutodetectProcess process,, +            DataCountsReporter dataCountsReporter,, +            AutoDetectResultProcessor autoDetectResultProcessor, Consumer<Exception> handler,, +            NamedXContentRegistry xContentRegistry) {, +        this.xContentRegistry = xContentRegistry;, +        return DataToProcessWriterFactory.create(true, autodetectProcess,, +                dataDescription.orElse(job.getDataDescription()), job.getAnalysisConfig(),, +                dataCountsReporter, xContentRegistry);, +++ b/plugin/src/main/java/org/elasticsearch/xpack/ml/job/process/autodetect/AutodetectProcessManager.java, +import org.elasticsearch.common.xcontent.NamedXContentRegistry;, +    private NamedXContentRegistry xContentRegistry;, +, +    public AutodetectProcessManager(Settings settings, Client client, ThreadPool threadPool,, +            JobManager jobManager, JobProvider jobProvider, JobResultsPersister jobResultsPersister,, +            PersistentTasksService persistentTasksService, NamedXContentRegistry xContentRegistry) {, +        this.xContentRegistry = xContentRegistry;, +            return new AutodetectCommunicator(taskId, job, process, dataCountsReporter, processor,, +                    handler, xContentRegistry);, +++ /dev/null, +++ b/plugin/src/main/java/org/elasticsearch/xpack/ml/MachineLearning.java, +import org.elasticsearch.xpack.persistent.PersistentTasksClusterService;, +import org.elasticsearch.xpack.persistent.PersistentTasksExecutorRegistry;, +import org.elasticsearch.xpack.persistent.PersistentTasksNodeService;, +import org.elasticsearch.xpack.persistent.PersistentTasksService;, +                normalizerFactory, persistentTasksService, xContentRegistry);, +++ b/plugin/src/main/java/org/elasticsearch/xpack/ml/job/process/autodetect/AutodetectCommunicator.java, +import org.elasticsearch.common.xcontent.NamedXContentRegistry;, +    private NamedXContentRegistry xContentRegistry;, +    public AutodetectCommunicator(long taskId, Job job, AutodetectProcess process,, +            DataCountsReporter dataCountsReporter,, +            AutoDetectResultProcessor autoDetectResultProcessor, Consumer<Exception> handler,, +            NamedXContentRegistry xContentRegistry) {, +        this.xContentRegistry = xContentRegistry;, +        return DataToProcessWriterFactory.create(true, autodetectProcess,, +                dataDescription.orElse(job.getDataDescription()), job.getAnalysisConfig(),, +                dataCountsReporter, xContentRegistry);, +++ b/plugin/src/main/java/org/elasticsearch/xpack/ml/job/process/autodetect/AutodetectProcessManager.java, +import org.elasticsearch.common.xcontent.NamedXContentRegistry;, +    private NamedXContentRegistry xContentRegistry;, +, +    public AutodetectProcessManager(Settings settings, Client client, ThreadPool threadPool,]
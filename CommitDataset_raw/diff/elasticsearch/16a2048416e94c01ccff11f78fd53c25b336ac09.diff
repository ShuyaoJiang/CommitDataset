[+++ b/core/src/main/java/org/elasticsearch/action/bulk/byscroll/AbstractAsyncBulkByScrollAction.java, +            startNextScroll(thisBatchStartTime, timeValueNanos(System.nanoTime()), 0);, +            startNextScroll(thisBatchStartTime, timeValueNanos(System.nanoTime()), response.getItems().length);, +    void startNextScroll(TimeValue lastBatchStartTime, TimeValue now, int lastBatchSize) {, +        TimeValue extraKeepAlive = task.throttleWaitTime(lastBatchStartTime, now, lastBatchSize);, +++ b/core/src/main/java/org/elasticsearch/action/bulk/byscroll/AbstractAsyncBulkByScrollAction.java, +            startNextScroll(thisBatchStartTime, timeValueNanos(System.nanoTime()), 0);, +            startNextScroll(thisBatchStartTime, timeValueNanos(System.nanoTime()), response.getItems().length);, +    void startNextScroll(TimeValue lastBatchStartTime, TimeValue now, int lastBatchSize) {, +        TimeValue extraKeepAlive = task.throttleWaitTime(lastBatchStartTime, now, lastBatchSize);, +++ b/core/src/main/java/org/elasticsearch/action/bulk/byscroll/WorkingBulkByScrollTask.java, +            TimeValue delay = throttleWaitTime(lastBatchStartTime, timeValueNanos(System.nanoTime()), lastBatchSize);, +    TimeValue throttleWaitTime(TimeValue lastBatchStartTime, TimeValue now, int lastBatchSize) {, +        long earliestNextBatchStartTime = now.nanos() + (long) perfectlyThrottledBatchTime(lastBatchSize);, +++ b/core/src/main/java/org/elasticsearch/action/bulk/byscroll/AbstractAsyncBulkByScrollAction.java, +            startNextScroll(thisBatchStartTime, timeValueNanos(System.nanoTime()), 0);, +            startNextScroll(thisBatchStartTime, timeValueNanos(System.nanoTime()), response.getItems().length);, +    void startNextScroll(TimeValue lastBatchStartTime, TimeValue now, int lastBatchSize) {, +        TimeValue extraKeepAlive = task.throttleWaitTime(lastBatchStartTime, now, lastBatchSize);, +++ b/core/src/main/java/org/elasticsearch/action/bulk/byscroll/WorkingBulkByScrollTask.java, +            TimeValue delay = throttleWaitTime(lastBatchStartTime, timeValueNanos(System.nanoTime()), lastBatchSize);, +    TimeValue throttleWaitTime(TimeValue lastBatchStartTime, TimeValue now, int lastBatchSize) {, +        long earliestNextBatchStartTime = now.nanos() + (long) perfectlyThrottledBatchTime(lastBatchSize);, +++ b/core/src/test/java/org/elasticsearch/action/bulk/byscroll/AsyncBulkByScrollActionTests.java, +import org.elasticsearch.action.bulk.byscroll.ScrollableHitSource.Hit;, +import org.elasticsearch.action.bulk.byscroll.ScrollableHitSource.SearchFailure;, +        TimeValue now = timeValueNanos(System.nanoTime());, +        action.startNextScroll(now, now, 0);, +        TimeValue now = timeValueNanos(System.nanoTime());, +        action.startNextScroll(now, now, 0);, +        TimeValue lastBatchStartTime = timeValueNanos(System.nanoTime());, +        TimeValue now = timeValueNanos(lastBatchStartTime.nanos() + 1);, +        action.startNextScroll(lastBatchStartTime, now, 100);, +            assertEquals(99, capturedDelay.get().seconds());, +            assertEquals(9, capturedDelay.get().seconds());, +            void startNextScroll(TimeValue lastBatchStartTime, TimeValue now, int lastBatchSize) {, +        TimeValue now = timeValueNanos(System.nanoTime());, +        cancelTaskCase((DummyAsyncBulkByScrollAction action) -> action.startNextScroll(now, now, 0));]
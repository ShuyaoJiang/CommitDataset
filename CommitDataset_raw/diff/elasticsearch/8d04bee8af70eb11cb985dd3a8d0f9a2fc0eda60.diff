[+++ b/core/src/main/java/org/elasticsearch/bootstrap/Security.java, +        m.put(Pattern.compile(".*securemock-.*\\.jar$"),     "es.security.jar.elasticsearch.securemock");, +        m.put(Pattern.compile(".*mockito-core-.*\\.jar$"),   "es.security.jar.mockito.core");, +        m.put(Pattern.compile(".*objenesis-.*\\.jar$"),      "es.security.jar.objenesis");, +++ b/core/src/main/java/org/elasticsearch/bootstrap/Security.java, +        m.put(Pattern.compile(".*securemock-.*\\.jar$"),     "es.security.jar.elasticsearch.securemock");, +        m.put(Pattern.compile(".*mockito-core-.*\\.jar$"),   "es.security.jar.mockito.core");, +        m.put(Pattern.compile(".*objenesis-.*\\.jar$"),      "es.security.jar.objenesis");, +++ b/core/src/main/resources/org/elasticsearch/bootstrap/security.policy, +// the following three jars all conspire to support creation of mocks, +grant codeBase "${es.security.jar.elasticsearch.securemock}" {, +  permission java.lang.RuntimePermission "reflectionFactoryAccess";, +};, +grant codeBase "${es.security.jar.mockito.core}" {, +  permission java.lang.RuntimePermission "reflectionFactoryAccess";, +};, +grant codeBase "${es.security.jar.objenesis}" {, +  permission java.lang.RuntimePermission "reflectionFactoryAccess";, +};, +]
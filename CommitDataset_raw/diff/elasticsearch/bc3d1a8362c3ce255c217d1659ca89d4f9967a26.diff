[+++ b/core/src/main/java/org/elasticsearch/action/admin/cluster/node/stats/NodeStats.java, +        if (in.readBoolean()) {, +            os = new OsStats(in);, +        }, +        if (in.readBoolean()) {, +            process = ProcessStats.readProcessStats(in);, +        }, +        if (in.readBoolean()) {, +            jvm = JvmStats.readJvmStats(in);, +        }, +        if (in.readBoolean()) {, +            threadPool = ThreadPoolStats.readThreadPoolStats(in);, +        }, +        if (in.readBoolean()) {, +            fs = new FsInfo(in);, +        }, +        if (in.readBoolean()) {, +            transport = TransportStats.readTransportStats(in);, +        }, +        if (in.readBoolean()) {, +            http = HttpStats.readHttpStats(in);, +        }, +        breaker = AllCircuitBreakerStats.readOptionalAllCircuitBreakerStats(in);, +        scriptStats = in.readOptionalStreamable(ScriptStats::new);, +        discoveryStats = in.readOptionalStreamable(() -> new DiscoveryStats(null));, +        if (os == null) {, +            out.writeBoolean(false);, +        } else {, +            out.writeBoolean(true);, +            os.writeTo(out);, +        }, +        if (process == null) {, +            out.writeBoolean(false);, +        } else {, +            out.writeBoolean(true);, +            process.writeTo(out);, +        }, +        if (jvm == null) {, +            out.writeBoolean(false);, +        } else {, +            out.writeBoolean(true);, +            jvm.writeTo(out);, +        }, +        if (threadPool == null) {, +            out.writeBoolean(false);, +        } else {, +            out.writeBoolean(true);, +            threadPool.writeTo(out);, +        }, +        if (fs == null) {, +            out.writeBoolean(false);, +        } else {, +            out.writeBoolean(true);, +            fs.writeTo(out);, +        }, +        if (transport == null) {, +            out.writeBoolean(false);, +        } else {, +            out.writeBoolean(true);, +            transport.writeTo(out);, +        }, +        if (http == null) {, +            out.writeBoolean(false);, +        } else {, +            out.writeBoolean(true);, +            http.writeTo(out);, +        }, +        out.writeOptionalStreamable(breaker);, +        out.writeOptionalStreamable(scriptStats);, +        out.writeOptionalStreamable(discoveryStats);, +, +, +, +, +, +++ b/core/src/main/java/org/elasticsearch/action/admin/cluster/node/stats/NodeStats.java, +        if (in.readBoolean()) {, +            os = new OsStats(in);, +        }, +        if (in.readBoolean()) {, +            process = ProcessStats.readProcessStats(in);, +        }, +        if (in.readBoolean()) {, +            jvm = JvmStats.readJvmStats(in);, +        }, +        if (in.readBoolean()) {, +            threadPool = ThreadPoolStats.readThreadPoolStats(in);, +        }, +        if (in.readBoolean()) {, +            fs = new FsInfo(in);, +        }, +        if (in.readBoolean()) {, +            transport = TransportStats.readTransportStats(in);, +        }, +        if (in.readBoolean()) {, +            http = HttpStats.readHttpStats(in);, +        }, +        breaker = AllCircuitBreakerStats.readOptionalAllCircuitBreakerStats(in);, +        scriptStats = in.readOptionalStreamable(ScriptStats::new);, +        discoveryStats = in.readOptionalStreamable(() -> new DiscoveryStats(null));]
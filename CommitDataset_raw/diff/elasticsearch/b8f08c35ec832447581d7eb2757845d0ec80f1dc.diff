[+++ b/.projectile, +++ b/.projectile, +++ b/core/src/main/java/org/elasticsearch/ingest/core/CompoundProcessor.java, +    static final String ON_FAILURE_PROCESSOR_FIELD = "on_failure_processor";, +                    executeOnFailure(ingestDocument, e, processor.getType());, +    void executeOnFailure(IngestDocument ingestDocument, Exception cause, String failedProcessorType) throws Exception {, +            ingestMetadata.put(ON_FAILURE_PROCESSOR_FIELD, failedProcessorType);, +            ingestMetadata.remove(ON_FAILURE_PROCESSOR_FIELD);, +++ b/.projectile, +++ b/core/src/main/java/org/elasticsearch/ingest/core/CompoundProcessor.java, +    static final String ON_FAILURE_PROCESSOR_FIELD = "on_failure_processor";, +                    executeOnFailure(ingestDocument, e, processor.getType());, +    void executeOnFailure(IngestDocument ingestDocument, Exception cause, String failedProcessorType) throws Exception {, +            ingestMetadata.put(ON_FAILURE_PROCESSOR_FIELD, failedProcessorType);, +            ingestMetadata.remove(ON_FAILURE_PROCESSOR_FIELD);, +++ b/core/src/main/java/org/elasticsearch/plugins/PluginManager.java, +++ b/.projectile, +++ b/core/src/main/java/org/elasticsearch/ingest/core/CompoundProcessor.java, +    static final String ON_FAILURE_PROCESSOR_FIELD = "on_failure_processor";, +                    executeOnFailure(ingestDocument, e, processor.getType());, +    void executeOnFailure(IngestDocument ingestDocument, Exception cause, String failedProcessorType) throws Exception {, +            ingestMetadata.put(ON_FAILURE_PROCESSOR_FIELD, failedProcessorType);, +            ingestMetadata.remove(ON_FAILURE_PROCESSOR_FIELD);, +++ b/core/src/main/java/org/elasticsearch/plugins/PluginManager.java, +++ b/core/src/main/resources/org/elasticsearch/plugins/plugin-install.help, +++ b/.projectile, +++ b/core/src/main/java/org/elasticsearch/ingest/core/CompoundProcessor.java, +    static final String ON_FAILURE_PROCESSOR_FIELD = "on_failure_processor";, +                    executeOnFailure(ingestDocument, e, processor.getType());, +    void executeOnFailure(IngestDocument ingestDocument, Exception cause, String failedProcessorType) throws Exception {, +            ingestMetadata.put(ON_FAILURE_PROCESSOR_FIELD, failedProcessorType);, +            ingestMetadata.remove(ON_FAILURE_PROCESSOR_FIELD);, +++ b/core/src/main/java/org/elasticsearch/plugins/PluginManager.java, +++ b/core/src/main/resources/org/elasticsearch/plugins/plugin-install.help, +++ b/core/src/test/java/org/elasticsearch/ingest/core/CompoundProcessorTests.java, +            assertThat(ingestMetadata.size(), equalTo(2));, +            assertThat(ingestMetadata.get(CompoundProcessor.ON_FAILURE_PROCESSOR_FIELD), equalTo("first"));, +        TestProcessor processorToFail = new TestProcessor("id", "second", ingestDocument -> {, +            assertThat(ingestMetadata.size(), equalTo(2));, +            assertThat(ingestMetadata.get(CompoundProcessor.ON_FAILURE_PROCESSOR_FIELD), equalTo("first"));, +            assertThat(ingestMetadata.size(), equalTo(2));, +            assertThat(ingestMetadata.get(CompoundProcessor.ON_FAILURE_PROCESSOR_FIELD), equalTo("second"));, +++ b/.projectile, +++ b/core/src/main/java/org/elasticsearch/ingest/core/CompoundProcessor.java, +    static final String ON_FAILURE_PROCESSOR_FIELD = "on_failure_processor";, +                    executeOnFailure(ingestDocument, e, processor.getType());, +    void executeOnFailure(IngestDocument ingestDocument, Exception cause, String failedProcessorType) throws Exception {, +            ingestMetadata.put(ON_FAILURE_PROCESSOR_FIELD, failedProcessorType);, +            ingestMetadata.remove(ON_FAILURE_PROCESSOR_FIELD);, +++ b/core/src/main/java/org/elasticsearch/plugins/PluginManager.java, +++ b/core/src/main/resources/org/elasticsearch/plugins/plugin-install.help, +++ b/core/src/test/java/org/elasticsearch/ingest/core/CompoundProcessorTests.java, +            assertThat(ingestMetadata.size(), equalTo(2));, +            assertThat(ingestMetadata.get(CompoundProcessor.ON_FAILURE_PROCESSOR_FIELD), equalTo("first"));, +        TestProcessor processorToFail = new TestProcessor("id", "second", ingestDocument -> {, +            assertThat(ingestMetadata.size(), equalTo(2));, +            assertThat(ingestMetadata.get(CompoundProcessor.ON_FAILURE_PROCESSOR_FIELD), equalTo("first"));, +            assertThat(ingestMetadata.size(), equalTo(2));, +            assertThat(ingestMetadata.get(CompoundProcessor.ON_FAILURE_PROCESSOR_FIELD), equalTo("second"));, +++ b/dev-tools/smoke_test_rc.py, +++ b/.projectile, +++ b/core/src/main/java/org/elasticsearch/ingest/core/CompoundProcessor.java, +    static final String ON_FAILURE_PROCESSOR_FIELD = "on_failure_processor";, +                    executeOnFailure(ingestDocument, e, processor.getType());, +    void executeOnFailure(IngestDocument ingestDocument, Exception cause, String failedProcessorType) throws Exception {, +            ingestMetadata.put(ON_FAILURE_PROCESSOR_FIELD, failedProcessorType);, +            ingestMetadata.remove(ON_FAILURE_PROCESSOR_FIELD);, +++ b/core/src/main/java/org/elasticsearch/plugins/PluginManager.java, +++ b/core/src/main/resources/org/elasticsearch/plugins/plugin-install.help, +++ b/core/src/test/java/org/elasticsearch/ingest/core/CompoundProcessorTests.java, +            assertThat(ingestMetadata.size(), equalTo(2));, +            assertThat(ingestMetadata.get(CompoundProcessor.ON_FAILURE_PROCESSOR_FIELD), equalTo("first"));, +        TestProcessor processorToFail = new TestProcessor("id", "second", ingestDocument -> {, +            assertThat(ingestMetadata.size(), equalTo(2));, +            assertThat(ingestMetadata.get(CompoundProcessor.ON_FAILURE_PROCESSOR_FIELD), equalTo("first"));, +            assertThat(ingestMetadata.size(), equalTo(2));, +            assertThat(ingestMetadata.get(CompoundProcessor.ON_FAILURE_PROCESSOR_FIELD), equalTo("second"));, +++ b/dev-tools/smoke_test_rc.py, +++ /dev/null, +++ b/.projectile, +++ b/core/src/main/java/org/elasticsearch/ingest/core/CompoundProcessor.java, +    static final String ON_FAILURE_PROCESSOR_FIELD = "on_failure_processor";, +                    executeOnFailure(ingestDocument, e, processor.getType());, +    void executeOnFailure(IngestDocument ingestDocument, Exception cause, String failedProcessorType) throws Exception {, +            ingestMetadata.put(ON_FAILURE_PROCESSOR_FIELD, failedProcessorType);, +            ingestMetadata.remove(ON_FAILURE_PROCESSOR_FIELD);, +++ b/core/src/main/java/org/elasticsearch/plugins/PluginManager.java, +++ b/core/src/main/resources/org/elasticsearch/plugins/plugin-install.help, +++ b/core/src/test/java/org/elasticsearch/ingest/core/CompoundProcessorTests.java, +            assertThat(ingestMetadata.size(), equalTo(2));, +            assertThat(ingestMetadata.get(CompoundProcessor.ON_FAILURE_PROCESSOR_FIELD), equalTo("first"));, +        TestProcessor processorToFail = new TestProcessor("id", "second", ingestDocument -> {, +            assertThat(ingestMetadata.size(), equalTo(2));, +            assertThat(ingestMetadata.get(CompoundProcessor.ON_FAILURE_PROCESSOR_FIELD), equalTo("first"));, +            assertThat(ingestMetadata.size(), equalTo(2));, +            assertThat(ingestMetadata.get(CompoundProcessor.ON_FAILURE_PROCESSOR_FIELD), equalTo("second"));, +++ b/dev-tools/smoke_test_rc.py, +++ /dev/null, +++ b/docs/plugins/discovery.asciidoc, +++ b/.projectile]
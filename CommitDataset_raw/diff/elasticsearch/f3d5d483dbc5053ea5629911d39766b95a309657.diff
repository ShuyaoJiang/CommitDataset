[+++ b/src/main/java/org/elasticsearch/index/mapper/DocumentMapper.java, +            this.rootMappers.put(UidFieldMapper.class, new UidFieldMapper(indexSettings));, +            this.rootMappers.put(IndexFieldMapper.class, new IndexFieldMapper(indexSettings));, +            this.rootMappers.put(TypeFieldMapper.class, new TypeFieldMapper(indexSettings));, +            this.rootMappers.put(AllFieldMapper.class, new AllFieldMapper(indexSettings));, +            this.rootMappers.put(VersionFieldMapper.class, new VersionFieldMapper(indexSettings));, +++ b/src/main/java/org/elasticsearch/index/mapper/DocumentMapper.java, +            this.rootMappers.put(UidFieldMapper.class, new UidFieldMapper(indexSettings));, +            this.rootMappers.put(IndexFieldMapper.class, new IndexFieldMapper(indexSettings));, +            this.rootMappers.put(TypeFieldMapper.class, new TypeFieldMapper(indexSettings));, +            this.rootMappers.put(AllFieldMapper.class, new AllFieldMapper(indexSettings));, +            this.rootMappers.put(VersionFieldMapper.class, new VersionFieldMapper(indexSettings));, +++ b/src/main/java/org/elasticsearch/index/mapper/core/AbstractFieldMapper.java, +        assert indexSettings != null;, +        this.writePre20Metadata = Version.indexCreated(indexSettings).before(Version.V_2_0_0);, +++ b/src/main/java/org/elasticsearch/index/mapper/DocumentMapper.java, +            this.rootMappers.put(UidFieldMapper.class, new UidFieldMapper(indexSettings));, +            this.rootMappers.put(IndexFieldMapper.class, new IndexFieldMapper(indexSettings));, +            this.rootMappers.put(TypeFieldMapper.class, new TypeFieldMapper(indexSettings));, +            this.rootMappers.put(AllFieldMapper.class, new AllFieldMapper(indexSettings));, +            this.rootMappers.put(VersionFieldMapper.class, new VersionFieldMapper(indexSettings));, +++ b/src/main/java/org/elasticsearch/index/mapper/core/AbstractFieldMapper.java, +        assert indexSettings != null;, +        this.writePre20Metadata = Version.indexCreated(indexSettings).before(Version.V_2_0_0);, +++ b/src/main/java/org/elasticsearch/index/mapper/core/BinaryFieldMapper.java, +                    fieldDataSettings, context.indexSettings(), multiFieldsBuilder.build(this, context), copyTo);, +                                @Nullable Settings fieldDataSettings, Settings indexSettings, MultiFields multiFields, CopyTo copyTo) {, +        super(names, 1.0f, fieldType, docValues, null, null, null, null, fieldDataSettings, indexSettings, multiFields, copyTo);, +++ b/src/main/java/org/elasticsearch/index/mapper/DocumentMapper.java, +            this.rootMappers.put(UidFieldMapper.class, new UidFieldMapper(indexSettings));, +            this.rootMappers.put(IndexFieldMapper.class, new IndexFieldMapper(indexSettings));, +            this.rootMappers.put(TypeFieldMapper.class, new TypeFieldMapper(indexSettings));, +            this.rootMappers.put(AllFieldMapper.class, new AllFieldMapper(indexSettings));, +            this.rootMappers.put(VersionFieldMapper.class, new VersionFieldMapper(indexSettings));, +++ b/src/main/java/org/elasticsearch/index/mapper/core/AbstractFieldMapper.java, +        assert indexSettings != null;, +        this.writePre20Metadata = Version.indexCreated(indexSettings).before(Version.V_2_0_0);, +++ b/src/main/java/org/elasticsearch/index/mapper/core/BinaryFieldMapper.java, +                    fieldDataSettings, context.indexSettings(), multiFieldsBuilder.build(this, context), copyTo);, +                                @Nullable Settings fieldDataSettings, Settings indexSettings, MultiFields multiFields, CopyTo copyTo) {, +        super(names, 1.0f, fieldType, docValues, null, null, null, null, fieldDataSettings, indexSettings, multiFields, copyTo);, +++ b/src/main/java/org/elasticsearch/index/mapper/core/CompletionFieldMapper.java, +import org.elasticsearch.common.settings.Settings;, +                    preserveSeparators, preservePositionIncrements, maxInputLength, context.indexSettings(), multiFieldsBuilder.build(this, context), copyTo, this.contextMapping);, +                                 boolean preserveSeparators, boolean preservePositionIncrements, int maxInputLength, Settings indexSettings, MultiFields multiFields, CopyTo copyTo, SortedMap<String, ContextMapping> contextMappings) {, +        super(names, 1.0f, Defaults.FIELD_TYPE, null, indexAnalyzer, searchAnalyzer, similarity, null, null, indexSettings, multiFields, copyTo);, +++ b/src/main/java/org/elasticsearch/index/mapper/DocumentMapper.java, +            this.rootMappers.put(UidFieldMapper.class, new UidFieldMapper(indexSettings));, +            this.rootMappers.put(IndexFieldMapper.class, new IndexFieldMapper(indexSettings));, +            this.rootMappers.put(TypeFieldMapper.class, new TypeFieldMapper(indexSettings));, +            this.rootMappers.put(AllFieldMapper.class, new AllFieldMapper(indexSettings));, +            this.rootMappers.put(VersionFieldMapper.class, new VersionFieldMapper(indexSettings));, +++ b/src/main/java/org/elasticsearch/index/mapper/core/AbstractFieldMapper.java, +        assert indexSettings != null;, +        this.writePre20Metadata = Version.indexCreated(indexSettings).before(Version.V_2_0_0);, +++ b/src/main/java/org/elasticsearch/index/mapper/core/BinaryFieldMapper.java, +                    fieldDataSettings, context.indexSettings(), multiFieldsBuilder.build(this, context), copyTo);, +                                @Nullable Settings fieldDataSettings, Settings indexSettings, MultiFields multiFields, CopyTo copyTo) {, +        super(names, 1.0f, fieldType, docValues, null, null, null, null, fieldDataSettings, indexSettings, multiFields, copyTo);, +++ b/src/main/java/org/elasticsearch/index/mapper/core/CompletionFieldMapper.java, +import org.elasticsearch.common.settings.Settings;, +                    preserveSeparators, preservePositionIncrements, maxInputLength, context.indexSettings(), multiFieldsBuilder.build(this, context), copyTo, this.contextMapping);, +                                 boolean preserveSeparators, boolean preservePositionIncrements, int maxInputLength, Settings indexSettings, MultiFields multiFields, CopyTo copyTo, SortedMap<String, ContextMapping> contextMappings) {, +        super(names, 1.0f, Defaults.FIELD_TYPE, null, indexAnalyzer, searchAnalyzer, similarity, null, null, indexSettings, multiFields, copyTo);, +++ b/src/main/java/org/elasticsearch/index/mapper/geo/GeoShapeFieldMapper.java, +import org.elasticsearch.common.settings.Settings;, +                    context.indexSettings(), multiFieldsBuilder.build(this, context), copyTo);, +                               Orientation shapeOrientation, FieldType fieldType, Settings indexSettings, MultiFields multiFields, CopyTo copyTo) {, +        super(names, 1, fieldType, null, null, null, null, null, null, indexSettings, multiFields, copyTo);, +++ b/src/main/java/org/elasticsearch/index/mapper/DocumentMapper.java, +            this.rootMappers.put(UidFieldMapper.class, new UidFieldMapper(indexSettings));, +            this.rootMappers.put(IndexFieldMapper.class, new IndexFieldMapper(indexSettings));, +            this.rootMappers.put(TypeFieldMapper.class, new TypeFieldMapper(indexSettings));, +            this.rootMappers.put(AllFieldMapper.class, new AllFieldMapper(indexSettings));, +            this.rootMappers.put(VersionFieldMapper.class, new VersionFieldMapper(indexSettings));, +++ b/src/main/java/org/elasticsearch/index/mapper/core/AbstractFieldMapper.java, +        assert indexSettings != null;, +        this.writePre20Metadata = Version.indexCreated(indexSettings).before(Version.V_2_0_0);, +++ b/src/main/java/org/elasticsearch/index/mapper/core/BinaryFieldMapper.java, +                    fieldDataSettings, context.indexSettings(), multiFieldsBuilder.build(this, context), copyTo);, +                                @Nullable Settings fieldDataSettings, Settings indexSettings, MultiFields multiFields, CopyTo copyTo) {, +        super(names, 1.0f, fieldType, docValues, null, null, null, null, fieldDataSettings, indexSettings, multiFields, copyTo);, +++ b/src/main/java/org/elasticsearch/index/mapper/core/CompletionFieldMapper.java, +import org.elasticsearch.common.settings.Settings;, +                    preserveSeparators, preservePositionIncrements, maxInputLength, context.indexSettings(), multiFieldsBuilder.build(this, context), copyTo, this.contextMapping);, +                                 boolean preserveSeparators, boolean preservePositionIncrements, int maxInputLength, Settings indexSettings, MultiFields multiFields, CopyTo copyTo, SortedMap<String, ContextMapping> contextMappings) {, +        super(names, 1.0f, Defaults.FIELD_TYPE, null, indexAnalyzer, searchAnalyzer, similarity, null, null, indexSettings, multiFields, copyTo);, +++ b/src/main/java/org/elasticsearch/index/mapper/geo/GeoShapeFieldMapper.java, +import org.elasticsearch.common.settings.Settings;, +                    context.indexSettings(), multiFieldsBuilder.build(this, context), copyTo);, +                               Orientation shapeOrientation, FieldType fieldType, Settings indexSettings, MultiFields multiFields, CopyTo copyTo) {, +        super(names, 1, fieldType, null, null, null, null, null, null, indexSettings, multiFields, copyTo);, +++ b/src/main/java/org/elasticsearch/index/mapper/internal/AllFieldMapper.java, +    public AllFieldMapper(Settings indexSettings) {, +        this(Defaults.NAME, new FieldType(Defaults.FIELD_TYPE), null, null, Defaults.ENABLED, false, null, null, null, indexSettings);, +++ b/src/main/java/org/elasticsearch/index/mapper/DocumentMapper.java, +            this.rootMappers.put(UidFieldMapper.class, new UidFieldMapper(indexSettings));, +            this.rootMappers.put(IndexFieldMapper.class, new IndexFieldMapper(indexSettings));, +            this.rootMappers.put(TypeFieldMapper.class, new TypeFieldMapper(indexSettings));, +            this.rootMappers.put(AllFieldMapper.class, new AllFieldMapper(indexSettings));]
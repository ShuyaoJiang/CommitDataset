[+++ b/src/test/java/org/elasticsearch/index/engine/InternalEngineTests.java, +import com.carrotsearch.randomizedtesting.annotations.Repeat;, +import com.carrotsearch.randomizedtesting.annotations.Seed;, +        boolean recoveredButFailed = false;, +                    // sometimes we fail after we committed the recovered docs during the finaly refresh call, +                    // that means hte index is consistent and recovered so we can't assert on the num recovered ops below., +                        try (IndexReader reader = DirectoryReader.open(directory.getDelegate())) {, +                            if (reader.numDocs() == numDocs) {, +                                recoveredButFailed = true;, +                                break;, +                            } else {, +                                // skip - we just failed, +                            }, +                        }, +        if (recoveredButFailed == false) {, +    }]
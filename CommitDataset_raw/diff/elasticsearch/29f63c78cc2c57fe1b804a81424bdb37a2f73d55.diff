[+++ b/core/src/main/java/org/elasticsearch/action/admin/cluster/settings/ClusterUpdateSettingsRequest.java, +        if (transientSettings.isEmpty() && persistentSettings.isEmpty()) {, +++ b/core/src/main/java/org/elasticsearch/action/admin/cluster/settings/ClusterUpdateSettingsRequest.java, +        if (transientSettings.isEmpty() && persistentSettings.isEmpty()) {, +++ b/core/src/main/java/org/elasticsearch/action/admin/cluster/settings/TransportClusterUpdateSettingsAction.java, +        if ((request.transientSettings().isEmpty() &&, +            request.persistentSettings().size() == 1 &&, +            (request.persistentSettings().isEmpty() && request.transientSettings().size() == 1 &&, +++ b/core/src/main/java/org/elasticsearch/action/admin/cluster/settings/ClusterUpdateSettingsRequest.java, +        if (transientSettings.isEmpty() && persistentSettings.isEmpty()) {, +++ b/core/src/main/java/org/elasticsearch/action/admin/cluster/settings/TransportClusterUpdateSettingsAction.java, +        if ((request.transientSettings().isEmpty() &&, +            request.persistentSettings().size() == 1 &&, +            (request.persistentSettings().isEmpty() && request.transientSettings().size() == 1 &&, +++ b/core/src/main/java/org/elasticsearch/action/admin/indices/settings/put/TransportUpdateSettingsAction.java, +        if (request.settings().size() == 1 && IndexMetaData.INDEX_BLOCKS_METADATA_SETTING.exists(request.settings()) || IndexMetaData.INDEX_READ_ONLY_SETTING.exists(request.settings())) {, +++ b/core/src/main/java/org/elasticsearch/action/admin/cluster/settings/ClusterUpdateSettingsRequest.java, +        if (transientSettings.isEmpty() && persistentSettings.isEmpty()) {, +++ b/core/src/main/java/org/elasticsearch/action/admin/cluster/settings/TransportClusterUpdateSettingsAction.java, +        if ((request.transientSettings().isEmpty() &&, +            request.persistentSettings().size() == 1 &&, +            (request.persistentSettings().isEmpty() && request.transientSettings().size() == 1 &&, +++ b/core/src/main/java/org/elasticsearch/action/admin/indices/settings/put/TransportUpdateSettingsAction.java, +        if (request.settings().size() == 1 && IndexMetaData.INDEX_BLOCKS_METADATA_SETTING.exists(request.settings()) || IndexMetaData.INDEX_READ_ONLY_SETTING.exists(request.settings())) {, +++ b/core/src/main/java/org/elasticsearch/action/admin/indices/settings/put/UpdateSettingsRequest.java, +        if (settings.isEmpty()) {, +++ b/core/src/main/java/org/elasticsearch/action/admin/cluster/settings/ClusterUpdateSettingsRequest.java, +        if (transientSettings.isEmpty() && persistentSettings.isEmpty()) {, +++ b/core/src/main/java/org/elasticsearch/action/admin/cluster/settings/TransportClusterUpdateSettingsAction.java, +        if ((request.transientSettings().isEmpty() &&, +            request.persistentSettings().size() == 1 &&, +            (request.persistentSettings().isEmpty() && request.transientSettings().size() == 1 &&, +++ b/core/src/main/java/org/elasticsearch/action/admin/indices/settings/put/TransportUpdateSettingsAction.java, +        if (request.settings().size() == 1 && IndexMetaData.INDEX_BLOCKS_METADATA_SETTING.exists(request.settings()) || IndexMetaData.INDEX_READ_ONLY_SETTING.exists(request.settings())) {, +++ b/core/src/main/java/org/elasticsearch/action/admin/indices/settings/put/UpdateSettingsRequest.java, +        if (settings.isEmpty()) {, +++ b/core/src/main/java/org/elasticsearch/cluster/metadata/MetaData.java, +            if (!metaData.persistentSettings().isEmpty()) {, +            if (context == XContentContext.API && !metaData.transientSettings().isEmpty()) {, +++ b/core/src/main/java/org/elasticsearch/action/admin/cluster/settings/ClusterUpdateSettingsRequest.java, +        if (transientSettings.isEmpty() && persistentSettings.isEmpty()) {, +++ b/core/src/main/java/org/elasticsearch/action/admin/cluster/settings/TransportClusterUpdateSettingsAction.java, +        if ((request.transientSettings().isEmpty() &&, +            request.persistentSettings().size() == 1 &&, +            (request.persistentSettings().isEmpty() && request.transientSettings().size() == 1 &&, +++ b/core/src/main/java/org/elasticsearch/action/admin/indices/settings/put/TransportUpdateSettingsAction.java, +        if (request.settings().size() == 1 && IndexMetaData.INDEX_BLOCKS_METADATA_SETTING.exists(request.settings()) || IndexMetaData.INDEX_READ_ONLY_SETTING.exists(request.settings())) {, +++ b/core/src/main/java/org/elasticsearch/action/admin/indices/settings/put/UpdateSettingsRequest.java, +        if (settings.isEmpty()) {, +++ b/core/src/main/java/org/elasticsearch/cluster/metadata/MetaData.java, +            if (!metaData.persistentSettings().isEmpty()) {, +            if (context == XContentContext.API && !metaData.transientSettings().isEmpty()) {, +++ b/core/src/main/java/org/elasticsearch/cluster/metadata/MetaDataUpdateSettingsService.java, +                if (!skippedSettigns.isEmpty() && !openIndices.isEmpty()) {, +++ b/core/src/main/java/org/elasticsearch/action/admin/cluster/settings/ClusterUpdateSettingsRequest.java, +        if (transientSettings.isEmpty() && persistentSettings.isEmpty()) {, +++ b/core/src/main/java/org/elasticsearch/action/admin/cluster/settings/TransportClusterUpdateSettingsAction.java, +        if ((request.transientSettings().isEmpty() &&, +            request.persistentSettings().size() == 1 &&, +            (request.persistentSettings().isEmpty() && request.transientSettings().size() == 1 &&, +++ b/core/src/main/java/org/elasticsearch/action/admin/indices/settings/put/TransportUpdateSettingsAction.java, +        if (request.settings().size() == 1 && IndexMetaData.INDEX_BLOCKS_METADATA_SETTING.exists(request.settings()) || IndexMetaData.INDEX_READ_ONLY_SETTING.exists(request.settings())) {, +++ b/core/src/main/java/org/elasticsearch/action/admin/indices/settings/put/UpdateSettingsRequest.java, +        if (settings.isEmpty()) {, +++ b/core/src/main/java/org/elasticsearch/cluster/metadata/MetaData.java, +            if (!metaData.persistentSettings().isEmpty()) {, +            if (context == XContentContext.API && !metaData.transientSettings().isEmpty()) {, +++ b/core/src/main/java/org/elasticsearch/cluster/metadata/MetaDataUpdateSettingsService.java, +                if (!skippedSettigns.isEmpty() && !openIndices.isEmpty()) {, +++ b/core/src/main/java/org/elasticsearch/common/settings/Settings.java, +        out.writeVInt(settings.size());, +        return this.settings.isEmpty(); // TODO: account for secure settings, +    }, +, +    /** Returns the number of settings in this settings object. */, +    public int size() {, +        return this.settings.size(); // TODO: account for secure settings, +++ b/core/src/main/java/org/elasticsearch/action/admin/cluster/settings/ClusterUpdateSettingsRequest.java, +        if (transientSettings.isEmpty() && persistentSettings.isEmpty()) {, +++ b/core/src/main/java/org/elasticsearch/action/admin/cluster/settings/TransportClusterUpdateSettingsAction.java, +        if ((request.transientSettings().isEmpty() &&, +            request.persistentSettings().size() == 1 &&, +            (request.persistentSettings().isEmpty() && request.transientSettings().size() == 1 &&, +++ b/core/src/main/java/org/elasticsearch/action/admin/indices/settings/put/TransportUpdateSettingsAction.java, +        if (request.settings().size() == 1 && IndexMetaData.INDEX_BLOCKS_METADATA_SETTING.exists(request.settings()) || IndexMetaData.INDEX_READ_ONLY_SETTING.exists(request.settings())) {, +++ b/core/src/main/java/org/elasticsearch/action/admin/indices/settings/put/UpdateSettingsRequest.java, +        if (settings.isEmpty()) {, +++ b/core/src/main/java/org/elasticsearch/cluster/metadata/MetaData.java, +            if (!metaData.persistentSettings().isEmpty()) {, +            if (context == XContentContext.API && !metaData.transientSettings().isEmpty()) {, +++ b/core/src/main/java/org/elasticsearch/cluster/metadata/MetaDataUpdateSettingsService.java, +                if (!skippedSettigns.isEmpty() && !openIndices.isEmpty()) {, +++ b/core/src/main/java/org/elasticsearch/common/settings/Settings.java, +        out.writeVInt(settings.size());, +        return this.settings.isEmpty(); // TODO: account for secure settings, +    }, +, +    /** Returns the number of settings in this settings object. */, +    public int size() {, +        return this.settings.size(); // TODO: account for secure settings]
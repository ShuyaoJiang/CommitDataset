[+++ b/modules/elasticsearch/src/main/java/org/elasticsearch/script/AbstractSearchScript.java, +    /**, +     * Returns the current score and only applicable when used as a scoring script in a custom score query!., +     * For other cases, use {@link #doc()} and get the score from it., +     */, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/script/AbstractSearchScript.java, +    /**, +     * Returns the current score and only applicable when used as a scoring script in a custom score query!., +     * For other cases, use {@link #doc()} and get the score from it., +     */, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/script/ScriptService.java, +import java.io.IOException;, +        // put some default optimized scripts, +        staticCache.put("doc.score", new CompiledScript("native", new DocScoreNativeScriptFactory()));, +, +    public static class DocScoreNativeScriptFactory implements NativeScriptFactory {, +        @Override public ExecutableScript newScript(@Nullable Map<String, Object> params) {, +            return new DocScoreSearchScript();, +        }, +    }, +, +    public static class DocScoreSearchScript extends AbstractFloatSearchScript {, +        @Override public float runAsFloat() {, +            try {, +                return doc().score();, +            } catch (IOException e) {, +                return 0;, +            }, +        }, +    }]
[+++ b/core/src/main/java/org/elasticsearch/common/io/stream/StreamInput.java, +++ b/core/src/main/java/org/elasticsearch/common/io/stream/StreamInput.java, +++ b/core/src/main/java/org/elasticsearch/common/io/stream/StreamOutput.java, +++ b/core/src/main/java/org/elasticsearch/common/io/stream/StreamInput.java, +++ b/core/src/main/java/org/elasticsearch/common/io/stream/StreamOutput.java, +++ b/core/src/main/java/org/elasticsearch/index/query/support/InnerHitBuilder.java, +                sorts.add(in.readNamedWriteable(SortBuilder.class));, +                out.writeNamedWriteable(sort);, +++ b/core/src/main/java/org/elasticsearch/common/io/stream/StreamInput.java, +++ b/core/src/main/java/org/elasticsearch/common/io/stream/StreamOutput.java, +++ b/core/src/main/java/org/elasticsearch/index/query/support/InnerHitBuilder.java, +                sorts.add(in.readNamedWriteable(SortBuilder.class));, +                out.writeNamedWriteable(sort);, +++ b/core/src/main/java/org/elasticsearch/search/aggregations/metrics/tophits/TopHitsAggregatorBuilder.java, +                sorts.add(in.readNamedWriteable(SortBuilder.class));, +                out.writeNamedWriteable(sort);, +++ b/core/src/main/java/org/elasticsearch/common/io/stream/StreamInput.java, +++ b/core/src/main/java/org/elasticsearch/common/io/stream/StreamOutput.java, +++ b/core/src/main/java/org/elasticsearch/index/query/support/InnerHitBuilder.java, +                sorts.add(in.readNamedWriteable(SortBuilder.class));, +                out.writeNamedWriteable(sort);, +++ b/core/src/main/java/org/elasticsearch/search/aggregations/metrics/tophits/TopHitsAggregatorBuilder.java, +                sorts.add(in.readNamedWriteable(SortBuilder.class));, +                out.writeNamedWriteable(sort);, +++ b/core/src/main/java/org/elasticsearch/search/builder/SearchSourceBuilder.java, +                sorts.add(in.readNamedWriteable(SortBuilder.class));, +                out.writeNamedWriteable(sort);]
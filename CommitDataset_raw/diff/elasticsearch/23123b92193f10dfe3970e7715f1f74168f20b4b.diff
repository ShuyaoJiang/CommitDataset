[+++ b/plugin/src/main/java/org/elasticsearch/xpack/ml/job/config/Detector.java, +            boolean emptyPartitionField = Strings.isEmpty(partitionFieldName);, +            // partition, by and over field names cannot be duplicates, +            if (!emptyPartitionField) {, +                if (partitionFieldName.equals(byFieldName)) {, +                    throw new IllegalArgumentException(Messages.getMessage(Messages.JOB_CONFIG_DETECTOR_DUPLICATE_FIELD_NAME,, +                            PARTITION_FIELD_NAME_FIELD.getPreferredName(), BY_FIELD_NAME_FIELD.getPreferredName(),, +                            partitionFieldName));, +                }, +                if (partitionFieldName.equals(overFieldName)) {, +                    throw new IllegalArgumentException(Messages.getMessage(Messages.JOB_CONFIG_DETECTOR_DUPLICATE_FIELD_NAME,, +                            PARTITION_FIELD_NAME_FIELD.getPreferredName(), OVER_FIELD_NAME_FIELD.getPreferredName(),, +                            partitionFieldName));, +                }, +            }, +            if (!emptyByField && byFieldName.equals(overFieldName)) {, +                throw new IllegalArgumentException(Messages.getMessage(Messages.JOB_CONFIG_DETECTOR_DUPLICATE_FIELD_NAME,, +                        BY_FIELD_NAME_FIELD.getPreferredName(), OVER_FIELD_NAME_FIELD.getPreferredName(),, +                        byFieldName));, +            }, +, +            // by/over field names cannot be "count" - this requirement dates back to the early, +            // days of the Splunk app and could be removed now BUT ONLY IF THE C++ CODE IS CHANGED, +            // FIRST - see https://github.com/elastic/x-pack-elasticsearch/issues/858, +            if (COUNT.equals(byFieldName)) {, +                throw new IllegalArgumentException(Messages.getMessage(Messages.JOB_CONFIG_DETECTOR_COUNT_DISALLOWED,, +                        BY_FIELD_NAME_FIELD.getPreferredName()));, +            }, +            if (COUNT.equals(overFieldName)) {, +                throw new IllegalArgumentException(Messages.getMessage(Messages.JOB_CONFIG_DETECTOR_COUNT_DISALLOWED,, +                        OVER_FIELD_NAME_FIELD.getPreferredName()));, +            }, +, +++ b/plugin/src/main/java/org/elasticsearch/xpack/ml/job/config/Detector.java, +            boolean emptyPartitionField = Strings.isEmpty(partitionFieldName);, +            // partition, by and over field names cannot be duplicates, +            if (!emptyPartitionField) {, +                if (partitionFieldName.equals(byFieldName)) {, +                    throw new IllegalArgumentException(Messages.getMessage(Messages.JOB_CONFIG_DETECTOR_DUPLICATE_FIELD_NAME,, +                            PARTITION_FIELD_NAME_FIELD.getPreferredName(), BY_FIELD_NAME_FIELD.getPreferredName(),, +                            partitionFieldName));, +                }, +                if (partitionFieldName.equals(overFieldName)) {, +                    throw new IllegalArgumentException(Messages.getMessage(Messages.JOB_CONFIG_DETECTOR_DUPLICATE_FIELD_NAME,, +                            PARTITION_FIELD_NAME_FIELD.getPreferredName(), OVER_FIELD_NAME_FIELD.getPreferredName(),, +                            partitionFieldName));, +                }, +            }, +            if (!emptyByField && byFieldName.equals(overFieldName)) {, +                throw new IllegalArgumentException(Messages.getMessage(Messages.JOB_CONFIG_DETECTOR_DUPLICATE_FIELD_NAME,, +                        BY_FIELD_NAME_FIELD.getPreferredName(), OVER_FIELD_NAME_FIELD.getPreferredName(),, +                        byFieldName));, +            }, +, +            // by/over field names cannot be "count" - this requirement dates back to the early, +            // days of the Splunk app and could be removed now BUT ONLY IF THE C++ CODE IS CHANGED, +            // FIRST - see https://github.com/elastic/x-pack-elasticsearch/issues/858, +            if (COUNT.equals(byFieldName)) {, +                throw new IllegalArgumentException(Messages.getMessage(Messages.JOB_CONFIG_DETECTOR_COUNT_DISALLOWED,, +                        BY_FIELD_NAME_FIELD.getPreferredName()));, +            }, +            if (COUNT.equals(overFieldName)) {, +                throw new IllegalArgumentException(Messages.getMessage(Messages.JOB_CONFIG_DETECTOR_COUNT_DISALLOWED,, +                        OVER_FIELD_NAME_FIELD.getPreferredName()));, +            }, +, +++ b/plugin/src/main/java/org/elasticsearch/xpack/ml/job/messages/Messages.java, +    public static final String JOB_CONFIG_DETECTOR_DUPLICATE_FIELD_NAME =, +            "{0} and {1} cannot be the same: ''{2}''";, +    public static final String JOB_CONFIG_DETECTOR_COUNT_DISALLOWED =, +            "''count'' is not a permitted value for {0}";, +++ b/plugin/src/main/java/org/elasticsearch/xpack/ml/job/config/Detector.java, +            boolean emptyPartitionField = Strings.isEmpty(partitionFieldName);, +            // partition, by and over field names cannot be duplicates, +            if (!emptyPartitionField) {, +                if (partitionFieldName.equals(byFieldName)) {, +                    throw new IllegalArgumentException(Messages.getMessage(Messages.JOB_CONFIG_DETECTOR_DUPLICATE_FIELD_NAME,, +                            PARTITION_FIELD_NAME_FIELD.getPreferredName(), BY_FIELD_NAME_FIELD.getPreferredName(),, +                            partitionFieldName));, +                }, +                if (partitionFieldName.equals(overFieldName)) {, +                    throw new IllegalArgumentException(Messages.getMessage(Messages.JOB_CONFIG_DETECTOR_DUPLICATE_FIELD_NAME,, +                            PARTITION_FIELD_NAME_FIELD.getPreferredName(), OVER_FIELD_NAME_FIELD.getPreferredName(),, +                            partitionFieldName));, +                }, +            }, +            if (!emptyByField && byFieldName.equals(overFieldName)) {, +                throw new IllegalArgumentException(Messages.getMessage(Messages.JOB_CONFIG_DETECTOR_DUPLICATE_FIELD_NAME,, +                        BY_FIELD_NAME_FIELD.getPreferredName(), OVER_FIELD_NAME_FIELD.getPreferredName(),, +                        byFieldName));, +            }, +, +            // by/over field names cannot be "count" - this requirement dates back to the early, +            // days of the Splunk app and could be removed now BUT ONLY IF THE C++ CODE IS CHANGED, +            // FIRST - see https://github.com/elastic/x-pack-elasticsearch/issues/858, +            if (COUNT.equals(byFieldName)) {, +                throw new IllegalArgumentException(Messages.getMessage(Messages.JOB_CONFIG_DETECTOR_COUNT_DISALLOWED,, +                        BY_FIELD_NAME_FIELD.getPreferredName()));, +            }, +            if (COUNT.equals(overFieldName)) {]
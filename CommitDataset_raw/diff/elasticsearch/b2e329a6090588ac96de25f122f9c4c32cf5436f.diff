[+++ b/plugins/river/couchdb/src/main/java/org/elasticsearch/river/couchdb/CouchdbRiver.java, +import javax.net.ssl.HostnameVerifier;, +import javax.net.ssl.HttpsURLConnection;, +import javax.net.ssl.SSLSession;, +                        // we always store it as a string, +                        String lastSeqAsString = null;, +                        if (lastSeq instanceof List) {, +                            // bigcouch uses array for the seq, +                            try {, +                                XContentBuilder builder = XContentFactory.jsonBuilder();, +                                builder.startObject();, +                                for (Object value : ((List) lastSeq)) {, +                                    builder.value(value);, +                                }, +                                builder.endObject();, +                                lastSeqAsString = builder.string();, +                            } catch (Exception e) {, +                                logger.error("failed to convert last_seq to a json string", e);, +                            }, +                        } else {, +                            lastSeqAsString = lastSeq.toString();, +                        }, +                            logger.trace("processing [_seq  ]: [{}]/[{}]/[{}], last_seq [{}]", riverIndexName, riverName.name(), "_seq", lastSeqAsString);, +                                .source(jsonBuilder().startObject().startObject("couchdb").field("last_seq", lastSeqAsString).endObject().endObject()));, +                String lastSeq = null;, +                            lastSeq = couchdbState.get("last_seq").toString(); // we know its always a string, +                        file = file + "&since=" + URLEncoder.encode(lastSeq, "UTF-8");, +                        file = file + "&since=" + lastSeq;]
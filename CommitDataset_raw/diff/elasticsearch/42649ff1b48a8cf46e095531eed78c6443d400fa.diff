[+++ b/test/framework/src/main/java/org/elasticsearch/test/rest/ESRestTestCase.java, +import org.elasticsearch.cluster.SnapshotsInProgress;, +import java.util.HashMap;, +        final Map<String, List<Map<?,?>>> inProgressSnapshots = wipeSnapshots();, +, +, +        assertTrue("Found in progress snapshots [" + inProgressSnapshots + "].", inProgressSnapshots.isEmpty());, +     * @return Map of repository name to list of snapshots found in unfinished state, +    private Map<String, List<Map<?, ?>>> wipeSnapshots() throws IOException {, +        final Map<String, List<Map<?, ?>>> inProgressSnapshots = new HashMap<>();, +                    if (SnapshotsInProgress.State.valueOf((String) snapshotInfo.get("state")).completed() == false) {, +                        inProgressSnapshots.computeIfAbsent(repoName, key -> new ArrayList<>()).add(snapshotInfo);, +                    }, +        return inProgressSnapshots;]
[+++ b/src/main/java/org/elasticsearch/action/admin/cluster/settings/ClusterUpdateSettingsResponse.java, +import java.io.IOException;, +, +import org.elasticsearch.common.settings.ImmutableSettings;, +import org.elasticsearch.common.settings.Settings;, +    Settings transientSettings;, +    Settings persistentSettings;, +, +        this.persistentSettings = ImmutableSettings.EMPTY;, +        this.transientSettings = ImmutableSettings.EMPTY;, +    }, +, +    ClusterUpdateSettingsResponse(Settings transientSettings, Settings persistentSettings) {, +        this.persistentSettings = persistentSettings;, +        this.transientSettings = transientSettings;, +        transientSettings = ImmutableSettings.readSettingsFromStream(in);, +        persistentSettings = ImmutableSettings.readSettingsFromStream(in);, +    }, +, +    public Settings getTransientSettings() {, +        return transientSettings;, +    }, +, +    public Settings getPersistentSettings() {, +        return persistentSettings;, +        ImmutableSettings.writeSettingsToStream(transientSettings, out);, +        ImmutableSettings.writeSettingsToStream(persistentSettings, out);, +++ b/src/main/java/org/elasticsearch/action/admin/cluster/settings/ClusterUpdateSettingsResponse.java, +import java.io.IOException;, +, +import org.elasticsearch.common.settings.ImmutableSettings;, +import org.elasticsearch.common.settings.Settings;, +    Settings transientSettings;, +    Settings persistentSettings;, +, +        this.persistentSettings = ImmutableSettings.EMPTY;, +        this.transientSettings = ImmutableSettings.EMPTY;, +    }, +, +    ClusterUpdateSettingsResponse(Settings transientSettings, Settings persistentSettings) {, +        this.persistentSettings = persistentSettings;, +        this.transientSettings = transientSettings;, +        transientSettings = ImmutableSettings.readSettingsFromStream(in);, +        persistentSettings = ImmutableSettings.readSettingsFromStream(in);, +    }, +, +    public Settings getTransientSettings() {, +        return transientSettings;, +    }, +, +    public Settings getPersistentSettings() {, +        return persistentSettings;, +        ImmutableSettings.writeSettingsToStream(transientSettings, out);, +        ImmutableSettings.writeSettingsToStream(persistentSettings, out);, +++ b/src/main/java/org/elasticsearch/action/admin/cluster/settings/TransportClusterUpdateSettingsAction.java, +import org.elasticsearch.common.xcontent.XContentBuilder;, +import org.elasticsearch.common.xcontent.XContentFactory;, +import org.elasticsearch.common.xcontent.XContentType;, +        final ImmutableSettings.Builder transientUpdates = ImmutableSettings.settingsBuilder();, +        final ImmutableSettings.Builder persistentUpdates = ImmutableSettings.settingsBuilder();, +, +                                transientUpdates.put(entry.getKey(), entry.getValue());, +                                persistentUpdates.put(entry.getKey(), entry.getValue());, +        return new ClusterUpdateSettingsResponse(transientUpdates.build(), persistentUpdates.build());, +++ b/src/main/java/org/elasticsearch/action/admin/cluster/settings/ClusterUpdateSettingsResponse.java, +import java.io.IOException;, +, +import org.elasticsearch.common.settings.ImmutableSettings;, +import org.elasticsearch.common.settings.Settings;, +    Settings transientSettings;, +    Settings persistentSettings;, +, +        this.persistentSettings = ImmutableSettings.EMPTY;, +        this.transientSettings = ImmutableSettings.EMPTY;, +    }, +, +    ClusterUpdateSettingsResponse(Settings transientSettings, Settings persistentSettings) {, +        this.persistentSettings = persistentSettings;, +        this.transientSettings = transientSettings;, +        transientSettings = ImmutableSettings.readSettingsFromStream(in);, +        persistentSettings = ImmutableSettings.readSettingsFromStream(in);, +    }, +, +    public Settings getTransientSettings() {, +        return transientSettings;, +    }, +, +    public Settings getPersistentSettings() {, +        return persistentSettings;, +        ImmutableSettings.writeSettingsToStream(transientSettings, out);, +        ImmutableSettings.writeSettingsToStream(persistentSettings, out);, +++ b/src/main/java/org/elasticsearch/action/admin/cluster/settings/TransportClusterUpdateSettingsAction.java, +import org.elasticsearch.common.xcontent.XContentBuilder;, +import org.elasticsearch.common.xcontent.XContentFactory;, +import org.elasticsearch.common.xcontent.XContentType;, +        final ImmutableSettings.Builder transientUpdates = ImmutableSettings.settingsBuilder();, +        final ImmutableSettings.Builder persistentUpdates = ImmutableSettings.settingsBuilder();, +, +                                transientUpdates.put(entry.getKey(), entry.getValue());, +                                persistentUpdates.put(entry.getKey(), entry.getValue());]
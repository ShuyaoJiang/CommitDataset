[+++ b/modules/elasticsearch/src/main/java/org/elasticsearch/ElasticSearchException.java, +import org.elasticsearch.rest.RestStatus;, +, +     * Returns the rest status code associated with this exception., +     */, +    public RestStatus status() {, +        ElasticSearchException current = this;, +        while (current instanceof ElasticSearchWrapperException) {, +            if (getCause() == null) {, +                break;, +            }, +            if (getCause() instanceof ElasticSearchException) {, +                current = (ElasticSearchException) getCause();, +            } else {, +                break;, +            }, +        }, +        if (current == this) {, +            return RestStatus.INTERNAL_SERVER_ERROR;, +        } else {, +            return current.status();, +        }, +    }, +, +    /**, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/ElasticSearchException.java, +import org.elasticsearch.rest.RestStatus;, +, +     * Returns the rest status code associated with this exception., +     */, +    public RestStatus status() {, +        ElasticSearchException current = this;, +        while (current instanceof ElasticSearchWrapperException) {, +            if (getCause() == null) {, +                break;, +            }, +            if (getCause() instanceof ElasticSearchException) {, +                current = (ElasticSearchException) getCause();, +            } else {, +                break;, +            }, +        }, +        if (current == this) {, +            return RestStatus.INTERNAL_SERVER_ERROR;, +        } else {, +            return current.status();, +        }, +    }, +, +    /**, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/http/HttpServer.java, +import static org.elasticsearch.rest.RestStatus.*;, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/ElasticSearchException.java, +import org.elasticsearch.rest.RestStatus;, +, +     * Returns the rest status code associated with this exception., +     */, +    public RestStatus status() {, +        ElasticSearchException current = this;, +        while (current instanceof ElasticSearchWrapperException) {, +            if (getCause() == null) {, +                break;, +            }, +            if (getCause() instanceof ElasticSearchException) {, +                current = (ElasticSearchException) getCause();, +            } else {, +                break;, +            }, +        }, +        if (current == this) {, +            return RestStatus.INTERNAL_SERVER_ERROR;, +        } else {, +            return current.status();, +        }, +    }, +, +    /**, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/http/HttpServer.java, +import static org.elasticsearch.rest.RestStatus.*;, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/http/netty/NettyHttpChannel.java, +import org.elasticsearch.rest.RestStatus;, +    private HttpResponseStatus getStatus(RestStatus status) {, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/ElasticSearchException.java, +import org.elasticsearch.rest.RestStatus;, +, +     * Returns the rest status code associated with this exception., +     */, +    public RestStatus status() {, +        ElasticSearchException current = this;, +        while (current instanceof ElasticSearchWrapperException) {, +            if (getCause() == null) {, +                break;, +            }, +            if (getCause() instanceof ElasticSearchException) {, +                current = (ElasticSearchException) getCause();, +            } else {, +                break;, +            }, +        }, +        if (current == this) {]
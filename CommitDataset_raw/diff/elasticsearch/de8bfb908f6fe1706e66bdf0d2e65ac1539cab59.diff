[+++ b/plugins/analysis-icu/src/main/java/org/elasticsearch/index/mapper/ICUCollationKeywordFieldMapper.java, +            throw new UnsupportedOperationException("[fuzzy] queries are not supported on [" + CONTENT_TYPE + "] fields.");, +            throw new UnsupportedOperationException("[prefix] queries are not supported on [" + CONTENT_TYPE + "] fields.");, +        }, +, +        @Override, +        public Query wildcardQuery(String value, QueryShardContext context) {, +            throw new UnsupportedOperationException("[wildcard] queries are not supported on [" + CONTENT_TYPE + "] fields.");, +            throw new UnsupportedOperationException("[regexp] queries are not supported on [" + CONTENT_TYPE + "] fields.");, +++ b/plugins/analysis-icu/src/main/java/org/elasticsearch/index/mapper/ICUCollationKeywordFieldMapper.java, +            throw new UnsupportedOperationException("[fuzzy] queries are not supported on [" + CONTENT_TYPE + "] fields.");, +            throw new UnsupportedOperationException("[prefix] queries are not supported on [" + CONTENT_TYPE + "] fields.");, +        }, +, +        @Override, +        public Query wildcardQuery(String value, QueryShardContext context) {, +            throw new UnsupportedOperationException("[wildcard] queries are not supported on [" + CONTENT_TYPE + "] fields.");, +            throw new UnsupportedOperationException("[regexp] queries are not supported on [" + CONTENT_TYPE + "] fields.");, +++ b/plugins/analysis-icu/src/test/java/org/elasticsearch/index/mapper/CollationFieldTypeTests.java, +    public void testWildcardQuery() {, +        MappedFieldType ft = createDefaultFieldType();, +        ft.setName("field");, +        ft.setIndexOptions(IndexOptions.DOCS);, +        expectThrows(UnsupportedOperationException.class,, +            () -> ft.wildcardQuery("foo*", null));, +    }, +, +++ b/plugins/analysis-icu/src/main/java/org/elasticsearch/index/mapper/ICUCollationKeywordFieldMapper.java, +            throw new UnsupportedOperationException("[fuzzy] queries are not supported on [" + CONTENT_TYPE + "] fields.");, +            throw new UnsupportedOperationException("[prefix] queries are not supported on [" + CONTENT_TYPE + "] fields.");, +        }, +, +        @Override, +        public Query wildcardQuery(String value, QueryShardContext context) {, +            throw new UnsupportedOperationException("[wildcard] queries are not supported on [" + CONTENT_TYPE + "] fields.");, +            throw new UnsupportedOperationException("[regexp] queries are not supported on [" + CONTENT_TYPE + "] fields.");, +++ b/plugins/analysis-icu/src/test/java/org/elasticsearch/index/mapper/CollationFieldTypeTests.java, +    public void testWildcardQuery() {, +        MappedFieldType ft = createDefaultFieldType();, +        ft.setName("field");, +        ft.setIndexOptions(IndexOptions.DOCS);, +        expectThrows(UnsupportedOperationException.class,, +            () -> ft.wildcardQuery("foo*", null));, +    }, +, +++ b/server/src/main/java/org/elasticsearch/index/mapper/IndexFieldMapper.java, +        @Override, +        public Query wildcardQuery(String value, QueryShardContext context) {, +            if (isSameIndex(value, context.getFullyQualifiedIndex().getName())) {, +                return Queries.newMatchAllQuery();, +            } else {, +                return Queries.newMatchNoDocsQuery("Index didn't match. Index queried: " + context.index().getName() + " vs. " + value);, +            }, +        }, +, +            String pattern = value instanceof BytesRef ? ((BytesRef) value).utf8ToString() : value.toString();, +++ b/plugins/analysis-icu/src/main/java/org/elasticsearch/index/mapper/ICUCollationKeywordFieldMapper.java, +            throw new UnsupportedOperationException("[fuzzy] queries are not supported on [" + CONTENT_TYPE + "] fields.");, +            throw new UnsupportedOperationException("[prefix] queries are not supported on [" + CONTENT_TYPE + "] fields.");, +        }, +, +        @Override, +        public Query wildcardQuery(String value, QueryShardContext context) {, +            throw new UnsupportedOperationException("[wildcard] queries are not supported on [" + CONTENT_TYPE + "] fields.");, +            throw new UnsupportedOperationException("[regexp] queries are not supported on [" + CONTENT_TYPE + "] fields.");, +++ b/plugins/analysis-icu/src/test/java/org/elasticsearch/index/mapper/CollationFieldTypeTests.java, +    public void testWildcardQuery() {, +        MappedFieldType ft = createDefaultFieldType();, +        ft.setName("field");, +        ft.setIndexOptions(IndexOptions.DOCS);, +        expectThrows(UnsupportedOperationException.class,, +            () -> ft.wildcardQuery("foo*", null));, +    }, +, +++ b/server/src/main/java/org/elasticsearch/index/mapper/IndexFieldMapper.java, +        @Override, +        public Query wildcardQuery(String value, QueryShardContext context) {, +            if (isSameIndex(value, context.getFullyQualifiedIndex().getName())) {, +                return Queries.newMatchAllQuery();, +            } else {, +                return Queries.newMatchNoDocsQuery("Index didn't match. Index queried: " + context.index().getName() + " vs. " + value);, +            }, +        }, +, +            String pattern = value instanceof BytesRef ? ((BytesRef) value).utf8ToString() : value.toString();, +++ b/server/src/main/java/org/elasticsearch/index/mapper/MappedFieldType.java, +    public Query wildcardQuery(String value, QueryShardContext context) {, +        throw new QueryShardException(context, "Can only use wildcard queries on keyword and text fields - not on [" + name + "] which is of type [" + typeName() + "]");, +    }, +, +++ b/plugins/analysis-icu/src/main/java/org/elasticsearch/index/mapper/ICUCollationKeywordFieldMapper.java, +            throw new UnsupportedOperationException("[fuzzy] queries are not supported on [" + CONTENT_TYPE + "] fields.");, +            throw new UnsupportedOperationException("[prefix] queries are not supported on [" + CONTENT_TYPE + "] fields.");, +        }, +, +        @Override, +        public Query wildcardQuery(String value, QueryShardContext context) {, +            throw new UnsupportedOperationException("[wildcard] queries are not supported on [" + CONTENT_TYPE + "] fields.");, +            throw new UnsupportedOperationException("[regexp] queries are not supported on [" + CONTENT_TYPE + "] fields.");, +++ b/plugins/analysis-icu/src/test/java/org/elasticsearch/index/mapper/CollationFieldTypeTests.java]
[+++ b/x-pack/plugin/security/src/test/java/org/elasticsearch/xpack/security/transport/ssl/SslIntegrationTests.java, +import org.elasticsearch.common.util.set.Sets;, +import org.elasticsearch.xpack.core.XPackSettings;, +import org.elasticsearch.xpack.core.ssl.SSLConfigurationSettings;, +import java.util.ArrayList;, +import java.util.Collections;, +import java.util.HashSet;, +import java.util.List;, +import java.util.Set;, +    public void testThatUnconfiguredCiphersAreRejected() throws Exception {, +        Set<String> supportedCiphers = Sets.newHashSet(SSLContext.getDefault().getSupportedSSLParameters().getCipherSuites());, +        Set<String> defaultXPackCiphers = Sets.newHashSet(XPackSettings.DEFAULT_CIPHERS);, +        final List<String> unconfiguredCiphers = new ArrayList<>(Sets.difference(supportedCiphers, defaultXPackCiphers));, +        Collections.shuffle(unconfiguredCiphers, random());, +        assumeFalse("the unconfigured ciphers list is empty", unconfiguredCiphers.isEmpty());, +, +                .putList("xpack.ssl.cipher_suites", unconfiguredCiphers)]
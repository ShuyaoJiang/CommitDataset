[+++ b/plugin/src/test/java/org/elasticsearch/xpack/security/transport/SecurityServerTransportInterceptorTests.java, +import org.elasticsearch.test.VersionUtils;, +import static org.hamcrest.Matchers.equalTo;, +        final User authUser = randomBoolean() ? new User("authenticator") : null;, +        final User user = new User("test", randomRoles(), authUser);, +        final User authUser = randomBoolean() ? new User("authenticator") : null;, +        final User user = new User("test", randomRoles(), authUser);, +        final User authUser = randomBoolean() ? new User("authenticator") : null;, +        final User user = new User("joe", randomRoles(), authUser);, +        final User authUser = randomBoolean() ? new User("authenticator") : null;, +        final User user = new User("joe", randomRoles(), authUser);, +, +    private String[] randomRoles() {, +        return generateRandomStringArray(3, 10, false, true);, +    }, +, +]
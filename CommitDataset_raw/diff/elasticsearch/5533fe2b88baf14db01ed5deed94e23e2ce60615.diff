[+++ b/src/main/java/org/elasticsearch/common/settings/ImmutableSettings.java, +         * @param prefix     The prefix to filter property key by, +         * Puts all the properties with keys starting with the provided <tt>prefix</tt>., +         *, +         * @param prefix     The prefix to filter property key by, +         * @param properties The properties to put, +         * @return The builder, +         */, +        public Builder putProperties(String prefix, Properties properties, String[] ignorePrefixes) {, +            for (Object key1 : properties.keySet()) {, +                String key = (String) key1;, +                String value = properties.getProperty(key);, +                if (key.startsWith(prefix)) {, +                    boolean ignore = false;, +                    for (String ignorePrefix : ignorePrefixes) {, +                        if (key.startsWith(ignorePrefix)) {, +                            ignore = true;, +                            break;, +                        }, +                    }, +                    if (!ignore) {, +                        map.put(key.substring(prefix.length()), value);, +                    }, +                }, +            }, +            return this;, +        }, +, +        /**, +++ b/src/main/java/org/elasticsearch/common/settings/ImmutableSettings.java, +         * @param prefix     The prefix to filter property key by, +         * Puts all the properties with keys starting with the provided <tt>prefix</tt>., +         *, +         * @param prefix     The prefix to filter property key by, +         * @param properties The properties to put, +         * @return The builder, +         */, +        public Builder putProperties(String prefix, Properties properties, String[] ignorePrefixes) {, +            for (Object key1 : properties.keySet()) {, +                String key = (String) key1;, +                String value = properties.getProperty(key);, +                if (key.startsWith(prefix)) {, +                    boolean ignore = false;, +                    for (String ignorePrefix : ignorePrefixes) {, +                        if (key.startsWith(ignorePrefix)) {, +                            ignore = true;, +                            break;, +                        }, +                    }, +                    if (!ignore) {, +                        map.put(key.substring(prefix.length()), value);, +                    }, +                }, +            }, +            return this;, +        }, +, +        /**, +++ b/src/main/java/org/elasticsearch/node/internal/InternalSettingsPerparer.java, +        // ignore this prefixes when getting properties from es. and elasticsearch., +        String[] ignorePrefixes = new String[]{"es.default.", "elasticsearch.default."};, +                .putProperties("elasticsearch.", System.getProperties(), ignorePrefixes), +                .putProperties("es.", System.getProperties(), ignorePrefixes), +                .putProperties("elasticsearch.", System.getProperties(), ignorePrefixes), +                .putProperties("es.", System.getProperties(), ignorePrefixes)]
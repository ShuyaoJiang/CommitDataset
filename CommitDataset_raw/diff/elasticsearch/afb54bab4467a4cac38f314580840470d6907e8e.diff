[+++ b/core/build.gradle, +  compile 'commons-cli:commons-cli:1.3.1', +++ b/core/build.gradle, +  compile 'commons-cli:commons-cli:1.3.1', +++ b/core/src/main/java/org/elasticsearch/bootstrap/Bootstrap.java, +import org.elasticsearch.common.cli.CliTool;, +import org.elasticsearch.common.cli.Terminal;, +import java.io.ByteArrayOutputStream;, +import java.io.IOException;, +import java.io.PrintStream;, +import java.nio.file.Path;, +import java.util.Locale;, +import java.util.concurrent.CountDownLatch;, +, +        BootstrapCLIParser bootstrapCLIParser = new BootstrapCLIParser();, +        CliTool.ExitStatus status = bootstrapCLIParser.execute(args);, +        if (CliTool.ExitStatus.OK != status) {, +            exit(status.status());, +    @SuppressForbidden(reason = "System#err"), +    private static void sysError(String line, boolean flush) {, +        System.err.println(line);, +        if (flush) {, +            System.err.flush();, +        }, +    }, +, +++ b/core/build.gradle, +  compile 'commons-cli:commons-cli:1.3.1', +++ b/core/src/main/java/org/elasticsearch/bootstrap/Bootstrap.java, +import org.elasticsearch.common.cli.CliTool;, +import org.elasticsearch.common.cli.Terminal;, +import java.io.ByteArrayOutputStream;, +import java.io.IOException;, +import java.io.PrintStream;, +import java.nio.file.Path;, +import java.util.Locale;, +import java.util.concurrent.CountDownLatch;, +, +        BootstrapCLIParser bootstrapCLIParser = new BootstrapCLIParser();, +        CliTool.ExitStatus status = bootstrapCLIParser.execute(args);, +        if (CliTool.ExitStatus.OK != status) {, +            exit(status.status());, +    @SuppressForbidden(reason = "System#err"), +    private static void sysError(String line, boolean flush) {, +        System.err.println(line);, +        if (flush) {, +            System.err.flush();, +        }, +    }, +, +++ b/core/src/main/java/org/elasticsearch/bootstrap/BootstrapCLIParser.java, +/*, + * Licensed to Elasticsearch under one or more contributor, + * license agreements. See the NOTICE file distributed with, + * this work for additional information regarding copyright, + * ownership. Elasticsearch licenses this file to you under, + * the Apache License, Version 2.0 (the "License"); you may, + * not use this file except in compliance with the License., + * You may obtain a copy of the License at, + *, + *    http://www.apache.org/licenses/LICENSE-2.0, + *, + * Unless required by applicable law or agreed to in writing,, + * software distributed under the License is distributed on an, + * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY, + * KIND, either express or implied.  See the License for the, + * specific language governing permissions and limitations, + * under the License., + */, +, +package org.elasticsearch.bootstrap;, +, +import org.apache.commons.cli.CommandLine;, +import org.apache.commons.cli.Option;, +import org.elasticsearch.Build;, +import org.elasticsearch.common.Strings;, +import org.elasticsearch.common.SuppressForbidden;, +import org.elasticsearch.common.cli.CliTool;, +import org.elasticsearch.common.cli.CliToolConfig;, +import org.elasticsearch.common.cli.UserError;, +import org.elasticsearch.common.cli.Terminal;, +import org.elasticsearch.common.settings.Settings;, +import org.elasticsearch.env.Environment;, +import org.elasticsearch.monitor.jvm.JvmInfo;, +, +import java.util.HashMap;, +import java.util.Iterator;, +import java.util.Locale;, +import java.util.Map;, +import java.util.Properties;, +, +import static org.elasticsearch.common.cli.CliToolConfig.Builder.cmd;, +import static org.elasticsearch.common.cli.CliToolConfig.Builder.optionBuilder;, +, +final class BootstrapCLIParser extends CliTool {, +, +    private static final CliToolConfig CONFIG = CliToolConfig.config("elasticsearch", BootstrapCLIParser.class), +            .cmds(Start.CMD, Version.CMD), +            .build();, +]
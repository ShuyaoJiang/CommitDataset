[+++ b/.ci/matrix-build-javas.yml, +  - java11, +++ b/.ci/matrix-build-javas.yml, +  - java11, +++ b/.ci/matrix-runtime-javas.yml, +  - java11, +++ b/.ci/matrix-build-javas.yml, +  - java11, +++ b/.ci/matrix-runtime-javas.yml, +  - java11, +++ b/buildSrc/src/main/resources/forbidden/jdk-signatures.txt, +# uncomment when https://github.com/elastic/elasticsearch/issues/31715 is fixed, +# java.lang.Thread#stop(java.lang.Throwable), +++ b/.ci/matrix-build-javas.yml, +  - java11, +++ b/.ci/matrix-runtime-javas.yml, +  - java11, +++ b/buildSrc/src/main/resources/forbidden/jdk-signatures.txt, +# uncomment when https://github.com/elastic/elasticsearch/issues/31715 is fixed, +# java.lang.Thread#stop(java.lang.Throwable), +++ b/distribution/bwc/build.gradle, +, +import java.nio.charset.StandardCharsets, +import static org.elasticsearch.gradle.BuildPlugin.getJavaHome, +    // send RUNTIME_JAVA_HOME so the build doesn't fails on newer version the branch doesn't know about, +    environment('RUNTIME_JAVA_HOME', getJavaHome(it, rootProject.ext.minimumRuntimeVersion.getMajorVersion() as int)), +    if (["5.6", "6.0", "6.1"].contains(bwcBranch)) {, +    } else if (["6.3", "6.x"].contains(bwcBranch)) {, +      environment('JAVA_HOME', getJavaHome(it, 10)), +    standardOutput = new IndentingOutputStream(System.out), +    errorOutput = new IndentingOutputStream(System.err), +, +class IndentingOutputStream extends OutputStream {, +, +  public static final byte[] INDENT = "  [bwc] ".getBytes(StandardCharsets.UTF_8), +  private final OutputStream delegate, +, +  public IndentingOutputStream(OutputStream delegate) {, +      this.delegate = delegate, +  }, +, +  @Override, +  public void write(int b) {, +    write([b] as int[], 0, 1), +  }, +, +  public void write(int[] bytes, int offset, int length) {, +    for (int i = 0; i < bytes.length; i++) {, +      delegate.write(bytes[i]), +      if (bytes[i] == '\n') {, +        delegate.write(INDENT), +      }, +    }, +  }, +}, +++ b/.ci/matrix-build-javas.yml, +  - java11, +++ b/.ci/matrix-runtime-javas.yml, +  - java11, +++ b/buildSrc/src/main/resources/forbidden/jdk-signatures.txt, +# uncomment when https://github.com/elastic/elasticsearch/issues/31715 is fixed, +# java.lang.Thread#stop(java.lang.Throwable), +++ b/distribution/bwc/build.gradle, +, +import java.nio.charset.StandardCharsets, +import static org.elasticsearch.gradle.BuildPlugin.getJavaHome, +    // send RUNTIME_JAVA_HOME so the build doesn't fails on newer version the branch doesn't know about, +    environment('RUNTIME_JAVA_HOME', getJavaHome(it, rootProject.ext.minimumRuntimeVersion.getMajorVersion() as int)), +    if (["5.6", "6.0", "6.1"].contains(bwcBranch)) {, +    } else if (["6.3", "6.x"].contains(bwcBranch)) {, +      environment('JAVA_HOME', getJavaHome(it, 10)), +    standardOutput = new IndentingOutputStream(System.out), +    errorOutput = new IndentingOutputStream(System.err), +, +class IndentingOutputStream extends OutputStream {, +, +  public static final byte[] INDENT = "  [bwc] ".getBytes(StandardCharsets.UTF_8), +  private final OutputStream delegate, +, +  public IndentingOutputStream(OutputStream delegate) {, +      this.delegate = delegate, +  }, +, +  @Override, +  public void write(int b) {, +    write([b] as int[], 0, 1), +  }, +, +  public void write(int[] bytes, int offset, int length) {, +    for (int i = 0; i < bytes.length; i++) {, +      delegate.write(bytes[i]), +      if (bytes[i] == '\n') {, +        delegate.write(INDENT), +      }, +    }, +  }, +}, +++ b/docs/build.gradle, +// remove when https://github.com/elastic/elasticsearch/issues/31305 is fixed, +if (rootProject.ext.compilerJavaVersion.isJava11()) {]
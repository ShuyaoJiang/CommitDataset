[+++ b/plugin/monitoring/src/main/java/org/elasticsearch/xpack/monitoring/exporter/Exporters.java, +        final ClusterState state = clusterService.state();, +, +        if (ClusterState.UNKNOWN_UUID.equals(state.metaData().clusterUUID()) || state.version() == ClusterState.UNKNOWN_VERSION) {, +++ b/plugin/monitoring/src/main/java/org/elasticsearch/xpack/monitoring/exporter/Exporters.java, +        final ClusterState state = clusterService.state();, +, +        if (ClusterState.UNKNOWN_UUID.equals(state.metaData().clusterUUID()) || state.version() == ClusterState.UNKNOWN_VERSION) {, +++ b/plugin/monitoring/src/test/java/org/elasticsearch/xpack/monitoring/exporter/ExportersTests.java, +import org.elasticsearch.cluster.metadata.MetaData;, +    private final MetaData metadata = mock(MetaData.class);, +    public void init() {, +        when(state.metaData()).thenReturn(metadata);, +        if (rarely()) {, +            when(metadata.clusterUUID()).thenReturn(ClusterState.UNKNOWN_UUID);, +        } else {, +        }]
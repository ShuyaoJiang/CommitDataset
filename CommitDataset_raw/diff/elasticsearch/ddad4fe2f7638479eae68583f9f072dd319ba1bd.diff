[+++ b/src/test/java/org/elasticsearch/test/integration/recovery/RecoveryWhileUnderLoadTests.java, +import org.elasticsearch.action.admin.indices.refresh.RefreshResponse;, +import static org.elasticsearch.test.hamcrest.ElasticsearchAssertions.assertNoFailures;, +        refreshAndAssert();, +            assertThat("iteration: " + i + " failed", client().prepareCount().setQuery(matchAllQuery()).execute().actionGet().getCount(), equalTo(indexCounter.get()));, +        refreshAndAssert();, +            assertThat("iteration: " + i + " failed", client().prepareCount().setQuery(matchAllQuery()).execute().actionGet().getCount(), equalTo(indexCounter.get()));, +        refreshAndAssert();, +        refreshAndAssert();, +            assertThat("iteration: " + i + " failed", client().prepareCount().setQuery(matchAllQuery()).execute().actionGet().getCount(), equalTo(indexCounter.get()));, +    , +    private RefreshResponse refreshAndAssert() {, +        RefreshResponse actionGet = client().admin().indices().prepareRefresh().execute().actionGet();, +        assertNoFailures(actionGet);, +        return actionGet;, +    }]
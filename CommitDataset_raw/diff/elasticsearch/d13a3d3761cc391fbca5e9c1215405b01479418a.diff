[+++ b/modules/reindex/src/main/java/org/elasticsearch/index/reindex/remote/RemoteScrollableHitSource.java, +import org.elasticsearch.common.xcontent.XContentFactory;, +                            HttpEntity responseEntity = response.getEntity();, +                            InputStream content = responseEntity.getContent();, +                            XContentType xContentType = null;, +                            if (responseEntity.getContentType() != null) {, +                                 xContentType = XContentType.fromMediaTypeOrFormat(responseEntity.getContentType().getValue());, +                            }, +                            if (xContentType == null) {, +                                //auto-detect as a fallback, +                                xContentType = XContentFactory.xContentType(content);, +                            }, +++ b/modules/reindex/src/main/java/org/elasticsearch/index/reindex/remote/RemoteScrollableHitSource.java, +import org.elasticsearch.common.xcontent.XContentFactory;, +                            HttpEntity responseEntity = response.getEntity();, +                            InputStream content = responseEntity.getContent();, +                            XContentType xContentType = null;, +                            if (responseEntity.getContentType() != null) {, +                                 xContentType = XContentType.fromMediaTypeOrFormat(responseEntity.getContentType().getValue());, +                            }, +                            if (xContentType == null) {, +                                //auto-detect as a fallback, +                                xContentType = XContentFactory.xContentType(content);, +                            }, +++ b/modules/reindex/src/test/java/org/elasticsearch/index/reindex/remote/RemoteScrollableHitSourceTests.java, +                    httpResponse.setEntity(new InputStreamEntity(resource.openStream(),, +                            randomBoolean() ? ContentType.APPLICATION_JSON : null));]
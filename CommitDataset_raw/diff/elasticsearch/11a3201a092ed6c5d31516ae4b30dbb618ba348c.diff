[+++ b/src/main/java/org/elasticsearch/cluster/block/ClusterBlock.java, +import java.util.ArrayList;, +import java.util.EnumSet;, +    private EnumSet<ClusterBlockLevel> levels;, +    public ClusterBlock(int id, String description, boolean retryable, boolean disableStatePersistence, RestStatus status, EnumSet<ClusterBlockLevel> levels) {, +    public EnumSet<ClusterBlockLevel> levels() {, +        final int len = in.readVInt();, +        ArrayList<ClusterBlockLevel> levels = new ArrayList<>();, +        for (int i = 0; i < len; i++) {, +            levels.add(ClusterBlockLevel.fromId(in.readVInt()));, +        this.levels = EnumSet.copyOf(levels);, +        out.writeVInt(levels.size());, +++ b/src/main/java/org/elasticsearch/cluster/block/ClusterBlock.java, +import java.util.ArrayList;, +import java.util.EnumSet;, +    private EnumSet<ClusterBlockLevel> levels;, +    public ClusterBlock(int id, String description, boolean retryable, boolean disableStatePersistence, RestStatus status, EnumSet<ClusterBlockLevel> levels) {, +    public EnumSet<ClusterBlockLevel> levels() {, +        final int len = in.readVInt();, +        ArrayList<ClusterBlockLevel> levels = new ArrayList<>();, +        for (int i = 0; i < len; i++) {, +            levels.add(ClusterBlockLevel.fromId(in.readVInt()));, +        this.levels = EnumSet.copyOf(levels);, +        out.writeVInt(levels.size());, +++ b/src/main/java/org/elasticsearch/cluster/block/ClusterBlockLevel.java, +import java.util.EnumSet;, +, +    public static final EnumSet<ClusterBlockLevel> ALL = EnumSet.of(READ, WRITE, METADATA);, +    public static final EnumSet<ClusterBlockLevel> READ_WRITE = EnumSet.of(READ, WRITE);, +++ b/src/main/java/org/elasticsearch/cluster/block/ClusterBlock.java, +import java.util.ArrayList;, +import java.util.EnumSet;, +    private EnumSet<ClusterBlockLevel> levels;, +    public ClusterBlock(int id, String description, boolean retryable, boolean disableStatePersistence, RestStatus status, EnumSet<ClusterBlockLevel> levels) {, +    public EnumSet<ClusterBlockLevel> levels() {, +        final int len = in.readVInt();, +        ArrayList<ClusterBlockLevel> levels = new ArrayList<>();, +        for (int i = 0; i < len; i++) {, +            levels.add(ClusterBlockLevel.fromId(in.readVInt()));, +        this.levels = EnumSet.copyOf(levels);, +        out.writeVInt(levels.size());, +++ b/src/main/java/org/elasticsearch/cluster/block/ClusterBlockLevel.java, +import java.util.EnumSet;, +, +    public static final EnumSet<ClusterBlockLevel> ALL = EnumSet.of(READ, WRITE, METADATA);, +    public static final EnumSet<ClusterBlockLevel> READ_WRITE = EnumSet.of(READ, WRITE);, +++ b/src/main/java/org/elasticsearch/cluster/metadata/IndexMetaData.java, +import java.util.EnumSet;, +    public static final ClusterBlock INDEX_READ_ONLY_BLOCK = new ClusterBlock(5, "index read-only (api)", false, false, RestStatus.FORBIDDEN, EnumSet.of(ClusterBlockLevel.WRITE, ClusterBlockLevel.METADATA));, +    public static final ClusterBlock INDEX_READ_BLOCK = new ClusterBlock(7, "index read (api)", false, false, RestStatus.FORBIDDEN, EnumSet.of(ClusterBlockLevel.READ));, +    public static final ClusterBlock INDEX_WRITE_BLOCK = new ClusterBlock(8, "index write (api)", false, false, RestStatus.FORBIDDEN, EnumSet.of(ClusterBlockLevel.WRITE));, +    public static final ClusterBlock INDEX_METADATA_BLOCK = new ClusterBlock(9, "index metadata (api)", false, false, RestStatus.FORBIDDEN, EnumSet.of(ClusterBlockLevel.METADATA));, +++ b/src/main/java/org/elasticsearch/cluster/block/ClusterBlock.java, +import java.util.ArrayList;, +import java.util.EnumSet;, +    private EnumSet<ClusterBlockLevel> levels;, +    public ClusterBlock(int id, String description, boolean retryable, boolean disableStatePersistence, RestStatus status, EnumSet<ClusterBlockLevel> levels) {, +    public EnumSet<ClusterBlockLevel> levels() {, +        final int len = in.readVInt();, +        ArrayList<ClusterBlockLevel> levels = new ArrayList<>();, +        for (int i = 0; i < len; i++) {, +            levels.add(ClusterBlockLevel.fromId(in.readVInt()));, +        this.levels = EnumSet.copyOf(levels);, +        out.writeVInt(levels.size());, +++ b/src/main/java/org/elasticsearch/cluster/block/ClusterBlockLevel.java, +import java.util.EnumSet;, +, +    public static final EnumSet<ClusterBlockLevel> ALL = EnumSet.of(READ, WRITE, METADATA);, +    public static final EnumSet<ClusterBlockLevel> READ_WRITE = EnumSet.of(READ, WRITE);, +++ b/src/main/java/org/elasticsearch/cluster/metadata/IndexMetaData.java, +import java.util.EnumSet;, +    public static final ClusterBlock INDEX_READ_ONLY_BLOCK = new ClusterBlock(5, "index read-only (api)", false, false, RestStatus.FORBIDDEN, EnumSet.of(ClusterBlockLevel.WRITE, ClusterBlockLevel.METADATA));, +    public static final ClusterBlock INDEX_READ_BLOCK = new ClusterBlock(7, "index read (api)", false, false, RestStatus.FORBIDDEN, EnumSet.of(ClusterBlockLevel.READ));, +    public static final ClusterBlock INDEX_WRITE_BLOCK = new ClusterBlock(8, "index write (api)", false, false, RestStatus.FORBIDDEN, EnumSet.of(ClusterBlockLevel.WRITE));, +    public static final ClusterBlock INDEX_METADATA_BLOCK = new ClusterBlock(9, "index metadata (api)", false, false, RestStatus.FORBIDDEN, EnumSet.of(ClusterBlockLevel.METADATA));, +++ b/src/main/java/org/elasticsearch/cluster/metadata/MetaData.java, +    public static final ClusterBlock CLUSTER_READ_ONLY_BLOCK = new ClusterBlock(6, "cluster read-only (api)", false, false, RestStatus.FORBIDDEN, EnumSet.of(ClusterBlockLevel.WRITE, ClusterBlockLevel.METADATA));, +++ b/src/main/java/org/elasticsearch/cluster/block/ClusterBlock.java, +import java.util.ArrayList;, +import java.util.EnumSet;, +    private EnumSet<ClusterBlockLevel> levels;, +    public ClusterBlock(int id, String description, boolean retryable, boolean disableStatePersistence, RestStatus status, EnumSet<ClusterBlockLevel> levels) {, +    public EnumSet<ClusterBlockLevel> levels() {, +        final int len = in.readVInt();, +        ArrayList<ClusterBlockLevel> levels = new ArrayList<>();, +        for (int i = 0; i < len; i++) {, +            levels.add(ClusterBlockLevel.fromId(in.readVInt()));, +        this.levels = EnumSet.copyOf(levels);, +        out.writeVInt(levels.size());, +++ b/src/main/java/org/elasticsearch/cluster/block/ClusterBlockLevel.java, +import java.util.EnumSet;, +, +    public static final EnumSet<ClusterBlockLevel> ALL = EnumSet.of(READ, WRITE, METADATA);, +    public static final EnumSet<ClusterBlockLevel> READ_WRITE = EnumSet.of(READ, WRITE);, +++ b/src/main/java/org/elasticsearch/cluster/metadata/IndexMetaData.java, +import java.util.EnumSet;, +    public static final ClusterBlock INDEX_READ_ONLY_BLOCK = new ClusterBlock(5, "index read-only (api)", false, false, RestStatus.FORBIDDEN, EnumSet.of(ClusterBlockLevel.WRITE, ClusterBlockLevel.METADATA));, +    public static final ClusterBlock INDEX_READ_BLOCK = new ClusterBlock(7, "index read (api)", false, false, RestStatus.FORBIDDEN, EnumSet.of(ClusterBlockLevel.READ));, +    public static final ClusterBlock INDEX_WRITE_BLOCK = new ClusterBlock(8, "index write (api)", false, false, RestStatus.FORBIDDEN, EnumSet.of(ClusterBlockLevel.WRITE));, +    public static final ClusterBlock INDEX_METADATA_BLOCK = new ClusterBlock(9, "index metadata (api)", false, false, RestStatus.FORBIDDEN, EnumSet.of(ClusterBlockLevel.METADATA));]
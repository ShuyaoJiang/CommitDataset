[+++ b/elasticsearch/x-pack/license-plugin/src/main/java/org/elasticsearch/license/plugin/Licensing.java, +import org.elasticsearch.license.plugin.core.LicensesService;, +        LicensesService licensesService = new LicensesService(settings, clusterService, clock,, +        return Arrays.asList(licensesService, securityLicenseState, securityLicensee, watcherLicensee, monitoringLicensee, graphLicensee);, +++ b/elasticsearch/x-pack/license-plugin/src/main/java/org/elasticsearch/license/plugin/Licensing.java, +import org.elasticsearch.license.plugin.core.LicensesService;, +        LicensesService licensesService = new LicensesService(settings, clusterService, clock,, +        return Arrays.asList(licensesService, securityLicenseState, securityLicensee, watcherLicensee, monitoringLicensee, graphLicensee);, +++ b/elasticsearch/x-pack/license-plugin/src/main/java/org/elasticsearch/license/plugin/action/delete/TransportDeleteLicenseAction.java, +import org.elasticsearch.license.plugin.core.LicensesService;, +    private final LicensesService licensesService;, +                                        LicensesService licensesService, ThreadPool threadPool, ActionFilters actionFilters,, +        this.licensesService = licensesService;, +        licensesService.removeLicense(request, new ActionListener<ClusterStateUpdateResponse>() {, +++ b/elasticsearch/x-pack/license-plugin/src/main/java/org/elasticsearch/license/plugin/Licensing.java, +import org.elasticsearch.license.plugin.core.LicensesService;, +        LicensesService licensesService = new LicensesService(settings, clusterService, clock,, +        return Arrays.asList(licensesService, securityLicenseState, securityLicensee, watcherLicensee, monitoringLicensee, graphLicensee);, +++ b/elasticsearch/x-pack/license-plugin/src/main/java/org/elasticsearch/license/plugin/action/delete/TransportDeleteLicenseAction.java, +import org.elasticsearch.license.plugin.core.LicensesService;, +    private final LicensesService licensesService;, +                                        LicensesService licensesService, ThreadPool threadPool, ActionFilters actionFilters,, +        this.licensesService = licensesService;, +        licensesService.removeLicense(request, new ActionListener<ClusterStateUpdateResponse>() {, +++ b/elasticsearch/x-pack/license-plugin/src/main/java/org/elasticsearch/license/plugin/action/get/TransportGetLicenseAction.java, +import org.elasticsearch.license.plugin.core.LicensesService;, +    private final LicensesService licensesService;, +                                     LicensesService licensesService, ThreadPool threadPool, ActionFilters actionFilters,, +        this.licensesService = licensesService;, +        listener.onResponse(new GetLicenseResponse(licensesService.getLicense()));, +++ b/elasticsearch/x-pack/license-plugin/src/main/java/org/elasticsearch/license/plugin/Licensing.java, +import org.elasticsearch.license.plugin.core.LicensesService;, +        LicensesService licensesService = new LicensesService(settings, clusterService, clock,, +        return Arrays.asList(licensesService, securityLicenseState, securityLicensee, watcherLicensee, monitoringLicensee, graphLicensee);, +++ b/elasticsearch/x-pack/license-plugin/src/main/java/org/elasticsearch/license/plugin/action/delete/TransportDeleteLicenseAction.java, +import org.elasticsearch.license.plugin.core.LicensesService;, +    private final LicensesService licensesService;, +                                        LicensesService licensesService, ThreadPool threadPool, ActionFilters actionFilters,, +        this.licensesService = licensesService;, +        licensesService.removeLicense(request, new ActionListener<ClusterStateUpdateResponse>() {, +++ b/elasticsearch/x-pack/license-plugin/src/main/java/org/elasticsearch/license/plugin/action/get/TransportGetLicenseAction.java, +import org.elasticsearch.license.plugin.core.LicensesService;, +    private final LicensesService licensesService;, +                                     LicensesService licensesService, ThreadPool threadPool, ActionFilters actionFilters,, +        this.licensesService = licensesService;, +        listener.onResponse(new GetLicenseResponse(licensesService.getLicense()));, +++ b/elasticsearch/x-pack/license-plugin/src/main/java/org/elasticsearch/license/plugin/action/put/TransportPutLicenseAction.java, +import org.elasticsearch.license.plugin.core.LicensesService;, +    private final LicensesService licensesService;, +                                     LicensesService licensesService, ThreadPool threadPool, ActionFilters actionFilters,, +        this.licensesService = licensesService;, +        licensesService.registerLicense(request, listener);, +++ b/elasticsearch/x-pack/license-plugin/src/main/java/org/elasticsearch/license/plugin/Licensing.java, +import org.elasticsearch.license.plugin.core.LicensesService;, +        LicensesService licensesService = new LicensesService(settings, clusterService, clock,, +        return Arrays.asList(licensesService, securityLicenseState, securityLicensee, watcherLicensee, monitoringLicensee, graphLicensee);, +++ b/elasticsearch/x-pack/license-plugin/src/main/java/org/elasticsearch/license/plugin/action/delete/TransportDeleteLicenseAction.java, +import org.elasticsearch.license.plugin.core.LicensesService;, +    private final LicensesService licensesService;, +                                        LicensesService licensesService, ThreadPool threadPool, ActionFilters actionFilters,, +        this.licensesService = licensesService;, +        licensesService.removeLicense(request, new ActionListener<ClusterStateUpdateResponse>() {, +++ b/elasticsearch/x-pack/license-plugin/src/main/java/org/elasticsearch/license/plugin/action/get/TransportGetLicenseAction.java, +import org.elasticsearch.license.plugin.core.LicensesService;, +    private final LicensesService licensesService;, +                                     LicensesService licensesService, ThreadPool threadPool, ActionFilters actionFilters,, +        this.licensesService = licensesService;, +        listener.onResponse(new GetLicenseResponse(licensesService.getLicense()));, +++ b/elasticsearch/x-pack/license-plugin/src/main/java/org/elasticsearch/license/plugin/action/put/TransportPutLicenseAction.java, +import org.elasticsearch.license.plugin.core.LicensesService;, +    private final LicensesService licensesService;, +                                     LicensesService licensesService, ThreadPool threadPool, ActionFilters actionFilters,, +        this.licensesService = licensesService;, +        licensesService.registerLicense(request, listener);, +++ /dev/null, +++ b/elasticsearch/x-pack/license-plugin/src/main/java/org/elasticsearch/license/plugin/Licensing.java, +import org.elasticsearch.license.plugin.core.LicensesService;, +        LicensesService licensesService = new LicensesService(settings, clusterService, clock,, +        return Arrays.asList(licensesService, securityLicenseState, securityLicensee, watcherLicensee, monitoringLicensee, graphLicensee);, +++ b/elasticsearch/x-pack/license-plugin/src/main/java/org/elasticsearch/license/plugin/action/delete/TransportDeleteLicenseAction.java, +import org.elasticsearch.license.plugin.core.LicensesService;, +    private final LicensesService licensesService;, +                                        LicensesService licensesService, ThreadPool threadPool, ActionFilters actionFilters,, +        this.licensesService = licensesService;, +        licensesService.removeLicense(request, new ActionListener<ClusterStateUpdateResponse>() {, +++ b/elasticsearch/x-pack/license-plugin/src/main/java/org/elasticsearch/license/plugin/action/get/TransportGetLicenseAction.java, +import org.elasticsearch.license.plugin.core.LicensesService;, +    private final LicensesService licensesService;, +                                     LicensesService licensesService, ThreadPool threadPool, ActionFilters actionFilters,, +        this.licensesService = licensesService;, +        listener.onResponse(new GetLicenseResponse(licensesService.getLicense()));, +++ b/elasticsearch/x-pack/license-plugin/src/main/java/org/elasticsearch/license/plugin/action/put/TransportPutLicenseAction.java, +import org.elasticsearch.license.plugin.core.LicensesService;, +    private final LicensesService licensesService;, +                                     LicensesService licensesService, ThreadPool threadPool, ActionFilters actionFilters,, +        this.licensesService = licensesService;, +        licensesService.registerLicense(request, listener);, +++ /dev/null, +++ b/elasticsearch/x-pack/license-plugin/src/main/java/org/elasticsearch/license/plugin/core/LicenseState.java, +import static org.elasticsearch.license.plugin.core.LicensesService.days;]
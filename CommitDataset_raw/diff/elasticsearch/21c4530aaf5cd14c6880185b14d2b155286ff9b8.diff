[+++ b/modules/elasticsearch/src/main/java/org/elasticsearch/cluster/routing/PlainShardsIterator.java, +        return shards.get(index);, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/cluster/routing/PlainShardsIterator.java, +        return shards.get(index);, +++ b/modules/elasticsearch/src/test/java/org/elasticsearch/cluster/structure/RoutingIteratorTests.java, +        ShardRouting firstRouting = shardIterator.firstOrNull();, +        assertThat(firstRouting, sameInstance(shardRouting1));, +        ShardRouting firstRouting = shardIterator.firstOrNull();, +        assertThat(shardRouting1, sameInstance(firstRouting));, +        firstRouting = shardIterator.firstOrNull();, +        assertThat(firstRouting, sameInstance(shardRouting3));, +        firstRouting = shardIterator.firstOrNull();, +        assertThat(shardRouting5, sameInstance(firstRouting));, +        firstRouting = shardIterator.firstOrNull();, +        assertThat(shardRouting7, sameInstance(firstRouting));, +, +        shardIterator = routingTable.index("test1").shard(0).shardsIt(4);, +        assertThat(shardIterator.size(), equalTo(2));, +        firstRouting = shardIterator.firstOrNull();, +        assertThat(shardIterator.firstOrNull(), notNullValue());, +        assertThat(shardIterator.firstOrNull(), sameInstance(shardIterator.firstOrNull()));, +        ShardRouting shardRouting9 = shardIterator.nextOrNull();, +        assertThat(shardRouting9, sameInstance(firstRouting));, +        assertThat(shardRouting9, notNullValue());, +        ShardRouting shardRouting10 = shardIterator.nextOrNull();, +        assertThat(shardRouting10, notNullValue());, +        assertThat(shardRouting10, not(sameInstance(shardRouting9)));, +        assertThat(shardIterator.nextOrNull(), nullValue());, +        assertThat(shardIterator.nextOrNull(), nullValue());, +, +        assertThat(shardRouting9, sameInstance(shardRouting5));, +        assertThat(shardRouting10, sameInstance(shardRouting6));]
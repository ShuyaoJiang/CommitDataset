[+++ b/elasticsearch/qa/audit-tests/src/test/java/org/elasticsearch/xpack/security/audit/IndexAuditIT.java, +        Response response = getRestClient().performRequest("GET", "/",, +                        UsernamePasswordToken.basicAuthHeaderValue(USER, new SecuredString(PASS.toCharArray()))));, +++ b/elasticsearch/qa/audit-tests/src/test/java/org/elasticsearch/xpack/security/audit/IndexAuditIT.java, +        Response response = getRestClient().performRequest("GET", "/",, +                        UsernamePasswordToken.basicAuthHeaderValue(USER, new SecuredString(PASS.toCharArray()))));, +++ b/elasticsearch/qa/security-example-realm/src/test/java/org/elasticsearch/example/realm/CustomRealmIT.java, +        Response response = getRestClient().performRequest("GET", "/",, +                new BasicHeader(CustomRealm.PW_HEADER, CustomRealm.KNOWN_PW));, +++ b/elasticsearch/qa/audit-tests/src/test/java/org/elasticsearch/xpack/security/audit/IndexAuditIT.java, +        Response response = getRestClient().performRequest("GET", "/",, +                        UsernamePasswordToken.basicAuthHeaderValue(USER, new SecuredString(PASS.toCharArray()))));, +++ b/elasticsearch/qa/security-example-realm/src/test/java/org/elasticsearch/example/realm/CustomRealmIT.java, +        Response response = getRestClient().performRequest("GET", "/",, +                new BasicHeader(CustomRealm.PW_HEADER, CustomRealm.KNOWN_PW));, +++ b/elasticsearch/qa/smoke-test-graph-with-security/src/test/java/org/elasticsearch/smoketest/GraphWithSecurityInsufficientRoleIT.java, +    public void test() throws Exception {, +            fail("should have failed because of missing role");, +++ b/elasticsearch/qa/audit-tests/src/test/java/org/elasticsearch/xpack/security/audit/IndexAuditIT.java, +        Response response = getRestClient().performRequest("GET", "/",, +                        UsernamePasswordToken.basicAuthHeaderValue(USER, new SecuredString(PASS.toCharArray()))));, +++ b/elasticsearch/qa/security-example-realm/src/test/java/org/elasticsearch/example/realm/CustomRealmIT.java, +        Response response = getRestClient().performRequest("GET", "/",, +                new BasicHeader(CustomRealm.PW_HEADER, CustomRealm.KNOWN_PW));, +++ b/elasticsearch/qa/smoke-test-graph-with-security/src/test/java/org/elasticsearch/smoketest/GraphWithSecurityInsufficientRoleIT.java, +    public void test() throws Exception {, +            fail("should have failed because of missing role");, +++ b/elasticsearch/qa/smoke-test-monitoring-with-security/insufficient-rights/src/test/java/org/elasticsearch/smoketest/MonitoringWithSecurityInsufficientRoleIT.java, +    public void test() throws Exception {, +++ b/elasticsearch/qa/audit-tests/src/test/java/org/elasticsearch/xpack/security/audit/IndexAuditIT.java, +        Response response = getRestClient().performRequest("GET", "/",, +                        UsernamePasswordToken.basicAuthHeaderValue(USER, new SecuredString(PASS.toCharArray()))));, +++ b/elasticsearch/qa/security-example-realm/src/test/java/org/elasticsearch/example/realm/CustomRealmIT.java, +        Response response = getRestClient().performRequest("GET", "/",, +                new BasicHeader(CustomRealm.PW_HEADER, CustomRealm.KNOWN_PW));, +++ b/elasticsearch/qa/smoke-test-graph-with-security/src/test/java/org/elasticsearch/smoketest/GraphWithSecurityInsufficientRoleIT.java, +    public void test() throws Exception {, +            fail("should have failed because of missing role");, +++ b/elasticsearch/qa/smoke-test-monitoring-with-security/insufficient-rights/src/test/java/org/elasticsearch/smoketest/MonitoringWithSecurityInsufficientRoleIT.java, +    public void test() throws Exception {, +++ b/elasticsearch/qa/smoke-test-plugins-ssl/src/test/java/org/elasticsearch/smoketest/SmokeTestMonitoringWithSecurityIT.java, +    , +++ b/elasticsearch/qa/audit-tests/src/test/java/org/elasticsearch/xpack/security/audit/IndexAuditIT.java, +        Response response = getRestClient().performRequest("GET", "/",, +                        UsernamePasswordToken.basicAuthHeaderValue(USER, new SecuredString(PASS.toCharArray()))));, +++ b/elasticsearch/qa/security-example-realm/src/test/java/org/elasticsearch/example/realm/CustomRealmIT.java, +        Response response = getRestClient().performRequest("GET", "/",, +                new BasicHeader(CustomRealm.PW_HEADER, CustomRealm.KNOWN_PW));, +++ b/elasticsearch/qa/smoke-test-graph-with-security/src/test/java/org/elasticsearch/smoketest/GraphWithSecurityInsufficientRoleIT.java, +    public void test() throws Exception {, +            fail("should have failed because of missing role");, +++ b/elasticsearch/qa/smoke-test-monitoring-with-security/insufficient-rights/src/test/java/org/elasticsearch/smoketest/MonitoringWithSecurityInsufficientRoleIT.java, +    public void test() throws Exception {, +++ b/elasticsearch/qa/smoke-test-plugins-ssl/src/test/java/org/elasticsearch/smoketest/SmokeTestMonitoringWithSecurityIT.java, +    , +++ b/elasticsearch/x-pack/build.gradle, +++ b/elasticsearch/qa/audit-tests/src/test/java/org/elasticsearch/xpack/security/audit/IndexAuditIT.java, +        Response response = getRestClient().performRequest("GET", "/",, +                        UsernamePasswordToken.basicAuthHeaderValue(USER, new SecuredString(PASS.toCharArray()))));, +++ b/elasticsearch/qa/security-example-realm/src/test/java/org/elasticsearch/example/realm/CustomRealmIT.java, +        Response response = getRestClient().performRequest("GET", "/",, +                new BasicHeader(CustomRealm.PW_HEADER, CustomRealm.KNOWN_PW));, +++ b/elasticsearch/qa/smoke-test-graph-with-security/src/test/java/org/elasticsearch/smoketest/GraphWithSecurityInsufficientRoleIT.java, +    public void test() throws Exception {, +            fail("should have failed because of missing role");, +++ b/elasticsearch/qa/smoke-test-monitoring-with-security/insufficient-rights/src/test/java/org/elasticsearch/smoketest/MonitoringWithSecurityInsufficientRoleIT.java, +    public void test() throws Exception {, +++ b/elasticsearch/qa/smoke-test-plugins-ssl/src/test/java/org/elasticsearch/smoketest/SmokeTestMonitoringWithSecurityIT.java, +    , +++ b/elasticsearch/x-pack/build.gradle, +++ b/elasticsearch/x-pack/license-plugin/src/test/java/org/elasticsearch/license/plugin/LicensesServiceClusterTests.java, +import java.util.Collections;, +        return Collections.singletonList(XPackPlugin.class);, +++ b/elasticsearch/qa/audit-tests/src/test/java/org/elasticsearch/xpack/security/audit/IndexAuditIT.java, +        Response response = getRestClient().performRequest("GET", "/",, +                        UsernamePasswordToken.basicAuthHeaderValue(USER, new SecuredString(PASS.toCharArray()))));, +++ b/elasticsearch/qa/security-example-realm/src/test/java/org/elasticsearch/example/realm/CustomRealmIT.java, +        Response response = getRestClient().performRequest("GET", "/",, +                new BasicHeader(CustomRealm.PW_HEADER, CustomRealm.KNOWN_PW));, +++ b/elasticsearch/qa/smoke-test-graph-with-security/src/test/java/org/elasticsearch/smoketest/GraphWithSecurityInsufficientRoleIT.java, +    public void test() throws Exception {, +            fail("should have failed because of missing role");, +++ b/elasticsearch/qa/smoke-test-monitoring-with-security/insufficient-rights/src/test/java/org/elasticsearch/smoketest/MonitoringWithSecurityInsufficientRoleIT.java, +    public void test() throws Exception {, +++ b/elasticsearch/qa/smoke-test-plugins-ssl/src/test/java/org/elasticsearch/smoketest/SmokeTestMonitoringWithSecurityIT.java, +    , +++ b/elasticsearch/x-pack/build.gradle, +++ b/elasticsearch/x-pack/license-plugin/src/test/java/org/elasticsearch/license/plugin/LicensesServiceClusterTests.java, +import java.util.Collections;, +        return Collections.singletonList(XPackPlugin.class);, +++ b/elasticsearch/x-pack/license-plugin/src/test/java/org/elasticsearch/xpack/TribeTransportTestCase.java, +++ b/elasticsearch/qa/audit-tests/src/test/java/org/elasticsearch/xpack/security/audit/IndexAuditIT.java, +        Response response = getRestClient().performRequest("GET", "/",, +                        UsernamePasswordToken.basicAuthHeaderValue(USER, new SecuredString(PASS.toCharArray()))));, +++ b/elasticsearch/qa/security-example-realm/src/test/java/org/elasticsearch/example/realm/CustomRealmIT.java, +        Response response = getRestClient().performRequest("GET", "/",, +                new BasicHeader(CustomRealm.PW_HEADER, CustomRealm.KNOWN_PW));, +++ b/elasticsearch/qa/smoke-test-graph-with-security/src/test/java/org/elasticsearch/smoketest/GraphWithSecurityInsufficientRoleIT.java, +    public void test() throws Exception {, +            fail("should have failed because of missing role");]
[+++ b/src/main/java/org/elasticsearch/action/admin/cluster/reroute/TransportClusterRerouteAction.java, +                RoutingAllocation.Result routingResult = allocationService.reroute(currentState, request.commands, true);, +++ b/src/main/java/org/elasticsearch/action/admin/cluster/reroute/TransportClusterRerouteAction.java, +                RoutingAllocation.Result routingResult = allocationService.reroute(currentState, request.commands, true);, +++ b/src/main/java/org/elasticsearch/cluster/node/DiscoveryNodeFilters.java, +, +    /**, +     * Generates a human-readable string for the DiscoverNodeFilters., +     * Example: {@code _id:"id1 OR blah",name:"blah OR name2"}, +     */, +    @Override, +    public String toString() {, +        StringBuilder sb = new StringBuilder();, +        int entryCount = filters.size();, +        for (Map.Entry<String, String[]> entry : filters.entrySet()) {, +            String attr = entry.getKey();, +            String[] values = entry.getValue();, +            sb.append(attr);, +            sb.append(":\"");, +            int valueCount = values.length;, +            for (String value : values) {, +                sb.append(value);, +                if (valueCount > 1) {, +                    sb.append(" " + opType.toString() + " ");, +                }, +                valueCount--;, +            }, +            sb.append("\"");, +            if (entryCount > 1) {, +                sb.append(",");, +            }, +            entryCount--;, +        }, +        return sb.toString();, +    }, +++ b/src/main/java/org/elasticsearch/action/admin/cluster/reroute/TransportClusterRerouteAction.java, +                RoutingAllocation.Result routingResult = allocationService.reroute(currentState, request.commands, true);, +++ b/src/main/java/org/elasticsearch/cluster/node/DiscoveryNodeFilters.java, +, +    /**, +     * Generates a human-readable string for the DiscoverNodeFilters., +     * Example: {@code _id:"id1 OR blah",name:"blah OR name2"}, +     */, +    @Override, +    public String toString() {, +        StringBuilder sb = new StringBuilder();, +        int entryCount = filters.size();, +        for (Map.Entry<String, String[]> entry : filters.entrySet()) {, +            String attr = entry.getKey();, +            String[] values = entry.getValue();, +            sb.append(attr);, +            sb.append(":\"");, +            int valueCount = values.length;, +            for (String value : values) {, +                sb.append(value);, +                if (valueCount > 1) {, +                    sb.append(" " + opType.toString() + " ");, +                }, +                valueCount--;, +            }, +            sb.append("\"");, +            if (entryCount > 1) {, +                sb.append(",");, +            }, +            entryCount--;, +        }, +        return sb.toString();, +    }, +++ b/src/main/java/org/elasticsearch/cluster/routing/allocation/AllocationService.java, +    public RoutingAllocation.Result reroute(ClusterState clusterState, AllocationCommands commands) {, +        return reroute(clusterState, commands, false);, +    }, +, +    public RoutingAllocation.Result reroute(ClusterState clusterState, AllocationCommands commands, boolean debug) throws ElasticsearchException {, +        allocation.debugDecision(debug);, +        return reroute(clusterState, false);, +    }, +, +    /**, +     * Reroutes the routing table based on the live nodes., +     * <p/>, +     * <p>If the same instance of the routing table is returned, then no change has been made., +     */, +    public RoutingAllocation.Result reroute(ClusterState clusterState, boolean debug) {, +        allocation.debugDecision(debug);, +        return rerouteWithNoReassign(clusterState, false);, +    }, +, +    /**, +     * Only handles reroute but *without* any reassignment of unassigned shards or rebalancing. Does, +     * make sure to handle removed nodes, but only moved the shards to UNASSIGNED, does not reassign, +     * them., +     */, +    public RoutingAllocation.Result rerouteWithNoReassign(ClusterState clusterState, boolean debug) {, +        allocation.debugDecision(debug);, +++ b/src/main/java/org/elasticsearch/action/admin/cluster/reroute/TransportClusterRerouteAction.java, +                RoutingAllocation.Result routingResult = allocationService.reroute(currentState, request.commands, true);, +++ b/src/main/java/org/elasticsearch/cluster/node/DiscoveryNodeFilters.java, +, +    /**]
[+++ b/modules/parent-join/src/test/java/org/elasticsearch/join/mapper/ParentJoinFieldMapperTests.java, +            assertThat(exc.getMessage(), containsString("Field [_parent_join] is defined twice."));, +            assertThat(exc.getMessage(), containsString("Field [_parent_join] is defined twice."));, +++ b/modules/parent-join/src/test/java/org/elasticsearch/join/mapper/ParentJoinFieldMapperTests.java, +            assertThat(exc.getMessage(), containsString("Field [_parent_join] is defined twice."));, +            assertThat(exc.getMessage(), containsString("Field [_parent_join] is defined twice."));, +++ b/server/src/main/java/org/elasticsearch/index/mapper/MapperMergeValidator.java, +    public static void validateMapperStructure(Collection<ObjectMapper> objectMappers,, +                                               Collection<FieldAliasMapper> fieldAliasMappers) {, +                throw new IllegalArgumentException("Object mapper [" + fullPath + "] is defined twice.");, +                    throw new IllegalArgumentException("Field [" + name + "] is defined both as an object and a field.");, +                    throw new IllegalArgumentException("Field [" + name + "] is defined twice.");, +++ b/modules/parent-join/src/test/java/org/elasticsearch/join/mapper/ParentJoinFieldMapperTests.java, +            assertThat(exc.getMessage(), containsString("Field [_parent_join] is defined twice."));, +            assertThat(exc.getMessage(), containsString("Field [_parent_join] is defined twice."));, +++ b/server/src/main/java/org/elasticsearch/index/mapper/MapperMergeValidator.java, +    public static void validateMapperStructure(Collection<ObjectMapper> objectMappers,, +                                               Collection<FieldAliasMapper> fieldAliasMappers) {, +                throw new IllegalArgumentException("Object mapper [" + fullPath + "] is defined twice.");, +                    throw new IllegalArgumentException("Field [" + name + "] is defined both as an object and a field.");, +                    throw new IllegalArgumentException("Field [" + name + "] is defined twice.");, +++ b/server/src/main/java/org/elasticsearch/index/mapper/MapperService.java, +            MapperMergeValidator.validateMapperStructure(objectMappers, fieldMappers, fieldAliasMappers);, +++ b/modules/parent-join/src/test/java/org/elasticsearch/join/mapper/ParentJoinFieldMapperTests.java, +            assertThat(exc.getMessage(), containsString("Field [_parent_join] is defined twice."));, +            assertThat(exc.getMessage(), containsString("Field [_parent_join] is defined twice."));, +++ b/server/src/main/java/org/elasticsearch/index/mapper/MapperMergeValidator.java, +    public static void validateMapperStructure(Collection<ObjectMapper> objectMappers,, +                                               Collection<FieldAliasMapper> fieldAliasMappers) {, +                throw new IllegalArgumentException("Object mapper [" + fullPath + "] is defined twice.");, +                    throw new IllegalArgumentException("Field [" + name + "] is defined both as an object and a field.");, +                    throw new IllegalArgumentException("Field [" + name + "] is defined twice.");, +++ b/server/src/main/java/org/elasticsearch/index/mapper/MapperService.java, +            MapperMergeValidator.validateMapperStructure(objectMappers, fieldMappers, fieldAliasMappers);, +++ b/server/src/test/java/org/elasticsearch/index/mapper/MapperMergeValidatorTests.java, +            MapperMergeValidator.validateMapperStructure(, +                singletonList(aliasMapper)));, +        assertEquals("Field [some.path] is defined both as an object and a field.", e.getMessage());, +++ b/modules/parent-join/src/test/java/org/elasticsearch/join/mapper/ParentJoinFieldMapperTests.java, +            assertThat(exc.getMessage(), containsString("Field [_parent_join] is defined twice."));, +            assertThat(exc.getMessage(), containsString("Field [_parent_join] is defined twice."));, +++ b/server/src/main/java/org/elasticsearch/index/mapper/MapperMergeValidator.java, +    public static void validateMapperStructure(Collection<ObjectMapper> objectMappers,, +                                               Collection<FieldAliasMapper> fieldAliasMappers) {, +                throw new IllegalArgumentException("Object mapper [" + fullPath + "] is defined twice.");, +                    throw new IllegalArgumentException("Field [" + name + "] is defined both as an object and a field.");, +                    throw new IllegalArgumentException("Field [" + name + "] is defined twice.");, +++ b/server/src/main/java/org/elasticsearch/index/mapper/MapperService.java, +            MapperMergeValidator.validateMapperStructure(objectMappers, fieldMappers, fieldAliasMappers);, +++ b/server/src/test/java/org/elasticsearch/index/mapper/MapperMergeValidatorTests.java, +            MapperMergeValidator.validateMapperStructure(, +                singletonList(aliasMapper)));, +        assertEquals("Field [some.path] is defined both as an object and a field.", e.getMessage());, +++ b/server/src/test/java/org/elasticsearch/index/mapper/TextFieldMapperTests.java, +            assertThat(e.getMessage(), containsString("Field [field._index_prefix] is defined twice."));, +++ b/modules/parent-join/src/test/java/org/elasticsearch/join/mapper/ParentJoinFieldMapperTests.java, +            assertThat(exc.getMessage(), containsString("Field [_parent_join] is defined twice."));, +            assertThat(exc.getMessage(), containsString("Field [_parent_join] is defined twice."));, +++ b/server/src/main/java/org/elasticsearch/index/mapper/MapperMergeValidator.java, +    public static void validateMapperStructure(Collection<ObjectMapper> objectMappers,, +                                               Collection<FieldAliasMapper> fieldAliasMappers) {, +                throw new IllegalArgumentException("Object mapper [" + fullPath + "] is defined twice.");, +                    throw new IllegalArgumentException("Field [" + name + "] is defined both as an object and a field.");, +                    throw new IllegalArgumentException("Field [" + name + "] is defined twice.");, +++ b/server/src/main/java/org/elasticsearch/index/mapper/MapperService.java, +            MapperMergeValidator.validateMapperStructure(objectMappers, fieldMappers, fieldAliasMappers);, +++ b/server/src/test/java/org/elasticsearch/index/mapper/MapperMergeValidatorTests.java, +            MapperMergeValidator.validateMapperStructure(, +                singletonList(aliasMapper)));, +        assertEquals("Field [some.path] is defined both as an object and a field.", e.getMessage());, +++ b/server/src/test/java/org/elasticsearch/index/mapper/TextFieldMapperTests.java, +            assertThat(e.getMessage(), containsString("Field [field._index_prefix] is defined twice."));, +++ b/server/src/test/java/org/elasticsearch/index/mapper/UpdateMappingTests.java, +            assertTrue(e.getMessage().contains("Field [_id] is defined twice."));, +            assertTrue(e.getMessage().contains("Field [_id] is defined twice."));]
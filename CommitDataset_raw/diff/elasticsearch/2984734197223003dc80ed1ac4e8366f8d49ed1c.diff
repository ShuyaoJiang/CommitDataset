[+++ b/server/src/main/java/org/elasticsearch/action/search/TransportSearchAction.java, +            /*, +             * We try to set a default of max concurrent shard requests based on the node count but upper-bound it by 256 by default to keep, +             * it sane. A single search request that fans out to lots of shards should not hit a cluster too hard while 256 is already a, +             * lot., +             */, +            searchRequest.setMaxConcurrentShardRequests(Math.min(256, nodeCount));, +++ b/server/src/main/java/org/elasticsearch/action/search/TransportSearchAction.java, +            /*, +             * We try to set a default of max concurrent shard requests based on the node count but upper-bound it by 256 by default to keep, +             * it sane. A single search request that fans out to lots of shards should not hit a cluster too hard while 256 is already a, +             * lot., +             */, +            searchRequest.setMaxConcurrentShardRequests(Math.min(256, nodeCount));, +++ b/server/src/main/java/org/elasticsearch/cluster/metadata/IndexMetaData.java, +        return Setting.intSetting(SETTING_NUMBER_OF_SHARDS, 1, 1, maxNumShards, Property.IndexScope, Property.Final);]
[+++ b/core/src/main/java/org/elasticsearch/client/transport/TransportClient.java, +import org.elasticsearch.node.Node;, +                .put(Node.NODE_CLIENT_SETTING.getKey(), true), +++ b/core/src/main/java/org/elasticsearch/client/transport/TransportClient.java, +import org.elasticsearch.node.Node;, +                .put(Node.NODE_CLIENT_SETTING.getKey(), true), +++ b/core/src/main/java/org/elasticsearch/cluster/node/DiscoveryNode.java, +        if (Node.NODE_LOCAL_SETTING.exists(settings)) {, +            return Node.NODE_LOCAL_SETTING.get(settings);, +        if (Node.NODE_MODE_SETTING.exists(settings)) {, +            String nodeMode = Node.NODE_MODE_SETTING.get(settings);, +        return (Node.NODE_CLIENT_SETTING.get(settings) || (Node.NODE_DATA_SETTING.get(settings) == false && Node.NODE_MASTER_SETTING.get(settings) == false)) == false;, +        return Node.NODE_CLIENT_SETTING.get(settings);, +        if (Node.NODE_MASTER_SETTING.exists(settings)) {, +            return Node.NODE_MASTER_SETTING.get(settings);, +        return clientNode(settings) == false;, +        if (Node.NODE_DATA_SETTING.exists(settings)) {, +            return Node.NODE_DATA_SETTING.get(settings);, +        return clientNode(settings) == false;, +++ b/core/src/main/java/org/elasticsearch/client/transport/TransportClient.java, +import org.elasticsearch.node.Node;, +                .put(Node.NODE_CLIENT_SETTING.getKey(), true), +++ b/core/src/main/java/org/elasticsearch/cluster/node/DiscoveryNode.java, +        if (Node.NODE_LOCAL_SETTING.exists(settings)) {, +            return Node.NODE_LOCAL_SETTING.get(settings);, +        if (Node.NODE_MODE_SETTING.exists(settings)) {, +            String nodeMode = Node.NODE_MODE_SETTING.get(settings);, +        return (Node.NODE_CLIENT_SETTING.get(settings) || (Node.NODE_DATA_SETTING.get(settings) == false && Node.NODE_MASTER_SETTING.get(settings) == false)) == false;, +        return Node.NODE_CLIENT_SETTING.get(settings);, +        if (Node.NODE_MASTER_SETTING.exists(settings)) {, +            return Node.NODE_MASTER_SETTING.get(settings);, +        return clientNode(settings) == false;, +        if (Node.NODE_DATA_SETTING.exists(settings)) {, +            return Node.NODE_DATA_SETTING.get(settings);, +        return clientNode(settings) == false;, +++ b/core/src/main/java/org/elasticsearch/common/settings/ClusterSettings.java, +        Node.NODE_CLIENT_SETTING,, +        Node.NODE_DATA_SETTING,, +        Node.NODE_MASTER_SETTING,, +        Node.NODE_LOCAL_SETTING,, +        Node.NODE_MODE_SETTING,, +        Node.NODE_INGEST_SETTING,, +        URLRepository.SUPPORTED_PROTOCOLS_SETTING)));, +++ b/core/src/main/java/org/elasticsearch/client/transport/TransportClient.java, +import org.elasticsearch.node.Node;, +                .put(Node.NODE_CLIENT_SETTING.getKey(), true), +++ b/core/src/main/java/org/elasticsearch/cluster/node/DiscoveryNode.java, +        if (Node.NODE_LOCAL_SETTING.exists(settings)) {, +            return Node.NODE_LOCAL_SETTING.get(settings);, +        if (Node.NODE_MODE_SETTING.exists(settings)) {, +            String nodeMode = Node.NODE_MODE_SETTING.get(settings);, +        return (Node.NODE_CLIENT_SETTING.get(settings) || (Node.NODE_DATA_SETTING.get(settings) == false && Node.NODE_MASTER_SETTING.get(settings) == false)) == false;, +        return Node.NODE_CLIENT_SETTING.get(settings);, +        if (Node.NODE_MASTER_SETTING.exists(settings)) {, +            return Node.NODE_MASTER_SETTING.get(settings);, +        return clientNode(settings) == false;, +        if (Node.NODE_DATA_SETTING.exists(settings)) {, +            return Node.NODE_DATA_SETTING.get(settings);, +        return clientNode(settings) == false;, +++ b/core/src/main/java/org/elasticsearch/common/settings/ClusterSettings.java, +        Node.NODE_CLIENT_SETTING,, +        Node.NODE_DATA_SETTING,, +        Node.NODE_MASTER_SETTING,, +        Node.NODE_LOCAL_SETTING,, +        Node.NODE_MODE_SETTING,, +        Node.NODE_INGEST_SETTING,, +        URLRepository.SUPPORTED_PROTOCOLS_SETTING)));, +++ b/core/src/main/java/org/elasticsearch/node/Node.java, +import java.util.function.Function;, +    public static final Setting<Boolean> NODE_CLIENT_SETTING = Setting.boolSetting("node.client", false, false, Setting.Scope.CLUSTER);, +    public static final Setting<Boolean> NODE_DATA_SETTING = Setting.boolSetting("node.data", true, false, Setting.Scope.CLUSTER);, +    public static final Setting<Boolean> NODE_MASTER_SETTING = Setting.boolSetting("node.master", true, false, Setting.Scope.CLUSTER);, +    public static final Setting<Boolean> NODE_LOCAL_SETTING = Setting.boolSetting("node.local", false, false, Setting.Scope.CLUSTER);, +    public static final Setting<String> NODE_MODE_SETTING = new Setting<>("node.mode", "network", Function.identity(), false, Setting.Scope.CLUSTER);, +    public static final Setting<Boolean> NODE_INGEST_SETTING = Setting.boolSetting("node.ingest", true, false, Setting.Scope.CLUSTER);, +, +    private static final String CLIENT_TYPE = "node";, +++ b/core/src/main/java/org/elasticsearch/client/transport/TransportClient.java, +import org.elasticsearch.node.Node;, +                .put(Node.NODE_CLIENT_SETTING.getKey(), true), +++ b/core/src/main/java/org/elasticsearch/cluster/node/DiscoveryNode.java, +        if (Node.NODE_LOCAL_SETTING.exists(settings)) {, +            return Node.NODE_LOCAL_SETTING.get(settings);, +        if (Node.NODE_MODE_SETTING.exists(settings)) {, +            String nodeMode = Node.NODE_MODE_SETTING.get(settings);, +        return (Node.NODE_CLIENT_SETTING.get(settings) || (Node.NODE_DATA_SETTING.get(settings) == false && Node.NODE_MASTER_SETTING.get(settings) == false)) == false;, +        return Node.NODE_CLIENT_SETTING.get(settings);, +        if (Node.NODE_MASTER_SETTING.exists(settings)) {, +            return Node.NODE_MASTER_SETTING.get(settings);, +        return clientNode(settings) == false;, +        if (Node.NODE_DATA_SETTING.exists(settings)) {, +            return Node.NODE_DATA_SETTING.get(settings);, +        return clientNode(settings) == false;, +++ b/core/src/main/java/org/elasticsearch/common/settings/ClusterSettings.java, +        Node.NODE_CLIENT_SETTING,, +        Node.NODE_DATA_SETTING,, +        Node.NODE_MASTER_SETTING,, +        Node.NODE_LOCAL_SETTING,, +        Node.NODE_MODE_SETTING,, +        Node.NODE_INGEST_SETTING,]
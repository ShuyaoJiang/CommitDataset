[+++ b/qa/rolling-upgrade/src/test/java/org/elasticsearch/upgrades/RecoveryIT.java, +import static org.elasticsearch.cluster.routing.UnassignedInfo.INDEX_DELAYED_NODE_LEFT_TIMEOUT_SETTING;, +                .put(IndexMetaData.INDEX_NUMBER_OF_REPLICAS_SETTING.getKey(), 1), +                // if the node with the replica is the first to be restarted, while a replica is still recovering, +                // then delayed allocation will kick in. When the node comes back, the master will search for a copy, +                // but the recovering copy will be seen as invalid and the cluster health won't return to GREEN, +                // before timing out, +                .put(INDEX_DELAYED_NODE_LEFT_TIMEOUT_SETTING.getKey(), "100ms");]
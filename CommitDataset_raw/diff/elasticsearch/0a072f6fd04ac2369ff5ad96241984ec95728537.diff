[+++ b/src/main/java/org/elasticsearch/index/engine/internal/InternalEngine.java, +                        { // commit and close the current writer - we write the current tanslog ID just in case, +                            final long translogId = translog.currentId();, +                            indexWriter.setCommitData(MapBuilder.<String, String>newMapBuilder().put(Translog.TRANSLOG_ID_KEY, Long.toString(translogId)).map());, +                            indexWriter.commit();, +                            indexWriter.rollback();, +                        }]
[+++ b/modules/lang-painless/src/test/java/org/elasticsearch/painless/StandardCastTests.java, +        expectScriptThrows(ClassCastException.class, () -> exec("byte o = 0; ArrayList b = o;"));, +        expectScriptThrows(ClassCastException.class, () -> exec("byte o = 0; ArrayList b = (ArrayList)o;"));, +        expectScriptThrows(ClassCastException.class, () -> exec("short o = 0; ArrayList b = o;"));, +        expectScriptThrows(ClassCastException.class, () -> exec("short o = 0; ArrayList b = (ArrayList)o;"));, +        expectScriptThrows(ClassCastException.class, () -> exec("Short o = Short.valueOf((short)0); String n = (String)o;"));, +        expectScriptThrows(ClassCastException.class, () -> exec("char o = 0; ArrayList b = o;"));, +        expectScriptThrows(ClassCastException.class, () -> exec("char o = 0; ArrayList b = (ArrayList)o;"));, +        expectScriptThrows(ClassCastException.class, () -> exec("Character o = Character.valueOf((char)0); String n = (String)o;"));, +        expectScriptThrows(ClassCastException.class, () -> exec("int o = 0; ArrayList b = o;"));, +        expectScriptThrows(ClassCastException.class, () -> exec("int o = 0; ArrayList b = (ArrayList)o;"));, +        expectScriptThrows(ClassCastException.class, () -> exec("Integer o = Integer.valueOf((int)0); String n = (String)o;"));, +, +    public void testPrimitiveLongCasts() {, +        expectScriptThrows(ClassCastException.class, () -> exec("long o = 0; Object n = o;"));, +        expectScriptThrows(ClassCastException.class, () -> exec("long o = 0; Object n = (Object)o;"));, +, +        expectScriptThrows(ClassCastException.class, () -> exec("long o = 0; Number n = o;"));, +        expectScriptThrows(ClassCastException.class, () -> exec("long o = 0; Number n = (Number)o;"));, +, +        expectScriptThrows(ClassCastException.class, () -> exec("long o = 0; String n = o;"));, +        expectScriptThrows(ClassCastException.class, () -> exec("long o = 0; String n = (String)o;"));, +, +        expectScriptThrows(ClassCastException.class, () -> exec("long o = 0; boolean b = o;"));, +        expectScriptThrows(ClassCastException.class, () -> exec("long o = 0; boolean b = (boolean)o;"));, +, +        expectScriptThrows(ClassCastException.class, () -> exec("long o = 0; byte b = o;"));, +        exec("long o = 0; byte b = (byte)o;");, +, +        expectScriptThrows(ClassCastException.class, () -> exec("long o = 0; short b = o;"));, +        exec("long o = 0; short b = (short)o;");, +, +        expectScriptThrows(ClassCastException.class, () -> exec("long o = 0; char b = o;"));, +        exec("long o = 0; char b = (char)o;");, +, +        expectScriptThrows(ClassCastException.class, () -> exec("long o = 0; int b = o;"));, +        exec("long o = 0; int b = (int)o;");, +, +        exec("long o = 0; long b = o;");, +        exec("long o = 0; long b = (long)o;");, +, +        exec("long o = 0; float b = o;");, +        exec("long o = 0; float b = (float)o;");, +, +        exec("long o = 0; double b = o;");, +        exec("long o = 0; double b = (double)o;");, +, +        expectScriptThrows(ClassCastException.class, () -> exec("long o = 0; Boolean b = o;"));, +        expectScriptThrows(ClassCastException.class, () -> exec("long o = 0; Boolean b = (Boolean)o;"));, +, +        expectScriptThrows(ClassCastException.class, () -> exec("long o = 0; Byte b = o;"));, +        expectScriptThrows(ClassCastException.class, () -> exec("long o = 0; Byte b = (Byte)o;"));, +, +        expectScriptThrows(ClassCastException.class, () -> exec("long o = 0; Short b = o;"));, +        expectScriptThrows(ClassCastException.class, () -> exec("long o = 0; Short b = (Short)o;"));, +, +        expectScriptThrows(ClassCastException.class, () -> exec("long o = 0; Character b = o;"));, +        expectScriptThrows(ClassCastException.class, () -> exec("long o = 0; Character b = (Character)o;"));, +, +        expectScriptThrows(ClassCastException.class, () -> exec("long o = 0; Integer b = o;"));, +        expectScriptThrows(ClassCastException.class, () -> exec("long o = 0; Integer b = (Integer)o;"));, +, +        expectScriptThrows(ClassCastException.class, () -> exec("long o = 0; Long b = o;"));, +        expectScriptThrows(ClassCastException.class, () -> exec("long o = 0; Long b = (Long)o;"));, +, +        expectScriptThrows(ClassCastException.class, () -> exec("long o = 0; Float b = o;"));, +        expectScriptThrows(ClassCastException.class, () -> exec("long o = 0; Float b = (Float)o;"));, +, +        expectScriptThrows(ClassCastException.class, () -> exec("long o = 0; Double b = o;"));, +        expectScriptThrows(ClassCastException.class, () -> exec("long o = 0; Double b = (Double)o;"));, +, +        expectScriptThrows(ClassCastException.class, () -> exec("long o = (long)0; ArrayList b = o;"));, +        expectScriptThrows(ClassCastException.class, () -> exec("long o = (long)0; ArrayList b = (ArrayList)o;"));, +    }, +, +    public void testLongCasts() {, +        exec("Long o = Long.valueOf((long)0); Object n = o;");, +        exec("Long o = null; Object n = o;");, +        exec("Long o = Long.valueOf((long)0); Object n = (Object)o;");, +        exec("Long o = null; Object n = (Object)o;");, +, +        exec("Long o = Long.valueOf((long)0); Number n = o;");, +        exec("Long o = null; Number n = o;");, +        exec("Long o = Long.valueOf((long)0); Number n = (Number)o;");, +        exec("Long o = null; Number n = (Number)o;");, +, +        expectScriptThrows(ClassCastException.class, () -> exec("Long o = Long.valueOf((long)0); String n = o;"));, +        expectScriptThrows(ClassCastException.class, () -> exec("Long o = null; String n = o;"));, +        expectScriptThrows(ClassCastException.class, () -> exec("Long o = Long.valueOf((long)0); String n = (String)o;"));, +        expectScriptThrows(ClassCastException.class, () -> exec("Long o = null; String n = (String)o;"));, +, +        expectScriptThrows(ClassCastException.class, () -> exec("Long o = Long.valueOf((long)0); boolean b = o;"));, +        expectScriptThrows(ClassCastException.class, () -> exec("Long o = null; boolean b = o;"));, +        expectScriptThrows(ClassCastException.class, () -> exec("Long o = Long.valueOf((long)0); boolean b = (boolean)o;"));, +        expectScriptThrows(ClassCastException.class, () -> exec("Long o = null; boolean b = (boolean)o;"));, +, +        expectScriptThrows(ClassCastException.class, () -> exec("Long o = Long.valueOf((long)0); byte b = o;"));, +        expectScriptThrows(ClassCastException.class, () -> exec("Long o = null; byte b = o;"));, +        expectScriptThrows(ClassCastException.class, () -> exec("Long o = Long.valueOf((long)0); byte b = (byte)o;"));, +        expectScriptThrows(ClassCastException.class, () -> exec("Long o = null; byte b = (byte)o;"));]
[+++ b/x-pack/plugin/sql/src/main/java/org/elasticsearch/xpack/sql/expression/function/scalar/Cast.java, +, +    @Override, +    public String name() {, +        StringBuilder sb = new StringBuilder(super.name());, +        sb.insert(sb.length() - 1, " AS " + to().sqlName());, +        return sb.toString();, +    }, +++ b/x-pack/plugin/sql/src/main/java/org/elasticsearch/xpack/sql/expression/function/scalar/Cast.java, +, +    @Override, +    public String name() {, +        StringBuilder sb = new StringBuilder(super.name());, +        sb.insert(sb.length() - 1, " AS " + to().sqlName());, +        return sb.toString();, +    }, +++ b/x-pack/qa/sql/src/main/resources/agg.csv-spec, +aggregateWithCastPruned, +SELECT CAST(SUM(salary) AS INTEGER) FROM test_emp;, +, +  SUM(salary), +-------------, +4824855, +;, +, +aggregateWithUpCast, +SELECT CAST(SUM(salary) AS DOUBLE) FROM test_emp;, +, +  CAST(SUM(salary) AS DOUBLE), +-----------------------------, +4824855.0, +;, +, +aggregateWithCastNumericToString, +SELECT CAST(AVG(salary) AS VARCHAR) FROM test_emp;, +, +  CAST(AVG(salary) AS VARCHAR):s, +--------------------------------, +48248.55, +;, +, +++ b/x-pack/plugin/sql/src/main/java/org/elasticsearch/xpack/sql/expression/function/scalar/Cast.java, +, +    @Override, +    public String name() {, +        StringBuilder sb = new StringBuilder(super.name());, +        sb.insert(sb.length() - 1, " AS " + to().sqlName());, +        return sb.toString();, +    }, +++ b/x-pack/qa/sql/src/main/resources/agg.csv-spec, +aggregateWithCastPruned, +SELECT CAST(SUM(salary) AS INTEGER) FROM test_emp;, +, +  SUM(salary), +-------------, +4824855, +;, +, +aggregateWithUpCast, +SELECT CAST(SUM(salary) AS DOUBLE) FROM test_emp;, +, +  CAST(SUM(salary) AS DOUBLE), +-----------------------------, +4824855.0, +;, +, +aggregateWithCastNumericToString, +SELECT CAST(AVG(salary) AS VARCHAR) FROM test_emp;, +, +  CAST(AVG(salary) AS VARCHAR):s, +--------------------------------, +48248.55, +;, +, +++ b/x-pack/qa/sql/src/main/resources/agg.sql-spec, +aggCountImplicitWithUpCast, +SELECT CAST(COUNT(*) AS DOUBLE) c FROM "test_emp";, +aggCountImplicitWithPrunedCast, +SELECT CAST(COUNT(*) AS BIGINT) c FROM "test_emp";, +aggMinImplicitWithUpCast, +SELECT CAST(MIN(emp_no) AS DOUBLE) m FROM "test_emp";, +aggMinImplicitWithPrunedCast, +SELECT CAST(MIN(emp_no) AS INTEGER) m FROM "test_emp";, +aggMaxImplicitWithUpCast, +SELECT CAST(MAX(emp_no) AS DOUBLE) c FROM "test_emp";, +aggMaxImplicitWithPrunedCast, +SELECT CAST(MAX(emp_no) AS INTEGER) c FROM "test_emp";, +aggSumImplicitWithUpCast, +SELECT CAST(SUM(emp_no) AS DOUBLE) s FROM "test_emp";, +aggSumImplicitWithUpCast, +SELECT CAST(SUM(emp_no) AS INTEGER) s FROM "test_emp";, +aggAvgImplicitWithUpCast, +SELECT CAST(AVG(emp_no) AS DOUBLE) a FROM "test_emp";]
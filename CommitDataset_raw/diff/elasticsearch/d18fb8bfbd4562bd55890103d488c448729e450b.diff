[+++ b/config/elasticsearch.yml, +, +################################## Security ################################, +, +# Uncomment if you want to disable JSONP as a valid return transport on the, +# http server. With this enabled, it may pose a security risk, so disabling, +# it unless you need it is recommended., +#, +#http.jsonp.enable: false, +++ b/config/elasticsearch.yml, +, +################################## Security ################################, +, +# Uncomment if you want to disable JSONP as a valid return transport on the, +# http server. With this enabled, it may pose a security risk, so disabling, +# it unless you need it is recommended., +#, +#http.jsonp.enable: false, +++ b/docs/reference/api-conventions.asciidoc, +By default JSONP resposes are enabled. All REST APIs accept a `callback` parameter, +resulting in a http://en.wikipedia.org/wiki/JSONP[JSONP] result. You can disable, +this behavior by adding the following to `config.yaml`:, +, +    http.jsonp.enable: false, +, +Please note, due to the architecture of Elasticsearch, this may pose a security, +risk. Under some circumstances, an attacker may be able to exfiltrate data in your, +Elasticsearch server if they're able to force your browser to make a JSONP request, +on your behalf (e.g. by including a <script> tag on an untrusted site with a, +legitimate query against a local Elasticsearch server)., +++ b/config/elasticsearch.yml, +, +################################## Security ################################, +, +# Uncomment if you want to disable JSONP as a valid return transport on the, +# http server. With this enabled, it may pose a security risk, so disabling, +# it unless you need it is recommended., +#, +#http.jsonp.enable: false, +++ b/docs/reference/api-conventions.asciidoc, +By default JSONP resposes are enabled. All REST APIs accept a `callback` parameter, +resulting in a http://en.wikipedia.org/wiki/JSONP[JSONP] result. You can disable, +this behavior by adding the following to `config.yaml`:, +, +    http.jsonp.enable: false, +, +Please note, due to the architecture of Elasticsearch, this may pose a security, +risk. Under some circumstances, an attacker may be able to exfiltrate data in your, +Elasticsearch server if they're able to force your browser to make a JSONP request, +on your behalf (e.g. by including a <script> tag on an untrusted site with a, +legitimate query against a local Elasticsearch server)., +++ b/src/main/java/org/elasticsearch/http/netty/NettyHttpChannel.java, +                // Add content-type header of "application/javascript", +                resp.headers().add(HttpHeaders.Names.CONTENT_TYPE, "application/javascript");, +, +            // If our response doesn't specify a content-type header, set one, +            if (!resp.headers().contains(HttpHeaders.Names.CONTENT_TYPE)) {, +            }, +, +            // If our response has no content-length, calculate and set one, +            if (!resp.headers().contains(HttpHeaders.Names.CONTENT_LENGTH)) {, +            }, +++ b/config/elasticsearch.yml, +, +################################## Security ################################, +, +# Uncomment if you want to disable JSONP as a valid return transport on the, +# http server. With this enabled, it may pose a security risk, so disabling, +# it unless you need it is recommended., +#, +#http.jsonp.enable: false, +++ b/docs/reference/api-conventions.asciidoc, +By default JSONP resposes are enabled. All REST APIs accept a `callback` parameter, +resulting in a http://en.wikipedia.org/wiki/JSONP[JSONP] result. You can disable, +this behavior by adding the following to `config.yaml`:, +, +    http.jsonp.enable: false, +, +Please note, due to the architecture of Elasticsearch, this may pose a security, +risk. Under some circumstances, an attacker may be able to exfiltrate data in your, +Elasticsearch server if they're able to force your browser to make a JSONP request, +on your behalf (e.g. by including a <script> tag on an untrusted site with a, +legitimate query against a local Elasticsearch server)., +++ b/src/main/java/org/elasticsearch/http/netty/NettyHttpChannel.java, +                // Add content-type header of "application/javascript", +                resp.headers().add(HttpHeaders.Names.CONTENT_TYPE, "application/javascript");, +, +            // If our response doesn't specify a content-type header, set one, +            if (!resp.headers().contains(HttpHeaders.Names.CONTENT_TYPE)) {, +            }, +, +            // If our response has no content-length, calculate and set one, +            if (!resp.headers().contains(HttpHeaders.Names.CONTENT_LENGTH)) {, +            }, +++ b/src/main/java/org/elasticsearch/rest/RestController.java, +import org.elasticsearch.common.xcontent.XContentBuilder;, +import static org.elasticsearch.rest.RestStatus.FORBIDDEN;, +        // If JSONP is disabled and someone sends a callback parameter we should bail out before querying, +        if (!settings.getAsBoolean("http.jsonp.enable", true) && request.hasParam("callback")){, +            try {]
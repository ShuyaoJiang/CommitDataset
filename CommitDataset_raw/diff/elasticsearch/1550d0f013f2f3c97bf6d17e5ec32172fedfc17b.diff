[+++ b/core/src/main/java/org/elasticsearch/search/SearchModule.java, +import org.elasticsearch.search.rescore.QueryRescorerBuilder;, +import org.elasticsearch.search.rescore.RescoreBuilder;, +import java.util.ArrayList;, +import java.util.HashMap;, +import java.util.HashSet;, +import java.util.List;, +import java.util.Map;, +import java.util.Set;, +import java.util.function.Supplier;, +, +        configureRescorers();, +    private void configureRescorers() {, +        namedWriteableRegistry.registerPrototype(RescoreBuilder.class, QueryRescorerBuilder.PROTOTYPE);, +    }, +, +++ b/core/src/main/java/org/elasticsearch/search/SearchModule.java, +import org.elasticsearch.search.rescore.QueryRescorerBuilder;, +import org.elasticsearch.search.rescore.RescoreBuilder;, +import java.util.ArrayList;, +import java.util.HashMap;, +import java.util.HashSet;, +import java.util.List;, +import java.util.Map;, +import java.util.Set;, +import java.util.function.Supplier;, +, +        configureRescorers();, +    private void configureRescorers() {, +        namedWriteableRegistry.registerPrototype(RescoreBuilder.class, QueryRescorerBuilder.PROTOTYPE);, +    }, +, +++ b/core/src/main/java/org/elasticsearch/search/SearchService.java, +, +import org.elasticsearch.search.rescore.RescoreBaseBuilder;, +                for (RescoreBaseBuilder rescore : source.rescores()) {, +                    context.addRescore(rescore.build(context.indexShard().getQueryShardContext()));, +            } catch (IOException e) {, +                throw new SearchContextException(context, "failed to create RescoreSearchContext", e);, +++ b/core/src/main/java/org/elasticsearch/search/SearchModule.java, +import org.elasticsearch.search.rescore.QueryRescorerBuilder;, +import org.elasticsearch.search.rescore.RescoreBuilder;, +import java.util.ArrayList;, +import java.util.HashMap;, +import java.util.HashSet;, +import java.util.List;, +import java.util.Map;, +import java.util.Set;, +import java.util.function.Supplier;, +, +        configureRescorers();, +    private void configureRescorers() {, +        namedWriteableRegistry.registerPrototype(RescoreBuilder.class, QueryRescorerBuilder.PROTOTYPE);, +    }, +, +++ b/core/src/main/java/org/elasticsearch/search/SearchService.java, +, +import org.elasticsearch.search.rescore.RescoreBaseBuilder;, +                for (RescoreBaseBuilder rescore : source.rescores()) {, +                    context.addRescore(rescore.build(context.indexShard().getQueryShardContext()));, +            } catch (IOException e) {, +                throw new SearchContextException(context, "failed to create RescoreSearchContext", e);, +++ b/core/src/main/java/org/elasticsearch/search/builder/SearchSourceBuilder.java, +, +    private List<RescoreBaseBuilder> rescoreBuilders;, +            rescoreBuilders.add(rescoreBuilder);, +    public List<RescoreBaseBuilder> rescores() {, +                    List<RescoreBaseBuilder> rescoreBuilders = new ArrayList<>();, +                        rescoreBuilders.add(RescoreBaseBuilder.PROTOTYPE.fromXContent(context));, +            for (RescoreBaseBuilder rescoreBuilder : rescoreBuilders) {, +                rescoreBuilder.toXContent(builder, params);, +            List<RescoreBaseBuilder> rescoreBuilders = new ArrayList<>();, +                rescoreBuilders.add(RescoreBaseBuilder.PROTOTYPE.readFrom(in));, +            for (RescoreBaseBuilder rescoreBuilder : rescoreBuilders) {, +                rescoreBuilder.writeTo(out);, +++ b/core/src/main/java/org/elasticsearch/search/SearchModule.java, +import org.elasticsearch.search.rescore.QueryRescorerBuilder;, +import org.elasticsearch.search.rescore.RescoreBuilder;, +import java.util.ArrayList;, +import java.util.HashMap;, +import java.util.HashSet;, +import java.util.List;, +import java.util.Map;, +import java.util.Set;, +import java.util.function.Supplier;, +, +        configureRescorers();, +    private void configureRescorers() {, +        namedWriteableRegistry.registerPrototype(RescoreBuilder.class, QueryRescorerBuilder.PROTOTYPE);, +    }, +, +++ b/core/src/main/java/org/elasticsearch/search/SearchService.java, +, +import org.elasticsearch.search.rescore.RescoreBaseBuilder;, +                for (RescoreBaseBuilder rescore : source.rescores()) {, +                    context.addRescore(rescore.build(context.indexShard().getQueryShardContext()));, +            } catch (IOException e) {, +                throw new SearchContextException(context, "failed to create RescoreSearchContext", e);, +++ b/core/src/main/java/org/elasticsearch/search/builder/SearchSourceBuilder.java, +]
[+++ b/src/test/java/org/apache/lucene/util/AbstractRandomizedTest.java, +import com.carrotsearch.randomizedtesting.*;, +     * The number of concurrent JVMs used to run the tests, Default is <tt>1</tt>, +     */, +    public static final int CHILD_JVM_COUNT = Integer.parseInt(System.getProperty(SysGlobals.CHILDVM_SYSPROP_JVM_COUNT, "1"));, +    /**, +     * The child JVM ordinal of this JVM. Default is <tt>0</tt>, +     */, +    public static final int CHILD_JVM_ID = Integer.parseInt(System.getProperty(SysGlobals.CHILDVM_SYSPROP_JVM_ID, "0"));, +, +    /**, +++ b/src/test/java/org/apache/lucene/util/AbstractRandomizedTest.java, +import com.carrotsearch.randomizedtesting.*;, +     * The number of concurrent JVMs used to run the tests, Default is <tt>1</tt>, +     */, +    public static final int CHILD_JVM_COUNT = Integer.parseInt(System.getProperty(SysGlobals.CHILDVM_SYSPROP_JVM_COUNT, "1"));, +    /**, +     * The child JVM ordinal of this JVM. Default is <tt>0</tt>, +     */, +    public static final int CHILD_JVM_ID = Integer.parseInt(System.getProperty(SysGlobals.CHILDVM_SYSPROP_JVM_ID, "0"));, +, +    /**, +++ b/src/test/java/org/elasticsearch/test/ElasticsearchIntegrationTest.java, +                        clusterName("shared", Integer.toString(CHILD_JVM_ID), masterSeed), numClientNodes, InternalTestCluster.DEFAULT_ENABLE_RANDOM_BENCH_NODES, CHILD_JVM_ID);, +        return new InternalTestCluster(currentClusterSeed, minNumDataNodes, maxNumDataNodes, clusterName(scope.name(), Integer.toString(CHILD_JVM_ID), currentClusterSeed), settingsSource, numClientNodes, enableRandomBenchNodes, CHILD_JVM_ID);, +++ b/src/test/java/org/apache/lucene/util/AbstractRandomizedTest.java, +import com.carrotsearch.randomizedtesting.*;, +     * The number of concurrent JVMs used to run the tests, Default is <tt>1</tt>, +     */, +    public static final int CHILD_JVM_COUNT = Integer.parseInt(System.getProperty(SysGlobals.CHILDVM_SYSPROP_JVM_COUNT, "1"));, +    /**, +     * The child JVM ordinal of this JVM. Default is <tt>0</tt>, +     */, +    public static final int CHILD_JVM_ID = Integer.parseInt(System.getProperty(SysGlobals.CHILDVM_SYSPROP_JVM_ID, "0"));, +, +    /**, +++ b/src/test/java/org/elasticsearch/test/ElasticsearchIntegrationTest.java, +                        clusterName("shared", Integer.toString(CHILD_JVM_ID), masterSeed), numClientNodes, InternalTestCluster.DEFAULT_ENABLE_RANDOM_BENCH_NODES, CHILD_JVM_ID);, +        return new InternalTestCluster(currentClusterSeed, minNumDataNodes, maxNumDataNodes, clusterName(scope.name(), Integer.toString(CHILD_JVM_ID), currentClusterSeed), settingsSource, numClientNodes, enableRandomBenchNodes, CHILD_JVM_ID);, +++ b/src/test/java/org/elasticsearch/test/ElasticsearchTestCase.java, +++ b/src/test/java/org/apache/lucene/util/AbstractRandomizedTest.java, +import com.carrotsearch.randomizedtesting.*;, +     * The number of concurrent JVMs used to run the tests, Default is <tt>1</tt>, +     */, +    public static final int CHILD_JVM_COUNT = Integer.parseInt(System.getProperty(SysGlobals.CHILDVM_SYSPROP_JVM_COUNT, "1"));, +    /**, +     * The child JVM ordinal of this JVM. Default is <tt>0</tt>, +     */, +    public static final int CHILD_JVM_ID = Integer.parseInt(System.getProperty(SysGlobals.CHILDVM_SYSPROP_JVM_ID, "0"));, +, +    /**, +++ b/src/test/java/org/elasticsearch/test/ElasticsearchIntegrationTest.java, +                        clusterName("shared", Integer.toString(CHILD_JVM_ID), masterSeed), numClientNodes, InternalTestCluster.DEFAULT_ENABLE_RANDOM_BENCH_NODES, CHILD_JVM_ID);, +        return new InternalTestCluster(currentClusterSeed, minNumDataNodes, maxNumDataNodes, clusterName(scope.name(), Integer.toString(CHILD_JVM_ID), currentClusterSeed), settingsSource, numClientNodes, enableRandomBenchNodes, CHILD_JVM_ID);, +++ b/src/test/java/org/elasticsearch/test/ElasticsearchTestCase.java, +++ b/src/test/java/org/elasticsearch/test/InternalTestCluster.java, +    public InternalTestCluster(long clusterSeed, int minNumDataNodes, int maxNumDataNodes, String clusterName, int numClientNodes, boolean enableRandomBenchNodes, int jvmOrdinal) {, +        this(clusterSeed, minNumDataNodes, maxNumDataNodes, clusterName, DEFAULT_SETTINGS_SOURCE, numClientNodes, enableRandomBenchNodes, jvmOrdinal);, +    public InternalTestCluster(long clusterSeed, int minNumDataNodes, int maxNumDataNodes, String clusterName, SettingsSource settingsSource, int numClientNodes, boolean enableRandomBenchNodes, int jvmOrdinal) {, +        final int basePort = 9300 + (100 * (jvmOrdinal+1));, +        builder.put("transport.tcp.port", basePort + "-" + (basePort+199));, +++ b/src/test/java/org/apache/lucene/util/AbstractRandomizedTest.java, +import com.carrotsearch.randomizedtesting.*;, +     * The number of concurrent JVMs used to run the tests, Default is <tt>1</tt>, +     */, +    public static final int CHILD_JVM_COUNT = Integer.parseInt(System.getProperty(SysGlobals.CHILDVM_SYSPROP_JVM_COUNT, "1"));, +    /**, +     * The child JVM ordinal of this JVM. Default is <tt>0</tt>, +     */, +    public static final int CHILD_JVM_ID = Integer.parseInt(System.getProperty(SysGlobals.CHILDVM_SYSPROP_JVM_ID, "0"));, +, +    /**, +++ b/src/test/java/org/elasticsearch/test/ElasticsearchIntegrationTest.java, +                        clusterName("shared", Integer.toString(CHILD_JVM_ID), masterSeed), numClientNodes, InternalTestCluster.DEFAULT_ENABLE_RANDOM_BENCH_NODES, CHILD_JVM_ID);, +        return new InternalTestCluster(currentClusterSeed, minNumDataNodes, maxNumDataNodes, clusterName(scope.name(), Integer.toString(CHILD_JVM_ID), currentClusterSeed), settingsSource, numClientNodes, enableRandomBenchNodes, CHILD_JVM_ID);, +++ b/src/test/java/org/elasticsearch/test/ElasticsearchTestCase.java, +++ b/src/test/java/org/elasticsearch/test/InternalTestCluster.java, +    public InternalTestCluster(long clusterSeed, int minNumDataNodes, int maxNumDataNodes, String clusterName, int numClientNodes, boolean enableRandomBenchNodes, int jvmOrdinal) {, +        this(clusterSeed, minNumDataNodes, maxNumDataNodes, clusterName, DEFAULT_SETTINGS_SOURCE, numClientNodes, enableRandomBenchNodes, jvmOrdinal);, +    public InternalTestCluster(long clusterSeed, int minNumDataNodes, int maxNumDataNodes, String clusterName, SettingsSource settingsSource, int numClientNodes, boolean enableRandomBenchNodes, int jvmOrdinal) {, +        final int basePort = 9300 + (100 * (jvmOrdinal+1));, +        builder.put("transport.tcp.port", basePort + "-" + (basePort+199));, +++ b/src/test/java/org/elasticsearch/threadpool/SimpleThreadPoolTests.java, +, +++ b/src/test/java/org/apache/lucene/util/AbstractRandomizedTest.java, +import com.carrotsearch.randomizedtesting.*;, +     * The number of concurrent JVMs used to run the tests, Default is <tt>1</tt>, +     */, +    public static final int CHILD_JVM_COUNT = Integer.parseInt(System.getProperty(SysGlobals.CHILDVM_SYSPROP_JVM_COUNT, "1"));, +    /**, +     * The child JVM ordinal of this JVM. Default is <tt>0</tt>, +     */, +    public static final int CHILD_JVM_ID = Integer.parseInt(System.getProperty(SysGlobals.CHILDVM_SYSPROP_JVM_ID, "0"));, +, +    /**, +++ b/src/test/java/org/elasticsearch/test/ElasticsearchIntegrationTest.java, +                        clusterName("shared", Integer.toString(CHILD_JVM_ID), masterSeed), numClientNodes, InternalTestCluster.DEFAULT_ENABLE_RANDOM_BENCH_NODES, CHILD_JVM_ID);, +        return new InternalTestCluster(currentClusterSeed, minNumDataNodes, maxNumDataNodes, clusterName(scope.name(), Integer.toString(CHILD_JVM_ID), currentClusterSeed), settingsSource, numClientNodes, enableRandomBenchNodes, CHILD_JVM_ID);, +++ b/src/test/java/org/elasticsearch/test/ElasticsearchTestCase.java, +++ b/src/test/java/org/elasticsearch/test/InternalTestCluster.java]
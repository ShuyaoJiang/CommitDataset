[+++ b/core/src/main/java/org/elasticsearch/common/settings/Settings.java, +            if (this.secureSettings.get() != null) {, +                throw new IllegalArgumentException("Secure settings already set. Existing settings: " +, +                    this.secureSettings.get().getSettingNames() + ", new settings: " + secureSettings.getSettingNames());, +            }, +++ b/core/src/main/java/org/elasticsearch/common/settings/Settings.java, +            if (this.secureSettings.get() != null) {, +                throw new IllegalArgumentException("Secure settings already set. Existing settings: " +, +                    this.secureSettings.get().getSettingNames() + ", new settings: " + secureSettings.getSettingNames());, +            }, +++ b/core/src/main/java/org/elasticsearch/transport/TcpTransport.java, +                .put(defaultSettings.getAsMap()), +                .put(profileSettings.getAsMap()), +++ b/core/src/main/java/org/elasticsearch/common/settings/Settings.java, +            if (this.secureSettings.get() != null) {, +                throw new IllegalArgumentException("Secure settings already set. Existing settings: " +, +                    this.secureSettings.get().getSettingNames() + ", new settings: " + secureSettings.getSettingNames());, +            }, +++ b/core/src/main/java/org/elasticsearch/transport/TcpTransport.java, +                .put(defaultSettings.getAsMap()), +                .put(profileSettings.getAsMap()), +++ b/test/framework/src/main/java/org/elasticsearch/common/settings/MockSecureSettings.java, +    /** Merge the given secure settings into this one. */, +    public void merge(MockSecureSettings secureSettings) {, +        for (String setting : secureSettings.getSettingNames()) {, +            if (settingNames.contains(setting)) {, +                throw new IllegalArgumentException("Cannot overwrite existing secure setting " + setting);, +            }, +        }, +        settingNames.addAll(secureSettings.settingNames);, +        secureStrings.putAll(secureSettings.secureStrings);, +        files.putAll(secureSettings.files);, +    }, +]
[+++ b/core/src/main/java/org/elasticsearch/common/settings/AddFileKeyStoreCommand.java, +            if (options.has(forceOption) == false &&, +                terminal.promptYesNo("The elasticsearch keystore does not exist. Do you want to create it?", false) == false) {, +                terminal.println("Exiting without creating keystore.");, +                return;, +            keystore = KeyStoreWrapper.create(new char[0] /* always use empty passphrase for auto created keystore */);, +            keystore.save(env.configFile());, +            terminal.println("Created elasticsearch keystore in " + env.configFile());, +        } else {, +        }, +++ b/core/src/main/java/org/elasticsearch/common/settings/AddFileKeyStoreCommand.java, +            if (options.has(forceOption) == false &&, +                terminal.promptYesNo("The elasticsearch keystore does not exist. Do you want to create it?", false) == false) {, +                terminal.println("Exiting without creating keystore.");, +                return;, +            keystore = KeyStoreWrapper.create(new char[0] /* always use empty passphrase for auto created keystore */);, +            keystore.save(env.configFile());, +            terminal.println("Created elasticsearch keystore in " + env.configFile());, +        } else {, +        }, +++ b/core/src/main/java/org/elasticsearch/common/settings/AddStringKeyStoreCommand.java, +            if (options.has(forceOption) == false &&, +                terminal.promptYesNo("The elasticsearch keystore does not exist. Do you want to create it?", false) == false) {, +                terminal.println("Exiting without creating keystore.");, +                return;, +            keystore = KeyStoreWrapper.create(new char[0] /* always use empty passphrase for auto created keystore */);, +            keystore.save(env.configFile());, +            terminal.println("Created elasticsearch keystore in " + env.configFile());, +        } else {, +        }, +++ b/core/src/main/java/org/elasticsearch/common/settings/AddFileKeyStoreCommand.java, +            if (options.has(forceOption) == false &&, +                terminal.promptYesNo("The elasticsearch keystore does not exist. Do you want to create it?", false) == false) {, +                terminal.println("Exiting without creating keystore.");, +                return;, +            keystore = KeyStoreWrapper.create(new char[0] /* always use empty passphrase for auto created keystore */);, +            keystore.save(env.configFile());, +            terminal.println("Created elasticsearch keystore in " + env.configFile());, +        } else {, +        }, +++ b/core/src/main/java/org/elasticsearch/common/settings/AddStringKeyStoreCommand.java, +            if (options.has(forceOption) == false &&, +                terminal.promptYesNo("The elasticsearch keystore does not exist. Do you want to create it?", false) == false) {, +                terminal.println("Exiting without creating keystore.");, +                return;, +            keystore = KeyStoreWrapper.create(new char[0] /* always use empty passphrase for auto created keystore */);, +            keystore.save(env.configFile());, +            terminal.println("Created elasticsearch keystore in " + env.configFile());, +        } else {, +        }, +++ b/core/src/test/java/org/elasticsearch/common/settings/AddFileKeyStoreCommandTests.java, +    public void testMissingPromptCreate() throws Exception {, +        Path file1 = createRandomFile();, +        terminal.addTextInput("y");, +        execute("foo", file1.toString());, +        assertSecureFile("foo", file1);, +    }, +, +    public void testMissingForceCreate() throws Exception {, +        Path file1 = createRandomFile();, +        terminal.addSecretInput("bar");, +        execute("-f", "foo", file1.toString());, +        assertSecureFile("foo", file1);, +    }, +, +    public void testMissingNoCreate() throws Exception {, +        terminal.addTextInput("n"); // explicit no, +        execute("foo");, +        assertNull(KeyStoreWrapper.load(env.configFile()));, +++ b/core/src/main/java/org/elasticsearch/common/settings/AddFileKeyStoreCommand.java, +            if (options.has(forceOption) == false &&, +                terminal.promptYesNo("The elasticsearch keystore does not exist. Do you want to create it?", false) == false) {, +                terminal.println("Exiting without creating keystore.");, +                return;, +            keystore = KeyStoreWrapper.create(new char[0] /* always use empty passphrase for auto created keystore */);, +            keystore.save(env.configFile());, +            terminal.println("Created elasticsearch keystore in " + env.configFile());, +        } else {, +        }, +++ b/core/src/main/java/org/elasticsearch/common/settings/AddStringKeyStoreCommand.java, +            if (options.has(forceOption) == false &&, +                terminal.promptYesNo("The elasticsearch keystore does not exist. Do you want to create it?", false) == false) {, +                terminal.println("Exiting without creating keystore.");, +                return;, +            keystore = KeyStoreWrapper.create(new char[0] /* always use empty passphrase for auto created keystore */);, +            keystore.save(env.configFile());, +            terminal.println("Created elasticsearch keystore in " + env.configFile());, +        } else {, +        }, +++ b/core/src/test/java/org/elasticsearch/common/settings/AddFileKeyStoreCommandTests.java, +    public void testMissingPromptCreate() throws Exception {, +        Path file1 = createRandomFile();, +        terminal.addTextInput("y");, +        execute("foo", file1.toString());, +        assertSecureFile("foo", file1);, +    }, +, +    public void testMissingForceCreate() throws Exception {, +        Path file1 = createRandomFile();, +        terminal.addSecretInput("bar");]
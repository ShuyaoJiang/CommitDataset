[+++ b/plugin/src/test/java/org/elasticsearch/xpack/monitoring/action/MonitoringBulkTests.java, +        awaitMonitoringDocsCountOnPrimary(greaterThanOrEqualTo(total.get()), "concurrent");, +++ b/plugin/src/test/java/org/elasticsearch/xpack/monitoring/action/MonitoringBulkTests.java, +        awaitMonitoringDocsCountOnPrimary(greaterThanOrEqualTo(total.get()), "concurrent");, +++ b/plugin/src/test/java/org/elasticsearch/xpack/monitoring/resolver/cluster/ClusterInfoTests.java, +        awaitMonitoringDocsCountOnPrimary(equalTo(1L), ClusterInfoMonitoringDoc.TYPE);, +        GetResponse response = client().prepareGet(dataIndex, ClusterInfoMonitoringDoc.TYPE, clusterUUID).setPreference("_primary").get();, +                .setPreference("_primary"), +++ b/plugin/src/test/java/org/elasticsearch/xpack/monitoring/action/MonitoringBulkTests.java, +        awaitMonitoringDocsCountOnPrimary(greaterThanOrEqualTo(total.get()), "concurrent");, +++ b/plugin/src/test/java/org/elasticsearch/xpack/monitoring/resolver/cluster/ClusterInfoTests.java, +        awaitMonitoringDocsCountOnPrimary(equalTo(1L), ClusterInfoMonitoringDoc.TYPE);, +        GetResponse response = client().prepareGet(dataIndex, ClusterInfoMonitoringDoc.TYPE, clusterUUID).setPreference("_primary").get();, +                .setPreference("_primary"), +++ b/plugin/src/test/java/org/elasticsearch/xpack/monitoring/resolver/cluster/ClusterStateTests.java, +        awaitMonitoringDocsCountOnPrimary(greaterThan(0L), ClusterStateResolver.TYPE);, +        SearchResponse response = client().prepareSearch().setTypes(ClusterStateResolver.TYPE).setPreference("_primary").get();, +        awaitMonitoringDocsCountOnPrimary(greaterThan(0L), ClusterStateResolver.TYPE);, +        SearchResponse response = client().prepareSearch().setTypes(ClusterStateResolver.TYPE).setPreference("_primary").get();, +        assertHitCount(client().prepareSearch().setSize(0).setTypes(ClusterStateResolver.TYPE).setPreference("_primary"), +        awaitMonitoringDocsCountOnPrimary(greaterThanOrEqualTo(nbNodes), ClusterStateNodeMonitoringDoc.TYPE);, +        SearchResponse response = client().prepareSearch(timestampedIndex).setTypes(ClusterStateNodeMonitoringDoc.TYPE), +                .setPreference("_primary").get();, +                .setPreference("_primary"), +        awaitMonitoringDocsCountOnPrimary(greaterThanOrEqualTo(nbNodes), DiscoveryNodeResolver.TYPE);, +        SearchResponse response = client().prepareSearch(dataIndex).setTypes(DiscoveryNodeResolver.TYPE).setPreference("_primary").get();, +            assertThat(client().prepareGet(dataIndex, DiscoveryNodeResolver.TYPE, nodeId).setPreference("_primary").get().isExists(),, +                    is(true));, +                    .setPreference("_primary"), +++ b/plugin/src/test/java/org/elasticsearch/xpack/monitoring/action/MonitoringBulkTests.java, +        awaitMonitoringDocsCountOnPrimary(greaterThanOrEqualTo(total.get()), "concurrent");, +++ b/plugin/src/test/java/org/elasticsearch/xpack/monitoring/resolver/cluster/ClusterInfoTests.java, +        awaitMonitoringDocsCountOnPrimary(equalTo(1L), ClusterInfoMonitoringDoc.TYPE);, +        GetResponse response = client().prepareGet(dataIndex, ClusterInfoMonitoringDoc.TYPE, clusterUUID).setPreference("_primary").get();, +                .setPreference("_primary"), +++ b/plugin/src/test/java/org/elasticsearch/xpack/monitoring/resolver/cluster/ClusterStateTests.java, +        awaitMonitoringDocsCountOnPrimary(greaterThan(0L), ClusterStateResolver.TYPE);, +        SearchResponse response = client().prepareSearch().setTypes(ClusterStateResolver.TYPE).setPreference("_primary").get();, +        awaitMonitoringDocsCountOnPrimary(greaterThan(0L), ClusterStateResolver.TYPE);, +        SearchResponse response = client().prepareSearch().setTypes(ClusterStateResolver.TYPE).setPreference("_primary").get();, +        assertHitCount(client().prepareSearch().setSize(0).setTypes(ClusterStateResolver.TYPE).setPreference("_primary"), +        awaitMonitoringDocsCountOnPrimary(greaterThanOrEqualTo(nbNodes), ClusterStateNodeMonitoringDoc.TYPE);, +        SearchResponse response = client().prepareSearch(timestampedIndex).setTypes(ClusterStateNodeMonitoringDoc.TYPE), +                .setPreference("_primary").get();, +                .setPreference("_primary"), +        awaitMonitoringDocsCountOnPrimary(greaterThanOrEqualTo(nbNodes), DiscoveryNodeResolver.TYPE);, +        SearchResponse response = client().prepareSearch(dataIndex).setTypes(DiscoveryNodeResolver.TYPE).setPreference("_primary").get();, +            assertThat(client().prepareGet(dataIndex, DiscoveryNodeResolver.TYPE, nodeId).setPreference("_primary").get().isExists(),, +                    is(true));, +                    .setPreference("_primary"), +++ b/plugin/src/test/java/org/elasticsearch/xpack/monitoring/resolver/cluster/ClusterStatsTests.java, +        awaitMonitoringDocsCountOnPrimary(greaterThan(0L), ClusterStatsResolver.TYPE);, +                SearchResponse response = client().prepareSearch().setTypes(ClusterStatsResolver.TYPE).setPreference("_primary").get();, +++ b/plugin/src/test/java/org/elasticsearch/xpack/monitoring/action/MonitoringBulkTests.java, +        awaitMonitoringDocsCountOnPrimary(greaterThanOrEqualTo(total.get()), "concurrent");, +++ b/plugin/src/test/java/org/elasticsearch/xpack/monitoring/resolver/cluster/ClusterInfoTests.java, +        awaitMonitoringDocsCountOnPrimary(equalTo(1L), ClusterInfoMonitoringDoc.TYPE);, +        GetResponse response = client().prepareGet(dataIndex, ClusterInfoMonitoringDoc.TYPE, clusterUUID).setPreference("_primary").get();, +                .setPreference("_primary"), +++ b/plugin/src/test/java/org/elasticsearch/xpack/monitoring/resolver/cluster/ClusterStateTests.java, +        awaitMonitoringDocsCountOnPrimary(greaterThan(0L), ClusterStateResolver.TYPE);, +        SearchResponse response = client().prepareSearch().setTypes(ClusterStateResolver.TYPE).setPreference("_primary").get();, +        awaitMonitoringDocsCountOnPrimary(greaterThan(0L), ClusterStateResolver.TYPE);, +        SearchResponse response = client().prepareSearch().setTypes(ClusterStateResolver.TYPE).setPreference("_primary").get();, +        assertHitCount(client().prepareSearch().setSize(0).setTypes(ClusterStateResolver.TYPE).setPreference("_primary"), +        awaitMonitoringDocsCountOnPrimary(greaterThanOrEqualTo(nbNodes), ClusterStateNodeMonitoringDoc.TYPE);, +        SearchResponse response = client().prepareSearch(timestampedIndex).setTypes(ClusterStateNodeMonitoringDoc.TYPE), +                .setPreference("_primary").get();, +                .setPreference("_primary"), +        awaitMonitoringDocsCountOnPrimary(greaterThanOrEqualTo(nbNodes), DiscoveryNodeResolver.TYPE);, +        SearchResponse response = client().prepareSearch(dataIndex).setTypes(DiscoveryNodeResolver.TYPE).setPreference("_primary").get();, +            assertThat(client().prepareGet(dataIndex, DiscoveryNodeResolver.TYPE, nodeId).setPreference("_primary").get().isExists(),, +                    is(true));, +                    .setPreference("_primary"), +++ b/plugin/src/test/java/org/elasticsearch/xpack/monitoring/resolver/cluster/ClusterStatsTests.java, +        awaitMonitoringDocsCountOnPrimary(greaterThan(0L), ClusterStatsResolver.TYPE);, +                SearchResponse response = client().prepareSearch().setTypes(ClusterStatsResolver.TYPE).setPreference("_primary").get();, +++ b/plugin/src/test/java/org/elasticsearch/xpack/monitoring/resolver/indices/IndexRecoveryTests.java, +        awaitMonitoringDocsCountOnPrimary(greaterThan(0L), IndexRecoveryResolver.TYPE);, +        SearchResponse response = client().prepareSearch().setTypes(IndexRecoveryResolver.TYPE).setPreference("_primary").get();, +        response = client().prepareSearch().setTypes(IndexRecoveryResolver.TYPE).setPreference("_primary").setSize(0), +                .setQuery(existsQuery("cluster_uuid")).get();, +        response = client().prepareSearch().setTypes(IndexRecoveryResolver.TYPE).setPreference("_primary").setSize(0), +                .setQuery(existsQuery("timestamp")).get();, +            response = client().prepareSearch().setTypes(IndexRecoveryResolver.TYPE).setPreference("_primary").setSize(0), +                    .setQuery(existsQuery(field)).get();, +++ b/plugin/src/test/java/org/elasticsearch/xpack/monitoring/action/MonitoringBulkTests.java, +        awaitMonitoringDocsCountOnPrimary(greaterThanOrEqualTo(total.get()), "concurrent");, +++ b/plugin/src/test/java/org/elasticsearch/xpack/monitoring/resolver/cluster/ClusterInfoTests.java, +        awaitMonitoringDocsCountOnPrimary(equalTo(1L), ClusterInfoMonitoringDoc.TYPE);, +        GetResponse response = client().prepareGet(dataIndex, ClusterInfoMonitoringDoc.TYPE, clusterUUID).setPreference("_primary").get();, +                .setPreference("_primary"), +++ b/plugin/src/test/java/org/elasticsearch/xpack/monitoring/resolver/cluster/ClusterStateTests.java, +        awaitMonitoringDocsCountOnPrimary(greaterThan(0L), ClusterStateResolver.TYPE);, +        SearchResponse response = client().prepareSearch().setTypes(ClusterStateResolver.TYPE).setPreference("_primary").get();, +        awaitMonitoringDocsCountOnPrimary(greaterThan(0L), ClusterStateResolver.TYPE);, +        SearchResponse response = client().prepareSearch().setTypes(ClusterStateResolver.TYPE).setPreference("_primary").get();, +        assertHitCount(client().prepareSearch().setSize(0).setTypes(ClusterStateResolver.TYPE).setPreference("_primary"), +        awaitMonitoringDocsCountOnPrimary(greaterThanOrEqualTo(nbNodes), ClusterStateNodeMonitoringDoc.TYPE);, +        SearchResponse response = client().prepareSearch(timestampedIndex).setTypes(ClusterStateNodeMonitoringDoc.TYPE)]
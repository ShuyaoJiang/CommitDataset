[+++ b/src/main/java/org/elasticsearch/search/lookup/SearchLookup.java, +import org.apache.lucene.index.AtomicReader;, +import org.apache.lucene.index.IndexReader;, +import org.elasticsearch.ElasticSearchIllegalArgumentException;, +, +    // Sneaky way fvh to get the ARC. See SourceScoreOrderFragmentsBuilder. Passed reader must be atomic., +    // but that is the case in SourceScoreOrderFragmentsBuilder., +    public void setNextReader(IndexReader reader) {, +        if (AtomicReader.class.isInstance(reader)) {, +            throw new ElasticSearchIllegalArgumentException("reader not instance of AtomicReader, but " + reader.getClass());, +        }, +        AtomicReaderContext context = (AtomicReaderContext) reader.getContext();, +        setNextReader(context);, +    }]
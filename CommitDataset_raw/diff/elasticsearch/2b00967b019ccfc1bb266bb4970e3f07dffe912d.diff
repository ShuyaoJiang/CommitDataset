[+++ b/elasticsearch/x-pack/license-plugin/src/main/java/org/elasticsearch/license/plugin/rest/RestGetLicenseAction.java, +import static org.elasticsearch.rest.RestStatus.NOT_FOUND;, +                        boolean hasLicense = response.license() != null;, +                        if (hasLicense) {, +                        return new BytesRestResponse(hasLicense ? OK : NOT_FOUND, builder);, +++ b/elasticsearch/x-pack/license-plugin/src/main/java/org/elasticsearch/license/plugin/rest/RestGetLicenseAction.java, +import static org.elasticsearch.rest.RestStatus.NOT_FOUND;, +                        boolean hasLicense = response.license() != null;, +                        if (hasLicense) {, +                        return new BytesRestResponse(hasLicense ? OK : NOT_FOUND, builder);, +++ b/elasticsearch/x-pack/license-plugin/src/test/resources/rest-api-spec/api/license.delete.json, +{, +  "license.delete": {, +    "documentation": "https://www.elastic.co/guide/en/shield/current/license-management.html",, +    "methods": ["DELETE"],, +    "url": {, +      "path": "/_license",, +      "paths": ["/_license"],, +      "parts" : {}, +    },, +    "body": null, +  }, +}, +++ b/elasticsearch/x-pack/license-plugin/src/main/java/org/elasticsearch/license/plugin/rest/RestGetLicenseAction.java, +import static org.elasticsearch.rest.RestStatus.NOT_FOUND;, +                        boolean hasLicense = response.license() != null;, +                        if (hasLicense) {, +                        return new BytesRestResponse(hasLicense ? OK : NOT_FOUND, builder);, +++ b/elasticsearch/x-pack/license-plugin/src/test/resources/rest-api-spec/api/license.delete.json, +{, +  "license.delete": {, +    "documentation": "https://www.elastic.co/guide/en/shield/current/license-management.html",, +    "methods": ["DELETE"],, +    "url": {, +      "path": "/_license",, +      "paths": ["/_license"],, +      "parts" : {}, +    },, +    "body": null, +  }, +}, +++ b/elasticsearch/x-pack/license-plugin/src/test/resources/rest-api-spec/test/license/20_put_license.yaml, +---, +"Should throw 404 after license deletion":, +, +  - do:, +    license.delete: {}, +, +  - match: { acknowledged: true }, +, +  - do:, +      catch: missing, +      license.get: {}, +++ b/elasticsearch/x-pack/license-plugin/src/main/java/org/elasticsearch/license/plugin/rest/RestGetLicenseAction.java, +import static org.elasticsearch.rest.RestStatus.NOT_FOUND;, +                        boolean hasLicense = response.license() != null;, +                        if (hasLicense) {, +                        return new BytesRestResponse(hasLicense ? OK : NOT_FOUND, builder);, +++ b/elasticsearch/x-pack/license-plugin/src/test/resources/rest-api-spec/api/license.delete.json, +{, +  "license.delete": {, +    "documentation": "https://www.elastic.co/guide/en/shield/current/license-management.html",, +    "methods": ["DELETE"],, +    "url": {, +      "path": "/_license",, +      "paths": ["/_license"],, +      "parts" : {}, +    },, +    "body": null, +  }, +}, +++ b/elasticsearch/x-pack/license-plugin/src/test/resources/rest-api-spec/test/license/20_put_license.yaml, +---, +"Should throw 404 after license deletion":, +, +  - do:, +    license.delete: {}, +, +  - match: { acknowledged: true }, +, +  - do:, +      catch: missing, +      license.get: {}, +++ b/elasticsearch/x-pack/marvel/src/main/java/org/elasticsearch/marvel/agent/resolver/shards/ShardsResolver.java, +            builder.field(Fields.SHARD.underscore().toString(), shardRouting, params);, +++ b/elasticsearch/x-pack/license-plugin/src/main/java/org/elasticsearch/license/plugin/rest/RestGetLicenseAction.java, +import static org.elasticsearch.rest.RestStatus.NOT_FOUND;, +                        boolean hasLicense = response.license() != null;, +                        if (hasLicense) {, +                        return new BytesRestResponse(hasLicense ? OK : NOT_FOUND, builder);, +++ b/elasticsearch/x-pack/license-plugin/src/test/resources/rest-api-spec/api/license.delete.json, +{, +  "license.delete": {, +    "documentation": "https://www.elastic.co/guide/en/shield/current/license-management.html",, +    "methods": ["DELETE"],, +    "url": {, +      "path": "/_license",, +      "paths": ["/_license"],, +      "parts" : {}, +    },]
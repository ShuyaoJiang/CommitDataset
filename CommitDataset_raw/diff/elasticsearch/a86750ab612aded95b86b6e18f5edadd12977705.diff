[+++ b/Vagrantfile, +    cat \<\<JAVA > /etc/profile.d/java_home.sh, +if [ -z "\\\$JAVA_HOME" ]; then, +  export JAVA_HOME=$(dirname $(dirname $(readlink -f $(which java)))), +fi, +JAVA, +Defaults   env_keep += "JAVA_HOME", +++ b/Vagrantfile, +    cat \<\<JAVA > /etc/profile.d/java_home.sh, +if [ -z "\\\$JAVA_HOME" ]; then, +  export JAVA_HOME=$(dirname $(dirname $(readlink -f $(which java)))), +fi, +JAVA, +Defaults   env_keep += "JAVA_HOME", +++ b/distribution/packages/src/common/scripts/preinst, +    err_exit "could not find java; set JAVA_HOME", +++ b/Vagrantfile, +    cat \<\<JAVA > /etc/profile.d/java_home.sh, +if [ -z "\\\$JAVA_HOME" ]; then, +  export JAVA_HOME=$(dirname $(dirname $(readlink -f $(which java)))), +fi, +JAVA, +Defaults   env_keep += "JAVA_HOME", +++ b/distribution/packages/src/common/scripts/preinst, +    err_exit "could not find java; set JAVA_HOME", +++ b/distribution/src/bin/elasticsearch-env, +  echo "warning: Falling back to java on path. This behavior is deprecated. Specify JAVA_HOME", +  echo "could not find java; set JAVA_HOME" >&2, +++ b/Vagrantfile, +    cat \<\<JAVA > /etc/profile.d/java_home.sh, +if [ -z "\\\$JAVA_HOME" ]; then, +  export JAVA_HOME=$(dirname $(dirname $(readlink -f $(which java)))), +fi, +JAVA, +Defaults   env_keep += "JAVA_HOME", +++ b/distribution/packages/src/common/scripts/preinst, +    err_exit "could not find java; set JAVA_HOME", +++ b/distribution/src/bin/elasticsearch-env, +  echo "warning: Falling back to java on path. This behavior is deprecated. Specify JAVA_HOME", +  echo "could not find java; set JAVA_HOME" >&2, +++ b/distribution/src/bin/elasticsearch-env.bat, +  echo warning: Falling back to java on path. This behavior is deprecated. Specify JAVA_HOME, +  echo could not find java; set JAVA_HOME 1>&2, +++ b/Vagrantfile, +    cat \<\<JAVA > /etc/profile.d/java_home.sh, +if [ -z "\\\$JAVA_HOME" ]; then, +  export JAVA_HOME=$(dirname $(dirname $(readlink -f $(which java)))), +fi, +JAVA, +Defaults   env_keep += "JAVA_HOME", +++ b/distribution/packages/src/common/scripts/preinst, +    err_exit "could not find java; set JAVA_HOME", +++ b/distribution/src/bin/elasticsearch-env, +  echo "warning: Falling back to java on path. This behavior is deprecated. Specify JAVA_HOME", +  echo "could not find java; set JAVA_HOME" >&2, +++ b/distribution/src/bin/elasticsearch-env.bat, +  echo warning: Falling back to java on path. This behavior is deprecated. Specify JAVA_HOME, +  echo could not find java; set JAVA_HOME 1>&2, +++ b/qa/vagrant/src/main/java/org/elasticsearch/packaging/test/ArchiveTestCase.java, +            assertThat(runResult.stderr, containsString("could not find java; set JAVA_HOME"));, +                assertThat(runResult.stderr, containsString("could not find java; set JAVA_HOME"));, +++ b/Vagrantfile, +    cat \<\<JAVA > /etc/profile.d/java_home.sh, +if [ -z "\\\$JAVA_HOME" ]; then, +  export JAVA_HOME=$(dirname $(dirname $(readlink -f $(which java)))), +fi, +JAVA, +Defaults   env_keep += "JAVA_HOME", +++ b/distribution/packages/src/common/scripts/preinst, +    err_exit "could not find java; set JAVA_HOME", +++ b/distribution/src/bin/elasticsearch-env, +  echo "warning: Falling back to java on path. This behavior is deprecated. Specify JAVA_HOME", +  echo "could not find java; set JAVA_HOME" >&2, +++ b/distribution/src/bin/elasticsearch-env.bat, +  echo warning: Falling back to java on path. This behavior is deprecated. Specify JAVA_HOME, +  echo could not find java; set JAVA_HOME 1>&2, +++ b/qa/vagrant/src/main/java/org/elasticsearch/packaging/test/ArchiveTestCase.java, +            assertThat(runResult.stderr, containsString("could not find java; set JAVA_HOME"));, +                assertThat(runResult.stderr, containsString("could not find java; set JAVA_HOME"));, +++ b/qa/vagrant/src/main/java/org/elasticsearch/packaging/test/PackageTestCase.java, +        final Result javaHomeOutput = sh.run("echo $JAVA_HOME");, +        final Path javaHome = Paths.get(javaHomeOutput.stdout.trim());, +        final Path originalJavaPath = javaHome.resolve("bin").resolve("java");, +        final Path relocatedJavaPath = javaHome.resolve("bin").resolve("java.relocated");, +            assertThat(installResult.stderr, containsString("could not find java; set JAVA_HOME"));, +++ b/Vagrantfile, +    cat \<\<JAVA > /etc/profile.d/java_home.sh, +if [ -z "\\\$JAVA_HOME" ]; then, +  export JAVA_HOME=$(dirname $(dirname $(readlink -f $(which java)))), +fi, +JAVA, +Defaults   env_keep += "JAVA_HOME", +++ b/distribution/packages/src/common/scripts/preinst, +    err_exit "could not find java; set JAVA_HOME", +++ b/distribution/src/bin/elasticsearch-env, +  echo "warning: Falling back to java on path. This behavior is deprecated. Specify JAVA_HOME", +  echo "could not find java; set JAVA_HOME" >&2, +++ b/distribution/src/bin/elasticsearch-env.bat, +  echo warning: Falling back to java on path. This behavior is deprecated. Specify JAVA_HOME, +  echo could not find java; set JAVA_HOME 1>&2]
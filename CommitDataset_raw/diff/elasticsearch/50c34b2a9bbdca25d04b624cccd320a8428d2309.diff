[+++ b/x-pack/docs/en/rest-api/ml/get-category.asciidoc, +`esxi_log` job:, +GET _xpack/ml/anomaly_detectors/esxi_log/results/categories, +      "job_id" : "esxi_log",, +      "terms" : "Vpxa verbose vpxavpxaInvtVm opID VpxaInvtVmChangeListener Guest DiskInfo Changed",, +      "regex" : ".*?Vpxa.+?verbose.+?vpxavpxaInvtVm.+?opID.+?VpxaInvtVmChangeListener.+?Guest.+?DiskInfo.+?Changed.*",, +      "max_matching_length": 154,, +        "Oct 19 17:04:44 esxi1.acme.com Vpxa: [3CB3FB90 verbose 'vpxavpxaInvtVm' opID=WFU-33d82c31] [VpxaInvtVmChangeListener] Guest DiskInfo Changed",, +        "Oct 19 17:04:45 esxi2.acme.com Vpxa: [3CA66B90 verbose 'vpxavpxaInvtVm' opID=WFU-33927856] [VpxaInvtVmChangeListener] Guest DiskInfo Changed",, +        "Oct 19 17:04:51 esxi1.acme.com Vpxa: [FFDBAB90 verbose 'vpxavpxaInvtVm' opID=WFU-25e0d447] [VpxaInvtVmChangeListener] Guest DiskInfo Changed",, +        "Oct 19 17:04:58 esxi2.acme.com Vpxa: [FFDDBB90 verbose 'vpxavpxaInvtVm' opID=WFU-bbff0134] [VpxaInvtVmChangeListener] Guest DiskInfo Changed", +      ],, +      "grok_pattern" : ".*?%{SYSLOGTIMESTAMP:timestamp}.+?Vpxa.+?%{BASE16NUM:field}.+?verbose.+?vpxavpxaInvtVm.+?opID.+?VpxaInvtVmChangeListener.+?Guest.+?DiskInfo.+?Changed.*", +++ b/x-pack/docs/en/rest-api/ml/get-category.asciidoc, +`esxi_log` job:, +GET _xpack/ml/anomaly_detectors/esxi_log/results/categories, +      "job_id" : "esxi_log",, +      "terms" : "Vpxa verbose vpxavpxaInvtVm opID VpxaInvtVmChangeListener Guest DiskInfo Changed",, +      "regex" : ".*?Vpxa.+?verbose.+?vpxavpxaInvtVm.+?opID.+?VpxaInvtVmChangeListener.+?Guest.+?DiskInfo.+?Changed.*",, +      "max_matching_length": 154,, +        "Oct 19 17:04:44 esxi1.acme.com Vpxa: [3CB3FB90 verbose 'vpxavpxaInvtVm' opID=WFU-33d82c31] [VpxaInvtVmChangeListener] Guest DiskInfo Changed",, +        "Oct 19 17:04:45 esxi2.acme.com Vpxa: [3CA66B90 verbose 'vpxavpxaInvtVm' opID=WFU-33927856] [VpxaInvtVmChangeListener] Guest DiskInfo Changed",, +        "Oct 19 17:04:51 esxi1.acme.com Vpxa: [FFDBAB90 verbose 'vpxavpxaInvtVm' opID=WFU-25e0d447] [VpxaInvtVmChangeListener] Guest DiskInfo Changed",, +        "Oct 19 17:04:58 esxi2.acme.com Vpxa: [FFDDBB90 verbose 'vpxavpxaInvtVm' opID=WFU-bbff0134] [VpxaInvtVmChangeListener] Guest DiskInfo Changed", +      ],, +      "grok_pattern" : ".*?%{SYSLOGTIMESTAMP:timestamp}.+?Vpxa.+?%{BASE16NUM:field}.+?verbose.+?vpxavpxaInvtVm.+?opID.+?VpxaInvtVmChangeListener.+?Guest.+?DiskInfo.+?Changed.*", +++ b/x-pack/docs/en/rest-api/ml/resultsresource.asciidoc, +`grok_pattern`::, +  experimental[] (string) A Grok pattern that could be used in Logstash or an, +  Ingest Pipeline to extract fields from messages that match the category. This, +  field is experimental and may be changed or removed in a future release. The, +  Grok patterns that are found are not optimal, but are often a good starting, +  point for manual tweaking., +, +++ b/x-pack/docs/en/rest-api/ml/get-category.asciidoc, +`esxi_log` job:, +GET _xpack/ml/anomaly_detectors/esxi_log/results/categories, +      "job_id" : "esxi_log",, +      "terms" : "Vpxa verbose vpxavpxaInvtVm opID VpxaInvtVmChangeListener Guest DiskInfo Changed",, +      "regex" : ".*?Vpxa.+?verbose.+?vpxavpxaInvtVm.+?opID.+?VpxaInvtVmChangeListener.+?Guest.+?DiskInfo.+?Changed.*",, +      "max_matching_length": 154,, +        "Oct 19 17:04:44 esxi1.acme.com Vpxa: [3CB3FB90 verbose 'vpxavpxaInvtVm' opID=WFU-33d82c31] [VpxaInvtVmChangeListener] Guest DiskInfo Changed",, +        "Oct 19 17:04:45 esxi2.acme.com Vpxa: [3CA66B90 verbose 'vpxavpxaInvtVm' opID=WFU-33927856] [VpxaInvtVmChangeListener] Guest DiskInfo Changed",, +        "Oct 19 17:04:51 esxi1.acme.com Vpxa: [FFDBAB90 verbose 'vpxavpxaInvtVm' opID=WFU-25e0d447] [VpxaInvtVmChangeListener] Guest DiskInfo Changed",, +        "Oct 19 17:04:58 esxi2.acme.com Vpxa: [FFDDBB90 verbose 'vpxavpxaInvtVm' opID=WFU-bbff0134] [VpxaInvtVmChangeListener] Guest DiskInfo Changed", +      ],, +      "grok_pattern" : ".*?%{SYSLOGTIMESTAMP:timestamp}.+?Vpxa.+?%{BASE16NUM:field}.+?verbose.+?vpxavpxaInvtVm.+?opID.+?VpxaInvtVmChangeListener.+?Guest.+?DiskInfo.+?Changed.*", +++ b/x-pack/docs/en/rest-api/ml/resultsresource.asciidoc, +`grok_pattern`::, +  experimental[] (string) A Grok pattern that could be used in Logstash or an, +  Ingest Pipeline to extract fields from messages that match the category. This, +  field is experimental and may be changed or removed in a future release. The, +  Grok patterns that are found are not optimal, but are often a good starting, +  point for manual tweaking., +, +++ b/x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/ml/job/results/CategoryDefinition.java, +import org.elasticsearch.Version;, +    public static final ParseField GROK_PATTERN = new ParseField("grok_pattern");, +        parser.declareString(CategoryDefinition::setGrokPattern, GROK_PATTERN);, +    private String grokPattern;, +        if (in.getVersion().onOrAfter(Version.V_7_0_0_alpha1)) {, +            grokPattern = in.readOptionalString();, +        }, +        if (out.getVersion().onOrAfter(Version.V_7_0_0_alpha1)) {, +            out.writeOptionalString(grokPattern);, +        }, +    public String getGrokPattern() {, +        return grokPattern;, +    }, +, +    public void setGrokPattern(String grokPattern) {, +        this.grokPattern = grokPattern;, +    }, +, +        if (grokPattern != null) {, +            builder.field(GROK_PATTERN.getPreferredName(), grokPattern);, +        }, +                && Objects.equals(this.examples, that.examples), +                && Objects.equals(this.grokPattern, that.grokPattern);, +        return Objects.hash(jobId, categoryId, terms, regex, maxMatchingLength, examples, grokPattern);, +++ b/x-pack/docs/en/rest-api/ml/get-category.asciidoc, +`esxi_log` job:, +GET _xpack/ml/anomaly_detectors/esxi_log/results/categories, +      "job_id" : "esxi_log",, +      "terms" : "Vpxa verbose vpxavpxaInvtVm opID VpxaInvtVmChangeListener Guest DiskInfo Changed",, +      "regex" : ".*?Vpxa.+?verbose.+?vpxavpxaInvtVm.+?opID.+?VpxaInvtVmChangeListener.+?Guest.+?DiskInfo.+?Changed.*",, +      "max_matching_length": 154,, +        "Oct 19 17:04:44 esxi1.acme.com Vpxa: [3CB3FB90 verbose 'vpxavpxaInvtVm' opID=WFU-33d82c31] [VpxaInvtVmChangeListener] Guest DiskInfo Changed",, +        "Oct 19 17:04:45 esxi2.acme.com Vpxa: [3CA66B90 verbose 'vpxavpxaInvtVm' opID=WFU-33927856] [VpxaInvtVmChangeListener] Guest DiskInfo Changed",, +        "Oct 19 17:04:51 esxi1.acme.com Vpxa: [FFDBAB90 verbose 'vpxavpxaInvtVm' opID=WFU-25e0d447] [VpxaInvtVmChangeListener] Guest DiskInfo Changed",, +        "Oct 19 17:04:58 esxi2.acme.com Vpxa: [FFDDBB90 verbose 'vpxavpxaInvtVm' opID=WFU-bbff0134] [VpxaInvtVmChangeListener] Guest DiskInfo Changed", +      ],, +      "grok_pattern" : ".*?%{SYSLOGTIMESTAMP:timestamp}.+?Vpxa.+?%{BASE16NUM:field}.+?verbose.+?vpxavpxaInvtVm.+?opID.+?VpxaInvtVmChangeListener.+?Guest.+?DiskInfo.+?Changed.*", +++ b/x-pack/docs/en/rest-api/ml/resultsresource.asciidoc, +`grok_pattern`::, +  experimental[] (string) A Grok pattern that could be used in Logstash or an, +  Ingest Pipeline to extract fields from messages that match the category. This, +  field is experimental and may be changed or removed in a future release. The, +  Grok patterns that are found are not optimal, but are often a good starting, +  point for manual tweaking.]
[+++ b/core/src/main/java/org/elasticsearch/http/netty/HttpRequestHandler.java, +        this.corsPattern = RestUtils.checkCorsSettingForRegex(serverTransport.settings().get(NettyHttpServerTransport.SETTING_CORS_ALLOW_ORIGIN));, +++ b/core/src/main/java/org/elasticsearch/http/netty/HttpRequestHandler.java, +        this.corsPattern = RestUtils.checkCorsSettingForRegex(serverTransport.settings().get(NettyHttpServerTransport.SETTING_CORS_ALLOW_ORIGIN));, +++ b/core/src/main/java/org/elasticsearch/rest/support/RestUtils.java, +import java.nio.charset.StandardCharsets;, +     *, +     * @return a corresponding {@link Pattern} if so and o.w. null., +    public static Pattern checkCorsSettingForRegex(String corsSetting) {, +        if (corsSetting == null) {, +            return null;, +        }, +++ b/core/src/main/java/org/elasticsearch/http/netty/HttpRequestHandler.java, +        this.corsPattern = RestUtils.checkCorsSettingForRegex(serverTransport.settings().get(NettyHttpServerTransport.SETTING_CORS_ALLOW_ORIGIN));, +++ b/core/src/main/java/org/elasticsearch/rest/support/RestUtils.java, +import java.nio.charset.StandardCharsets;, +     *, +     * @return a corresponding {@link Pattern} if so and o.w. null., +    public static Pattern checkCorsSettingForRegex(String corsSetting) {, +        if (corsSetting == null) {, +            return null;, +        }, +++ b/core/src/test/java/org/elasticsearch/rest/util/RestUtilsTests.java, +import static org.hamcrest.Matchers.*;, +        assertThat(RestUtils.checkCorsSettingForRegex(settingsValue), is(nullValue()));, +        assertThat(RestUtils.checkCorsSettingForRegex(settingsValue).toString(), is(pattern.toString()));, +        Pattern pattern = RestUtils.checkCorsSettingForRegex(settingsValue);]
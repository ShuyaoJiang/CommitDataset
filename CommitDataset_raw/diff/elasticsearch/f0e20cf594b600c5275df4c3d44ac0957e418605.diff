[+++ b/core/src/main/java/org/elasticsearch/common/util/MultiDataPathUpgrader.java, +                    String fileName = shardPath.getFileName().toString();, +                    if (Files.isDirectory(shardPath) && fileName.chars().allMatch(Character::isDigit)) {, +                        int shardId = Integer.parseInt(fileName);, +++ b/core/src/main/java/org/elasticsearch/common/util/MultiDataPathUpgrader.java, +                    String fileName = shardPath.getFileName().toString();, +                    if (Files.isDirectory(shardPath) && fileName.chars().allMatch(Character::isDigit)) {, +                        int shardId = Integer.parseInt(fileName);, +++ b/core/src/main/java/org/elasticsearch/common/util/primitives/Integers.java, +import java.util.Collection;, +import java.util.Objects;, +++ b/core/src/main/java/org/elasticsearch/common/util/MultiDataPathUpgrader.java, +                    String fileName = shardPath.getFileName().toString();, +                    if (Files.isDirectory(shardPath) && fileName.chars().allMatch(Character::isDigit)) {, +                        int shardId = Integer.parseInt(fileName);, +++ b/core/src/main/java/org/elasticsearch/common/util/primitives/Integers.java, +import java.util.Collection;, +import java.util.Objects;, +++ b/core/src/main/java/org/elasticsearch/env/NodeEnvironment.java, +                    String fileName = shardPath.getFileName().toString();, +                    if (Files.isDirectory(shardPath) && fileName.chars().allMatch(Character::isDigit)) {, +                        int shardId = Integer.parseInt(fileName);, +++ b/core/src/main/java/org/elasticsearch/common/util/MultiDataPathUpgrader.java, +                    String fileName = shardPath.getFileName().toString();, +                    if (Files.isDirectory(shardPath) && fileName.chars().allMatch(Character::isDigit)) {, +                        int shardId = Integer.parseInt(fileName);, +++ b/core/src/main/java/org/elasticsearch/common/util/primitives/Integers.java, +import java.util.Collection;, +import java.util.Objects;, +++ b/core/src/main/java/org/elasticsearch/env/NodeEnvironment.java, +                    String fileName = shardPath.getFileName().toString();, +                    if (Files.isDirectory(shardPath) && fileName.chars().allMatch(Character::isDigit)) {, +                        int shardId = Integer.parseInt(fileName);, +++ /dev/null]
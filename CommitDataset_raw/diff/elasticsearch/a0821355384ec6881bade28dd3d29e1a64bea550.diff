[+++ b/core/src/main/java/org/elasticsearch/index/IndexServicesProvider.java, +, +import org.elasticsearch.indices.memory.IndexingMemoryController;, +    private final IndexingMemoryController indexingMemoryController;, +    public IndexServicesProvider(IndicesLifecycle indicesLifecycle, ThreadPool threadPool, MapperService mapperService, IndexQueryParserService queryParserService, IndexCache indexCache, IndexAliasesService indexAliasesService, IndicesQueryCache indicesQueryCache, CodecService codecService, TermVectorsService termVectorsService, IndexFieldDataService indexFieldDataService, @Nullable IndicesWarmer warmer, SimilarityService similarityService, EngineFactory factory, BigArrays bigArrays, @Nullable IndexSearcherWrapper indexSearcherWrapper, IndexingMemoryController indexingMemoryController) {, +        this.indexingMemoryController = indexingMemoryController;, +    public IndexSearcherWrapper getIndexSearcherWrapper() {, +        return indexSearcherWrapper;, +    }, +, +    public IndexingMemoryController getIndexingMemoryController() {, +        return indexingMemoryController;, +    }, +++ b/core/src/main/java/org/elasticsearch/index/IndexServicesProvider.java, +, +import org.elasticsearch.indices.memory.IndexingMemoryController;, +    private final IndexingMemoryController indexingMemoryController;, +    public IndexServicesProvider(IndicesLifecycle indicesLifecycle, ThreadPool threadPool, MapperService mapperService, IndexQueryParserService queryParserService, IndexCache indexCache, IndexAliasesService indexAliasesService, IndicesQueryCache indicesQueryCache, CodecService codecService, TermVectorsService termVectorsService, IndexFieldDataService indexFieldDataService, @Nullable IndicesWarmer warmer, SimilarityService similarityService, EngineFactory factory, BigArrays bigArrays, @Nullable IndexSearcherWrapper indexSearcherWrapper, IndexingMemoryController indexingMemoryController) {, +        this.indexingMemoryController = indexingMemoryController;, +    public IndexSearcherWrapper getIndexSearcherWrapper() {, +        return indexSearcherWrapper;, +    }, +, +    public IndexingMemoryController getIndexingMemoryController() {, +        return indexingMemoryController;, +    }, +++ b/core/src/main/java/org/elasticsearch/index/engine/Engine.java, +    /** How much heap Lucene's IndexWriter is using */, +    abstract public long indexWriterRAMBytesUsed();, +, +, +        /**, +         * Returns operation start time in nanoseconds., +         */, +        long startTime();, +        @Override, +        @Override, +++ b/core/src/main/java/org/elasticsearch/index/IndexServicesProvider.java, +, +import org.elasticsearch.indices.memory.IndexingMemoryController;, +    private final IndexingMemoryController indexingMemoryController;, +    public IndexServicesProvider(IndicesLifecycle indicesLifecycle, ThreadPool threadPool, MapperService mapperService, IndexQueryParserService queryParserService, IndexCache indexCache, IndexAliasesService indexAliasesService, IndicesQueryCache indicesQueryCache, CodecService codecService, TermVectorsService termVectorsService, IndexFieldDataService indexFieldDataService, @Nullable IndicesWarmer warmer, SimilarityService similarityService, EngineFactory factory, BigArrays bigArrays, @Nullable IndexSearcherWrapper indexSearcherWrapper, IndexingMemoryController indexingMemoryController) {, +        this.indexingMemoryController = indexingMemoryController;, +    public IndexSearcherWrapper getIndexSearcherWrapper() {, +        return indexSearcherWrapper;, +    }, +, +    public IndexingMemoryController getIndexingMemoryController() {, +        return indexingMemoryController;, +    }, +++ b/core/src/main/java/org/elasticsearch/index/engine/Engine.java, +    /** How much heap Lucene's IndexWriter is using */, +    abstract public long indexWriterRAMBytesUsed();, +, +, +        /**, +         * Returns operation start time in nanoseconds., +         */, +        long startTime();, +        @Override, +        @Override, +++ b/core/src/main/java/org/elasticsearch/index/engine/InternalEngine.java, +    public long indexWriterRAMBytesUsed() {, +        return indexWriter.ramBytesUsed();, +    }, +, +    @Override, +++ b/core/src/main/java/org/elasticsearch/index/IndexServicesProvider.java, +, +import org.elasticsearch.indices.memory.IndexingMemoryController;, +    private final IndexingMemoryController indexingMemoryController;, +    public IndexServicesProvider(IndicesLifecycle indicesLifecycle, ThreadPool threadPool, MapperService mapperService, IndexQueryParserService queryParserService, IndexCache indexCache, IndexAliasesService indexAliasesService, IndicesQueryCache indicesQueryCache, CodecService codecService, TermVectorsService termVectorsService, IndexFieldDataService indexFieldDataService, @Nullable IndicesWarmer warmer, SimilarityService similarityService, EngineFactory factory, BigArrays bigArrays, @Nullable IndexSearcherWrapper indexSearcherWrapper, IndexingMemoryController indexingMemoryController) {, +        this.indexingMemoryController = indexingMemoryController;, +    public IndexSearcherWrapper getIndexSearcherWrapper() {, +        return indexSearcherWrapper;, +    }, +, +    public IndexingMemoryController getIndexingMemoryController() {, +        return indexingMemoryController;, +    }, +++ b/core/src/main/java/org/elasticsearch/index/engine/Engine.java, +    /** How much heap Lucene's IndexWriter is using */, +    abstract public long indexWriterRAMBytesUsed();, +, +, +        /**, +         * Returns operation start time in nanoseconds., +         */, +        long startTime();, +        @Override, +        @Override, +++ b/core/src/main/java/org/elasticsearch/index/engine/InternalEngine.java, +    public long indexWriterRAMBytesUsed() {, +        return indexWriter.ramBytesUsed();, +    }, +, +    @Override, +++ b/core/src/main/java/org/elasticsearch/index/engine/ShadowEngine.java, +    @Override, +    public long indexWriterRAMBytesUsed() {]
[+++ b/buildSrc/src/main/java/org/elasticsearch/gradle/testclusters/ElasticsearchNode.java, +        // Test clusters are not reused, don't spend time on a graceful shutdown, +        stopHandle(esProcess.toHandle(), true);, +    private void stopHandle(ProcessHandle processHandle, boolean forcibly) {, +        if (processHandle.isAlive() == false) {, +            return;, +, +        // Stop all children first, ES could actually be a child when there's some wrapper process like on Windows., +        processHandle.children().forEach(each -> stopHandle(each, forcibly));, +, +        logProcessInfo(, +            "Terminating elasticsearch process" + (forcibly ? " forcibly " : "gracefully") + ":",, +            processHandle.info(), +, +        if (forcibly) {, +            processHandle.destroyForcibly();, +        } else {, +            processHandle.destroy();, +            waitForProcessToExit(processHandle);, +            if (processHandle.isAlive() == false) {, +                return;, +            }, +            logger.info("process did not terminate after {} {}, stopping it forcefully",, +                ES_DESTROY_TIMEOUT, ES_DESTROY_TIMEOUT_UNIT);, +, +            throw new TestClustersException("Was not able to terminate elasticsearch process");]
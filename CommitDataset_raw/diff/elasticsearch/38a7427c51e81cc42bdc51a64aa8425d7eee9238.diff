[+++ b/core/src/main/java/org/elasticsearch/action/admin/cluster/node/stats/NodeStats.java, +        discoveryStats = in.readOptionalWriteable(DiscoveryStats::new);, +        out.writeOptionalWriteable(discoveryStats);, +++ b/core/src/main/java/org/elasticsearch/action/admin/cluster/node/stats/NodeStats.java, +        discoveryStats = in.readOptionalWriteable(DiscoveryStats::new);, +        out.writeOptionalWriteable(discoveryStats);, +++ b/core/src/main/java/org/elasticsearch/discovery/DiscoveryStats.java, +import org.elasticsearch.common.io.stream.Writeable;, +public class DiscoveryStats implements Writeable, ToXContent {, +    private final PendingClusterStateStats queueStats;, +    public DiscoveryStats(StreamInput in) throws IOException {, +        queueStats = in.readOptionalWriteable(PendingClusterStateStats::new);, +    }, +, +    @Override, +    public void writeTo(StreamOutput out) throws IOException {, +        out.writeOptionalWriteable(queueStats);, +    }, +, +++ b/core/src/main/java/org/elasticsearch/action/admin/cluster/node/stats/NodeStats.java, +        discoveryStats = in.readOptionalWriteable(DiscoveryStats::new);, +        out.writeOptionalWriteable(discoveryStats);, +++ b/core/src/main/java/org/elasticsearch/discovery/DiscoveryStats.java, +import org.elasticsearch.common.io.stream.Writeable;, +public class DiscoveryStats implements Writeable, ToXContent {, +    private final PendingClusterStateStats queueStats;, +    public DiscoveryStats(StreamInput in) throws IOException {, +        queueStats = in.readOptionalWriteable(PendingClusterStateStats::new);, +    }, +, +    @Override, +    public void writeTo(StreamOutput out) throws IOException {, +        out.writeOptionalWriteable(queueStats);, +    }, +, +++ b/core/src/main/java/org/elasticsearch/discovery/local/LocalDiscovery.java, +import org.elasticsearch.discovery.zen.publish.PendingClusterStateStats;, +        return new DiscoveryStats((PendingClusterStateStats)null);, +++ b/core/src/main/java/org/elasticsearch/action/admin/cluster/node/stats/NodeStats.java, +        discoveryStats = in.readOptionalWriteable(DiscoveryStats::new);, +        out.writeOptionalWriteable(discoveryStats);, +++ b/core/src/main/java/org/elasticsearch/discovery/DiscoveryStats.java, +import org.elasticsearch.common.io.stream.Writeable;, +public class DiscoveryStats implements Writeable, ToXContent {, +    private final PendingClusterStateStats queueStats;, +    public DiscoveryStats(StreamInput in) throws IOException {, +        queueStats = in.readOptionalWriteable(PendingClusterStateStats::new);, +    }, +, +    @Override, +    public void writeTo(StreamOutput out) throws IOException {, +        out.writeOptionalWriteable(queueStats);, +    }, +, +++ b/core/src/main/java/org/elasticsearch/discovery/local/LocalDiscovery.java, +import org.elasticsearch.discovery.zen.publish.PendingClusterStateStats;, +        return new DiscoveryStats((PendingClusterStateStats)null);, +++ b/core/src/main/java/org/elasticsearch/discovery/zen/publish/PendingClusterStateStats.java, +import org.elasticsearch.common.io.stream.Writeable;, +public class PendingClusterStateStats implements Writeable, ToXContent {, +    private final int total;, +    private final int pending;, +    private final int committed;, +    public PendingClusterStateStats(StreamInput in) throws IOException {, +        total = in.readVInt();, +        pending = in.readVInt();, +        committed = in.readVInt();, +    }, +, +    @Override, +    public void writeTo(StreamOutput out) throws IOException {, +        out.writeVInt(total);, +        out.writeVInt(pending);, +        out.writeVInt(committed);, +    }, +]
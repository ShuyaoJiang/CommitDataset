[+++ b/server/src/main/java/org/elasticsearch/index/query/InnerHitBuilder.java, +        docValueFields.add(new FieldAndFormat(field, format));, +++ b/server/src/main/java/org/elasticsearch/index/query/InnerHitBuilder.java, +        docValueFields.add(new FieldAndFormat(field, format));, +++ b/server/src/test/java/org/elasticsearch/index/query/InnerHitBuilderTests.java, +import java.util.Arrays;, +    public void testSetDocValueFormat() {, +        InnerHitBuilder innerHit = new InnerHitBuilder();, +        innerHit.addDocValueField("foo");, +        innerHit.addDocValueField("@timestamp", "epoch_millis");, +        assertEquals(, +                Arrays.asList(new FieldAndFormat("foo", null), new FieldAndFormat("@timestamp", "epoch_millis")),, +                innerHit.getDocValueFields());, +    }]
[+++ b/docs/reference/migration/migrate_2_0.asciidoc, +* `_routing` configuration is limited to requiring the field., +++ b/docs/reference/migration/migrate_2_0.asciidoc, +* `_routing` configuration is limited to requiring the field., +++ b/src/main/java/org/elasticsearch/index/mapper/internal/RoutingFieldMapper.java, +            if (parserContext.indexVersionCreated().before(Version.V_2_0_0)) {, +            }, +        if (writePre2xSettings && (includeDefaults || indexed != indexedDefault)) {, +        if (writePre2xSettings && (includeDefaults || fieldType.stored() != Defaults.FIELD_TYPE.stored())) {, +++ b/docs/reference/migration/migrate_2_0.asciidoc, +* `_routing` configuration is limited to requiring the field., +++ b/src/main/java/org/elasticsearch/index/mapper/internal/RoutingFieldMapper.java, +            if (parserContext.indexVersionCreated().before(Version.V_2_0_0)) {, +            }, +        if (writePre2xSettings && (includeDefaults || indexed != indexedDefault)) {, +        if (writePre2xSettings && (includeDefaults || fieldType.stored() != Defaults.FIELD_TYPE.stored())) {, +++ b/src/test/java/org/elasticsearch/get/GetActionTests.java, +        String[] fieldsList = {"_timestamp", "_size"};, +        String[] alwaysStoredFieldsList = {"_routing"};, +        assertGetFieldsAlwaysWorks(indexOrAlias(), "doc", "1", alwaysStoredFieldsList, "1");, +        assertGetFieldsAlwaysWorks(indexOrAlias(), "doc", "1", alwaysStoredFieldsList, "1");, +        assertGetFieldsAlwaysWorks(indexOrAlias(), "doc", "1", alwaysStoredFieldsList, "1");, +++ b/docs/reference/migration/migrate_2_0.asciidoc, +* `_routing` configuration is limited to requiring the field., +++ b/src/main/java/org/elasticsearch/index/mapper/internal/RoutingFieldMapper.java, +            if (parserContext.indexVersionCreated().before(Version.V_2_0_0)) {, +            }, +        if (writePre2xSettings && (includeDefaults || indexed != indexedDefault)) {, +        if (writePre2xSettings && (includeDefaults || fieldType.stored() != Defaults.FIELD_TYPE.stored())) {, +++ b/src/test/java/org/elasticsearch/get/GetActionTests.java, +        String[] fieldsList = {"_timestamp", "_size"};, +        String[] alwaysStoredFieldsList = {"_routing"};, +        assertGetFieldsAlwaysWorks(indexOrAlias(), "doc", "1", alwaysStoredFieldsList, "1");, +        assertGetFieldsAlwaysWorks(indexOrAlias(), "doc", "1", alwaysStoredFieldsList, "1");, +        assertGetFieldsAlwaysWorks(indexOrAlias(), "doc", "1", alwaysStoredFieldsList, "1");, +++ b/src/test/java/org/elasticsearch/index/mapper/routing/RoutingTypeMapperTests.java, +import org.elasticsearch.Version;, +import org.elasticsearch.cluster.metadata.IndexMetaData;, +import org.elasticsearch.common.settings.ImmutableSettings;, +import org.elasticsearch.common.settings.Settings;, +    public void testFieldTypeSettingsBackcompat() throws Exception {, +        Settings indexSettings = ImmutableSettings.builder().put(IndexMetaData.SETTING_VERSION_CREATED, Version.V_1_4_2.id).build();, +        DocumentMapper docMapper = createIndex("test", indexSettings).mapperService().documentMapperParser().parse(mapping);, +    public void testFieldTypeSettingsSerializationBackcompat() throws Exception {, +        Settings indexSettings = ImmutableSettings.builder().put(IndexMetaData.SETTING_VERSION_CREATED, Version.V_1_4_2.id).build();, +        DocumentMapper enabledMapper = createIndex("test", indexSettings).mapperService().documentMapperParser().parse(enabledMapping);]
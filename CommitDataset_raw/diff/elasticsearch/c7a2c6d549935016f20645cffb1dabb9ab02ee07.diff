[+++ b/server/src/main/java/org/elasticsearch/search/aggregations/bucket/composite/LongValuesSource.java, +import org.apache.lucene.search.BoostQuery;, +import org.apache.lucene.search.IndexOrDocValuesQuery;, +    static Query extractQuery(Query query) {, +        if (query instanceof BoostQuery) {, +            return extractQuery(((BoostQuery) query).getQuery());, +        } else if (query instanceof IndexOrDocValuesQuery) {, +            return extractQuery(((IndexOrDocValuesQuery) query).getIndexQuery());, +        } else {, +            return query;, +        }, +    }, +, +        query = extractQuery(query);, +++ b/server/src/main/java/org/elasticsearch/search/aggregations/bucket/composite/LongValuesSource.java, +import org.apache.lucene.search.BoostQuery;, +import org.apache.lucene.search.IndexOrDocValuesQuery;, +    static Query extractQuery(Query query) {, +        if (query instanceof BoostQuery) {, +            return extractQuery(((BoostQuery) query).getQuery());, +        } else if (query instanceof IndexOrDocValuesQuery) {, +            return extractQuery(((IndexOrDocValuesQuery) query).getIndexQuery());, +        } else {, +            return query;, +        }, +    }, +, +        query = extractQuery(query);, +++ b/server/src/test/java/org/elasticsearch/search/aggregations/bucket/composite/SingleDimensionValuesSourceTests.java, +import org.apache.lucene.search.BoostQuery;, +import org.apache.lucene.search.IndexOrDocValuesQuery;, +                assertNotNull(source.createSortedDocsProducerOrNull(reader, new IndexOrDocValuesQuery(, +                    LongPoint.newRangeQuery("number", 0, 1), new MatchAllDocsQuery())));, +                assertNotNull(source.createSortedDocsProducerOrNull(reader, new BoostQuery(new IndexOrDocValuesQuery(, +                    LongPoint.newRangeQuery("number", 0, 1), new MatchAllDocsQuery()), 2.0f)));]
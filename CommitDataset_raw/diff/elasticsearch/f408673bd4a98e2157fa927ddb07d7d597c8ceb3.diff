[+++ b/src/test/java/org/elasticsearch/test/integration/ElasticsearchLuceneTestCase.java, +import org.apache.lucene.codecs.Codec;, +    private static final Codec DEFAULT_CODEC = Codec.getDefault();, +, +    /**, +     * Forcefully reset the default codec, +     */, +    public static void forceDefaultCodec() {, +        Codec.setDefault(DEFAULT_CODEC);, +    }, +++ b/src/test/java/org/elasticsearch/test/integration/ElasticsearchLuceneTestCase.java, +import org.apache.lucene.codecs.Codec;, +    private static final Codec DEFAULT_CODEC = Codec.getDefault();, +, +    /**, +     * Forcefully reset the default codec, +     */, +    public static void forceDefaultCodec() {, +        Codec.setDefault(DEFAULT_CODEC);, +    }, +++ b/src/test/java/org/elasticsearch/test/unit/index/codec/CodecTests.java, +import org.elasticsearch.test.integration.ElasticsearchLuceneTestCase;, +import org.junit.Before;, +public class CodecTests extends ElasticsearchLuceneTestCase {, +    , +    @Override, +    @Before, +    public void setUp() throws Exception {, +        super.setUp();, +        forceDefaultCodec(); // we test against default codec so never get a random one here!, +    }, +        assertThat(((ElasticSearch090PostingsFormat)postingsFormatService.get("default").get()).getDefaultWrapped(), instanceOf(((PerFieldPostingsFormat) Codec.getDefault().postingsFormat()).getPostingsFormatForField("").getClass()));]
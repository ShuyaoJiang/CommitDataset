[+++ b/core/src/main/java/org/elasticsearch/bootstrap/Bootstrap.java, +    public static void initializeNatives(Path tmpFile, boolean mlockAll, boolean systemCallFilter, boolean ctrlHandler) {, +        // enable system call filter, +        if (systemCallFilter) {, +            Natives.tryInstallSystemCallFilter(tmpFile);, +++ b/core/src/main/java/org/elasticsearch/bootstrap/Bootstrap.java, +    public static void initializeNatives(Path tmpFile, boolean mlockAll, boolean systemCallFilter, boolean ctrlHandler) {, +        // enable system call filter, +        if (systemCallFilter) {, +            Natives.tryInstallSystemCallFilter(tmpFile);, +++ b/core/src/main/java/org/elasticsearch/bootstrap/BootstrapChecks.java, +            return areSystemCallFiltersEnabled && !isSystemCallFilterInstalled();, +        boolean isSystemCallFilterInstalled() {, +            return Natives.isSystemCallFilterInstalled();, +            return isSystemCallFilterInstalled() && mightFork();, +        boolean isSystemCallFilterInstalled() {, +            return Natives.isSystemCallFilterInstalled();, +++ b/core/src/main/java/org/elasticsearch/bootstrap/Bootstrap.java, +    public static void initializeNatives(Path tmpFile, boolean mlockAll, boolean systemCallFilter, boolean ctrlHandler) {, +        // enable system call filter, +        if (systemCallFilter) {, +            Natives.tryInstallSystemCallFilter(tmpFile);, +++ b/core/src/main/java/org/elasticsearch/bootstrap/BootstrapChecks.java, +            return areSystemCallFiltersEnabled && !isSystemCallFilterInstalled();, +        boolean isSystemCallFilterInstalled() {, +            return Natives.isSystemCallFilterInstalled();, +            return isSystemCallFilterInstalled() && mightFork();, +        boolean isSystemCallFilterInstalled() {, +            return Natives.isSystemCallFilterInstalled();, +++ b/core/src/main/java/org/elasticsearch/bootstrap/BootstrapInfo.java, +     * Returns true if system call filter is installed (supported systems only), +    public static boolean isSystemCallFilterInstalled() {, +        return Natives.isSystemCallFilterInstalled();, +++ b/core/src/main/java/org/elasticsearch/bootstrap/Bootstrap.java, +    public static void initializeNatives(Path tmpFile, boolean mlockAll, boolean systemCallFilter, boolean ctrlHandler) {, +        // enable system call filter, +        if (systemCallFilter) {, +            Natives.tryInstallSystemCallFilter(tmpFile);, +++ b/core/src/main/java/org/elasticsearch/bootstrap/BootstrapChecks.java, +            return areSystemCallFiltersEnabled && !isSystemCallFilterInstalled();, +        boolean isSystemCallFilterInstalled() {, +            return Natives.isSystemCallFilterInstalled();, +            return isSystemCallFilterInstalled() && mightFork();, +        boolean isSystemCallFilterInstalled() {, +            return Natives.isSystemCallFilterInstalled();, +++ b/core/src/main/java/org/elasticsearch/bootstrap/BootstrapInfo.java, +     * Returns true if system call filter is installed (supported systems only), +    public static boolean isSystemCallFilterInstalled() {, +        return Natives.isSystemCallFilterInstalled();, +++ b/core/src/main/java/org/elasticsearch/bootstrap/JNANatives.java, +    // Set to true, in case native system call filter install was successful, +    static boolean LOCAL_SYSTEM_CALL_FILTER = false;, +    static boolean LOCAL_SYSTEM_CALL_FILTER_ALL = false;, +    static void tryInstallSystemCallFilter(Path tmpFile) {, +            int ret = SystemCallFilter.init(tmpFile);, +            LOCAL_SYSTEM_CALL_FILTER = true;, +                LOCAL_SYSTEM_CALL_FILTER_ALL = true;, +++ b/core/src/main/java/org/elasticsearch/bootstrap/Bootstrap.java, +    public static void initializeNatives(Path tmpFile, boolean mlockAll, boolean systemCallFilter, boolean ctrlHandler) {, +        // enable system call filter, +        if (systemCallFilter) {, +            Natives.tryInstallSystemCallFilter(tmpFile);, +++ b/core/src/main/java/org/elasticsearch/bootstrap/BootstrapChecks.java, +            return areSystemCallFiltersEnabled && !isSystemCallFilterInstalled();, +        boolean isSystemCallFilterInstalled() {, +            return Natives.isSystemCallFilterInstalled();, +            return isSystemCallFilterInstalled() && mightFork();, +        boolean isSystemCallFilterInstalled() {, +            return Natives.isSystemCallFilterInstalled();, +++ b/core/src/main/java/org/elasticsearch/bootstrap/BootstrapInfo.java, +     * Returns true if system call filter is installed (supported systems only), +    public static boolean isSystemCallFilterInstalled() {, +        return Natives.isSystemCallFilterInstalled();, +++ b/core/src/main/java/org/elasticsearch/bootstrap/JNANatives.java, +    // Set to true, in case native system call filter install was successful, +    static boolean LOCAL_SYSTEM_CALL_FILTER = false;, +    static boolean LOCAL_SYSTEM_CALL_FILTER_ALL = false;, +    static void tryInstallSystemCallFilter(Path tmpFile) {, +            int ret = SystemCallFilter.init(tmpFile);, +            LOCAL_SYSTEM_CALL_FILTER = true;, +                LOCAL_SYSTEM_CALL_FILTER_ALL = true;, +++ b/core/src/main/java/org/elasticsearch/bootstrap/Natives.java, +    static void tryInstallSystemCallFilter(Path tmpFile) {, +            logger.warn("cannot install system call filter because JNA is not available");, +        JNANatives.tryInstallSystemCallFilter(tmpFile);, +    static boolean isSystemCallFilterInstalled() {, +        return JNANatives.LOCAL_SYSTEM_CALL_FILTER;, +++ b/core/src/main/java/org/elasticsearch/bootstrap/Bootstrap.java, +    public static void initializeNatives(Path tmpFile, boolean mlockAll, boolean systemCallFilter, boolean ctrlHandler) {, +        // enable system call filter, +        if (systemCallFilter) {, +            Natives.tryInstallSystemCallFilter(tmpFile);, +++ b/core/src/main/java/org/elasticsearch/bootstrap/BootstrapChecks.java, +            return areSystemCallFiltersEnabled && !isSystemCallFilterInstalled();, +        boolean isSystemCallFilterInstalled() {, +            return Natives.isSystemCallFilterInstalled();, +            return isSystemCallFilterInstalled() && mightFork();, +        boolean isSystemCallFilterInstalled() {, +            return Natives.isSystemCallFilterInstalled();, +++ b/core/src/main/java/org/elasticsearch/bootstrap/BootstrapInfo.java]
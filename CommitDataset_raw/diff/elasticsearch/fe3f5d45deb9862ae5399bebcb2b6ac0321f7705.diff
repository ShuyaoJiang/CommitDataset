[+++ b/modules/elasticsearch/src/main/java/org/elasticsearch/action/admin/cluster/state/ClusterStateResponse.java, +        clusterState = ClusterState.Builder.readFrom(in, null);, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/action/admin/cluster/state/ClusterStateResponse.java, +        clusterState = ClusterState.Builder.readFrom(in, null);, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/cluster/ClusterState.java, +        public static ClusterState fromBytes(byte[] data, DiscoveryNode localNode) throws IOException {, +            return readFrom(new BytesStreamInput(data), localNode);, +        public static ClusterState readFrom(StreamInput in, @Nullable DiscoveryNode localNode) throws IOException {, +            builder.metaData = MetaData.Builder.readFrom(in);, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/action/admin/cluster/state/ClusterStateResponse.java, +        clusterState = ClusterState.Builder.readFrom(in, null);, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/cluster/ClusterState.java, +        public static ClusterState fromBytes(byte[] data, DiscoveryNode localNode) throws IOException {, +            return readFrom(new BytesStreamInput(data), localNode);, +        public static ClusterState readFrom(StreamInput in, @Nullable DiscoveryNode localNode) throws IOException {, +            builder.metaData = MetaData.Builder.readFrom(in);, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/cluster/metadata/IndexMetaData.java, +        public static IndexMetaData fromXContent(XContentParser parser) throws IOException {, +                        ImmutableSettings.Builder settingsBuilder = settingsBuilder();, +        public static IndexMetaData readFrom(StreamInput in) throws IOException {, +            builder.settings(readSettingsFromStream(in));, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/action/admin/cluster/state/ClusterStateResponse.java, +        clusterState = ClusterState.Builder.readFrom(in, null);, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/cluster/ClusterState.java, +        public static ClusterState fromBytes(byte[] data, DiscoveryNode localNode) throws IOException {, +            return readFrom(new BytesStreamInput(data), localNode);, +        public static ClusterState readFrom(StreamInput in, @Nullable DiscoveryNode localNode) throws IOException {, +            builder.metaData = MetaData.Builder.readFrom(in);, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/cluster/metadata/IndexMetaData.java, +        public static IndexMetaData fromXContent(XContentParser parser) throws IOException {, +                        ImmutableSettings.Builder settingsBuilder = settingsBuilder();, +        public static IndexMetaData readFrom(StreamInput in) throws IOException {, +            builder.settings(readSettingsFromStream(in));, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/cluster/metadata/MetaData.java, +        public static MetaData fromXContent(XContentParser parser) throws IOException {, +                            builder.put(IndexMetaData.Builder.fromXContent(parser));, +        public static MetaData readFrom(StreamInput in) throws IOException {, +                builder.put(IndexMetaData.Builder.readFrom(in));, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/action/admin/cluster/state/ClusterStateResponse.java, +        clusterState = ClusterState.Builder.readFrom(in, null);, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/cluster/ClusterState.java, +        public static ClusterState fromBytes(byte[] data, DiscoveryNode localNode) throws IOException {, +            return readFrom(new BytesStreamInput(data), localNode);, +        public static ClusterState readFrom(StreamInput in, @Nullable DiscoveryNode localNode) throws IOException {, +            builder.metaData = MetaData.Builder.readFrom(in);, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/cluster/metadata/IndexMetaData.java, +        public static IndexMetaData fromXContent(XContentParser parser) throws IOException {, +                        ImmutableSettings.Builder settingsBuilder = settingsBuilder();, +        public static IndexMetaData readFrom(StreamInput in) throws IOException {, +            builder.settings(readSettingsFromStream(in));, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/cluster/metadata/MetaData.java, +        public static MetaData fromXContent(XContentParser parser) throws IOException {, +                            builder.put(IndexMetaData.Builder.fromXContent(parser));, +        public static MetaData readFrom(StreamInput in) throws IOException {, +                builder.put(IndexMetaData.Builder.readFrom(in));, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/common/settings/ImmutableSettings.java, +    private ImmutableSettings(Map<String, String> settings, ClassLoader classLoader) {, +            retVal.put(entry.getKey(), new ImmutableSettings(Collections.unmodifiableMap(entry.getValue()), classLoader));, +            return new ImmutableSettings(Collections.unmodifiableMap(map), classLoader);, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/action/admin/cluster/state/ClusterStateResponse.java, +        clusterState = ClusterState.Builder.readFrom(in, null);, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/cluster/ClusterState.java, +        public static ClusterState fromBytes(byte[] data, DiscoveryNode localNode) throws IOException {, +            return readFrom(new BytesStreamInput(data), localNode);, +        public static ClusterState readFrom(StreamInput in, @Nullable DiscoveryNode localNode) throws IOException {, +            builder.metaData = MetaData.Builder.readFrom(in);, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/cluster/metadata/IndexMetaData.java, +        public static IndexMetaData fromXContent(XContentParser parser) throws IOException {, +                        ImmutableSettings.Builder settingsBuilder = settingsBuilder();, +        public static IndexMetaData readFrom(StreamInput in) throws IOException {, +            builder.settings(readSettingsFromStream(in));, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/cluster/metadata/MetaData.java, +        public static MetaData fromXContent(XContentParser parser) throws IOException {, +                            builder.put(IndexMetaData.Builder.fromXContent(parser));, +        public static MetaData readFrom(StreamInput in) throws IOException {, +                builder.put(IndexMetaData.Builder.readFrom(in));, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/common/settings/ImmutableSettings.java, +    private ImmutableSettings(Map<String, String> settings, ClassLoader classLoader) {, +            retVal.put(entry.getKey(), new ImmutableSettings(Collections.unmodifiableMap(entry.getValue()), classLoader));, +            return new ImmutableSettings(Collections.unmodifiableMap(map), classLoader);, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/common/settings/Settings.java, + * @author kimchy (shay.banon), +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/action/admin/cluster/state/ClusterStateResponse.java, +        clusterState = ClusterState.Builder.readFrom(in, null);, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/cluster/ClusterState.java, +        public static ClusterState fromBytes(byte[] data, DiscoveryNode localNode) throws IOException {, +            return readFrom(new BytesStreamInput(data), localNode);, +        public static ClusterState readFrom(StreamInput in, @Nullable DiscoveryNode localNode) throws IOException {, +            builder.metaData = MetaData.Builder.readFrom(in);, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/cluster/metadata/IndexMetaData.java, +        public static IndexMetaData fromXContent(XContentParser parser) throws IOException {, +                        ImmutableSettings.Builder settingsBuilder = settingsBuilder();, +        public static IndexMetaData readFrom(StreamInput in) throws IOException {, +            builder.settings(readSettingsFromStream(in));, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/cluster/metadata/MetaData.java, +        public static MetaData fromXContent(XContentParser parser) throws IOException {, +                            builder.put(IndexMetaData.Builder.fromXContent(parser));, +        public static MetaData readFrom(StreamInput in) throws IOException {, +                builder.put(IndexMetaData.Builder.readFrom(in));, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/common/settings/ImmutableSettings.java]
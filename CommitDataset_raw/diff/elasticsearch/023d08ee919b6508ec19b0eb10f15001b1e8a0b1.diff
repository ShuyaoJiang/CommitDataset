[+++ b/server/src/main/java/org/elasticsearch/search/aggregations/AggregationBuilder.java, +++ b/server/src/main/java/org/elasticsearch/search/aggregations/AggregationBuilder.java, +++ b/server/src/test/java/org/elasticsearch/search/aggregations/FiltersAggsRewriteIT.java, +import java.util.HashMap;, +import java.util.Map;, +        Map<String, Object> metadata = new HashMap<>();, +        metadata.put(randomAlphaOfLengthBetween(1, 20), randomAlphaOfLengthBetween(1, 20));, +        builder.setMetaData(metadata);, +        assertEquals(metadata, filters.getMetaData());, +++ b/server/src/main/java/org/elasticsearch/search/aggregations/AggregationBuilder.java, +++ b/server/src/test/java/org/elasticsearch/search/aggregations/FiltersAggsRewriteIT.java, +import java.util.HashMap;, +import java.util.Map;, +        Map<String, Object> metadata = new HashMap<>();, +        metadata.put(randomAlphaOfLengthBetween(1, 20), randomAlphaOfLengthBetween(1, 20));, +        builder.setMetaData(metadata);, +        assertEquals(metadata, filters.getMetaData());, +++ b/server/src/test/java/org/elasticsearch/search/aggregations/bucket/FiltersTests.java, +import java.util.Collections;, +        original.setMetaData(Collections.singletonMap(randomAlphaOfLengthBetween(1, 20), randomAlphaOfLengthBetween(1, 20)));]
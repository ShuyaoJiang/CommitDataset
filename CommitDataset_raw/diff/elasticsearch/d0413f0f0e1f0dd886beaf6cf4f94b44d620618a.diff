[+++ b/core/src/main/java/org/elasticsearch/index/IndexService.java, +        public synchronized void close() {, +++ b/core/src/main/java/org/elasticsearch/index/IndexService.java, +        public synchronized void close() {, +++ b/core/src/test/java/org/elasticsearch/index/IndexServiceTests.java, +, +        // here we need to swap first before we let it go otherwise threads might be very fast and run that task twice due to, +        // random exception and the schedule interval is 1ms, +        latch2.getAndSet(new CountDownLatch(1)).countDown();]
[+++ b/pom.xml, +                                <tests.processors>${tests.processors}</tests.processors>, +++ b/pom.xml, +                                <tests.processors>${tests.processors}</tests.processors>, +++ b/src/main/java/org/elasticsearch/common/util/concurrent/EsExecutors.java, +     * Settings key to manually set the number of available processors., +     * This is used to adjust thread pools sizes etc. per node., +     */, +    public static final String PROCESSORS = "processors";, +, +    /**, +        return settings.getAsInt(PROCESSORS, Math.min(32, Runtime.getRuntime().availableProcessors()));, +++ b/pom.xml, +                                <tests.processors>${tests.processors}</tests.processors>, +++ b/src/main/java/org/elasticsearch/common/util/concurrent/EsExecutors.java, +     * Settings key to manually set the number of available processors., +     * This is used to adjust thread pools sizes etc. per node., +     */, +    public static final String PROCESSORS = "processors";, +, +    /**, +        return settings.getAsInt(PROCESSORS, Math.min(32, Runtime.getRuntime().availableProcessors()));, +++ b/src/test/java/org/apache/lucene/util/AbstractRandomizedTest.java, +import org.elasticsearch.common.settings.ImmutableSettings;, +import org.elasticsearch.common.util.concurrent.EsExecutors;, +    public static final String SYSPROP_PROCESSORS = "tests.processors";, +, +    public static final int TESTS_PROCESSORS;, +, +, +        String processors = System.getProperty(SYSPROP_PROCESSORS, ""); // mvn sets "" as default, +        if (processors == null || processors.isEmpty()) {, +            processors = Integer.toString(EsExecutors.boundedNumberOfProcessors(ImmutableSettings.EMPTY));, +        }, +        TESTS_PROCESSORS = Integer.parseInt(processors);, +++ b/pom.xml, +                                <tests.processors>${tests.processors}</tests.processors>, +++ b/src/main/java/org/elasticsearch/common/util/concurrent/EsExecutors.java, +     * Settings key to manually set the number of available processors., +     * This is used to adjust thread pools sizes etc. per node., +     */, +    public static final String PROCESSORS = "processors";, +, +    /**, +        return settings.getAsInt(PROCESSORS, Math.min(32, Runtime.getRuntime().availableProcessors()));, +++ b/src/test/java/org/apache/lucene/util/AbstractRandomizedTest.java, +import org.elasticsearch.common.settings.ImmutableSettings;, +import org.elasticsearch.common.util.concurrent.EsExecutors;, +    public static final String SYSPROP_PROCESSORS = "tests.processors";, +, +    public static final int TESTS_PROCESSORS;, +, +, +        String processors = System.getProperty(SYSPROP_PROCESSORS, ""); // mvn sets "" as default, +        if (processors == null || processors.isEmpty()) {, +            processors = Integer.toString(EsExecutors.boundedNumberOfProcessors(ImmutableSettings.EMPTY));, +        }, +        TESTS_PROCESSORS = Integer.parseInt(processors);, +++ b/src/test/java/org/elasticsearch/test/TestCluster.java, +import org.apache.lucene.util.AbstractRandomizedTest;, +        if (random.nextInt(10) == 0) {, +            builder.put(EsExecutors.PROCESSORS, 1 + random.nextInt(AbstractRandomizedTest.TESTS_PROCESSORS));, +        } else {, +            builder.put(EsExecutors.PROCESSORS, AbstractRandomizedTest.TESTS_PROCESSORS);, +        }, +++ b/pom.xml, +                                <tests.processors>${tests.processors}</tests.processors>, +++ b/src/main/java/org/elasticsearch/common/util/concurrent/EsExecutors.java, +     * Settings key to manually set the number of available processors., +     * This is used to adjust thread pools sizes etc. per node., +     */, +    public static final String PROCESSORS = "processors";, +, +    /**, +        return settings.getAsInt(PROCESSORS, Math.min(32, Runtime.getRuntime().availableProcessors()));, +++ b/src/test/java/org/apache/lucene/util/AbstractRandomizedTest.java, +import org.elasticsearch.common.settings.ImmutableSettings;, +import org.elasticsearch.common.util.concurrent.EsExecutors;, +    public static final String SYSPROP_PROCESSORS = "tests.processors";, +, +    public static final int TESTS_PROCESSORS;, +, +, +        String processors = System.getProperty(SYSPROP_PROCESSORS, ""); // mvn sets "" as default, +        if (processors == null || processors.isEmpty()) {, +            processors = Integer.toString(EsExecutors.boundedNumberOfProcessors(ImmutableSettings.EMPTY));, +        }, +        TESTS_PROCESSORS = Integer.parseInt(processors);, +++ b/src/test/java/org/elasticsearch/test/TestCluster.java, +import org.apache.lucene.util.AbstractRandomizedTest;, +        if (random.nextInt(10) == 0) {, +            builder.put(EsExecutors.PROCESSORS, 1 + random.nextInt(AbstractRandomizedTest.TESTS_PROCESSORS));, +        } else {, +            builder.put(EsExecutors.PROCESSORS, AbstractRandomizedTest.TESTS_PROCESSORS);, +        }, +++ b/src/test/java/org/elasticsearch/test/junit/listeners/ReproduceInfoPrinter.java, +import org.apache.lucene.util.AbstractRandomizedTest;, +            appendOpt(AbstractRandomizedTest.SYSPROP_PROCESSORS, Integer.toString(AbstractRandomizedTest.TESTS_PROCESSORS));]
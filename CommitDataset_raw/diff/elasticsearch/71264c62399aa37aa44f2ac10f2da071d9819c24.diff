[+++ b/core/src/main/java/org/elasticsearch/index/analysis/PatternAnalyzer.java, +, +    @Override, +    protected TokenStream normalize(String fieldName, TokenStream in) {, +        TokenStream stream = in;, +        if (lowercase) {, +            stream = new LowerCaseFilter(stream);, +        }, +        return stream;, +    }, +++ b/core/src/main/java/org/elasticsearch/index/analysis/PatternAnalyzer.java, +, +    @Override, +    protected TokenStream normalize(String fieldName, TokenStream in) {, +        TokenStream stream = in;, +        if (lowercase) {, +            stream = new LowerCaseFilter(stream);, +        }, +        return stream;, +    }, +++ b/core/src/test/java/org/elasticsearch/index/analysis/PatternAnalyzerTests.java, +import org.apache.lucene.util.BytesRef;, +, +  public void testNormalize() {, +      PatternAnalyzer a = new PatternAnalyzer(Pattern.compile("\\s+"), false, null);, +      assertEquals(new BytesRef("FooBar"), a.normalize("dummy", "FooBar"));, +      a = new PatternAnalyzer(Pattern.compile("\\s+"), true, null);, +      assertEquals(new BytesRef("foobar"), a.normalize("dummy", "FooBar"));, +  }]
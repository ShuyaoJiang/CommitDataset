[+++ b/modules/lang-painless/src/main/java/org/elasticsearch/painless/Def.java, +    /** factory for arraylength MethodHandle (intrinsic) from Java 9 (pkg-private for tests) */, +    static final MethodHandle JAVA9_ARRAY_LENGTH_MH_FACTORY;, +++ b/modules/lang-painless/src/main/java/org/elasticsearch/painless/Def.java, +    /** factory for arraylength MethodHandle (intrinsic) from Java 9 (pkg-private for tests) */, +    static final MethodHandle JAVA9_ARRAY_LENGTH_MH_FACTORY;, +++ b/modules/lang-painless/src/test/java/org/elasticsearch/painless/ArrayTests.java, +import org.apache.lucene.util.Constants;, +        assertEquals(Constants.JRE_IS_MINIMUM_JAVA9, Def.JAVA9_ARRAY_LENGTH_MH_FACTORY != null);, +++ b/modules/lang-painless/src/main/java/org/elasticsearch/painless/Def.java, +    /** factory for arraylength MethodHandle (intrinsic) from Java 9 (pkg-private for tests) */, +    static final MethodHandle JAVA9_ARRAY_LENGTH_MH_FACTORY;, +++ b/modules/lang-painless/src/test/java/org/elasticsearch/painless/ArrayTests.java, +import org.apache.lucene.util.Constants;, +        assertEquals(Constants.JRE_IS_MINIMUM_JAVA9, Def.JAVA9_ARRAY_LENGTH_MH_FACTORY != null);, +++ b/modules/lang-painless/src/test/java/org/elasticsearch/painless/StringTests.java, +import org.apache.lucene.util.Constants;, +, +    , +    public void testJava9StringConcatBytecode() {, +        assumeTrue("Needs Java 9 to test indified String concat", Constants.JRE_IS_MINIMUM_JAVA9);, +        assertNotNull(WriterConstants.INDY_STRING_CONCAT_BOOTSTRAP_HANDLE);, +        assertBytecodeExists("String s = \"cat\"; return s + true + 'abc' + null;", , +                "INVOKEDYNAMIC concat(Ljava/lang/String;ZLjava/lang/String;Ljava/lang/Object;)Ljava/lang/String;");, +    }]
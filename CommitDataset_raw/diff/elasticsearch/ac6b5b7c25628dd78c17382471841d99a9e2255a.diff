[+++ b/elasticsearch/x-pack/marvel/src/main/java/org/elasticsearch/marvel/cleaner/CleanerService.java, +import org.elasticsearch.common.util.concurrent.AbstractLifecycleRunnable;, +            return globalRetention;, +            return MarvelSettings.HISTORY_DURATION.getDefault(Settings.EMPTY);, +    class IndicesCleaner extends AbstractLifecycleRunnable {, +        /**, +         * Enable automatic logging and stopping of the runnable based on the {@link #lifecycle}., +         */, +        public IndicesCleaner() {, +            super(lifecycle, logger);, +, +        @Override, +        protected void doRunInLifecycle() throws Exception {, +        protected void onAfterInLifecycle() {, +     * Schedule task so that it will be executed everyday at the next 01:00 AM., +            // if it's not after now, then it needs to be the next day!, +            if (next.isAfter(now) == false) {]
[+++ b/src/main/java/org/elasticsearch/index/shard/service/InternalIndexShard.java, +        verifyNotClosed();, +            throw new IllegalIndexShardStateException(shardId, state, "operations only allowed when started/relocated");, +            throw new IllegalIndexShardStateException(shardId, state, "operation only allowed when started/recovering");, +        }, +    }, +, +    private void verifyNotClosed() throws IllegalIndexShardStateException {, +        IndexShardState state = this.state; // one time volatile read, +        if (state == IndexShardState.CLOSED) {, +            throw new IllegalIndexShardStateException(shardId, state, "operation only allowed when not closed");]
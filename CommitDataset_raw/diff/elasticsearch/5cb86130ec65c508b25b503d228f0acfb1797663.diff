[+++ b/core/src/main/java/org/elasticsearch/action/admin/cluster/stats/ClusterStatsIndices.java, +                ShardStats indexShardStats = countsPerIndex.get(shardStats.getShardRouting().getIndex());, +                    countsPerIndex.put(shardStats.getShardRouting().getIndex(), indexShardStats);, +++ b/core/src/main/java/org/elasticsearch/action/admin/cluster/stats/ClusterStatsIndices.java, +                ShardStats indexShardStats = countsPerIndex.get(shardStats.getShardRouting().getIndex());, +                    countsPerIndex.put(shardStats.getShardRouting().getIndex(), indexShardStats);, +++ /dev/null, +++ b/core/src/main/java/org/elasticsearch/action/admin/cluster/stats/ClusterStatsIndices.java, +                ShardStats indexShardStats = countsPerIndex.get(shardStats.getShardRouting().getIndex());, +                    countsPerIndex.put(shardStats.getShardRouting().getIndex(), indexShardStats);, +++ /dev/null, +++ /dev/null, +++ b/core/src/main/java/org/elasticsearch/action/admin/cluster/stats/ClusterStatsIndices.java, +                ShardStats indexShardStats = countsPerIndex.get(shardStats.getShardRouting().getIndex());, +                    countsPerIndex.put(shardStats.getShardRouting().getIndex(), indexShardStats);, +++ /dev/null, +++ /dev/null, +++ b/core/src/main/java/org/elasticsearch/action/admin/indices/cache/clear/TransportClearIndicesCacheAction.java, +import org.elasticsearch.action.support.broadcast.node.TransportBroadcastByNodeAction;, +import org.elasticsearch.cluster.routing.ShardsIterator;, +import org.elasticsearch.common.io.stream.StreamInput;, +import java.io.IOException;, +, +public class TransportClearIndicesCacheAction extends TransportBroadcastByNodeAction<ClearIndicesCacheRequest, ClearIndicesCacheResponse, TransportBroadcastByNodeAction.EmptyResult> {, +                ClearIndicesCacheRequest.class, ThreadPool.Names.MANAGEMENT);, +    protected EmptyResult readShardResult(StreamInput in) throws IOException {, +        return EmptyResult.readEmptyResultFrom(in);, +    protected ClearIndicesCacheResponse newResponse(ClearIndicesCacheRequest request, int totalShards, int successfulShards, int failedShards, List<EmptyResult> responses, List<ShardOperationFailedException> shardFailures) {, +        return new ClearIndicesCacheResponse(totalShards, successfulShards, failedShards, shardFailures);, +    protected ClearIndicesCacheRequest readRequestFrom(StreamInput in) throws IOException {, +        final ClearIndicesCacheRequest request = new ClearIndicesCacheRequest();, +        request.readFrom(in);, +        return request;, +    protected EmptyResult shardOperation(ClearIndicesCacheRequest request, ShardRouting shardRouting) {, +        IndexService service = indicesService.indexService(shardRouting.getIndex());, +            IndexShard shard = service.shard(shardRouting.id());, +        return EmptyResult.INSTANCE;, +    protected ShardsIterator shards(ClusterState clusterState, ClearIndicesCacheRequest request, String[] concreteIndices) {, +        return clusterState.routingTable().allShards(concreteIndices);, +++ b/core/src/main/java/org/elasticsearch/action/admin/cluster/stats/ClusterStatsIndices.java, +                ShardStats indexShardStats = countsPerIndex.get(shardStats.getShardRouting().getIndex());, +                    countsPerIndex.put(shardStats.getShardRouting().getIndex(), indexShardStats);, +++ /dev/null, +++ /dev/null, +++ b/core/src/main/java/org/elasticsearch/action/admin/indices/cache/clear/TransportClearIndicesCacheAction.java, +import org.elasticsearch.action.support.broadcast.node.TransportBroadcastByNodeAction;, +import org.elasticsearch.cluster.routing.ShardsIterator;, +import org.elasticsearch.common.io.stream.StreamInput;, +import java.io.IOException;, +, +public class TransportClearIndicesCacheAction extends TransportBroadcastByNodeAction<ClearIndicesCacheRequest, ClearIndicesCacheResponse, TransportBroadcastByNodeAction.EmptyResult> {, +                ClearIndicesCacheRequest.class, ThreadPool.Names.MANAGEMENT);, +    protected EmptyResult readShardResult(StreamInput in) throws IOException {, +        return EmptyResult.readEmptyResultFrom(in);, +    protected ClearIndicesCacheResponse newResponse(ClearIndicesCacheRequest request, int totalShards, int successfulShards, int failedShards, List<EmptyResult> responses, List<ShardOperationFailedException> shardFailures) {, +        return new ClearIndicesCacheResponse(totalShards, successfulShards, failedShards, shardFailures);, +    protected ClearIndicesCacheRequest readRequestFrom(StreamInput in) throws IOException {, +        final ClearIndicesCacheRequest request = new ClearIndicesCacheRequest();, +        request.readFrom(in);, +        return request;, +    protected EmptyResult shardOperation(ClearIndicesCacheRequest request, ShardRouting shardRouting) {, +        IndexService service = indicesService.indexService(shardRouting.getIndex());, +            IndexShard shard = service.shard(shardRouting.id());, +        return EmptyResult.INSTANCE;, +    protected ShardsIterator shards(ClusterState clusterState, ClearIndicesCacheRequest request, String[] concreteIndices) {, +        return clusterState.routingTable().allShards(concreteIndices);, +++ /dev/null, +++ b/core/src/main/java/org/elasticsearch/action/admin/cluster/stats/ClusterStatsIndices.java, +                ShardStats indexShardStats = countsPerIndex.get(shardStats.getShardRouting().getIndex());, +                    countsPerIndex.put(shardStats.getShardRouting().getIndex(), indexShardStats);, +++ /dev/null, +++ /dev/null, +++ b/core/src/main/java/org/elasticsearch/action/admin/indices/cache/clear/TransportClearIndicesCacheAction.java, +import org.elasticsearch.action.support.broadcast.node.TransportBroadcastByNodeAction;, +import org.elasticsearch.cluster.routing.ShardsIterator;, +import org.elasticsearch.common.io.stream.StreamInput;, +import java.io.IOException;, +, +public class TransportClearIndicesCacheAction extends TransportBroadcastByNodeAction<ClearIndicesCacheRequest, ClearIndicesCacheResponse, TransportBroadcastByNodeAction.EmptyResult> {, +                ClearIndicesCacheRequest.class, ThreadPool.Names.MANAGEMENT);, +    protected EmptyResult readShardResult(StreamInput in) throws IOException {, +        return EmptyResult.readEmptyResultFrom(in);, +    protected ClearIndicesCacheResponse newResponse(ClearIndicesCacheRequest request, int totalShards, int successfulShards, int failedShards, List<EmptyResult> responses, List<ShardOperationFailedException> shardFailures) {, +        return new ClearIndicesCacheResponse(totalShards, successfulShards, failedShards, shardFailures);, +    protected ClearIndicesCacheRequest readRequestFrom(StreamInput in) throws IOException {, +        final ClearIndicesCacheRequest request = new ClearIndicesCacheRequest();, +        request.readFrom(in);, +        return request;, +    protected EmptyResult shardOperation(ClearIndicesCacheRequest request, ShardRouting shardRouting) {, +        IndexService service = indicesService.indexService(shardRouting.getIndex());, +            IndexShard shard = service.shard(shardRouting.id());, +        return EmptyResult.INSTANCE;, +    protected ShardsIterator shards(ClusterState clusterState, ClearIndicesCacheRequest request, String[] concreteIndices) {, +        return clusterState.routingTable().allShards(concreteIndices);, +++ /dev/null, +++ /dev/null, +++ b/core/src/main/java/org/elasticsearch/action/admin/cluster/stats/ClusterStatsIndices.java, +                ShardStats indexShardStats = countsPerIndex.get(shardStats.getShardRouting().getIndex());, +                    countsPerIndex.put(shardStats.getShardRouting().getIndex(), indexShardStats);, +++ /dev/null]
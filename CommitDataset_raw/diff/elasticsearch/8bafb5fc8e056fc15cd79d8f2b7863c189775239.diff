[+++ b/src/main/java/org/elasticsearch/index/cache/IndexCache.java, +    /**, +     * Return the {@link FixedBitSetFilterCache} for this index., +     */, +    public FixedBitSetFilterCache fixedBitSetFilterCache() {, +        return fixedBitSetFilterCache;, +    }, +, +++ b/src/main/java/org/elasticsearch/index/cache/IndexCache.java, +    /**, +     * Return the {@link FixedBitSetFilterCache} for this index., +     */, +    public FixedBitSetFilterCache fixedBitSetFilterCache() {, +        return fixedBitSetFilterCache;, +    }, +, +++ b/src/main/java/org/elasticsearch/index/engine/Engine.java, +import org.elasticsearch.index.cache.fixedbitset.FixedBitSetFilter;, +        private final FixedBitSetFilter parentFilter;, +        public DeleteByQuery(Query query, BytesReference source, @Nullable String[] filteringAliases, @Nullable Filter aliasFilter, FixedBitSetFilter parentFilter, Operation.Origin origin, long startTime, String... types) {, +        public FixedBitSetFilter parentFilter() {, +++ b/src/main/java/org/elasticsearch/index/cache/IndexCache.java, +    /**, +     * Return the {@link FixedBitSetFilterCache} for this index., +     */, +    public FixedBitSetFilterCache fixedBitSetFilterCache() {, +        return fixedBitSetFilterCache;, +    }, +, +++ b/src/main/java/org/elasticsearch/index/engine/Engine.java, +import org.elasticsearch.index.cache.fixedbitset.FixedBitSetFilter;, +        private final FixedBitSetFilter parentFilter;, +        public DeleteByQuery(Query query, BytesReference source, @Nullable String[] filteringAliases, @Nullable Filter aliasFilter, FixedBitSetFilter parentFilter, Operation.Origin origin, long startTime, String... types) {, +        public FixedBitSetFilter parentFilter() {, +++ b/src/main/java/org/elasticsearch/index/search/nested/IncludeNestedDocsQuery.java, +import org.elasticsearch.index.cache.fixedbitset.FixedBitSetFilter;, +    private final FixedBitSetFilter parentFilter;, +    public IncludeNestedDocsQuery(Query parentQuery, FixedBitSetFilter parentFilter) {, +        private final FixedBitSetFilter parentsFilter;, +        IncludeNestedDocsWeight(Query parentQuery, Weight parentWeight, FixedBitSetFilter parentsFilter) {, +            FixedBitSet parents = parentsFilter.getDocIdSet(context, acceptDocs);, +++ b/src/main/java/org/elasticsearch/index/cache/IndexCache.java, +    /**, +     * Return the {@link FixedBitSetFilterCache} for this index., +     */, +    public FixedBitSetFilterCache fixedBitSetFilterCache() {, +        return fixedBitSetFilterCache;, +    }, +, +++ b/src/main/java/org/elasticsearch/index/engine/Engine.java, +import org.elasticsearch.index.cache.fixedbitset.FixedBitSetFilter;, +        private final FixedBitSetFilter parentFilter;, +        public DeleteByQuery(Query query, BytesReference source, @Nullable String[] filteringAliases, @Nullable Filter aliasFilter, FixedBitSetFilter parentFilter, Operation.Origin origin, long startTime, String... types) {, +        public FixedBitSetFilter parentFilter() {, +++ b/src/main/java/org/elasticsearch/index/search/nested/IncludeNestedDocsQuery.java, +import org.elasticsearch.index.cache.fixedbitset.FixedBitSetFilter;, +    private final FixedBitSetFilter parentFilter;, +    public IncludeNestedDocsQuery(Query parentQuery, FixedBitSetFilter parentFilter) {, +        private final FixedBitSetFilter parentsFilter;, +        IncludeNestedDocsWeight(Query parentQuery, Weight parentWeight, FixedBitSetFilter parentsFilter) {, +            FixedBitSet parents = parentsFilter.getDocIdSet(context, acceptDocs);, +++ b/src/main/java/org/elasticsearch/index/shard/service/InternalIndexShard.java, +import org.elasticsearch.index.cache.fixedbitset.FixedBitSetFilter;, +import org.elasticsearch.index.cache.fixedbitset.ShardFixedBitSetFilterCache;, +        FixedBitSetFilter parentFilter = mapperService.hasNested() ? indexCache.fixedBitSetFilterCache().getFixedBitSetFilter(NonNestedDocsFilter.INSTANCE) : null;]
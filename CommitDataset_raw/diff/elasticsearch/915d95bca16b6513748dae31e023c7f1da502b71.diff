[+++ b/plugin/src/main/java/org/elasticsearch/xpack/security/audit/AuditTrailService.java, +    public void accessGranted(User user, String action, TransportMessage message, String[] roleNames,, +                              @Nullable Set<String> specificIndices) {, +    public void accessDenied(User user, String action, TransportMessage message, String[] roleNames,, +                             @Nullable Set<String> specificIndices) {, +++ b/plugin/src/main/java/org/elasticsearch/xpack/security/audit/AuditTrailService.java, +    public void accessGranted(User user, String action, TransportMessage message, String[] roleNames,, +                              @Nullable Set<String> specificIndices) {, +    public void accessDenied(User user, String action, TransportMessage message, String[] roleNames,, +                             @Nullable Set<String> specificIndices) {, +++ b/plugin/src/test/java/org/elasticsearch/xpack/security/authz/AuthorizationServiceTests.java, +        verify(auditTrail).accessDenied(SystemUser.INSTANCE, "cluster:admin/whatever", request, new String[] { SystemUser.ROLE_NAME },, +                null);]
[+++ b/core/src/main/java/org/elasticsearch/plugins/InstallPluginCommand.java, +    static final Set<PosixFilePermission> BIN_DIR_PERMS;, +    static final Set<PosixFilePermission> BIN_FILES_PERMS;, +    static final Set<PosixFilePermission> CONFIG_DIR_PERMS;, +    static final Set<PosixFilePermission> CONFIG_FILES_PERMS;, +    static final Set<PosixFilePermission> PLUGIN_DIR_PERMS;, +    static final Set<PosixFilePermission> PLUGIN_FILES_PERMS;, +        // Bin directory get chmod 755, +        BIN_DIR_PERMS = Collections.unmodifiableSet(PosixFilePermissions.fromString("rwxr-xr-x"));, +        // Bin files also get chmod 755, +        BIN_FILES_PERMS = BIN_DIR_PERMS;, +, +        // Config directory get chmod 750, +        CONFIG_DIR_PERMS = Collections.unmodifiableSet(PosixFilePermissions.fromString("rwxr-x---"));, +, +        // Config files get chmod 660, +        CONFIG_FILES_PERMS = Collections.unmodifiableSet(PosixFilePermissions.fromString("rw-rw----"));, +, +        // Plugin directory get chmod 755, +        PLUGIN_DIR_PERMS = BIN_DIR_PERMS;, +, +        // Plugins files get chmod 644, +        PLUGIN_FILES_PERMS = Collections.unmodifiableSet(PosixFilePermissions.fromString("rw-r--r--"));, +            return Files.createTempDirectory(pluginsDir, ".installing-", PosixFilePermissions.asFileAttribute(PLUGIN_DIR_PERMS));, +                        setFileAttributes(pluginFile, PLUGIN_DIR_PERMS);, +                        setFileAttributes(pluginFile, PLUGIN_FILES_PERMS);, +        setFileAttributes(destBinDir, BIN_DIR_PERMS);, +                setFileAttributes(destFile, BIN_FILES_PERMS);, +        setFileAttributes(destConfigDir, CONFIG_DIR_PERMS);, +                    setFileAttributes(destFile, CONFIG_FILES_PERMS);, +++ b/core/src/main/java/org/elasticsearch/plugins/InstallPluginCommand.java, +    static final Set<PosixFilePermission> BIN_DIR_PERMS;, +    static final Set<PosixFilePermission> BIN_FILES_PERMS;, +    static final Set<PosixFilePermission> CONFIG_DIR_PERMS;, +    static final Set<PosixFilePermission> CONFIG_FILES_PERMS;, +    static final Set<PosixFilePermission> PLUGIN_DIR_PERMS;, +    static final Set<PosixFilePermission> PLUGIN_FILES_PERMS;, +        // Bin directory get chmod 755, +        BIN_DIR_PERMS = Collections.unmodifiableSet(PosixFilePermissions.fromString("rwxr-xr-x"));, +        // Bin files also get chmod 755, +        BIN_FILES_PERMS = BIN_DIR_PERMS;, +, +        // Config directory get chmod 750, +        CONFIG_DIR_PERMS = Collections.unmodifiableSet(PosixFilePermissions.fromString("rwxr-x---"));, +, +        // Config files get chmod 660, +        CONFIG_FILES_PERMS = Collections.unmodifiableSet(PosixFilePermissions.fromString("rw-rw----"));, +, +        // Plugin directory get chmod 755, +        PLUGIN_DIR_PERMS = BIN_DIR_PERMS;, +, +        // Plugins files get chmod 644, +        PLUGIN_FILES_PERMS = Collections.unmodifiableSet(PosixFilePermissions.fromString("rw-r--r--"));, +            return Files.createTempDirectory(pluginsDir, ".installing-", PosixFilePermissions.asFileAttribute(PLUGIN_DIR_PERMS));, +                        setFileAttributes(pluginFile, PLUGIN_DIR_PERMS);, +                        setFileAttributes(pluginFile, PLUGIN_FILES_PERMS);, +        setFileAttributes(destBinDir, BIN_DIR_PERMS);, +                setFileAttributes(destFile, BIN_FILES_PERMS);, +        setFileAttributes(destConfigDir, CONFIG_DIR_PERMS);, +                    setFileAttributes(destFile, CONFIG_FILES_PERMS);, +++ b/distribution/build.gradle, +        dirMode 0750, +        fileMode 0660, + *, + * The following commands are useful when it comes to check the user/group, + * and files permissions set within the RPM and DEB packages:, + *, + *    rpm -qlp --dump path/to/elasticsearch.rpm, + *    dpkg -c path/to/elasticsearch.deb, +      dirMode 0750, +      fileMode 0660, +      fileMode 0750, +      fileMode 0660, +    Closure suckUpEmptyDirectories = { path, u, g, mode ->, +        dirMode mode, +        fileMode mode, +    suckUpEmptyDirectories('/var/run', 'elasticsearch', 'elasticsearch', 0755), +    suckUpEmptyDirectories('/var/log', 'elasticsearch', 'elasticsearch', 0750), +    suckUpEmptyDirectories('/var/lib', 'elasticsearch', 'elasticsearch', 0750), +    suckUpEmptyDirectories('/usr/share/elasticsearch', 'root', 'root', 0755), +++ b/core/src/main/java/org/elasticsearch/plugins/InstallPluginCommand.java, +    static final Set<PosixFilePermission> BIN_DIR_PERMS;, +    static final Set<PosixFilePermission> BIN_FILES_PERMS;, +    static final Set<PosixFilePermission> CONFIG_DIR_PERMS;, +    static final Set<PosixFilePermission> CONFIG_FILES_PERMS;, +    static final Set<PosixFilePermission> PLUGIN_DIR_PERMS;, +    static final Set<PosixFilePermission> PLUGIN_FILES_PERMS;, +        // Bin directory get chmod 755, +        BIN_DIR_PERMS = Collections.unmodifiableSet(PosixFilePermissions.fromString("rwxr-xr-x"));, +        // Bin files also get chmod 755, +        BIN_FILES_PERMS = BIN_DIR_PERMS;, +, +        // Config directory get chmod 750, +        CONFIG_DIR_PERMS = Collections.unmodifiableSet(PosixFilePermissions.fromString("rwxr-x---"));, +, +        // Config files get chmod 660, +        CONFIG_FILES_PERMS = Collections.unmodifiableSet(PosixFilePermissions.fromString("rw-rw----"));, +, +        // Plugin directory get chmod 755, +        PLUGIN_DIR_PERMS = BIN_DIR_PERMS;]
[+++ b/rest-api-spec/src/main/resources/rest-api-spec/test/indices.flush/10_basic.yml, +, +---, +"Flush stats":, +  - skip:, +      version: " - 6.99.99", +      reason: periodic flush stats is introduced in 7.0, +  - do:, +      indices.create:, +        index: test, +        body:, +          settings:, +            number_of_shards: 1, +            index.translog.flush_threshold_size: 160b, +  - do:, +      indices.flush:, +        index: test, +  - do:, +      indices.stats: { index: test }, +  - match: { indices.test.primaries.flush.periodic: 0 }, +  - match: { indices.test.primaries.flush.total:    1 }, +  - do:, +      index:, +        index: test, +        type:  doc, +        id:    1, +        body:  { "message": "a long message to make a periodic flush happen after this index operation" }, +  - do:, +      indices.stats: { index: test }, +  # periodic flush is async, +  - gte: { indices.test.primaries.flush.periodic: 0 }, +  - gte: { indices.test.primaries.flush.total:    1 }, +++ b/rest-api-spec/src/main/resources/rest-api-spec/test/indices.flush/10_basic.yml, +, +---, +"Flush stats":, +  - skip:, +      version: " - 6.99.99", +      reason: periodic flush stats is introduced in 7.0, +  - do:, +      indices.create:, +        index: test, +        body:, +          settings:, +            number_of_shards: 1, +            index.translog.flush_threshold_size: 160b, +  - do:, +      indices.flush:, +        index: test, +  - do:, +      indices.stats: { index: test }, +  - match: { indices.test.primaries.flush.periodic: 0 }, +  - match: { indices.test.primaries.flush.total:    1 }, +  - do:, +      index:, +        index: test, +        type:  doc, +        id:    1, +        body:  { "message": "a long message to make a periodic flush happen after this index operation" }, +  - do:, +      indices.stats: { index: test }, +  # periodic flush is async, +  - gte: { indices.test.primaries.flush.periodic: 0 }, +  - gte: { indices.test.primaries.flush.total:    1 }, +++ b/server/src/main/java/org/elasticsearch/index/flush/FlushStats.java, +import org.elasticsearch.Version;, +    private long periodic;, +    public FlushStats(long total, long periodic, long totalTimeInMillis) {, +        this.periodic = periodic;, +    public void add(long total, long periodic, long totalTimeInMillis) {, +        this.periodic += periodic;, +        this.periodic += flushStats.periodic;, +     * The number of flushes that were periodically triggered when translog exceeded the flush threshold., +     */, +    public long getPeriodic() {, +        return periodic;, +    }, +, +    /**, +        builder.field(Fields.PERIODIC, periodic);, +        static final String PERIODIC = "periodic";, +        if (in.getVersion().onOrAfter(Version.V_7_0_0_alpha1)) {, +            periodic = in.readVLong();, +        }, +        if (out.getVersion().onOrAfter(Version.V_7_0_0_alpha1)) {, +            out.writeVLong(periodic);, +        }, +++ b/rest-api-spec/src/main/resources/rest-api-spec/test/indices.flush/10_basic.yml, +, +---, +"Flush stats":, +  - skip:, +      version: " - 6.99.99", +      reason: periodic flush stats is introduced in 7.0, +  - do:, +      indices.create:, +        index: test, +        body:, +          settings:, +            number_of_shards: 1]
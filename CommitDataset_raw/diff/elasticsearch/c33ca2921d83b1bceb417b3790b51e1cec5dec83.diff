[+++ b/src/main/java/org/elasticsearch/search/facet/AbstractFacetCollector.java, +    public Filter getAndClearFilter() {, +        Filter filter = this.filter;, +        this.filter = null;, +        return filter;, +    }, +, +++ b/src/main/java/org/elasticsearch/search/facet/AbstractFacetCollector.java, +    public Filter getAndClearFilter() {, +        Filter filter = this.filter;, +        this.filter = null;, +        return filter;, +    }, +, +++ b/src/main/java/org/elasticsearch/search/facet/FacetPhase.java, +                            // we can clear the filter, since we are anyhow going to iterate over it, +                            // so no need to double check it..., +                            filter = facetCollector.getAndClearFilter();]
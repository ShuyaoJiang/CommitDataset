[+++ b/core/src/main/java/org/elasticsearch/bootstrap/Bootstrap.java, +import org.elasticsearch.cli.ExitCodes;, +import org.elasticsearch.common.logging.DeprecationLogger;, +import java.util.Locale;, +import java.util.Objects;, +                BootstrapSettings.SYSTEM_CALL_FILTER_SETTING.get(settings),, +++ b/core/src/main/java/org/elasticsearch/bootstrap/Bootstrap.java, +import org.elasticsearch.cli.ExitCodes;, +import org.elasticsearch.common.logging.DeprecationLogger;, +import java.util.Locale;, +import java.util.Objects;, +                BootstrapSettings.SYSTEM_CALL_FILTER_SETTING.get(settings),, +++ b/core/src/main/java/org/elasticsearch/bootstrap/BootstrapChecks.java, +        checks.add(new SystemCallFilterCheck(BootstrapSettings.SYSTEM_CALL_FILTER_SETTING.get(settings)));, +                BootstrapSettings.SYSTEM_CALL_FILTER_SETTING.getKey());, +                BootstrapSettings.SYSTEM_CALL_FILTER_SETTING.getKey());, +++ b/core/src/main/java/org/elasticsearch/bootstrap/Bootstrap.java, +import org.elasticsearch.cli.ExitCodes;, +import org.elasticsearch.common.logging.DeprecationLogger;, +import java.util.Locale;, +import java.util.Objects;, +                BootstrapSettings.SYSTEM_CALL_FILTER_SETTING.get(settings),, +++ b/core/src/main/java/org/elasticsearch/bootstrap/BootstrapChecks.java, +        checks.add(new SystemCallFilterCheck(BootstrapSettings.SYSTEM_CALL_FILTER_SETTING.get(settings)));, +                BootstrapSettings.SYSTEM_CALL_FILTER_SETTING.getKey());, +                BootstrapSettings.SYSTEM_CALL_FILTER_SETTING.getKey());, +++ b/core/src/main/java/org/elasticsearch/bootstrap/BootstrapSettings.java, +    public static final Setting<Boolean> SYSTEM_CALL_FILTER_SETTING =, +        Setting.boolSetting("bootstrap.system_call_filter", true, Property.NodeScope);, +++ b/core/src/main/java/org/elasticsearch/bootstrap/Bootstrap.java, +import org.elasticsearch.cli.ExitCodes;, +import org.elasticsearch.common.logging.DeprecationLogger;, +import java.util.Locale;, +import java.util.Objects;, +                BootstrapSettings.SYSTEM_CALL_FILTER_SETTING.get(settings),, +++ b/core/src/main/java/org/elasticsearch/bootstrap/BootstrapChecks.java, +        checks.add(new SystemCallFilterCheck(BootstrapSettings.SYSTEM_CALL_FILTER_SETTING.get(settings)));, +                BootstrapSettings.SYSTEM_CALL_FILTER_SETTING.getKey());, +                BootstrapSettings.SYSTEM_CALL_FILTER_SETTING.getKey());, +++ b/core/src/main/java/org/elasticsearch/bootstrap/BootstrapSettings.java, +    public static final Setting<Boolean> SYSTEM_CALL_FILTER_SETTING =, +        Setting.boolSetting("bootstrap.system_call_filter", true, Property.NodeScope);, +++ b/core/src/main/java/org/elasticsearch/common/settings/ClusterSettings.java, +                    BootstrapSettings.SYSTEM_CALL_FILTER_SETTING,, +++ b/core/src/main/java/org/elasticsearch/bootstrap/Bootstrap.java, +import org.elasticsearch.cli.ExitCodes;, +import org.elasticsearch.common.logging.DeprecationLogger;, +import java.util.Locale;, +import java.util.Objects;, +                BootstrapSettings.SYSTEM_CALL_FILTER_SETTING.get(settings),, +++ b/core/src/main/java/org/elasticsearch/bootstrap/BootstrapChecks.java, +        checks.add(new SystemCallFilterCheck(BootstrapSettings.SYSTEM_CALL_FILTER_SETTING.get(settings)));, +                BootstrapSettings.SYSTEM_CALL_FILTER_SETTING.getKey());, +                BootstrapSettings.SYSTEM_CALL_FILTER_SETTING.getKey());, +++ b/core/src/main/java/org/elasticsearch/bootstrap/BootstrapSettings.java, +    public static final Setting<Boolean> SYSTEM_CALL_FILTER_SETTING =, +        Setting.boolSetting("bootstrap.system_call_filter", true, Property.NodeScope);, +++ b/core/src/main/java/org/elasticsearch/common/settings/ClusterSettings.java, +                    BootstrapSettings.SYSTEM_CALL_FILTER_SETTING,, +++ b/core/src/test/java/org/elasticsearch/bootstrap/BootstrapCheckTests.java, +                    "OnError [" + command + "] requires forking but is prevented by system call filters " +, +                        "([bootstrap.system_call_filter=true]); upgrade to at least Java 8u92 and use ExitOnOutOfMemoryError")));, +                        + " requires forking but is prevented by system call filters ([bootstrap.system_call_filter=true]);", +++ b/core/src/main/java/org/elasticsearch/bootstrap/Bootstrap.java, +import org.elasticsearch.cli.ExitCodes;, +import org.elasticsearch.common.logging.DeprecationLogger;, +import java.util.Locale;, +import java.util.Objects;, +                BootstrapSettings.SYSTEM_CALL_FILTER_SETTING.get(settings),, +++ b/core/src/main/java/org/elasticsearch/bootstrap/BootstrapChecks.java, +        checks.add(new SystemCallFilterCheck(BootstrapSettings.SYSTEM_CALL_FILTER_SETTING.get(settings)));, +                BootstrapSettings.SYSTEM_CALL_FILTER_SETTING.getKey());, +                BootstrapSettings.SYSTEM_CALL_FILTER_SETTING.getKey());, +++ b/core/src/main/java/org/elasticsearch/bootstrap/BootstrapSettings.java, +    public static final Setting<Boolean> SYSTEM_CALL_FILTER_SETTING =, +        Setting.boolSetting("bootstrap.system_call_filter", true, Property.NodeScope);, +++ b/core/src/main/java/org/elasticsearch/common/settings/ClusterSettings.java, +                    BootstrapSettings.SYSTEM_CALL_FILTER_SETTING,, +++ b/core/src/test/java/org/elasticsearch/bootstrap/BootstrapCheckTests.java, +                    "OnError [" + command + "] requires forking but is prevented by system call filters " +, +                        "([bootstrap.system_call_filter=true]); upgrade to at least Java 8u92 and use ExitOnOutOfMemoryError")));, +                        + " requires forking but is prevented by system call filters ([bootstrap.system_call_filter=true]);", +++ b/core/src/test/java/org/elasticsearch/bootstrap/BootstrapSettingsTests.java, +        assertTrue(BootstrapSettings.SYSTEM_CALL_FILTER_SETTING.get(Settings.EMPTY));, +++ b/core/src/main/java/org/elasticsearch/bootstrap/Bootstrap.java, +import org.elasticsearch.cli.ExitCodes;, +import org.elasticsearch.common.logging.DeprecationLogger;, +import java.util.Locale;, +import java.util.Objects;, +                BootstrapSettings.SYSTEM_CALL_FILTER_SETTING.get(settings),, +++ b/core/src/main/java/org/elasticsearch/bootstrap/BootstrapChecks.java, +        checks.add(new SystemCallFilterCheck(BootstrapSettings.SYSTEM_CALL_FILTER_SETTING.get(settings)));, +                BootstrapSettings.SYSTEM_CALL_FILTER_SETTING.getKey());, +                BootstrapSettings.SYSTEM_CALL_FILTER_SETTING.getKey());, +++ b/core/src/main/java/org/elasticsearch/bootstrap/BootstrapSettings.java, +    public static final Setting<Boolean> SYSTEM_CALL_FILTER_SETTING =, +        Setting.boolSetting("bootstrap.system_call_filter", true, Property.NodeScope);, +++ b/core/src/main/java/org/elasticsearch/common/settings/ClusterSettings.java, +                    BootstrapSettings.SYSTEM_CALL_FILTER_SETTING,, +++ b/core/src/test/java/org/elasticsearch/bootstrap/BootstrapCheckTests.java]
[+++ b/test/framework/src/main/java/org/elasticsearch/transport/nio/ESSelector.java, +                    Thread.currentThread().interrupt();, +                    throw new IllegalStateException("Thread was interrupted while waiting for selector to close", e);, +            } else if (selector.isOpen()) {, +                selector.close();, +++ b/test/framework/src/main/java/org/elasticsearch/transport/nio/ESSelector.java, +                    Thread.currentThread().interrupt();, +                    throw new IllegalStateException("Thread was interrupted while waiting for selector to close", e);, +            } else if (selector.isOpen()) {, +                selector.close();, +++ b/test/framework/src/test/java/org/elasticsearch/transport/nio/ESSelectorTests.java, +    public void testSelectorClosedIfOpenAndEventLoopNotRunning() throws IOException {, +        when(rawSelector.isOpen()).thenReturn(true);, +        selector.close();, +        verify(rawSelector).close();, +    }, +]
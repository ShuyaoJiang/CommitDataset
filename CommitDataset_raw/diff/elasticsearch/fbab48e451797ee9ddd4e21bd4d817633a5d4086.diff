[+++ b/core/src/main/java/org/elasticsearch/cluster/ClusterInfo.java, +    private final ImmutableMap<String, DiskUsage> usages;, +    private final ImmutableMap<String, Long> shardSizes;, +    public ClusterInfo(ImmutableMap<String, DiskUsage> usages, ImmutableMap<String, Long> shardSizes) {, +    public Map<String, Long> getShardSizes() {, +        return this.shardSizes;, +++ b/core/src/main/java/org/elasticsearch/cluster/ClusterInfo.java, +    private final ImmutableMap<String, DiskUsage> usages;, +    private final ImmutableMap<String, Long> shardSizes;, +    public ClusterInfo(ImmutableMap<String, DiskUsage> usages, ImmutableMap<String, Long> shardSizes) {, +    public Map<String, Long> getShardSizes() {, +        return this.shardSizes;, +++ b/core/src/main/java/org/elasticsearch/cluster/InternalClusterInfoService.java, +                        String sid = shardIdentifierFromRouting(s.getShardRouting());, +    /**, +     * Method that incorporates the ShardId for the shard into a string that, +     * includes a 'p' or 'r' depending on whether the shard is a primary., +     */, +    public static String shardIdentifierFromRouting(ShardRouting shardRouting) {, +        return shardRouting.shardId().toString() + "[" + (shardRouting.primary() ? "p" : "r") + "]";, +    }, +++ b/core/src/main/java/org/elasticsearch/cluster/ClusterInfo.java, +    private final ImmutableMap<String, DiskUsage> usages;, +    private final ImmutableMap<String, Long> shardSizes;, +    public ClusterInfo(ImmutableMap<String, DiskUsage> usages, ImmutableMap<String, Long> shardSizes) {, +    public Map<String, Long> getShardSizes() {, +        return this.shardSizes;, +++ b/core/src/main/java/org/elasticsearch/cluster/InternalClusterInfoService.java, +                        String sid = shardIdentifierFromRouting(s.getShardRouting());, +    /**, +     * Method that incorporates the ShardId for the shard into a string that, +     * includes a 'p' or 'r' depending on whether the shard is a primary., +     */, +    public static String shardIdentifierFromRouting(ShardRouting shardRouting) {, +        return shardRouting.shardId().toString() + "[" + (shardRouting.primary() ? "p" : "r") + "]";, +    }, +++ b/core/src/main/java/org/elasticsearch/cluster/routing/IndexRoutingTable.java, +                        indexShardRoutingBuilder.addShard(new ShardRouting(index, shardId, null, null, null, i == 0, ShardRoutingState.UNASSIGNED, 0, unassignedInfo));, +                        indexShardRoutingBuilder.addShard(new ShardRouting(index, shardId, null, null, i == 0 ? restoreSource : null, i == 0, ShardRoutingState.UNASSIGNED, 0, unassignedInfo));, +                    indexShardRoutingBuilder.addShard(new ShardRouting(index, shardId, null, null, null, i == 0, ShardRoutingState.UNASSIGNED, 0, unassignedInfo));, +                ShardRouting shard = new ShardRouting(index, shardId, null, null, null, false, ShardRoutingState.UNASSIGNED, 0, new UnassignedInfo(UnassignedInfo.Reason.REPLICA_ADDED, null));, +++ b/core/src/main/java/org/elasticsearch/cluster/ClusterInfo.java, +    private final ImmutableMap<String, DiskUsage> usages;, +    private final ImmutableMap<String, Long> shardSizes;, +    public ClusterInfo(ImmutableMap<String, DiskUsage> usages, ImmutableMap<String, Long> shardSizes) {, +    public Map<String, Long> getShardSizes() {, +        return this.shardSizes;, +++ b/core/src/main/java/org/elasticsearch/cluster/InternalClusterInfoService.java, +                        String sid = shardIdentifierFromRouting(s.getShardRouting());, +    /**, +     * Method that incorporates the ShardId for the shard into a string that, +     * includes a 'p' or 'r' depending on whether the shard is a primary., +     */, +    public static String shardIdentifierFromRouting(ShardRouting shardRouting) {, +        return shardRouting.shardId().toString() + "[" + (shardRouting.primary() ? "p" : "r") + "]";, +    }, +++ b/core/src/main/java/org/elasticsearch/cluster/routing/IndexRoutingTable.java, +                        indexShardRoutingBuilder.addShard(new ShardRouting(index, shardId, null, null, null, i == 0, ShardRoutingState.UNASSIGNED, 0, unassignedInfo));, +                        indexShardRoutingBuilder.addShard(new ShardRouting(index, shardId, null, null, i == 0 ? restoreSource : null, i == 0, ShardRoutingState.UNASSIGNED, 0, unassignedInfo));, +                    indexShardRoutingBuilder.addShard(new ShardRouting(index, shardId, null, null, null, i == 0, ShardRoutingState.UNASSIGNED, 0, unassignedInfo));, +                ShardRouting shard = new ShardRouting(index, shardId, null, null, null, false, ShardRoutingState.UNASSIGNED, 0, new UnassignedInfo(UnassignedInfo.Reason.REPLICA_ADDED, null));, +++ b/core/src/main/java/org/elasticsearch/cluster/routing/IndexShardRoutingTable.java, +                allInitializingShards.add(shard.targetRoutingIfRelocating());, +++ b/core/src/main/java/org/elasticsearch/cluster/ClusterInfo.java, +    private final ImmutableMap<String, DiskUsage> usages;, +    private final ImmutableMap<String, Long> shardSizes;, +    public ClusterInfo(ImmutableMap<String, DiskUsage> usages, ImmutableMap<String, Long> shardSizes) {, +    public Map<String, Long> getShardSizes() {, +        return this.shardSizes;, +++ b/core/src/main/java/org/elasticsearch/cluster/InternalClusterInfoService.java, +                        String sid = shardIdentifierFromRouting(s.getShardRouting());, +    /**, +     * Method that incorporates the ShardId for the shard into a string that, +     * includes a 'p' or 'r' depending on whether the shard is a primary., +     */, +    public static String shardIdentifierFromRouting(ShardRouting shardRouting) {, +        return shardRouting.shardId().toString() + "[" + (shardRouting.primary() ? "p" : "r") + "]";, +    }, +++ b/core/src/main/java/org/elasticsearch/cluster/routing/IndexRoutingTable.java, +                        indexShardRoutingBuilder.addShard(new ShardRouting(index, shardId, null, null, null, i == 0, ShardRoutingState.UNASSIGNED, 0, unassignedInfo));, +                        indexShardRoutingBuilder.addShard(new ShardRouting(index, shardId, null, null, i == 0 ? restoreSource : null, i == 0, ShardRoutingState.UNASSIGNED, 0, unassignedInfo));, +                    indexShardRoutingBuilder.addShard(new ShardRouting(index, shardId, null, null, null, i == 0, ShardRoutingState.UNASSIGNED, 0, unassignedInfo));, +                ShardRouting shard = new ShardRouting(index, shardId, null, null, null, false, ShardRoutingState.UNASSIGNED, 0, new UnassignedInfo(UnassignedInfo.Reason.REPLICA_ADDED, null));, +++ b/core/src/main/java/org/elasticsearch/cluster/routing/IndexShardRoutingTable.java, +                allInitializingShards.add(shard.targetRoutingIfRelocating());, +++ b/core/src/main/java/org/elasticsearch/cluster/routing/RoutingNodes.java, +                            sr = new ShardRouting(shard.index(), shard.id(), shard.relocatingNodeId(),, +                                    shard.currentNodeId(), shard.restoreSource(), shard.primary(), ShardRoutingState.INITIALIZING, shard.version());, +     * Relocate a shard to another node., +    public void relocate(ShardRouting shard, String nodeId) {, +++ b/core/src/main/java/org/elasticsearch/cluster/ClusterInfo.java, +    private final ImmutableMap<String, DiskUsage> usages;, +    private final ImmutableMap<String, Long> shardSizes;, +    public ClusterInfo(ImmutableMap<String, DiskUsage> usages, ImmutableMap<String, Long> shardSizes) {, +    public Map<String, Long> getShardSizes() {, +        return this.shardSizes;, +++ b/core/src/main/java/org/elasticsearch/cluster/InternalClusterInfoService.java, +                        String sid = shardIdentifierFromRouting(s.getShardRouting());, +    /**, +     * Method that incorporates the ShardId for the shard into a string that]
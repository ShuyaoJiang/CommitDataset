[+++ b/src/test/java/org/elasticsearch/test/rest/section/DoSection.java, +import com.google.common.collect.Maps;, +import org.elasticsearch.common.collect.Tuple;, +import java.util.Map;, +import static org.elasticsearch.common.collect.Tuple.tuple;, +            return;, +        }, +, +        try {, +            RestResponse restResponse = executionContext.callApi(apiCallSection.getApi(), apiCallSection.getParams(), apiCallSection.getBody());, +            if (Strings.hasLength(catchParam)) {, +                String catchStatusCode;, +                if (catches.containsKey(catchParam)) {, +                    catchStatusCode = catches.get(catchParam).v1();, +                } else if (catchParam.startsWith("/") && catchParam.endsWith("/")) {, +                    catchStatusCode = "4xx|5xx";, +                } else {, +                    throw new UnsupportedOperationException("catch value [" + catchParam + "] not supported");, +                }, +                fail(formatStatusCodeMessage(restResponse, catchStatusCode));, +            }, +        } catch(RestException e) {, +            if (!Strings.hasLength(catchParam)) {, +                fail(formatStatusCodeMessage(e.restResponse(), "2xx"));, +            } else if (catches.containsKey(catchParam)) {, +                assertStatusCode(e.restResponse());, +    private void assertStatusCode(RestResponse restResponse) {, +        Tuple<String, org.hamcrest.Matcher<Integer>> stringMatcherTuple = catches.get(catchParam);, +        assertThat(formatStatusCodeMessage(restResponse, stringMatcherTuple.v1()),, +                restResponse.getStatusCode(), stringMatcherTuple.v2());, +    }, +, +, +    private static Map<String, Tuple<String, org.hamcrest.Matcher<Integer>>> catches = Maps.newHashMap();, +, +    static {, +        catches.put("missing", tuple("404", equalTo(404)));, +        catches.put("conflict", tuple("409", equalTo(409)));, +        catches.put("forbidden", tuple("403", equalTo(403)));, +        catches.put("request", tuple("4xx|5xx", greaterThanOrEqualTo(400)));, +    }]
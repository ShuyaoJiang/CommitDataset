[+++ b/build.gradle, +++ b/build.gradle, +++ b/buildSrc/build.gradle, +++ b/build.gradle, +++ b/buildSrc/build.gradle, +++ b/buildSrc/src/main/groovy/org/elasticsearch/gradle/BuildPlugin.groovy, +        configureJarManifest(project) // jar config must be added before info broker, +            pom.withXml { XmlProvider xml ->, +    /** Adds repositores used by ES dependencies */, +    static void configureRepositories(Project project) {, +        RepositoryHandler repos = project.repositories, +        if (System.getProperty("repos.mavenlocal") != null) {, +            // with -Drepos.mavenlocal=true we can force checking the local .m2 repo which is, +            // useful for development ie. bwc tests where we install stuff in the local repository, +            // such that we don't have to pass hardcoded files to gradle, +            repos.mavenLocal(), +        }, +        repos.mavenCentral(), +        repos.maven {, +            name 'sonatype-snapshots', +            url 'http://oss.sonatype.org/content/repositories/snapshots/', +        }, +        String luceneVersion = VersionProperties.lucene, +        if (luceneVersion.contains('-snapshot')) {, +            // extract the revision number from the version with a regex matcher, +            String revision = (luceneVersion =~ /\w+-snapshot-([a-z0-9]+)/)[0][1], +            repos.maven {, +                name 'lucene-snapshots', +                url "http://s3.amazonaws.com/download.elasticsearch.org/lucenesnapshots/${revision}", +    /** Adds additional manifest info to jars */, +    static void configureJarManifest(Project project) {, +++ b/build.gradle, +++ b/buildSrc/build.gradle, +++ b/buildSrc/src/main/groovy/org/elasticsearch/gradle/BuildPlugin.groovy, +        configureJarManifest(project) // jar config must be added before info broker, +            pom.withXml { XmlProvider xml ->, +    /** Adds repositores used by ES dependencies */, +    static void configureRepositories(Project project) {, +        RepositoryHandler repos = project.repositories, +        if (System.getProperty("repos.mavenlocal") != null) {, +            // with -Drepos.mavenlocal=true we can force checking the local .m2 repo which is, +            // useful for development ie. bwc tests where we install stuff in the local repository, +            // such that we don't have to pass hardcoded files to gradle, +            repos.mavenLocal(), +        }, +        repos.mavenCentral(), +        repos.maven {, +            name 'sonatype-snapshots', +            url 'http://oss.sonatype.org/content/repositories/snapshots/', +        }, +        String luceneVersion = VersionProperties.lucene, +        if (luceneVersion.contains('-snapshot')) {, +            // extract the revision number from the version with a regex matcher, +            String revision = (luceneVersion =~ /\w+-snapshot-([a-z0-9]+)/)[0][1], +            repos.maven {, +                name 'lucene-snapshots', +                url "http://s3.amazonaws.com/download.elasticsearch.org/lucenesnapshots/${revision}", +    /** Adds additional manifest info to jars */, +    static void configureJarManifest(Project project) {, +++ b/buildSrc/src/main/groovy/org/elasticsearch/gradle/plugin/PluginBuildPlugin.groovy, +import org.gradle.api.artifacts.Dependency, +++ b/build.gradle, +++ b/buildSrc/build.gradle, +++ b/buildSrc/src/main/groovy/org/elasticsearch/gradle/BuildPlugin.groovy, +        configureJarManifest(project) // jar config must be added before info broker, +            pom.withXml { XmlProvider xml ->, +    /** Adds repositores used by ES dependencies */, +    static void configureRepositories(Project project) {, +        RepositoryHandler repos = project.repositories, +        if (System.getProperty("repos.mavenlocal") != null) {, +            // with -Drepos.mavenlocal=true we can force checking the local .m2 repo which is, +            // useful for development ie. bwc tests where we install stuff in the local repository, +            // such that we don't have to pass hardcoded files to gradle, +            repos.mavenLocal(), +        }, +        repos.mavenCentral(), +        repos.maven {, +            name 'sonatype-snapshots', +            url 'http://oss.sonatype.org/content/repositories/snapshots/', +        }, +        String luceneVersion = VersionProperties.lucene, +        if (luceneVersion.contains('-snapshot')) {, +            // extract the revision number from the version with a regex matcher, +            String revision = (luceneVersion =~ /\w+-snapshot-([a-z0-9]+)/)[0][1], +            repos.maven {, +                name 'lucene-snapshots', +                url "http://s3.amazonaws.com/download.elasticsearch.org/lucenesnapshots/${revision}", +    /** Adds additional manifest info to jars */, +    static void configureJarManifest(Project project) {, +++ b/buildSrc/src/main/groovy/org/elasticsearch/gradle/plugin/PluginBuildPlugin.groovy, +import org.gradle.api.artifacts.Dependency, +++ b/buildSrc/src/main/resources/checkstyle_suppressions.xml, +++ b/build.gradle, +++ b/buildSrc/build.gradle, +++ b/buildSrc/src/main/groovy/org/elasticsearch/gradle/BuildPlugin.groovy, +        configureJarManifest(project) // jar config must be added before info broker, +            pom.withXml { XmlProvider xml ->, +    /** Adds repositores used by ES dependencies */, +    static void configureRepositories(Project project) {, +        RepositoryHandler repos = project.repositories]
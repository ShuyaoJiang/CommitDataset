[+++ b/modules/elasticsearch/src/main/java/org/elasticsearch/discovery/zen/ping/unicast/UnicastZenPing.java, +    private void sendPings(final int id, final TimeValue timeout, boolean wait) {, +        final UnicastPingRequest pingRequest = new UnicastPingRequest();, +, +            final boolean disconnect = disconnectX;, +            if (!transportService.nodeConnected(nodeToSend)) {, +                // fork the connection to another thread, +                threadPool.cached().execute(new Runnable() {, +                    @Override public void run() {, +                            // connect to the node, see if we manage to do it, if not, bail, +                            // we are connected, send the ping request, +                            sendPingRequestToNode(id, timeout, pingRequest, latch, node, disconnect, nodeToSend);, +                            // can't connect to the node, +                        }, +                    }, +                });, +            } else {, +                sendPingRequestToNode(id, timeout, pingRequest, latch, node, disconnectX, nodeToSend);, +            }, +        }, +        if (wait) {, +            try {, +                latch.await(timeout.millis() * 5, TimeUnit.MILLISECONDS);, +            } catch (InterruptedException e) {, +                // ignore, +            }, +        }, +    private void sendPingRequestToNode(final int id, TimeValue timeout, UnicastPingRequest pingRequest, final CountDownLatch latch, final DiscoveryNode node, final boolean disconnect, final DiscoveryNode nodeToSend) {, +        logger.trace("[{}] connecting to {}, disconnect[{}]", id, nodeToSend, disconnect);]
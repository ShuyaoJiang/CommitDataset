[+++ b/modules/elasticsearch/src/main/java/org/elasticsearch/cluster/routing/allocation/decider/SameShardAllocationDecider.java, +import java.util.List;, +, +        List<MutableShardRouting> shards = node.shards();, +        for (int i = 0; i < shards.size(); i++) {, +            if (shards.get(i).shardId().equals(shardRouting.shardId())) {]
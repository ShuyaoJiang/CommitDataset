[+++ b/src/main/java/org/elasticsearch/monitor/jvm/HotThreads.java, +            final int busiestThreads = Math.min(this.busiestThreads, hotties.size());, +++ b/src/main/java/org/elasticsearch/monitor/jvm/HotThreads.java, +            final int busiestThreads = Math.min(this.busiestThreads, hotties.size());, +++ b/src/test/java/org/elasticsearch/action/admin/HotThreadsTest.java, +import java.util.concurrent.atomic.AtomicBoolean;, +import static org.hamcrest.CoreMatchers.is;, +        final AtomicBoolean hasErrors = new AtomicBoolean(false);, +                nodesHotThreadsRequestBuilder.setThreads(rarely() ? randomIntBetween(500, 5000) : randomIntBetween(1, 500));, +                    boolean success = false;, +                        success = true;, +                        if (!success) {, +                            hasErrors.set(true);, +                        }, +                    hasErrors.set(true);, +            assertThat(hasErrors.get(), is(false));]
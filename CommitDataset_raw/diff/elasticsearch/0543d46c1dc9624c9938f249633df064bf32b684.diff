[+++ b/core/src/main/java/org/elasticsearch/search/sort/FieldSortBuilder.java, +    public FieldSortBuilder setNestedFilter(QueryBuilder nestedFilter) {, +    public QueryBuilder getNestedFilter() {, +++ b/core/src/main/java/org/elasticsearch/search/sort/FieldSortBuilder.java, +    public FieldSortBuilder setNestedFilter(QueryBuilder nestedFilter) {, +    public QueryBuilder getNestedFilter() {, +++ b/core/src/main/java/org/elasticsearch/search/sort/GeoDistanceSortBuilder.java, +                // the json in the format of -> field : { lat : 30, lon : 12 }, +                    // TODO Note to remember: while this is kept as a QueryBuilder internally,, +                    // we need to make sure to call toFilter() on it once on the shard, +                    // (e.g. in the new build() method), +++ b/core/src/main/java/org/elasticsearch/search/sort/FieldSortBuilder.java, +    public FieldSortBuilder setNestedFilter(QueryBuilder nestedFilter) {, +    public QueryBuilder getNestedFilter() {, +++ b/core/src/main/java/org/elasticsearch/search/sort/GeoDistanceSortBuilder.java, +                // the json in the format of -> field : { lat : 30, lon : 12 }, +                    // TODO Note to remember: while this is kept as a QueryBuilder internally,, +                    // we need to make sure to call toFilter() on it once on the shard, +                    // (e.g. in the new build() method), +++ b/core/src/main/java/org/elasticsearch/search/sort/GeoDistanceSortParser.java, +    public SortField parse(XContentParser parser, QueryShardContext context) throws Exception {, +++ b/core/src/main/java/org/elasticsearch/search/sort/FieldSortBuilder.java, +    public FieldSortBuilder setNestedFilter(QueryBuilder nestedFilter) {, +    public QueryBuilder getNestedFilter() {, +++ b/core/src/main/java/org/elasticsearch/search/sort/GeoDistanceSortBuilder.java, +                // the json in the format of -> field : { lat : 30, lon : 12 }, +                    // TODO Note to remember: while this is kept as a QueryBuilder internally,, +                    // we need to make sure to call toFilter() on it once on the shard, +                    // (e.g. in the new build() method), +++ b/core/src/main/java/org/elasticsearch/search/sort/GeoDistanceSortParser.java, +    public SortField parse(XContentParser parser, QueryShardContext context) throws Exception {, +++ b/core/src/main/java/org/elasticsearch/search/sort/ScoreSortBuilder.java, +++ b/core/src/main/java/org/elasticsearch/search/sort/FieldSortBuilder.java, +    public FieldSortBuilder setNestedFilter(QueryBuilder nestedFilter) {, +    public QueryBuilder getNestedFilter() {, +++ b/core/src/main/java/org/elasticsearch/search/sort/GeoDistanceSortBuilder.java, +                // the json in the format of -> field : { lat : 30, lon : 12 }, +                    // TODO Note to remember: while this is kept as a QueryBuilder internally,, +                    // we need to make sure to call toFilter() on it once on the shard, +                    // (e.g. in the new build() method), +++ b/core/src/main/java/org/elasticsearch/search/sort/GeoDistanceSortParser.java, +    public SortField parse(XContentParser parser, QueryShardContext context) throws Exception {, +++ b/core/src/main/java/org/elasticsearch/search/sort/ScoreSortBuilder.java, +++ b/core/src/main/java/org/elasticsearch/search/sort/ScriptSortBuilder.java, +++ b/core/src/main/java/org/elasticsearch/search/sort/FieldSortBuilder.java, +    public FieldSortBuilder setNestedFilter(QueryBuilder nestedFilter) {, +    public QueryBuilder getNestedFilter() {, +++ b/core/src/main/java/org/elasticsearch/search/sort/GeoDistanceSortBuilder.java, +                // the json in the format of -> field : { lat : 30, lon : 12 }, +                    // TODO Note to remember: while this is kept as a QueryBuilder internally,, +                    // we need to make sure to call toFilter() on it once on the shard, +                    // (e.g. in the new build() method), +++ b/core/src/main/java/org/elasticsearch/search/sort/GeoDistanceSortParser.java, +    public SortField parse(XContentParser parser, QueryShardContext context) throws Exception {, +++ b/core/src/main/java/org/elasticsearch/search/sort/ScoreSortBuilder.java, +++ b/core/src/main/java/org/elasticsearch/search/sort/ScriptSortBuilder.java, +++ b/core/src/main/java/org/elasticsearch/search/sort/ScriptSortParser.java, +    public SortField parse(XContentParser parser, QueryShardContext context) throws Exception {, +        // If nested_path is specified, then wrap the `fieldComparatorSource` in a `NestedFieldComparatorSource`, +++ b/core/src/main/java/org/elasticsearch/search/sort/FieldSortBuilder.java, +    public FieldSortBuilder setNestedFilter(QueryBuilder nestedFilter) {, +    public QueryBuilder getNestedFilter() {, +++ b/core/src/main/java/org/elasticsearch/search/sort/GeoDistanceSortBuilder.java, +                // the json in the format of -> field : { lat : 30, lon : 12 }, +                    // TODO Note to remember: while this is kept as a QueryBuilder internally,, +                    // we need to make sure to call toFilter() on it once on the shard, +                    // (e.g. in the new build() method), +++ b/core/src/main/java/org/elasticsearch/search/sort/GeoDistanceSortParser.java, +    public SortField parse(XContentParser parser, QueryShardContext context) throws Exception {, +++ b/core/src/main/java/org/elasticsearch/search/sort/ScoreSortBuilder.java, +++ b/core/src/main/java/org/elasticsearch/search/sort/ScriptSortBuilder.java, +++ b/core/src/main/java/org/elasticsearch/search/sort/ScriptSortParser.java, +    public SortField parse(XContentParser parser, QueryShardContext context) throws Exception {, +        // If nested_path is specified, then wrap the `fieldComparatorSource` in a `NestedFieldComparatorSource`, +++ b/core/src/main/java/org/elasticsearch/search/sort/SortBuilder.java, +++ b/core/src/main/java/org/elasticsearch/search/sort/FieldSortBuilder.java, +    public FieldSortBuilder setNestedFilter(QueryBuilder nestedFilter) {, +    public QueryBuilder getNestedFilter() {, +++ b/core/src/main/java/org/elasticsearch/search/sort/GeoDistanceSortBuilder.java, +                // the json in the format of -> field : { lat : 30, lon : 12 }, +                    // TODO Note to remember: while this is kept as a QueryBuilder internally,, +                    // we need to make sure to call toFilter() on it once on the shard, +                    // (e.g. in the new build() method), +++ b/core/src/main/java/org/elasticsearch/search/sort/GeoDistanceSortParser.java, +    public SortField parse(XContentParser parser, QueryShardContext context) throws Exception {, +++ b/core/src/main/java/org/elasticsearch/search/sort/ScoreSortBuilder.java, +++ b/core/src/main/java/org/elasticsearch/search/sort/ScriptSortBuilder.java, +++ b/core/src/main/java/org/elasticsearch/search/sort/ScriptSortParser.java, +    public SortField parse(XContentParser parser, QueryShardContext context) throws Exception {, +        // If nested_path is specified, then wrap the `fieldComparatorSource` in a `NestedFieldComparatorSource`, +++ b/core/src/main/java/org/elasticsearch/search/sort/SortBuilder.java, +++ b/core/src/main/java/org/elasticsearch/search/sort/SortBuilderParser.java, +    SortBuilder fromXContent(QueryParseContext context, String elementName) throws IOException;, +++ b/core/src/main/java/org/elasticsearch/search/sort/FieldSortBuilder.java, +    public FieldSortBuilder setNestedFilter(QueryBuilder nestedFilter) {, +    public QueryBuilder getNestedFilter() {, +++ b/core/src/main/java/org/elasticsearch/search/sort/GeoDistanceSortBuilder.java, +                // the json in the format of -> field : { lat : 30, lon : 12 }, +                    // TODO Note to remember: while this is kept as a QueryBuilder internally,, +                    // we need to make sure to call toFilter() on it once on the shard]
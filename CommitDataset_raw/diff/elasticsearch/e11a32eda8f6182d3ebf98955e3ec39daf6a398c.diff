[+++ b/server/src/main/java/org/elasticsearch/index/IndexService.java, +            indexShard = new IndexShard(, +                    routing,, +                    this.indexSettings,, +                    path,, +                    store,, +                    indexSortSupplier,, +                    indexCache,, +                    mapperService,, +                    similarityService,, +                    engineFactory,, +                    eventListener,, +                    searcherWrapper,, +                    threadPool,, +                    bigArrays,, +                    engineWarmer,, +                    searchOperationListeners,, +                    indexingOperationListeners,, +                    () -> globalCheckpointSyncer.accept(shardId),, +++ b/server/src/main/java/org/elasticsearch/index/IndexService.java, +            indexShard = new IndexShard(, +                    routing,, +                    this.indexSettings,, +                    path,, +                    store,, +                    indexSortSupplier,, +                    indexCache,, +                    mapperService,, +                    similarityService,, +                    engineFactory,, +                    eventListener,, +                    searcherWrapper,, +                    threadPool,, +                    bigArrays,, +                    engineWarmer,, +                    searchOperationListeners,, +                    indexingOperationListeners,, +                    () -> globalCheckpointSyncer.accept(shardId),, +++ b/server/src/main/java/org/elasticsearch/index/shard/IndexShard.java, +            final ShardRouting shardRouting,, +            final IndexSettings indexSettings,, +            final ShardPath path,, +            final Store store,, +            final Supplier<Sort> indexSortSupplier,, +            final IndexCache indexCache,, +            final MapperService mapperService,, +            final SimilarityService similarityService,, +            final @Nullable EngineFactory engineFactory,, +            final IndexEventListener indexEventListener,, +            final IndexSearcherWrapper indexSearcherWrapper,, +            final ThreadPool threadPool,, +            final BigArrays bigArrays,, +            final Engine.Warmer warmer,, +            final List<SearchOperationListener> searchOperationListener,, +            final List<IndexingOperationListener> listeners,, +            final Runnable globalCheckpointSyncer,, +            final CircuitBreakerService circuitBreakerService) throws IOException {, +++ b/server/src/main/java/org/elasticsearch/index/IndexService.java, +            indexShard = new IndexShard(, +                    routing,, +                    this.indexSettings,, +                    path,, +                    store,, +                    indexSortSupplier,, +                    indexCache,, +                    mapperService,, +                    similarityService,, +                    engineFactory,, +                    eventListener,, +                    searcherWrapper,, +                    threadPool,, +                    bigArrays,, +                    engineWarmer,, +                    searchOperationListeners,, +                    indexingOperationListeners,, +                    () -> globalCheckpointSyncer.accept(shardId),, +++ b/server/src/main/java/org/elasticsearch/index/shard/IndexShard.java, +            final ShardRouting shardRouting,, +            final IndexSettings indexSettings,, +            final ShardPath path,, +            final Store store,, +            final Supplier<Sort> indexSortSupplier,, +            final IndexCache indexCache,, +            final MapperService mapperService,, +            final SimilarityService similarityService,, +            final @Nullable EngineFactory engineFactory,, +            final IndexEventListener indexEventListener,, +            final IndexSearcherWrapper indexSearcherWrapper,, +            final ThreadPool threadPool,, +            final BigArrays bigArrays,, +            final Engine.Warmer warmer,, +            final List<SearchOperationListener> searchOperationListener,, +            final List<IndexingOperationListener> listeners,, +            final Runnable globalCheckpointSyncer,, +            final CircuitBreakerService circuitBreakerService) throws IOException {, +++ b/server/src/main/java/org/elasticsearch/indices/IndicesService.java, +    public IndexShard createShard(, +            final ShardRouting shardRouting,, +            final RecoveryState recoveryState,, +            final PeerRecoveryTargetService recoveryTargetService,]
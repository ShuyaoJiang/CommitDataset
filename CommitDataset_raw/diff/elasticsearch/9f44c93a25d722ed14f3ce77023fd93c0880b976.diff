[+++ b/modules/elasticsearch/src/main/java/org/elasticsearch/action/search/type/TransportSearchDfsQueryAndFetchAction.java, +                ReduceSearchPhaseException failure = new ReduceSearchPhaseException("query_fetch", "", e, buildShardFailures());, +                if (logger.isDebugEnabled()) {, +                    logger.debug("failed to reduce search", failure);, +                }, +                listener.onFailure(failure);, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/action/search/type/TransportSearchDfsQueryAndFetchAction.java, +                ReduceSearchPhaseException failure = new ReduceSearchPhaseException("query_fetch", "", e, buildShardFailures());, +                if (logger.isDebugEnabled()) {, +                    logger.debug("failed to reduce search", failure);, +                }, +                listener.onFailure(failure);, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/action/search/type/TransportSearchDfsQueryThenFetchAction.java, +                ReduceSearchPhaseException failure = new ReduceSearchPhaseException("fetch", "", e, buildShardFailures());, +                if (logger.isDebugEnabled()) {, +                    logger.debug("failed to reduce search", failure);, +                }, +                listener.onFailure(failure);, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/action/search/type/TransportSearchDfsQueryAndFetchAction.java, +                ReduceSearchPhaseException failure = new ReduceSearchPhaseException("query_fetch", "", e, buildShardFailures());, +                if (logger.isDebugEnabled()) {, +                    logger.debug("failed to reduce search", failure);, +                }, +                listener.onFailure(failure);, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/action/search/type/TransportSearchDfsQueryThenFetchAction.java, +                ReduceSearchPhaseException failure = new ReduceSearchPhaseException("fetch", "", e, buildShardFailures());, +                if (logger.isDebugEnabled()) {, +                    logger.debug("failed to reduce search", failure);, +                }, +                listener.onFailure(failure);, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/action/search/type/TransportSearchQueryThenFetchAction.java, +                ReduceSearchPhaseException failure = new ReduceSearchPhaseException("fetch", "", e, buildShardFailures());, +                if (logger.isDebugEnabled()) {, +                    logger.debug("failed to reduce search", failure);, +                }, +                listener.onFailure(failure);, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/action/search/type/TransportSearchDfsQueryAndFetchAction.java, +                ReduceSearchPhaseException failure = new ReduceSearchPhaseException("query_fetch", "", e, buildShardFailures());, +                if (logger.isDebugEnabled()) {, +                    logger.debug("failed to reduce search", failure);, +                }, +                listener.onFailure(failure);, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/action/search/type/TransportSearchDfsQueryThenFetchAction.java, +                ReduceSearchPhaseException failure = new ReduceSearchPhaseException("fetch", "", e, buildShardFailures());, +                if (logger.isDebugEnabled()) {, +                    logger.debug("failed to reduce search", failure);, +                }, +                listener.onFailure(failure);, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/action/search/type/TransportSearchQueryThenFetchAction.java, +                ReduceSearchPhaseException failure = new ReduceSearchPhaseException("fetch", "", e, buildShardFailures());, +                if (logger.isDebugEnabled()) {, +                    logger.debug("failed to reduce search", failure);, +                }, +                listener.onFailure(failure);, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/action/search/type/TransportSearchScrollScanAction.java, +                ReduceSearchPhaseException failure = new ReduceSearchPhaseException("fetch", "", e, buildShardFailures(shardFailures, searchCache));, +                if (logger.isDebugEnabled()) {, +                    logger.debug("failed to reduce search", failure);, +                }, +                listener.onFailure(failure);, +            } finally {, +                searchCache.releaseQueryFetchResults(queryFetchResults);]
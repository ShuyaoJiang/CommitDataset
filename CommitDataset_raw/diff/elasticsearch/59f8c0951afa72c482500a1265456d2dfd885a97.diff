[+++ b/rest-api-spec/test/nodes.info/20_transport.yaml, +---, +"node_info test profile is empty":, +  - do:, +      nodes.info:, +        metric: [ transport ], +, +# there is no possbility to use is_true here due to unknown node_id, +# which is part of the path, just checking for profiles in the body, +  - match: { $body: /profiles/ }, +++ b/rest-api-spec/test/nodes.info/20_transport.yaml, +---, +"node_info test profile is empty":, +  - do:, +      nodes.info:, +        metric: [ transport ], +, +# there is no possbility to use is_true here due to unknown node_id, +# which is part of the path, just checking for profiles in the body, +  - match: { $body: /profiles/ }, +++ b/src/main/java/org/elasticsearch/transport/Transport.java, +import java.util.Map;, +     * Further profile bound addresses, +     * @return Should return null if transport does not support profiles, otherwise a map with name of profile and its bound transport address, +     */, +    Map<String, BoundTransportAddress> profileBoundAddresses();, +, +    /**, +    /**, +     * Returns count of currently open connections, +     */, +++ b/rest-api-spec/test/nodes.info/20_transport.yaml, +---, +"node_info test profile is empty":, +  - do:, +      nodes.info:, +        metric: [ transport ], +, +# there is no possbility to use is_true here due to unknown node_id, +# which is part of the path, just checking for profiles in the body, +  - match: { $body: /profiles/ }, +++ b/src/main/java/org/elasticsearch/transport/Transport.java, +import java.util.Map;, +     * Further profile bound addresses, +     * @return Should return null if transport does not support profiles, otherwise a map with name of profile and its bound transport address, +     */, +    Map<String, BoundTransportAddress> profileBoundAddresses();, +, +    /**, +    /**, +     * Returns count of currently open connections, +     */, +++ b/src/main/java/org/elasticsearch/transport/TransportInfo.java, +import com.google.common.collect.Maps;, +import org.elasticsearch.common.Nullable;, +import java.util.Map;, +    private Map<String, BoundTransportAddress> profileAddresses;, +    public TransportInfo(BoundTransportAddress address, @Nullable Map<String, BoundTransportAddress> profileAddresses) {, +        this.profileAddresses = profileAddresses;, +        static final XContentBuilderString PROFILES = new XContentBuilderString("profiles");, +        builder.startObject(Fields.PROFILES);, +        if (profileAddresses != null && profileAddresses.size() > 0) {, +            for (Map.Entry<String, BoundTransportAddress> entry : profileAddresses.entrySet()) {, +                builder.startObject(entry.getKey());, +                builder.field(Fields.BOUND_ADDRESS, entry.getValue().boundAddress().toString());, +                builder.field(Fields.PUBLISH_ADDRESS, entry.getValue().publishAddress().toString());, +                builder.endObject();, +            }, +        }, +        builder.endObject();, +        int size = in.readVInt();, +        if (size > 0) {, +            profileAddresses = Maps.newHashMapWithExpectedSize(size);, +            for (int i = 0; i < size; i++) {, +                String key = in.readString();, +                BoundTransportAddress value = BoundTransportAddress.readBoundTransportAddress(in);, +                profileAddresses.put(key, value);, +            }, +        }, +        if (profileAddresses != null) {, +            out.writeVInt(profileAddresses.size());, +        } else {, +            out.writeVInt(0);, +        }, +        if (profileAddresses != null && profileAddresses.size() > 0) {, +            for (Map.Entry<String, BoundTransportAddress> entry : profileAddresses.entrySet()) {, +                out.writeString(entry.getKey());, +                entry.getValue().writeTo(out);, +            }, +        }, +, +    public Map<String, BoundTransportAddress> getProfileAddresses() {, +        return profileAddresses();, +    }, +, +    public Map<String, BoundTransportAddress> profileAddresses() {, +        return profileAddresses;, +    }, +++ b/rest-api-spec/test/nodes.info/20_transport.yaml, +---]
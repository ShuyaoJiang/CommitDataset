[+++ b/modules/elasticsearch/src/main/java/org/elasticsearch/common/lucene/store/SwitchDirectory.java, +import java.util.HashSet;, +        Set<String> files = new HashSet<String>();, +        for (String f : primaryDir.listAll()) {, +            files.add(f);, +        }, +        for (String f : secondaryDir.listAll()) {, +            files.add(f);, +        }, +        return files.toArray(new String[files.size()]);]
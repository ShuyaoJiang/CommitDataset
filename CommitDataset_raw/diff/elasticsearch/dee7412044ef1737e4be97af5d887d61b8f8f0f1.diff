[+++ b/elasticsearch/src/main/java/org/elasticsearch/xpack/prelert/job/persistence/ElasticsearchMappings.java, +                                .field(COPY_TO, ALL_FIELD_VALUES), +++ b/elasticsearch/src/main/java/org/elasticsearch/xpack/prelert/job/persistence/ElasticsearchMappings.java, +                                .field(COPY_TO, ALL_FIELD_VALUES), +++ b/elasticsearch/src/test/resources/rest-api-spec/test/custom_all_field.yaml, +setup:, +  - do:, +      xpack.prelert.put_job:, +        body:  >, +          {, +            "job_id": "custom-all-test-1",, +            "description":"Job for testing custom all field",, +            "analysis_config" : {, +                "detectors" :[{"function":"metric","field_name":"responsetime","by_field_name":"airline"}], +            }, +          }, +  - do:, +      xpack.prelert.put_job:, +        body:  >, +          {, +            "job_id": "custom-all-test-2",, +            "description":"Job for testing custom all field",, +            "analysis_config" : {, +                "detectors" :[{"function":"metric","field_name":"responsetime","by_field_name":"airline"}], +            }, +          }, +, +, +  - do:, +      index:, +        index:  prelertresults-custom-all-test-1, +        type:   result, +        id:     custom_all_1464739200000_1_1, +        body:, +          {, +            "job_id": "custom-all-test-1",, +            "result_type": "record",, +            "timestamp": "2016-06-01T00:00:00Z",, +            "anomaly_score": 60.0,, +            "bucket_span": 1,, +            "by_field_value": "A by field",, +            "partition_field_value": "A partition field",, +            "over_field_value": "An over field",, +            "influencer_field_name": "An influencer field",, +            "causes": [{, +                "by_field_value": "Cause by field",, +                "partition_field_value": "Cause partition field",, +                "over_field_value": "Cause over field",, +                "correlated_by_field_value": "Cause correlated by field", +                }], +          }, +, +  - do:, +      index:, +        index:  prelertresults-custom-all-test-2, +        type:   result, +        id:     custom_all_1464739200000_1_2, +        body:, +          {, +            "job_id": "custom-all-test-2",, +            "result_type": "record",, +            "timestamp": "2016-06-01T00:00:00Z",, +            "bucket_span": 1,, +            "by_field_value": "A by field", +          }, +, +  - do:, +      indices.refresh:, +        index: [prelertresults-custom-all-test-1, prelertresults-custom-all-test-2], +, +---, +"Test querying custom all field":, +, +  - do:, +      search:, +        index: prelertresults-custom-all-test-1, +        body: { query: { query_string: { query: "A by field" } } }, +  - match: { hits.total: 1 }, +, +  - do:, +      search:, +        index: prelertresults-custom-all-test-1, +        body: { query: { query_string: { query: "A partition field" } } }, +  - match: { hits.total: 1 }, +, +  - do:, +      search:, +        index: prelertresults-custom-all-test-1, +        body: { query: { query_string: { query: "An over field" } } }, +  - match: { hits.total: 1 }, +, +  - do:, +      search:, +        index: prelertresults-custom-all-test-1, +        body: { query: { query_string: { query: "An influencer field" } } }, +  - match: { hits.total: 1 }, +, +  - do:, +      search:, +        index: prelertresults-custom-all-test-1]
[+++ b/plugins/repository-azure/src/main/java/org/elasticsearch/cloud/azure/storage/AzureStorageServiceImpl.java, +            client.getDefaultRequestOptions().setTimeoutIntervalInMs(timeout);, +++ b/plugins/repository-azure/src/main/java/org/elasticsearch/cloud/azure/storage/AzureStorageServiceImpl.java, +            client.getDefaultRequestOptions().setTimeoutIntervalInMs(timeout);, +++ b/plugins/repository-azure/src/test/java/org/elasticsearch/cloud/azure/storage/AzureStorageServiceTest.java, +    public void testGetDefaultClientWithNoSecondary() {, +        AzureStorageServiceImpl azureStorageService = new AzureStorageServiceMock(Settings.builder(), +            .put("cloud.azure.storage.azure1.account", "myaccount1"), +            .put("cloud.azure.storage.azure1.key", "mykey1"), +            .build());, +        azureStorageService.doStart();, +        CloudBlobClient client = azureStorageService.getSelectedClient(null, LocationMode.PRIMARY_ONLY);, +        assertThat(client.getEndpoint(), is(URI.create("https://azure1")));, +    }, +, +    public void testGetDefaultClientWithPrimaryAndSecondaries() {, +        AzureStorageServiceImpl azureStorageService = new AzureStorageServiceMock(settings);, +        azureStorageService.doStart();, +        CloudBlobClient client = azureStorageService.getSelectedClient(null, LocationMode.PRIMARY_ONLY);, +        assertThat(client.getEndpoint(), is(URI.create("https://azure1")));, +    }, +]
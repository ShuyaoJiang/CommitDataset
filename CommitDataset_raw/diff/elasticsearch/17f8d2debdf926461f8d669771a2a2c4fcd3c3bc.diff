[+++ b/core/src/main/java/org/elasticsearch/bootstrap/Bootstrap.java, +++ b/core/src/main/java/org/elasticsearch/bootstrap/Bootstrap.java, +++ b/core/src/main/java/org/elasticsearch/env/Environment.java, +++ b/core/src/main/java/org/elasticsearch/bootstrap/Bootstrap.java, +++ b/core/src/main/java/org/elasticsearch/env/Environment.java, +++ b/core/src/main/java/org/elasticsearch/node/InternalSettingsPreparer.java, +        if (Files.exists(environment.configFile().resolve("elasticsearch.yaml"))) {, +            throw new SettingsException("elasticsearch.yaml was deprecated in 5.5.0 and must be renamed to elasticsearch.yml");, +        }, +, +        if (Files.exists(environment.configFile().resolve("elasticsearch.json"))) {, +            throw new SettingsException("elasticsearch.json was deprecated in 5.5.0 and must be converted to elasticsearch.yml");, +        }, +, +        Path path = environment.configFile().resolve("elasticsearch.yml");, +        return new Environment(output.build());, +++ b/core/src/main/java/org/elasticsearch/bootstrap/Bootstrap.java, +++ b/core/src/main/java/org/elasticsearch/env/Environment.java, +++ b/core/src/main/java/org/elasticsearch/node/InternalSettingsPreparer.java, +        if (Files.exists(environment.configFile().resolve("elasticsearch.yaml"))) {, +            throw new SettingsException("elasticsearch.yaml was deprecated in 5.5.0 and must be renamed to elasticsearch.yml");, +        }, +, +        if (Files.exists(environment.configFile().resolve("elasticsearch.json"))) {, +            throw new SettingsException("elasticsearch.json was deprecated in 5.5.0 and must be converted to elasticsearch.yml");, +        }, +, +        Path path = environment.configFile().resolve("elasticsearch.yml");, +        return new Environment(output.build());, +++ /dev/null, +++ b/core/src/main/java/org/elasticsearch/bootstrap/Bootstrap.java, +++ b/core/src/main/java/org/elasticsearch/env/Environment.java, +++ b/core/src/main/java/org/elasticsearch/node/InternalSettingsPreparer.java, +        if (Files.exists(environment.configFile().resolve("elasticsearch.yaml"))) {, +            throw new SettingsException("elasticsearch.yaml was deprecated in 5.5.0 and must be renamed to elasticsearch.yml");, +        }, +, +        if (Files.exists(environment.configFile().resolve("elasticsearch.json"))) {, +            throw new SettingsException("elasticsearch.json was deprecated in 5.5.0 and must be converted to elasticsearch.yml");, +        }, +, +        Path path = environment.configFile().resolve("elasticsearch.yml");, +        return new Environment(output.build());, +++ /dev/null, +++ b/core/src/test/java/org/elasticsearch/node/InternalSettingsPreparerTests.java, +    public void testYamlNotAllowed() throws IOException {, +        InputStream yaml = getClass().getResourceAsStream("/config/elasticsearch.yml");, +            InternalSettingsPreparer.prepareEnvironment(Settings.builder().put(baseEnvSettings).build(), null));, +        assertEquals("elasticsearch.yaml was deprecated in 5.5.0 and must be renamed to elasticsearch.yml", e.getMessage());, +    public void testJsonNotAllowed() throws IOException {, +        SettingsException e = expectThrows(SettingsException.class, () ->, +            InternalSettingsPreparer.prepareEnvironment(Settings.builder().put(baseEnvSettings).build(), null));, +        assertEquals("elasticsearch.json was deprecated in 5.5.0 and must be converted to elasticsearch.yml", e.getMessage());, +++ b/core/src/main/java/org/elasticsearch/bootstrap/Bootstrap.java, +++ b/core/src/main/java/org/elasticsearch/env/Environment.java, +++ b/core/src/main/java/org/elasticsearch/node/InternalSettingsPreparer.java, +        if (Files.exists(environment.configFile().resolve("elasticsearch.yaml"))) {, +            throw new SettingsException("elasticsearch.yaml was deprecated in 5.5.0 and must be renamed to elasticsearch.yml");, +        }, +, +        if (Files.exists(environment.configFile().resolve("elasticsearch.json"))) {, +            throw new SettingsException("elasticsearch.json was deprecated in 5.5.0 and must be converted to elasticsearch.yml");, +        }, +, +        Path path = environment.configFile().resolve("elasticsearch.yml");, +        return new Environment(output.build());, +++ /dev/null, +++ b/core/src/test/java/org/elasticsearch/node/InternalSettingsPreparerTests.java, +    public void testYamlNotAllowed() throws IOException {, +        InputStream yaml = getClass().getResourceAsStream("/config/elasticsearch.yml");, +            InternalSettingsPreparer.prepareEnvironment(Settings.builder().put(baseEnvSettings).build(), null));, +        assertEquals("elasticsearch.yaml was deprecated in 5.5.0 and must be renamed to elasticsearch.yml", e.getMessage());, +    public void testJsonNotAllowed() throws IOException {, +        SettingsException e = expectThrows(SettingsException.class, () ->, +            InternalSettingsPreparer.prepareEnvironment(Settings.builder().put(baseEnvSettings).build(), null));, +        assertEquals("elasticsearch.json was deprecated in 5.5.0 and must be converted to elasticsearch.yml", e.getMessage());, +++ /dev/null, +++ b/core/src/main/java/org/elasticsearch/bootstrap/Bootstrap.java, +++ b/core/src/main/java/org/elasticsearch/env/Environment.java, +++ b/core/src/main/java/org/elasticsearch/node/InternalSettingsPreparer.java, +        if (Files.exists(environment.configFile().resolve("elasticsearch.yaml"))) {, +            throw new SettingsException("elasticsearch.yaml was deprecated in 5.5.0 and must be renamed to elasticsearch.yml");, +        }, +, +        if (Files.exists(environment.configFile().resolve("elasticsearch.json"))) {, +            throw new SettingsException("elasticsearch.json was deprecated in 5.5.0 and must be converted to elasticsearch.yml");, +        }, +, +        Path path = environment.configFile().resolve("elasticsearch.yml");, +        return new Environment(output.build());, +++ /dev/null, +++ b/core/src/test/java/org/elasticsearch/node/InternalSettingsPreparerTests.java, +    public void testYamlNotAllowed() throws IOException {, +        InputStream yaml = getClass().getResourceAsStream("/config/elasticsearch.yml");, +            InternalSettingsPreparer.prepareEnvironment(Settings.builder().put(baseEnvSettings).build(), null));, +        assertEquals("elasticsearch.yaml was deprecated in 5.5.0 and must be renamed to elasticsearch.yml", e.getMessage());, +    public void testJsonNotAllowed() throws IOException {, +        SettingsException e = expectThrows(SettingsException.class, () ->, +            InternalSettingsPreparer.prepareEnvironment(Settings.builder().put(baseEnvSettings).build(), null));, +        assertEquals("elasticsearch.json was deprecated in 5.5.0 and must be converted to elasticsearch.yml", e.getMessage());]
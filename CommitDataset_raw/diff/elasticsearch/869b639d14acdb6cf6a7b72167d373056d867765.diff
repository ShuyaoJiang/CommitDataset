[+++ b/qa/build.gradle, +      cluster.distribution = System.getProperty('tests.distribution', 'oss-zip'), +++ b/qa/build.gradle, +      cluster.distribution = System.getProperty('tests.distribution', 'oss-zip'), +++ b/qa/mixed-cluster/build.gradle, +    /* To support taking index snapshots, we have to set path.repo setting */, +    if ('zip'.equals(extension.distribution)) {, +      systemProperty 'tests.rest.blacklist', [, +          'cat.templates/10_basic/No templates',, +          'cat.templates/10_basic/Sort templates',, +          'cat.templates/10_basic/Multiple template',, +        ].join(','), +    }, +++ b/qa/build.gradle, +      cluster.distribution = System.getProperty('tests.distribution', 'oss-zip'), +++ b/qa/mixed-cluster/build.gradle, +    /* To support taking index snapshots, we have to set path.repo setting */, +    if ('zip'.equals(extension.distribution)) {, +      systemProperty 'tests.rest.blacklist', [, +          'cat.templates/10_basic/No templates',, +          'cat.templates/10_basic/Sort templates',, +          'cat.templates/10_basic/Multiple template',, +        ].join(','), +    }, +++ b/qa/smoke-test-multinode/build.gradle, +, +integTestRunner {, +  if ('zip'.equals(integTestCluster.distribution)) {, +    systemProperty 'tests.rest.blacklist', [, +        'cat.templates/10_basic/No templates',, +        'cat.templates/10_basic/Sort templates',, +        'cat.templates/10_basic/Multiple template',, +      ].join(','), +  }, +}, +++ b/qa/build.gradle, +      cluster.distribution = System.getProperty('tests.distribution', 'oss-zip'), +++ b/qa/mixed-cluster/build.gradle, +    /* To support taking index snapshots, we have to set path.repo setting */, +    if ('zip'.equals(extension.distribution)) {, +      systemProperty 'tests.rest.blacklist', [, +          'cat.templates/10_basic/No templates',, +          'cat.templates/10_basic/Sort templates',, +          'cat.templates/10_basic/Multiple template',, +        ].join(','), +    }, +++ b/qa/smoke-test-multinode/build.gradle, +, +integTestRunner {, +  if ('zip'.equals(integTestCluster.distribution)) {, +    systemProperty 'tests.rest.blacklist', [, +        'cat.templates/10_basic/No templates',, +        'cat.templates/10_basic/Sort templates',, +        'cat.templates/10_basic/Multiple template',, +      ].join(','), +  }, +}, +++ b/qa/smoke-test-rank-eval-with-mustache/build.gradle, +/*, + * One of the integration tests doesn't work with the zip distribution, + * and will be fixed later., + * Tracked by https://github.com/elastic/elasticsearch/issues/30628, + */, +if ("zip".equals(integTestCluster.distribution)) {, +    integTestRunner.enabled = false, +}, +++ b/qa/build.gradle, +      cluster.distribution = System.getProperty('tests.distribution', 'oss-zip'), +++ b/qa/mixed-cluster/build.gradle, +    /* To support taking index snapshots, we have to set path.repo setting */, +    if ('zip'.equals(extension.distribution)) {, +      systemProperty 'tests.rest.blacklist', [, +          'cat.templates/10_basic/No templates',, +          'cat.templates/10_basic/Sort templates',, +          'cat.templates/10_basic/Multiple template',, +        ].join(','), +    }, +++ b/qa/smoke-test-multinode/build.gradle, +, +integTestRunner {, +  if ('zip'.equals(integTestCluster.distribution)) {, +    systemProperty 'tests.rest.blacklist', [, +        'cat.templates/10_basic/No templates',, +        'cat.templates/10_basic/Sort templates',, +        'cat.templates/10_basic/Multiple template',, +      ].join(','), +  }, +}, +++ b/qa/smoke-test-rank-eval-with-mustache/build.gradle, +/*, + * One of the integration tests doesn't work with the zip distribution, + * and will be fixed later., + * Tracked by https://github.com/elastic/elasticsearch/issues/30628, + */, +if ("zip".equals(integTestCluster.distribution)) {, +    integTestRunner.enabled = false, +}, +++ b/test/framework/src/main/java/org/elasticsearch/test/junit/listeners/ReproduceInfoPrinter.java, +            appendOpt("tests.distribution", System.getProperty("tests.distribution"));]
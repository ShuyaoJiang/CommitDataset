[+++ b/modules/elasticsearch/src/main/java/org/apache/lucene/search/PublicTermsFilter.java, +import org.apache.lucene.index.IndexReader;, +import org.apache.lucene.index.TermDocs;, +import org.apache.lucene.util.OpenBitSet;, +import java.io.IOException;, +, +    // override default impl here to use fastSet..., +, +    @Override, +    public DocIdSet getDocIdSet(IndexReader reader) throws IOException {, +        OpenBitSet result = new OpenBitSet(reader.maxDoc());, +        TermDocs td = reader.termDocs();, +        try {, +            for (Term term : terms) {, +                td.seek(term);, +                while (td.next()) {, +                    result.fastSet(td.doc());, +                }, +            }, +        }, +        finally {, +            td.close();, +        }, +        return result;, +    }, +++ b/modules/elasticsearch/src/main/java/org/apache/lucene/search/PublicTermsFilter.java, +import org.apache.lucene.index.IndexReader;, +import org.apache.lucene.index.TermDocs;, +import org.apache.lucene.util.OpenBitSet;, +import java.io.IOException;, +, +    // override default impl here to use fastSet..., +, +    @Override, +    public DocIdSet getDocIdSet(IndexReader reader) throws IOException {, +        OpenBitSet result = new OpenBitSet(reader.maxDoc());, +        TermDocs td = reader.termDocs();, +        try {, +            for (Term term : terms) {, +                td.seek(term);, +                while (td.next()) {, +                    result.fastSet(td.doc());, +                }, +            }, +        }, +        finally {, +            td.close();, +        }, +        return result;, +    }, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/common/lucene/search/TermFilter.java, + * @author kimchy (shay.banon), +                result.fastSet(td.doc());, +++ b/modules/elasticsearch/src/main/java/org/apache/lucene/search/PublicTermsFilter.java, +import org.apache.lucene.index.IndexReader;, +import org.apache.lucene.index.TermDocs;, +import org.apache.lucene.util.OpenBitSet;, +import java.io.IOException;, +, +    // override default impl here to use fastSet..., +, +    @Override, +    public DocIdSet getDocIdSet(IndexReader reader) throws IOException {, +        OpenBitSet result = new OpenBitSet(reader.maxDoc());, +        TermDocs td = reader.termDocs();, +        try {, +            for (Term term : terms) {, +                td.seek(term);, +                while (td.next()) {, +                    result.fastSet(td.doc());, +                }, +            }, +        }, +        finally {, +            td.close();, +        }, +        return result;, +    }, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/common/lucene/search/TermFilter.java, + * @author kimchy (shay.banon), +                result.fastSet(td.doc());, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/index/cache/filter/FilterCache.java, +    Filter weakCache(Filter filterToCache);, +, +++ b/modules/elasticsearch/src/main/java/org/apache/lucene/search/PublicTermsFilter.java, +import org.apache.lucene.index.IndexReader;, +import org.apache.lucene.index.TermDocs;, +import org.apache.lucene.util.OpenBitSet;, +import java.io.IOException;, +, +    // override default impl here to use fastSet..., +, +    @Override, +    public DocIdSet getDocIdSet(IndexReader reader) throws IOException {, +        OpenBitSet result = new OpenBitSet(reader.maxDoc());, +        TermDocs td = reader.termDocs();, +        try {, +            for (Term term : terms) {, +                td.seek(term);, +                while (td.next()) {]
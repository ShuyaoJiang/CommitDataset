[+++ b/x-pack/plugin/ccr/src/main/java/org/elasticsearch/xpack/ccr/Ccr.java, +            new AutoFollowCoordinator(settings, client, clusterService, ccrLicenseChecker, threadPool::relativeTimeInMillis), +++ b/x-pack/plugin/ccr/src/main/java/org/elasticsearch/xpack/ccr/Ccr.java, +            new AutoFollowCoordinator(settings, client, clusterService, ccrLicenseChecker, threadPool::relativeTimeInMillis), +++ b/x-pack/plugin/ccr/src/main/java/org/elasticsearch/xpack/ccr/CcrSettings.java, +import org.elasticsearch.common.unit.TimeValue;, +     * Dynamic node setting for specifying the wait_for_timeout that the auto follow coordinator should be using., +     */, +    public static final Setting<TimeValue> CCR_AUTO_FOLLOW_WAIT_FOR_METADATA_TIMEOUT = Setting.timeSetting(, +        "ccr.auto_follow.wait_for_metadata_timeout", TimeValue.timeValueSeconds(60), Property.NodeScope, Property.Dynamic);, +, +    /**, +                CCR_FOLLOWING_INDEX_SETTING,, +                CCR_AUTO_FOLLOW_WAIT_FOR_METADATA_TIMEOUT);, +++ b/x-pack/plugin/ccr/src/main/java/org/elasticsearch/xpack/ccr/Ccr.java, +            new AutoFollowCoordinator(settings, client, clusterService, ccrLicenseChecker, threadPool::relativeTimeInMillis), +++ b/x-pack/plugin/ccr/src/main/java/org/elasticsearch/xpack/ccr/CcrSettings.java, +import org.elasticsearch.common.unit.TimeValue;, +     * Dynamic node setting for specifying the wait_for_timeout that the auto follow coordinator should be using., +     */, +    public static final Setting<TimeValue> CCR_AUTO_FOLLOW_WAIT_FOR_METADATA_TIMEOUT = Setting.timeSetting(, +        "ccr.auto_follow.wait_for_metadata_timeout", TimeValue.timeValueSeconds(60), Property.NodeScope, Property.Dynamic);, +, +    /**, +                CCR_FOLLOWING_INDEX_SETTING,, +                CCR_AUTO_FOLLOW_WAIT_FOR_METADATA_TIMEOUT);, +++ b/x-pack/plugin/ccr/src/main/java/org/elasticsearch/xpack/ccr/action/AutoFollowCoordinator.java, +import org.elasticsearch.common.unit.TimeValue;, +import org.elasticsearch.xpack.ccr.CcrSettings;, +    private volatile TimeValue waitForMetadataTimeOut;, +            Settings settings,, +, +        Consumer<TimeValue> updater = newWaitForTimeOut -> {, +            if (newWaitForTimeOut.equals(waitForMetadataTimeOut) == false) {, +                LOGGER.info("changing wait_for_metadata_timeout from [{}] to [{}]", waitForMetadataTimeOut, newWaitForTimeOut);, +                waitForMetadataTimeOut = newWaitForTimeOut;, +            }, +        };, +        clusterService.getClusterSettings().addSettingsUpdateConsumer(CcrSettings.CCR_AUTO_FOLLOW_WAIT_FOR_METADATA_TIMEOUT, updater);, +        waitForMetadataTimeOut = CcrSettings.CCR_AUTO_FOLLOW_WAIT_FOR_METADATA_TIMEOUT.get(settings);, +                    request.waitForTimeout(waitForMetadataTimeOut);, +++ b/x-pack/plugin/ccr/src/main/java/org/elasticsearch/xpack/ccr/Ccr.java, +            new AutoFollowCoordinator(settings, client, clusterService, ccrLicenseChecker, threadPool::relativeTimeInMillis), +++ b/x-pack/plugin/ccr/src/main/java/org/elasticsearch/xpack/ccr/CcrSettings.java, +import org.elasticsearch.common.unit.TimeValue;, +     * Dynamic node setting for specifying the wait_for_timeout that the auto follow coordinator should be using., +     */, +    public static final Setting<TimeValue> CCR_AUTO_FOLLOW_WAIT_FOR_METADATA_TIMEOUT = Setting.timeSetting(, +        "ccr.auto_follow.wait_for_metadata_timeout", TimeValue.timeValueSeconds(60), Property.NodeScope, Property.Dynamic);, +, +    /**, +                CCR_FOLLOWING_INDEX_SETTING,, +                CCR_AUTO_FOLLOW_WAIT_FOR_METADATA_TIMEOUT);, +++ b/x-pack/plugin/ccr/src/main/java/org/elasticsearch/xpack/ccr/action/AutoFollowCoordinator.java, +import org.elasticsearch.common.unit.TimeValue;, +import org.elasticsearch.xpack.ccr.CcrSettings;, +    private volatile TimeValue waitForMetadataTimeOut;, +            Settings settings,, +, +        Consumer<TimeValue> updater = newWaitForTimeOut -> {, +            if (newWaitForTimeOut.equals(waitForMetadataTimeOut) == false) {, +                LOGGER.info("changing wait_for_metadata_timeout from [{}] to [{}]", waitForMetadataTimeOut, newWaitForTimeOut);, +                waitForMetadataTimeOut = newWaitForTimeOut;, +            }, +        };, +        clusterService.getClusterSettings().addSettingsUpdateConsumer(CcrSettings.CCR_AUTO_FOLLOW_WAIT_FOR_METADATA_TIMEOUT, updater);, +        waitForMetadataTimeOut = CcrSettings.CCR_AUTO_FOLLOW_WAIT_FOR_METADATA_TIMEOUT.get(settings);, +                    request.waitForTimeout(waitForMetadataTimeOut);, +++ b/x-pack/plugin/ccr/src/test/java/org/elasticsearch/xpack/CcrIntegTestCase.java, +import org.elasticsearch.xpack.ccr.CcrSettings;, +        // Let cluster state api return quickly in order to speed up auto follow tests:, +        builder.put(CcrSettings.CCR_AUTO_FOLLOW_WAIT_FOR_METADATA_TIMEOUT.getKey(), TimeValue.timeValueMillis(100));, +++ b/x-pack/plugin/ccr/src/main/java/org/elasticsearch/xpack/ccr/Ccr.java, +            new AutoFollowCoordinator(settings, client, clusterService, ccrLicenseChecker, threadPool::relativeTimeInMillis), +++ b/x-pack/plugin/ccr/src/main/java/org/elasticsearch/xpack/ccr/CcrSettings.java, +import org.elasticsearch.common.unit.TimeValue;, +     * Dynamic node setting for specifying the wait_for_timeout that the auto follow coordinator should be using., +     */, +    public static final Setting<TimeValue> CCR_AUTO_FOLLOW_WAIT_FOR_METADATA_TIMEOUT = Setting.timeSetting(, +        "ccr.auto_follow.wait_for_metadata_timeout", TimeValue.timeValueSeconds(60), Property.NodeScope, Property.Dynamic);, +, +    /**, +                CCR_FOLLOWING_INDEX_SETTING,, +                CCR_AUTO_FOLLOW_WAIT_FOR_METADATA_TIMEOUT);, +++ b/x-pack/plugin/ccr/src/main/java/org/elasticsearch/xpack/ccr/action/AutoFollowCoordinator.java, +import org.elasticsearch.common.unit.TimeValue;, +import org.elasticsearch.xpack.ccr.CcrSettings;, +    private volatile TimeValue waitForMetadataTimeOut;, +            Settings settings,, +, +        Consumer<TimeValue> updater = newWaitForTimeOut -> {, +            if (newWaitForTimeOut.equals(waitForMetadataTimeOut) == false) {, +                LOGGER.info("changing wait_for_metadata_timeout from [{}] to [{}]", waitForMetadataTimeOut, newWaitForTimeOut);, +                waitForMetadataTimeOut = newWaitForTimeOut;, +            }, +        };, +        clusterService.getClusterSettings().addSettingsUpdateConsumer(CcrSettings.CCR_AUTO_FOLLOW_WAIT_FOR_METADATA_TIMEOUT, updater);, +        waitForMetadataTimeOut = CcrSettings.CCR_AUTO_FOLLOW_WAIT_FOR_METADATA_TIMEOUT.get(settings);, +                    request.waitForTimeout(waitForMetadataTimeOut);, +++ b/x-pack/plugin/ccr/src/test/java/org/elasticsearch/xpack/CcrIntegTestCase.java]
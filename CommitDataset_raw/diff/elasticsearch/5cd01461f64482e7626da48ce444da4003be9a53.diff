[+++ b/src/test/java/org/elasticsearch/test/integration/search/suggest/CompletionSuggestSearchTests.java, +import org.elasticsearch.common.settings.ImmutableSettings;, +        Settings.Builder settingsBuilder = createDefaultSettings();, +        createIndexAndMappingAndSettings(createDefaultSettings(), indexAnalyzer, searchAnalyzer, payloads, preserveSeparators, preservePositionIncrements);, +    }, +, +    private ImmutableSettings.Builder createDefaultSettings() {, +        int randomReplicaNumber = between(0, numberOfNodes()-1);, +        return settingsBuilder().put(SETTING_NUMBER_OF_SHARDS, randomShardNumber).put(SETTING_NUMBER_OF_REPLICAS, randomReplicaNumber);]
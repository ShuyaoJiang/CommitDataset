[+++ b/x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/security/authc/support/mapper/NativeRoleMappingStoreField.java, +++ b/x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/security/authc/support/mapper/NativeRoleMappingStoreField.java, +++ b/x-pack/plugin/core/src/main/resources/security-index-template.json, +    "_doc" : {, +++ b/x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/security/authc/support/mapper/NativeRoleMappingStoreField.java, +++ b/x-pack/plugin/core/src/main/resources/security-index-template.json, +    "_doc" : {, +++ /dev/null, +++ b/x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/security/authc/support/mapper/NativeRoleMappingStoreField.java, +++ b/x-pack/plugin/core/src/main/resources/security-index-template.json, +    "_doc" : {, +++ /dev/null, +++ b/x-pack/plugin/security/src/main/java/org/elasticsearch/xpack/security/authc/ApiKeyService.java, +import static org.elasticsearch.index.mapper.MapperService.SINGLE_MAPPING_NAME;, +import static org.elasticsearch.xpack.security.support.SecurityIndexManager.SECURITY_INDEX_NAME;, +                            client.prepareIndex(SECURITY_INDEX_NAME, SINGLE_MAPPING_NAME), +                final GetRequest getRequest = client, +                        .prepareGet(SECURITY_INDEX_NAME, SINGLE_MAPPING_NAME, credentials.getId()), +                        .setFetchSource(true), +                        .request();, +        final SearchRequest request = client.prepareSearch(SECURITY_INDEX_NAME), +                UpdateRequest request = client, +                        .prepareUpdate(SECURITY_INDEX_NAME, SINGLE_MAPPING_NAME, apiKeyId), +++ b/x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/security/authc/support/mapper/NativeRoleMappingStoreField.java, +++ b/x-pack/plugin/core/src/main/resources/security-index-template.json, +    "_doc" : {, +++ /dev/null, +++ b/x-pack/plugin/security/src/main/java/org/elasticsearch/xpack/security/authc/ApiKeyService.java, +import static org.elasticsearch.index.mapper.MapperService.SINGLE_MAPPING_NAME;, +import static org.elasticsearch.xpack.security.support.SecurityIndexManager.SECURITY_INDEX_NAME;, +                            client.prepareIndex(SECURITY_INDEX_NAME, SINGLE_MAPPING_NAME), +                final GetRequest getRequest = client, +                        .prepareGet(SECURITY_INDEX_NAME, SINGLE_MAPPING_NAME, credentials.getId()), +                        .setFetchSource(true), +                        .request();, +        final SearchRequest request = client.prepareSearch(SECURITY_INDEX_NAME), +                UpdateRequest request = client, +                        .prepareUpdate(SECURITY_INDEX_NAME, SINGLE_MAPPING_NAME, apiKeyId), +++ b/x-pack/plugin/security/src/main/java/org/elasticsearch/xpack/security/authc/TokenService.java, +import static org.elasticsearch.index.mapper.MapperService.SINGLE_MAPPING_NAME;, +import static org.elasticsearch.xpack.security.support.SecurityIndexManager.SECURITY_INDEX_NAME;, +                        client.prepareIndex(SECURITY_INDEX_NAME, SINGLE_MAPPING_NAME, documentId), +                    final GetRequest getRequest = client.prepareGet(SecurityIndexManager.SECURITY_INDEX_NAME, SINGLE_MAPPING_NAME,, +                UpdateRequest request = client, +                        .prepareUpdate(SECURITY_INDEX_NAME, SINGLE_MAPPING_NAME, getTokenDocumentId(tokenId)), +            final SearchRequest request = client.prepareSearch(SECURITY_INDEX_NAME), +                    client.prepareUpdate(SecurityIndexManager.SECURITY_INDEX_NAME, SINGLE_MAPPING_NAME, tokenDocId), +            client.prepareGet(SECURITY_INDEX_NAME, SINGLE_MAPPING_NAME, tokenDocId).request();, +            final SearchRequest request = client.prepareSearch(SECURITY_INDEX_NAME), +            final SearchRequest request = client.prepareSearch(SECURITY_INDEX_NAME), +                final GetRequest getRequest = client.prepareGet(SECURITY_INDEX_NAME, SINGLE_MAPPING_NAME, getTokenDocumentId(userToken)), +                        .request();, +++ b/x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/security/authc/support/mapper/NativeRoleMappingStoreField.java, +++ b/x-pack/plugin/core/src/main/resources/security-index-template.json, +    "_doc" : {, +++ /dev/null, +++ b/x-pack/plugin/security/src/main/java/org/elasticsearch/xpack/security/authc/ApiKeyService.java, +import static org.elasticsearch.index.mapper.MapperService.SINGLE_MAPPING_NAME;, +import static org.elasticsearch.xpack.security.support.SecurityIndexManager.SECURITY_INDEX_NAME;, +                            client.prepareIndex(SECURITY_INDEX_NAME, SINGLE_MAPPING_NAME), +                final GetRequest getRequest = client, +                        .prepareGet(SECURITY_INDEX_NAME, SINGLE_MAPPING_NAME, credentials.getId()), +                        .setFetchSource(true), +                        .request();, +        final SearchRequest request = client.prepareSearch(SECURITY_INDEX_NAME), +                UpdateRequest request = client, +                        .prepareUpdate(SECURITY_INDEX_NAME, SINGLE_MAPPING_NAME, apiKeyId), +++ b/x-pack/plugin/security/src/main/java/org/elasticsearch/xpack/security/authc/TokenService.java, +import static org.elasticsearch.index.mapper.MapperService.SINGLE_MAPPING_NAME;, +import static org.elasticsearch.xpack.security.support.SecurityIndexManager.SECURITY_INDEX_NAME;, +                        client.prepareIndex(SECURITY_INDEX_NAME, SINGLE_MAPPING_NAME, documentId), +                    final GetRequest getRequest = client.prepareGet(SecurityIndexManager.SECURITY_INDEX_NAME, SINGLE_MAPPING_NAME,, +                UpdateRequest request = client, +                        .prepareUpdate(SECURITY_INDEX_NAME, SINGLE_MAPPING_NAME, getTokenDocumentId(tokenId)), +            final SearchRequest request = client.prepareSearch(SECURITY_INDEX_NAME), +                    client.prepareUpdate(SecurityIndexManager.SECURITY_INDEX_NAME, SINGLE_MAPPING_NAME, tokenDocId), +            client.prepareGet(SECURITY_INDEX_NAME, SINGLE_MAPPING_NAME, tokenDocId).request();, +            final SearchRequest request = client.prepareSearch(SECURITY_INDEX_NAME), +            final SearchRequest request = client.prepareSearch(SECURITY_INDEX_NAME), +                final GetRequest getRequest = client.prepareGet(SECURITY_INDEX_NAME, SINGLE_MAPPING_NAME, getTokenDocumentId(userToken)), +                        .request();, +++ b/x-pack/plugin/security/src/main/java/org/elasticsearch/xpack/security/authc/esnative/NativeUsersStore.java, +import static org.elasticsearch.index.mapper.MapperService.SINGLE_MAPPING_NAME;, +                    query = QueryBuilders.boolQuery().filter(QueryBuilders.idsQuery().addIds(users));, +                            client.prepareGet(SECURITY_INDEX_NAME, SINGLE_MAPPING_NAME, getIdForUser(USER_DOC_TYPE, user)).request(),, +                    client.prepareUpdate(SECURITY_INDEX_NAME, SINGLE_MAPPING_NAME, getIdForUser(docType, username)), +                    client.prepareIndex(SECURITY_INDEX_NAME, SINGLE_MAPPING_NAME, getIdForUser(RESERVED_USER_TYPE, username)), +                            .setSource(Fields.PASSWORD.getPreferredName(), String.valueOf(passwordHash), Fields.ENABLED.getPreferredName(),, +                                    true, Fields.TYPE.getPreferredName(), RESERVED_USER_TYPE), +                    client.prepareUpdate(SECURITY_INDEX_NAME, SINGLE_MAPPING_NAME, getIdForUser(USER_DOC_TYPE, putUserRequest.username())), +                    client.prepareIndex(SECURITY_INDEX_NAME, SINGLE_MAPPING_NAME, getIdForUser(USER_DOC_TYPE, putUserRequest.username())), +                    client.prepareUpdate(SECURITY_INDEX_NAME, SINGLE_MAPPING_NAME, getIdForUser(USER_DOC_TYPE, username)), +                    client.prepareUpdate(SECURITY_INDEX_NAME, SINGLE_MAPPING_NAME, getIdForUser(RESERVED_USER_TYPE, username)), +                DeleteRequest request = client, +                        .prepareDelete(SECURITY_INDEX_NAME, SINGLE_MAPPING_NAME, getIdForUser(USER_DOC_TYPE, deleteUserRequest.username())), +                        .request();, +                            client.prepareGet(SECURITY_INDEX_NAME, SINGLE_MAPPING_NAME, getIdForUser(RESERVED_USER_TYPE, username)), +                                .request(),, +++ b/x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/security/authc/support/mapper/NativeRoleMappingStoreField.java, +++ b/x-pack/plugin/core/src/main/resources/security-index-template.json]
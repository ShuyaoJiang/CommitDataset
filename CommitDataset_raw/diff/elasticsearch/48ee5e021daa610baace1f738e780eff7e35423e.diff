[+++ b/plugin/src/main/java/org/elasticsearch/xpack/ml/job/process/autodetect/AutodetectCommunicator.java, +import java.util.concurrent.atomic.AtomicBoolean;, +    final AtomicBoolean inUse = new AtomicBoolean(false);, +        });, +        });, +        });, +        });, +        });, +    private <T> T checkAndRun(Supplier<String> errorMessage, CheckedSupplier<T, IOException> callback) throws IOException {, +        if (inUse.compareAndSet(false, true)) {, +                inUse.set(false);, +++ b/plugin/src/main/java/org/elasticsearch/xpack/ml/job/process/autodetect/AutodetectCommunicator.java, +import java.util.concurrent.atomic.AtomicBoolean;, +    final AtomicBoolean inUse = new AtomicBoolean(false);, +        });, +        });, +        });, +        });, +        });, +    private <T> T checkAndRun(Supplier<String> errorMessage, CheckedSupplier<T, IOException> callback) throws IOException {, +        if (inUse.compareAndSet(false, true)) {, +                inUse.set(false);, +++ b/plugin/src/test/java/org/elasticsearch/xpack/ml/job/process/autodetect/AutodetectCommunicatorTests.java, +        communicator.inUse.set(true);, +        communicator.inUse.set(false);, +        communicator.inUse.set(true);, +        communicator.inUse.set(false);, +        communicator.inUse.set(true);, +        expectThrows(ElasticsearchStatusException.class, () -> communicator.close());, +        communicator.inUse.set(false);, +        communicator.inUse.set(true);, +        communicator.inUse.set(false);, +        communicator.inUse.set(true);, +        communicator.inUse.set(false);]
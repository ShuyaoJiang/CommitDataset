[+++ b/modules/ingest-common/src/main/java/org/elasticsearch/ingest/common/ForEachProcessor.java, +import org.elasticsearch.script.ScriptService;, +, +        private final ScriptService scriptService;, +, +        Factory(ScriptService scriptService) {, +            this.scriptService = scriptService;, +        }, +, +            Processor processor =, +                ConfigurationUtils.readProcessor(factories, scriptService, entry.getKey(), entry.getValue());, +++ b/modules/ingest-common/src/main/java/org/elasticsearch/ingest/common/ForEachProcessor.java, +import org.elasticsearch.script.ScriptService;, +, +        private final ScriptService scriptService;, +, +        Factory(ScriptService scriptService) {, +            this.scriptService = scriptService;, +        }, +, +            Processor processor =, +                ConfigurationUtils.readProcessor(factories, scriptService, entry.getKey(), entry.getValue());, +++ b/modules/ingest-common/src/main/java/org/elasticsearch/ingest/common/IngestCommonPlugin.java, +        processors.put(ForEachProcessor.TYPE, new ForEachProcessor.Factory(parameters.scriptService));, +++ b/modules/ingest-common/src/main/java/org/elasticsearch/ingest/common/ForEachProcessor.java, +import org.elasticsearch.script.ScriptService;, +, +        private final ScriptService scriptService;, +, +        Factory(ScriptService scriptService) {, +            this.scriptService = scriptService;, +        }, +, +            Processor processor =, +                ConfigurationUtils.readProcessor(factories, scriptService, entry.getKey(), entry.getValue());, +++ b/modules/ingest-common/src/main/java/org/elasticsearch/ingest/common/IngestCommonPlugin.java, +        processors.put(ForEachProcessor.TYPE, new ForEachProcessor.Factory(parameters.scriptService));, +++ b/modules/ingest-common/src/test/java/org/elasticsearch/ingest/common/ForEachProcessorFactoryTests.java, +import org.elasticsearch.script.ScriptService;, +import static org.mockito.Mockito.mock;, +    private final ScriptService scriptService = mock(ScriptService.class);, +, +        ForEachProcessor.Factory forEachFactory = new ForEachProcessor.Factory(scriptService);, +        ForEachProcessor.Factory forEachFactory = new ForEachProcessor.Factory(scriptService);, +        ForEachProcessor.Factory forEachFactory = new ForEachProcessor.Factory(scriptService);, +        ForEachProcessor.Factory forEachFactory = new ForEachProcessor.Factory(scriptService);, +        ForEachProcessor.Factory forEachFactory = new ForEachProcessor.Factory(scriptService);, +        ForEachProcessor.Factory forEachFactory = new ForEachProcessor.Factory(scriptService);, +++ b/modules/ingest-common/src/main/java/org/elasticsearch/ingest/common/ForEachProcessor.java, +import org.elasticsearch.script.ScriptService;, +, +        private final ScriptService scriptService;, +, +        Factory(ScriptService scriptService) {, +            this.scriptService = scriptService;, +        }, +, +            Processor processor =, +                ConfigurationUtils.readProcessor(factories, scriptService, entry.getKey(), entry.getValue());, +++ b/modules/ingest-common/src/main/java/org/elasticsearch/ingest/common/IngestCommonPlugin.java, +        processors.put(ForEachProcessor.TYPE, new ForEachProcessor.Factory(parameters.scriptService));, +++ b/modules/ingest-common/src/test/java/org/elasticsearch/ingest/common/ForEachProcessorFactoryTests.java, +import org.elasticsearch.script.ScriptService;, +import static org.mockito.Mockito.mock;, +    private final ScriptService scriptService = mock(ScriptService.class);, +, +        ForEachProcessor.Factory forEachFactory = new ForEachProcessor.Factory(scriptService);, +        ForEachProcessor.Factory forEachFactory = new ForEachProcessor.Factory(scriptService);, +        ForEachProcessor.Factory forEachFactory = new ForEachProcessor.Factory(scriptService);, +        ForEachProcessor.Factory forEachFactory = new ForEachProcessor.Factory(scriptService);, +        ForEachProcessor.Factory forEachFactory = new ForEachProcessor.Factory(scriptService);, +        ForEachProcessor.Factory forEachFactory = new ForEachProcessor.Factory(scriptService);, +++ b/modules/ingest-common/src/test/resources/rest-api-spec/test/ingest/210_conditional_processor.yml, +---, +teardown:, +  - do:, +      ingest.delete_pipeline:, +        id: "my_pipeline", +        ignore: 404, +, +---, +"Test conditional processor fulfilled condition":, +  - do:, +      ingest.put_pipeline:, +        id: "my_pipeline", +        body:  >, +          {, +            "description": "_description",, +            "processors": [, +              {, +                "bytes" : {, +                  "if" : "ctx.conditional_field == 'bar'",, +                  "field" : "bytes_source_field",, +                  "target_field" : "bytes_target_field", +                }, +              }, +            ], +          }, +  - match: { acknowledged: true }, +]
[+++ b/docs/java-api/query-dsl-queries.asciidoc, +=== More Like This (Field) Query (mlt and mlt_field), +++ b/docs/java-api/query-dsl-queries.asciidoc, +=== More Like This (Field) Query (mlt and mlt_field), +++ b/src/main/java/org/elasticsearch/bootstrap/Security.java, +, +import org.elasticsearch.common.logging.ESLogger;, +import org.elasticsearch.common.logging.Loggers;, +import java.security.NoSuchAlgorithmException;, +import java.security.PermissionCollection;, +import java.security.Policy;, +import java.security.URIParameter;, +        ESLogger log = Loggers.getLogger(Security.class);, +        // retrieve the parsed policy we created: its useful if something goes wrong, +        Policy policy = null;, +        try {, +            policy = Policy.getInstance("JavaPolicy", new URIParameter(newConfig.toUri()));, +        } catch (NoSuchAlgorithmException impossible) {, +            throw new RuntimeException(impossible);, +        }, +        PermissionCollection permissions = policy.getPermissions(Security.class.getProtectionDomain());, +        log.trace("generated permissions: {}", permissions);, +        , +        try {, +            // don't hide securityexception here, it means java.io.tmpdir is not accessible!, +            Files.delete(newConfig);, +        } catch (SecurityException broken) {, +            log.error("unable to properly access temporary files, permissions: {}", permissions);, +            throw broken;, +        } catch (IOException ignore) {, +            // e.g. virus scanner on windows, +        }]
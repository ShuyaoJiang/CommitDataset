[+++ b/docs/painless/painless-debugging.asciidoc, +   "status": 400, +++ b/docs/painless/painless-debugging.asciidoc, +   "status": 400, +++ b/docs/reference/migration/migrate_7_0/scripting.asciidoc, +, +==== Script errors will return as `400` error codes, +, +Malformed scripts, either in search templates, ingest pipelines or search , +requests, return `400 - Bad request` while they would previously return, +`500 - Internal Server Error`. This also applies for stored scripts., +++ b/docs/painless/painless-debugging.asciidoc, +   "status": 400, +++ b/docs/reference/migration/migrate_7_0/scripting.asciidoc, +, +==== Script errors will return as `400` error codes, +, +Malformed scripts, either in search templates, ingest pipelines or search , +requests, return `400 - Bad request` while they would previously return, +`500 - Internal Server Error`. This also applies for stored scripts., +++ b/docs/reference/migration/migrate_7_0/search.asciidoc, +*   script compilation errors, +++ b/docs/painless/painless-debugging.asciidoc, +   "status": 400, +++ b/docs/reference/migration/migrate_7_0/scripting.asciidoc, +, +==== Script errors will return as `400` error codes, +, +Malformed scripts, either in search templates, ingest pipelines or search , +requests, return `400 - Bad request` while they would previously return, +`500 - Internal Server Error`. This also applies for stored scripts., +++ b/docs/reference/migration/migrate_7_0/search.asciidoc, +*   script compilation errors, +++ b/modules/lang-mustache/src/main/java/org/elasticsearch/script/mustache/MustacheScriptEngine.java, +import com.github.mustachejava.MustacheException;, +import org.elasticsearch.script.ScriptException;, +import java.io.StringReader;, +import java.util.Collections;, +        try {, +        } catch (MustacheException ex) {, +            throw new ScriptException(ex.getMessage(), ex, Collections.emptyList(), templateSource, NAME);, +        }, +, +++ b/docs/painless/painless-debugging.asciidoc, +   "status": 400, +++ b/docs/reference/migration/migrate_7_0/scripting.asciidoc, +, +==== Script errors will return as `400` error codes, +, +Malformed scripts, either in search templates, ingest pipelines or search , +requests, return `400 - Bad request` while they would previously return, +`500 - Internal Server Error`. This also applies for stored scripts., +++ b/docs/reference/migration/migrate_7_0/search.asciidoc, +*   script compilation errors, +++ b/modules/lang-mustache/src/main/java/org/elasticsearch/script/mustache/MustacheScriptEngine.java, +import com.github.mustachejava.MustacheException;, +import org.elasticsearch.script.ScriptException;, +import java.io.StringReader;, +import java.util.Collections;, +        try {, +        } catch (MustacheException ex) {, +            throw new ScriptException(ex.getMessage(), ex, Collections.emptyList(), templateSource, NAME);, +        }, +, +++ b/modules/lang-mustache/src/test/java/org/elasticsearch/script/mustache/MustacheTests.java, +import org.elasticsearch.common.bytes.BytesReference;, +import org.elasticsearch.common.xcontent.XContentBuilder;, +import org.elasticsearch.common.xcontent.XContentHelper;, +import org.elasticsearch.script.ScriptEngine;, +import org.elasticsearch.script.ScriptException;, +import org.elasticsearch.script.TemplateScript;, +import org.elasticsearch.test.ESTestCase;, +import org.hamcrest.Matcher;, +, +        final String script = "{{#toJson}}{{foo}}{{bar}}{{/toJson}}";, +        ScriptException e = expectThrows(ScriptException.class, () -> compile(script));, +        assertEquals(MustacheScriptEngine.NAME, e.getLang());, +        assertEquals(script, e.getScript());, +        final String script2 = "{{#toJson}}{{/toJson}}";, +        e = expectThrows(ScriptException.class, () -> compile(script2));, +        assertEquals(MustacheScriptEngine.NAME, e.getLang());, +        assertEquals(script2, e.getScript());, +        final String script = "{{#join}}{{/join}}";, +        ScriptException e = expectThrows(ScriptException.class, () -> compile(script));, +        assertEquals(MustacheScriptEngine.NAME, e.getLang());, +        assertEquals(script, e.getScript());, +        final String script2 = "{{#join delimiter='a'}}{{/join delimiter='b'}}";, +        e = expectThrows(ScriptException.class, () -> compile(script2));, +        assertEquals(MustacheScriptEngine.NAME, e.getLang());, +        assertEquals(script2, e.getScript());, +++ b/docs/painless/painless-debugging.asciidoc, +   "status": 400, +++ b/docs/reference/migration/migrate_7_0/scripting.asciidoc, +, +==== Script errors will return as `400` error codes, +, +Malformed scripts, either in search templates, ingest pipelines or search , +requests, return `400 - Bad request` while they would previously return, +`500 - Internal Server Error`. This also applies for stored scripts., +++ b/docs/reference/migration/migrate_7_0/search.asciidoc]
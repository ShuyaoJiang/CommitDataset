[+++ b/modules/elasticsearch/src/main/java/org/elasticsearch/transport/netty/MessageChannelHandler.java, +        int size = buffer.getInt(buffer.readerIndex() - 4);, +        int markedReaderIndex = buffer.readerIndex();, +        int expectedIndexReader = markedReaderIndex + size;, +, +        TransportResponseHandler handler = null;, +            handleRequest(event, streamIn, requestId);, +            handler = transportServiceAdapter.remove(requestId);, +                    handlerResponseError(streamIn, handler);, +                    handleResponse(streamIn, handler);, +                // if its null, skip those bytes, +                buffer.readerIndex(markedReaderIndex + size);, +        if (buffer.readerIndex() < expectedIndexReader) {, +            logger.warn("Message not fully read for [{}] and handler {}, resetting", requestId, handler);, +            buffer.readerIndex(expectedIndexReader);, +        }, +    private void handleResponse(StreamInput buffer, final TransportResponseHandler handler) {, +    private void handlerResponseError(StreamInput buffer, final TransportResponseHandler handler) {, +    private void handleRequest(MessageEvent event, StreamInput buffer, long requestId) throws IOException {, +                logger.warn("No handler found for action [{}]", action);]
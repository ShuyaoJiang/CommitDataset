[+++ b/src/test/java/org/elasticsearch/test/integration/AbstractSharedClusterTest.java, +++ b/src/test/java/org/elasticsearch/test/integration/AbstractSharedClusterTest.java, +++ b/src/test/java/org/elasticsearch/test/integration/search/basic/TransportTwoNodesSearchTests.java, +    private Set<String> prepareData() throws Exception {, +        Set<String> fullExpectedIds = Sets.newHashSet();, +        ensureGreen();, +        return fullExpectedIds;, +    private void index(Client client, String id, String nameValue, int age) throws IOException {, +        client().index(Requests.indexRequest("test").type("type1").id(id).source(source(id, nameValue, age))).actionGet();, +    }, +, +    private XContentBuilder source(String id, String nameValue, int age) throws IOException {, +        StringBuilder multi = new StringBuilder().append(nameValue);, +        for (int i = 0; i < age; i++) {, +            multi.append(" ").append(nameValue);, +        }, +        return jsonBuilder().startObject(), +                .field("id", id), +                .field("nid", Integer.parseInt(id)), +                .field("name", nameValue + id), +                .field("age", age), +                .field("multi", multi.toString()), +                .field("_boost", age * 10), +                .endObject();, +        prepareData();, +, +        prepareData();, +, +        prepareData();, +, +        Set<String> fullExpectedIds = prepareData();, +, +        prepareData();, +, +        prepareData();, +, +        prepareData();, +, +        prepareData();, +, +        prepareData();, +, +        prepareData();, +, +        prepareData();, +]
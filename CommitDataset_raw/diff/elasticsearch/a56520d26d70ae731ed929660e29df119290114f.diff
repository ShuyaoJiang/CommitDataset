[+++ b/src/main/java/org/elasticsearch/cache/recycler/PageCacheRecycler.java, +        final double totalWeight = bytesWeight + intsWeight + longsWeight + objectsWeight;, +++ b/src/main/java/org/elasticsearch/cache/recycler/PageCacheRecycler.java, +        final double totalWeight = bytesWeight + intsWeight + longsWeight + objectsWeight;, +++ b/src/main/java/org/elasticsearch/common/recycler/Recyclers.java, +++ b/src/main/java/org/elasticsearch/cache/recycler/PageCacheRecycler.java, +        final double totalWeight = bytesWeight + intsWeight + longsWeight + objectsWeight;, +++ b/src/main/java/org/elasticsearch/common/recycler/Recyclers.java, +++ b/src/main/java/org/elasticsearch/common/util/AbstractBigArray.java, +++ b/src/main/java/org/elasticsearch/cache/recycler/PageCacheRecycler.java, +        final double totalWeight = bytesWeight + intsWeight + longsWeight + objectsWeight;, +++ b/src/main/java/org/elasticsearch/common/recycler/Recyclers.java, +++ b/src/main/java/org/elasticsearch/common/util/AbstractBigArray.java, +++ b/src/main/java/org/elasticsearch/common/util/BigArrays.java, +        private final long[] array;, +        DoubleArrayWrapper(BigArrays bigArrays, long[] array, long size, Recycler.V<long[]> releasable, boolean clearOnResize) {, +            return Double.longBitsToDouble(array[(int) index]);, +            double ret = Double.longBitsToDouble(array[(int) index]);, +            array[(int) index] = Double.doubleToRawLongBits(value);, +            return array[(int) index] = Double.doubleToRawLongBits(Double.longBitsToDouble(array[(int) index]) + inc);, +            Arrays.fill(array, (int) fromIndex, (int) toIndex, Double.doubleToRawLongBits(value));, +        private final int[] array;, +        FloatArrayWrapper(BigArrays bigArrays, int[] array, long size, Recycler.V<int[]> releasable, boolean clearOnResize) {, +            return Float.intBitsToFloat(array[(int) index]);, +            float ret = Float.intBitsToFloat(array[(int) index]);, +            array[(int) index] = Float.floatToRawIntBits(value);, +            return array[(int) index] = Float.floatToRawIntBits(Float.intBitsToFloat(array[(int) index]) + inc);, +            Arrays.fill(array, (int) fromIndex, (int) toIndex, Float.floatToRawIntBits(value));, +        if (size > LONG_PAGE_SIZE) {, +        } else if (size >= LONG_PAGE_SIZE / 2 && recycler != null) {, +            final Recycler.V<long[]> page = recycler.longPage(clearOnResize);, +            arr = new DoubleArrayWrapper(this, new long[(int) size], size, null, clearOnResize);, +        final long newSize = overSize(minSize, LONG_PAGE_SIZE, RamUsageEstimator.NUM_BYTES_LONG);, +        if (size > INT_PAGE_SIZE) {, +        } else if (size >= INT_PAGE_SIZE / 2 && recycler != null) {, +            final Recycler.V<int[]> page = recycler.intPage(clearOnResize);, +            array = new FloatArrayWrapper(this, new int[(int) size], size, null, clearOnResize);, +        final long newSize = overSize(minSize, INT_PAGE_SIZE, RamUsageEstimator.NUM_BYTES_FLOAT);, +++ b/src/main/java/org/elasticsearch/cache/recycler/PageCacheRecycler.java, +        final double totalWeight = bytesWeight + intsWeight + longsWeight + objectsWeight;, +++ b/src/main/java/org/elasticsearch/common/recycler/Recyclers.java, +++ b/src/main/java/org/elasticsearch/common/util/AbstractBigArray.java, +++ b/src/main/java/org/elasticsearch/common/util/BigArrays.java, +        private final long[] array;, +        DoubleArrayWrapper(BigArrays bigArrays, long[] array, long size, Recycler.V<long[]> releasable, boolean clearOnResize) {, +            return Double.longBitsToDouble(array[(int) index]);, +            double ret = Double.longBitsToDouble(array[(int) index]);, +            array[(int) index] = Double.doubleToRawLongBits(value);, +            return array[(int) index] = Double.doubleToRawLongBits(Double.longBitsToDouble(array[(int) index]) + inc);, +            Arrays.fill(array, (int) fromIndex, (int) toIndex, Double.doubleToRawLongBits(value));, +        private final int[] array;, +        FloatArrayWrapper(BigArrays bigArrays, int[] array, long size, Recycler.V<int[]> releasable, boolean clearOnResize) {, +            return Float.intBitsToFloat(array[(int) index]);, +            float ret = Float.intBitsToFloat(array[(int) index]);, +            array[(int) index] = Float.floatToRawIntBits(value);, +            return array[(int) index] = Float.floatToRawIntBits(Float.intBitsToFloat(array[(int) index]) + inc);, +            Arrays.fill(array, (int) fromIndex, (int) toIndex, Float.floatToRawIntBits(value));, +        if (size > LONG_PAGE_SIZE) {, +        } else if (size >= LONG_PAGE_SIZE / 2 && recycler != null) {, +            final Recycler.V<long[]> page = recycler.longPage(clearOnResize);, +            arr = new DoubleArrayWrapper(this, new long[(int) size], size, null, clearOnResize);, +        final long newSize = overSize(minSize, LONG_PAGE_SIZE, RamUsageEstimator.NUM_BYTES_LONG);, +        if (size > INT_PAGE_SIZE) {, +        } else if (size >= INT_PAGE_SIZE / 2 && recycler != null) {, +            final Recycler.V<int[]> page = recycler.intPage(clearOnResize);, +            array = new FloatArrayWrapper(this, new int[(int) size], size, null, clearOnResize);, +        final long newSize = overSize(minSize, INT_PAGE_SIZE, RamUsageEstimator.NUM_BYTES_FLOAT);, +++ b/src/main/java/org/elasticsearch/common/util/BigDoubleArray.java, +, +import static org.elasticsearch.common.util.BigArrays.LONG_PAGE_SIZE;, +    private long[][] pages;, +        super(LONG_PAGE_SIZE, bigArrays, clearOnResize);, +        pages = new long[numPages(size)][];, +            pages[i] = newLongPage(i);, +        return Double.longBitsToDouble(pages[pageIndex][indexInPage]);, +        final long[] page = pages[pageIndex];, +        final double ret = Double.longBitsToDouble(page[indexInPage]);, +        page[indexInPage] = Double.doubleToRawLongBits(value);, +        final long[] page = pages[pageIndex];, +        return page[indexInPage] = Double.doubleToRawLongBits(Double.longBitsToDouble(page[indexInPage]) + inc);, +            pages[i] = newLongPage(i);, +        final long longBits = Double.doubleToRawLongBits(value);, +            Arrays.fill(pages[fromPage], indexInPage(fromIndex), indexInPage(toIndex - 1) + 1, longBits);, +            Arrays.fill(pages[fromPage], indexInPage(fromIndex), pages[fromPage].length, longBits);, +                Arrays.fill(pages[i], longBits);, +            Arrays.fill(pages[toPage], 0, indexInPage(toIndex - 1) + 1, longBits);, +++ b/src/main/java/org/elasticsearch/cache/recycler/PageCacheRecycler.java, +        final double totalWeight = bytesWeight + intsWeight + longsWeight + objectsWeight;, +++ b/src/main/java/org/elasticsearch/common/recycler/Recyclers.java, +++ b/src/main/java/org/elasticsearch/common/util/AbstractBigArray.java, +++ b/src/main/java/org/elasticsearch/common/util/BigArrays.java, +        private final long[] array;, +        DoubleArrayWrapper(BigArrays bigArrays, long[] array, long size, Recycler.V<long[]> releasable, boolean clearOnResize) {, +            return Double.longBitsToDouble(array[(int) index]);, +            double ret = Double.longBitsToDouble(array[(int) index]);, +            array[(int) index] = Double.doubleToRawLongBits(value);, +            return array[(int) index] = Double.doubleToRawLongBits(Double.longBitsToDouble(array[(int) index]) + inc);, +            Arrays.fill(array, (int) fromIndex, (int) toIndex, Double.doubleToRawLongBits(value));, +        private final int[] array;, +        FloatArrayWrapper(BigArrays bigArrays, int[] array, long size, Recycler.V<int[]> releasable, boolean clearOnResize) {]
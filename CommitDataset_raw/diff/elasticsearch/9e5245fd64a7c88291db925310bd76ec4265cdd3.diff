[+++ b/elasticsearch/src/main/java/org/elasticsearch/xpack/prelert/PrelertPlugin.java, +import org.elasticsearch.xpack.prelert.action.PostDataAction;, +import org.elasticsearch.xpack.prelert.action.UpdateModelSnapshotAction;, +import org.elasticsearch.xpack.prelert.rest.job.RestPostDataAction;, +import org.elasticsearch.xpack.prelert.rest.modelsnapshots.RestUpdateModelSnapshotAction;, +++ b/elasticsearch/src/main/java/org/elasticsearch/xpack/prelert/PrelertPlugin.java, +import org.elasticsearch.xpack.prelert.action.PostDataAction;, +import org.elasticsearch.xpack.prelert.action.UpdateModelSnapshotAction;, +import org.elasticsearch.xpack.prelert.rest.job.RestPostDataAction;, +import org.elasticsearch.xpack.prelert.rest.modelsnapshots.RestUpdateModelSnapshotAction;, +++ b/elasticsearch/src/main/java/org/elasticsearch/xpack/prelert/job/DataDescription.java, +        // TODO norelease, this can now be removed, +++ b/elasticsearch/src/main/java/org/elasticsearch/xpack/prelert/PrelertPlugin.java, +import org.elasticsearch.xpack.prelert.action.PostDataAction;, +import org.elasticsearch.xpack.prelert.action.UpdateModelSnapshotAction;, +import org.elasticsearch.xpack.prelert.rest.job.RestPostDataAction;, +import org.elasticsearch.xpack.prelert.rest.modelsnapshots.RestUpdateModelSnapshotAction;, +++ b/elasticsearch/src/main/java/org/elasticsearch/xpack/prelert/job/DataDescription.java, +        // TODO norelease, this can now be removed, +++ /dev/null, +++ b/elasticsearch/src/main/java/org/elasticsearch/xpack/prelert/PrelertPlugin.java, +import org.elasticsearch.xpack.prelert.action.PostDataAction;, +import org.elasticsearch.xpack.prelert.action.UpdateModelSnapshotAction;, +import org.elasticsearch.xpack.prelert.rest.job.RestPostDataAction;, +import org.elasticsearch.xpack.prelert.rest.modelsnapshots.RestUpdateModelSnapshotAction;, +++ b/elasticsearch/src/main/java/org/elasticsearch/xpack/prelert/job/DataDescription.java, +        // TODO norelease, this can now be removed, +++ /dev/null, +++ /dev/null, +++ b/elasticsearch/src/main/java/org/elasticsearch/xpack/prelert/PrelertPlugin.java, +import org.elasticsearch.xpack.prelert.action.PostDataAction;, +import org.elasticsearch.xpack.prelert.action.UpdateModelSnapshotAction;, +import org.elasticsearch.xpack.prelert.rest.job.RestPostDataAction;, +import org.elasticsearch.xpack.prelert.rest.modelsnapshots.RestUpdateModelSnapshotAction;, +++ b/elasticsearch/src/main/java/org/elasticsearch/xpack/prelert/job/DataDescription.java, +        // TODO norelease, this can now be removed, +++ /dev/null, +++ /dev/null, +++ b/elasticsearch/src/main/java/org/elasticsearch/xpack/prelert/job/process/autodetect/writer/AbstractJsonRecordReader.java, +    AbstractJsonRecordReader(JsonParser parser, Map<String, Integer> fieldMap, Logger logger) {, +++ b/elasticsearch/src/main/java/org/elasticsearch/xpack/prelert/PrelertPlugin.java, +import org.elasticsearch.xpack.prelert.action.PostDataAction;, +import org.elasticsearch.xpack.prelert.action.UpdateModelSnapshotAction;, +import org.elasticsearch.xpack.prelert.rest.job.RestPostDataAction;, +import org.elasticsearch.xpack.prelert.rest.modelsnapshots.RestUpdateModelSnapshotAction;, +++ b/elasticsearch/src/main/java/org/elasticsearch/xpack/prelert/job/DataDescription.java, +        // TODO norelease, this can now be removed, +++ /dev/null, +++ /dev/null, +++ b/elasticsearch/src/main/java/org/elasticsearch/xpack/prelert/job/process/autodetect/writer/AbstractJsonRecordReader.java, +    AbstractJsonRecordReader(JsonParser parser, Map<String, Integer> fieldMap, Logger logger) {, +++ b/elasticsearch/src/main/java/org/elasticsearch/xpack/prelert/job/process/autodetect/writer/JsonDataToProcessWriter.java, +        JsonRecordReader recordReader = new SimpleJsonRecordReader(parser, inFieldIndexes, logger);, +++ b/elasticsearch/src/main/java/org/elasticsearch/xpack/prelert/PrelertPlugin.java, +import org.elasticsearch.xpack.prelert.action.PostDataAction;, +import org.elasticsearch.xpack.prelert.action.UpdateModelSnapshotAction;, +import org.elasticsearch.xpack.prelert.rest.job.RestPostDataAction;, +import org.elasticsearch.xpack.prelert.rest.modelsnapshots.RestUpdateModelSnapshotAction;, +++ b/elasticsearch/src/main/java/org/elasticsearch/xpack/prelert/job/DataDescription.java, +        // TODO norelease, this can now be removed, +++ /dev/null, +++ /dev/null, +++ b/elasticsearch/src/main/java/org/elasticsearch/xpack/prelert/job/process/autodetect/writer/AbstractJsonRecordReader.java, +    AbstractJsonRecordReader(JsonParser parser, Map<String, Integer> fieldMap, Logger logger) {, +++ b/elasticsearch/src/main/java/org/elasticsearch/xpack/prelert/job/process/autodetect/writer/JsonDataToProcessWriter.java, +        JsonRecordReader recordReader = new SimpleJsonRecordReader(parser, inFieldIndexes, logger);, +++ b/elasticsearch/src/main/java/org/elasticsearch/xpack/prelert/job/process/autodetect/writer/SimpleJsonRecordReader.java, +    SimpleJsonRecordReader(JsonParser parser, Map<String, Integer> fieldMap, Logger logger) {, +        super(parser, fieldMap, logger);, +++ b/elasticsearch/src/main/java/org/elasticsearch/xpack/prelert/PrelertPlugin.java, +import org.elasticsearch.xpack.prelert.action.PostDataAction;, +import org.elasticsearch.xpack.prelert.action.UpdateModelSnapshotAction;, +import org.elasticsearch.xpack.prelert.rest.job.RestPostDataAction;, +import org.elasticsearch.xpack.prelert.rest.modelsnapshots.RestUpdateModelSnapshotAction;, +++ b/elasticsearch/src/main/java/org/elasticsearch/xpack/prelert/job/DataDescription.java, +        // TODO norelease, this can now be removed, +++ /dev/null, +++ /dev/null, +++ b/elasticsearch/src/main/java/org/elasticsearch/xpack/prelert/job/process/autodetect/writer/AbstractJsonRecordReader.java, +    AbstractJsonRecordReader(JsonParser parser, Map<String, Integer> fieldMap, Logger logger) {, +++ b/elasticsearch/src/main/java/org/elasticsearch/xpack/prelert/job/process/autodetect/writer/JsonDataToProcessWriter.java, +        JsonRecordReader recordReader = new SimpleJsonRecordReader(parser, inFieldIndexes, logger);, +++ b/elasticsearch/src/main/java/org/elasticsearch/xpack/prelert/job/process/autodetect/writer/SimpleJsonRecordReader.java, +    SimpleJsonRecordReader(JsonParser parser, Map<String, Integer> fieldMap, Logger logger) {, +        super(parser, fieldMap, logger);, +++ b/elasticsearch/src/main/java/org/elasticsearch/xpack/prelert/scheduler/ScheduledJob.java, +import org.elasticsearch.xpack.prelert.scheduler.extractor.DataExtractor;, +import org.elasticsearch.xpack.prelert.scheduler.extractor.DataExtractorFactory;, +    private static final Logger LOGGER = Loggers.getLogger(ScheduledJob.class);, +    private final DataExtractorFactory dataExtractorFactory;, +    private volatile DataExtractor dataExtractor;, +    ScheduledJob(String jobId, long frequencyMs, long queryDelayMs, DataExtractorFactory dataExtractorFactory,, +        this.dataExtractorFactory = dataExtractorFactory;, +        LOGGER.info("[{}] Lookback has finished", jobId);, +        if (dataExtractor != null) {, +        }, +        running = false;, +        LOGGER.trace("[{}] Searching data in: [{}, {})", jobId, start, end);, +        dataExtractor = dataExtractorFactory.newExtractor(start, end);, +        while (dataExtractor.hasNext()) {]
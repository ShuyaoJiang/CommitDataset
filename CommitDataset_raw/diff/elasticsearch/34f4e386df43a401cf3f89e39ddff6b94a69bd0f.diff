[+++ b/distribution/src/main/resources/bin/elasticsearch-plugin.bat, +IF DEFINED JAVA_HOME (, +  set JAVA=%JAVA_HOME%\bin\java.exe, +) ELSE (, +  FOR %%I IN (java.exe) DO set JAVA=%%~$PATH:I, +), +IF NOT EXIST "%JAVA%" (, +  ECHO Could not find any executable java binary. Please install java in your PATH or set JAVA_HOME 1>&2, +  EXIT /B 1, +), +"%JAVA%" %ES_JAVA_OPTS% -Des.path.home="%ES_HOME%" !properties! -cp "%ES_HOME%/lib/*;" "org.elasticsearch.plugins.PluginCli" !args!, +++ b/distribution/src/main/resources/bin/elasticsearch-plugin.bat, +IF DEFINED JAVA_HOME (, +  set JAVA=%JAVA_HOME%\bin\java.exe, +) ELSE (, +  FOR %%I IN (java.exe) DO set JAVA=%%~$PATH:I, +), +IF NOT EXIST "%JAVA%" (, +  ECHO Could not find any executable java binary. Please install java in your PATH or set JAVA_HOME 1>&2, +  EXIT /B 1, +), +"%JAVA%" %ES_JAVA_OPTS% -Des.path.home="%ES_HOME%" !properties! -cp "%ES_HOME%/lib/*;" "org.elasticsearch.plugins.PluginCli" !args!, +++ b/distribution/src/main/resources/bin/elasticsearch.bat, +"%JAVA%" %ES_JAVA_OPTS% %ES_PARAMS% -cp "%ES_CLASSPATH%" "org.elasticsearch.bootstrap.Elasticsearch" !newparams!, +++ b/distribution/src/main/resources/bin/elasticsearch-plugin.bat, +IF DEFINED JAVA_HOME (, +  set JAVA=%JAVA_HOME%\bin\java.exe, +) ELSE (, +  FOR %%I IN (java.exe) DO set JAVA=%%~$PATH:I, +), +IF NOT EXIST "%JAVA%" (, +  ECHO Could not find any executable java binary. Please install java in your PATH or set JAVA_HOME 1>&2, +  EXIT /B 1, +), +"%JAVA%" %ES_JAVA_OPTS% -Des.path.home="%ES_HOME%" !properties! -cp "%ES_HOME%/lib/*;" "org.elasticsearch.plugins.PluginCli" !args!, +++ b/distribution/src/main/resources/bin/elasticsearch.bat, +"%JAVA%" %ES_JAVA_OPTS% %ES_PARAMS% -cp "%ES_CLASSPATH%" "org.elasticsearch.bootstrap.Elasticsearch" !newparams!, +++ b/distribution/src/main/resources/bin/elasticsearch.in.bat, +IF DEFINED JAVA_HOME (, +  set JAVA=%JAVA_HOME%\bin\java.exe, +) ELSE (, +  FOR %%I IN (java.exe) DO set JAVA=%%~$PATH:I, +), +IF NOT EXIST "%JAVA%" (, +  ECHO Could not find any executable java binary. Please install java in your PATH or set JAVA_HOME 1>&2, +), +++ b/distribution/src/main/resources/bin/elasticsearch-plugin.bat, +IF DEFINED JAVA_HOME (, +  set JAVA=%JAVA_HOME%\bin\java.exe, +) ELSE (, +  FOR %%I IN (java.exe) DO set JAVA=%%~$PATH:I, +), +IF NOT EXIST "%JAVA%" (, +  ECHO Could not find any executable java binary. Please install java in your PATH or set JAVA_HOME 1>&2, +  EXIT /B 1, +), +"%JAVA%" %ES_JAVA_OPTS% -Des.path.home="%ES_HOME%" !properties! -cp "%ES_HOME%/lib/*;" "org.elasticsearch.plugins.PluginCli" !args!, +++ b/distribution/src/main/resources/bin/elasticsearch.bat, +"%JAVA%" %ES_JAVA_OPTS% %ES_PARAMS% -cp "%ES_CLASSPATH%" "org.elasticsearch.bootstrap.Elasticsearch" !newparams!, +++ b/distribution/src/main/resources/bin/elasticsearch.in.bat, +IF DEFINED JAVA_HOME (, +  set JAVA=%JAVA_HOME%\bin\java.exe, +) ELSE (, +  FOR %%I IN (java.exe) DO set JAVA=%%~$PATH:I, +), +IF NOT EXIST "%JAVA%" (, +  ECHO Could not find any executable java binary. Please install java in your PATH or set JAVA_HOME 1>&2, +), +++ b/distribution/src/main/resources/bin/service.bat, +IF DEFINED JAVA_HOME (, +  SET JAVA=%JAVA_HOME%\bin\java.exe, +) ELSE (, +  FOR %%I IN (java.exe) DO set JAVA=%%~$PATH:I, +), +IF NOT EXIST "%JAVA%" (, +  ECHO Could not find any executable java binary. Please install java in your PATH or set JAVA_HOME 1>&2, +  EXIT /B 1, +), +IF DEFINED JAVA_HOME GOTO :cont, +IF NOT "%JAVA:~-13%" == "\bin\java.exe" (, +  FOR /f "tokens=2 delims=[]" %%I IN ('dir %JAVA%') DO @set JAVA=%%I, +), +IF "%JAVA:~-13%" == "\bin\java.exe" (, +  SET JAVA_HOME=%JAVA:~0,-13%, +), +, +:cont, +"%JAVA%" -Xmx50M -version > nul 2>&1, +"%JAVA%" -Xmx50M -version 2>&1 | "%windir%\System32\find" "64-Bit" >nul:]
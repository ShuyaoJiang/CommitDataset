[+++ b/x-pack/plugin/sql/src/main/java/org/elasticsearch/xpack/sql/expression/Expressions.java, +import org.elasticsearch.xpack.sql.type.DataType;, +public final class Expressions {, +    private Expressions() {}, +        return e.dataType().isNumeric() ? TypeResolution.TYPE_RESOLVED : new TypeResolution(numericErrorMessage(e));, +    }, +, +    public static TypeResolution typeMustBeNumericOrDate(Expression e) {, +        return e.dataType().isNumeric() || e.dataType() == DataType.DATE ?, +            TypeResolution.TYPE_RESOLVED :, +            new TypeResolution(numericErrorMessage(e));, +    }, +, +    private static String numericErrorMessage(Expression e) {, +        return "Argument required to be numeric ('" + Expressions.name(e) + "' of type '" + e.dataType().esType + "')";, +++ b/x-pack/plugin/sql/src/main/java/org/elasticsearch/xpack/sql/expression/Expressions.java, +import org.elasticsearch.xpack.sql.type.DataType;, +public final class Expressions {, +    private Expressions() {}, +        return e.dataType().isNumeric() ? TypeResolution.TYPE_RESOLVED : new TypeResolution(numericErrorMessage(e));, +    }, +, +    public static TypeResolution typeMustBeNumericOrDate(Expression e) {, +        return e.dataType().isNumeric() || e.dataType() == DataType.DATE ?, +            TypeResolution.TYPE_RESOLVED :, +            new TypeResolution(numericErrorMessage(e));, +    }, +, +    private static String numericErrorMessage(Expression e) {, +        return "Argument required to be numeric ('" + Expressions.name(e) + "' of type '" + e.dataType().esType + "')";, +++ b/x-pack/plugin/sql/src/main/java/org/elasticsearch/xpack/sql/expression/function/aggregate/Max.java, +import org.elasticsearch.xpack.sql.expression.Expressions;, +import java.util.List;, +, +, +    @Override, +    protected TypeResolution resolveType() {, +        return Expressions.typeMustBeNumericOrDate(field());, +    }, +++ b/x-pack/plugin/sql/src/main/java/org/elasticsearch/xpack/sql/expression/Expressions.java, +import org.elasticsearch.xpack.sql.type.DataType;, +public final class Expressions {, +    private Expressions() {}, +        return e.dataType().isNumeric() ? TypeResolution.TYPE_RESOLVED : new TypeResolution(numericErrorMessage(e));, +    }, +, +    public static TypeResolution typeMustBeNumericOrDate(Expression e) {, +        return e.dataType().isNumeric() || e.dataType() == DataType.DATE ?, +            TypeResolution.TYPE_RESOLVED :, +            new TypeResolution(numericErrorMessage(e));, +    }, +, +    private static String numericErrorMessage(Expression e) {, +        return "Argument required to be numeric ('" + Expressions.name(e) + "' of type '" + e.dataType().esType + "')";, +++ b/x-pack/plugin/sql/src/main/java/org/elasticsearch/xpack/sql/expression/function/aggregate/Max.java, +import org.elasticsearch.xpack.sql.expression.Expressions;, +import java.util.List;, +, +, +    @Override, +    protected TypeResolution resolveType() {, +        return Expressions.typeMustBeNumericOrDate(field());, +    }, +++ b/x-pack/plugin/sql/src/main/java/org/elasticsearch/xpack/sql/expression/function/aggregate/Min.java, +import org.elasticsearch.xpack.sql.expression.Expressions;, +import java.util.List;, +, +, +    @Override, +    protected TypeResolution resolveType() {, +        return Expressions.typeMustBeNumericOrDate(field());, +    }, +++ b/x-pack/plugin/sql/src/main/java/org/elasticsearch/xpack/sql/expression/Expressions.java, +import org.elasticsearch.xpack.sql.type.DataType;, +public final class Expressions {, +    private Expressions() {}, +        return e.dataType().isNumeric() ? TypeResolution.TYPE_RESOLVED : new TypeResolution(numericErrorMessage(e));, +    }, +, +    public static TypeResolution typeMustBeNumericOrDate(Expression e) {, +        return e.dataType().isNumeric() || e.dataType() == DataType.DATE ?, +            TypeResolution.TYPE_RESOLVED :, +            new TypeResolution(numericErrorMessage(e));, +    }, +, +    private static String numericErrorMessage(Expression e) {, +        return "Argument required to be numeric ('" + Expressions.name(e) + "' of type '" + e.dataType().esType + "')";, +++ b/x-pack/plugin/sql/src/main/java/org/elasticsearch/xpack/sql/expression/function/aggregate/Max.java, +import org.elasticsearch.xpack.sql.expression.Expressions;, +import java.util.List;, +, +, +    @Override, +    protected TypeResolution resolveType() {, +        return Expressions.typeMustBeNumericOrDate(field());, +    }, +++ b/x-pack/plugin/sql/src/main/java/org/elasticsearch/xpack/sql/expression/function/aggregate/Min.java, +import org.elasticsearch.xpack.sql.expression.Expressions;, +import java.util.List;, +]
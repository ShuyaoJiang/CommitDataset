[+++ b/plugin/src/main/java/org/elasticsearch/xpack/ml/action/StartDatafeedAction.java, +import org.elasticsearch.action.support.IndicesOptions;, +import org.elasticsearch.cluster.routing.IndexRoutingTable;, +                               IndexNameExpressionResolver indexNameExpressionResolver) {, +                        waitForDatafeedStarted(persistentTask.getId(), request, listener);, +        private final IndexNameExpressionResolver resolver;, +            this.resolver = new IndexNameExpressionResolver(settings);, +            Assignment assignment = selectNode(logger, request.getDatafeedId(), clusterState, resolver);, +    static Assignment selectNode(Logger logger, String datafeedId, ClusterState clusterState,, +                                 IndexNameExpressionResolver resolver) {, +        String reason = verifyIndicesActive(logger, datafeed, clusterState, resolver);, +        if (reason != null) {, +            return new Assignment(null, reason);, +        }, +    private static String verifyIndicesActive(Logger logger, DatafeedConfig datafeed, ClusterState clusterState,, +                                              IndexNameExpressionResolver resolver) {, +        List<String> indices = datafeed.getIndexes();, +        for (String index : indices) {, +            String[] concreteIndices;, +            String reason = "cannot start datafeed [" + datafeed.getId() + "] because index [", +                    + index + "] does not exist, is closed, or is still initializing.";, +, +            try {, +                concreteIndices = resolver.concreteIndexNames(clusterState, IndicesOptions.lenientExpandOpen(), index);, +                if (concreteIndices.length == 0) {, +                    logger.debug(reason);, +                    return reason;, +                }, +            } catch (Exception e) {, +                logger.debug(reason);, +                return reason;, +            }, +, +            for (String concreteIndex : concreteIndices) {, +                IndexRoutingTable routingTable = clusterState.getRoutingTable().index(concreteIndex);, +                if (routingTable == null || !routingTable.allPrimaryShardsActive()) {, +                    reason = "cannot start datafeed [" + datafeed.getId() + "] because index [", +                            + concreteIndex + "] does not have all primary shards active yet.";, +                    logger.debug(reason);, +                    return reason;, +                }, +            }, +        }, +        return null;, +    }, +, +++ b/plugin/src/main/java/org/elasticsearch/xpack/ml/action/StartDatafeedAction.java, +import org.elasticsearch.action.support.IndicesOptions;, +import org.elasticsearch.cluster.routing.IndexRoutingTable;, +                               IndexNameExpressionResolver indexNameExpressionResolver) {, +                        waitForDatafeedStarted(persistentTask.getId(), request, listener);, +        private final IndexNameExpressionResolver resolver;, +            this.resolver = new IndexNameExpressionResolver(settings);, +            Assignment assignment = selectNode(logger, request.getDatafeedId(), clusterState, resolver);, +    static Assignment selectNode(Logger logger, String datafeedId, ClusterState clusterState,, +                                 IndexNameExpressionResolver resolver) {, +        String reason = verifyIndicesActive(logger, datafeed, clusterState, resolver);, +        if (reason != null) {, +            return new Assignment(null, reason);, +        }, +    private static String verifyIndicesActive(Logger logger, DatafeedConfig datafeed, ClusterState clusterState,, +                                              IndexNameExpressionResolver resolver) {, +        List<String> indices = datafeed.getIndexes();, +        for (String index : indices) {, +            String[] concreteIndices;, +            String reason = "cannot start datafeed [" + datafeed.getId() + "] because index [", +                    + index + "] does not exist, is closed, or is still initializing.";, +, +            try {, +                concreteIndices = resolver.concreteIndexNames(clusterState, IndicesOptions.lenientExpandOpen(), index);, +                if (concreteIndices.length == 0) {, +                    logger.debug(reason);, +                    return reason;, +                }, +            } catch (Exception e) {, +                logger.debug(reason);, +                return reason;, +            }, +, +            for (String concreteIndex : concreteIndices) {, +                IndexRoutingTable routingTable = clusterState.getRoutingTable().index(concreteIndex);, +                if (routingTable == null || !routingTable.allPrimaryShardsActive()) {, +                    reason = "cannot start datafeed [" + datafeed.getId() + "] because index [", +                            + concreteIndex + "] does not have all primary shards active yet.";, +                    logger.debug(reason);, +                    return reason;, +                }, +            }, +        }, +        return null;, +    }, +, +++ b/plugin/src/test/java/org/elasticsearch/xpack/ml/action/DatafeedJobsIT.java, +import org.elasticsearch.action.admin.cluster.health.ClusterHealthRequest;, +import org.elasticsearch.action.admin.cluster.health.ClusterHealthResponse;, +        ClusterHealthResponse r = client().admin().cluster().prepareHealth("data-1", "data-2").setWaitForYellowStatus().get();, +        List<String> t = new ArrayList<>(2);, +        t.add("data-1");, +        t.add("data-2");, +        DatafeedConfig datafeedConfig = createDatafeed(job.getId() + "-datafeed", job.getId(), t);]
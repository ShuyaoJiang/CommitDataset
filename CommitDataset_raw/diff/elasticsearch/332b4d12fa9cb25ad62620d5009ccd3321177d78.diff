[+++ b/core/src/test/java/org/elasticsearch/search/fetch/subphase/InnerHitsIT.java, +import org.elasticsearch.common.settings.Settings;, +                        // number_of_shards = 1, because then we catch the expected exception in the same way., +                        // (See expectThrows(...) below), +                        .setSettings(Settings.builder().put("index.number_of_shards", 1)), +        Exception e = expectThrows(Exception.class, () -> client().prepareSearch("articles").setQuery(nestedQuery("comments.messages",, +            matchQuery("comments.messages.message", "fox"), ScoreMode.Avg).innerHit(new InnerHitBuilder())).get());, +            "not nested. All parent fields need to be nested fields too", e.getCause().getCause().getMessage());, +        e = expectThrows(Exception.class, () -> client().prepareSearch("articles").setQuery(nestedQuery("comments.messages",, +            .setFetchSourceContext(new FetchSourceContext(true)))).get());, +            "not nested. All parent fields need to be nested fields too", e.getCause().getCause().getMessage());, +        SearchResponse response = client().prepareSearch("articles")]
[+++ b/core/src/main/java/org/elasticsearch/action/admin/indices/rollover/TransportRolloverAction.java, +import java.util.Locale;, +            return String.join("-", sourceIndexName.substring(0, numberIndex), String.format(Locale.ROOT, "%06d", ++counter));, +++ b/core/src/main/java/org/elasticsearch/action/admin/indices/rollover/TransportRolloverAction.java, +import java.util.Locale;, +            return String.join("-", sourceIndexName.substring(0, numberIndex), String.format(Locale.ROOT, "%06d", ++counter));, +++ b/core/src/main/java/org/elasticsearch/action/ingest/WriteableIngestDocument.java, +        @SuppressWarnings("unchecked"), +        Map<String, String> ingestMetadata = (Map<String, String>) in.readGenericValue();, +        out.writeGenericValue(ingestDocument.getIngestMetadata());, +        builder.startObject("_ingest");, +        for (Map.Entry<String, String> ingestMetadata : ingestDocument.getIngestMetadata().entrySet()) {, +            builder.field(ingestMetadata.getKey(), ingestMetadata.getValue());, +        }, +        builder.endObject();, +++ b/core/src/main/java/org/elasticsearch/action/admin/indices/rollover/TransportRolloverAction.java, +import java.util.Locale;, +            return String.join("-", sourceIndexName.substring(0, numberIndex), String.format(Locale.ROOT, "%06d", ++counter));, +++ b/core/src/main/java/org/elasticsearch/action/ingest/WriteableIngestDocument.java, +        @SuppressWarnings("unchecked"), +        Map<String, String> ingestMetadata = (Map<String, String>) in.readGenericValue();, +        out.writeGenericValue(ingestDocument.getIngestMetadata());, +        builder.startObject("_ingest");, +        for (Map.Entry<String, String> ingestMetadata : ingestDocument.getIngestMetadata().entrySet()) {, +            builder.field(ingestMetadata.getKey(), ingestMetadata.getValue());, +        }, +        builder.endObject();, +++ b/core/src/main/java/org/elasticsearch/client/transport/support/TransportProxyClient.java, +++ b/core/src/main/java/org/elasticsearch/action/admin/indices/rollover/TransportRolloverAction.java, +import java.util.Locale;, +            return String.join("-", sourceIndexName.substring(0, numberIndex), String.format(Locale.ROOT, "%06d", ++counter));, +++ b/core/src/main/java/org/elasticsearch/action/ingest/WriteableIngestDocument.java, +        @SuppressWarnings("unchecked"), +        Map<String, String> ingestMetadata = (Map<String, String>) in.readGenericValue();, +        out.writeGenericValue(ingestDocument.getIngestMetadata());, +        builder.startObject("_ingest");, +        for (Map.Entry<String, String> ingestMetadata : ingestDocument.getIngestMetadata().entrySet()) {, +            builder.field(ingestMetadata.getKey(), ingestMetadata.getValue());, +        }, +        builder.endObject();, +++ b/core/src/main/java/org/elasticsearch/client/transport/support/TransportProxyClient.java, +++ b/core/src/main/java/org/elasticsearch/cluster/metadata/MetaDataCreateIndexService.java, +++ b/core/src/main/java/org/elasticsearch/action/admin/indices/rollover/TransportRolloverAction.java, +import java.util.Locale;, +            return String.join("-", sourceIndexName.substring(0, numberIndex), String.format(Locale.ROOT, "%06d", ++counter));, +++ b/core/src/main/java/org/elasticsearch/action/ingest/WriteableIngestDocument.java, +        @SuppressWarnings("unchecked"), +        Map<String, String> ingestMetadata = (Map<String, String>) in.readGenericValue();, +        out.writeGenericValue(ingestDocument.getIngestMetadata());, +        builder.startObject("_ingest");, +        for (Map.Entry<String, String> ingestMetadata : ingestDocument.getIngestMetadata().entrySet()) {, +            builder.field(ingestMetadata.getKey(), ingestMetadata.getValue());, +        }, +        builder.endObject();, +++ b/core/src/main/java/org/elasticsearch/client/transport/support/TransportProxyClient.java, +++ b/core/src/main/java/org/elasticsearch/cluster/metadata/MetaDataCreateIndexService.java, +++ b/core/src/main/java/org/elasticsearch/ingest/CompoundProcessor.java, +        Map<String, String> ingestMetadata = ingestDocument.getIngestMetadata();, +        Map<String, String> ingestMetadata = ingestDocument.getIngestMetadata();, +++ b/core/src/main/java/org/elasticsearch/action/admin/indices/rollover/TransportRolloverAction.java, +import java.util.Locale;, +            return String.join("-", sourceIndexName.substring(0, numberIndex), String.format(Locale.ROOT, "%06d", ++counter));, +++ b/core/src/main/java/org/elasticsearch/action/ingest/WriteableIngestDocument.java, +        @SuppressWarnings("unchecked"), +        Map<String, String> ingestMetadata = (Map<String, String>) in.readGenericValue();, +        out.writeGenericValue(ingestDocument.getIngestMetadata());, +        builder.startObject("_ingest");, +        for (Map.Entry<String, String> ingestMetadata : ingestDocument.getIngestMetadata().entrySet()) {, +            builder.field(ingestMetadata.getKey(), ingestMetadata.getValue());, +        }, +        builder.endObject();, +++ b/core/src/main/java/org/elasticsearch/client/transport/support/TransportProxyClient.java, +++ b/core/src/main/java/org/elasticsearch/cluster/metadata/MetaDataCreateIndexService.java, +++ b/core/src/main/java/org/elasticsearch/ingest/CompoundProcessor.java, +        Map<String, String> ingestMetadata = ingestDocument.getIngestMetadata();, +        Map<String, String> ingestMetadata = ingestDocument.getIngestMetadata();, +++ b/core/src/main/java/org/elasticsearch/ingest/IngestDocument.java, +    private final Map<String, String> ingestMetadata;, +    public IngestDocument(Map<String, Object> sourceAndMetadata, Map<String, String> ingestMetadata) {, +    public Map<String, String> getIngestMetadata() {, +++ b/core/src/main/java/org/elasticsearch/action/admin/indices/rollover/TransportRolloverAction.java, +import java.util.Locale;, +            return String.join("-", sourceIndexName.substring(0, numberIndex), String.format(Locale.ROOT, "%06d", ++counter));, +++ b/core/src/main/java/org/elasticsearch/action/ingest/WriteableIngestDocument.java, +        @SuppressWarnings("unchecked"), +        Map<String, String> ingestMetadata = (Map<String, String>) in.readGenericValue();, +        out.writeGenericValue(ingestDocument.getIngestMetadata());, +        builder.startObject("_ingest");, +        for (Map.Entry<String, String> ingestMetadata : ingestDocument.getIngestMetadata().entrySet()) {, +            builder.field(ingestMetadata.getKey(), ingestMetadata.getValue());, +        }, +        builder.endObject();, +++ b/core/src/main/java/org/elasticsearch/client/transport/support/TransportProxyClient.java, +++ b/core/src/main/java/org/elasticsearch/cluster/metadata/MetaDataCreateIndexService.java, +++ b/core/src/main/java/org/elasticsearch/ingest/CompoundProcessor.java, +        Map<String, String> ingestMetadata = ingestDocument.getIngestMetadata();, +        Map<String, String> ingestMetadata = ingestDocument.getIngestMetadata();, +++ b/core/src/main/java/org/elasticsearch/ingest/IngestDocument.java, +    private final Map<String, String> ingestMetadata;, +    public IngestDocument(Map<String, Object> sourceAndMetadata, Map<String, String> ingestMetadata) {]
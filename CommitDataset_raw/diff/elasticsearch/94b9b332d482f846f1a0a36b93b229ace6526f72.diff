[+++ b/elasticsearch/x-pack/security/src/main/java/org/elasticsearch/xpack/security/InternalClient.java, +import org.elasticsearch.xpack.security.authc.AuthenticationService;, +        this.signUserHeader = AuthenticationService.SIGN_USER_HEADER.get(settings);, +++ b/elasticsearch/x-pack/security/src/main/java/org/elasticsearch/xpack/security/InternalClient.java, +import org.elasticsearch.xpack.security.authc.AuthenticationService;, +        this.signUserHeader = AuthenticationService.SIGN_USER_HEADER.get(settings);, +++ b/elasticsearch/x-pack/security/src/main/java/org/elasticsearch/xpack/security/Security.java, +import org.elasticsearch.xpack.security.authc.AuthenticationService;, +import org.elasticsearch.xpack.security.authz.AuthorizationService;, +        AuthenticationService.addSettings(settingsList);, +        AuthorizationService.addSettings(settingsList);, +++ b/elasticsearch/x-pack/security/src/main/java/org/elasticsearch/xpack/security/InternalClient.java, +import org.elasticsearch.xpack.security.authc.AuthenticationService;, +        this.signUserHeader = AuthenticationService.SIGN_USER_HEADER.get(settings);, +++ b/elasticsearch/x-pack/security/src/main/java/org/elasticsearch/xpack/security/Security.java, +import org.elasticsearch.xpack.security.authc.AuthenticationService;, +import org.elasticsearch.xpack.security.authz.AuthorizationService;, +        AuthenticationService.addSettings(settingsList);, +        AuthorizationService.addSettings(settingsList);, +++ b/elasticsearch/x-pack/security/src/main/java/org/elasticsearch/xpack/security/SecurityContext.java, +import org.elasticsearch.xpack.security.authc.AuthenticationService;, +        this.signUserHeader = AuthenticationService.SIGN_USER_HEADER.get(settings);, +++ b/elasticsearch/x-pack/security/src/main/java/org/elasticsearch/xpack/security/InternalClient.java, +import org.elasticsearch.xpack.security.authc.AuthenticationService;, +        this.signUserHeader = AuthenticationService.SIGN_USER_HEADER.get(settings);, +++ b/elasticsearch/x-pack/security/src/main/java/org/elasticsearch/xpack/security/Security.java, +import org.elasticsearch.xpack.security.authc.AuthenticationService;, +import org.elasticsearch.xpack.security.authz.AuthorizationService;, +        AuthenticationService.addSettings(settingsList);, +        AuthorizationService.addSettings(settingsList);, +++ b/elasticsearch/x-pack/security/src/main/java/org/elasticsearch/xpack/security/SecurityContext.java, +import org.elasticsearch.xpack.security.authc.AuthenticationService;, +        this.signUserHeader = AuthenticationService.SIGN_USER_HEADER.get(settings);, +++ b/elasticsearch/x-pack/security/src/main/java/org/elasticsearch/xpack/security/action/filter/SecurityActionFilter.java, +import org.elasticsearch.xpack.security.authc.AuthenticationService;, +import org.elasticsearch.xpack.security.authz.AuthorizationService;, +++ b/elasticsearch/x-pack/security/src/main/java/org/elasticsearch/xpack/security/InternalClient.java, +import org.elasticsearch.xpack.security.authc.AuthenticationService;, +        this.signUserHeader = AuthenticationService.SIGN_USER_HEADER.get(settings);, +++ b/elasticsearch/x-pack/security/src/main/java/org/elasticsearch/xpack/security/Security.java, +import org.elasticsearch.xpack.security.authc.AuthenticationService;, +import org.elasticsearch.xpack.security.authz.AuthorizationService;, +        AuthenticationService.addSettings(settingsList);, +        AuthorizationService.addSettings(settingsList);, +++ b/elasticsearch/x-pack/security/src/main/java/org/elasticsearch/xpack/security/SecurityContext.java, +import org.elasticsearch.xpack.security.authc.AuthenticationService;, +        this.signUserHeader = AuthenticationService.SIGN_USER_HEADER.get(settings);, +++ b/elasticsearch/x-pack/security/src/main/java/org/elasticsearch/xpack/security/action/filter/SecurityActionFilter.java, +import org.elasticsearch.xpack.security.authc.AuthenticationService;, +import org.elasticsearch.xpack.security.authz.AuthorizationService;, +++ b/elasticsearch/x-pack/security/src/main/java/org/elasticsearch/xpack/security/action/interceptor/BulkRequestInterceptor.java, +import org.elasticsearch.xpack.security.authz.AuthorizationService;, +        IndicesAccessControl indicesAccessControl = threadContext.getTransient(AuthorizationService.INDICES_PERMISSIONS_KEY);, +++ b/elasticsearch/x-pack/security/src/main/java/org/elasticsearch/xpack/security/InternalClient.java, +import org.elasticsearch.xpack.security.authc.AuthenticationService;, +        this.signUserHeader = AuthenticationService.SIGN_USER_HEADER.get(settings);, +++ b/elasticsearch/x-pack/security/src/main/java/org/elasticsearch/xpack/security/Security.java, +import org.elasticsearch.xpack.security.authc.AuthenticationService;, +import org.elasticsearch.xpack.security.authz.AuthorizationService;, +        AuthenticationService.addSettings(settingsList);, +        AuthorizationService.addSettings(settingsList);, +++ b/elasticsearch/x-pack/security/src/main/java/org/elasticsearch/xpack/security/SecurityContext.java, +import org.elasticsearch.xpack.security.authc.AuthenticationService;, +        this.signUserHeader = AuthenticationService.SIGN_USER_HEADER.get(settings);, +++ b/elasticsearch/x-pack/security/src/main/java/org/elasticsearch/xpack/security/action/filter/SecurityActionFilter.java, +import org.elasticsearch.xpack.security.authc.AuthenticationService;, +import org.elasticsearch.xpack.security.authz.AuthorizationService;, +++ b/elasticsearch/x-pack/security/src/main/java/org/elasticsearch/xpack/security/action/interceptor/BulkRequestInterceptor.java, +import org.elasticsearch.xpack.security.authz.AuthorizationService;, +        IndicesAccessControl indicesAccessControl = threadContext.getTransient(AuthorizationService.INDICES_PERMISSIONS_KEY);, +++ b/elasticsearch/x-pack/security/src/main/java/org/elasticsearch/xpack/security/action/interceptor/FieldAndDocumentLevelSecurityRequestInterceptor.java, +import org.elasticsearch.xpack.security.authz.AuthorizationService;, +        IndicesAccessControl indicesAccessControl = threadContext.getTransient(AuthorizationService.INDICES_PERMISSIONS_KEY);, +++ b/elasticsearch/x-pack/security/src/main/java/org/elasticsearch/xpack/security/InternalClient.java, +import org.elasticsearch.xpack.security.authc.AuthenticationService;, +        this.signUserHeader = AuthenticationService.SIGN_USER_HEADER.get(settings);, +++ b/elasticsearch/x-pack/security/src/main/java/org/elasticsearch/xpack/security/Security.java, +import org.elasticsearch.xpack.security.authc.AuthenticationService;, +import org.elasticsearch.xpack.security.authz.AuthorizationService;, +        AuthenticationService.addSettings(settingsList);, +        AuthorizationService.addSettings(settingsList);, +++ b/elasticsearch/x-pack/security/src/main/java/org/elasticsearch/xpack/security/SecurityContext.java, +import org.elasticsearch.xpack.security.authc.AuthenticationService;, +        this.signUserHeader = AuthenticationService.SIGN_USER_HEADER.get(settings);, +++ b/elasticsearch/x-pack/security/src/main/java/org/elasticsearch/xpack/security/action/filter/SecurityActionFilter.java, +import org.elasticsearch.xpack.security.authc.AuthenticationService;, +import org.elasticsearch.xpack.security.authz.AuthorizationService;, +++ b/elasticsearch/x-pack/security/src/main/java/org/elasticsearch/xpack/security/action/interceptor/BulkRequestInterceptor.java, +import org.elasticsearch.xpack.security.authz.AuthorizationService;, +        IndicesAccessControl indicesAccessControl = threadContext.getTransient(AuthorizationService.INDICES_PERMISSIONS_KEY);, +++ b/elasticsearch/x-pack/security/src/main/java/org/elasticsearch/xpack/security/action/interceptor/FieldAndDocumentLevelSecurityRequestInterceptor.java, +import org.elasticsearch.xpack.security.authz.AuthorizationService;, +        IndicesAccessControl indicesAccessControl = threadContext.getTransient(AuthorizationService.INDICES_PERMISSIONS_KEY);, +++ b/elasticsearch/x-pack/security/src/main/java/org/elasticsearch/xpack/security/authc/AuthenticationModule.java, +        bind(AuthenticationService.class).asEagerSingleton();, +++ b/elasticsearch/x-pack/security/src/main/java/org/elasticsearch/xpack/security/InternalClient.java, +import org.elasticsearch.xpack.security.authc.AuthenticationService;, +        this.signUserHeader = AuthenticationService.SIGN_USER_HEADER.get(settings);, +++ b/elasticsearch/x-pack/security/src/main/java/org/elasticsearch/xpack/security/Security.java, +import org.elasticsearch.xpack.security.authc.AuthenticationService;]
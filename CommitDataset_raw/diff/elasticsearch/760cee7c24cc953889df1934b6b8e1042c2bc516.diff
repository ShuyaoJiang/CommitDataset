[+++ b/src/main/java/org/elasticsearch/search/aggregations/bucket/tophits/InternalTopHits.java, +import org.apache.lucene.search.ScoreDoc;, +import org.apache.lucene.search.Sort;, +import org.apache.lucene.search.TopDocs;, +import org.apache.lucene.search.TopFieldDocs;, +                int position;, +                do {, +                    position = tracker[scoreDoc.shardIndex]++;, +                } while (shardDocs[scoreDoc.shardIndex].scoreDocs[position] != scoreDoc);, +                hits[i] = (InternalSearchHit) shardHits[scoreDoc.shardIndex].getAt(position);, +++ b/src/main/java/org/elasticsearch/search/aggregations/bucket/tophits/InternalTopHits.java, +import org.apache.lucene.search.ScoreDoc;, +import org.apache.lucene.search.Sort;, +import org.apache.lucene.search.TopDocs;, +import org.apache.lucene.search.TopFieldDocs;, +                int position;, +                do {, +                    position = tracker[scoreDoc.shardIndex]++;, +                } while (shardDocs[scoreDoc.shardIndex].scoreDocs[position] != scoreDoc);, +                hits[i] = (InternalSearchHit) shardHits[scoreDoc.shardIndex].getAt(position);, +++ b/src/test/java/org/elasticsearch/search/aggregations/bucket/TopHitsTests.java, +            logger.info(i + ": top_hits: [" + hits.getAt(i).id() + "][" + hits.getAt(i).sortValues()[0] + "] control: [" + controlHits.getAt(i).id() + "][" + controlHits.getAt(i).sortValues()[0] + "]");]
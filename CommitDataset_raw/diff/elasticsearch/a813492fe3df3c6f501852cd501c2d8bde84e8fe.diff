[+++ b/test/framework/src/main/java/org/elasticsearch/test/rest/yaml/Stash.java, +            pathBuilder.append(element.next().toString().replace(".", "\\."));, +                pathBuilder.append(element.next().toString().replace(".", "\\."));, +++ b/test/framework/src/main/java/org/elasticsearch/test/rest/yaml/Stash.java, +            pathBuilder.append(element.next().toString().replace(".", "\\."));, +                pathBuilder.append(element.next().toString().replace(".", "\\."));, +++ b/test/framework/src/test/java/org/elasticsearch/test/rest/yaml/StashTests.java, +        String topLevelKey;, +        if (randomBoolean()) {, +            topLevelKey = randomAlphaOfLength(2) + "." + randomAlphaOfLength(2);, +        } else {, +            topLevelKey = randomAlphaOfLength(5);, +        }, +        stash.stashValue("body", singletonMap(topLevelKey, Arrays.asList("a", "b")));, +            expected = singletonMap(topLevelKey, Arrays.asList("test", "boooooh!"));, +            map = singletonMap(topLevelKey, Arrays.asList("test", "${body.$_path}oooooh!"));, +            expected = singletonMap(topLevelKey, Arrays.asList("test", "b"));, +            map = singletonMap(topLevelKey, Arrays.asList("test", "$body.$_path"));, +        String topLevelKey;, +        if (randomBoolean()) {, +            topLevelKey = randomAlphaOfLength(2) + "." + randomAlphaOfLength(2);, +        } else {, +            topLevelKey = randomAlphaOfLength(5);, +        }, +        stash.stashValue("body", singletonMap(topLevelKey, singletonMap("a", "b")));, +            expected = singletonMap(topLevelKey, singletonMap("a", "boooooh!"));, +            map = singletonMap(topLevelKey, singletonMap("a", "${body.$_path}oooooh!"));, +            expected = singletonMap(topLevelKey, singletonMap("a", "b"));, +            map = singletonMap(topLevelKey, singletonMap("a", "$body.$_path"));]
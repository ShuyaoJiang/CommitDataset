[+++ b/build.gradle, +      lucene:             "${luceneVersion}",, +    if (versions.lucene.contains('-snapshot')) {, +      String revision = (luceneVersion =~ /\d\.\d\.\d-snapshot-(\d+)/)[0][1], +        url "http://s3.amazonaws.com/download.elasticsearch.org/lucenesnapshots/${revision}", +      }, +++ b/build.gradle, +      lucene:             "${luceneVersion}",, +    if (versions.lucene.contains('-snapshot')) {, +      String revision = (luceneVersion =~ /\d\.\d\.\d-snapshot-(\d+)/)[0][1], +        url "http://s3.amazonaws.com/download.elasticsearch.org/lucenesnapshots/${revision}", +      }, +++ b/buildSrc/build.gradle, +  jcenter(), +  compile 'com.netflix.nebula:gradle-info-plugin:3.0.3', +  compile 'org.eclipse.jgit:org.eclipse.jgit:3.2.0.201312181205-r', +  compile 'com.perforce:p4java:2012.3.551082' // THIS IS SUPPOSED TO BE OPTIONAL IN THE FUTURE...., +        'version': props.getProperty('version'),, +        'luceneVersion': props.getProperty('luceneVersion'), +++ b/build.gradle, +      lucene:             "${luceneVersion}",, +    if (versions.lucene.contains('-snapshot')) {, +      String revision = (luceneVersion =~ /\d\.\d\.\d-snapshot-(\d+)/)[0][1], +        url "http://s3.amazonaws.com/download.elasticsearch.org/lucenesnapshots/${revision}", +      }, +++ b/buildSrc/build.gradle, +  jcenter(), +  compile 'com.netflix.nebula:gradle-info-plugin:3.0.3', +  compile 'org.eclipse.jgit:org.eclipse.jgit:3.2.0.201312181205-r', +  compile 'com.perforce:p4java:2012.3.551082' // THIS IS SUPPOSED TO BE OPTIONAL IN THE FUTURE...., +        'version': props.getProperty('version'),, +        'luceneVersion': props.getProperty('luceneVersion'), +++ b/buildSrc/src/main/groovy/org/elasticsearch/gradle/BuildPlugin.groovy, +import org.gradle.api.tasks.bundling.Jar, +        // these plugins add lots of info to our jars, +        project.pluginManager.apply('nebula.info-broker'), +        project.pluginManager.apply('nebula.info-basic'), +        project.pluginManager.apply('nebula.info-java'), +        project.pluginManager.apply('nebula.info-scm'), +        project.pluginManager.apply('nebula.info-jar'), +        configureJarManifest(project), +    /** Adds additional manifest info to jars */, +    static void configureJarManifest(Project project) {, +        project.afterEvaluate {, +            project.tasks.withType(Jar) { Jar jarTask ->, +                manifest {, +                    attributes('X-Compile-Elasticsearch-Version': ElasticsearchProperties.version,, +                               'X-Compile-Lucene-Version': ElasticsearchProperties.luceneVersion), +                }, +            }, +        }, +    }, +, +++ b/build.gradle, +      lucene:             "${luceneVersion}",, +    if (versions.lucene.contains('-snapshot')) {, +      String revision = (luceneVersion =~ /\d\.\d\.\d-snapshot-(\d+)/)[0][1], +        url "http://s3.amazonaws.com/download.elasticsearch.org/lucenesnapshots/${revision}", +      }, +++ b/buildSrc/build.gradle, +  jcenter(), +  compile 'com.netflix.nebula:gradle-info-plugin:3.0.3', +  compile 'org.eclipse.jgit:org.eclipse.jgit:3.2.0.201312181205-r', +  compile 'com.perforce:p4java:2012.3.551082' // THIS IS SUPPOSED TO BE OPTIONAL IN THE FUTURE...., +        'version': props.getProperty('version'),, +        'luceneVersion': props.getProperty('luceneVersion'), +++ b/buildSrc/src/main/groovy/org/elasticsearch/gradle/BuildPlugin.groovy, +import org.gradle.api.tasks.bundling.Jar, +        // these plugins add lots of info to our jars, +        project.pluginManager.apply('nebula.info-broker'), +        project.pluginManager.apply('nebula.info-basic'), +        project.pluginManager.apply('nebula.info-java'), +        project.pluginManager.apply('nebula.info-scm'), +        project.pluginManager.apply('nebula.info-jar'), +        configureJarManifest(project), +    /** Adds additional manifest info to jars */, +    static void configureJarManifest(Project project) {, +        project.afterEvaluate {, +            project.tasks.withType(Jar) { Jar jarTask ->, +                manifest {, +                    attributes('X-Compile-Elasticsearch-Version': ElasticsearchProperties.version,, +                               'X-Compile-Lucene-Version': ElasticsearchProperties.luceneVersion), +                }, +            }, +        }, +    }, +, +++ b/buildSrc/src/main/groovy/org/elasticsearch/gradle/ElasticsearchProperties.groovy, +    static final String luceneVersion, +        luceneVersion = props.getProperty('luceneVersion'), +++ b/build.gradle, +      lucene:             "${luceneVersion}",, +    if (versions.lucene.contains('-snapshot')) {, +      String revision = (luceneVersion =~ /\d\.\d\.\d-snapshot-(\d+)/)[0][1], +        url "http://s3.amazonaws.com/download.elasticsearch.org/lucenesnapshots/${revision}", +      }, +++ b/buildSrc/build.gradle, +  jcenter(), +  compile 'com.netflix.nebula:gradle-info-plugin:3.0.3', +  compile 'org.eclipse.jgit:org.eclipse.jgit:3.2.0.201312181205-r']
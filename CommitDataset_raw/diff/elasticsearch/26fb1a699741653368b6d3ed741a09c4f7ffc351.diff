[+++ b/plugin/src/main/java/org/elasticsearch/xpack/security/authz/permission/FieldPermissions.java, +        if (!containsAllField(grantedFields) && !containsAllField(deniedFields)) {, +            // It is not explicitly stated whether _all should be allowed/denied, +    private static boolean containsAllField(String[] fields) {, +        return fields != null && Arrays.stream(fields).anyMatch(AllFieldMapper.NAME::equals);, +    }, +, +++ b/plugin/src/main/java/org/elasticsearch/xpack/security/authz/permission/FieldPermissions.java, +        if (!containsAllField(grantedFields) && !containsAllField(deniedFields)) {, +            // It is not explicitly stated whether _all should be allowed/denied, +    private static boolean containsAllField(String[] fields) {, +        return fields != null && Arrays.stream(fields).anyMatch(AllFieldMapper.NAME::equals);, +    }, +, +++ b/plugin/src/test/java/org/elasticsearch/xpack/security/authz/permission/FieldPermissionsTests.java, +import java.util.Arrays;, +import java.util.Collections;, +, +    public void testAllFieldIsAutomaticallyExcludedIfNotExplicitlyGranted() throws Exception {, +        final FieldPermissions fieldPermissions = new FieldPermissions(, +                new FieldPermissionsDefinition(new String[] { "_a*" }, new String[0]));, +        assertTrue(fieldPermissions.grantsAccessTo("_animal"));, +        assertFalse(fieldPermissions.grantsAccessTo("_all"));, +    }, +, +    public void testAllFieldIsNotExcludedIfExplicitlyGranted() throws Exception {, +        final String[] grant = { "foo", "bar", "baz", "_all" };, +        Collections.shuffle(Arrays.asList(grant), random());, +, +        final FieldPermissions fieldPermissions = new FieldPermissions(, +                new FieldPermissionsDefinition(grant, new String[0]));, +, +        assertTrue(fieldPermissions.grantsAccessTo("_all"));, +        assertTrue(fieldPermissions.grantsAccessTo("foo"));, +        assertTrue(fieldPermissions.grantsAccessTo("bar"));, +        assertTrue(fieldPermissions.grantsAccessTo("baz"));, +        assertFalse(fieldPermissions.grantsAccessTo(randomAlphaOfLengthBetween(5, 8)));, +    }]
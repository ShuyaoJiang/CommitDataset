[+++ b/src/main/java/org/elasticsearch/index/engine/internal/InternalEngine.java, +        if (optimizeAutoGenerateId && create.autoGeneratedId() && !create.canHaveDuplicates()) {, +            // We don't need to lock because this ID cannot be concurrently updated:, +            innerCreateNoLock(create, writer, Versions.NOT_FOUND, null);, +        } else {, +                innerCreateNoLock(create, writer, currentVersion, versionValue);, +        }, +    }, +, +    private void innerCreateNoLock(Create create, IndexWriter writer, long currentVersion, VersionValue versionValue) throws IOException {]
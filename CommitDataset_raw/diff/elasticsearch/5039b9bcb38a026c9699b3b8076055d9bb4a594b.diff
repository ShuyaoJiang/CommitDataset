[+++ b/x-pack/plugin/security/src/main/java/org/elasticsearch/xpack/security/authc/file/FileUserPasswdStore.java, +        final char[] hash = users.get(username);, +        return users.containsKey(username);, +++ b/x-pack/plugin/security/src/main/java/org/elasticsearch/xpack/security/authc/file/FileUserPasswdStore.java, +        final char[] hash = users.get(username);, +        return users.containsKey(username);, +++ b/x-pack/plugin/security/src/main/java/org/elasticsearch/xpack/security/authc/file/FileUserRolesStore.java, +        final String[] roles = userRoles.get(username);, +        return roles == null ? Strings.EMPTY_ARRAY : roles;, +                List<String> roles = userToRoles.computeIfAbsent(user, k -> new ArrayList<>());, +                List<String> users = roleToUsers.computeIfAbsent(role, k -> new ArrayList<>());]
[+++ b/server/src/main/java/org/elasticsearch/search/aggregations/support/MultiValuesSource.java, +                                        QueryShardContext context) {, +++ b/server/src/main/java/org/elasticsearch/search/aggregations/support/MultiValuesSource.java, +                                        QueryShardContext context) {, +++ b/server/src/main/java/org/elasticsearch/search/aggregations/support/MultiValuesSourceAggregationBuilder.java, +++ b/server/src/main/java/org/elasticsearch/search/aggregations/support/MultiValuesSource.java, +                                        QueryShardContext context) {, +++ b/server/src/main/java/org/elasticsearch/search/aggregations/support/MultiValuesSourceAggregationBuilder.java, +++ b/server/src/main/java/org/elasticsearch/search/aggregations/support/ValueType.java, +            IndexNumericFieldData.class, DocValueFormat.RAW),, +    DOUBLE((byte) 3, "float|double", "double", ValuesSourceType.NUMERIC, IndexNumericFieldData.class, DocValueFormat.RAW),, +    NUMBER((byte) 4, "number", "number", ValuesSourceType.NUMERIC, IndexNumericFieldData.class, DocValueFormat.RAW),, +            new DocValueFormat.DateTime(DateFieldMapper.DEFAULT_DATE_TIME_FORMATTER, DateTimeZone.UTC)),, +    NUMERIC((byte) 7, "numeric", "numeric", ValuesSourceType.NUMERIC, IndexNumericFieldData.class, DocValueFormat.RAW),, +    GEOPOINT((byte) 8, "geo_point", "geo_point", ValuesSourceType.GEOPOINT, IndexGeoPointFieldData.class, DocValueFormat.GEOHASH),, +    BOOLEAN((byte) 9, "boolean", "boolean", ValuesSourceType.NUMERIC, IndexNumericFieldData.class, DocValueFormat.BOOLEAN);, +++ b/server/src/main/java/org/elasticsearch/search/aggregations/support/MultiValuesSource.java, +                                        QueryShardContext context) {, +++ b/server/src/main/java/org/elasticsearch/search/aggregations/support/MultiValuesSourceAggregationBuilder.java, +++ b/server/src/main/java/org/elasticsearch/search/aggregations/support/ValueType.java, +            IndexNumericFieldData.class, DocValueFormat.RAW),, +    DOUBLE((byte) 3, "float|double", "double", ValuesSourceType.NUMERIC, IndexNumericFieldData.class, DocValueFormat.RAW),, +    NUMBER((byte) 4, "number", "number", ValuesSourceType.NUMERIC, IndexNumericFieldData.class, DocValueFormat.RAW),, +            new DocValueFormat.DateTime(DateFieldMapper.DEFAULT_DATE_TIME_FORMATTER, DateTimeZone.UTC)),, +    NUMERIC((byte) 7, "numeric", "numeric", ValuesSourceType.NUMERIC, IndexNumericFieldData.class, DocValueFormat.RAW),, +    GEOPOINT((byte) 8, "geo_point", "geo_point", ValuesSourceType.GEOPOINT, IndexGeoPointFieldData.class, DocValueFormat.GEOHASH),, +    BOOLEAN((byte) 9, "boolean", "boolean", ValuesSourceType.NUMERIC, IndexNumericFieldData.class, DocValueFormat.BOOLEAN);, +++ b/server/src/main/java/org/elasticsearch/search/aggregations/support/ValuesSource.java, +                return scriptValueType != null ? scriptValueType == ValueType.DOUBLE : true;, +++ b/server/src/main/java/org/elasticsearch/search/aggregations/support/MultiValuesSource.java, +                                        QueryShardContext context) {, +++ b/server/src/main/java/org/elasticsearch/search/aggregations/support/MultiValuesSourceAggregationBuilder.java, +++ b/server/src/main/java/org/elasticsearch/search/aggregations/support/ValueType.java, +            IndexNumericFieldData.class, DocValueFormat.RAW),, +    DOUBLE((byte) 3, "float|double", "double", ValuesSourceType.NUMERIC, IndexNumericFieldData.class, DocValueFormat.RAW),, +    NUMBER((byte) 4, "number", "number", ValuesSourceType.NUMERIC, IndexNumericFieldData.class, DocValueFormat.RAW),, +            new DocValueFormat.DateTime(DateFieldMapper.DEFAULT_DATE_TIME_FORMATTER, DateTimeZone.UTC)),, +    NUMERIC((byte) 7, "numeric", "numeric", ValuesSourceType.NUMERIC, IndexNumericFieldData.class, DocValueFormat.RAW),, +    GEOPOINT((byte) 8, "geo_point", "geo_point", ValuesSourceType.GEOPOINT, IndexGeoPointFieldData.class, DocValueFormat.GEOHASH),, +    BOOLEAN((byte) 9, "boolean", "boolean", ValuesSourceType.NUMERIC, IndexNumericFieldData.class, DocValueFormat.BOOLEAN);, +++ b/server/src/main/java/org/elasticsearch/search/aggregations/support/ValuesSource.java, +                return scriptValueType != null ? scriptValueType == ValueType.DOUBLE : true;, +++ b/server/src/main/java/org/elasticsearch/search/aggregations/support/ValuesSourceAggregatorFactory.java, +++ b/server/src/main/java/org/elasticsearch/search/aggregations/support/MultiValuesSource.java, +                                        QueryShardContext context) {, +++ b/server/src/main/java/org/elasticsearch/search/aggregations/support/MultiValuesSourceAggregationBuilder.java, +++ b/server/src/main/java/org/elasticsearch/search/aggregations/support/ValueType.java, +            IndexNumericFieldData.class, DocValueFormat.RAW),, +    DOUBLE((byte) 3, "float|double", "double", ValuesSourceType.NUMERIC, IndexNumericFieldData.class, DocValueFormat.RAW),, +    NUMBER((byte) 4, "number", "number", ValuesSourceType.NUMERIC, IndexNumericFieldData.class, DocValueFormat.RAW),, +            new DocValueFormat.DateTime(DateFieldMapper.DEFAULT_DATE_TIME_FORMATTER, DateTimeZone.UTC)),, +    NUMERIC((byte) 7, "numeric", "numeric", ValuesSourceType.NUMERIC, IndexNumericFieldData.class, DocValueFormat.RAW),, +    GEOPOINT((byte) 8, "geo_point", "geo_point", ValuesSourceType.GEOPOINT, IndexGeoPointFieldData.class, DocValueFormat.GEOHASH),, +    BOOLEAN((byte) 9, "boolean", "boolean", ValuesSourceType.NUMERIC, IndexNumericFieldData.class, DocValueFormat.BOOLEAN);, +++ b/server/src/main/java/org/elasticsearch/search/aggregations/support/ValuesSource.java, +                return scriptValueType != null ? scriptValueType == ValueType.DOUBLE : true;, +++ b/server/src/main/java/org/elasticsearch/search/aggregations/support/ValuesSourceAggregatorFactory.java, +++ b/server/src/main/java/org/elasticsearch/search/aggregations/support/ValuesSourceConfig.java, +            ValuesSourceConfig<VS> config = new ValuesSourceConfig<>(valuesSourceType);, +    public VS toValuesSource(QueryShardContext context) {, +    private VS originalValuesSource() {, +    private ValuesSource.Numeric numericScript() {, +    private ValuesSource.Numeric numericField() {, +    private ValuesSource bytesField() {, +    private ValuesSource.Bytes bytesScript() {, +    private ValuesSource.GeoPoint geoPointField() {, +++ b/server/src/main/java/org/elasticsearch/search/aggregations/support/MultiValuesSource.java, +                                        QueryShardContext context) {, +++ b/server/src/main/java/org/elasticsearch/search/aggregations/support/MultiValuesSourceAggregationBuilder.java, +++ b/server/src/main/java/org/elasticsearch/search/aggregations/support/ValueType.java, +            IndexNumericFieldData.class, DocValueFormat.RAW),, +    DOUBLE((byte) 3, "float|double", "double", ValuesSourceType.NUMERIC, IndexNumericFieldData.class, DocValueFormat.RAW),, +    NUMBER((byte) 4, "number", "number", ValuesSourceType.NUMERIC, IndexNumericFieldData.class, DocValueFormat.RAW),, +            new DocValueFormat.DateTime(DateFieldMapper.DEFAULT_DATE_TIME_FORMATTER, DateTimeZone.UTC)),, +    NUMERIC((byte) 7, "numeric", "numeric", ValuesSourceType.NUMERIC, IndexNumericFieldData.class, DocValueFormat.RAW),, +    GEOPOINT((byte) 8, "geo_point", "geo_point", ValuesSourceType.GEOPOINT, IndexGeoPointFieldData.class, DocValueFormat.GEOHASH),, +    BOOLEAN((byte) 9, "boolean", "boolean", ValuesSourceType.NUMERIC, IndexNumericFieldData.class, DocValueFormat.BOOLEAN);, +++ b/server/src/main/java/org/elasticsearch/search/aggregations/support/ValuesSource.java, +                return scriptValueType != null ? scriptValueType == ValueType.DOUBLE : true;, +++ b/server/src/main/java/org/elasticsearch/search/aggregations/support/ValuesSourceAggregatorFactory.java, +++ b/server/src/main/java/org/elasticsearch/search/aggregations/support/ValuesSourceConfig.java, +            ValuesSourceConfig<VS> config = new ValuesSourceConfig<>(valuesSourceType);, +    public VS toValuesSource(QueryShardContext context) {, +    private VS originalValuesSource() {, +    private ValuesSource.Numeric numericScript() {, +    private ValuesSource.Numeric numericField() {, +    private ValuesSource bytesField() {, +    private ValuesSource.Bytes bytesScript() {, +    private ValuesSource.GeoPoint geoPointField() {, +++ b/server/src/main/java/org/elasticsearch/search/aggregations/support/ValuesSourceType.java]
[+++ b/src/main/java/org/elasticsearch/search/SearchService.java, +        for (final SearchContext context : activeContexts.values()) {, +            freeContext(context.id());, +        final SearchContext context = createAndPutContext(request);, +            freeContext(context.id());, +        final SearchContext context = createAndPutContext(request);, +            freeContext(context.id());, +        final SearchContext context = findContext(request.id());, +            freeContext(context.id());, +        final SearchContext context = createAndPutContext(request);, +            freeContext(context.id());, +        final SearchContext context = findContext(request.id());, +            freeContext(context.id());, +        final SearchContext context = findContext(request.id());, +            freeContext(context.id());, +            freeContext(context.id());, +        final SearchContext context = createAndPutContext(request);, +            freeContext(context.id());, +        final SearchContext context = findContext(request.id());, +            freeContext(context.id());, +            freeContext(context.id());, +        final SearchContext context = findContext(request.id());, +            freeContext(context.id());, +        final SearchContext context = findContext(request.id());, +            freeContext(context.id()); // we just try to make sure this is freed - rethrow orig exception., +                freeContext(context.id());, +        final SearchContext context = activeContexts.remove(id);, +        if (context != null) {, +            try {, +            } finally {, +            }, +        return false;, +                freeContext(searchContext.id());, +                                    freeContext(context.id());, +                    freeContext(context.id());, +++ b/src/main/java/org/elasticsearch/search/SearchService.java, +        for (final SearchContext context : activeContexts.values()) {, +            freeContext(context.id());, +        final SearchContext context = createAndPutContext(request);, +            freeContext(context.id());, +        final SearchContext context = createAndPutContext(request);, +            freeContext(context.id());, +        final SearchContext context = findContext(request.id());, +            freeContext(context.id());, +        final SearchContext context = createAndPutContext(request);, +            freeContext(context.id());, +        final SearchContext context = findContext(request.id());, +            freeContext(context.id());, +        final SearchContext context = findContext(request.id());, +            freeContext(context.id());, +            freeContext(context.id());, +        final SearchContext context = createAndPutContext(request);, +            freeContext(context.id());, +        final SearchContext context = findContext(request.id());, +            freeContext(context.id());, +            freeContext(context.id());, +        final SearchContext context = findContext(request.id());, +            freeContext(context.id());, +        final SearchContext context = findContext(request.id());, +            freeContext(context.id()); // we just try to make sure this is freed - rethrow orig exception., +                freeContext(context.id());, +        final SearchContext context = activeContexts.remove(id);, +        if (context != null) {, +            try {, +            } finally {, +            }, +        return false;, +                freeContext(searchContext.id());, +                                    freeContext(context.id());, +                    freeContext(context.id());, +++ b/src/main/java/org/elasticsearch/search/action/SearchServiceTransportAction.java, +            final boolean freed = searchService.freeContext(contextId);, +++ b/src/main/java/org/elasticsearch/search/SearchService.java, +        for (final SearchContext context : activeContexts.values()) {, +            freeContext(context.id());, +        final SearchContext context = createAndPutContext(request);, +            freeContext(context.id());, +        final SearchContext context = createAndPutContext(request);, +            freeContext(context.id());, +        final SearchContext context = findContext(request.id());, +            freeContext(context.id());, +        final SearchContext context = createAndPutContext(request);, +            freeContext(context.id());, +        final SearchContext context = findContext(request.id());, +            freeContext(context.id());, +        final SearchContext context = findContext(request.id());, +            freeContext(context.id());, +            freeContext(context.id());, +        final SearchContext context = createAndPutContext(request);, +            freeContext(context.id());, +        final SearchContext context = findContext(request.id());, +            freeContext(context.id());, +            freeContext(context.id());, +        final SearchContext context = findContext(request.id());, +            freeContext(context.id());, +        final SearchContext context = findContext(request.id());, +            freeContext(context.id()); // we just try to make sure this is freed - rethrow orig exception., +                freeContext(context.id());, +        final SearchContext context = activeContexts.remove(id);, +        if (context != null) {]
[+++ b/modules/elasticsearch/src/main/java/org/elasticsearch/index/get/ShardGetService.java, +                        Object value = null;, +                            SearchScript searchScript = scriptService.search(searchLookup, "mvel", field, null);, +                                value = searchScript.run();, +                            } catch (RuntimeException e) {, +                                if (logger.isTraceEnabled()) {, +                                    logger.trace("failed to execute get request script field [{}]", e, field);, +                                }, +                                // ignore, +                            }, +                        } else {, +                            FieldMappers x = docMapper.mappers().smartName(field);, +                            if (x == null || !x.mapper().stored()) {, +                                if (searchLookup == null) {, +                                    searchLookup = new SearchLookup(mapperService, indexCache.fieldData());, +                                    searchLookup.setNextReader(docIdAndVersion.reader);, +                                    searchLookup.setNextDocId(docIdAndVersion.docId);, +                                }, +                                value = searchLookup.source().extractValue(field);, +                            }, +                        }, +, +                        if (value != null) {, +                                SearchScript searchScript = scriptService.search(searchLookup, "mvel", field, null);, +                                        logger.trace("failed to execute get request script field [{}]", e, field);, +                            } else {, +                                if (searchLookup == null) {, +                                    searchLookup = new SearchLookup(mapperService, indexCache.fieldData());, +                                    searchLookup.source().setNextSource(SourceLookup.sourceAsMap(source.source.bytes(), source.source.offset(), source.source.length()));, +                                }, +                                value = searchLookup.source().extractValue(field);, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/index/get/ShardGetService.java, +                        Object value = null;, +                            SearchScript searchScript = scriptService.search(searchLookup, "mvel", field, null);, +                                value = searchScript.run();, +                            } catch (RuntimeException e) {, +                                if (logger.isTraceEnabled()) {, +                                    logger.trace("failed to execute get request script field [{}]", e, field);, +                                }, +                                // ignore, +                            }, +                        } else {, +                            FieldMappers x = docMapper.mappers().smartName(field);, +                            if (x == null || !x.mapper().stored()) {, +                                if (searchLookup == null) {, +                                    searchLookup = new SearchLookup(mapperService, indexCache.fieldData());, +                                    searchLookup.setNextReader(docIdAndVersion.reader);, +                                    searchLookup.setNextDocId(docIdAndVersion.docId);, +                                }, +                                value = searchLookup.source().extractValue(field);, +                            }, +                        }, +, +                        if (value != null) {, +                                SearchScript searchScript = scriptService.search(searchLookup, "mvel", field, null);, +                                        logger.trace("failed to execute get request script field [{}]", e, field);, +                            } else {, +                                if (searchLookup == null) {, +                                    searchLookup = new SearchLookup(mapperService, indexCache.fieldData());, +                                    searchLookup.source().setNextSource(SourceLookup.sourceAsMap(source.source.bytes(), source.source.offset(), source.source.length()));, +                                }, +                                value = searchLookup.source().extractValue(field);, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/search/lookup/SourceLookup.java]
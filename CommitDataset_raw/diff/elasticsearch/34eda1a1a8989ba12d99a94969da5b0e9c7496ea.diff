[+++ b/core/src/main/java/org/elasticsearch/env/Environment.java, +        if (PATH_DATA_SETTING.exists(settings)) {, +        }, +++ b/core/src/main/java/org/elasticsearch/env/Environment.java, +        if (PATH_DATA_SETTING.exists(settings)) {, +        }, +++ b/core/src/test/java/org/elasticsearch/env/EnvironmentTests.java, +    public void testPathDataNotSetInEnvironmentIfNotSet() {, +        final Path defaultPathData = createTempDir().toAbsolutePath();, +        final Settings settings = Settings.builder(), +                .put("path.home", createTempDir().toAbsolutePath()), +                .put("default.path.data", defaultPathData), +                .build();, +        assertFalse(Environment.PATH_DATA_SETTING.exists(settings));, +        assertTrue(Environment.DEFAULT_PATH_DATA_SETTING.exists(settings));, +        final Environment environment = new Environment(settings);, +        assertFalse(Environment.PATH_DATA_SETTING.exists(environment.settings()));, +        assertTrue(Environment.DEFAULT_PATH_DATA_SETTING.exists(environment.settings()));, +    }, +]
[+++ b/core/src/main/java/org/elasticsearch/search/SearchModule.java, +        registerAggregation(SumAggregationBuilder::new, InternalSum::new, new SumParser(), SumAggregationBuilder.AGGREGATION_NAME_FIELD);, +        registerAggregation(MinAggregationBuilder::new, InternalMin::new, new MinParser(), MinAggregationBuilder.AGGREGATION_NAME_FIELD);, +        registerAggregation(MaxAggregationBuilder::new, InternalMax::new, new MaxParser(), MaxAggregationBuilder.AGGREGATION_NAME_FIELD);, +++ b/core/src/main/java/org/elasticsearch/search/SearchModule.java, +        registerAggregation(SumAggregationBuilder::new, InternalSum::new, new SumParser(), SumAggregationBuilder.AGGREGATION_NAME_FIELD);, +        registerAggregation(MinAggregationBuilder::new, InternalMin::new, new MinParser(), MinAggregationBuilder.AGGREGATION_NAME_FIELD);, +        registerAggregation(MaxAggregationBuilder::new, InternalMax::new, new MaxParser(), MaxAggregationBuilder.AGGREGATION_NAME_FIELD);, +++ b/core/src/main/java/org/elasticsearch/search/aggregations/metrics/max/InternalMax.java, +    private final double max;, +    /**, +     * Read from a stream., +     */, +    public InternalMax(StreamInput in) throws IOException {, +        super(in);, +        format = in.readNamedWriteable(DocValueFormat.class);, +        max = in.readDouble();, +    }, +, +    @Override, +    protected void doWriteTo(StreamOutput out) throws IOException {, +        out.writeNamedWriteable(format);, +        out.writeDouble(max);, +    }, +, +    @Override, +    public String getWriteableName() {, +        return MaxAggregationBuilder.NAME;, +    }, +, +++ b/core/src/main/java/org/elasticsearch/search/SearchModule.java, +        registerAggregation(SumAggregationBuilder::new, InternalSum::new, new SumParser(), SumAggregationBuilder.AGGREGATION_NAME_FIELD);, +        registerAggregation(MinAggregationBuilder::new, InternalMin::new, new MinParser(), MinAggregationBuilder.AGGREGATION_NAME_FIELD);, +        registerAggregation(MaxAggregationBuilder::new, InternalMax::new, new MaxParser(), MaxAggregationBuilder.AGGREGATION_NAME_FIELD);, +++ b/core/src/main/java/org/elasticsearch/search/aggregations/metrics/max/InternalMax.java, +    private final double max;, +    /**, +     * Read from a stream., +     */, +    public InternalMax(StreamInput in) throws IOException {, +        super(in);, +        format = in.readNamedWriteable(DocValueFormat.class);, +        max = in.readDouble();, +    }, +, +    @Override, +    protected void doWriteTo(StreamOutput out) throws IOException {, +        out.writeNamedWriteable(format);, +        out.writeDouble(max);, +    }, +, +    @Override, +    public String getWriteableName() {, +        return MaxAggregationBuilder.NAME;, +    }, +, +++ b/core/src/main/java/org/elasticsearch/search/aggregations/metrics/max/MaxAggregationBuilder.java, +import org.elasticsearch.search.aggregations.InternalAggregation.Type;, +    public static final String NAME = "max";, +    public final static Type TYPE = new Type(NAME);, +        super(name, TYPE, ValuesSourceType.NUMERIC, ValueType.NUMERIC);, +        super(in, TYPE, ValuesSourceType.NUMERIC, ValueType.NUMERIC);, +++ b/core/src/main/java/org/elasticsearch/search/SearchModule.java, +        registerAggregation(SumAggregationBuilder::new, InternalSum::new, new SumParser(), SumAggregationBuilder.AGGREGATION_NAME_FIELD);, +        registerAggregation(MinAggregationBuilder::new, InternalMin::new, new MinParser(), MinAggregationBuilder.AGGREGATION_NAME_FIELD);, +        registerAggregation(MaxAggregationBuilder::new, InternalMax::new, new MaxParser(), MaxAggregationBuilder.AGGREGATION_NAME_FIELD);, +++ b/core/src/main/java/org/elasticsearch/search/aggregations/metrics/max/InternalMax.java, +    private final double max;, +    /**, +     * Read from a stream., +     */, +    public InternalMax(StreamInput in) throws IOException {, +        super(in);, +        format = in.readNamedWriteable(DocValueFormat.class);, +        max = in.readDouble();, +    }, +, +    @Override, +    protected void doWriteTo(StreamOutput out) throws IOException {, +        out.writeNamedWriteable(format);, +        out.writeDouble(max);, +    }, +, +    @Override, +    public String getWriteableName() {, +        return MaxAggregationBuilder.NAME;, +    }, +, +++ b/core/src/main/java/org/elasticsearch/search/aggregations/metrics/max/MaxAggregationBuilder.java, +import org.elasticsearch.search.aggregations.InternalAggregation.Type;, +    public static final String NAME = "max";, +    public final static Type TYPE = new Type(NAME);, +        super(name, TYPE, ValuesSourceType.NUMERIC, ValueType.NUMERIC);, +        super(in, TYPE, ValuesSourceType.NUMERIC, ValueType.NUMERIC);, +++ b/core/src/main/java/org/elasticsearch/search/aggregations/metrics/min/InternalMin.java, +    private final double min;, +    /**, +     * Read from a stream., +     */, +    public InternalMin(StreamInput in) throws IOException {]
[+++ b/rest-api-spec/src/main/resources/rest-api-spec/test/search.aggregation/180_percentiles_tdigest_metric.yml, +setup:, +  - do:, +      indices.create:, +          index: test_1, +          body:, +            settings:, +              number_of_replicas: 0, +            mappings:, +              doc:, +                properties:, +                  int_field:, +                     type : integer, +                  double_field:, +                     type : double, +                  string_field:, +                     type: keyword, +, +  - do:, +       bulk:, +         refresh: true, +         body:, +           - index:, +               _index: test_1, +               _type:  doc, +               _id:    1, +           - int_field: 1, +             double_field: 1.0, +             string_field: foo, +           - index:, +               _index: test_1, +               _type:  doc, +               _id:    2, +           - int_field: 51, +             double_field: 51.0, +             string_field: foo, +           - index:, +               _index: test_1, +               _type:  doc, +               _id:    3, +           - int_field: 101, +             double_field: 101.0, +             string_field: foo, +           - index:, +               _index: test_1, +               _type:  doc, +               _id:    4, +           - int_field: 151, +             double_field: 151.0, +             string_field: foo, +, +---, +"Basic test":, +, +  - do:, +      search:, +        body:, +          aggs:, +            percentiles_int:, +              percentiles:, +                field: int_field, +            percentiles_double:, +              percentiles:, +                field: double_field, +, +, +  - match: { hits.total: 4 }, +  - length: { hits.hits: 4 }, +  - match:, +      aggregations.percentiles_int.values:, +        1.0: 2.5, +        5.0: 8.500000000000002, +        25.0: 38.5, +        50.0: 76.0, +        75.0: 113.5, +        95.0: 143.49999999999997, +        99.0: 149.5, +  - match:, +      aggregations.percentiles_double.values:, +        1.0: 2.5, +        5.0: 8.500000000000002, +        25.0: 38.5, +        50.0: 76.0, +        75.0: 113.5, +        95.0: 143.49999999999997, +        99.0: 149.5, +, +  - do:, +      search:, +        body:, +          aggs:, +            percentiles_int:, +              percentiles:, +                field: int_field, +                tdigest:, +                  compression: 200, +            percentiles_double:, +              percentiles:, +                field: double_field, +                tdigest:]
[+++ b/modules/elasticsearch/src/main/java/org/apache/lucene/queryParser/MissingFieldQueryExtension.java, +        return new DeletionAwareConstantScoreQuery(filter);, +++ b/modules/elasticsearch/src/main/java/org/apache/lucene/queryParser/MissingFieldQueryExtension.java, +        return new DeletionAwareConstantScoreQuery(filter);, +++ b/modules/elasticsearch/src/main/java/org/apache/lucene/search/DeletionAwareConstantScoreQuery.java, +            boolean exists = cs._innerIter.advance(doc) == doc;, +        final DocIdSetIterator _innerIter;, +        private int doc = -1;, +                _innerIter = DocIdSet.EMPTY_DOCIDSET.iterator();, +                    _innerIter = DocIdSet.EMPTY_DOCIDSET.iterator();, +                    _innerIter = iter;, +            while ((doc = _innerIter.nextDoc()) != NO_MORE_DOCS) {, +                if (!reader.isDeleted(doc)) {, +                    return doc;, +            return doc;, +            return doc;, +            doc = _innerIter.advance(target);, +            if (doc != NO_MORE_DOCS) {, +                    while ((doc = _innerIter.nextDoc()) != NO_MORE_DOCS) {, +                        if (!reader.isDeleted(doc)) {, +                            return doc;, +                    return doc;, +                }, +            }, +            return doc;, +        }, +++ b/modules/elasticsearch/src/main/java/org/apache/lucene/queryParser/MissingFieldQueryExtension.java, +        return new DeletionAwareConstantScoreQuery(filter);, +++ b/modules/elasticsearch/src/main/java/org/apache/lucene/search/DeletionAwareConstantScoreQuery.java, +            boolean exists = cs._innerIter.advance(doc) == doc;, +        final DocIdSetIterator _innerIter;, +        private int doc = -1;, +                _innerIter = DocIdSet.EMPTY_DOCIDSET.iterator();, +                    _innerIter = DocIdSet.EMPTY_DOCIDSET.iterator();, +                    _innerIter = iter;, +            while ((doc = _innerIter.nextDoc()) != NO_MORE_DOCS) {, +                if (!reader.isDeleted(doc)) {, +                    return doc;, +            return doc;, +            return doc;, +            doc = _innerIter.advance(target);, +            if (doc != NO_MORE_DOCS) {, +                    while ((doc = _innerIter.nextDoc()) != NO_MORE_DOCS) {, +                        if (!reader.isDeleted(doc)) {, +                            return doc;, +                    return doc;, +                }, +            }, +            return doc;, +        }, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/common/lucene/search/Queries.java, +    public final static Query MATCH_ALL_QUERY = new DeletionAwareConstantScoreQuery(new MatchAllDocsFilter());, +++ b/modules/elasticsearch/src/main/java/org/apache/lucene/queryParser/MissingFieldQueryExtension.java, +        return new DeletionAwareConstantScoreQuery(filter);, +++ b/modules/elasticsearch/src/main/java/org/apache/lucene/search/DeletionAwareConstantScoreQuery.java, +            boolean exists = cs._innerIter.advance(doc) == doc;, +        final DocIdSetIterator _innerIter;, +        private int doc = -1;, +                _innerIter = DocIdSet.EMPTY_DOCIDSET.iterator();, +                    _innerIter = DocIdSet.EMPTY_DOCIDSET.iterator();, +                    _innerIter = iter;, +            while ((doc = _innerIter.nextDoc()) != NO_MORE_DOCS) {, +                if (!reader.isDeleted(doc)) {, +                    return doc;, +            return doc;, +            return doc;, +            doc = _innerIter.advance(target);, +            if (doc != NO_MORE_DOCS) {, +                    while ((doc = _innerIter.nextDoc()) != NO_MORE_DOCS) {, +                        if (!reader.isDeleted(doc)) {, +                            return doc;, +                    return doc;, +                }, +            }, +            return doc;, +        }, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/common/lucene/search/Queries.java, +    public final static Query MATCH_ALL_QUERY = new DeletionAwareConstantScoreQuery(new MatchAllDocsFilter());, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/index/query/xcontent/ConstantScoreQueryParser.java, +        Query query = new DeletionAwareConstantScoreQuery(filter);, +++ b/modules/elasticsearch/src/main/java/org/apache/lucene/queryParser/MissingFieldQueryExtension.java, +        return new DeletionAwareConstantScoreQuery(filter);, +++ b/modules/elasticsearch/src/main/java/org/apache/lucene/search/DeletionAwareConstantScoreQuery.java, +            boolean exists = cs._innerIter.advance(doc) == doc;, +        final DocIdSetIterator _innerIter;, +        private int doc = -1;, +                _innerIter = DocIdSet.EMPTY_DOCIDSET.iterator();, +                    _innerIter = DocIdSet.EMPTY_DOCIDSET.iterator();, +                    _innerIter = iter;, +            while ((doc = _innerIter.nextDoc()) != NO_MORE_DOCS) {, +                if (!reader.isDeleted(doc)) {, +                    return doc;, +            return doc;, +            return doc;, +            doc = _innerIter.advance(target);, +            if (doc != NO_MORE_DOCS) {, +                    while ((doc = _innerIter.nextDoc()) != NO_MORE_DOCS) {, +                        if (!reader.isDeleted(doc)) {, +                            return doc;, +                    return doc;]
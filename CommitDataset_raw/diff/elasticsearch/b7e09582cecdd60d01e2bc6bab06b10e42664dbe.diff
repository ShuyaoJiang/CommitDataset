[+++ b/core/src/main/java/org/elasticsearch/common/io/stream/StreamInput.java, +    public int[] readVIntArray() throws IOException {, +        int length = readVInt();, +        int[] values = new int[length];, +        for (int i = 0; i < length; i++) {, +            values[i] = readVInt();, +        }, +        return values;, +    }, +, +    public long[] readVLongArray() throws IOException {, +        int length = readVInt();, +        long[] values = new long[length];, +        for (int i = 0; i < length; i++) {, +            values[i] = readVLong();, +        }, +        return values;, +    }, +, +++ b/core/src/main/java/org/elasticsearch/common/io/stream/StreamInput.java, +    public int[] readVIntArray() throws IOException {, +        int length = readVInt();, +        int[] values = new int[length];, +        for (int i = 0; i < length; i++) {, +            values[i] = readVInt();, +        }, +        return values;, +    }, +, +    public long[] readVLongArray() throws IOException {, +        int length = readVInt();, +        long[] values = new long[length];, +        for (int i = 0; i < length; i++) {, +            values[i] = readVLong();, +        }, +        return values;, +    }, +, +++ b/core/src/main/java/org/elasticsearch/common/io/stream/StreamOutput.java, +    public void writeVIntArray(int[] values) throws IOException {, +        writeVInt(values.length);, +        for (int value : values) {, +            writeVInt(value);, +        }, +    }, +, +    public void writeVLongArray(long[] values) throws IOException {, +        writeVInt(values.length);, +        for (long value : values) {, +            writeVLong(value);, +        }, +    }, +, +++ b/core/src/main/java/org/elasticsearch/common/io/stream/StreamInput.java, +    public int[] readVIntArray() throws IOException {, +        int length = readVInt();, +        int[] values = new int[length];, +        for (int i = 0; i < length; i++) {, +            values[i] = readVInt();, +        }, +        return values;, +    }, +, +    public long[] readVLongArray() throws IOException {, +        int length = readVInt();, +        long[] values = new long[length];, +        for (int i = 0; i < length; i++) {, +            values[i] = readVLong();, +        }, +        return values;, +    }, +, +++ b/core/src/main/java/org/elasticsearch/common/io/stream/StreamOutput.java, +    public void writeVIntArray(int[] values) throws IOException {, +        writeVInt(values.length);, +        for (int value : values) {, +            writeVInt(value);, +        }, +    }, +, +    public void writeVLongArray(long[] values) throws IOException {, +        writeVInt(values.length);, +        for (long value : values) {, +            writeVLong(value);, +        }, +    }, +, +++ b/core/src/test/java/org/elasticsearch/common/io/stream/BytesStreamsTests.java, +        int[] vIntArray = {4, 5, 6};, +        out.writeVIntArray(vIntArray);, +        long[] vLongArray = {4, 5, 6};, +        out.writeVLongArray(vLongArray);, +        assertThat(in.readVIntArray(), equalTo(vIntArray));, +        assertThat(in.readVLongArray(), equalTo(vLongArray));]
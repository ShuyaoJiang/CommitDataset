[+++ b/core/src/main/java/org/elasticsearch/common/settings/Setting.java, +    public static Setting<Boolean> boolSetting(String key, Function<Settings, String> defaultValueFn, Property... properties) {, +        return new Setting<>(key, defaultValueFn, Booleans::parseBooleanExact, properties);, +    }, +, +++ b/core/src/main/java/org/elasticsearch/common/settings/Setting.java, +    public static Setting<Boolean> boolSetting(String key, Function<Settings, String> defaultValueFn, Property... properties) {, +        return new Setting<>(key, defaultValueFn, Booleans::parseBooleanExact, properties);, +    }, +, +++ b/core/src/main/java/org/elasticsearch/script/ScriptEngineRegistry.java, +    private final Map<String, Boolean> defaultInlineScriptEnableds;, +        Map<String, Boolean> inlineScriptEnableds = new HashMap<>();, +            inlineScriptEnableds.put(language, registration.getDefaultInlineScriptEnabled());, +        this.defaultInlineScriptEnableds = Collections.unmodifiableMap(inlineScriptEnableds);, +    Map<String, Boolean> getDefaultInlineScriptEnableds() {, +        return this.defaultInlineScriptEnableds;, +        private final boolean defaultInlineScriptEnabled;, +            this(scriptEngineService, scriptEngineLanguage, false);, +                                        boolean defaultInlineScriptEnabled) {, +            this.defaultInlineScriptEnabled = defaultInlineScriptEnabled;, +        boolean getDefaultInlineScriptEnabled() {, +            return defaultInlineScriptEnabled;, +++ b/core/src/main/java/org/elasticsearch/common/settings/Setting.java, +    public static Setting<Boolean> boolSetting(String key, Function<Settings, String> defaultValueFn, Property... properties) {, +        return new Setting<>(key, defaultValueFn, Booleans::parseBooleanExact, properties);, +    }, +, +++ b/core/src/main/java/org/elasticsearch/script/ScriptEngineRegistry.java, +    private final Map<String, Boolean> defaultInlineScriptEnableds;, +        Map<String, Boolean> inlineScriptEnableds = new HashMap<>();, +            inlineScriptEnableds.put(language, registration.getDefaultInlineScriptEnabled());, +        this.defaultInlineScriptEnableds = Collections.unmodifiableMap(inlineScriptEnableds);, +    Map<String, Boolean> getDefaultInlineScriptEnableds() {, +        return this.defaultInlineScriptEnableds;, +        private final boolean defaultInlineScriptEnabled;, +            this(scriptEngineService, scriptEngineLanguage, false);, +                                        boolean defaultInlineScriptEnabled) {, +            this.defaultInlineScriptEnabled = defaultInlineScriptEnabled;, +        boolean getDefaultInlineScriptEnabled() {, +            return defaultInlineScriptEnabled;, +++ /dev/null, +++ b/core/src/main/java/org/elasticsearch/common/settings/Setting.java, +    public static Setting<Boolean> boolSetting(String key, Function<Settings, String> defaultValueFn, Property... properties) {, +        return new Setting<>(key, defaultValueFn, Booleans::parseBooleanExact, properties);, +    }, +, +++ b/core/src/main/java/org/elasticsearch/script/ScriptEngineRegistry.java, +    private final Map<String, Boolean> defaultInlineScriptEnableds;, +        Map<String, Boolean> inlineScriptEnableds = new HashMap<>();, +            inlineScriptEnableds.put(language, registration.getDefaultInlineScriptEnabled());, +        this.defaultInlineScriptEnableds = Collections.unmodifiableMap(inlineScriptEnableds);, +    Map<String, Boolean> getDefaultInlineScriptEnableds() {, +        return this.defaultInlineScriptEnableds;, +        private final boolean defaultInlineScriptEnabled;, +            this(scriptEngineService, scriptEngineLanguage, false);, +                                        boolean defaultInlineScriptEnabled) {, +            this.defaultInlineScriptEnabled = defaultInlineScriptEnabled;, +        boolean getDefaultInlineScriptEnabled() {, +            return defaultInlineScriptEnabled;, +++ /dev/null, +++ b/core/src/main/java/org/elasticsearch/script/ScriptModes.java, + * Holds the boolean indicating the enabled mode for each of the different scripting languages available, each script source and each, + * scripted operation., +    final Map<String, Boolean> scriptEnabled;, +        HashMap<String, Boolean> scriptModes = new HashMap<>();, +        for (Setting<Boolean> scriptModeSetting : scriptSettings.getScriptLanguageSettings()) {, +        this.scriptEnabled = Collections.unmodifiableMap(scriptModes);, +     * @return whether scripts are enabled (true) or disabled (false), +    public boolean getScriptEnabled(String lang, ScriptType scriptType, ScriptContext scriptContext) {, +        //native scripts are always enabled as they are static by definition, +            return true;, +        Boolean scriptMode = scriptEnabled.get(getKey(lang, scriptType, scriptContext));, +        TreeMap<String, Boolean> scriptModesTreeMap = new TreeMap<>();, +        scriptModesTreeMap.putAll(scriptEnabled);, +        for (Map.Entry<String, Boolean> stringScriptModeEntry : scriptModesTreeMap.entrySet()) {, +++ b/core/src/main/java/org/elasticsearch/common/settings/Setting.java, +    public static Setting<Boolean> boolSetting(String key, Function<Settings, String> defaultValueFn, Property... properties) {, +        return new Setting<>(key, defaultValueFn, Booleans::parseBooleanExact, properties);, +    }, +, +++ b/core/src/main/java/org/elasticsearch/script/ScriptEngineRegistry.java, +    private final Map<String, Boolean> defaultInlineScriptEnableds;, +        Map<String, Boolean> inlineScriptEnableds = new HashMap<>();, +            inlineScriptEnableds.put(language, registration.getDefaultInlineScriptEnabled());, +        this.defaultInlineScriptEnableds = Collections.unmodifiableMap(inlineScriptEnableds);, +    Map<String, Boolean> getDefaultInlineScriptEnableds() {, +        return this.defaultInlineScriptEnableds;, +        private final boolean defaultInlineScriptEnabled;, +            this(scriptEngineService, scriptEngineLanguage, false);, +                                        boolean defaultInlineScriptEnabled) {, +            this.defaultInlineScriptEnabled = defaultInlineScriptEnabled;, +        boolean getDefaultInlineScriptEnabled() {, +            return defaultInlineScriptEnabled;, +++ /dev/null, +++ b/core/src/main/java/org/elasticsearch/script/ScriptModes.java, + * Holds the boolean indicating the enabled mode for each of the different scripting languages available, each script source and each, + * scripted operation., +    final Map<String, Boolean> scriptEnabled;, +        HashMap<String, Boolean> scriptModes = new HashMap<>();]
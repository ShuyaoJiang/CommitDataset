[+++ b/src/main/java/org/elasticsearch/index/query/BoolQueryParser.java, +import org.apache.lucene.search.MatchAllDocsQuery;, +            return new MatchAllDocsQuery();, +++ b/src/main/java/org/elasticsearch/index/query/BoolQueryParser.java, +import org.apache.lucene.search.MatchAllDocsQuery;, +            return new MatchAllDocsQuery();, +++ b/src/test/java/org/elasticsearch/index/query/SimpleIndexQueryParserTests.java, +import org.elasticsearch.common.xcontent.XContentHelper;, +import org.elasticsearch.common.xcontent.XContentParser;, +import org.elasticsearch.index.search.child.CustomQueryWrappingFilter;, +import org.elasticsearch.index.search.child.ParentConstantScoreQuery;, +import org.elasticsearch.search.internal.SearchContext;, +import static org.elasticsearch.common.xcontent.XContentFactory.jsonBuilder;, +    // https://github.com/elasticsearch/elasticsearch/issues/7240, +    @Test, +    public void testEmptyBooleanQuery() throws Exception {, +        IndexQueryParserService queryParser = queryParser();, +        String query = jsonBuilder().startObject().startObject("bool").endObject().endObject().string();, +        Query parsedQuery = queryParser.parse(query).query();, +        assertThat(parsedQuery, instanceOf(MatchAllDocsQuery.class));, +    }, +    // https://github.com/elasticsearch/elasticsearch/issues/7240, +    @Test, +    public void testEmptyBooleanQueryInsideFQuery() throws Exception {, +        IndexQueryParserService queryParser = queryParser();, +        String query = copyToStringFromClasspath("/org/elasticsearch/index/query/fquery-with-empty-bool-query.json");, +        XContentParser parser = XContentHelper.createParser(new BytesArray(query));, +        ParsedFilter parsedQuery = queryParser.parseInnerFilter(parser);, +        assertThat(parsedQuery.filter(), instanceOf(QueryWrapperFilter.class));, +        assertThat(((QueryWrapperFilter) parsedQuery.filter()).getQuery(), instanceOf(XFilteredQuery.class));, +        assertThat(((XFilteredQuery) ((QueryWrapperFilter) parsedQuery.filter()).getQuery()).getFilter(), instanceOf(TermFilter.class));, +        TermFilter filter = (TermFilter) ((XFilteredQuery) ((QueryWrapperFilter) parsedQuery.filter()).getQuery()).getFilter();, +        assertThat(filter.getTerm().toString(), equalTo("text:apache"));, +    }, +, +    // https://github.com/elasticsearch/elasticsearch/issues/6722, +    public void testEmptyBoolSubClausesIsMatchAll() throws ElasticsearchException, IOException {, +        String query = copyToStringFromClasspath("/org/elasticsearch/index/query/bool-query-with-empty-clauses-for-parsing.json");, +        IndexService indexService = createIndex("testidx", client().admin().indices().prepareCreate("testidx"), +                .addMapping("foo"), +                .addMapping("test", "_parent", "type=foo"));, +        SearchContext.setCurrent(createSearchContext(indexService));, +        IndexQueryParserService queryParser = indexService.queryParserService();, +        Query parsedQuery = queryParser.parse(query).query();, +        assertThat(parsedQuery, instanceOf(XConstantScoreQuery.class));, +        assertThat(((XConstantScoreQuery) parsedQuery).getFilter(), instanceOf(CustomQueryWrappingFilter.class));, +        assertThat(((CustomQueryWrappingFilter) ((XConstantScoreQuery) parsedQuery).getFilter()).getQuery(), instanceOf(ParentConstantScoreQuery.class));, +        assertThat(((CustomQueryWrappingFilter) ((XConstantScoreQuery) parsedQuery).getFilter()).getQuery().toString(), equalTo("parent_filter[foo](*:*)"));, +        SearchContext.removeCurrent();, +    }, +++ b/src/main/java/org/elasticsearch/index/query/BoolQueryParser.java, +import org.apache.lucene.search.MatchAllDocsQuery;, +            return new MatchAllDocsQuery();, +++ b/src/test/java/org/elasticsearch/index/query/SimpleIndexQueryParserTests.java, +import org.elasticsearch.common.xcontent.XContentHelper;, +import org.elasticsearch.common.xcontent.XContentParser;, +import org.elasticsearch.index.search.child.CustomQueryWrappingFilter;, +import org.elasticsearch.index.search.child.ParentConstantScoreQuery;, +import org.elasticsearch.search.internal.SearchContext;, +import static org.elasticsearch.common.xcontent.XContentFactory.jsonBuilder;, +    // https://github.com/elasticsearch/elasticsearch/issues/7240, +    @Test, +    public void testEmptyBooleanQuery() throws Exception {, +        IndexQueryParserService queryParser = queryParser();, +        String query = jsonBuilder().startObject().startObject("bool").endObject().endObject().string();, +        Query parsedQuery = queryParser.parse(query).query();, +        assertThat(parsedQuery, instanceOf(MatchAllDocsQuery.class));, +    }, +    // https://github.com/elasticsearch/elasticsearch/issues/7240, +    @Test, +    public void testEmptyBooleanQueryInsideFQuery() throws Exception {, +        IndexQueryParserService queryParser = queryParser();, +        String query = copyToStringFromClasspath("/org/elasticsearch/index/query/fquery-with-empty-bool-query.json");, +        XContentParser parser = XContentHelper.createParser(new BytesArray(query));, +        ParsedFilter parsedQuery = queryParser.parseInnerFilter(parser);, +        assertThat(parsedQuery.filter(), instanceOf(QueryWrapperFilter.class));, +        assertThat(((QueryWrapperFilter) parsedQuery.filter()).getQuery(), instanceOf(XFilteredQuery.class));, +        assertThat(((XFilteredQuery) ((QueryWrapperFilter) parsedQuery.filter()).getQuery()).getFilter(), instanceOf(TermFilter.class));, +        TermFilter filter = (TermFilter) ((XFilteredQuery) ((QueryWrapperFilter) parsedQuery.filter()).getQuery()).getFilter();, +        assertThat(filter.getTerm().toString(), equalTo("text:apache"));, +    }, +, +    // https://github.com/elasticsearch/elasticsearch/issues/6722, +    public void testEmptyBoolSubClausesIsMatchAll() throws ElasticsearchException, IOException {, +        String query = copyToStringFromClasspath("/org/elasticsearch/index/query/bool-query-with-empty-clauses-for-parsing.json");, +        IndexService indexService = createIndex("testidx", client().admin().indices().prepareCreate("testidx"), +                .addMapping("foo"), +                .addMapping("test", "_parent", "type=foo"));, +        SearchContext.setCurrent(createSearchContext(indexService));, +        IndexQueryParserService queryParser = indexService.queryParserService();, +        Query parsedQuery = queryParser.parse(query).query();, +        assertThat(parsedQuery, instanceOf(XConstantScoreQuery.class));, +        assertThat(((XConstantScoreQuery) parsedQuery).getFilter(), instanceOf(CustomQueryWrappingFilter.class));, +        assertThat(((CustomQueryWrappingFilter) ((XConstantScoreQuery) parsedQuery).getFilter()).getQuery(), instanceOf(ParentConstantScoreQuery.class));, +        assertThat(((CustomQueryWrappingFilter) ((XConstantScoreQuery) parsedQuery).getFilter()).getQuery().toString(), equalTo("parent_filter[foo](*:*)"));, +        SearchContext.removeCurrent();, +    }, +++ b/src/test/java/org/elasticsearch/index/query/bool-query-with-empty-clauses-for-parsing.json, +{, +  "filtered": {]
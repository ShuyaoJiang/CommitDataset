[+++ b/modules/elasticsearch/src/main/java/org/elasticsearch/search/facets/AbstractFacetBuilder.java, +import org.elasticsearch.common.xcontent.builder.XContentBuilder;, +import java.io.IOException;, +, +    protected XContentFilterBuilder facetFilter;, +    public AbstractFacetBuilder facetFilter(XContentFilterBuilder filter) {, +        this.facetFilter = filter;, +, +    protected void addFilterFacetAndGlobal(XContentBuilder builder, Params params) throws IOException {, +        if (facetFilter != null) {, +            builder.field("facet_filter");, +            facetFilter.toXContent(builder, params);, +        }, +, +        if (global != null) {, +            builder.field("global", global);, +        }, +    }, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/search/facets/AbstractFacetBuilder.java, +import org.elasticsearch.common.xcontent.builder.XContentBuilder;, +import java.io.IOException;, +, +    protected XContentFilterBuilder facetFilter;, +    public AbstractFacetBuilder facetFilter(XContentFilterBuilder filter) {, +        this.facetFilter = filter;, +, +    protected void addFilterFacetAndGlobal(XContentBuilder builder, Params params) throws IOException {, +        if (facetFilter != null) {, +            builder.field("facet_filter");, +            facetFilter.toXContent(builder, params);, +        }, +, +        if (global != null) {, +            builder.field("global", global);, +        }, +    }, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/search/facets/Facet.java, +import org.elasticsearch.search.facets.filter.FilterFacet;, +        RANGE(5, RangeFacet.class),, +        /**, +         * Filter facet type, matching {@link FilterFacet}., +         */, +        FILTER(6, FilterFacet.class);, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/search/facets/AbstractFacetBuilder.java, +import org.elasticsearch.common.xcontent.builder.XContentBuilder;, +import java.io.IOException;, +, +    protected XContentFilterBuilder facetFilter;, +    public AbstractFacetBuilder facetFilter(XContentFilterBuilder filter) {, +        this.facetFilter = filter;, +, +    protected void addFilterFacetAndGlobal(XContentBuilder builder, Params params) throws IOException {, +        if (facetFilter != null) {, +            builder.field("facet_filter");, +            facetFilter.toXContent(builder, params);, +        }, +, +        if (global != null) {, +            builder.field("global", global);, +        }, +    }, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/search/facets/Facet.java, +import org.elasticsearch.search.facets.filter.FilterFacet;, +        RANGE(5, RangeFacet.class),, +        /**, +         * Filter facet type, matching {@link FilterFacet}., +         */, +        FILTER(6, FilterFacet.class);, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/search/facets/FacetBuilders.java, +import org.elasticsearch.index.query.xcontent.XContentFilterBuilder;, +import org.elasticsearch.search.facets.filter.FilterFacetBuilder;, +    public static FilterFacetBuilder filterFacet(String facetName) {, +        return new FilterFacetBuilder(facetName);, +    }, +, +    public static FilterFacetBuilder filterFacet(String facetName, XContentFilterBuilder filter) {, +        return new FilterFacetBuilder(facetName).filter(filter);, +    }, +, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/search/facets/AbstractFacetBuilder.java, +import org.elasticsearch.common.xcontent.builder.XContentBuilder;, +import java.io.IOException;, +, +    protected XContentFilterBuilder facetFilter;, +    public AbstractFacetBuilder facetFilter(XContentFilterBuilder filter) {, +        this.facetFilter = filter;, +, +    protected void addFilterFacetAndGlobal(XContentBuilder builder, Params params) throws IOException {, +        if (facetFilter != null) {, +            builder.field("facet_filter");, +            facetFilter.toXContent(builder, params);, +        }, +, +        if (global != null) {, +            builder.field("global", global);, +        }, +    }, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/search/facets/Facet.java, +import org.elasticsearch.search.facets.filter.FilterFacet;, +        RANGE(5, RangeFacet.class),]
[+++ b/core/src/main/java/org/elasticsearch/action/search/SearchRequestBuilder.java, +     * {@link #addRescorer(org.elasticsearch.search.rescore.RescoreBuilder, int)}., +    public SearchRequestBuilder setRescorer(RescoreBuilder<?> rescorer) {, +     * {@link #addRescorer(org.elasticsearch.search.rescore.RescoreBuilder, int)}., +    public SearchRequestBuilder setRescorer(RescoreBuilder rescorer, int window) {, +        return addRescorer(rescorer.windowSize(window));, +    public SearchRequestBuilder addRescorer(RescoreBuilder<?> rescorer) {, +        sourceBuilder().addRescorer(rescorer);, +    public SearchRequestBuilder addRescorer(RescoreBuilder<?> rescorer, int window) {, +        sourceBuilder().addRescorer(rescorer.windowSize(window));, +++ b/core/src/main/java/org/elasticsearch/action/search/SearchRequestBuilder.java, +     * {@link #addRescorer(org.elasticsearch.search.rescore.RescoreBuilder, int)}., +    public SearchRequestBuilder setRescorer(RescoreBuilder<?> rescorer) {, +     * {@link #addRescorer(org.elasticsearch.search.rescore.RescoreBuilder, int)}., +    public SearchRequestBuilder setRescorer(RescoreBuilder rescorer, int window) {, +        return addRescorer(rescorer.windowSize(window));, +    public SearchRequestBuilder addRescorer(RescoreBuilder<?> rescorer) {, +        sourceBuilder().addRescorer(rescorer);, +    public SearchRequestBuilder addRescorer(RescoreBuilder<?> rescorer, int window) {, +        sourceBuilder().addRescorer(rescorer.windowSize(window));, +++ b/core/src/main/java/org/elasticsearch/client/transport/TransportClient.java, +                .put("node.client", true), +++ b/core/src/main/java/org/elasticsearch/action/search/SearchRequestBuilder.java, +     * {@link #addRescorer(org.elasticsearch.search.rescore.RescoreBuilder, int)}., +    public SearchRequestBuilder setRescorer(RescoreBuilder<?> rescorer) {, +     * {@link #addRescorer(org.elasticsearch.search.rescore.RescoreBuilder, int)}., +    public SearchRequestBuilder setRescorer(RescoreBuilder rescorer, int window) {, +        return addRescorer(rescorer.windowSize(window));, +    public SearchRequestBuilder addRescorer(RescoreBuilder<?> rescorer) {, +        sourceBuilder().addRescorer(rescorer);, +    public SearchRequestBuilder addRescorer(RescoreBuilder<?> rescorer, int window) {, +        sourceBuilder().addRescorer(rescorer.windowSize(window));, +++ b/core/src/main/java/org/elasticsearch/client/transport/TransportClient.java, +                .put("node.client", true), +++ b/core/src/main/java/org/elasticsearch/cluster/node/DiscoveryNode.java, +        if (settings.get("node.local") != null) {, +            return settings.getAsBoolean("node.local", false);, +        if (settings.get("node.mode") != null) {, +            String nodeMode = settings.get("node.mode");, +        return !(settings.getAsBoolean("node.client", false) || (!settings.getAsBoolean("node.data", true) && !settings.getAsBoolean("node.master", true)));, +        String client = settings.get("node.client");, +        return Booleans.isExplicitTrue(client);, +        String master = settings.get("node.master");, +        if (master == null) {, +            return !clientNode(settings);, +        return Booleans.isExplicitTrue(master);, +        String data = settings.get("node.data");, +        if (data == null) {, +            return !clientNode(settings);, +        return Booleans.isExplicitTrue(data);, +++ b/core/src/main/java/org/elasticsearch/action/search/SearchRequestBuilder.java, +     * {@link #addRescorer(org.elasticsearch.search.rescore.RescoreBuilder, int)}., +    public SearchRequestBuilder setRescorer(RescoreBuilder<?> rescorer) {, +     * {@link #addRescorer(org.elasticsearch.search.rescore.RescoreBuilder, int)}., +    public SearchRequestBuilder setRescorer(RescoreBuilder rescorer, int window) {, +        return addRescorer(rescorer.windowSize(window));, +    public SearchRequestBuilder addRescorer(RescoreBuilder<?> rescorer) {, +        sourceBuilder().addRescorer(rescorer);, +    public SearchRequestBuilder addRescorer(RescoreBuilder<?> rescorer, int window) {, +        sourceBuilder().addRescorer(rescorer.windowSize(window));, +++ b/core/src/main/java/org/elasticsearch/client/transport/TransportClient.java, +                .put("node.client", true), +++ b/core/src/main/java/org/elasticsearch/cluster/node/DiscoveryNode.java, +        if (settings.get("node.local") != null) {, +            return settings.getAsBoolean("node.local", false);, +        if (settings.get("node.mode") != null) {, +            String nodeMode = settings.get("node.mode");, +        return !(settings.getAsBoolean("node.client", false) || (!settings.getAsBoolean("node.data", true) && !settings.getAsBoolean("node.master", true)));, +        String client = settings.get("node.client");, +        return Booleans.isExplicitTrue(client);, +        String master = settings.get("node.master");, +        if (master == null) {, +            return !clientNode(settings);, +        return Booleans.isExplicitTrue(master);, +        String data = settings.get("node.data");, +        if (data == null) {, +            return !clientNode(settings);, +        return Booleans.isExplicitTrue(data);, +++ b/core/src/main/java/org/elasticsearch/common/io/stream/StreamInput.java, +import org.elasticsearch.search.rescore.RescoreBuilder;, +     * Reads a {@link RescoreBuilder} from the current stream, +    public RescoreBuilder<?> readRescorer() throws IOException {, +        return readNamedWriteable(RescoreBuilder.class);, +++ b/core/src/main/java/org/elasticsearch/action/search/SearchRequestBuilder.java, +     * {@link #addRescorer(org.elasticsearch.search.rescore.RescoreBuilder, int)}., +    public SearchRequestBuilder setRescorer(RescoreBuilder<?> rescorer) {, +     * {@link #addRescorer(org.elasticsearch.search.rescore.RescoreBuilder, int)}., +    public SearchRequestBuilder setRescorer(RescoreBuilder rescorer, int window) {, +        return addRescorer(rescorer.windowSize(window));, +    public SearchRequestBuilder addRescorer(RescoreBuilder<?> rescorer) {, +        sourceBuilder().addRescorer(rescorer);, +    public SearchRequestBuilder addRescorer(RescoreBuilder<?> rescorer, int window) {, +        sourceBuilder().addRescorer(rescorer.windowSize(window));, +++ b/core/src/main/java/org/elasticsearch/client/transport/TransportClient.java, +                .put("node.client", true), +++ b/core/src/main/java/org/elasticsearch/cluster/node/DiscoveryNode.java, +        if (settings.get("node.local") != null) {, +            return settings.getAsBoolean("node.local", false);, +        if (settings.get("node.mode") != null) {, +            String nodeMode = settings.get("node.mode");]
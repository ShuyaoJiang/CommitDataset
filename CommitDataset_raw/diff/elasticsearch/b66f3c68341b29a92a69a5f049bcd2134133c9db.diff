[+++ b/src/main/java/org/elasticsearch/action/index/TransportIndexAction.java, +            if (index.parsedDoc().mappingsModified()) {, +                updateMappingOnMaster(request);, +            }, +            if (create.parsedDoc().mappingsModified()) {, +                updateMappingOnMaster(request);, +            }, +, +++ b/src/main/java/org/elasticsearch/action/index/TransportIndexAction.java, +            if (index.parsedDoc().mappingsModified()) {, +                updateMappingOnMaster(request);, +            }, +            if (create.parsedDoc().mappingsModified()) {, +                updateMappingOnMaster(request);, +            }, +, +++ b/src/test/java/org/elasticsearch/indices/mapping/SimpleDeleteMappingTests.java, +        for (int i = 0; i < 10 && !clusterState.metaData().index("test").mappings().containsKey("type1"); i++, Thread.sleep(100)) ;, +, +        assertThat(clusterState.metaData().index("test").mappings(), hasKey("type1"));, +]
[+++ b/modules/rank-eval/src/main/java/org/elasticsearch/index/rankeval/RankEvalContext.java, +import org.elasticsearch.search.SearchRequestParsers;, +    private final SearchRequestParsers searchRequestParsers;, +    public RankEvalContext(ParseFieldMatcher parseFieldMatcher, QueryParseContext parseContext, SearchRequestParsers searchRequestParsers) {, +        this.searchRequestParsers = searchRequestParsers;, +        return searchRequestParsers.suggesters;, +        return searchRequestParsers.aggParsers;, +++ b/modules/rank-eval/src/main/java/org/elasticsearch/index/rankeval/RankEvalContext.java, +import org.elasticsearch.search.SearchRequestParsers;, +    private final SearchRequestParsers searchRequestParsers;, +    public RankEvalContext(ParseFieldMatcher parseFieldMatcher, QueryParseContext parseContext, SearchRequestParsers searchRequestParsers) {, +        this.searchRequestParsers = searchRequestParsers;, +        return searchRequestParsers.suggesters;, +        return searchRequestParsers.aggParsers;, +++ b/modules/rank-eval/src/main/java/org/elasticsearch/index/rankeval/RestRankEvalAction.java, +import org.elasticsearch.search.SearchRequestParsers;, +    private SearchRequestParsers searchRequestParsers;, +    public RestRankEvalAction(Settings settings, RestController controller, SearchRequestParsers searchRequestParsers) {, +        this.searchRequestParsers = searchRequestParsers;, +            QueryParseContext parseContext = new QueryParseContext(searchRequestParsers.queryParsers, parser, parseFieldMatcher);, +                        new RankEvalContext(parseFieldMatcher, parseContext, searchRequestParsers));, +++ b/modules/rank-eval/src/main/java/org/elasticsearch/index/rankeval/RankEvalContext.java, +import org.elasticsearch.search.SearchRequestParsers;, +    private final SearchRequestParsers searchRequestParsers;, +    public RankEvalContext(ParseFieldMatcher parseFieldMatcher, QueryParseContext parseContext, SearchRequestParsers searchRequestParsers) {, +        this.searchRequestParsers = searchRequestParsers;, +        return searchRequestParsers.suggesters;, +        return searchRequestParsers.aggParsers;, +++ b/modules/rank-eval/src/main/java/org/elasticsearch/index/rankeval/RestRankEvalAction.java, +import org.elasticsearch.search.SearchRequestParsers;, +    private SearchRequestParsers searchRequestParsers;, +    public RestRankEvalAction(Settings settings, RestController controller, SearchRequestParsers searchRequestParsers) {, +        this.searchRequestParsers = searchRequestParsers;, +            QueryParseContext parseContext = new QueryParseContext(searchRequestParsers.queryParsers, parser, parseFieldMatcher);, +                        new RankEvalContext(parseFieldMatcher, parseContext, searchRequestParsers));, +++ b/modules/rank-eval/src/test/java/org/elasticsearch/index/rankeval/QuerySpecTests.java, +import org.elasticsearch.search.SearchRequestParsers;, +    private static SearchRequestParsers searchRequestParsers;, +        AggregatorParsers aggsParsers = new AggregatorParsers(new ParseFieldRegistry<>("aggregation"),, +                new ParseFieldRegistry<>("aggregation_pipes"));, +        IndicesQueriesRegistry queriesRegistry = searchModule.getQueryParserRegistry();, +        Suggesters suggesters = searchModule.getSuggesters();, +        searchRequestParsers = new SearchRequestParsers(queriesRegistry, aggsParsers, suggesters);, +        searchRequestParsers = null;, +        QueryParseContext queryContext = new QueryParseContext(searchRequestParsers.queryParsers, parser, ParseFieldMatcher.STRICT);, +                searchRequestParsers);, +++ b/modules/rank-eval/src/main/java/org/elasticsearch/index/rankeval/RankEvalContext.java, +import org.elasticsearch.search.SearchRequestParsers;, +    private final SearchRequestParsers searchRequestParsers;, +    public RankEvalContext(ParseFieldMatcher parseFieldMatcher, QueryParseContext parseContext, SearchRequestParsers searchRequestParsers) {, +        this.searchRequestParsers = searchRequestParsers;, +        return searchRequestParsers.suggesters;, +        return searchRequestParsers.aggParsers;, +++ b/modules/rank-eval/src/main/java/org/elasticsearch/index/rankeval/RestRankEvalAction.java, +import org.elasticsearch.search.SearchRequestParsers;, +    private SearchRequestParsers searchRequestParsers;, +    public RestRankEvalAction(Settings settings, RestController controller, SearchRequestParsers searchRequestParsers) {, +        this.searchRequestParsers = searchRequestParsers;, +            QueryParseContext parseContext = new QueryParseContext(searchRequestParsers.queryParsers, parser, parseFieldMatcher);, +                        new RankEvalContext(parseFieldMatcher, parseContext, searchRequestParsers));, +++ b/modules/rank-eval/src/test/java/org/elasticsearch/index/rankeval/QuerySpecTests.java, +import org.elasticsearch.search.SearchRequestParsers;, +    private static SearchRequestParsers searchRequestParsers;, +        AggregatorParsers aggsParsers = new AggregatorParsers(new ParseFieldRegistry<>("aggregation"),, +                new ParseFieldRegistry<>("aggregation_pipes"));, +        IndicesQueriesRegistry queriesRegistry = searchModule.getQueryParserRegistry();, +        Suggesters suggesters = searchModule.getSuggesters();, +        searchRequestParsers = new SearchRequestParsers(queriesRegistry, aggsParsers, suggesters);, +        searchRequestParsers = null;, +        QueryParseContext queryContext = new QueryParseContext(searchRequestParsers.queryParsers, parser, ParseFieldMatcher.STRICT);, +                searchRequestParsers);, +++ b/modules/rank-eval/src/test/java/org/elasticsearch/index/rankeval/RatedDocumentTests.java, +        RankEvalContext context = new RankEvalContext(ParseFieldMatcher.STRICT, null, null);]
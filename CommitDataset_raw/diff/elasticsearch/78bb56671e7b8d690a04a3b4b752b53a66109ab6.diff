[+++ b/modules/reindex/src/main/java/org/elasticsearch/index/reindex/ClientScrollableHitSource.java, +    public void clearScroll(String scrollId, Runnable onCompletion) {, +                onCompletion.run();, +                onCompletion.run();, +    @Override, +    protected void cleanup() {, +        // Nothing to do, +    }, +, +++ b/modules/reindex/src/main/java/org/elasticsearch/index/reindex/ClientScrollableHitSource.java, +    public void clearScroll(String scrollId, Runnable onCompletion) {, +                onCompletion.run();, +                onCompletion.run();, +    @Override, +    protected void cleanup() {, +        // Nothing to do, +    }, +, +++ b/modules/reindex/src/main/java/org/elasticsearch/index/reindex/ScrollableHitSource.java, +    public final void close() {, +            clearScroll(scrollId, this::cleanup);, +        } else {, +            cleanup();, +    /**, +     * Called to clear a scroll id., +     * @param scrollId the id to clear, +     * @param onCompletion implementers must call this after completing the clear whether they are successful or not, +     */, +    protected abstract void clearScroll(String scrollId, Runnable onCompletion);, +    /**, +     * Called after the process has been totally finished to clean up any resources the process needed like remote connections., +     */, +    protected abstract void cleanup();, +++ b/modules/reindex/src/main/java/org/elasticsearch/index/reindex/ClientScrollableHitSource.java, +    public void clearScroll(String scrollId, Runnable onCompletion) {, +                onCompletion.run();, +                onCompletion.run();, +    @Override, +    protected void cleanup() {, +        // Nothing to do, +    }, +, +++ b/modules/reindex/src/main/java/org/elasticsearch/index/reindex/ScrollableHitSource.java, +    public final void close() {, +            clearScroll(scrollId, this::cleanup);, +        } else {, +            cleanup();, +    /**, +     * Called to clear a scroll id., +     * @param scrollId the id to clear, +     * @param onCompletion implementers must call this after completing the clear whether they are successful or not, +     */, +    protected abstract void clearScroll(String scrollId, Runnable onCompletion);, +    /**, +     * Called after the process has been totally finished to clean up any resources the process needed like remote connections., +     */, +    protected abstract void cleanup();, +++ b/modules/reindex/src/main/java/org/elasticsearch/index/reindex/remote/RemoteScrollableHitSource.java, +    protected void clearScroll(String scrollId, Runnable onCompletion) {, +                onCompletion.run();, +                onCompletion.run();, +            }, +        });, +    }, +, +    @Override, +    protected void cleanup() {, +        /* This is called on the RestClient's thread pool and attempting to close the client on its own threadpool causes it to fail to, +         * close. So we always shutdown the RestClient asynchronously on a thread in Elasticsearch's generic thread pool. */, +        threadPool.generic().submit(() -> {, +            try {, +                client.close();, +                logger.info("Shut down remote connection");, +            } catch (IOException e) {, +                logger.error("Failed to shutdown the remote connection", e);, +++ b/modules/reindex/src/main/java/org/elasticsearch/index/reindex/ClientScrollableHitSource.java, +    public void clearScroll(String scrollId, Runnable onCompletion) {, +                onCompletion.run();, +                onCompletion.run();, +    @Override, +    protected void cleanup() {, +        // Nothing to do, +    }, +, +++ b/modules/reindex/src/main/java/org/elasticsearch/index/reindex/ScrollableHitSource.java, +    public final void close() {, +            clearScroll(scrollId, this::cleanup);, +        } else {, +            cleanup();, +    /**, +     * Called to clear a scroll id., +     * @param scrollId the id to clear, +     * @param onCompletion implementers must call this after completing the clear whether they are successful or not, +     */, +    protected abstract void clearScroll(String scrollId, Runnable onCompletion);, +    /**, +     * Called after the process has been totally finished to clean up any resources the process needed like remote connections., +     */, +    protected abstract void cleanup();, +++ b/modules/reindex/src/main/java/org/elasticsearch/index/reindex/remote/RemoteScrollableHitSource.java]
[+++ b/core/src/main/java/org/elasticsearch/cluster/InternalClusterInfoService.java, +                buildShardLevelInfo(logger, stats, newShardSizes, newShardRoutingToDataPath);, +            ImmutableOpenMap.Builder<ShardRouting, String> newShardRoutingToDataPath) {, +++ b/core/src/main/java/org/elasticsearch/cluster/InternalClusterInfoService.java, +                buildShardLevelInfo(logger, stats, newShardSizes, newShardRoutingToDataPath);, +            ImmutableOpenMap.Builder<ShardRouting, String> newShardRoutingToDataPath) {, +++ b/core/src/main/java/org/elasticsearch/common/ParseField.java, +import java.util.Collections;, +import java.util.Set;, +    private final String[] allNames;, +        Set<String> allNames = new HashSet<>();, +        allNames.add(camelCaseName);, +        allNames.add(underscoreName);, +        Collections.addAll(allNames, this.deprecatedNames);, +        this.allNames = allNames.toArray(new String[allNames.size()]);, +++ b/core/src/main/java/org/elasticsearch/cluster/InternalClusterInfoService.java, +                buildShardLevelInfo(logger, stats, newShardSizes, newShardRoutingToDataPath);, +            ImmutableOpenMap.Builder<ShardRouting, String> newShardRoutingToDataPath) {, +++ b/core/src/main/java/org/elasticsearch/common/ParseField.java, +import java.util.Collections;, +import java.util.Set;, +    private final String[] allNames;, +        Set<String> allNames = new HashSet<>();, +        allNames.add(camelCaseName);, +        allNames.add(underscoreName);, +        Collections.addAll(allNames, this.deprecatedNames);, +        this.allNames = allNames.toArray(new String[allNames.size()]);, +++ b/core/src/test/java/org/elasticsearch/cluster/DiskUsageTests.java, +        InternalClusterInfoService.buildShardLevelInfo(logger, stats, shardSizes, routingToPath);, +++ b/core/src/main/java/org/elasticsearch/cluster/InternalClusterInfoService.java, +                buildShardLevelInfo(logger, stats, newShardSizes, newShardRoutingToDataPath);, +            ImmutableOpenMap.Builder<ShardRouting, String> newShardRoutingToDataPath) {, +++ b/core/src/main/java/org/elasticsearch/common/ParseField.java, +import java.util.Collections;, +import java.util.Set;, +    private final String[] allNames;, +        Set<String> allNames = new HashSet<>();, +        allNames.add(camelCaseName);, +        allNames.add(underscoreName);, +        Collections.addAll(allNames, this.deprecatedNames);, +        this.allNames = allNames.toArray(new String[allNames.size()]);, +++ b/core/src/test/java/org/elasticsearch/cluster/DiskUsageTests.java, +        InternalClusterInfoService.buildShardLevelInfo(logger, stats, shardSizes, routingToPath);, +++ b/core/src/test/java/org/elasticsearch/common/ParseFieldTests.java, +import static org.hamcrest.collection.IsArrayContainingInAnyOrder.arrayContainingInAnyOrder;, +, +    public void testGetAllNamesIncludedDeprecated() {, +        ParseField parseField = new ParseField("terms", "in");, +        assertThat(parseField.getAllNamesIncludedDeprecated(), arrayContainingInAnyOrder("terms", "in"));, +, +        parseField = new ParseField("more_like_this", "mlt");, +        assertThat(parseField.getAllNamesIncludedDeprecated(), arrayContainingInAnyOrder("more_like_this", "moreLikeThis", "mlt"));, +    }, +++ b/core/src/main/java/org/elasticsearch/cluster/InternalClusterInfoService.java, +                buildShardLevelInfo(logger, stats, newShardSizes, newShardRoutingToDataPath);, +            ImmutableOpenMap.Builder<ShardRouting, String> newShardRoutingToDataPath) {, +++ b/core/src/main/java/org/elasticsearch/common/ParseField.java, +import java.util.Collections;, +import java.util.Set;, +    private final String[] allNames;, +        Set<String> allNames = new HashSet<>();, +        allNames.add(camelCaseName);, +        allNames.add(underscoreName);, +        Collections.addAll(allNames, this.deprecatedNames);, +        this.allNames = allNames.toArray(new String[allNames.size()]);, +++ b/core/src/test/java/org/elasticsearch/cluster/DiskUsageTests.java, +        InternalClusterInfoService.buildShardLevelInfo(logger, stats, shardSizes, routingToPath);, +++ b/core/src/test/java/org/elasticsearch/common/ParseFieldTests.java, +import static org.hamcrest.collection.IsArrayContainingInAnyOrder.arrayContainingInAnyOrder;, +, +    public void testGetAllNamesIncludedDeprecated() {, +        ParseField parseField = new ParseField("terms", "in");, +        assertThat(parseField.getAllNamesIncludedDeprecated(), arrayContainingInAnyOrder("terms", "in"));, +, +        parseField = new ParseField("more_like_this", "mlt");, +        assertThat(parseField.getAllNamesIncludedDeprecated(), arrayContainingInAnyOrder("more_like_this", "moreLikeThis", "mlt"));, +    }, +++ b/rest-api-spec/src/main/resources/rest-api-spec/api/update_by_query.json, +         "required" : true,]
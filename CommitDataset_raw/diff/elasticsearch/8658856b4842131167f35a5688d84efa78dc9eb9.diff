[+++ b/modules/elasticsearch/src/main/java/org/elasticsearch/cluster/routing/RoutingNodes.java, +            List<MutableShardRouting> nShards = routingNode.shards();, +            for (int i = 0; i < nShards.size(); i++) {, +                MutableShardRouting shardRouting = nShards.get(i);, +        for (int i = 0; i < unassigned.size(); i++) {, +            MutableShardRouting shardRouting = unassigned.get(i);]
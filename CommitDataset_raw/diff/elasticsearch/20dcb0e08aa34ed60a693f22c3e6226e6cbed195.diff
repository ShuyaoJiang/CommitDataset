[+++ b/src/test/java/org/elasticsearch/test/ElasticsearchBackwardsCompatIntegrationTest.java, +import org.elasticsearch.cluster.node.DiscoveryNode;, +import org.elasticsearch.common.collect.Tuple;, +import org.elasticsearch.env.Environment;, +import org.elasticsearch.node.internal.InternalSettingsPreparer;, +        Settings settings = ImmutableSettings.builder(), +, +        // verify that the end node setting will have network enabled., +        Tuple<Settings, Environment> finalSettings = InternalSettingsPreparer.prepareSettings(settings, true);, +        assertFalse("backward compatibility tests must run in network mode. You probably have a system property overriding the test settings",, +                DiscoveryNode.localNode(finalSettings.v1()));, +        return settings;, +++ b/src/test/java/org/elasticsearch/test/ElasticsearchBackwardsCompatIntegrationTest.java, +import org.elasticsearch.cluster.node.DiscoveryNode;, +import org.elasticsearch.common.collect.Tuple;, +import org.elasticsearch.env.Environment;, +import org.elasticsearch.node.internal.InternalSettingsPreparer;, +        Settings settings = ImmutableSettings.builder(), +, +        // verify that the end node setting will have network enabled., +        Tuple<Settings, Environment> finalSettings = InternalSettingsPreparer.prepareSettings(settings, true);, +        assertFalse("backward compatibility tests must run in network mode. You probably have a system property overriding the test settings",, +                DiscoveryNode.localNode(finalSettings.v1()));, +        return settings;, +++ b/src/test/java/org/elasticsearch/test/ExternalTestCluster.java, +import org.elasticsearch.cluster.node.DiscoveryNode;, +import org.elasticsearch.common.collect.Tuple;, +import org.elasticsearch.common.settings.Settings;, +import org.elasticsearch.env.Environment;, +import org.elasticsearch.node.internal.InternalSettingsPreparer;, +import static junit.framework.Assert.assertFalse;, +, +        Settings clientSettings = ImmutableSettings.settingsBuilder(), +                .put("node.mode", "network").build(); // we require network here!, +, +        // verify that the end node setting will have network enabled., +        Tuple<Settings, Environment> finalSettings = InternalSettingsPreparer.prepareSettings(clientSettings, true);, +        assertFalse("backward compatibility tests must run in network mode. You probably have a system property overriding the test settings",, +                DiscoveryNode.localNode(finalSettings.v1()));, +, +        this.client = new TransportClient(clientSettings).addTransportAddresses(transportAddresses);]
[+++ b/client/rest-high-level/src/test/java/org/elasticsearch/client/BulkProcessorIT.java, +            assertThat(bulkItemResponse.getType(), equalTo("_doc"));, +                    processor.add(new IndexRequest("test", "_doc", Integer.toString(testDocs)), +                    multiGetRequest.add("test", Integer.toString(testDocs));, +                    processor.add(new IndexRequest("test-ro", "_doc", Integer.toString(testReadOnlyDocs)), +            assertThat(bulkItemResponse.getType(), equalTo("_doc"));, +                .setGlobalType("_doc"), +            indexDocs(processor, numDocs, null, null, "test", "pipeline_id");, +            assertThat(hits, everyItem(Matchers.allOf(hasIndex("test"), hasType("_doc"))));, +    private static MultiGetRequest indexDocs(BulkProcessor processor, int numDocs, String localIndex,, +                processor.add(new IndexRequest(localIndex, "_doc", Integer.toString(i)), +                BytesArray data = bytesBulkRequest(localIndex, "_doc", i);, +            multiGetRequest.add(localIndex, Integer.toString(i));, +        return indexDocs(processor, numDocs, "test", null, null, null);, +            assertThat(bulkItemResponse.getType(), equalTo("_doc"));, +            assertThat(multiGetItemResponse.getType(), equalTo("_doc"));, +++ b/client/rest-high-level/src/test/java/org/elasticsearch/client/BulkProcessorIT.java, +            assertThat(bulkItemResponse.getType(), equalTo("_doc"));, +                    processor.add(new IndexRequest("test", "_doc", Integer.toString(testDocs)), +                    multiGetRequest.add("test", Integer.toString(testDocs));, +                    processor.add(new IndexRequest("test-ro", "_doc", Integer.toString(testReadOnlyDocs)), +            assertThat(bulkItemResponse.getType(), equalTo("_doc"));, +                .setGlobalType("_doc"), +            indexDocs(processor, numDocs, null, null, "test", "pipeline_id");, +            assertThat(hits, everyItem(Matchers.allOf(hasIndex("test"), hasType("_doc"))));, +    private static MultiGetRequest indexDocs(BulkProcessor processor, int numDocs, String localIndex,, +                processor.add(new IndexRequest(localIndex, "_doc", Integer.toString(i)), +                BytesArray data = bytesBulkRequest(localIndex, "_doc", i);, +            multiGetRequest.add(localIndex, Integer.toString(i));, +        return indexDocs(processor, numDocs, "test", null, null, null);, +            assertThat(bulkItemResponse.getType(), equalTo("_doc"));, +            assertThat(multiGetItemResponse.getType(), equalTo("_doc"));, +++ b/client/rest-high-level/src/test/java/org/elasticsearch/client/BulkProcessorRetryIT.java, +            processor.add(new IndexRequest(INDEX_NAME, "_doc", Integer.toString(i)), +            multiGetRequest.add(INDEX_NAME, Integer.toString(i));, +++ b/client/rest-high-level/src/test/java/org/elasticsearch/client/BulkProcessorIT.java, +            assertThat(bulkItemResponse.getType(), equalTo("_doc"));, +                    processor.add(new IndexRequest("test", "_doc", Integer.toString(testDocs)), +                    multiGetRequest.add("test", Integer.toString(testDocs));, +                    processor.add(new IndexRequest("test-ro", "_doc", Integer.toString(testReadOnlyDocs)), +            assertThat(bulkItemResponse.getType(), equalTo("_doc"));, +                .setGlobalType("_doc"), +            indexDocs(processor, numDocs, null, null, "test", "pipeline_id");, +            assertThat(hits, everyItem(Matchers.allOf(hasIndex("test"), hasType("_doc"))));, +    private static MultiGetRequest indexDocs(BulkProcessor processor, int numDocs, String localIndex,, +                processor.add(new IndexRequest(localIndex, "_doc", Integer.toString(i)), +                BytesArray data = bytesBulkRequest(localIndex, "_doc", i);, +            multiGetRequest.add(localIndex, Integer.toString(i));, +        return indexDocs(processor, numDocs, "test", null, null, null);, +            assertThat(bulkItemResponse.getType(), equalTo("_doc"));, +            assertThat(multiGetItemResponse.getType(), equalTo("_doc"));, +++ b/client/rest-high-level/src/test/java/org/elasticsearch/client/BulkProcessorRetryIT.java, +            processor.add(new IndexRequest(INDEX_NAME, "_doc", Integer.toString(i)), +            multiGetRequest.add(INDEX_NAME, Integer.toString(i));, +++ b/client/rest-high-level/src/test/java/org/elasticsearch/client/CrudIT.java, +            GetRequest getRequest = new GetRequest("index", "id");, +            GetRequest getRequest = new GetRequest("index", "id");, +            GetRequest getRequest = new GetRequest("index", "does_not_exist");, +            GetRequest getRequest = new GetRequest("index", "does_not_exist").version(1);, +            GetRequest getRequest = new GetRequest("index", "id");, +            GetRequest getRequest = new GetRequest("index", "id");, +            GetRequest getRequest = new GetRequest("index", "does_not_exist");, +            GetRequest getRequest = new GetRequest("index", "does_not_exist").version(1);, +            GetRequest getRequest = new GetRequest(noSourceIndex, "1");, +            GetRequest getRequest = new GetRequest("index", "id");, +            GetRequest getRequest = new GetRequest("index", "id").version(2);, +            GetRequest getRequest = new GetRequest("index", "id");, +            GetRequest getRequest = new GetRequest("index", "does_not_exist");, +            GetRequest getRequest = new GetRequest("index", "id");, +            GetRequest getRequest = new GetRequest("index", "id");, +            multiGetRequest.add("index", "id1");, +            multiGetRequest.add("index", "id2");, +            assertNull(response.getResponses()[0].getFailure().getType());, +            assertNull(response.getResponses()[1].getType());, +            multiGetRequest.add("index", "id1");, +            multiGetRequest.add("index", "id2");, +                (int) (highLevelClient().get(new GetRequest(sourceIndex, "2"), RequestOptions.DEFAULT), +            GetRequest getRequest = new GetRequest(indexPattern, "id#1");, +            GetRequest getRequest = new GetRequest("index", docId);, +            GetRequest getRequest = new GetRequest("index", "id").routing(routing);, +++ b/client/rest-high-level/src/test/java/org/elasticsearch/client/BulkProcessorIT.java, +            assertThat(bulkItemResponse.getType(), equalTo("_doc"));, +                    processor.add(new IndexRequest("test", "_doc", Integer.toString(testDocs)), +                    multiGetRequest.add("test", Integer.toString(testDocs));, +                    processor.add(new IndexRequest("test-ro", "_doc", Integer.toString(testReadOnlyDocs)), +            assertThat(bulkItemResponse.getType(), equalTo("_doc"));, +                .setGlobalType("_doc"), +            indexDocs(processor, numDocs, null, null, "test", "pipeline_id");, +            assertThat(hits, everyItem(Matchers.allOf(hasIndex("test"), hasType("_doc"))));, +    private static MultiGetRequest indexDocs(BulkProcessor processor, int numDocs, String localIndex,, +                processor.add(new IndexRequest(localIndex, "_doc", Integer.toString(i)), +                BytesArray data = bytesBulkRequest(localIndex, "_doc", i);, +            multiGetRequest.add(localIndex, Integer.toString(i));, +        return indexDocs(processor, numDocs, "test", null, null, null);, +            assertThat(bulkItemResponse.getType(), equalTo("_doc"));, +            assertThat(multiGetItemResponse.getType(), equalTo("_doc"));, +++ b/client/rest-high-level/src/test/java/org/elasticsearch/client/BulkProcessorRetryIT.java, +            processor.add(new IndexRequest(INDEX_NAME, "_doc", Integer.toString(i)), +            multiGetRequest.add(INDEX_NAME, Integer.toString(i));, +++ b/client/rest-high-level/src/test/java/org/elasticsearch/client/CrudIT.java]
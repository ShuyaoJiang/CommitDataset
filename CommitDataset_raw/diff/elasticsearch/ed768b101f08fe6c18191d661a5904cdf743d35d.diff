[+++ b/core/src/main/java/org/elasticsearch/action/ingest/SimulateProcessorResult.java, +import org.elasticsearch.ElasticsearchParseException;, +class SimulateProcessorResult implements Writeable, ToXContent {, +    SimulateProcessorResult(String processorTag, IngestDocument ingestDocument, Exception failure) {, +        this.ingestDocument = (ingestDocument == null) ? null : new WriteableIngestDocument(ingestDocument);, +        this.failure = failure;, +    SimulateProcessorResult(String processorTag, IngestDocument ingestDocument) {, +        this(processorTag, ingestDocument, null);, +    }, +, +    SimulateProcessorResult(String processorTag, Exception failure) {, +        this(processorTag, null, failure);, +    SimulateProcessorResult(StreamInput in) throws IOException {, +        } else {, +            this.ingestDocument = null;, +        this.failure = in.readException();, +        if (ingestDocument == null) {, +            ingestDocument.writeTo(out);, +        out.writeException(failure);, +, +, +        if (failure != null && ingestDocument != null) {, +            builder.startObject("ignored_error");, +            ElasticsearchException.renderException(builder, params, failure);, +            builder.endObject();, +        } else if (failure != null) {, +, +        if (ingestDocument != null) {, +            ingestDocument.toXContent(builder, params);, +        }, +, +++ b/core/src/main/java/org/elasticsearch/action/ingest/SimulateProcessorResult.java, +import org.elasticsearch.ElasticsearchParseException;, +class SimulateProcessorResult implements Writeable, ToXContent {, +    SimulateProcessorResult(String processorTag, IngestDocument ingestDocument, Exception failure) {, +        this.ingestDocument = (ingestDocument == null) ? null : new WriteableIngestDocument(ingestDocument);, +        this.failure = failure;, +    SimulateProcessorResult(String processorTag, IngestDocument ingestDocument) {, +        this(processorTag, ingestDocument, null);, +    }, +, +    SimulateProcessorResult(String processorTag, Exception failure) {, +        this(processorTag, null, failure);, +    SimulateProcessorResult(StreamInput in) throws IOException {, +        } else {, +            this.ingestDocument = null;, +        this.failure = in.readException();, +        if (ingestDocument == null) {, +            ingestDocument.writeTo(out);, +        out.writeException(failure);, +, +, +        if (failure != null && ingestDocument != null) {, +            builder.startObject("ignored_error");, +            ElasticsearchException.renderException(builder, params, failure);, +            builder.endObject();, +        } else if (failure != null) {, +, +        if (ingestDocument != null) {, +            ingestDocument.toXContent(builder, params);, +        }, +, +++ b/core/src/main/java/org/elasticsearch/action/ingest/TrackingResultProcessor.java, +                processorResultList.add(new SimulateProcessorResult(actualProcessor.getTag(), new IngestDocument(ingestDocument), e));, +++ b/core/src/main/java/org/elasticsearch/action/ingest/SimulateProcessorResult.java, +import org.elasticsearch.ElasticsearchParseException;, +class SimulateProcessorResult implements Writeable, ToXContent {, +    SimulateProcessorResult(String processorTag, IngestDocument ingestDocument, Exception failure) {, +        this.ingestDocument = (ingestDocument == null) ? null : new WriteableIngestDocument(ingestDocument);, +        this.failure = failure;, +    SimulateProcessorResult(String processorTag, IngestDocument ingestDocument) {, +        this(processorTag, ingestDocument, null);, +    }, +, +    SimulateProcessorResult(String processorTag, Exception failure) {, +        this(processorTag, null, failure);, +    SimulateProcessorResult(StreamInput in) throws IOException {, +        } else {, +            this.ingestDocument = null;, +        this.failure = in.readException();, +        if (ingestDocument == null) {, +            ingestDocument.writeTo(out);, +        out.writeException(failure);, +, +, +        if (failure != null && ingestDocument != null) {, +            builder.startObject("ignored_error");, +            ElasticsearchException.renderException(builder, params, failure);, +            builder.endObject();, +        } else if (failure != null) {, +, +        if (ingestDocument != null) {, +            ingestDocument.toXContent(builder, params);, +        }, +, +++ b/core/src/main/java/org/elasticsearch/action/ingest/TrackingResultProcessor.java, +                processorResultList.add(new SimulateProcessorResult(actualProcessor.getTag(), new IngestDocument(ingestDocument), e));, +++ b/core/src/test/java/org/elasticsearch/action/ingest/SimulateExecutionServiceTests.java, +        RuntimeException exception = new RuntimeException("processor failed");, +        TestProcessor testProcessor = new TestProcessor("processor_0", "mock", ingestDocument -> { throw exception; });]
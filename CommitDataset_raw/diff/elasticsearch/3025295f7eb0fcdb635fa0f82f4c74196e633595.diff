[+++ b/server/src/main/java/org/elasticsearch/common/geo/GeoPoint.java, +import org.elasticsearch.common.xcontent.ToXContent;, +import org.elasticsearch.common.xcontent.ToXContentFragment;, +import org.elasticsearch.common.xcontent.XContentBuilder;, +import java.io.IOException;, +public final class GeoPoint implements ToXContentFragment {, +, +    @Override, +    public XContentBuilder toXContent(XContentBuilder builder, Params params) throws IOException {, +        return builder.latlon(lat, lon);, +    }, +++ b/server/src/main/java/org/elasticsearch/common/geo/GeoPoint.java, +import org.elasticsearch.common.xcontent.ToXContent;, +import org.elasticsearch.common.xcontent.ToXContentFragment;, +import org.elasticsearch.common.xcontent.XContentBuilder;, +import java.io.IOException;, +public final class GeoPoint implements ToXContentFragment {, +, +    @Override, +    public XContentBuilder toXContent(XContentBuilder builder, Params params) throws IOException {, +        return builder.latlon(lat, lon);, +    }, +++ b/server/src/main/java/org/elasticsearch/common/text/Text.java, +import org.elasticsearch.common.xcontent.ToXContent;, +import org.elasticsearch.common.xcontent.ToXContentFragment;, +import org.elasticsearch.common.xcontent.XContentBuilder;, +import java.io.IOException;, +public final class Text implements Comparable<Text>, ToXContentFragment {, +, +    @Override, +    public XContentBuilder toXContent(XContentBuilder builder, Params params) throws IOException {, +        if (hasString()) {, +            return builder.value(this.string());, +        } else {, +            // TODO: TextBytesOptimization we can use a buffer here to convert it? maybe add a, +            // request to jackson to support InputStream as well?, +            return builder.utf8Value(this.bytes().toBytesRef());, +        }, +    }, +++ b/server/src/main/java/org/elasticsearch/common/geo/GeoPoint.java, +import org.elasticsearch.common.xcontent.ToXContent;, +import org.elasticsearch.common.xcontent.ToXContentFragment;, +import org.elasticsearch.common.xcontent.XContentBuilder;, +import java.io.IOException;, +public final class GeoPoint implements ToXContentFragment {, +, +    @Override, +    public XContentBuilder toXContent(XContentBuilder builder, Params params) throws IOException {, +        return builder.latlon(lat, lon);, +    }, +++ b/server/src/main/java/org/elasticsearch/common/text/Text.java, +import org.elasticsearch.common.xcontent.ToXContent;, +import org.elasticsearch.common.xcontent.ToXContentFragment;, +import org.elasticsearch.common.xcontent.XContentBuilder;, +import java.io.IOException;, +public final class Text implements Comparable<Text>, ToXContentFragment {, +, +    @Override, +    public XContentBuilder toXContent(XContentBuilder builder, Params params) throws IOException {, +        if (hasString()) {, +            return builder.value(this.string());, +        } else {, +            // TODO: TextBytesOptimization we can use a buffer here to convert it? maybe add a, +            // request to jackson to support InputStream as well?, +            return builder.utf8Value(this.bytes().toBytesRef());, +        }, +    }, +++ b/server/src/main/java/org/elasticsearch/common/xcontent/XContentBuilder.java, +    // LatLon]
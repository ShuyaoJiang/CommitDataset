[+++ b/src/main/java/org/elasticsearch/index/mapper/MapperService.java, +                assert assertSerialization(oldMapper);, +                assert assertSerialization(mapper);, +    private boolean assertSerialization(DocumentMapper mapper) {, +        // capture the source now, it may change due to concurrent parsing, +        final CompressedString mappingSource = mapper.mappingSource();, +        DocumentMapper newMapper = parse(mapper.type(), mappingSource, false);, +, +        if (newMapper.mappingSource().equals(mappingSource) == false) {, +            throw new IllegalStateException("DocumentMapper serialization result is different from source. \n--> Source [", +                + mappingSource + "]\n--> Result [", +                + newMapper.mappingSource() + "]");, +        }, +        return true;, +    }, +]
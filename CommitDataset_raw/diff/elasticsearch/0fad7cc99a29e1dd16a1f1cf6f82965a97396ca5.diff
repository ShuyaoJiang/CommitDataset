[+++ b/modules/transport-netty4/src/main/java/org/elasticsearch/transport/netty4/Netty4SizeHeaderFrameDecoder.java, +            int messageLength = TcpTransport.readMessageLength(networkBytes);, +            // If the message length is -1, we have not read a complete header., +            if (messageLength != -1) {, +                int messageLengthWithHeader = messageLength + HEADER_SIZE;, +                // If the message length is greater than the network bytes available, we have not read a complete frame., +                if (messageLengthWithHeader <= networkBytes.length()) {, +                    if (messageLengthWithHeader != 6) {, +            }]
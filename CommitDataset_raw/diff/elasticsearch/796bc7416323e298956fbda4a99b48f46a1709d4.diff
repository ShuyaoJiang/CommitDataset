[+++ b/core/src/main/java/org/elasticsearch/index/query/RegexpQueryBuilder.java, +                    if (fieldName != null) {, +                        throw new ParsingException(parser.getTokenLocation(), "[regexp] query doesn't support multiple fields, found [", +                                + fieldName + "] and [" + parser.currentName() + "]");, +                    }, +++ b/core/src/main/java/org/elasticsearch/index/query/RegexpQueryBuilder.java, +                    if (fieldName != null) {, +                        throw new ParsingException(parser.getTokenLocation(), "[regexp] query doesn't support multiple fields, found [", +                                + fieldName + "] and [" + parser.currentName() + "]");, +                    }, +++ b/core/src/test/java/org/elasticsearch/index/query/RegexpQueryBuilderTests.java, +, +        String shortJson =, +                "{\n" +, +                "    \"regexp\": {\n" +, +                "      \"user1\": \"k.*y\",\n" +, +                "      \"user2\": \"k.*y\"\n" +, +                "    }\n" +, +                "}";, +        e = expectThrows(ParsingException.class, () -> parseQuery(shortJson));, +        assertEquals("[regexp] query doesn't support multiple fields, found [user1] and [user2]", e.getMessage());]
[+++ b/src/test/java/org/elasticsearch/script/expression/ExpressionScriptTests.java, +import org.elasticsearch.action.search.*;, +    private SearchRequestBuilder buildRequest(String script, Object... params) {, +        return req;, +        SearchResponse rsp = buildRequest("doc['foo'].value + 1").get();, +        ScoreFunctionBuilder score = ScoreFunctionBuilders.scriptFunction("1 / _score", "expression");, +        req.setSearchType(SearchType.DFS_QUERY_THEN_FETCH); // make sure DF is consistent, +        SearchResponse rsp = buildRequest("doc['x'].value + 1").get();, +            buildRequest("doc['bogus'].value").get();, +        String script = "doc['x'].value * a + b + ((c + doc['x'].value) > 5000000009 ? 1 : 0)";, +        SearchResponse rsp = buildRequest(script, "a", 2, "b", 3.5, "c", 5000000000L).get();, +            buildRequest("garbage%@#%@").get();, +            buildRequest("a", "a", "astring").get();, +            buildRequest("doc['text'].value").get();, +            buildRequest("bogus").get();, +            buildRequest("doc").get();, +            buildRequest("doc['foo'].bogus").get();]
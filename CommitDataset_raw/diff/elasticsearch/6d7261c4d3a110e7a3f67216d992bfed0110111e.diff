[+++ b/core/src/main/java/org/elasticsearch/ingest/ConfigurationUtils.java, +        String tag = ConfigurationUtils.readOptionalStringProperty(null, null, config, TAG_KEY);, +        throw newConfigurationException(type, tag, null, "No processor type exists with name [" + type + "]");, +++ b/core/src/main/java/org/elasticsearch/ingest/ConfigurationUtils.java, +        String tag = ConfigurationUtils.readOptionalStringProperty(null, null, config, TAG_KEY);, +        throw newConfigurationException(type, tag, null, "No processor type exists with name [" + type + "]");, +++ b/core/src/test/java/org/elasticsearch/ingest/ConfigurationUtilsTests.java, +import static org.hamcrest.Matchers.is;, +import static org.hamcrest.Matchers.nullValue;, +        Map<String, Object> unknownTaggedConfig = new HashMap<>();, +        unknownTaggedConfig.put("tag", "my_unknown");, +        config.add(Collections.singletonMap("unknown_processor", unknownTaggedConfig));, +            assertThat(e.getHeader("processor_tag"), equalTo(Collections.singletonList("my_unknown")));, +            assertThat(e.getHeader("processor_type"), equalTo(Collections.singletonList("unknown_processor")));, +            assertThat(e.getHeader("property_name"), is(nullValue()));]
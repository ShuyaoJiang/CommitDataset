[+++ b/src/main/java/org/elasticsearch/action/support/TransportAction.java, +import org.elasticsearch.common.logging.ESLogger;, +import org.elasticsearch.common.util.concurrent.EsRejectedExecutionException;, +            listener = new ThreadedActionListener<Response>(threadPool, listener, logger);, +    static final class ThreadedActionListener<Response> implements ActionListener<Response> {, +        private final ESLogger logger;, +, +        ThreadedActionListener(ThreadPool threadPool, ActionListener<Response> listener, ESLogger logger) {, +            this.logger = logger;, +            try {, +            } catch (EsRejectedExecutionException ex) {, +                logger.debug("Can not run threaded action, exectuion rejected [{}] running on current thread", listener);, +                /* we don't care if that takes long since we are shutting down. But if we not respond somebody could wait, +                 * for the response on the listener side which could be a remote machine so make sure we push it out there.*/, +                try {, +                    listener.onResponse(response);, +                } catch (Throwable e) {, +                    listener.onFailure(e);, +                }, +            }, +            try {, +            } catch (EsRejectedExecutionException ex) {, +                logger.debug("Can not run threaded action, exectuion rejected for listener [{}] running on current thread", listener);, +                /* we don't care if that takes long since we are shutting down. But if we not respond somebody could wait, +                 * for the response on the listener side which could be a remote machine so make sure we push it out there.*/, +                listener.onFailure(e);, +            }]
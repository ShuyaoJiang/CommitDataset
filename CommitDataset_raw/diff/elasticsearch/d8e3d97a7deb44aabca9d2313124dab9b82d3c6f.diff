[+++ b/docs/reference/cluster/stats.asciidoc, +      "network_types": {, +      },, +      "discovery_types": {, +        ..., +      }, +// TESTRESPONSE[s/"network_types": \{[^\}]*\}/"network_types": $body.$_path/], +// TESTRESPONSE[s/"discovery_types": \{[^\}]*\}/"discovery_types": $body.$_path/], +// 2. Similarly, ignore the contents of `network_types` and `discovery_types`., +++ b/docs/reference/cluster/stats.asciidoc, +      "network_types": {, +      },, +      "discovery_types": {, +        ..., +      }, +// TESTRESPONSE[s/"network_types": \{[^\}]*\}/"network_types": $body.$_path/], +// TESTRESPONSE[s/"discovery_types": \{[^\}]*\}/"discovery_types": $body.$_path/], +// 2. Similarly, ignore the contents of `network_types` and `discovery_types`., +++ b/rest-api-spec/src/main/resources/rest-api-spec/test/cluster.stats/10_basic.yml, +, +---, +"get cluster stats returns discovery types":, +  - skip:, +      version: " - 6.99.99", +      reason:  "discovery types are added for v7.0.0", +, +  - do:, +      cluster.stats: {}, +, +  - is_true: nodes.discovery_types, +++ b/docs/reference/cluster/stats.asciidoc, +      "network_types": {, +      },, +      "discovery_types": {, +        ..., +      }, +// TESTRESPONSE[s/"network_types": \{[^\}]*\}/"network_types": $body.$_path/], +// TESTRESPONSE[s/"discovery_types": \{[^\}]*\}/"discovery_types": $body.$_path/], +// 2. Similarly, ignore the contents of `network_types` and `discovery_types`., +++ b/rest-api-spec/src/main/resources/rest-api-spec/test/cluster.stats/10_basic.yml, +, +---, +"get cluster stats returns discovery types":, +  - skip:, +      version: " - 6.99.99", +      reason:  "discovery types are added for v7.0.0", +, +  - do:, +      cluster.stats: {}, +, +  - is_true: nodes.discovery_types, +++ b/server/src/main/java/org/elasticsearch/action/admin/cluster/stats/ClusterStatsNodes.java, +import org.elasticsearch.discovery.DiscoveryModule;, +    private final DiscoveryTypes discoveryTypes;, +        this.discoveryTypes = new DiscoveryTypes(nodeInfos);, +, +        discoveryTypes.toXContent(builder, params);, +    static class DiscoveryTypes implements ToXContentFragment {, +, +        private final Map<String, AtomicInteger> discoveryTypes;, +, +        DiscoveryTypes(final List<NodeInfo> nodeInfos) {, +            final Map<String, AtomicInteger> discoveryTypes = new HashMap<>();, +            for (final NodeInfo nodeInfo : nodeInfos) {, +                final Settings settings = nodeInfo.getSettings();, +                final String discoveryType = DiscoveryModule.DISCOVERY_TYPE_SETTING.get(settings);, +                discoveryTypes.computeIfAbsent(discoveryType, k -> new AtomicInteger()).incrementAndGet();, +            }, +            this.discoveryTypes = Collections.unmodifiableMap(discoveryTypes);, +        }, +, +        @Override, +        public XContentBuilder toXContent(XContentBuilder builder, Params params) throws IOException {, +            builder.startObject("discovery_types");, +            for (final Map.Entry<String, AtomicInteger> entry : discoveryTypes.entrySet()) {, +                builder.field(entry.getKey(), entry.getValue().get());, +            }, +            builder.endObject();, +            return builder;, +        }, +    }, +, +++ b/docs/reference/cluster/stats.asciidoc, +      "network_types": {, +      },, +      "discovery_types": {, +        ..., +      }, +// TESTRESPONSE[s/"network_types": \{[^\}]*\}/"network_types": $body.$_path/], +// TESTRESPONSE[s/"discovery_types": \{[^\}]*\}/"discovery_types": $body.$_path/], +// 2. Similarly, ignore the contents of `network_types` and `discovery_types`., +++ b/rest-api-spec/src/main/resources/rest-api-spec/test/cluster.stats/10_basic.yml, +, +---, +"get cluster stats returns discovery types":, +  - skip:, +      version: " - 6.99.99", +      reason:  "discovery types are added for v7.0.0", +, +  - do:]
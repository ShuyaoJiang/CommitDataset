[+++ b/plugin/src/main/java/org/elasticsearch/xpack/ml/job/config/AnalysisConfig.java, +         * <li>Field names cannot be empty strings</li>, +         * <li>If multivariate by fields are enabled a detector must have a by field</li>, +            if (multivariateByFields != null && multivariateByFields) {, +                if (aDetectorHasAByField(detectors) == false) {, +                    throw ExceptionsHelper.badRequestException(Messages.JOB_CONFIG_MULTIVARIATE_REQUIRES_BY_FIELD);, +                }, +            }, +, +        private static boolean aDetectorHasAByField(List<Detector> detectors) {, +            for (Detector detector : detectors) {, +                if (Strings.hasLength(detector.getByFieldName())) {, +                    return true;, +                }, +            }, +, +            return false;, +        }, +++ b/plugin/src/main/java/org/elasticsearch/xpack/ml/job/config/AnalysisConfig.java, +         * <li>Field names cannot be empty strings</li>, +         * <li>If multivariate by fields are enabled a detector must have a by field</li>, +            if (multivariateByFields != null && multivariateByFields) {, +                if (aDetectorHasAByField(detectors) == false) {, +                    throw ExceptionsHelper.badRequestException(Messages.JOB_CONFIG_MULTIVARIATE_REQUIRES_BY_FIELD);, +                }, +            }, +, +        private static boolean aDetectorHasAByField(List<Detector> detectors) {, +            for (Detector detector : detectors) {, +                if (Strings.hasLength(detector.getByFieldName())) {, +                    return true;, +                }, +            }, +, +            return false;, +        }, +++ b/plugin/src/main/java/org/elasticsearch/xpack/ml/job/config/Detector.java, +            if (field != null) {, +                if (field.isEmpty()) {, +                    throw ExceptionsHelper.badRequestException(, +                            Messages.getMessage(Messages.JOB_CONFIG_INFLUENCER_FIELD_NAME_CANNOT_BE_EMPTY));, +                }, +                if (containsInvalidChar(field)) {, +        }, +++ b/plugin/src/main/java/org/elasticsearch/xpack/ml/job/config/AnalysisConfig.java, +         * <li>Field names cannot be empty strings</li>, +         * <li>If multivariate by fields are enabled a detector must have a by field</li>, +            if (multivariateByFields != null && multivariateByFields) {, +                if (aDetectorHasAByField(detectors) == false) {, +                    throw ExceptionsHelper.badRequestException(Messages.JOB_CONFIG_MULTIVARIATE_REQUIRES_BY_FIELD);, +                }, +            }, +, +        private static boolean aDetectorHasAByField(List<Detector> detectors) {, +            for (Detector detector : detectors) {, +                if (Strings.hasLength(detector.getByFieldName())) {, +                    return true;, +                }, +            }, +, +            return false;, +        }, +++ b/plugin/src/main/java/org/elasticsearch/xpack/ml/job/config/Detector.java, +            if (field != null) {, +                if (field.isEmpty()) {, +                    throw ExceptionsHelper.badRequestException(, +                            Messages.getMessage(Messages.JOB_CONFIG_INFLUENCER_FIELD_NAME_CANNOT_BE_EMPTY));, +                }, +                if (containsInvalidChar(field)) {, +        }, +++ b/plugin/src/main/java/org/elasticsearch/xpack/ml/job/messages/Messages.java, +    public static final String JOB_CONFIG_INFLUENCER_FIELD_NAME_CANNOT_BE_EMPTY = "Influencers and field names cannot be empty strings";, +    public static final String JOB_CONFIG_MULTIVARIATE_REQUIRES_BY_FIELD =, +            "The multivariate_by_fields setting requires a detector with a by field";, +++ b/plugin/src/main/java/org/elasticsearch/xpack/ml/job/config/AnalysisConfig.java, +         * <li>Field names cannot be empty strings</li>, +         * <li>If multivariate by fields are enabled a detector must have a by field</li>, +            if (multivariateByFields != null && multivariateByFields) {, +                if (aDetectorHasAByField(detectors) == false) {, +                    throw ExceptionsHelper.badRequestException(Messages.JOB_CONFIG_MULTIVARIATE_REQUIRES_BY_FIELD);, +                }, +            }, +, +        private static boolean aDetectorHasAByField(List<Detector> detectors) {, +            for (Detector detector : detectors) {, +                if (Strings.hasLength(detector.getByFieldName())) {, +                    return true;, +                }, +            }, +, +            return false;, +        }, +++ b/plugin/src/main/java/org/elasticsearch/xpack/ml/job/config/Detector.java, +            if (field != null) {, +                if (field.isEmpty()) {, +                    throw ExceptionsHelper.badRequestException(, +                            Messages.getMessage(Messages.JOB_CONFIG_INFLUENCER_FIELD_NAME_CANNOT_BE_EMPTY));, +                }, +                if (containsInvalidChar(field)) {, +        }]
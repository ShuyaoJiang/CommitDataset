[+++ b/core/src/main/java/org/elasticsearch/search/aggregations/bucket/significant/GlobalOrdinalsSignificantTermsAggregator.java, +    public GlobalOrdinalsSignificantTermsAggregator(String name,, +                                                    AggregatorFactories factories,, +                                                    ValuesSource.Bytes.WithOrdinals.FieldData valuesSource,, +                                                    DocValueFormat format,, +                                                    BucketCountThresholds bucketCountThresholds,, +                                                    IncludeExclude.OrdinalsFilter includeExclude,, +                                                    SearchContext context,, +                                                    Aggregator parent,, +                                                    boolean forceRemapGlobalOrds,, +                                                    SignificanceHeuristic significanceHeuristic,, +                                                    SignificantTermsAggregatorFactory termsAggFactory,, +                                                    List<PipelineAggregator> pipelineAggregators,, +                                                    Map<String, Object> metaData) throws IOException {, +            forceRemapGlobalOrds, SubAggCollectionMode.DEPTH_FIRST, false, pipelineAggregators, metaData);, +        this.numCollectedDocs = 0;, +    public LeafBucketCollector getLeafCollector(LeafReaderContext ctx, final LeafBucketCollector sub) throws IOException {, +        if (valueCount == 0) { // no context in this reader, +            size = (int) Math.min(valueCount, bucketCountThresholds.getShardSize());, +        for (long globalTermOrd = 0; globalTermOrd < valueCount; ++globalTermOrd) {, +            copy(lookupGlobalOrd.apply(globalTermOrd), spare.termBytes);, +                pipelineAggregators(), metaData(), format, numCollectedDocs, supersetSize, significanceHeuristic, emptyList());, +        super.doClose();, +++ b/core/src/main/java/org/elasticsearch/search/aggregations/bucket/significant/GlobalOrdinalsSignificantTermsAggregator.java, +    public GlobalOrdinalsSignificantTermsAggregator(String name,, +                                                    AggregatorFactories factories,, +                                                    ValuesSource.Bytes.WithOrdinals.FieldData valuesSource,, +                                                    DocValueFormat format,, +                                                    BucketCountThresholds bucketCountThresholds,, +                                                    IncludeExclude.OrdinalsFilter includeExclude,, +                                                    SearchContext context,, +                                                    Aggregator parent,, +                                                    boolean forceRemapGlobalOrds,, +                                                    SignificanceHeuristic significanceHeuristic,, +                                                    SignificantTermsAggregatorFactory termsAggFactory,, +                                                    List<PipelineAggregator> pipelineAggregators,, +                                                    Map<String, Object> metaData) throws IOException {, +            forceRemapGlobalOrds, SubAggCollectionMode.DEPTH_FIRST, false, pipelineAggregators, metaData);, +        this.numCollectedDocs = 0;, +    public LeafBucketCollector getLeafCollector(LeafReaderContext ctx, final LeafBucketCollector sub) throws IOException {, +        if (valueCount == 0) { // no context in this reader, +            size = (int) Math.min(valueCount, bucketCountThresholds.getShardSize());, +        for (long globalTermOrd = 0; globalTermOrd < valueCount; ++globalTermOrd) {, +            copy(lookupGlobalOrd.apply(globalTermOrd), spare.termBytes);, +                pipelineAggregators(), metaData(), format, numCollectedDocs, supersetSize, significanceHeuristic, emptyList());, +        super.doClose();, +++ b/core/src/main/java/org/elasticsearch/search/aggregations/bucket/significant/SignificantTermsAggregatorFactory.java, +    public SignificantTermsAggregatorFactory(String name,, +                                             ValuesSourceConfig<ValuesSource> config,, +                                             IncludeExclude includeExclude,, +                                             String executionHint,, +                                             QueryBuilder filterBuilder,, +                                             TermsAggregator.BucketCountThresholds bucketCountThresholds,, +                                             SignificanceHeuristic significanceHeuristic,, +                                             SearchContext context,, +                                             AggregatorFactory<?> parent,, +                                             AggregatorFactories.Builder subFactoriesBuilder,, +                                             Map<String, Object> metaData) throws IOException {, +            Aggregator create(String name,, +                              AggregatorFactories factories,, +                              ValuesSource valuesSource,, +                              DocValueFormat format,, +                              TermsAggregator.BucketCountThresholds bucketCountThresholds,, +                              IncludeExclude includeExclude,, +                              SearchContext aggregationContext,, +                              Aggregator parent,, +                              SignificanceHeuristic significanceHeuristic,, +                              SignificantTermsAggregatorFactory termsAggregatorFactory,, +                              List<PipelineAggregator> pipelineAggregators,, +, +, +            Aggregator create(String name,, +                              AggregatorFactories factories,, +                              ValuesSource valuesSource,, +                              DocValueFormat format,, +                              TermsAggregator.BucketCountThresholds bucketCountThresholds,, +                              IncludeExclude includeExclude,, +                              SearchContext aggregationContext,, +                              Aggregator parent,, +                              SignificanceHeuristic significanceHeuristic,, +                              SignificantTermsAggregatorFactory termsAggregatorFactory,, +                              List<PipelineAggregator> pipelineAggregators,, +, +                        aggregationContext, parent, false, significanceHeuristic, termsAggregatorFactory, pipelineAggregators, metaData);, +, +            Aggregator create(String name,, +                              AggregatorFactories factories,, +                              ValuesSource valuesSource,, +                              DocValueFormat format,, +                              TermsAggregator.BucketCountThresholds bucketCountThresholds,, +                              IncludeExclude includeExclude,, +                              SearchContext aggregationContext,, +                              Aggregator parent,, +                              SignificanceHeuristic significanceHeuristic,, +                              SignificantTermsAggregatorFactory termsAggregatorFactory,, +                              List<PipelineAggregator> pipelineAggregators,, +, +                return new GlobalOrdinalsSignificantTermsAggregator(name, factories,, +                    (ValuesSource.Bytes.WithOrdinals.FieldData) valuesSource, format, bucketCountThresholds, filter, aggregationContext, parent,, +                    true, significanceHeuristic, termsAggregatorFactory, pipelineAggregators, metaData);]
[+++ b/elasticsearch/x-pack/security/src/main/java/org/elasticsearch/xpack/security/Security.java, +            }, +            if (indexAuditLoggingEnabled(settings) == false) {, +                        IndexAuditTrail indexAuditTrail = new IndexAuditTrail(settings, client, threadPool, clusterService);, +                        auditTrails.add(indexAuditTrail);, +                        components.add(indexAuditTrail); // SecurityLifecycleService needs this...., +++ b/elasticsearch/x-pack/security/src/main/java/org/elasticsearch/xpack/security/Security.java, +            }, +            if (indexAuditLoggingEnabled(settings) == false) {, +                        IndexAuditTrail indexAuditTrail = new IndexAuditTrail(settings, client, threadPool, clusterService);, +                        auditTrails.add(indexAuditTrail);, +                        components.add(indexAuditTrail); // SecurityLifecycleService needs this...., +++ b/elasticsearch/x-pack/security/src/main/java/org/elasticsearch/xpack/security/SecurityLifecycleService.java, +import org.elasticsearch.common.inject.internal.Nullable;, +                                    @Nullable IndexAuditTrail indexAuditTrail, NativeUsersStore nativeUserStore,, +        if (indexAuditTrail != null) {, +    }, +        if (indexAuditTrail != null) {, +}, +++ b/elasticsearch/x-pack/security/src/main/java/org/elasticsearch/xpack/security/Security.java, +            }, +            if (indexAuditLoggingEnabled(settings) == false) {, +                        IndexAuditTrail indexAuditTrail = new IndexAuditTrail(settings, client, threadPool, clusterService);, +                        auditTrails.add(indexAuditTrail);, +                        components.add(indexAuditTrail); // SecurityLifecycleService needs this...., +++ b/elasticsearch/x-pack/security/src/main/java/org/elasticsearch/xpack/security/SecurityLifecycleService.java, +import org.elasticsearch.common.inject.internal.Nullable;, +                                    @Nullable IndexAuditTrail indexAuditTrail, NativeUsersStore nativeUserStore,, +        if (indexAuditTrail != null) {, +    }, +        if (indexAuditTrail != null) {, +}, +++ b/elasticsearch/x-pack/security/src/test/java/org/elasticsearch/xpack/security/audit/index/RemoteIndexAuditTrailStartingTests.java, +            /*Iterable<IndexAuditTrail> auditTrails = internalCluster().getInstances(IndexAuditTrail.class);, +            }*/, +        /*if (outputs.contains("index")) {, +        }*/]
[+++ b/elasticsearch/x-pack/marvel/src/test/java/org/elasticsearch/marvel/agent/collector/indices/IndexStatsCollectorTests.java, +        assertThat(indexStats.getTotal().getIndexing().getTotal().getThrottleTimeInMillis(), equalTo(0L));, +                    assertThat(indexStats.getTotal().getIndexing().getTotal().getThrottleTimeInMillis(), equalTo(0L));, +++ b/elasticsearch/x-pack/marvel/src/test/java/org/elasticsearch/marvel/agent/collector/indices/IndexStatsCollectorTests.java, +        assertThat(indexStats.getTotal().getIndexing().getTotal().getThrottleTimeInMillis(), equalTo(0L));, +                    assertThat(indexStats.getTotal().getIndexing().getTotal().getThrottleTimeInMillis(), equalTo(0L));, +++ b/elasticsearch/x-pack/shield/src/main/java/org/elasticsearch/shield/action/ShieldActionFilter.java, +    public void apply(String action, ActionRequest request, ActionListener listener, ActionFilterChain chain) {, +                chain.proceed(action, request, new SigningListener(this, listener));, +                chain.proceed(action, request, listener);, +++ b/elasticsearch/x-pack/marvel/src/test/java/org/elasticsearch/marvel/agent/collector/indices/IndexStatsCollectorTests.java, +        assertThat(indexStats.getTotal().getIndexing().getTotal().getThrottleTimeInMillis(), equalTo(0L));, +                    assertThat(indexStats.getTotal().getIndexing().getTotal().getThrottleTimeInMillis(), equalTo(0L));, +++ b/elasticsearch/x-pack/shield/src/main/java/org/elasticsearch/shield/action/ShieldActionFilter.java, +    public void apply(String action, ActionRequest request, ActionListener listener, ActionFilterChain chain) {, +                chain.proceed(action, request, new SigningListener(this, listener));, +                chain.proceed(action, request, listener);, +++ b/elasticsearch/x-pack/shield/src/main/java/org/elasticsearch/shield/transport/ServerTransportFilter.java, +            if (extractClientCert && (transportChannel instanceof NettyTransportChannel)) {, +                Channel channel = ((NettyTransportChannel)transportChannel).getChannel();, +++ b/elasticsearch/x-pack/marvel/src/test/java/org/elasticsearch/marvel/agent/collector/indices/IndexStatsCollectorTests.java, +        assertThat(indexStats.getTotal().getIndexing().getTotal().getThrottleTimeInMillis(), equalTo(0L));, +                    assertThat(indexStats.getTotal().getIndexing().getTotal().getThrottleTimeInMillis(), equalTo(0L));, +++ b/elasticsearch/x-pack/shield/src/main/java/org/elasticsearch/shield/action/ShieldActionFilter.java, +    public void apply(String action, ActionRequest request, ActionListener listener, ActionFilterChain chain) {, +                chain.proceed(action, request, new SigningListener(this, listener));, +                chain.proceed(action, request, listener);, +++ b/elasticsearch/x-pack/shield/src/main/java/org/elasticsearch/shield/transport/ServerTransportFilter.java, +            if (extractClientCert && (transportChannel instanceof NettyTransportChannel)) {, +                Channel channel = ((NettyTransportChannel)transportChannel).getChannel();, +++ b/elasticsearch/x-pack/shield/src/main/java/org/elasticsearch/shield/transport/ShieldServerTransportService.java, +        public void messageReceived(T request, TransportChannel channel) throws Exception {, +                handler.messageReceived(request, channel);, +++ b/elasticsearch/x-pack/marvel/src/test/java/org/elasticsearch/marvel/agent/collector/indices/IndexStatsCollectorTests.java, +        assertThat(indexStats.getTotal().getIndexing().getTotal().getThrottleTimeInMillis(), equalTo(0L));, +                    assertThat(indexStats.getTotal().getIndexing().getTotal().getThrottleTimeInMillis(), equalTo(0L));, +++ b/elasticsearch/x-pack/shield/src/main/java/org/elasticsearch/shield/action/ShieldActionFilter.java, +    public void apply(String action, ActionRequest request, ActionListener listener, ActionFilterChain chain) {, +                chain.proceed(action, request, new SigningListener(this, listener));, +                chain.proceed(action, request, listener);, +++ b/elasticsearch/x-pack/shield/src/main/java/org/elasticsearch/shield/transport/ServerTransportFilter.java, +            if (extractClientCert && (transportChannel instanceof NettyTransportChannel)) {, +                Channel channel = ((NettyTransportChannel)transportChannel).getChannel();, +++ b/elasticsearch/x-pack/shield/src/main/java/org/elasticsearch/shield/transport/ShieldServerTransportService.java, +        public void messageReceived(T request, TransportChannel channel) throws Exception {, +                handler.messageReceived(request, channel);, +++ b/elasticsearch/x-pack/shield/src/test/java/org/elasticsearch/shield/action/ShieldActionFilterTests.java, +        filter.apply("_action", request, listener, chain);, +        verify(chain).proceed(eq("_action"), eq(request), isA(ShieldActionFilter.SigningListener.class));, +        filter.apply("_action", request, listener, chain);, +        filter.apply("_action", request, listener, chain);, +        verify(chain).proceed(eq("_action"), eq(request), isA(ShieldActionFilter.SigningListener.class));, +        filter.apply("_action", request, listener, chain);, +        filter.apply("_action", request, listener, chain);, +        verify(chain).proceed(eq("_action"), eq(request), eq(listener));, +++ b/elasticsearch/x-pack/marvel/src/test/java/org/elasticsearch/marvel/agent/collector/indices/IndexStatsCollectorTests.java, +        assertThat(indexStats.getTotal().getIndexing().getTotal().getThrottleTimeInMillis(), equalTo(0L));, +                    assertThat(indexStats.getTotal().getIndexing().getTotal().getThrottleTimeInMillis(), equalTo(0L));, +++ b/elasticsearch/x-pack/shield/src/main/java/org/elasticsearch/shield/action/ShieldActionFilter.java, +    public void apply(String action, ActionRequest request, ActionListener listener, ActionFilterChain chain) {, +                chain.proceed(action, request, new SigningListener(this, listener));, +                chain.proceed(action, request, listener);, +++ b/elasticsearch/x-pack/shield/src/main/java/org/elasticsearch/shield/transport/ServerTransportFilter.java, +            if (extractClientCert && (transportChannel instanceof NettyTransportChannel)) {, +                Channel channel = ((NettyTransportChannel)transportChannel).getChannel();, +++ b/elasticsearch/x-pack/shield/src/main/java/org/elasticsearch/shield/transport/ShieldServerTransportService.java, +        public void messageReceived(T request, TransportChannel channel) throws Exception {, +                handler.messageReceived(request, channel);, +++ b/elasticsearch/x-pack/shield/src/test/java/org/elasticsearch/shield/action/ShieldActionFilterTests.java, +        filter.apply("_action", request, listener, chain);, +        verify(chain).proceed(eq("_action"), eq(request), isA(ShieldActionFilter.SigningListener.class));, +        filter.apply("_action", request, listener, chain);, +        filter.apply("_action", request, listener, chain);, +        verify(chain).proceed(eq("_action"), eq(request), isA(ShieldActionFilter.SigningListener.class));, +        filter.apply("_action", request, listener, chain);, +        filter.apply("_action", request, listener, chain);, +        verify(chain).proceed(eq("_action"), eq(request), eq(listener));, +++ b/elasticsearch/x-pack/shield/src/test/java/org/elasticsearch/shield/audit/AuditTrailModuleTests.java, +                    new NetworkModule(new NetworkService(settings), settings, false, null) {, +++ b/elasticsearch/x-pack/marvel/src/test/java/org/elasticsearch/marvel/agent/collector/indices/IndexStatsCollectorTests.java, +        assertThat(indexStats.getTotal().getIndexing().getTotal().getThrottleTimeInMillis(), equalTo(0L));, +                    assertThat(indexStats.getTotal().getIndexing().getTotal().getThrottleTimeInMillis(), equalTo(0L));, +++ b/elasticsearch/x-pack/shield/src/main/java/org/elasticsearch/shield/action/ShieldActionFilter.java, +    public void apply(String action, ActionRequest request, ActionListener listener, ActionFilterChain chain) {, +                chain.proceed(action, request, new SigningListener(this, listener));, +                chain.proceed(action, request, listener);, +++ b/elasticsearch/x-pack/shield/src/main/java/org/elasticsearch/shield/transport/ServerTransportFilter.java, +            if (extractClientCert && (transportChannel instanceof NettyTransportChannel)) {, +                Channel channel = ((NettyTransportChannel)transportChannel).getChannel();, +++ b/elasticsearch/x-pack/shield/src/main/java/org/elasticsearch/shield/transport/ShieldServerTransportService.java, +        public void messageReceived(T request, TransportChannel channel) throws Exception {, +                handler.messageReceived(request, channel);, +++ b/elasticsearch/x-pack/shield/src/test/java/org/elasticsearch/shield/action/ShieldActionFilterTests.java, +        filter.apply("_action", request, listener, chain);, +        verify(chain).proceed(eq("_action"), eq(request), isA(ShieldActionFilter.SigningListener.class));, +        filter.apply("_action", request, listener, chain);, +        filter.apply("_action", request, listener, chain);, +        verify(chain).proceed(eq("_action"), eq(request), isA(ShieldActionFilter.SigningListener.class));, +        filter.apply("_action", request, listener, chain);, +        filter.apply("_action", request, listener, chain);]
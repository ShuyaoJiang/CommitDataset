[+++ b/core/src/test/java/org/elasticsearch/common/settings/loader/PropertiesSettingsLoaderTests.java, +import org.junit.Before;, +, +    private PropertiesSettingsLoader loader;, +, +    @Before, +    public void setUp() throws Exception {, +        super.setUp();, +        loader = new PropertiesSettingsLoader();, +, +    public void testDuplicateKeyFromStringThrowsException() throws IOException {, +        final ElasticsearchParseException e = expectThrows(ElasticsearchParseException.class, () -> loader.load("foo=bar\nfoo=baz"));, +        assertEquals(e.getMessage(), "duplicate settings key [foo] found, previous value [bar], current value [baz]");, +        final ElasticsearchParseException e = expectThrows(, +                ElasticsearchParseException.class,, +                () -> loader.load("foo=bar\nfoo=baz".getBytes(Charset.defaultCharset())), +        );]
[+++ b/core/src/test/java/org/elasticsearch/cluster/ClusterModuleTests.java, +        {, +            // Eclipse Neon 2 didn't compile the plugins definition inside the lambda expression,, +            // probably due to https://bugs.eclipse.org/bugs/show_bug.cgi?id=511750, which is, +            // fixed in Eclipse Oxygon. Pulled out the plugins definition to make it work in older versions, +            List<ClusterPlugin> plugins = Collections.singletonList(new ClusterPlugin() {, +            });, +            IllegalStateException ise = expectThrows(IllegalStateException.class,, +                    () -> ClusterModule.getClusterStateCustomSuppliers(plugins));, +        }, +        {, +            List<ClusterPlugin> plugins = Arrays.asList(new ClusterPlugin() {, +            });, +            IllegalStateException ise = expectThrows(IllegalStateException.class,, +                    () -> ClusterModule.getClusterStateCustomSuppliers(plugins));, +}]
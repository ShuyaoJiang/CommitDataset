[+++ b/x-pack/plugin/sql/jdbc/src/main/java/org/elasticsearch/xpack/sql/jdbc/JdbcDatabaseMetaData.java, +        return true;, +        Object[][] data = queryColumn(con, "SYS TABLES CATALOG LIKE '%' LIKE ''", 1);, +        Object[][] data = queryColumn(con, "SYS TABLES CATALOG LIKE '' LIKE '' TYPE '%'", 4);, +++ b/x-pack/plugin/sql/jdbc/src/main/java/org/elasticsearch/xpack/sql/jdbc/JdbcDatabaseMetaData.java, +        return true;, +        Object[][] data = queryColumn(con, "SYS TABLES CATALOG LIKE '%' LIKE ''", 1);, +        Object[][] data = queryColumn(con, "SYS TABLES CATALOG LIKE '' LIKE '' TYPE '%'", 4);, +++ b/x-pack/plugin/sql/src/main/java/org/elasticsearch/xpack/sql/parser/CommandBuilder.java, +                    // treat % as null, +                    // https://docs.microsoft.com/en-us/sql/odbc/reference/develop-app/value-list-arguments, +++ b/x-pack/plugin/sql/jdbc/src/main/java/org/elasticsearch/xpack/sql/jdbc/JdbcDatabaseMetaData.java, +        return true;, +        Object[][] data = queryColumn(con, "SYS TABLES CATALOG LIKE '%' LIKE ''", 1);, +        Object[][] data = queryColumn(con, "SYS TABLES CATALOG LIKE '' LIKE '' TYPE '%'", 4);, +++ b/x-pack/plugin/sql/src/main/java/org/elasticsearch/xpack/sql/parser/CommandBuilder.java, +                    // treat % as null, +                    // https://docs.microsoft.com/en-us/sql/odbc/reference/develop-app/value-list-arguments, +++ b/x-pack/plugin/sql/src/main/java/org/elasticsearch/xpack/sql/plan/logical/command/sys/SysTables.java, +import org.elasticsearch.xpack.sql.tree.Source;, +        // catalog enumeration, +        if (clusterPattern == null || clusterPattern.pattern().equals(SQL_WILDCARD)) {, +            // enumerate only if pattern is "" and no types are specified (types is null), +            if (pattern != null && pattern.pattern().isEmpty() && index == null, +                    && types == null) {, +        // enumerate types, +        // if no types are specified (the parser takes care of the % case), +        if (types == null) {, +            // empty string for catalog, +            if (clusterPattern != null && clusterPattern.pattern().isEmpty(), +                    // empty string for table like and no index specified, +                    && pattern != null && pattern.pattern().isEmpty() && index == null) {, +                // send only the types, everything else is made of empty strings, +        // no enumeration pattern found, list actual tables, +++ b/x-pack/plugin/sql/jdbc/src/main/java/org/elasticsearch/xpack/sql/jdbc/JdbcDatabaseMetaData.java, +        return true;, +        Object[][] data = queryColumn(con, "SYS TABLES CATALOG LIKE '%' LIKE ''", 1);, +        Object[][] data = queryColumn(con, "SYS TABLES CATALOG LIKE '' LIKE '' TYPE '%'", 4);, +++ b/x-pack/plugin/sql/src/main/java/org/elasticsearch/xpack/sql/parser/CommandBuilder.java, +                    // treat % as null, +                    // https://docs.microsoft.com/en-us/sql/odbc/reference/develop-app/value-list-arguments, +++ b/x-pack/plugin/sql/src/main/java/org/elasticsearch/xpack/sql/plan/logical/command/sys/SysTables.java, +import org.elasticsearch.xpack.sql.tree.Source;, +        // catalog enumeration, +        if (clusterPattern == null || clusterPattern.pattern().equals(SQL_WILDCARD)) {, +            // enumerate only if pattern is "" and no types are specified (types is null), +            if (pattern != null && pattern.pattern().isEmpty() && index == null, +                    && types == null) {, +        // enumerate types, +        // if no types are specified (the parser takes care of the % case), +        if (types == null) {, +            // empty string for catalog, +            if (clusterPattern != null && clusterPattern.pattern().isEmpty(), +                    // empty string for table like and no index specified, +                    && pattern != null && pattern.pattern().isEmpty() && index == null) {, +                // send only the types, everything else is made of empty strings, +        // no enumeration pattern found, list actual tables, +++ b/x-pack/plugin/sql/src/test/java/org/elasticsearch/xpack/sql/plan/logical/command/sys/SysTablesTests.java, +    //, +    // catalog enumeration, +    //, +    public void testSysTablesCatalogEnumeration() throws Exception {, +        executeCommand("SYS TABLES CATALOG LIKE '%' LIKE ''", r -> {, +            // everything else should be null, +            for (int i = 1; i < 10; i++) {, +                assertNull(r.column(i));, +            }, +        }, index);, +    //, +    // table types enumeration, +    //, +    public void testSysTablesTypesEnumerationWoString() throws Exception {, +        executeCommand("SYS TABLES CATALOG LIKE '' LIKE '' ", r -> {, +        }, new IndexInfo[0]);, +    }, +, +    public void testSysTablesEnumerateTypes() throws Exception {, +        executeCommand("SYS TABLES CATALOG LIKE '' LIKE '' TYPE '%'", r -> {, +            assertEquals(2, r.size());, +            assertEquals("BASE TABLE", r.column(3));, +            assertTrue(r.advanceRow());, +            assertEquals("VIEW", r.column(3));, +        }, alias, index);, +    }, +, +    public void testSysTablesTypesEnumeration() throws Exception {, +        executeCommand("SYS TABLES CATALOG LIKE '' LIKE '' TYPE '%'", r -> {, +            assertEquals(2, r.size());, +, +            Iterator<IndexType> it = IndexType.VALID.stream().sorted(Comparator.comparing(IndexType::toSql)).iterator();, +, +            for (int t = 0; t < r.size(); t++) {, +                assertEquals(it.next().toSql(), r.column(3));, +, +                // everything else should be null, +                for (int i = 0; i < 10; i++) {, +                    if (i != 3) {, +                        assertNull(r.column(i));, +                    }, +                }]
[+++ b/libs/build.gradle, +++ b/libs/build.gradle, +++ b/qa/build.gradle, +++ b/libs/build.gradle, +++ b/qa/build.gradle, +++ b/settings.gradle, +  'test:logger-usage', +/**, +  * Iterates over sub directories, looking for build.gradle, and adds a project if found, +  * for that dir with the given path prefix. Note that this requires each level, +  * of the dir hierarchy to have a build.gradle. Otherwise we would have to iterate, +  * all files/directories in the source tree to find all projects., +  */, +void addSubProjects(String path, File dir, List<String> projects, List<String> branches) {, +  if (dir.isDirectory() == false) return;, +  if (dir.name == 'buildSrc') return;, +  if (new File(dir, 'build.gradle').exists() == false) return;, +  if (findProject(dir) != null) return;, +, +  final String projectName = "${path}:${dir.name}", +  include projectName, +, +  if (dir.name == 'bwc-snapshot-dummy-projects') {, +    for (final String branch : branches) {, +      final String snapshotProjectName = "${projectName}:bwc-snapshot-${branch}", +      projects.add(snapshotProjectName), +      include snapshotProjectName, +      project("${snapshotProjectName}").projectDir = dir, +    // TODO do we want to assert that there's nothing else in the bwc directory?, +  } else {, +    if (path.isEmpty() || path.startsWith(':example-plugins')) {, +      project(projectName).projectDir = dir, +    }, +    for (File subdir : dir.listFiles()) {, +      addSubProjects(projectName, subdir, projects, branches), +    }, +  }, +}, +, +// include example plugins first, so adding plugin dirs below won't muck with :example-plugins, +File examplePluginsDir = new File(rootProject.projectDir, 'plugins/examples'), +for (File example : examplePluginsDir.listFiles()) {, +  if (example.isDirectory() == false) continue;, +  if (example.name.startsWith('build') || example.name.startsWith('.')) continue;, +  addSubProjects(':example-plugins', example, projects, []), +}, +project(':example-plugins').projectDir = new File(rootProject.projectDir, 'plugins/examples'), +, +addSubProjects('', new File(rootProject.projectDir, 'libs'), projects, []), +addSubProjects('', new File(rootProject.projectDir, 'modules'), projects, []), +addSubProjects('', new File(rootProject.projectDir, 'plugins'), projects, []), +addSubProjects('', new File(rootProject.projectDir, 'qa'), projects, [])]
[+++ b/core/src/main/java/org/elasticsearch/node/Node.java, +        // tribe nodes don't have a master so we shouldn't register an observer         s, +        final TimeValue initialStateTimeout = DiscoverySettings.INITIAL_STATE_TIMEOUT_SETTING.get(settings);, +        if (initialStateTimeout.millis() > 0) {, +                logger.debug("waiting to join the cluster. timeout [{}]", initialStateTimeout);, +                            initialStateTimeout);, +                }, MasterNodeChangePredicate.INSTANCE, initialStateTimeout);, +++ b/core/src/main/java/org/elasticsearch/node/Node.java, +        // tribe nodes don't have a master so we shouldn't register an observer         s, +        final TimeValue initialStateTimeout = DiscoverySettings.INITIAL_STATE_TIMEOUT_SETTING.get(settings);, +        if (initialStateTimeout.millis() > 0) {, +                logger.debug("waiting to join the cluster. timeout [{}]", initialStateTimeout);, +                            initialStateTimeout);, +                }, MasterNodeChangePredicate.INSTANCE, initialStateTimeout);, +++ b/test/framework/src/main/java/org/elasticsearch/test/InternalTestCluster.java, +                "[{}] (data) nodes and [{}] coord only nodes (min_master_nodes are [{}])",, +            numSharedDedicatedMasterNodes, numSharedDataNodes, numSharedCoordOnlyNodes,, +            autoManageMinMasterNodes ? "auto-managed" : "manual");, +++ b/core/src/main/java/org/elasticsearch/node/Node.java, +        // tribe nodes don't have a master so we shouldn't register an observer         s, +        final TimeValue initialStateTimeout = DiscoverySettings.INITIAL_STATE_TIMEOUT_SETTING.get(settings);, +        if (initialStateTimeout.millis() > 0) {, +                logger.debug("waiting to join the cluster. timeout [{}]", initialStateTimeout);, +                            initialStateTimeout);, +                }, MasterNodeChangePredicate.INSTANCE, initialStateTimeout);, +++ b/test/framework/src/main/java/org/elasticsearch/test/InternalTestCluster.java, +                "[{}] (data) nodes and [{}] coord only nodes (min_master_nodes are [{}])",, +            numSharedDedicatedMasterNodes, numSharedDataNodes, numSharedCoordOnlyNodes,, +            autoManageMinMasterNodes ? "auto-managed" : "manual");, +++ b/test/framework/src/test/java/org/elasticsearch/test/test/InternalTestClusterTests.java, +import org.elasticsearch.test.junit.annotations.TestLogging;, +    @TestLogging("_root:DEBUG")]
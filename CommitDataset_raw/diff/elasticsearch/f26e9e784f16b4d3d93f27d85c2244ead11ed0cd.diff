[+++ b/src/main/java/org/elasticsearch/index/engine/internal/InternalEngine.java, +        boolean success = false;, +            /* Acquire order here is store -> manager since we need, +            * to make sure that the store is not closed before, +            * the searcher is acquired. */, +            store.incRef();, +            final SearcherManager manager = this.searcherManager;, +            /* This might throw NPE but that's fine we will run ensureOpen(), +            *  in the catch block and throw the right exception */, +            final IndexSearcher searcher = manager.acquire();, +            try {, +                final Searcher retVal = newSearcher(source, searcher, manager);, +                success = true;, +                return retVal;, +            } finally {, +                if (!success) {, +                    manager.release(searcher);, +                }, +            }, +        } finally {, +            if (!success) {  // release the ref in the case of an error..., +                store.decRef();, +            }, +        private final AtomicBoolean released = new AtomicBoolean(false);]
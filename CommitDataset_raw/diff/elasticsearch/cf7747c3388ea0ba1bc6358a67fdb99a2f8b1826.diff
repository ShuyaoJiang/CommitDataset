[+++ b/docs/reference/migration/migrate_6_0/plugins.asciidoc, +, +* Specifying region has been removed. This includes the settings `cloud.aws.region`,, +`cloud.aws.s3.region`, `repositories.s3.region`, and specifying, +region inside the repository settings. Instead, specify the full endpoint if a custom, +s3 location is needed, or rely on the default behavior which automatically locates, +the region of the configured bucket., +++ b/docs/reference/migration/migrate_6_0/plugins.asciidoc, +, +* Specifying region has been removed. This includes the settings `cloud.aws.region`,, +`cloud.aws.s3.region`, `repositories.s3.region`, and specifying, +region inside the repository settings. Instead, specify the full endpoint if a custom, +s3 location is needed, or rely on the default behavior which automatically locates, +the region of the configured bucket., +++ b/plugins/repository-s3/src/main/java/org/elasticsearch/cloud/aws/AwsS3Service.java, +         * cloud.aws.s3.endpoint: Endpoint., +++ b/docs/reference/migration/migrate_6_0/plugins.asciidoc, +, +* Specifying region has been removed. This includes the settings `cloud.aws.region`,, +`cloud.aws.s3.region`, `repositories.s3.region`, and specifying, +region inside the repository settings. Instead, specify the full endpoint if a custom, +s3 location is needed, or rely on the default behavior which automatically locates, +the region of the configured bucket., +++ b/plugins/repository-s3/src/main/java/org/elasticsearch/cloud/aws/AwsS3Service.java, +         * cloud.aws.s3.endpoint: Endpoint., +++ b/plugins/repository-s3/src/main/java/org/elasticsearch/cloud/aws/InternalAwsS3Service.java, +++ b/docs/reference/migration/migrate_6_0/plugins.asciidoc, +, +* Specifying region has been removed. This includes the settings `cloud.aws.region`,, +`cloud.aws.s3.region`, `repositories.s3.region`, and specifying, +region inside the repository settings. Instead, specify the full endpoint if a custom, +s3 location is needed, or rely on the default behavior which automatically locates, +the region of the configured bucket., +++ b/plugins/repository-s3/src/main/java/org/elasticsearch/cloud/aws/AwsS3Service.java, +         * cloud.aws.s3.endpoint: Endpoint., +++ b/plugins/repository-s3/src/main/java/org/elasticsearch/cloud/aws/InternalAwsS3Service.java, +++ b/plugins/repository-s3/src/main/java/org/elasticsearch/plugin/repository/s3/S3RepositoryPlugin.java, +++ b/docs/reference/migration/migrate_6_0/plugins.asciidoc, +, +* Specifying region has been removed. This includes the settings `cloud.aws.region`,, +`cloud.aws.s3.region`, `repositories.s3.region`, and specifying, +region inside the repository settings. Instead, specify the full endpoint if a custom, +s3 location is needed, or rely on the default behavior which automatically locates, +the region of the configured bucket., +++ b/plugins/repository-s3/src/main/java/org/elasticsearch/cloud/aws/AwsS3Service.java, +         * cloud.aws.s3.endpoint: Endpoint., +++ b/plugins/repository-s3/src/main/java/org/elasticsearch/cloud/aws/InternalAwsS3Service.java, +++ b/plugins/repository-s3/src/main/java/org/elasticsearch/plugin/repository/s3/S3RepositoryPlugin.java, +++ b/plugins/repository-s3/src/main/java/org/elasticsearch/repositories/s3/S3Repository.java, +++ b/docs/reference/migration/migrate_6_0/plugins.asciidoc, +, +* Specifying region has been removed. This includes the settings `cloud.aws.region`,, +`cloud.aws.s3.region`, `repositories.s3.region`, and specifying, +region inside the repository settings. Instead, specify the full endpoint if a custom, +s3 location is needed, or rely on the default behavior which automatically locates, +the region of the configured bucket., +++ b/plugins/repository-s3/src/main/java/org/elasticsearch/cloud/aws/AwsS3Service.java, +         * cloud.aws.s3.endpoint: Endpoint., +++ b/plugins/repository-s3/src/main/java/org/elasticsearch/cloud/aws/InternalAwsS3Service.java, +++ b/plugins/repository-s3/src/main/java/org/elasticsearch/plugin/repository/s3/S3RepositoryPlugin.java, +++ b/plugins/repository-s3/src/main/java/org/elasticsearch/repositories/s3/S3Repository.java, +++ b/plugins/repository-s3/src/test/java/org/elasticsearch/cloud/aws/AwsS3ServiceImplTests.java, +        launchAWSCredentialsWithElasticsearchSettingsTest(Settings.EMPTY, settings, "aws_key", "aws_secret");, +        Settings repositorySettings = Settings.builder().put(InternalAwsS3Service.CLIENT_NAME.getKey(), "myconfig").build();, +        launchAWSCredentialsWithElasticsearchSettingsTest(Settings.EMPTY, settings, "aws_key", "aws_secret");, +        launchAWSCredentialsWithElasticsearchSettingsTest(Settings.EMPTY, settings, "s3_key", "s3_secret");, +        launchAWSCredentialsWithElasticsearchSettingsTest(Settings.EMPTY, settings, "s3_key", "s3_secret");, +        launchAWSCredentialsWithElasticsearchSettingsTest(Settings.EMPTY, settings, "repositories_key", "repositories_secret");, +        launchAWSCredentialsWithElasticsearchSettingsTest(Settings.EMPTY, settings, "repositories_key", "repositories_secret");, +        launchAWSCredentialsWithElasticsearchSettingsTest(Settings.EMPTY, settings, "repositories_key", "repositories_secret");, +        Settings repositorySettings = generateRepositorySettings("repository_key", "repository_secret", null, null);, +        Settings repositorySettings = generateRepositorySettings("repository_key", "repository_secret", null, null);, +        Settings repositorySettings = generateRepositorySettings("repository_key", "repository_secret", null, null);, +        launchAWSConfigurationTest(Settings.EMPTY, Settings.EMPTY, Protocol.HTTPS, null, -1, null, null, null, 3, false,, +        launchAWSConfigurationTest(settings, Settings.EMPTY, Protocol.HTTP, "aws_proxy_host", 8080, "aws_proxy_username",, +        launchAWSConfigurationTest(settings, Settings.EMPTY, Protocol.HTTP, "aws_proxy_host", 8080, "aws_proxy_username",, +        launchAWSConfigurationTest(settings, Settings.EMPTY, Protocol.HTTPS, "s3_proxy_host", 8081, "s3_proxy_username",, +        launchAWSConfigurationTest(settings, Settings.EMPTY, Protocol.HTTPS, null, -1, null,, +        Settings repositorySettings = generateRepositorySettings(null, null, null, 20);, +    private static Settings generateRepositorySettings(String key, String secret, String endpoint, Integer maxRetries) {, +        assertEndpoint(generateRepositorySettings("repository_key", "repository_secret", null, null), Settings.EMPTY, "");, +        assertEndpoint(generateRepositorySettings("repository_key", "repository_secret", null, null), settings, "s3.endpoint");, +        assertEndpoint(generateRepositorySettings("repository_key", "repository_secret", "repository.endpoint", null),, +        assertEndpoint(generateRepositorySettings("repository_key", "repository_secret", null, null), settings,, +++ b/docs/reference/migration/migrate_6_0/plugins.asciidoc, +, +* Specifying region has been removed. This includes the settings `cloud.aws.region`,, +`cloud.aws.s3.region`, `repositories.s3.region`, and specifying, +region inside the repository settings. Instead, specify the full endpoint if a custom, +s3 location is needed, or rely on the default behavior which automatically locates, +the region of the configured bucket., +++ b/plugins/repository-s3/src/main/java/org/elasticsearch/cloud/aws/AwsS3Service.java, +         * cloud.aws.s3.endpoint: Endpoint., +++ b/plugins/repository-s3/src/main/java/org/elasticsearch/cloud/aws/InternalAwsS3Service.java, +++ b/plugins/repository-s3/src/main/java/org/elasticsearch/plugin/repository/s3/S3RepositoryPlugin.java, +++ b/plugins/repository-s3/src/main/java/org/elasticsearch/repositories/s3/S3Repository.java, +++ b/plugins/repository-s3/src/test/java/org/elasticsearch/cloud/aws/AwsS3ServiceImplTests.java, +        launchAWSCredentialsWithElasticsearchSettingsTest(Settings.EMPTY, settings, "aws_key", "aws_secret");, +        Settings repositorySettings = Settings.builder().put(InternalAwsS3Service.CLIENT_NAME.getKey(), "myconfig").build();, +        launchAWSCredentialsWithElasticsearchSettingsTest(Settings.EMPTY, settings, "aws_key", "aws_secret");]
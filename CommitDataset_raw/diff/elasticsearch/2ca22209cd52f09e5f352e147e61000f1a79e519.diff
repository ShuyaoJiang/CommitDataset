[+++ b/docs/reference/migration/migrate_7_0/settings.asciidoc, +The default protocols are now TLSv1.3 (if supported), TLSv1.2 and TLSv1.1., +xpack.security.http.ssl.supported_protocols: [ "TLSv1.3", "TLSv1.2", "TLSv1.1", "TLSv1" ], +++ b/docs/reference/migration/migrate_7_0/settings.asciidoc, +The default protocols are now TLSv1.3 (if supported), TLSv1.2 and TLSv1.1., +xpack.security.http.ssl.supported_protocols: [ "TLSv1.3", "TLSv1.2", "TLSv1.1", "TLSv1" ], +++ b/docs/reference/settings/security-settings.asciidoc, +Supported protocols for TLS/SSL (with versions). Defaults to `TLSv1.3,TLSv1.2,TLSv1.1` if, +the JVM supports TLSv1.3, otherwise `TLSv1.2,TLSv1.1`., +Supported protocols for TLS/SSL (with versions). Defaults to `TLSv1.3,TLSv1.2,TLSv1.1` if, +the JVM supports TLSv1.3, otherwise `TLSv1.2,TLSv1.1`., +Specifies the supported protocols for TLS/SSL. Defaults to `TLSv1.3,TLSv1.2,TLSv1.1` if, +the JVM supports TLSv1.3, otherwise `TLSv1.2,TLSv1.1`., +`SSLv3`, `TLSv1`, `TLSv1.1`, `TLSv1.2`, `TLSv1.3`. Defaults to `TLSv1.3,TLSv1.2,TLSv1.1` if, +the JVM supports TLSv1.3, otherwise `TLSv1.2,TLSv1.1`., +++ b/docs/reference/migration/migrate_7_0/settings.asciidoc, +The default protocols are now TLSv1.3 (if supported), TLSv1.2 and TLSv1.1., +xpack.security.http.ssl.supported_protocols: [ "TLSv1.3", "TLSv1.2", "TLSv1.1", "TLSv1" ], +++ b/docs/reference/settings/security-settings.asciidoc, +Supported protocols for TLS/SSL (with versions). Defaults to `TLSv1.3,TLSv1.2,TLSv1.1` if, +the JVM supports TLSv1.3, otherwise `TLSv1.2,TLSv1.1`., +Supported protocols for TLS/SSL (with versions). Defaults to `TLSv1.3,TLSv1.2,TLSv1.1` if, +the JVM supports TLSv1.3, otherwise `TLSv1.2,TLSv1.1`., +Specifies the supported protocols for TLS/SSL. Defaults to `TLSv1.3,TLSv1.2,TLSv1.1` if, +the JVM supports TLSv1.3, otherwise `TLSv1.2,TLSv1.1`., +`SSLv3`, `TLSv1`, `TLSv1.1`, `TLSv1.2`, `TLSv1.3`. Defaults to `TLSv1.3,TLSv1.2,TLSv1.1` if, +the JVM supports TLSv1.3, otherwise `TLSv1.2,TLSv1.1`., +++ b/docs/reference/settings/ssl-settings.asciidoc, +`SSLv3`, `TLSv1`, `TLSv1.1`, `TLSv1.2`, `TLSv1.3`. Defaults to `TLSv1.3,TLSv1.2,TLSv1.1` if, +the JVM supports TLSv1.3, otherwise `TLSv1.2,TLSv1.1`., +++ b/docs/reference/migration/migrate_7_0/settings.asciidoc, +The default protocols are now TLSv1.3 (if supported), TLSv1.2 and TLSv1.1., +xpack.security.http.ssl.supported_protocols: [ "TLSv1.3", "TLSv1.2", "TLSv1.1", "TLSv1" ], +++ b/docs/reference/settings/security-settings.asciidoc, +Supported protocols for TLS/SSL (with versions). Defaults to `TLSv1.3,TLSv1.2,TLSv1.1` if, +the JVM supports TLSv1.3, otherwise `TLSv1.2,TLSv1.1`., +Supported protocols for TLS/SSL (with versions). Defaults to `TLSv1.3,TLSv1.2,TLSv1.1` if, +the JVM supports TLSv1.3, otherwise `TLSv1.2,TLSv1.1`., +Specifies the supported protocols for TLS/SSL. Defaults to `TLSv1.3,TLSv1.2,TLSv1.1` if, +the JVM supports TLSv1.3, otherwise `TLSv1.2,TLSv1.1`., +`SSLv3`, `TLSv1`, `TLSv1.1`, `TLSv1.2`, `TLSv1.3`. Defaults to `TLSv1.3,TLSv1.2,TLSv1.1` if, +the JVM supports TLSv1.3, otherwise `TLSv1.2,TLSv1.1`., +++ b/docs/reference/settings/ssl-settings.asciidoc, +`SSLv3`, `TLSv1`, `TLSv1.1`, `TLSv1.2`, `TLSv1.3`. Defaults to `TLSv1.3,TLSv1.2,TLSv1.1` if, +the JVM supports TLSv1.3, otherwise `TLSv1.2,TLSv1.1`., +++ b/libs/ssl-config/src/main/java/org/elasticsearch/common/ssl/SslConfiguration.java, +import java.security.NoSuchAlgorithmException;, +import java.util.LinkedHashMap;, +import java.util.Map;, +import java.util.Map.Entry;, +    /**, +     * An ordered map of protocol algorithms to SSLContext algorithms. The map is ordered from most, +     * secure to least secure. The names in this map are taken from the, +     * <a href="https://docs.oracle.com/en/java/javase/11/docs/specs/security/standard-names.html#sslcontext-algorithms">, +     * Java Security Standard Algorithm Names Documentation for Java 11</a>., +     */, +    static final Map<String, String> ORDERED_PROTOCOL_ALGORITHM_MAP;, +    static {, +        LinkedHashMap<String, String> protocolAlgorithmMap = new LinkedHashMap<>();, +        try {, +            SSLContext.getInstance("TLSv1.3");, +            protocolAlgorithmMap.put("TLSv1.3", "TLSv1.3");, +        } catch (NoSuchAlgorithmException e) {, +            // ignore since we support JVMs that do not support TLSv1.3, +        }, +        protocolAlgorithmMap.put("TLSv1.2", "TLSv1.2");, +        protocolAlgorithmMap.put("TLSv1.1", "TLSv1.1");, +        protocolAlgorithmMap.put("TLSv1", "TLSv1");, +        protocolAlgorithmMap.put("SSLv3", "SSLv3");, +        protocolAlgorithmMap.put("SSLv2", "SSL");, +        protocolAlgorithmMap.put("SSLv2Hello", "SSL");, +        ORDERED_PROTOCOL_ALGORITHM_MAP = Collections.unmodifiableMap(protocolAlgorithmMap);, +    }, +, +        for (Entry<String, String> entry : ORDERED_PROTOCOL_ALGORITHM_MAP.entrySet()) {, +            if (supportedProtocols.contains(entry.getKey())) {, +                return entry.getValue();, +        throw new SslConfigException("no supported SSL/TLS protocol was found in the configured supported protocols: ", +            + supportedProtocols);, +++ b/docs/reference/migration/migrate_7_0/settings.asciidoc, +The default protocols are now TLSv1.3 (if supported), TLSv1.2 and TLSv1.1., +xpack.security.http.ssl.supported_protocols: [ "TLSv1.3", "TLSv1.2", "TLSv1.1", "TLSv1" ], +++ b/docs/reference/settings/security-settings.asciidoc, +Supported protocols for TLS/SSL (with versions). Defaults to `TLSv1.3,TLSv1.2,TLSv1.1` if, +the JVM supports TLSv1.3, otherwise `TLSv1.2,TLSv1.1`., +Supported protocols for TLS/SSL (with versions). Defaults to `TLSv1.3,TLSv1.2,TLSv1.1` if, +the JVM supports TLSv1.3, otherwise `TLSv1.2,TLSv1.1`., +Specifies the supported protocols for TLS/SSL. Defaults to `TLSv1.3,TLSv1.2,TLSv1.1` if, +the JVM supports TLSv1.3, otherwise `TLSv1.2,TLSv1.1`., +`SSLv3`, `TLSv1`, `TLSv1.1`, `TLSv1.2`, `TLSv1.3`. Defaults to `TLSv1.3,TLSv1.2,TLSv1.1` if, +the JVM supports TLSv1.3, otherwise `TLSv1.2,TLSv1.1`., +++ b/docs/reference/settings/ssl-settings.asciidoc, +`SSLv3`, `TLSv1`, `TLSv1.1`, `TLSv1.2`, `TLSv1.3`. Defaults to `TLSv1.3,TLSv1.2,TLSv1.1` if, +the JVM supports TLSv1.3, otherwise `TLSv1.2,TLSv1.1`., +++ b/libs/ssl-config/src/main/java/org/elasticsearch/common/ssl/SslConfiguration.java, +import java.security.NoSuchAlgorithmException;, +import java.util.LinkedHashMap;, +import java.util.Map;, +import java.util.Map.Entry;, +    /**]
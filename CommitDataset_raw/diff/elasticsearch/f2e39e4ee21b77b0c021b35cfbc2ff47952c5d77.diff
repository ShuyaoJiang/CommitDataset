[+++ b/src/main/java/org/elasticsearch/cluster/block/ClusterBlocks.java, +import org.elasticsearch.cluster.metadata.IndexMetaData;, +import org.elasticsearch.cluster.metadata.MetaDataStateIndexService;, +        public Builder addBlocks(IndexMetaData indexMetaData) {, +            if (indexMetaData.state() == IndexMetaData.State.CLOSE) {, +                addIndexBlock(indexMetaData.index(), MetaDataStateIndexService.INDEX_CLOSED_BLOCK);, +            }, +            if (indexMetaData.settings().getAsBoolean(IndexMetaData.SETTING_READ_ONLY, false)) {, +                addIndexBlock(indexMetaData.index(), IndexMetaData.INDEX_READ_ONLY_BLOCK);, +            }, +            if (indexMetaData.settings().getAsBoolean(IndexMetaData.SETTING_BLOCKS_READ, false)) {, +                addIndexBlock(indexMetaData.index(), IndexMetaData.INDEX_READ_BLOCK);, +            }, +            if (indexMetaData.settings().getAsBoolean(IndexMetaData.SETTING_BLOCKS_WRITE, false)) {, +                addIndexBlock(indexMetaData.index(), IndexMetaData.INDEX_WRITE_BLOCK);, +            }, +            if (indexMetaData.settings().getAsBoolean(IndexMetaData.SETTING_BLOCKS_METADATA, false)) {, +                addIndexBlock(indexMetaData.index(), IndexMetaData.INDEX_METADATA_BLOCK);, +            }, +            return this;, +        }, +, +++ b/src/main/java/org/elasticsearch/cluster/block/ClusterBlocks.java, +import org.elasticsearch.cluster.metadata.IndexMetaData;, +import org.elasticsearch.cluster.metadata.MetaDataStateIndexService;, +        public Builder addBlocks(IndexMetaData indexMetaData) {, +            if (indexMetaData.state() == IndexMetaData.State.CLOSE) {, +                addIndexBlock(indexMetaData.index(), MetaDataStateIndexService.INDEX_CLOSED_BLOCK);, +            }, +            if (indexMetaData.settings().getAsBoolean(IndexMetaData.SETTING_READ_ONLY, false)) {, +                addIndexBlock(indexMetaData.index(), IndexMetaData.INDEX_READ_ONLY_BLOCK);, +            }, +            if (indexMetaData.settings().getAsBoolean(IndexMetaData.SETTING_BLOCKS_READ, false)) {, +                addIndexBlock(indexMetaData.index(), IndexMetaData.INDEX_READ_BLOCK);, +            }, +            if (indexMetaData.settings().getAsBoolean(IndexMetaData.SETTING_BLOCKS_WRITE, false)) {, +                addIndexBlock(indexMetaData.index(), IndexMetaData.INDEX_WRITE_BLOCK);, +            }, +            if (indexMetaData.settings().getAsBoolean(IndexMetaData.SETTING_BLOCKS_METADATA, false)) {, +                addIndexBlock(indexMetaData.index(), IndexMetaData.INDEX_METADATA_BLOCK);, +            }, +            return this;, +        }, +, +++ b/src/main/java/org/elasticsearch/cluster/metadata/IndexMetaData.java, +        public Builder index(String name) {, +            this.index = index;, +            return this;, +        }, +, +++ b/src/main/java/org/elasticsearch/cluster/block/ClusterBlocks.java, +import org.elasticsearch.cluster.metadata.IndexMetaData;, +import org.elasticsearch.cluster.metadata.MetaDataStateIndexService;, +        public Builder addBlocks(IndexMetaData indexMetaData) {, +            if (indexMetaData.state() == IndexMetaData.State.CLOSE) {, +                addIndexBlock(indexMetaData.index(), MetaDataStateIndexService.INDEX_CLOSED_BLOCK);, +            }, +            if (indexMetaData.settings().getAsBoolean(IndexMetaData.SETTING_READ_ONLY, false)) {, +                addIndexBlock(indexMetaData.index(), IndexMetaData.INDEX_READ_ONLY_BLOCK);, +            }, +            if (indexMetaData.settings().getAsBoolean(IndexMetaData.SETTING_BLOCKS_READ, false)) {, +                addIndexBlock(indexMetaData.index(), IndexMetaData.INDEX_READ_BLOCK);, +            }, +            if (indexMetaData.settings().getAsBoolean(IndexMetaData.SETTING_BLOCKS_WRITE, false)) {, +                addIndexBlock(indexMetaData.index(), IndexMetaData.INDEX_WRITE_BLOCK);, +            }, +            if (indexMetaData.settings().getAsBoolean(IndexMetaData.SETTING_BLOCKS_METADATA, false)) {, +                addIndexBlock(indexMetaData.index(), IndexMetaData.INDEX_METADATA_BLOCK);, +            }, +            return this;, +        }, +, +++ b/src/main/java/org/elasticsearch/cluster/metadata/IndexMetaData.java, +        public Builder index(String name) {, +            this.index = index;, +            return this;, +        }, +, +++ b/src/main/java/org/elasticsearch/cluster/metadata/MetaDataCreateIndexService.java, +                        RoutingTable.Builder routingTableBuilder = RoutingTable.builder().routingTable(updatedState.routingTable()), +                                .add(updatedState.metaData().index(request.index), true);, +++ b/src/main/java/org/elasticsearch/cluster/block/ClusterBlocks.java, +import org.elasticsearch.cluster.metadata.IndexMetaData;, +import org.elasticsearch.cluster.metadata.MetaDataStateIndexService;, +        public Builder addBlocks(IndexMetaData indexMetaData) {, +            if (indexMetaData.state() == IndexMetaData.State.CLOSE) {, +                addIndexBlock(indexMetaData.index(), MetaDataStateIndexService.INDEX_CLOSED_BLOCK);, +            }, +            if (indexMetaData.settings().getAsBoolean(IndexMetaData.SETTING_READ_ONLY, false)) {, +                addIndexBlock(indexMetaData.index(), IndexMetaData.INDEX_READ_ONLY_BLOCK);, +            }, +            if (indexMetaData.settings().getAsBoolean(IndexMetaData.SETTING_BLOCKS_READ, false)) {, +                addIndexBlock(indexMetaData.index(), IndexMetaData.INDEX_READ_BLOCK);, +            }, +            if (indexMetaData.settings().getAsBoolean(IndexMetaData.SETTING_BLOCKS_WRITE, false)) {, +                addIndexBlock(indexMetaData.index(), IndexMetaData.INDEX_WRITE_BLOCK);, +            }, +            if (indexMetaData.settings().getAsBoolean(IndexMetaData.SETTING_BLOCKS_METADATA, false)) {, +                addIndexBlock(indexMetaData.index(), IndexMetaData.INDEX_METADATA_BLOCK);, +            }]
[+++ b/core/src/main/java/org/elasticsearch/rest/support/RestUtils.java, +            } else if (c == '&' || c == ';') {, +++ b/core/src/main/java/org/elasticsearch/rest/support/RestUtils.java, +            } else if (c == '&' || c == ';') {, +++ b/core/src/test/java/org/elasticsearch/rest/util/RestUtilsTests.java, +    static char randomDelimiter() {, +        return randomBoolean() ? '&' : ';';, +    }, +, +        uri = String.format(Locale.ROOT, "something?test=value%ctest1=value1", randomDelimiter());, +        uri = String.format(Locale.ROOT, "something?%c", randomDelimiter());, +        uri = String.format(Locale.ROOT, "something?p=v%c%cp1=v1", randomDelimiter(), randomDelimiter());, +        uri = String.format(Locale.ROOT, "something?%c=", randomDelimiter());, +        uri = String.format(Locale.ROOT, "something?p=v%ca", randomDelimiter());, +        uri = String.format(Locale.ROOT, "something?p=v%ca%cp1=v1", randomDelimiter(), randomDelimiter());, +        uri = String.format(Locale.ROOT, "something?p=v%ca%cb%cp1=v1", randomDelimiter(), randomDelimiter(), randomDelimiter());, +        String uri = String.format(, +                Locale.ROOT,, +                "example.com/:@-._~!$%c'()*+,=;:@-._~!$%c'()*+,=:@-._~!$%c'()*+,==?/?:@-._~!$'()*+,=/?:@-._~!$'()*+,==#/?:@-._~!$%c'()*+,;=",, +                randomDelimiter(),, +                randomDelimiter(),, +                randomDelimiter(),, +                randomDelimiter());, +        assertThat(params.get("/?:@-._~!$'()* ,"), equalTo("/?:@-._~!$'()* ,=="));]
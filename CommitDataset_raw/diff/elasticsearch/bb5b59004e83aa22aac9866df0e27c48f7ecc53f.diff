[+++ b/x-pack/plugin/security/src/test/java/org/elasticsearch/xpack/ssl/SSLTrustRestrictionsTests.java, +import org.elasticsearch.test.InternalTestCluster;, +import org.elasticsearch.watcher.ResourceWatcherService;, +        runResourceWatcher();, +    /**, +     * Force the file watch to be updated., +     * Ideally we'd just left the service do its thing, but that means waiting for 5sec, +     * We can drop the 5s down, but then we run into resource contention issues., +     * This method just tells the {@link ResourceWatcherService} to run its check at a time that suits the tests. In all other respects, +     * it works just like normal - the usual file checks apply for detecting it as "changed", and only the previously configured files, +     * are checked., +     */, +    private void runResourceWatcher() {, +        final InternalTestCluster cluster = internalCluster();, +        if (cluster.size() > 0) {, +            final ResourceWatcherService service = cluster.getInstance(ResourceWatcherService.class);, +            logger.info("Triggering a reload of watched resources");, +            service.notifyNow(ResourceWatcherService.Frequency.HIGH);, +        }, +    }, +]
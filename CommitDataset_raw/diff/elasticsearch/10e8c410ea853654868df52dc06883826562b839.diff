[+++ b/core/src/main/java/org/elasticsearch/discovery/zen/publish/PublishClusterStateAction.java, +    /**, +     * Coordinates acknowledgments of the sent cluster state from the different nodes. Commits the change, +     * after `minimum_master_nodes` have successfully responded or fails the entire change. After committing, +     * the cluster state, will trigger a commit message to all nodes that responded previously and responds immediately, +     * to all future acknowledgments., +     */, +                    checkForCommitOrFailIfNoPending(node);, +        /**, +         * check if enough master node responded to commit the change. fails the commit, +         * if there are no more pending master nodes but not enough acks to commit., +         */, +        synchronized private void checkForCommitOrFailIfNoPending(DiscoveryNode masterNode) {, +                    masterNode, clusterState.version(), pendingMasterNodes, neededMastersToCommit);, +            decrementPendingMasterAcksAndChangeForFailure();, +        synchronized private void decrementPendingMasterAcksAndChangeForFailure() {, +                markAsFailed("no more pending master nodes, but failed to reach needed acks ([" + neededMastersToCommit + "] left)");, +                decrementPendingMasterAcksAndChangeForFailure();]
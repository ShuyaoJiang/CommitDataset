[+++ b/buildSrc/src/main/resources/checkstyle_suppressions.xml, +++ b/buildSrc/src/main/resources/checkstyle_suppressions.xml, +++ b/core/src/main/java/org/elasticsearch/action/search/AbstractSearchAsyncAction.java, +import java.util.concurrent.TimeUnit;, +    private final TransportSearchAction.SearchTimeProvider timeProvider;, +                                        ActionListener<SearchResponse> listener, GroupShardsIterator shardsIts, TransportSearchAction.SearchTimeProvider timeProvider,, +        this.timeProvider = timeProvider;, +    long buildTookInMillis() {, +        return TimeUnit.NANOSECONDS.toMillis(, +                timeProvider.getRelativeCurrentNanos() - timeProvider.getRelativeStartNanos());, +            filter, indexBoost, timeProvider.getAbsoluteStartMillis());, +++ b/buildSrc/src/main/resources/checkstyle_suppressions.xml, +++ b/core/src/main/java/org/elasticsearch/action/search/AbstractSearchAsyncAction.java, +import java.util.concurrent.TimeUnit;, +    private final TransportSearchAction.SearchTimeProvider timeProvider;, +                                        ActionListener<SearchResponse> listener, GroupShardsIterator shardsIts, TransportSearchAction.SearchTimeProvider timeProvider,, +        this.timeProvider = timeProvider;, +    long buildTookInMillis() {, +        return TimeUnit.NANOSECONDS.toMillis(, +                timeProvider.getRelativeCurrentNanos() - timeProvider.getRelativeStartNanos());, +            filter, indexBoost, timeProvider.getAbsoluteStartMillis());, +++ b/core/src/main/java/org/elasticsearch/action/search/SearchDfsQueryThenFetchAsyncAction.java, +, +    SearchDfsQueryThenFetchAsyncAction(, +            final Logger logger,, +            final SearchTransportService searchTransportService,, +            final Function<String, Transport.Connection> nodeIdToConnection,, +            final Map<String, AliasFilter> aliasFilter,, +            final Map<String, Float> concreteIndexBoosts,, +            final SearchPhaseController searchPhaseController,, +            final Executor executor,, +            final SearchRequest request,, +            final ActionListener<SearchResponse> listener,, +            final GroupShardsIterator shardsIts,, +            final TransportSearchAction.SearchTimeProvider timeProvider,, +            final long clusterStateVersion,, +            final SearchTask task) {, +        super(, +                "dfs",, +                logger,, +                searchTransportService,, +                nodeIdToConnection,, +                aliasFilter,, +                concreteIndexBoosts,, +                executor,, +                request,, +                listener,, +                shardsIts,, +                timeProvider,, +                clusterStateVersion,, +                task,, +                new SearchPhaseResults<>(shardsIts.size()));, +    protected void executePhaseOnShard(, +            final ShardIterator shardIt,, +            final ShardRouting shard,, +            final ActionListener<DfsSearchResult> listener) {, +    protected SearchPhase getNextPhase(, +            final SearchPhaseResults<DfsSearchResult> results, final SearchPhaseContext context) {, +        return new DfsQueryPhase(, +                results.results,, +                searchPhaseController,, +                (queryResults) ->, +                        new FetchSearchPhase(queryResults, searchPhaseController, context),, +                context);, +, +++ b/buildSrc/src/main/resources/checkstyle_suppressions.xml, +++ b/core/src/main/java/org/elasticsearch/action/search/AbstractSearchAsyncAction.java, +import java.util.concurrent.TimeUnit;, +    private final TransportSearchAction.SearchTimeProvider timeProvider;, +                                        ActionListener<SearchResponse> listener, GroupShardsIterator shardsIts, TransportSearchAction.SearchTimeProvider timeProvider,, +        this.timeProvider = timeProvider;, +    long buildTookInMillis() {, +        return TimeUnit.NANOSECONDS.toMillis(, +                timeProvider.getRelativeCurrentNanos() - timeProvider.getRelativeStartNanos());, +            filter, indexBoost, timeProvider.getAbsoluteStartMillis());, +++ b/core/src/main/java/org/elasticsearch/action/search/SearchDfsQueryThenFetchAsyncAction.java, +, +    SearchDfsQueryThenFetchAsyncAction(, +            final Logger logger,, +            final SearchTransportService searchTransportService,, +            final Function<String, Transport.Connection> nodeIdToConnection,, +            final Map<String, AliasFilter> aliasFilter,, +            final Map<String, Float> concreteIndexBoosts,, +            final SearchPhaseController searchPhaseController,, +            final Executor executor,, +            final SearchRequest request,, +            final ActionListener<SearchResponse> listener,, +            final GroupShardsIterator shardsIts,, +            final TransportSearchAction.SearchTimeProvider timeProvider,, +            final long clusterStateVersion,, +            final SearchTask task) {, +        super(, +                "dfs",, +                logger,, +                searchTransportService,, +                nodeIdToConnection,, +                aliasFilter,, +                concreteIndexBoosts,, +                executor,, +                request,]
[+++ b/plugin/security/src/main/java/org/elasticsearch/xpack/security/authc/saml/SamlRealm.java, +import org.apache.http.client.HttpClient;, +        HTTPMetadataResolver resolver = new PrivilegedHTTPMetadataResolver(builder.build(), metadataUrl);, +    private static final class PrivilegedHTTPMetadataResolver extends HTTPMetadataResolver {, +, +        PrivilegedHTTPMetadataResolver(final HttpClient client, final String metadataURL) throws ResolverException {, +            super(client, metadataURL);, +        }, +, +        @Override, +        protected byte[] fetchMetadata() throws ResolverException {, +            try {, +                return AccessController.doPrivileged(, +                        (PrivilegedExceptionAction<byte[]>) () -> PrivilegedHTTPMetadataResolver.super.fetchMetadata());, +            } catch (final PrivilegedActionException e) {, +                throw (ResolverException) e.getCause();, +            }, +        }, +, +    }, +]
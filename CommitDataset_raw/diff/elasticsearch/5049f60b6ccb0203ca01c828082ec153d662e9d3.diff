[+++ b/src/main/java/org/elasticsearch/action/admin/cluster/settings/TransportClusterUpdateSettingsAction.java, +                            .persistentSettings(persistentSettings.build()), +                            .transientSettings(transientSettings.build());, +                    boolean updatedReadOnly = metaData.persistentSettings().getAsBoolean(MetaData.SETTING_READ_ONLY, false) || metaData.transientSettings().getAsBoolean(MetaData.SETTING_READ_ONLY, false);, +                    } else {, +++ b/src/main/java/org/elasticsearch/action/admin/cluster/settings/TransportClusterUpdateSettingsAction.java, +                            .persistentSettings(persistentSettings.build()), +                            .transientSettings(transientSettings.build());, +                    boolean updatedReadOnly = metaData.persistentSettings().getAsBoolean(MetaData.SETTING_READ_ONLY, false) || metaData.transientSettings().getAsBoolean(MetaData.SETTING_READ_ONLY, false);, +                    } else {, +++ b/src/main/java/org/elasticsearch/cluster/metadata/IndexMetaData.java, +    public static final ClusterBlock INDEX_READ_ONLY_BLOCK = new ClusterBlock(5, "index read-only (api)", false, false, ClusterBlockLevel.WRITE, ClusterBlockLevel.METADATA);, +    public static final String SETTING_READ_ONLY = "index.blocks.read_only";, +++ b/src/main/java/org/elasticsearch/action/admin/cluster/settings/TransportClusterUpdateSettingsAction.java, +                            .persistentSettings(persistentSettings.build()), +                            .transientSettings(transientSettings.build());, +                    boolean updatedReadOnly = metaData.persistentSettings().getAsBoolean(MetaData.SETTING_READ_ONLY, false) || metaData.transientSettings().getAsBoolean(MetaData.SETTING_READ_ONLY, false);, +                    } else {, +++ b/src/main/java/org/elasticsearch/cluster/metadata/IndexMetaData.java, +    public static final ClusterBlock INDEX_READ_ONLY_BLOCK = new ClusterBlock(5, "index read-only (api)", false, false, ClusterBlockLevel.WRITE, ClusterBlockLevel.METADATA);, +    public static final String SETTING_READ_ONLY = "index.blocks.read_only";, +++ b/src/main/java/org/elasticsearch/cluster/metadata/MetaData.java, +    public static final String SETTING_READ_ONLY = "cluster.blocks.read_only";, +    public static final ClusterBlock CLUSTER_READ_ONLY_BLOCK = new ClusterBlock(6, "cluster read-only (api)", false, false, ClusterBlockLevel.WRITE, ClusterBlockLevel.METADATA);, +        public Settings transientSettings() {, +            return this.transientSettings;, +        }, +, +        public Settings persistentSettings() {, +            return this.persistentSettings;, +        }, +, +++ b/src/main/java/org/elasticsearch/action/admin/cluster/settings/TransportClusterUpdateSettingsAction.java, +                            .persistentSettings(persistentSettings.build()), +                            .transientSettings(transientSettings.build());, +                    boolean updatedReadOnly = metaData.persistentSettings().getAsBoolean(MetaData.SETTING_READ_ONLY, false) || metaData.transientSettings().getAsBoolean(MetaData.SETTING_READ_ONLY, false);, +                    } else {, +++ b/src/main/java/org/elasticsearch/cluster/metadata/IndexMetaData.java, +    public static final ClusterBlock INDEX_READ_ONLY_BLOCK = new ClusterBlock(5, "index read-only (api)", false, false, ClusterBlockLevel.WRITE, ClusterBlockLevel.METADATA);, +    public static final String SETTING_READ_ONLY = "index.blocks.read_only";, +++ b/src/main/java/org/elasticsearch/cluster/metadata/MetaData.java, +    public static final String SETTING_READ_ONLY = "cluster.blocks.read_only";, +    public static final ClusterBlock CLUSTER_READ_ONLY_BLOCK = new ClusterBlock(6, "cluster read-only (api)", false, false, ClusterBlockLevel.WRITE, ClusterBlockLevel.METADATA);, +        public Settings transientSettings() {, +            return this.transientSettings;, +        }, +, +        public Settings persistentSettings() {, +            return this.persistentSettings;, +        }, +, +++ b/src/main/java/org/elasticsearch/cluster/metadata/MetaDataUpdateSettingsService.java, +                            } else {, +++ b/src/main/java/org/elasticsearch/action/admin/cluster/settings/TransportClusterUpdateSettingsAction.java, +                            .persistentSettings(persistentSettings.build()), +                            .transientSettings(transientSettings.build());, +                    boolean updatedReadOnly = metaData.persistentSettings().getAsBoolean(MetaData.SETTING_READ_ONLY, false) || metaData.transientSettings().getAsBoolean(MetaData.SETTING_READ_ONLY, false);, +                    } else {, +++ b/src/main/java/org/elasticsearch/cluster/metadata/IndexMetaData.java, +    public static final ClusterBlock INDEX_READ_ONLY_BLOCK = new ClusterBlock(5, "index read-only (api)", false, false, ClusterBlockLevel.WRITE, ClusterBlockLevel.METADATA);, +    public static final String SETTING_READ_ONLY = "index.blocks.read_only";, +++ b/src/main/java/org/elasticsearch/cluster/metadata/MetaData.java, +    public static final String SETTING_READ_ONLY = "cluster.blocks.read_only";, +    public static final ClusterBlock CLUSTER_READ_ONLY_BLOCK = new ClusterBlock(6, "cluster read-only (api)", false, false, ClusterBlockLevel.WRITE, ClusterBlockLevel.METADATA);, +        public Settings transientSettings() {, +            return this.transientSettings;, +        }, +, +        public Settings persistentSettings() {, +            return this.persistentSettings;, +        }, +, +++ b/src/main/java/org/elasticsearch/cluster/metadata/MetaDataUpdateSettingsService.java, +                            } else {, +++ b/src/main/java/org/elasticsearch/gateway/GatewayService.java, +                        if (indexMetaData.settings().getAsBoolean(IndexMetaData.SETTING_READ_ONLY, false)) {, +++ b/src/main/java/org/elasticsearch/action/admin/cluster/settings/TransportClusterUpdateSettingsAction.java, +                            .persistentSettings(persistentSettings.build()), +                            .transientSettings(transientSettings.build());, +                    boolean updatedReadOnly = metaData.persistentSettings().getAsBoolean(MetaData.SETTING_READ_ONLY, false) || metaData.transientSettings().getAsBoolean(MetaData.SETTING_READ_ONLY, false);, +                    } else {, +++ b/src/main/java/org/elasticsearch/cluster/metadata/IndexMetaData.java, +    public static final ClusterBlock INDEX_READ_ONLY_BLOCK = new ClusterBlock(5, "index read-only (api)", false, false, ClusterBlockLevel.WRITE, ClusterBlockLevel.METADATA);, +    public static final String SETTING_READ_ONLY = "index.blocks.read_only";, +++ b/src/main/java/org/elasticsearch/cluster/metadata/MetaData.java, +    public static final String SETTING_READ_ONLY = "cluster.blocks.read_only";, +    public static final ClusterBlock CLUSTER_READ_ONLY_BLOCK = new ClusterBlock(6, "cluster read-only (api)", false, false, ClusterBlockLevel.WRITE, ClusterBlockLevel.METADATA);, +        public Settings transientSettings() {, +            return this.transientSettings;, +        }, +, +        public Settings persistentSettings() {, +            return this.persistentSettings;, +        }, +, +++ b/src/main/java/org/elasticsearch/cluster/metadata/MetaDataUpdateSettingsService.java, +                            } else {, +++ b/src/main/java/org/elasticsearch/gateway/GatewayService.java, +                        if (indexMetaData.settings().getAsBoolean(IndexMetaData.SETTING_READ_ONLY, false)) {, +++ /dev/null]
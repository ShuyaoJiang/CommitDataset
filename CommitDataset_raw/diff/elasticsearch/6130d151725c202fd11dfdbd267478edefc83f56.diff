[+++ b/server/src/main/java/org/elasticsearch/indices/flush/SyncedFlushService.java, +    final IndexShardRoutingTable getShardRoutingTable(final ShardId shardId, final ClusterState state) {, +        final IndexMetaData indexMetaData = state.getMetaData().index(shardId.getIndex());, +        if (indexMetaData == null) {, +            throw new IndexNotFoundException(shardId.getIndexName());, +        } else if (indexMetaData.getState() == IndexMetaData.State.CLOSE) {, +        final IndexShardRoutingTable shardRoutingTable = state.routingTable().index(indexMetaData.getIndex()).shard(shardId.id());, +++ b/server/src/main/java/org/elasticsearch/indices/flush/SyncedFlushService.java, +    final IndexShardRoutingTable getShardRoutingTable(final ShardId shardId, final ClusterState state) {, +        final IndexMetaData indexMetaData = state.getMetaData().index(shardId.getIndex());, +        if (indexMetaData == null) {, +            throw new IndexNotFoundException(shardId.getIndexName());, +        } else if (indexMetaData.getState() == IndexMetaData.State.CLOSE) {, +        final IndexShardRoutingTable shardRoutingTable = state.routingTable().index(indexMetaData.getIndex()).shard(shardId.id());, +++ b/server/src/test/java/org/elasticsearch/indices/flush/SyncedFlushSingleNodeTests.java, +import org.elasticsearch.cluster.metadata.IndexMetaData;, +import org.elasticsearch.common.settings.Settings;, +import static org.elasticsearch.test.hamcrest.ElasticsearchAssertions.assertAcked;, +, +        createIndex("test", Settings.builder(), +            .put(IndexMetaData.SETTING_NUMBER_OF_SHARDS, 1), +            .put(IndexMetaData.SETTING_NUMBER_OF_REPLICAS, 0), +            .build());, +        final IndexShard shard = test.getShardOrNull(0);, +        assertNotNull(shard);, +        final ShardId shardId = shard.shardId();, +        final SyncedFlushService flushService = getInstanceFromNode(SyncedFlushService.class);, +, +        flushService.attemptSyncedFlush(new ShardId(shard.shardId().getIndex(), 1), listener);, +        assertAcked(client().admin().indices().prepareClose("test"));]
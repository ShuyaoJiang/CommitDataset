[+++ b/test/framework/src/main/java/org/elasticsearch/test/InternalTestCluster.java, +        List<NodeAndClient> values = nodes.values().stream().filter(predicate).collect(Collectors.toList());, +        if (values.isEmpty() == false) {, +            return randomFrom(random, values);, +        if (size < n) {, +                startDataOnlyNodes(n - size);, +                startNodes(n - size);, +            if (autoManageMinMasterNodes && currentMasters > 0 && newMasters > 0 &&, +                getMinMasterNodes(currentMasters + newMasters) <= currentMasters) {, +                // if we're adding too many master-eligible nodes at once, we can't update the min master setting before adding the nodes., +            if (autoManageMinMasterNodes && currentMasters > 0 && newMasters > 0 &&, +                getMinMasterNodes(currentMasters + newMasters) > currentMasters) {, +     * Starts a node with default settings and returns its name., +     * Starts a node with the given settings builder and returns its name., +     * Starts a node with the given settings and returns its name., +        return startNodes(settings).get(0);]
[+++ b/x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/security/ScrollHelper.java, +import org.apache.logging.log4j.LogManager;, +import org.apache.logging.log4j.Logger;, +import org.apache.logging.log4j.message.ParameterizedMessage;, +    private static final Logger LOGGER = LogManager.getLogger(ScrollHelper.class);, +            throw new IllegalArgumentException("request must have scroll set");, +                client.clearScroll(clearScrollRequest, ActionListener.wrap((r) -> {}, e ->, +                    LOGGER.warn(new ParameterizedMessage("clear scroll failed for scroll id [{}]", response.getScrollId()), e), +                ));, +++ b/x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/security/ScrollHelper.java, +import org.apache.logging.log4j.LogManager;, +import org.apache.logging.log4j.Logger;, +import org.apache.logging.log4j.message.ParameterizedMessage;, +    private static final Logger LOGGER = LogManager.getLogger(ScrollHelper.class);, +            throw new IllegalArgumentException("request must have scroll set");, +                client.clearScroll(clearScrollRequest, ActionListener.wrap((r) -> {}, e ->, +                    LOGGER.warn(new ParameterizedMessage("clear scroll failed for scroll id [{}]", response.getScrollId()), e), +                ));, +++ b/x-pack/plugin/security/src/main/java/org/elasticsearch/xpack/security/authc/TokenService.java, +import static org.elasticsearch.search.SearchService.DEFAULT_KEEPALIVE_SETTING;, +                .setScroll(DEFAULT_KEEPALIVE_SETTING.get(settings)), +++ b/x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/security/ScrollHelper.java, +import org.apache.logging.log4j.LogManager;, +import org.apache.logging.log4j.Logger;, +import org.apache.logging.log4j.message.ParameterizedMessage;, +    private static final Logger LOGGER = LogManager.getLogger(ScrollHelper.class);, +            throw new IllegalArgumentException("request must have scroll set");, +                client.clearScroll(clearScrollRequest, ActionListener.wrap((r) -> {}, e ->, +                    LOGGER.warn(new ParameterizedMessage("clear scroll failed for scroll id [{}]", response.getScrollId()), e), +                ));, +++ b/x-pack/plugin/security/src/main/java/org/elasticsearch/xpack/security/authc/TokenService.java, +import static org.elasticsearch.search.SearchService.DEFAULT_KEEPALIVE_SETTING;, +                .setScroll(DEFAULT_KEEPALIVE_SETTING.get(settings)), +++ b/x-pack/plugin/security/src/main/java/org/elasticsearch/xpack/security/authc/esnative/NativeUsersStore.java, +import static org.elasticsearch.search.SearchService.DEFAULT_KEEPALIVE_SETTING;, +                            .setScroll(DEFAULT_KEEPALIVE_SETTING.get(settings)), +++ b/x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/security/ScrollHelper.java, +import org.apache.logging.log4j.LogManager;, +import org.apache.logging.log4j.Logger;, +import org.apache.logging.log4j.message.ParameterizedMessage;, +    private static final Logger LOGGER = LogManager.getLogger(ScrollHelper.class);, +            throw new IllegalArgumentException("request must have scroll set");, +                client.clearScroll(clearScrollRequest, ActionListener.wrap((r) -> {}, e ->, +                    LOGGER.warn(new ParameterizedMessage("clear scroll failed for scroll id [{}]", response.getScrollId()), e), +                ));, +++ b/x-pack/plugin/security/src/main/java/org/elasticsearch/xpack/security/authc/TokenService.java, +import static org.elasticsearch.search.SearchService.DEFAULT_KEEPALIVE_SETTING;, +                .setScroll(DEFAULT_KEEPALIVE_SETTING.get(settings)), +++ b/x-pack/plugin/security/src/main/java/org/elasticsearch/xpack/security/authc/esnative/NativeUsersStore.java, +import static org.elasticsearch.search.SearchService.DEFAULT_KEEPALIVE_SETTING;, +                            .setScroll(DEFAULT_KEEPALIVE_SETTING.get(settings)), +++ b/x-pack/plugin/security/src/main/java/org/elasticsearch/xpack/security/authc/support/mapper/NativeRoleMappingStore.java, +import static org.elasticsearch.search.SearchService.DEFAULT_KEEPALIVE_SETTING;, +                    .setScroll(DEFAULT_KEEPALIVE_SETTING.get(settings)), +++ b/x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/security/ScrollHelper.java, +import org.apache.logging.log4j.LogManager;, +import org.apache.logging.log4j.Logger;, +import org.apache.logging.log4j.message.ParameterizedMessage;, +    private static final Logger LOGGER = LogManager.getLogger(ScrollHelper.class);, +            throw new IllegalArgumentException("request must have scroll set");, +                client.clearScroll(clearScrollRequest, ActionListener.wrap((r) -> {}, e ->, +                    LOGGER.warn(new ParameterizedMessage("clear scroll failed for scroll id [{}]", response.getScrollId()), e), +                ));, +++ b/x-pack/plugin/security/src/main/java/org/elasticsearch/xpack/security/authc/TokenService.java, +import static org.elasticsearch.search.SearchService.DEFAULT_KEEPALIVE_SETTING;, +                .setScroll(DEFAULT_KEEPALIVE_SETTING.get(settings)), +++ b/x-pack/plugin/security/src/main/java/org/elasticsearch/xpack/security/authc/esnative/NativeUsersStore.java, +import static org.elasticsearch.search.SearchService.DEFAULT_KEEPALIVE_SETTING;, +                            .setScroll(DEFAULT_KEEPALIVE_SETTING.get(settings)), +++ b/x-pack/plugin/security/src/main/java/org/elasticsearch/xpack/security/authc/support/mapper/NativeRoleMappingStore.java, +import static org.elasticsearch.search.SearchService.DEFAULT_KEEPALIVE_SETTING;, +                    .setScroll(DEFAULT_KEEPALIVE_SETTING.get(settings)), +++ b/x-pack/plugin/security/src/main/java/org/elasticsearch/xpack/security/authz/store/NativePrivilegeStore.java, +import static org.elasticsearch.search.SearchService.DEFAULT_KEEPALIVE_SETTING;, +                        .setScroll(DEFAULT_KEEPALIVE_SETTING.get(settings)), +++ b/x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/security/ScrollHelper.java, +import org.apache.logging.log4j.LogManager;, +import org.apache.logging.log4j.Logger;, +import org.apache.logging.log4j.message.ParameterizedMessage;, +    private static final Logger LOGGER = LogManager.getLogger(ScrollHelper.class);, +            throw new IllegalArgumentException("request must have scroll set");, +                client.clearScroll(clearScrollRequest, ActionListener.wrap((r) -> {}, e ->, +                    LOGGER.warn(new ParameterizedMessage("clear scroll failed for scroll id [{}]", response.getScrollId()), e), +                ));, +++ b/x-pack/plugin/security/src/main/java/org/elasticsearch/xpack/security/authc/TokenService.java, +import static org.elasticsearch.search.SearchService.DEFAULT_KEEPALIVE_SETTING;, +                .setScroll(DEFAULT_KEEPALIVE_SETTING.get(settings)), +++ b/x-pack/plugin/security/src/main/java/org/elasticsearch/xpack/security/authc/esnative/NativeUsersStore.java, +import static org.elasticsearch.search.SearchService.DEFAULT_KEEPALIVE_SETTING;, +                            .setScroll(DEFAULT_KEEPALIVE_SETTING.get(settings)), +++ b/x-pack/plugin/security/src/main/java/org/elasticsearch/xpack/security/authc/support/mapper/NativeRoleMappingStore.java, +import static org.elasticsearch.search.SearchService.DEFAULT_KEEPALIVE_SETTING;, +                    .setScroll(DEFAULT_KEEPALIVE_SETTING.get(settings)), +++ b/x-pack/plugin/security/src/main/java/org/elasticsearch/xpack/security/authz/store/NativePrivilegeStore.java, +import static org.elasticsearch.search.SearchService.DEFAULT_KEEPALIVE_SETTING;, +                        .setScroll(DEFAULT_KEEPALIVE_SETTING.get(settings)), +++ b/x-pack/plugin/security/src/main/java/org/elasticsearch/xpack/security/authz/store/NativeRolesStore.java, +import static org.elasticsearch.search.SearchService.DEFAULT_KEEPALIVE_SETTING;, +                            .setScroll(DEFAULT_KEEPALIVE_SETTING.get(settings)), +++ b/x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/security/ScrollHelper.java]
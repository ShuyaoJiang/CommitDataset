[+++ b/core/src/main/java/org/elasticsearch/common/lucene/ShardCoreKeyMap.java, +                reader.addCoreClosedListener(ownerCoreCacheKey -> {, +                });, +++ b/core/src/main/java/org/elasticsearch/common/lucene/ShardCoreKeyMap.java, +                reader.addCoreClosedListener(ownerCoreCacheKey -> {, +                });, +++ b/core/src/main/java/org/elasticsearch/index/IndexService.java, +import java.util.Objects;, +                if (Objects.equals(left.getMessage(), right.getMessage())) {, +++ b/core/src/main/java/org/elasticsearch/common/lucene/ShardCoreKeyMap.java, +                reader.addCoreClosedListener(ownerCoreCacheKey -> {, +                });, +++ b/core/src/main/java/org/elasticsearch/index/IndexService.java, +import java.util.Objects;, +                if (Objects.equals(left.getMessage(), right.getMessage())) {, +++ b/core/src/test/java/org/elasticsearch/common/lucene/ShardCoreKeyMapTests.java]
[+++ b/src/test/java/org/elasticsearch/index/engine/internal/InternalEngineIntegrationTest.java, +import org.elasticsearch.index.merge.policy.AbstractMergePolicyProvider;, +import static org.elasticsearch.test.hamcrest.ElasticsearchAssertions.assertAcked;, +, +        boolean compound = randomBoolean();, +        assertAcked(client().admin().indices().prepareCreate("test").setSettings(ImmutableSettings.builder(), +                .put("number_of_replicas", 0), +                .put("number_of_shards", 1), +                 // this is important otherwise the MP will still trigger a merge even if there is only one segment, +                .put(InternalEngine.INDEX_COMPOUND_ON_FLUSH, compound), +                .put(AbstractMergePolicyProvider.INDEX_COMPOUND_FORMAT, compound), +        ));]
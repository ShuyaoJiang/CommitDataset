[+++ b/src/main/java/org/elasticsearch/cluster/routing/allocation/decider/DiskThresholdDecider.java, +    public long sizeOfRelocatingShards(RoutingNode node, Map<String, Long> shardSizes, boolean subtractShardsMovingAway) {, +        for (ShardRouting routing : node.shardsWithState(ShardRoutingState.RELOCATING, ShardRoutingState.INITIALIZING)) {, +            if (routing.initializing() && routing.relocatingNodeId() != null) {, +            } else if (subtractShardsMovingAway && routing.relocating()) {, +            long relocatingShardsSize = sizeOfRelocatingShards(node, shardSizes, false);, +            long relocatingShardsSize = sizeOfRelocatingShards(node, shardSizes, true);]
[+++ b/x-pack/plugin/ml/src/main/java/org/elasticsearch/xpack/ml/action/TransportDeleteExpiredDataAction.java, +import org.elasticsearch.xpack.core.ClientHelper;, +        this.client = ClientHelper.clientWithOrigin(client, ClientHelper.ML_ORIGIN);, +++ b/x-pack/plugin/ml/src/main/java/org/elasticsearch/xpack/ml/action/TransportDeleteExpiredDataAction.java, +import org.elasticsearch.xpack.core.ClientHelper;, +        this.client = ClientHelper.clientWithOrigin(client, ClientHelper.ML_ORIGIN);, +++ b/x-pack/plugin/ml/src/main/java/org/elasticsearch/xpack/ml/job/retention/ExpiredForecastsRemover.java, + *, + * This is expected to be used by actions requiring admin rights. Thus,, + * it is also expected that the provided client will be a client with the, + * ML origin so that permissions to manage ML indices are met., +++ b/x-pack/plugin/ml/src/main/java/org/elasticsearch/xpack/ml/action/TransportDeleteExpiredDataAction.java, +import org.elasticsearch.xpack.core.ClientHelper;, +        this.client = ClientHelper.clientWithOrigin(client, ClientHelper.ML_ORIGIN);, +++ b/x-pack/plugin/ml/src/main/java/org/elasticsearch/xpack/ml/job/retention/ExpiredForecastsRemover.java, + *, + * This is expected to be used by actions requiring admin rights. Thus,, + * it is also expected that the provided client will be a client with the, + * ML origin so that permissions to manage ML indices are met., +++ b/x-pack/plugin/ml/src/main/java/org/elasticsearch/xpack/ml/job/retention/ExpiredModelSnapshotsRemover.java, + *, + * This is expected to be used by actions requiring admin rights. Thus,, + * it is also expected that the provided client will be a client with the, + * ML origin so that permissions to manage ML indices are met., +++ b/x-pack/plugin/ml/src/main/java/org/elasticsearch/xpack/ml/action/TransportDeleteExpiredDataAction.java, +import org.elasticsearch.xpack.core.ClientHelper;, +        this.client = ClientHelper.clientWithOrigin(client, ClientHelper.ML_ORIGIN);, +++ b/x-pack/plugin/ml/src/main/java/org/elasticsearch/xpack/ml/job/retention/ExpiredForecastsRemover.java, + *, + * This is expected to be used by actions requiring admin rights. Thus,, + * it is also expected that the provided client will be a client with the, + * ML origin so that permissions to manage ML indices are met., +++ b/x-pack/plugin/ml/src/main/java/org/elasticsearch/xpack/ml/job/retention/ExpiredModelSnapshotsRemover.java, + *, + * This is expected to be used by actions requiring admin rights. Thus,, + * it is also expected that the provided client will be a client with the, + * ML origin so that permissions to manage ML indices are met., +++ b/x-pack/plugin/ml/src/main/java/org/elasticsearch/xpack/ml/job/retention/ExpiredResultsRemover.java, + *, + * This is expected to be used by actions requiring admin rights. Thus,, + * it is also expected that the provided client will be a client with the, + * ML origin so that permissions to manage ML indices are met., +        client.execute(DeleteByQueryAction.INSTANCE, request, new ActionListener<BulkByScrollResponse>() {]
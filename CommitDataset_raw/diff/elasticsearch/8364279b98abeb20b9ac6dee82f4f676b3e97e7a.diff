[+++ b/core/src/main/java/org/elasticsearch/search/SearchService.java, +    /**, +     * Returns true iff the given search source builder can be early terminated by rewriting to a match none query. Or in other words, +     * if the execution of a the search request can be early terminated without executing it. This is for instance not possible if, +     * a global aggregation is part of this request or if there is a suggest builder present., +     */, +        if (source == null || source.query() == null || source.query() instanceof MatchAllQueryBuilder || source.suggest() != null) {, +++ b/core/src/main/java/org/elasticsearch/search/SearchService.java, +    /**, +     * Returns true iff the given search source builder can be early terminated by rewriting to a match none query. Or in other words, +     * if the execution of a the search request can be early terminated without executing it. This is for instance not possible if, +     * a global aggregation is part of this request or if there is a suggest builder present., +     */, +        if (source == null || source.query() == null || source.query() instanceof MatchAllQueryBuilder || source.suggest() != null) {, +++ b/core/src/test/java/org/elasticsearch/search/SearchServiceTests.java, +import org.elasticsearch.search.suggest.SuggestBuilder;, +        assertFalse(SearchService.canRewriteToMatchNone(new SearchSourceBuilder().query(new MatchNoneQueryBuilder()), +            .aggregation(new TermsAggregationBuilder("test", ValueType.STRING).minDocCount(1)), +            .suggest(new SuggestBuilder())));, +        assertFalse(SearchService.canRewriteToMatchNone(new SearchSourceBuilder().query(new TermQueryBuilder("foo", "bar")), +            .suggest(new SuggestBuilder())));, +]
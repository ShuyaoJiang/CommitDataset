[+++ b/elasticsearch/src/main/java/org/elasticsearch/xpack/security/Security.java, +import org.elasticsearch.xpack.security.authz.permission.FieldPermissionsCache;, +        components.add(allRolesStore); // for SecurityFeatureSet and clear roles cache, +        settingsList.add(CompositeRolesStore.CACHE_SIZE_SETTING);, +        settingsList.add(FieldPermissionsCache.CACHE_SIZE_SETTING);, +++ b/elasticsearch/src/main/java/org/elasticsearch/xpack/security/Security.java, +import org.elasticsearch.xpack.security.authz.permission.FieldPermissionsCache;, +        components.add(allRolesStore); // for SecurityFeatureSet and clear roles cache, +        settingsList.add(CompositeRolesStore.CACHE_SIZE_SETTING);, +        settingsList.add(FieldPermissionsCache.CACHE_SIZE_SETTING);, +++ b/elasticsearch/src/main/java/org/elasticsearch/xpack/security/action/filter/SecurityActionFilter.java, +import org.elasticsearch.xpack.security.support.Automatons;, +    private static final Predicate<String> SECURITY_ACTION_MATCHER = Automatons.predicate("cluster:admin/xpack/security*");, +++ b/elasticsearch/src/main/java/org/elasticsearch/xpack/security/Security.java, +import org.elasticsearch.xpack.security.authz.permission.FieldPermissionsCache;, +        components.add(allRolesStore); // for SecurityFeatureSet and clear roles cache, +        settingsList.add(CompositeRolesStore.CACHE_SIZE_SETTING);, +        settingsList.add(FieldPermissionsCache.CACHE_SIZE_SETTING);, +++ b/elasticsearch/src/main/java/org/elasticsearch/xpack/security/action/filter/SecurityActionFilter.java, +import org.elasticsearch.xpack.security.support.Automatons;, +    private static final Predicate<String> SECURITY_ACTION_MATCHER = Automatons.predicate("cluster:admin/xpack/security*");, +++ b/elasticsearch/src/main/java/org/elasticsearch/xpack/security/action/role/PutRoleRequest.java, +    public void addIndex(String[] indices, String[] privileges, String[] grantedFields, String[] deniedFields,, +                .grantedFields(grantedFields), +                .deniedFields(deniedFields), +++ b/elasticsearch/src/main/java/org/elasticsearch/xpack/security/Security.java, +import org.elasticsearch.xpack.security.authz.permission.FieldPermissionsCache;, +        components.add(allRolesStore); // for SecurityFeatureSet and clear roles cache, +        settingsList.add(CompositeRolesStore.CACHE_SIZE_SETTING);, +        settingsList.add(FieldPermissionsCache.CACHE_SIZE_SETTING);, +++ b/elasticsearch/src/main/java/org/elasticsearch/xpack/security/action/filter/SecurityActionFilter.java, +import org.elasticsearch.xpack.security.support.Automatons;, +    private static final Predicate<String> SECURITY_ACTION_MATCHER = Automatons.predicate("cluster:admin/xpack/security*");, +++ b/elasticsearch/src/main/java/org/elasticsearch/xpack/security/action/role/PutRoleRequest.java, +    public void addIndex(String[] indices, String[] privileges, String[] grantedFields, String[] deniedFields,, +                .grantedFields(grantedFields), +                .deniedFields(deniedFields), +++ b/elasticsearch/src/main/java/org/elasticsearch/xpack/security/action/role/PutRoleRequestBuilder.java, +    public PutRoleRequestBuilder addIndices(String[] indices, String[] privileges, String[] grantedFields, String[] deniedFields,, +                                            @Nullable BytesReference query) {, +        request.addIndex(indices, privileges, grantedFields, deniedFields, query);, +++ b/elasticsearch/src/main/java/org/elasticsearch/xpack/security/Security.java, +import org.elasticsearch.xpack.security.authz.permission.FieldPermissionsCache;, +        components.add(allRolesStore); // for SecurityFeatureSet and clear roles cache, +        settingsList.add(CompositeRolesStore.CACHE_SIZE_SETTING);, +        settingsList.add(FieldPermissionsCache.CACHE_SIZE_SETTING);, +++ b/elasticsearch/src/main/java/org/elasticsearch/xpack/security/action/filter/SecurityActionFilter.java, +import org.elasticsearch.xpack.security.support.Automatons;, +    private static final Predicate<String> SECURITY_ACTION_MATCHER = Automatons.predicate("cluster:admin/xpack/security*");, +++ b/elasticsearch/src/main/java/org/elasticsearch/xpack/security/action/role/PutRoleRequest.java, +    public void addIndex(String[] indices, String[] privileges, String[] grantedFields, String[] deniedFields,, +                .grantedFields(grantedFields), +                .deniedFields(deniedFields), +++ b/elasticsearch/src/main/java/org/elasticsearch/xpack/security/action/role/PutRoleRequestBuilder.java, +    public PutRoleRequestBuilder addIndices(String[] indices, String[] privileges, String[] grantedFields, String[] deniedFields,, +                                            @Nullable BytesReference query) {, +        request.addIndex(indices, privileges, grantedFields, deniedFields, query);, +++ b/elasticsearch/src/main/java/org/elasticsearch/xpack/security/action/role/TransportClearRolesCacheAction.java, +import org.elasticsearch.xpack.security.authz.store.CompositeRolesStore;, +    private final CompositeRolesStore rolesStore;, +                                          CompositeRolesStore rolesStore, IndexNameExpressionResolver indexNameExpressionResolver) {, +++ b/elasticsearch/src/main/java/org/elasticsearch/xpack/security/Security.java, +import org.elasticsearch.xpack.security.authz.permission.FieldPermissionsCache;, +        components.add(allRolesStore); // for SecurityFeatureSet and clear roles cache, +        settingsList.add(CompositeRolesStore.CACHE_SIZE_SETTING);, +        settingsList.add(FieldPermissionsCache.CACHE_SIZE_SETTING);, +++ b/elasticsearch/src/main/java/org/elasticsearch/xpack/security/action/filter/SecurityActionFilter.java, +import org.elasticsearch.xpack.security.support.Automatons;, +    private static final Predicate<String> SECURITY_ACTION_MATCHER = Automatons.predicate("cluster:admin/xpack/security*");, +++ b/elasticsearch/src/main/java/org/elasticsearch/xpack/security/action/role/PutRoleRequest.java, +    public void addIndex(String[] indices, String[] privileges, String[] grantedFields, String[] deniedFields,, +                .grantedFields(grantedFields), +                .deniedFields(deniedFields), +++ b/elasticsearch/src/main/java/org/elasticsearch/xpack/security/action/role/PutRoleRequestBuilder.java, +    public PutRoleRequestBuilder addIndices(String[] indices, String[] privileges, String[] grantedFields, String[] deniedFields,, +                                            @Nullable BytesReference query) {, +        request.addIndex(indices, privileges, grantedFields, deniedFields, query);, +++ b/elasticsearch/src/main/java/org/elasticsearch/xpack/security/action/role/TransportClearRolesCacheAction.java, +import org.elasticsearch.xpack.security.authz.store.CompositeRolesStore;, +    private final CompositeRolesStore rolesStore;, +                                          CompositeRolesStore rolesStore, IndexNameExpressionResolver indexNameExpressionResolver) {, +++ b/elasticsearch/src/main/java/org/elasticsearch/xpack/security/action/role/TransportGetRolesAction.java, +                    if (rd != null) {, +                        listener.onFailure(new IllegalStateException("unable to obtain reserved role [" + role + "]"));, +                        return;, +                    }, +                } else {, +++ b/elasticsearch/src/main/java/org/elasticsearch/xpack/security/Security.java, +import org.elasticsearch.xpack.security.authz.permission.FieldPermissionsCache;, +        components.add(allRolesStore); // for SecurityFeatureSet and clear roles cache, +        settingsList.add(CompositeRolesStore.CACHE_SIZE_SETTING);, +        settingsList.add(FieldPermissionsCache.CACHE_SIZE_SETTING);, +++ b/elasticsearch/src/main/java/org/elasticsearch/xpack/security/action/filter/SecurityActionFilter.java, +import org.elasticsearch.xpack.security.support.Automatons;, +    private static final Predicate<String> SECURITY_ACTION_MATCHER = Automatons.predicate("cluster:admin/xpack/security*");, +++ b/elasticsearch/src/main/java/org/elasticsearch/xpack/security/action/role/PutRoleRequest.java, +    public void addIndex(String[] indices, String[] privileges, String[] grantedFields, String[] deniedFields,, +                .grantedFields(grantedFields), +                .deniedFields(deniedFields), +++ b/elasticsearch/src/main/java/org/elasticsearch/xpack/security/action/role/PutRoleRequestBuilder.java]
[+++ b/src/main/java/org/elasticsearch/indices/recovery/RecoveryStatus.java, +    /** Get a temporary name for the provided file name. */, +    public String getTempNameForFile(String origFile) {, +++ b/src/main/java/org/elasticsearch/indices/recovery/RecoveryStatus.java, +    /** Get a temporary name for the provided file name. */, +    public String getTempNameForFile(String origFile) {, +++ b/src/main/java/org/elasticsearch/indices/recovery/RecoveryTarget.java, +import java.util.Arrays;, +                    final String temporaryFileName = recoveryStatus.getTempNameForFile(request.name());, +                    assert Arrays.asList(store.directory().listAll()).contains(temporaryFileName);, +                    store.directory().sync(Collections.singleton(temporaryFileName));]
[+++ b/src/main/java/org/elasticsearch/indices/cluster/IndicesClusterStateService.java, +import java.util.HashMap;, +import java.util.Iterator;, +import java.util.List;, +import java.util.Map;, +            List<String> typesToRefresh = Lists.newArrayList();, +                boolean requireRefresh = processMapping(index, mapperService, MapperService.DEFAULT_MAPPING, indexMetaData.mapping(MapperService.DEFAULT_MAPPING).source());, +                if (requireRefresh) {, +                    typesToRefresh.add(MapperService.DEFAULT_MAPPING);, +                }, +            if (!typesToRefresh.isEmpty() && sendRefreshMapping) {]
[+++ b/src/main/java/org/elasticsearch/gateway/local/state/meta/LocalGatewayMetaState.java, +                ensureNoPre019State();, +    /**, +     * Throws an IAE if a pre 0.19 state is detected, +     */, +    private void ensureNoPre019State() throws Exception {, +                    final String name = stateFile.getFileName().toString();, +                    if (name.startsWith("metadata-")) {, +                        throw new ElasticsearchIllegalStateException("Detected pre 0.19 metadata file please upgrade to a version before ", +                                + Version.CURRENT.minimumCompatibilityVersion(), +                                + " first to upgrade state structures - metadata found: [" + stateFile.getParent().toAbsolutePath());, +++ b/src/main/java/org/elasticsearch/gateway/local/state/meta/LocalGatewayMetaState.java, +                ensureNoPre019State();, +    /**, +     * Throws an IAE if a pre 0.19 state is detected, +     */, +    private void ensureNoPre019State() throws Exception {, +                    final String name = stateFile.getFileName().toString();, +                    if (name.startsWith("metadata-")) {, +                        throw new ElasticsearchIllegalStateException("Detected pre 0.19 metadata file please upgrade to a version before ", +                                + Version.CURRENT.minimumCompatibilityVersion(), +                                + " first to upgrade state structures - metadata found: [" + stateFile.getParent().toAbsolutePath());, +++ b/src/main/java/org/elasticsearch/gateway/local/state/shards/LocalGatewayShardsState.java, +import org.elasticsearch.ElasticsearchIllegalStateException;, +import org.elasticsearch.Version;, +                ensureNoPre019State();, +    private void ensureNoPre019State() throws Exception {, +            if (Files.exists(stateLocation)) {, +                        throw new ElasticsearchIllegalStateException("Detected pre 0.19 shard state file please upgrade to a version before ", +                                + Version.CURRENT.minimumCompatibilityVersion(), +                                + " first to upgrade state structures - shard state found: [" + stateFile.getParent().toAbsolutePath());]
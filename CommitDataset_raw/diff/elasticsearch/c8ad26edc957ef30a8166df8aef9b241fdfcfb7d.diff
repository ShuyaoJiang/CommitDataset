[+++ b/core/src/test/java/org/elasticsearch/search/aggregations/metrics/InternalStatsTests.java, +        long count = frequently() ? randomIntBetween(1, Integer.MAX_VALUE) : 0;, +        double min = randomDoubleBetween(-1000000, 1000000, true);, +        double max = randomDoubleBetween(-1000000, 1000000, true);, +        double sum = randomDoubleBetween(-1000000, 1000000, true);, +        DocValueFormat format = randomNumericDocValueFormat();, +        return new InternalStats(name, count, sum, min, max, format, pipelineAggregators, Collections.emptyMap());, +        assertEquals(expectedSum, reduced.getSum(), 1e-7);]
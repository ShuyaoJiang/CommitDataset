[+++ b/modules/lang-groovy/src/main/plugin-metadata/plugin-security.policy, +  permission org.elasticsearch.script.ClassPermission "sun.reflect.MethodAccessorImpl";, +++ b/modules/lang-groovy/src/main/plugin-metadata/plugin-security.policy, +  permission org.elasticsearch.script.ClassPermission "sun.reflect.MethodAccessorImpl";, +++ b/modules/lang-groovy/src/test/java/org/elasticsearch/script/groovy/GroovySecurityTests.java, +        // Groovy uses reflection to invoke closures. These reflective calls are optimized by the JVM after "sun.reflect.inflationThreshold", +        // invocations. After the inflation step, access to sun.reflect.MethodAccessorImpl is required from the security manager. This test,, +        // assuming a inflation threshold below 100 (15 is current value on Oracle JVMs), checks that the relevant permission is available., +        assertSuccess("(1..100).collect{ it + 1 }");, +++ b/modules/lang-groovy/src/main/plugin-metadata/plugin-security.policy, +  permission org.elasticsearch.script.ClassPermission "sun.reflect.MethodAccessorImpl";, +++ b/modules/lang-groovy/src/test/java/org/elasticsearch/script/groovy/GroovySecurityTests.java, +        // Groovy uses reflection to invoke closures. These reflective calls are optimized by the JVM after "sun.reflect.inflationThreshold", +        // invocations. After the inflation step, access to sun.reflect.MethodAccessorImpl is required from the security manager. This test,, +        // assuming a inflation threshold below 100 (15 is current value on Oracle JVMs), checks that the relevant permission is available., +        assertSuccess("(1..100).collect{ it + 1 }");, +++ b/plugins/lang-javascript/src/test/java/org/elasticsearch/script/javascript/JavaScriptSecurityTests.java, +        assertSuccess("Array.apply(null, Array(100)).map(function (_, i) {return i;}).map(function (i) {return i+1;})");, +++ b/modules/lang-groovy/src/main/plugin-metadata/plugin-security.policy, +  permission org.elasticsearch.script.ClassPermission "sun.reflect.MethodAccessorImpl";, +++ b/modules/lang-groovy/src/test/java/org/elasticsearch/script/groovy/GroovySecurityTests.java, +        // Groovy uses reflection to invoke closures. These reflective calls are optimized by the JVM after "sun.reflect.inflationThreshold", +        // invocations. After the inflation step, access to sun.reflect.MethodAccessorImpl is required from the security manager. This test,, +        // assuming a inflation threshold below 100 (15 is current value on Oracle JVMs), checks that the relevant permission is available., +        assertSuccess("(1..100).collect{ it + 1 }");, +++ b/plugins/lang-javascript/src/test/java/org/elasticsearch/script/javascript/JavaScriptSecurityTests.java, +        assertSuccess("Array.apply(null, Array(100)).map(function (_, i) {return i;}).map(function (i) {return i+1;})");, +++ b/plugins/lang-python/src/test/java/org/elasticsearch/script/python/PythonSecurityTests.java, +        assertSuccess("map(lambda x: x + 1, range(100))");]
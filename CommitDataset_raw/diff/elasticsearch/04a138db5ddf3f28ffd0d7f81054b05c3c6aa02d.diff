[+++ b/src/main/java/org/elasticsearch/action/search/SearchRequest.java, +++ b/src/main/java/org/elasticsearch/action/search/SearchRequest.java, +++ b/src/main/java/org/elasticsearch/action/search/type/TransportSearchHelper.java, +++ b/src/main/java/org/elasticsearch/action/search/SearchRequest.java, +++ b/src/main/java/org/elasticsearch/action/search/type/TransportSearchHelper.java, +++ b/src/main/java/org/elasticsearch/client/action/search/SearchRequestBuilder.java, +        sourceBuilder().timeout(timeout);, +        sourceBuilder().timeout(timeout);, +++ b/src/main/java/org/elasticsearch/action/search/SearchRequest.java, +++ b/src/main/java/org/elasticsearch/action/search/type/TransportSearchHelper.java, +++ b/src/main/java/org/elasticsearch/client/action/search/SearchRequestBuilder.java, +        sourceBuilder().timeout(timeout);, +        sourceBuilder().timeout(timeout);, +++ b/src/main/java/org/elasticsearch/rest/action/search/RestSearchAction.java, +        if (request.hasParam("timeout")) {, +            if (searchSourceBuilder == null) {, +                searchSourceBuilder = new SearchSourceBuilder();, +            }, +            searchSourceBuilder.timeout(request.paramAsTime("timeout", null));, +        }, +++ b/src/main/java/org/elasticsearch/action/search/SearchRequest.java, +++ b/src/main/java/org/elasticsearch/action/search/type/TransportSearchHelper.java, +++ b/src/main/java/org/elasticsearch/client/action/search/SearchRequestBuilder.java, +        sourceBuilder().timeout(timeout);, +        sourceBuilder().timeout(timeout);, +++ b/src/main/java/org/elasticsearch/rest/action/search/RestSearchAction.java, +        if (request.hasParam("timeout")) {, +            if (searchSourceBuilder == null) {, +                searchSourceBuilder = new SearchSourceBuilder();, +            }, +            searchSourceBuilder.timeout(request.paramAsTime("timeout", null));, +        }, +++ b/src/main/java/org/elasticsearch/search/builder/SearchSourceBuilder.java, +import org.elasticsearch.common.unit.TimeValue;, +    private long timeoutInMillis = -1;, +, +     * An optional timeout to control how long search is allowed to take., +     */, +    public SearchSourceBuilder timeout(TimeValue timeout) {, +        this.timeoutInMillis = timeout.millis();, +        return this;, +    }, +, +    /**, +     * An optional timeout to control how long search is allowed to take., +     */, +    public SearchSourceBuilder timeout(String timeout) {, +        this.timeoutInMillis = TimeValue.parseTimeValue(timeout, null).millis();, +        return this;, +    }, +, +    /**, +        if (timeoutInMillis != -1) {, +            builder.field("timeout", timeoutInMillis);, +        }, +, +++ b/src/main/java/org/elasticsearch/action/search/SearchRequest.java, +++ b/src/main/java/org/elasticsearch/action/search/type/TransportSearchHelper.java, +++ b/src/main/java/org/elasticsearch/client/action/search/SearchRequestBuilder.java, +        sourceBuilder().timeout(timeout);, +        sourceBuilder().timeout(timeout);, +++ b/src/main/java/org/elasticsearch/rest/action/search/RestSearchAction.java, +        if (request.hasParam("timeout")) {, +            if (searchSourceBuilder == null) {, +                searchSourceBuilder = new SearchSourceBuilder();, +            }, +            searchSourceBuilder.timeout(request.paramAsTime("timeout", null));, +        }, +++ b/src/main/java/org/elasticsearch/search/builder/SearchSourceBuilder.java, +import org.elasticsearch.common.unit.TimeValue;, +    private long timeoutInMillis = -1;, +, +     * An optional timeout to control how long search is allowed to take., +     */, +    public SearchSourceBuilder timeout(TimeValue timeout) {, +        this.timeoutInMillis = timeout.millis();, +        return this;, +    }, +, +    /**, +     * An optional timeout to control how long search is allowed to take., +     */, +    public SearchSourceBuilder timeout(String timeout) {, +        this.timeoutInMillis = TimeValue.parseTimeValue(timeout, null).millis();, +        return this;, +    }, +, +    /**, +        if (timeoutInMillis != -1) {, +            builder.field("timeout", timeoutInMillis);, +        }, +, +++ b/src/main/java/org/elasticsearch/search/internal/ContextIndexSearcher.java, +        if (searchContext.timeoutInMillis() != -1) {, +            collector = new TimeLimitingCollector(collector, TimeLimitingCollector.getGlobalCounter(), searchContext.timeoutInMillis());, +        if (searchContext.timeoutInMillis() != -1) {, +++ b/src/main/java/org/elasticsearch/action/search/SearchRequest.java, +++ b/src/main/java/org/elasticsearch/action/search/type/TransportSearchHelper.java, +++ b/src/main/java/org/elasticsearch/client/action/search/SearchRequestBuilder.java, +        sourceBuilder().timeout(timeout);]
[+++ b/src/main/java/org/elasticsearch/search/highlight/FastVectorHighlighter.java, +                    cache.fieldMatchFieldQuery = new CustomFieldQuery(highlighterContext.query.originalQuery(), hitContext.topLevelReader(), true, field.requireFieldMatch());, +                    cache.noFieldMatchFieldQuery = new CustomFieldQuery(highlighterContext.query.originalQuery(), hitContext.topLevelReader(), true, field.requireFieldMatch());, +++ b/src/main/java/org/elasticsearch/search/highlight/FastVectorHighlighter.java, +                    cache.fieldMatchFieldQuery = new CustomFieldQuery(highlighterContext.query.originalQuery(), hitContext.topLevelReader(), true, field.requireFieldMatch());, +                    cache.noFieldMatchFieldQuery = new CustomFieldQuery(highlighterContext.query.originalQuery(), hitContext.topLevelReader(), true, field.requireFieldMatch());, +++ b/src/main/java/org/elasticsearch/search/highlight/HighlightPhase.java, +                HighlighterContext.HighlightQuery highlightQuery;, +                if (field.highlightQuery() == null) {, +                    highlightQuery = new HighlighterContext.HighlightQuery(context.parsedQuery().query(), context.query(), context.queryRewritten());, +                } else {, +                    highlightQuery = new HighlighterContext.HighlightQuery(field.highlightQuery(), field.highlightQuery(), false);, +++ b/src/main/java/org/elasticsearch/search/highlight/FastVectorHighlighter.java, +                    cache.fieldMatchFieldQuery = new CustomFieldQuery(highlighterContext.query.originalQuery(), hitContext.topLevelReader(), true, field.requireFieldMatch());, +                    cache.noFieldMatchFieldQuery = new CustomFieldQuery(highlighterContext.query.originalQuery(), hitContext.topLevelReader(), true, field.requireFieldMatch());, +++ b/src/main/java/org/elasticsearch/search/highlight/HighlightPhase.java, +                HighlighterContext.HighlightQuery highlightQuery;, +                if (field.highlightQuery() == null) {, +                    highlightQuery = new HighlighterContext.HighlightQuery(context.parsedQuery().query(), context.query(), context.queryRewritten());, +                } else {, +                    highlightQuery = new HighlighterContext.HighlightQuery(field.highlightQuery(), field.highlightQuery(), false);, +++ b/src/main/java/org/elasticsearch/search/highlight/HighlighterContext.java, +    public final HighlightQuery query;, +            FetchSubPhase.HitContext hitContext, HighlightQuery query) {, +        this.query = query;, +    }, +, +    static class HighlightQuery {, +        private final Query originalQuery;, +        private final Query query;, +        private final boolean queryRewritten;, +, +        HighlightQuery(Query originalQuery, Query query, boolean queryRewritten) {, +            this.originalQuery = originalQuery;, +            this.query = query;, +            this.queryRewritten = queryRewritten;, +        }, +, +        public boolean queryRewritten() {, +            return queryRewritten;, +        }, +, +        public Query originalQuery() {, +            return originalQuery;, +        }, +, +        public Query query() {, +            return query;, +        }, +++ b/src/main/java/org/elasticsearch/search/highlight/FastVectorHighlighter.java, +                    cache.fieldMatchFieldQuery = new CustomFieldQuery(highlighterContext.query.originalQuery(), hitContext.topLevelReader(), true, field.requireFieldMatch());, +                    cache.noFieldMatchFieldQuery = new CustomFieldQuery(highlighterContext.query.originalQuery(), hitContext.topLevelReader(), true, field.requireFieldMatch());, +++ b/src/main/java/org/elasticsearch/search/highlight/HighlightPhase.java, +                HighlighterContext.HighlightQuery highlightQuery;, +                if (field.highlightQuery() == null) {, +                    highlightQuery = new HighlighterContext.HighlightQuery(context.parsedQuery().query(), context.query(), context.queryRewritten());, +                } else {, +                    highlightQuery = new HighlighterContext.HighlightQuery(field.highlightQuery(), field.highlightQuery(), false);, +++ b/src/main/java/org/elasticsearch/search/highlight/HighlighterContext.java, +    public final HighlightQuery query;, +            FetchSubPhase.HitContext hitContext, HighlightQuery query) {, +        this.query = query;, +    }, +, +    static class HighlightQuery {, +        private final Query originalQuery;, +        private final Query query;, +        private final boolean queryRewritten;, +, +        HighlightQuery(Query originalQuery, Query query, boolean queryRewritten) {, +            this.originalQuery = originalQuery;, +            this.query = query;, +            this.queryRewritten = queryRewritten;, +        }, +, +        public boolean queryRewritten() {, +            return queryRewritten;, +        }, +, +        public Query originalQuery() {, +            return originalQuery;, +        }, +, +        public Query query() {, +            return query;, +        }, +++ b/src/main/java/org/elasticsearch/search/highlight/PlainHighlighter.java, +            Query query = highlighterContext.query.originalQuery();, +++ b/src/main/java/org/elasticsearch/search/highlight/FastVectorHighlighter.java, +                    cache.fieldMatchFieldQuery = new CustomFieldQuery(highlighterContext.query.originalQuery(), hitContext.topLevelReader(), true, field.requireFieldMatch());, +                    cache.noFieldMatchFieldQuery = new CustomFieldQuery(highlighterContext.query.originalQuery(), hitContext.topLevelReader(), true, field.requireFieldMatch());, +++ b/src/main/java/org/elasticsearch/search/highlight/HighlightPhase.java, +                HighlighterContext.HighlightQuery highlightQuery;, +                if (field.highlightQuery() == null) {, +                    highlightQuery = new HighlighterContext.HighlightQuery(context.parsedQuery().query(), context.query(), context.queryRewritten());, +                } else {, +                    highlightQuery = new HighlighterContext.HighlightQuery(field.highlightQuery(), field.highlightQuery(), false);, +++ b/src/main/java/org/elasticsearch/search/highlight/HighlighterContext.java, +    public final HighlightQuery query;, +            FetchSubPhase.HitContext hitContext, HighlightQuery query) {]
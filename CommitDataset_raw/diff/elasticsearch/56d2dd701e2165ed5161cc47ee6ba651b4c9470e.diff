[+++ b/plugins/mapper-size/src/test/java/org/elasticsearch/index/mapper/size/SizeMappingTests.java, +import org.elasticsearch.index.mapper.MapperService;, +import org.elasticsearch.index.mapper.MetadataFieldMapper;, +import org.elasticsearch.indices.IndicesModule;, +import java.util.HashMap;, +import java.util.Map;, +    MapperService mapperService;, +        Map<String, MetadataFieldMapper.TypeParser> metadataMappers = new HashMap<>();, +        IndicesModule indices = new IndicesModule();, +        indices.registerMetadataMapper(SizeFieldMapper.NAME, new SizeFieldMapper.TypeParser());, +        mapperService = new MapperService(indexService.getIndexSettings(), indexService.analysisService(), indexService.similarityService(), indices.getMapperRegistry());, +        parser = mapperService.documentMapperParser();, +        MapperRegistry mapperRegistry = new MapperRegistry(, +        parser = new DocumentMapperParser(indexService.getIndexSettings(), mapperService,, +        DocumentMapper enabledMapper = mapperService.merge("type", new CompressedXContent(enabledMapping), true, false);, +        DocumentMapper disabledMapper = mapperService.merge("type", new CompressedXContent(disabledMapping), false, false);]
[+++ b/src/main/java/org/elasticsearch/cluster/metadata/MetaData.java, +    public static final String GLOBAL_ONLY_PARAM = "global_only";, +, +    public static final String PERSISTENT_ONLY_PARAM = "persistent_only";, +            boolean globalOnly = params.paramAsBoolean(GLOBAL_ONLY_PARAM, false);, +            boolean persistentOnly = params.paramAsBoolean(PERSISTENT_ONLY_PARAM, false);, +            if (!persistentOnly && !metaData.transientSettings().getAsMap().isEmpty()) {, +            if (!globalOnly && !metaData.indices().isEmpty()) {, +                if (!persistentOnly || factory.isPersistent()) {, +++ b/src/main/java/org/elasticsearch/cluster/metadata/MetaData.java, +    public static final String GLOBAL_ONLY_PARAM = "global_only";, +, +    public static final String PERSISTENT_ONLY_PARAM = "persistent_only";, +            boolean globalOnly = params.paramAsBoolean(GLOBAL_ONLY_PARAM, false);, +            boolean persistentOnly = params.paramAsBoolean(PERSISTENT_ONLY_PARAM, false);, +            if (!persistentOnly && !metaData.transientSettings().getAsMap().isEmpty()) {, +            if (!globalOnly && !metaData.indices().isEmpty()) {, +                if (!persistentOnly || factory.isPersistent()) {, +++ b/src/main/java/org/elasticsearch/gateway/local/state/meta/LocalGatewayMetaState.java, +            globalOnlyParams.put(MetaData.PERSISTENT_ONLY_PARAM, "true");, +            globalOnlyParams.put(MetaData.GLOBAL_ONLY_PARAM, "true");, +            globalOnlyParams.put(MetaData.PERSISTENT_ONLY_PARAM, "true");, +            globalOnlyParams.put(MetaData.GLOBAL_ONLY_PARAM, "true");, +++ b/src/main/java/org/elasticsearch/cluster/metadata/MetaData.java, +    public static final String GLOBAL_ONLY_PARAM = "global_only";, +, +    public static final String PERSISTENT_ONLY_PARAM = "persistent_only";, +            boolean globalOnly = params.paramAsBoolean(GLOBAL_ONLY_PARAM, false);, +            boolean persistentOnly = params.paramAsBoolean(PERSISTENT_ONLY_PARAM, false);, +            if (!persistentOnly && !metaData.transientSettings().getAsMap().isEmpty()) {, +            if (!globalOnly && !metaData.indices().isEmpty()) {, +                if (!persistentOnly || factory.isPersistent()) {, +++ b/src/main/java/org/elasticsearch/gateway/local/state/meta/LocalGatewayMetaState.java, +            globalOnlyParams.put(MetaData.PERSISTENT_ONLY_PARAM, "true");, +            globalOnlyParams.put(MetaData.GLOBAL_ONLY_PARAM, "true");, +            globalOnlyParams.put(MetaData.PERSISTENT_ONLY_PARAM, "true");, +            globalOnlyParams.put(MetaData.GLOBAL_ONLY_PARAM, "true");, +++ b/src/main/java/org/elasticsearch/repositories/blobstore/BlobStoreRepository.java, +        globalOnlyParams.put(MetaData.PERSISTENT_ONLY_PARAM, "true");, +        globalOnlyParams.put(MetaData.GLOBAL_ONLY_PARAM, "true");]
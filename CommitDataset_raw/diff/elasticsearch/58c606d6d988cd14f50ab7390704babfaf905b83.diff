[+++ b/modules/elasticsearch/src/main/java/org/elasticsearch/index/field/data/NumericFieldData.java, +    public abstract void forEachValueInDoc(int docId, MissingDoubleValueInDocProc proc);, +, +    }, +, +    public static interface MissingDoubleValueInDocProc {, +        void onValue(int docId, double value);, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/index/field/data/NumericFieldData.java, +    public abstract void forEachValueInDoc(int docId, MissingDoubleValueInDocProc proc);, +, +    }, +, +    public static interface MissingDoubleValueInDocProc {, +        void onValue(int docId, double value);, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/index/field/data/bytes/MultiValueByteFieldData.java, +        for (int[] ordinal : ordinals) {, +            int loc = ordinal[docId];, +            if (loc != 0) {, +                proc.onValue(docId, values[loc]);, +            }, +        }, +    }, +, +    @Override public void forEachValueInDoc(int docId, MissingDoubleValueInDocProc proc) {, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/index/field/data/NumericFieldData.java, +    public abstract void forEachValueInDoc(int docId, MissingDoubleValueInDocProc proc);, +, +    }, +, +    public static interface MissingDoubleValueInDocProc {, +        void onValue(int docId, double value);, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/index/field/data/bytes/MultiValueByteFieldData.java, +        for (int[] ordinal : ordinals) {, +            int loc = ordinal[docId];, +            if (loc != 0) {, +                proc.onValue(docId, values[loc]);, +            }, +        }, +    }, +, +    @Override public void forEachValueInDoc(int docId, MissingDoubleValueInDocProc proc) {, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/index/field/data/bytes/SingleValueByteFieldData.java, +            return;, +        }, +        proc.onValue(docId, values[loc]);, +    }, +, +    @Override public void forEachValueInDoc(int docId, MissingDoubleValueInDocProc proc) {, +        int loc = ordinals[docId];, +        if (loc == 0) {, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/index/field/data/NumericFieldData.java, +    public abstract void forEachValueInDoc(int docId, MissingDoubleValueInDocProc proc);, +, +    }, +, +    public static interface MissingDoubleValueInDocProc {, +        void onValue(int docId, double value);, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/index/field/data/bytes/MultiValueByteFieldData.java, +        for (int[] ordinal : ordinals) {, +            int loc = ordinal[docId];, +            if (loc != 0) {, +                proc.onValue(docId, values[loc]);, +            }, +        }, +    }, +, +    @Override public void forEachValueInDoc(int docId, MissingDoubleValueInDocProc proc) {, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/index/field/data/bytes/SingleValueByteFieldData.java, +            return;, +        }, +        proc.onValue(docId, values[loc]);, +    }, +, +    @Override public void forEachValueInDoc(int docId, MissingDoubleValueInDocProc proc) {, +        int loc = ordinals[docId];, +        if (loc == 0) {, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/index/field/data/doubles/MultiValueDoubleFieldData.java, +        for (int[] ordinal : ordinals) {, +            int loc = ordinal[docId];, +            if (loc != 0) {, +                proc.onValue(docId, values[loc]);, +            }, +        }, +    }, +, +    @Override public void forEachValueInDoc(int docId, MissingDoubleValueInDocProc proc) {, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/index/field/data/NumericFieldData.java, +    public abstract void forEachValueInDoc(int docId, MissingDoubleValueInDocProc proc);, +, +    }, +, +    public static interface MissingDoubleValueInDocProc {, +        void onValue(int docId, double value);, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/index/field/data/bytes/MultiValueByteFieldData.java, +        for (int[] ordinal : ordinals) {, +            int loc = ordinal[docId];, +            if (loc != 0) {, +                proc.onValue(docId, values[loc]);, +            }, +        }]
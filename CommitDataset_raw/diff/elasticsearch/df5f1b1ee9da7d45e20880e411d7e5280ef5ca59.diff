[+++ b/core/src/main/java/org/elasticsearch/cluster/metadata/AutoExpandReplicas.java, +        // TODO change the following back to be final, https://github.com/elastic/elasticsearch/issues/16097, +        int min;, +        int max;, +++ b/core/src/main/java/org/elasticsearch/cluster/metadata/AutoExpandReplicas.java, +        // TODO change the following back to be final, https://github.com/elastic/elasticsearch/issues/16097, +        int min;, +        int max;, +++ b/core/src/test/java/org/elasticsearch/tribe/TribeIT.java, +                Strings.randomBase64UUID(getRandom()), nodeConfigurationSource, 0, false, SECOND_CLUSTER_NODE_PREFIX, Collections.emptyList());, +++ b/core/src/main/java/org/elasticsearch/cluster/metadata/AutoExpandReplicas.java, +        // TODO change the following back to be final, https://github.com/elastic/elasticsearch/issues/16097, +        int min;, +        int max;, +++ b/core/src/test/java/org/elasticsearch/tribe/TribeIT.java, +                Strings.randomBase64UUID(getRandom()), nodeConfigurationSource, 0, false, SECOND_CLUSTER_NODE_PREFIX, Collections.emptyList());, +++ b/test/framework/src/main/java/org/elasticsearch/test/ESIntegTestCase.java, +                InternalTestCluster.DEFAULT_ENABLE_HTTP_PIPELINING, nodePrefix, mockPlugins);, +++ b/core/src/main/java/org/elasticsearch/cluster/metadata/AutoExpandReplicas.java, +        // TODO change the following back to be final, https://github.com/elastic/elasticsearch/issues/16097, +        int min;, +        int max;, +++ b/core/src/test/java/org/elasticsearch/tribe/TribeIT.java, +                Strings.randomBase64UUID(getRandom()), nodeConfigurationSource, 0, false, SECOND_CLUSTER_NODE_PREFIX, Collections.emptyList());, +++ b/test/framework/src/main/java/org/elasticsearch/test/ESIntegTestCase.java, +                InternalTestCluster.DEFAULT_ENABLE_HTTP_PIPELINING, nodePrefix, mockPlugins);, +++ b/test/framework/src/main/java/org/elasticsearch/test/InternalTestCluster.java, +    static NodeConfigurationSource DEFAULT_SETTINGS_SOURCE = NodeConfigurationSource.EMPTY;, +, +                               boolean enableHttpPipelining, String nodePrefix, Collection<Class<? extends Plugin>> mockPlugins) {, +            if (nodeClient != null) {, +                return nodeClient;, +            return nodeClient = node.client();, +            if (transportClient != null) {, +                return transportClient;, +            }, +            return transportClient = new TransportClientFactory(false, nodeConfigurationSource.transportClientSettings(), baseDir, nodeMode, nodeConfigurationSource.transportClientPlugins()).client(node, clusterName);, +++ b/core/src/main/java/org/elasticsearch/cluster/metadata/AutoExpandReplicas.java, +        // TODO change the following back to be final, https://github.com/elastic/elasticsearch/issues/16097, +        int min;, +        int max;, +++ b/core/src/test/java/org/elasticsearch/tribe/TribeIT.java, +                Strings.randomBase64UUID(getRandom()), nodeConfigurationSource, 0, false, SECOND_CLUSTER_NODE_PREFIX, Collections.emptyList());, +++ b/test/framework/src/main/java/org/elasticsearch/test/ESIntegTestCase.java, +                InternalTestCluster.DEFAULT_ENABLE_HTTP_PIPELINING, nodePrefix, mockPlugins);, +++ b/test/framework/src/main/java/org/elasticsearch/test/InternalTestCluster.java, +    static NodeConfigurationSource DEFAULT_SETTINGS_SOURCE = NodeConfigurationSource.EMPTY;, +, +                               boolean enableHttpPipelining, String nodePrefix, Collection<Class<? extends Plugin>> mockPlugins) {, +            if (nodeClient != null) {, +                return nodeClient;, +            return nodeClient = node.client();, +            if (transportClient != null) {, +                return transportClient;, +            }, +            return transportClient = new TransportClientFactory(false, nodeConfigurationSource.transportClientSettings(), baseDir, nodeMode, nodeConfigurationSource.transportClientPlugins()).client(node, clusterName);, +++ b/test/framework/src/test/java/org/elasticsearch/test/test/InternalTestClusterTests.java, +        InternalTestCluster cluster0 = new InternalTestCluster("local", clusterSeed, baseDir, minNumDataNodes, maxNumDataNodes, clusterName, nodeConfigurationSource, numClientNodes, enableHttpPipelining, nodePrefix, Collections.emptyList());, +        InternalTestCluster cluster1 = new InternalTestCluster("local", clusterSeed, baseDir, minNumDataNodes, maxNumDataNodes, clusterName, nodeConfigurationSource, numClientNodes, enableHttpPipelining, nodePrefix, Collections.emptyList());, +        InternalTestCluster cluster0 = new InternalTestCluster("local", clusterSeed, baseDir, minNumDataNodes, maxNumDataNodes, clusterName1, nodeConfigurationSource, numClientNodes, enableHttpPipelining, nodePrefix, Collections.emptyList());, +        InternalTestCluster cluster1 = new InternalTestCluster("local", clusterSeed, baseDir, minNumDataNodes, maxNumDataNodes, clusterName2, nodeConfigurationSource, numClientNodes, enableHttpPipelining, nodePrefix, Collections.emptyList());]
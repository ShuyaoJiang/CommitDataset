[+++ b/modules/rank-eval/build.gradle, +integTestCluster {, +  // Modules who's integration is explicitly tested in integration tests, +  module project(':modules:lang-mustache'), +}, +, +run {, +  // Modules who's integration is explicitly tested in integration tests, +  module project(':modules:lang-mustache'), +}, +++ b/modules/rank-eval/build.gradle, +integTestCluster {, +  // Modules who's integration is explicitly tested in integration tests, +  module project(':modules:lang-mustache'), +}, +, +run {, +  // Modules who's integration is explicitly tested in integration tests, +  module project(':modules:lang-mustache'), +}, +++ b/modules/rank-eval/src/test/resources/rest-api-spec/test/rank_eval/40_rank_eval_templated.yml, +setup:, +, +  - do:, +     indices.create:, +         index: test, +         body:, +           settings:, +             index:, +               number_of_shards: 1, +  - do:, +      index:, +        index:   test, +        type:    _doc, +        id:      1, +        body:    { "text": "berlin", "title" : "Berlin, Germany" }, +, +  - do:, +      index:, +        index:   test, +        type:    _doc, +        id:      2, +        body:   { "text": "amsterdam" }, +, +  - do:, +      index:, +        index:   test, +        type:    _doc, +        id:      3, +        body:   { "text": "amsterdam" }, +, +  - do:, +      index:, +        index:   test, +        type:    _doc, +        id:      4, +        body:   { "text": "amsterdam" }, +, +  - do:, +      index:, +        index:   test, +        type:    _doc, +        id:      5, +        body:   { "text": "amsterdam" }, +, +  - do:, +      index:, +        index:   test, +        type:    _doc, +        id:      6, +        body:   { "text": "amsterdam" }, +, +  - do:, +      indices.refresh: {}, +, +---, +"Basic rank-eval request with template":, +, +  - skip:, +      version: " - 6.1.99", +      reason: the ranking evaluation feature is available since 6.2, +, +  - do:, +      rank_eval:, +        body: {, +          "templates": [ { "id": "match", "template": {"source": "{\"query\": { \"match\" : {\"text\" : \"{{query_string}}\" }}}" }} ],, +          "requests" : [, +            {, +                "id": "amsterdam_query",, +                "params": { "query_string": "amsterdam" },, +                "template_id": "match",, +                "ratings": [, +                    {"_index": "test", "_id": "2", "rating": 1},, +                    {"_index": "test", "_id": "3", "rating": 1},, +                    {"_index": "test", "_id": "4", "rating": 1},, +                    {"_index": "test", "_id": "5", "rating": 1},], +            },, +            {, +                "id" : "berlin_query",, +                "params": { "query_string": "berlin" },]
[+++ b/src/main/java/org/elasticsearch/index/engine/InternalEngine.java, +    // we use flushNeeded here, since if there are no changes, then the commit won't write, +    // will not really happen, and then the commitUserData and the new translog will not be reflected, +    private volatile boolean flushNeeded = false;, +            flushNeeded = true;, +            flushNeeded = true;, +            flushNeeded = true;, +            flushNeeded = true;, +                if (flushNeeded || force) {, +                    flushNeeded = false;, +                    final long translogId;, +, +++ b/src/main/java/org/elasticsearch/index/engine/InternalEngine.java, +    // we use flushNeeded here, since if there are no changes, then the commit won't write, +    // will not really happen, and then the commitUserData and the new translog will not be reflected, +    private volatile boolean flushNeeded = false;, +            flushNeeded = true;, +            flushNeeded = true;, +            flushNeeded = true;, +            flushNeeded = true;, +                if (flushNeeded || force) {, +                    flushNeeded = false;, +                    final long translogId;, +, +++ b/src/test/java/org/elasticsearch/index/store/CorruptedFileTest.java, +    @AwaitsFix(bugUrl = "https://github.com/elastic/elasticsearch/issues/11226")]
[+++ b/src/test/java/org/elasticsearch/common/compress/CompressedStringTests.java, +import org.apache.lucene.util.TestUtil;, +import java.util.Random;, +    , +    public void testRandom() throws IOException {, +        String compressor = "lzf";, +        CompressorFactory.configure(ImmutableSettings.settingsBuilder().put("compress.default.type", compressor).build());, +        Random r = getRandom();, +        for (int i = 0; i < 2000; i++) {, +            String string = TestUtil.randomUnicodeString(r, 10000);, +            CompressedString compressedString = new CompressedString(string);, +            assertThat(compressedString.string(), equalTo(string));, +        }, +    }]
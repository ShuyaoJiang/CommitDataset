[+++ b/server/src/main/java/org/elasticsearch/common/io/Streams.java, +        // Leverage try-with-resources to close in and out so that exceptions in close() are either propagated or added as suppressed, +        // exceptions to the main exception, +        try (InputStream in2 = in; OutputStream out2 = out) {, +            return doCopy(in2, out2, buffer);, +        }, +    }, +, +    private static long doCopy(InputStream in, OutputStream out, byte[] buffer) throws IOException {, +        try (OutputStream out2 = out) {, +            out2.write(in);, +        // Leverage try-with-resources to close in and out so that exceptions in close() are either propagated or added as suppressed, +        // exceptions to the main exception, +        try (Reader in2 = in; Writer out2 = out) {, +            return doCopy(in2, out2);, +        }, +    }, +, +    private static int doCopy(Reader in, Writer out) throws IOException {, +        try (Writer out2 = out) {, +            out2.write(in);]
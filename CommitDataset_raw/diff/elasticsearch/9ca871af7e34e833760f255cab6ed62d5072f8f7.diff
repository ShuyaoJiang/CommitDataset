[+++ b/modules/reindex/src/test/java/org/elasticsearch/index/reindex/RethrottleTests.java, +import static org.hamcrest.Matchers.both;, +             * With multiple slices these numbers might not add up perfectly, thus the 1.01F. */, +            long unfinished = status.getSliceStatuses().stream(), +                    .filter(slice -> slice != null), +                    .filter(slice -> slice.getStatus().getTotal() > slice.getStatus().getSuccessfullyProcessed()), +                    .count();, +            float maxExpectedSliceRequestsPerSecond = newRequestsPerSecond == Float.POSITIVE_INFINITY ?, +                    Float.POSITIVE_INFINITY : (newRequestsPerSecond / unfinished) * 1.01F;, +            float minExpectedSliceRequestsPerSecond = newRequestsPerSecond == Float.POSITIVE_INFINITY ?, +                    Float.POSITIVE_INFINITY : (newRequestsPerSecond / request.request().getSlices()) * 0.99F;, +                    // This slice reports as not having completed so it should have been processed., +                    assertThat(slice.getRequestsPerSecond(), both(greaterThanOrEqualTo(minExpectedSliceRequestsPerSecond)), +                            .and(lessThanOrEqualTo(maxExpectedSliceRequestsPerSecond)));, +                if (minExpectedSliceRequestsPerSecond <= slice.getRequestsPerSecond(), +                        && slice.getRequestsPerSecond() <= maxExpectedSliceRequestsPerSecond) {]
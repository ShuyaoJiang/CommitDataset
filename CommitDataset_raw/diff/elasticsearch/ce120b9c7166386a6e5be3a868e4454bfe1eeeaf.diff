[+++ b/core/src/main/java/org/elasticsearch/common/network/NetworkUtils.java, +import java.util.HashSet;, + * Utilities for network interfaces / addresses binding and publishing., + * Its only intended for that purpose, not general purpose usage!!!!, +    static void sortAddresses(List<InetAddress> list) {, +    static InetAddress[] getLoopbackAddresses() throws SocketException {, +    static InetAddress[] getFirstNonLoopbackAddresses() throws SocketException {, +    static InetAddress[] getAddressesForInterface(String name) throws SocketException {, +    static InetAddress[] getAllByName(String host) throws UnknownHostException {, +        // deduplicate, in case of resolver misconfiguration, +        // stuff like https://bugzilla.redhat.com/show_bug.cgi?id=496300, +        List<InetAddress> unique = new ArrayList<>(new HashSet<>(Arrays.asList(addresses)));, +        sortAddresses(unique);, +        return unique.toArray(new InetAddress[unique.size()]);, +    static InetAddress[] filterIPV4(InetAddress addresses[]) {, +    static InetAddress[] filterIPV6(InetAddress addresses[]) {, +++ b/core/src/main/java/org/elasticsearch/common/network/NetworkUtils.java, +import java.util.HashSet;, + * Utilities for network interfaces / addresses binding and publishing., + * Its only intended for that purpose, not general purpose usage!!!!, +    static void sortAddresses(List<InetAddress> list) {, +    static InetAddress[] getLoopbackAddresses() throws SocketException {, +    static InetAddress[] getFirstNonLoopbackAddresses() throws SocketException {, +    static InetAddress[] getAddressesForInterface(String name) throws SocketException {, +    static InetAddress[] getAllByName(String host) throws UnknownHostException {, +        // deduplicate, in case of resolver misconfiguration, +        // stuff like https://bugzilla.redhat.com/show_bug.cgi?id=496300, +        List<InetAddress> unique = new ArrayList<>(new HashSet<>(Arrays.asList(addresses)));, +        sortAddresses(unique);, +        return unique.toArray(new InetAddress[unique.size()]);, +    static InetAddress[] filterIPV4(InetAddress addresses[]) {, +    static InetAddress[] filterIPV6(InetAddress addresses[]) {, +++ b/core/src/main/java/org/elasticsearch/search/aggregations/metrics/cardinality/CardinalityAggregatorFactory.java, +final class CardinalityAggregatorFactory extends ValuesSourceAggregatorFactory<ValuesSource> {, +++ b/core/src/main/java/org/elasticsearch/common/network/NetworkUtils.java, +import java.util.HashSet;, + * Utilities for network interfaces / addresses binding and publishing., + * Its only intended for that purpose, not general purpose usage!!!!, +    static void sortAddresses(List<InetAddress> list) {, +    static InetAddress[] getLoopbackAddresses() throws SocketException {, +    static InetAddress[] getFirstNonLoopbackAddresses() throws SocketException {, +    static InetAddress[] getAddressesForInterface(String name) throws SocketException {, +    static InetAddress[] getAllByName(String host) throws UnknownHostException {, +        // deduplicate, in case of resolver misconfiguration, +        // stuff like https://bugzilla.redhat.com/show_bug.cgi?id=496300, +        List<InetAddress> unique = new ArrayList<>(new HashSet<>(Arrays.asList(addresses)));, +        sortAddresses(unique);, +        return unique.toArray(new InetAddress[unique.size()]);, +    static InetAddress[] filterIPV4(InetAddress addresses[]) {, +    static InetAddress[] filterIPV6(InetAddress addresses[]) {, +++ b/core/src/main/java/org/elasticsearch/search/aggregations/metrics/cardinality/CardinalityAggregatorFactory.java, +final class CardinalityAggregatorFactory extends ValuesSourceAggregatorFactory<ValuesSource> {, +++ b/core/src/main/java/org/elasticsearch/transport/netty/NettyTransport.java, +++ b/core/src/main/java/org/elasticsearch/common/network/NetworkUtils.java, +import java.util.HashSet;, + * Utilities for network interfaces / addresses binding and publishing., + * Its only intended for that purpose, not general purpose usage!!!!, +    static void sortAddresses(List<InetAddress> list) {, +    static InetAddress[] getLoopbackAddresses() throws SocketException {, +    static InetAddress[] getFirstNonLoopbackAddresses() throws SocketException {, +    static InetAddress[] getAddressesForInterface(String name) throws SocketException {, +    static InetAddress[] getAllByName(String host) throws UnknownHostException {, +        // deduplicate, in case of resolver misconfiguration, +        // stuff like https://bugzilla.redhat.com/show_bug.cgi?id=496300, +        List<InetAddress> unique = new ArrayList<>(new HashSet<>(Arrays.asList(addresses)));, +        sortAddresses(unique);, +        return unique.toArray(new InetAddress[unique.size()]);, +    static InetAddress[] filterIPV4(InetAddress addresses[]) {, +    static InetAddress[] filterIPV6(InetAddress addresses[]) {, +++ b/core/src/main/java/org/elasticsearch/search/aggregations/metrics/cardinality/CardinalityAggregatorFactory.java, +final class CardinalityAggregatorFactory extends ValuesSourceAggregatorFactory<ValuesSource> {, +++ b/core/src/main/java/org/elasticsearch/transport/netty/NettyTransport.java, +++ b/dev-tools/src/main/resources/ant/integration-tests.xml]
[+++ b/src/main/java/org/elasticsearch/shield/action/ShieldActionFilter.java, +import org.elasticsearch.common.logging.ESLogger;, +import org.elasticsearch.common.logging.Loggers;, +    private static final ESLogger logger = Loggers.getLogger(ShieldActionFilter.class);, +, +            logger.error("Blocking read operation [" + action + "] due to disabled license");, +++ b/src/main/java/org/elasticsearch/shield/action/ShieldActionFilter.java, +import org.elasticsearch.common.logging.ESLogger;, +import org.elasticsearch.common.logging.Loggers;, +    private static final ESLogger logger = Loggers.getLogger(ShieldActionFilter.class);, +, +            logger.error("Blocking read operation [" + action + "] due to disabled license");, +++ b/src/main/java/org/elasticsearch/shield/action/ShieldActionModule.java, +        // we need to ensure that there's only a single instance of this filter., +        bind(ShieldActionFilter.class).asEagerSingleton();, +++ b/src/main/java/org/elasticsearch/shield/action/ShieldActionFilter.java, +import org.elasticsearch.common.logging.ESLogger;, +import org.elasticsearch.common.logging.Loggers;, +    private static final ESLogger logger = Loggers.getLogger(ShieldActionFilter.class);, +, +            logger.error("Blocking read operation [" + action + "] due to disabled license");, +++ b/src/main/java/org/elasticsearch/shield/action/ShieldActionModule.java, +        // we need to ensure that there's only a single instance of this filter., +        bind(ShieldActionFilter.class).asEagerSingleton();, +++ b/src/test/java/org/elasticsearch/integration/LicensingTests.java, +        public InternalLicensesClientService(Settings settings) {, +            enable();]
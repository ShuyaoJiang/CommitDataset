[+++ b/x-pack/docs/en/security/authentication/configuring-saml-realm.asciidoc, +[role="xpack"], +[[configuring-saml-realm]], +=== Configuring a SAML realm, +, +The {stack} supports Security Assertion Markup Language Single Sign On (SAML SSO) , +into {kib} with {es} as a backend service. In particular, the {stack} supports , +the SAML 2.0 Web Browser SSO and the SAML 2.0 Single Logout profiles. It can , +integrate with any identity provider (IdP) that supports at least the SAML 2.0 , +Web Browser SSO Profile. , +, +In SAML terminology, the {stack} is operating as a _service provider_ (SP). For more , +information, see {stack-ov}/saml-realm.html[SAML authentication] and , +{stack-ov}/saml-guide.html[Configuring SAML SSO on the {stack}]. , +, +[NOTE], +--, +, +* If you configure a SAML realm for use in {kib}, you should also configure, +another realm, such as the native realm in your authentication chain., +* These instructions assume that you have an existing SAML identity provider., +--, +, +To enable SAML authentication in {es} and add the {stack} as a service provider:, +, +. Enable SSL/TLS for HTTP. , ++, +--, +If your {es} cluster is operating in production mode, you must, +configure the HTTP interface to use TLS before you can enable SAML , +authentication., +, +See <<tls-http>>., +--, +, +. Enable the Token Service. , ++, +--, +The {es} SAML implementation makes use of the {es} Token Service.  This service, +is automatically enabled if you configure TLS on the HTTP interface. You can , +explicitly enable it by including the following setting in your , +`elasticsearch.yml` file:, +, +[source, yaml], +------------------------------------------------------------, +xpack.security.authc.token.enabled: true, +------------------------------------------------------------, +--, +, +. Configure a SAML IdP metadata file. , ++, +--, +The {stack} uses a standard SAML metadata document in XML format, which defines , +the capabilities and features of your identity provider. You should be able to, +download or generate such a document within your IdP administration interface. , +, +Most IdPs will provide an appropriate metadata file with all the features that, +the {stack} requires. For more information, see , +{stack-ov}/saml-guide-idp.html[The identity provider]., +--, +, +.. Download the IdP metadata document and store it within the `config` directory , +on each {es} node. For example, store it as `config/saml/idp-metadata.xml`., +, +.. Get the identifier for your identity provider. , ++, +--, +The IdP will have been assigned an identifier (_EntityID_ in SAML terminology),, +which is most commonly expressed in Uniform Resource Identifier (URI) form. Your , +admin interface might tell you what this is or you might need to read the , +metadata document to find it. Look for the `entityID` attribute on the, +`EntityDescriptor` element., +--, +, +. Create one or more SAML realms., ++, +--, +SAML authentication is enabled by configuring a SAML realm within the, +authentication chain for {es}., +, +This realm has a few mandatory settings, and a number of optional settings., +The available settings are described in detail in the, +<<ref-saml-settings>>. The following settings (in the `elasticsearch.yml` , +configuration file) are the most common settings:, +, +[source, yaml], +------------------------------------------------------------, +xpack.security.authc.realms.saml1: <1>, +  type: saml <2>, +  order: 2 <3>, +  idp.metadata.path: saml/idp-metadata.xml <4>, +  idp.entity_id: "https://sso.example.com/" <5>, +  sp.entity_id:  "https://kibana.example.com/" <6>, +  sp.acs: "https://kibana.example.com/api/security/v1/saml" <7>, +  sp.logout: "https://kibana.example.com/logout" <8>, +------------------------------------------------------------, +<1> This setting defines a new authentication realm named "saml1". For an , +introduction to realms, see {stack-ov}/realms.html[Realms]. , +<2> The `type` must be `saml`., +<3>  You should define a unique order on each realm in your authentication chain.]
[+++ b/src/main/java/org/elasticsearch/common/lucene/search/function/FiltersFunctionScoreQuery.java, +            float weightSum = 0;, +, +                if (filterFunction.function instanceof WeightFactorFunction) {, +                    weightSum += ((WeightFactorFunction) filterFunction.function).getWeight();, +                } else {, +                    weightSum++;, +                }, +, +                if (weightSum != 0) {, +                        factor /= weightSum;, +                float weightSum = 0;, +                        if (filterFunctions[i].function instanceof WeightFactorFunction) {, +                            weightSum+= ((WeightFactorFunction)filterFunctions[i].function).getWeight();, +                        } else {, +                            weightSum++;, +                }, +                if (weightSum != 0) {, +                        factor /= weightSum;, +++ b/src/main/java/org/elasticsearch/common/lucene/search/function/FiltersFunctionScoreQuery.java, +            float weightSum = 0;, +, +                if (filterFunction.function instanceof WeightFactorFunction) {, +                    weightSum += ((WeightFactorFunction) filterFunction.function).getWeight();, +                } else {, +                    weightSum++;, +                }, +, +                if (weightSum != 0) {, +                        factor /= weightSum;, +                float weightSum = 0;, +                        if (filterFunctions[i].function instanceof WeightFactorFunction) {, +                            weightSum+= ((WeightFactorFunction)filterFunctions[i].function).getWeight();, +                        } else {, +                            weightSum++;, +                }, +                if (weightSum != 0) {, +                        factor /= weightSum;, +++ b/src/test/java/org/elasticsearch/search/functionscore/FunctionScoreTests.java, +        float weightSum = 0;, +, +            weightSum += weights[i];, +            expectedScore /= weightSum;]
[+++ b/x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/security/authz/store/ReservedRolesStore.java, +                        new RoleDescriptor.ApplicationResourcePrivileges[] {, +                            RoleDescriptor.ApplicationResourcePrivileges.builder(), +                                .application("kibana-*").resources("*").privileges("reserved_monitoring").build(), +                        },, +                        null, null, MetadataUtils.DEFAULT_RESERVED_METADATA, null)), +                        new RoleDescriptor.ApplicationResourcePrivileges[] {, +                            RoleDescriptor.ApplicationResourcePrivileges.builder(), +                                .application("kibana-*").resources("*").privileges("reserved_ml").build(), +                        },, +                        null, null, MetadataUtils.DEFAULT_RESERVED_METADATA, null)), +                        new RoleDescriptor.ApplicationResourcePrivileges[] {, +                            RoleDescriptor.ApplicationResourcePrivileges.builder(), +                                .application("kibana-*").resources("*").privileges("reserved_ml").build(), +                        },, +                        null, null, MetadataUtils.DEFAULT_RESERVED_METADATA, null)), +++ b/x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/security/authz/store/ReservedRolesStore.java, +                        new RoleDescriptor.ApplicationResourcePrivileges[] {, +                            RoleDescriptor.ApplicationResourcePrivileges.builder(), +                                .application("kibana-*").resources("*").privileges("reserved_monitoring").build(), +                        },, +                        null, null, MetadataUtils.DEFAULT_RESERVED_METADATA, null)), +                        new RoleDescriptor.ApplicationResourcePrivileges[] {, +                            RoleDescriptor.ApplicationResourcePrivileges.builder(), +                                .application("kibana-*").resources("*").privileges("reserved_ml").build(), +                        },, +                        null, null, MetadataUtils.DEFAULT_RESERVED_METADATA, null)), +                        new RoleDescriptor.ApplicationResourcePrivileges[] {, +                            RoleDescriptor.ApplicationResourcePrivileges.builder(), +                                .application("kibana-*").resources("*").privileges("reserved_ml").build(), +                        },, +                        null, null, MetadataUtils.DEFAULT_RESERVED_METADATA, null)), +++ b/x-pack/plugin/core/src/test/java/org/elasticsearch/xpack/core/security/authz/store/ReservedRolesStoreTests.java, +, +        final String kibanaApplicationWithRandomIndex = "kibana-" + randomFrom(randomAlphaOfLengthBetween(8, 24), ".kibana");, +        assertThat(monitoringUserRole.application().grants(, +            new ApplicationPrivilege(kibanaApplicationWithRandomIndex, "app-foo", "foo"), "*"), is(false));, +        assertThat(monitoringUserRole.application().grants(, +            new ApplicationPrivilege(kibanaApplicationWithRandomIndex, "app-reserved_monitoring", "reserved_monitoring"), "*"), is(true));, +, +        final String otherApplication = "logstash-" + randomAlphaOfLengthBetween(8, 24);, +        assertThat(monitoringUserRole.application().grants(, +            new ApplicationPrivilege(otherApplication, "app-foo", "foo"), "*"), is(false));, +        assertThat(monitoringUserRole.application().grants(, +            new ApplicationPrivilege(otherApplication, "app-reserved_monitoring", "reserved_monitoring"), "*"), is(false));, +, +        final String kibanaApplicationWithRandomIndex = "kibana-" + randomFrom(randomAlphaOfLengthBetween(8, 24), ".kibana");, +        assertThat(role.application().grants(, +            new ApplicationPrivilege(kibanaApplicationWithRandomIndex, "app-foo", "foo"), "*"), is(false));, +        assertThat(role.application().grants(, +            new ApplicationPrivilege(kibanaApplicationWithRandomIndex, "app-reserved_ml", "reserved_ml"), "*"), is(true));, +, +        final String otherApplication = "logstash-" + randomAlphaOfLengthBetween(8, 24);, +        assertThat(role.application().grants(, +            new ApplicationPrivilege(otherApplication, "app-foo", "foo"), "*"), is(false));, +        assertThat(role.application().grants(, +            new ApplicationPrivilege(otherApplication, "app-reserved_ml", "reserved_ml"), "*"), is(false));, +, +, +        final String kibanaApplicationWithRandomIndex = "kibana-" + randomFrom(randomAlphaOfLengthBetween(8, 24), ".kibana");, +        assertThat(role.application().grants(, +            new ApplicationPrivilege(kibanaApplicationWithRandomIndex, "app-foo", "foo"), "*"), is(false));, +        assertThat(role.application().grants(, +            new ApplicationPrivilege(kibanaApplicationWithRandomIndex, "app-reserved_ml", "reserved_ml"), "*"), is(true));, +, +        final String otherApplication = "logstash-" + randomAlphaOfLengthBetween(8, 24);, +        assertThat(role.application().grants(, +            new ApplicationPrivilege(otherApplication, "app-foo", "foo"), "*"), is(false));, +        assertThat(role.application().grants(, +            new ApplicationPrivilege(otherApplication, "app-reserved_ml", "reserved_ml"), "*"), is(false));]
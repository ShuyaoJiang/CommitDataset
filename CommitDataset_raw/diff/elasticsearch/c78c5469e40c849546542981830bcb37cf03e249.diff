[+++ b/src/main/java/org/elasticsearch/indices/recovery/RecoveryTarget.java, +import org.apache.lucene.store.Directory;, +                final Directory directory = store.directory();, +                for (String file : filesToRename) {, +                        directory.deleteFile(file);, +                    } catch (Throwable ex) {, +                        logger.debug("failed to delete file [{}]", ex, file);, +                    }, +                }, +                for (String fileToRename : filesToRename) {, +                    // now, rename the files... and fail it it won't work, +++ b/src/main/java/org/elasticsearch/indices/recovery/RecoveryTarget.java, +import org.apache.lucene.store.Directory;, +                final Directory directory = store.directory();, +                for (String file : filesToRename) {, +                        directory.deleteFile(file);, +                    } catch (Throwable ex) {, +                        logger.debug("failed to delete file [{}]", ex, file);, +                    }, +                }, +                for (String fileToRename : filesToRename) {, +                    // now, rename the files... and fail it it won't work, +++ b/src/test/java/org/elasticsearch/test/store/mock/MockDirectoryHelper.java, +        final long seed = indexSettings.getAsLong(AbstractIntegrationTest.INDEX_SEED_SETTING, 0l);, +        random = new Random(seed);, +        noDeleteOpenFile = indexSettings.getAsBoolean(RANDOM_NO_DELETE_OPEN_FILE, random.nextBoolean()); // true is default in MDW]
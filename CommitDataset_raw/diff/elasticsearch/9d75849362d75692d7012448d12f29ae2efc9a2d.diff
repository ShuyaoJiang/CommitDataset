[+++ b/modules/elasticsearch/src/main/java/org/elasticsearch/transport/netty/NettyTransport.java, +import java.util.*;, +            nodeChannels.close();, +        public synchronized void close() {, +            List<ChannelFuture> futures = new ArrayList<ChannelFuture>();, +            closeChannelsAndWait(low, futures);, +            closeChannelsAndWait(med, futures);, +            closeChannelsAndWait(high, futures);, +            for (ChannelFuture future : futures) {, +                future.awaitUninterruptibly();, +            }, +        private void closeChannelsAndWait(Channel[] channels, List<ChannelFuture> futures) {, +                        futures.add(channel.close());]
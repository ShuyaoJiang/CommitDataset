[+++ b/src/main/java/org/elasticsearch/search/aggregations/metrics/cardinality/CardinalityAggregator.java, +            if (maxOrd == 0) {, +                return new EmptyCollector();, +            }, +, +    private static class EmptyCollector implements Collector {, +, +        @Override, +        public void collect(int doc, long bucketOrd) {, +            // no-op, +        }, +, +        @Override, +        public void postCollect() {, +            // no-op, +        }, +, +        @Override, +        public void close() throws ElasticsearchException {, +            // no-op, +        }, +    }, +, +++ b/src/main/java/org/elasticsearch/search/aggregations/metrics/cardinality/CardinalityAggregator.java, +            if (maxOrd == 0) {, +                return new EmptyCollector();, +            }, +, +    private static class EmptyCollector implements Collector {, +, +        @Override, +        public void collect(int doc, long bucketOrd) {, +            // no-op, +        }, +, +        @Override, +        public void postCollect() {, +            // no-op, +        }, +, +        @Override, +        public void close() throws ElasticsearchException {, +            // no-op, +        }, +    }, +, +++ b/src/test/java/org/elasticsearch/search/aggregations/metrics/CardinalityTests.java, +, +        IndexRequestBuilder[] dummyDocsBuilder = new IndexRequestBuilder[10];, +        for (int i = 0; i < dummyDocsBuilder.length; i++) {, +            dummyDocsBuilder[i] = client().prepareIndex("idx", "type").setSource("a_field", "1");, +        }, +        indexRandom(true, dummyDocsBuilder);, +]
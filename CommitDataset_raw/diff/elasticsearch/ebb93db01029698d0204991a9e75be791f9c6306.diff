[+++ b/core/src/main/java/org/elasticsearch/index/engine/InternalEngine.java, +        if (origin == Operation.Origin.PRIMARY) {, +        } else {, +            if (index.seqNo() <= seqNoService.getLocalCheckpoint()){, +        assert plan.seqNoForIndexing >= 0 : "ops should have an assigned seq no.; origin: " + index.origin();, +        if (delete.seqNo() <= seqNoService.getLocalCheckpoint()) {, +++ b/core/src/main/java/org/elasticsearch/index/engine/InternalEngine.java, +        if (origin == Operation.Origin.PRIMARY) {, +        } else {, +            if (index.seqNo() <= seqNoService.getLocalCheckpoint()){, +        assert plan.seqNoForIndexing >= 0 : "ops should have an assigned seq no.; origin: " + index.origin();, +        if (delete.seqNo() <= seqNoService.getLocalCheckpoint()) {, +++ b/core/src/test/java/org/elasticsearch/index/engine/InternalEngineTests.java]
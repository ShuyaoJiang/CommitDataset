[+++ b/plugins/ingest/src/main/java/org/elasticsearch/ingest/Data.java, +        if (path == null || path.length() == 0) {, +            return false;, +        }, +, +     * nested maps will be put in as parent key values until, +        if (path == null || path.length() == 0) {, +            throw new IllegalArgumentException("cannot add null or empty field");, +        }, +        if (value == null) {, +            throw new IllegalArgumentException("cannot add null value to field [" + path + "]");, +        }, +        assert pathElements.length > 0;, +++ b/plugins/ingest/src/main/java/org/elasticsearch/ingest/Data.java, +        if (path == null || path.length() == 0) {, +            return false;, +        }, +, +     * nested maps will be put in as parent key values until, +        if (path == null || path.length() == 0) {, +            throw new IllegalArgumentException("cannot add null or empty field");, +        }, +        if (value == null) {, +            throw new IllegalArgumentException("cannot add null value to field [" + path + "]");, +        }, +        assert pathElements.length > 0;, +++ b/plugins/ingest/src/test/java/org/elasticsearch/ingest/DataTests.java, +    public void testGetPropertyNull() {, +        assertNull(data.getProperty(null));, +    }, +, +    public void testGetPropertyEmpty() {, +        assertNull(data.getProperty(""));, +    }, +, +    public void testContainsPropertyNull() {, +        assertFalse(data.containsProperty(null));, +    }, +, +    public void testContainsPropertyEmpty() {, +        assertFalse(data.containsProperty(""));, +    }, +, +            fail("add field should have failed");, +    public void testAddFieldNullName() {, +        try {, +            data.addField(null, "bar");, +            fail("add field should have failed");, +        } catch(IllegalArgumentException e) {, +            assertThat(e.getMessage(), equalTo("cannot add null or empty field"));, +        }, +    }, +, +    public void testAddFieldEmptyName() {, +        try {, +            data.addField("", "bar");, +            fail("add field should have failed");, +        } catch(IllegalArgumentException e) {, +            assertThat(e.getMessage(), equalTo("cannot add null or empty field"));, +        }, +    }, +, +    public void testAddFieldNullValue() {, +        try {, +            data.addField("new_field", null);, +            fail("add field should have failed");, +        } catch(IllegalArgumentException e) {, +            assertThat(e.getMessage(), equalTo("cannot add null value to field [new_field]"));, +        }, +    }, +]
[+++ b/src/main/java/org/elasticsearch/common/geo/GeoHashUtils.java, +            if (nx >= 0 && nx <= xLimit && ny >= 0 && ny <= yLimit) {, +++ b/src/main/java/org/elasticsearch/common/geo/GeoHashUtils.java, +            if (nx >= 0 && nx <= xLimit && ny >= 0 && ny <= yLimit) {, +++ b/src/test/java/org/elasticsearch/index/search/geo/GeoHashUtilsTests.java, +import java.util.ArrayList;, +import java.util.Collection;, +import java.util.List;, +, +    @Test, +    public void testNeighbours() {, +        String geohash = "gcpv";, +        List<String> expectedNeighbors = new ArrayList<>();, +        expectedNeighbors.add("gcpw");, +        expectedNeighbors.add("gcpy");, +        expectedNeighbors.add("u10n");, +        expectedNeighbors.add("gcpt");, +        expectedNeighbors.add("u10j");, +        expectedNeighbors.add("gcps");, +        expectedNeighbors.add("gcpu");, +        expectedNeighbors.add("u10h");, +        Collection<? super String> neighbors = new ArrayList<>();, +        GeoHashUtils.addNeighbors(geohash, neighbors );, +        assertEquals(expectedNeighbors, neighbors);, +    }]
[+++ b/x-pack/docs/en/security/authentication/active-directory-realm.asciidoc, +See {ref}/configuring-ad-realm.html[Configuring an Active Directory Realm]., +See {ref}/configuring-ad-realm.html[Configuring an Active Directory realm]. , +, +properties are populated in the user's _metadata_:, +This metadata is returned in the , +{ref}/security-api-authenticate.html[authenticate API] and can be used with, +<<templating-role-query, templated queries>> in roles., +, +See , +{ref}/configuring-tls.html#tls-active-directory[Encrypting communications between {es} and Active Directory]., +++ b/x-pack/docs/en/security/authentication/active-directory-realm.asciidoc, +See {ref}/configuring-ad-realm.html[Configuring an Active Directory Realm]., +See {ref}/configuring-ad-realm.html[Configuring an Active Directory realm]. , +, +properties are populated in the user's _metadata_:, +This metadata is returned in the , +{ref}/security-api-authenticate.html[authenticate API] and can be used with, +<<templating-role-query, templated queries>> in roles., +, +See , +{ref}/configuring-tls.html#tls-active-directory[Encrypting communications between {es} and Active Directory]., +++ b/x-pack/docs/en/security/authentication/configuring-active-directory-realm.asciidoc, +[role="xpack"], +[[configuring-ad-realm]], +=== Configuring an Active Directory realm, +, +You can configure {security} to communicate with Active Directory to authenticate, +users. To integrate with Active Directory, you configure an `active_directory`, +realm and map Active Directory users and groups to {security} roles in the role , +mapping file., +, +For more information about Active Directory realms, see , +{xpack-ref}/active-directory-realm.html[Active Directory User Authentication]., +, +. Add a realm configuration of type `active_directory` to `elasticsearch.yml`, +under the `xpack.security.authc.realms` namespace. At a minimum, you must set , +the realm `type` to `active_directory` and specify the Active Directory , +`domain_name`. If you are configuring multiple realms, you should also , +explicitly set the `order` attribute to control the order in which the realms , +are consulted during authentication. , ++, +--, +See <<ref-ad-settings>> for all of the options you can set for an , +`active_directory` realm., +, +NOTE: Binding to Active Directory fails if the domain name is not mapped in DNS., +      If DNS is not being provided by a Windows DNS server, add a mapping for, +      the domain in the local `/etc/hosts` file., +, +For example, the following realm configuration configures {security} to connect, +to `ldaps://example.com:636` to authenticate users through Active Directory:, +, +[source, yaml], +------------------------------------------------------------, +xpack:, +  security:, +    authc:, +      realms:, +        active_directory:, +          type: active_directory, +          order: 0 <1>, +          domain_name: ad.example.com, +          url: ldaps://ad.example.com:636 <2>, +------------------------------------------------------------, +<1> The realm order controls the order in which the configured realms are checked, +    when authenticating a user., +<2> If you don't specify the URL, it defaults to `ldap:<domain_name>:389`., +, +IMPORTANT: When you configure realms in `elasticsearch.yml`, only the, +realms you specify are used for authentication. If you also want to use the, +`native` or `file` realms, you must include them in the realm chain., +--, +, +. If you are authenticating users across multiple domains in a forest, extra , +steps are required. There are a few minor differences in the configuration and , +the way that users authenticate. , ++, +--, +Set the `domain_name` setting to the forest root domain name. , +, +You must also set the `url` setting, since you must authenticate against the , +Global Catalog, which uses a different port and might not be running on every , +Domain Controller., +, +For example, the following realm configuration configures {security} to connect , +to specific Domain Controllers on the Global Catalog port with the domain name , +set to the forest root:, +, +[source, yaml], +------------------------------------------------------------, +xpack:, +  security:, +    authc:, +      realms:, +        active_directory:, +          type: active_directory, +          order: 0, +          domain_name: example.com <1>, +          url: ldaps://dc1.ad.example.com:3269, ldaps://dc2.ad.example.com:3269 <2>]
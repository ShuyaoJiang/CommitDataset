[+++ b/src/main/java/org/elasticsearch/action/admin/indices/validate/query/TransportValidateQueryAction.java, +        return clusterService.operationRouting().searchShards(clusterState, request.indices(), concreteIndices, routingMap, "_local");, +++ b/src/main/java/org/elasticsearch/action/admin/indices/validate/query/TransportValidateQueryAction.java, +        return clusterService.operationRouting().searchShards(clusterState, request.indices(), concreteIndices, routingMap, "_local");, +++ b/src/main/java/org/elasticsearch/action/count/CountRequest.java, +        routing = in.readOptionalString();, +        types = in.readStringArray();, +        out.writeOptionalString(routing);, +        out.writeStringArray(types);, +++ b/src/main/java/org/elasticsearch/action/admin/indices/validate/query/TransportValidateQueryAction.java, +        return clusterService.operationRouting().searchShards(clusterState, request.indices(), concreteIndices, routingMap, "_local");, +++ b/src/main/java/org/elasticsearch/action/count/CountRequest.java, +        routing = in.readOptionalString();, +        types = in.readStringArray();, +        out.writeOptionalString(routing);, +        out.writeStringArray(types);, +++ b/src/main/java/org/elasticsearch/action/count/CountRequestBuilder.java, +++ b/src/main/java/org/elasticsearch/action/admin/indices/validate/query/TransportValidateQueryAction.java, +        return clusterService.operationRouting().searchShards(clusterState, request.indices(), concreteIndices, routingMap, "_local");, +++ b/src/main/java/org/elasticsearch/action/count/CountRequest.java, +        routing = in.readOptionalString();, +        types = in.readStringArray();, +        out.writeOptionalString(routing);, +        out.writeStringArray(types);, +++ b/src/main/java/org/elasticsearch/action/count/CountRequestBuilder.java, +++ b/src/main/java/org/elasticsearch/action/count/TransportCountAction.java, +        return clusterService.operationRouting().searchShards(clusterState, request.indices(), concreteIndices, routingMap, null);, +++ b/src/main/java/org/elasticsearch/action/admin/indices/validate/query/TransportValidateQueryAction.java, +        return clusterService.operationRouting().searchShards(clusterState, request.indices(), concreteIndices, routingMap, "_local");, +++ b/src/main/java/org/elasticsearch/action/count/CountRequest.java, +        routing = in.readOptionalString();, +        types = in.readStringArray();, +        out.writeOptionalString(routing);, +        out.writeStringArray(types);, +++ b/src/main/java/org/elasticsearch/action/count/CountRequestBuilder.java, +++ b/src/main/java/org/elasticsearch/action/count/TransportCountAction.java, +        return clusterService.operationRouting().searchShards(clusterState, request.indices(), concreteIndices, routingMap, null);, +++ b/src/main/java/org/elasticsearch/action/search/MultiSearchRequest.java, +++ b/src/main/java/org/elasticsearch/action/admin/indices/validate/query/TransportValidateQueryAction.java, +        return clusterService.operationRouting().searchShards(clusterState, request.indices(), concreteIndices, routingMap, "_local");, +++ b/src/main/java/org/elasticsearch/action/count/CountRequest.java, +        routing = in.readOptionalString();, +        types = in.readStringArray();, +        out.writeOptionalString(routing);, +        out.writeStringArray(types);, +++ b/src/main/java/org/elasticsearch/action/count/CountRequestBuilder.java, +++ b/src/main/java/org/elasticsearch/action/count/TransportCountAction.java, +        return clusterService.operationRouting().searchShards(clusterState, request.indices(), concreteIndices, routingMap, null);, +++ b/src/main/java/org/elasticsearch/action/search/MultiSearchRequest.java, +++ b/src/main/java/org/elasticsearch/action/search/SearchRequest.java, +++ b/src/main/java/org/elasticsearch/action/admin/indices/validate/query/TransportValidateQueryAction.java, +        return clusterService.operationRouting().searchShards(clusterState, request.indices(), concreteIndices, routingMap, "_local");, +++ b/src/main/java/org/elasticsearch/action/count/CountRequest.java, +        routing = in.readOptionalString();, +        types = in.readStringArray();, +        out.writeOptionalString(routing);, +        out.writeStringArray(types);, +++ b/src/main/java/org/elasticsearch/action/count/CountRequestBuilder.java, +++ b/src/main/java/org/elasticsearch/action/count/TransportCountAction.java, +        return clusterService.operationRouting().searchShards(clusterState, request.indices(), concreteIndices, routingMap, null);, +++ b/src/main/java/org/elasticsearch/action/search/MultiSearchRequest.java, +++ b/src/main/java/org/elasticsearch/action/search/SearchRequest.java, +++ b/src/main/java/org/elasticsearch/action/search/SearchRequestBuilder.java, +++ b/src/main/java/org/elasticsearch/action/admin/indices/validate/query/TransportValidateQueryAction.java, +        return clusterService.operationRouting().searchShards(clusterState, request.indices(), concreteIndices, routingMap, "_local");, +++ b/src/main/java/org/elasticsearch/action/count/CountRequest.java, +        routing = in.readOptionalString();, +        types = in.readStringArray();, +        out.writeOptionalString(routing);, +        out.writeStringArray(types);, +++ b/src/main/java/org/elasticsearch/action/count/CountRequestBuilder.java, +++ b/src/main/java/org/elasticsearch/action/count/TransportCountAction.java, +        return clusterService.operationRouting().searchShards(clusterState, request.indices(), concreteIndices, routingMap, null);, +++ b/src/main/java/org/elasticsearch/action/search/MultiSearchRequest.java, +++ b/src/main/java/org/elasticsearch/action/search/SearchRequest.java, +++ b/src/main/java/org/elasticsearch/action/search/SearchRequestBuilder.java, +++ b/src/main/java/org/elasticsearch/action/search/TransportSearchAction.java, +                int shardCount = clusterService.operationRouting().searchShardsCount(clusterState, searchRequest.indices(), concreteIndices, routingMap, searchRequest.preference());, +++ b/src/main/java/org/elasticsearch/action/admin/indices/validate/query/TransportValidateQueryAction.java, +        return clusterService.operationRouting().searchShards(clusterState, request.indices(), concreteIndices, routingMap, "_local");, +++ b/src/main/java/org/elasticsearch/action/count/CountRequest.java, +        routing = in.readOptionalString();, +        types = in.readStringArray();, +        out.writeOptionalString(routing);, +        out.writeStringArray(types);, +++ b/src/main/java/org/elasticsearch/action/count/CountRequestBuilder.java, +++ b/src/main/java/org/elasticsearch/action/count/TransportCountAction.java, +        return clusterService.operationRouting().searchShards(clusterState, request.indices(), concreteIndices, routingMap, null);, +++ b/src/main/java/org/elasticsearch/action/search/MultiSearchRequest.java, +++ b/src/main/java/org/elasticsearch/action/search/SearchRequest.java, +++ b/src/main/java/org/elasticsearch/action/search/SearchRequestBuilder.java, +++ b/src/main/java/org/elasticsearch/action/search/TransportSearchAction.java, +                int shardCount = clusterService.operationRouting().searchShardsCount(clusterState, searchRequest.indices(), concreteIndices, routingMap, searchRequest.preference());, +++ b/src/main/java/org/elasticsearch/action/search/type/TransportSearchTypeAction.java, +            shardsIts = clusterService.operationRouting().searchShards(clusterState, request.indices(), concreteIndices, routingMap, request.preference());, +++ b/src/main/java/org/elasticsearch/action/admin/indices/validate/query/TransportValidateQueryAction.java, +        return clusterService.operationRouting().searchShards(clusterState, request.indices(), concreteIndices, routingMap, "_local");, +++ b/src/main/java/org/elasticsearch/action/count/CountRequest.java, +        routing = in.readOptionalString();, +        types = in.readStringArray();]
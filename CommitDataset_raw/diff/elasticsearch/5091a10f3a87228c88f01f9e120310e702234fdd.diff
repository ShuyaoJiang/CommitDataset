[+++ b/core/src/test/java/org/elasticsearch/test/InternalTestCluster.java, +    /**, +     * The number of ports in the range used for this JVM, +     */, +    public static final int PORTS_PER_JVM = 100;, +, +    public static final int BASE_PORT = 9300 + PORTS_PER_JVM * (JVM_ORDINAL + 1);, +++ b/core/src/test/java/org/elasticsearch/test/InternalTestCluster.java, +    /**, +     * The number of ports in the range used for this JVM, +     */, +    public static final int PORTS_PER_JVM = 100;, +, +    public static final int BASE_PORT = 9300 + PORTS_PER_JVM * (JVM_ORDINAL + 1);, +++ b/core/src/test/java/org/elasticsearch/test/discovery/ClusterDiscoveryConfiguration.java, +            final int maxPort = basePort + InternalTestCluster.PORTS_PER_JVM;, +                while (tries < InternalTestCluster.PORTS_PER_JVM && !foundPortInRange) {]
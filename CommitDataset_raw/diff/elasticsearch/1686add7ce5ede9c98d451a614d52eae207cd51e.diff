[+++ b/plugin/src/main/java/org/elasticsearch/xpack/security/Security.java, +import java.io.IOException;, +import java.security.GeneralSecurityException;, +import java.time.Clock;, +import java.util.ArrayList;, +import java.util.Arrays;, +import java.util.Collection;, +import java.util.Collections;, +import java.util.HashMap;, +import java.util.LinkedHashSet;, +import java.util.List;, +import java.util.Map;, +import java.util.Optional;, +import java.util.Set;, +import java.util.function.BiConsumer;, +import java.util.function.Function;, +import java.util.function.Supplier;, +import java.util.function.UnaryOperator;, +import java.util.stream.Collectors;, +, +import org.elasticsearch.common.util.CollectionUtils;, +            final ArrayList<BootstrapCheck> checks = CollectionUtils.arrayAsArrayList(, +            checks.addAll(InternalRealms.getBootstrapChecks(settings));, +            return checks;, +++ b/plugin/src/main/java/org/elasticsearch/xpack/security/Security.java, +import java.io.IOException;, +import java.security.GeneralSecurityException;, +import java.time.Clock;, +import java.util.ArrayList;, +import java.util.Arrays;, +import java.util.Collection;, +import java.util.Collections;, +import java.util.HashMap;, +import java.util.LinkedHashSet;, +import java.util.List;, +import java.util.Map;, +import java.util.Optional;, +import java.util.Set;, +import java.util.function.BiConsumer;, +import java.util.function.Function;, +import java.util.function.Supplier;, +import java.util.function.UnaryOperator;, +import java.util.stream.Collectors;, +, +import org.elasticsearch.common.util.CollectionUtils;, +            final ArrayList<BootstrapCheck> checks = CollectionUtils.arrayAsArrayList(, +            checks.addAll(InternalRealms.getBootstrapChecks(settings));, +            return checks;, +++ b/plugin/src/main/java/org/elasticsearch/xpack/security/authc/InternalRealms.java, +import java.util.ArrayList;, +import java.util.Arrays;, +import java.util.Collections;, +import java.util.HashMap;, +import java.util.HashSet;, +import java.util.List;, +import java.util.Map;, +import java.util.Set;, +, +import org.elasticsearch.bootstrap.BootstrapCheck;, +import org.elasticsearch.common.settings.Settings;, +import org.elasticsearch.xpack.security.authc.support.RoleMappingFileBootstrapCheck;, +    public static List<BootstrapCheck> getBootstrapChecks(final Settings globalSettings) {, +        final List<BootstrapCheck> checks = new ArrayList<>();, +        final Map<String, Settings> settingsByRealm = RealmSettings.getRealmSettings(globalSettings);, +        settingsByRealm.forEach((name, settings) -> {, +            final RealmConfig realmConfig = new RealmConfig(name, settings, globalSettings, null);, +            switch (realmConfig.type()) {, +                case LdapRealm.AD_TYPE:, +                case LdapRealm.LDAP_TYPE:, +                case PkiRealm.TYPE:, +                    final BootstrapCheck check = RoleMappingFileBootstrapCheck.create(realmConfig);, +                    if (check != null) {, +                        checks.add(check);, +                    }, +            }, +        });, +        return checks;, +    }, +++ b/plugin/src/main/java/org/elasticsearch/xpack/security/Security.java, +import java.io.IOException;, +import java.security.GeneralSecurityException;, +import java.time.Clock;, +import java.util.ArrayList;, +import java.util.Arrays;, +import java.util.Collection;, +import java.util.Collections;, +import java.util.HashMap;, +import java.util.LinkedHashSet;, +import java.util.List;, +import java.util.Map;, +import java.util.Optional;, +import java.util.Set;, +import java.util.function.BiConsumer;, +import java.util.function.Function;, +import java.util.function.Supplier;, +import java.util.function.UnaryOperator;, +import java.util.stream.Collectors;, +, +import org.elasticsearch.common.util.CollectionUtils;, +            final ArrayList<BootstrapCheck> checks = CollectionUtils.arrayAsArrayList(]
[+++ b/src/main/java/org/elasticsearch/index/search/geo/GeoDistanceRangeFilter.java, +import org.apache.lucene.index.AtomicReaderContext;, +import org.apache.lucene.util.Bits;, +    public DocIdSet getDocIdSet(AtomicReaderContext context, Bits acceptedDocs) throws IOException {, +            DocIdSet docIdSet = boundingBoxFilter.getDocIdSet(context, acceptedDocs);, +            boundingBoxDocSet = DocSets.convert(context.reader(), docIdSet);, +        final GeoPointFieldData fieldData = (GeoPointFieldData) fieldDataCache.cache(GeoPointFieldDataType.TYPE, context.reader(), fieldName);, +        GeoDistanceRangeDocSet distDocSet = new GeoDistanceRangeDocSet(context.reader().maxDoc(), fieldData, fixedSourceDistance, distanceBoundingCheck, inclusiveLowerPoint, inclusiveUpperPoint);, +++ b/src/main/java/org/elasticsearch/index/search/geo/GeoDistanceRangeFilter.java, +import org.apache.lucene.index.AtomicReaderContext;, +import org.apache.lucene.util.Bits;, +    public DocIdSet getDocIdSet(AtomicReaderContext context, Bits acceptedDocs) throws IOException {, +            DocIdSet docIdSet = boundingBoxFilter.getDocIdSet(context, acceptedDocs);, +            boundingBoxDocSet = DocSets.convert(context.reader(), docIdSet);, +        final GeoPointFieldData fieldData = (GeoPointFieldData) fieldDataCache.cache(GeoPointFieldDataType.TYPE, context.reader(), fieldName);, +        GeoDistanceRangeDocSet distDocSet = new GeoDistanceRangeDocSet(context.reader().maxDoc(), fieldData, fixedSourceDistance, distanceBoundingCheck, inclusiveLowerPoint, inclusiveUpperPoint);, +++ b/src/main/java/org/elasticsearch/index/search/geo/GeoPolygonFilter.java, +import org.apache.lucene.index.AtomicReaderContext;, +import org.apache.lucene.util.Bits;, +    public DocIdSet getDocIdSet(AtomicReaderContext context, Bits acceptedDocs) throws IOException {, +        final GeoPointFieldData fieldData = (GeoPointFieldData) fieldDataCache.cache(GeoPointFieldDataType.TYPE, context.reader(), fieldName);, +        return new GeoPolygonDocSet(context.reader().maxDoc(), fieldData, points);]
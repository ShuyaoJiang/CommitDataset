[+++ b/core/src/main/java/org/apache/lucene/queries/BlendedTermQuery.java, + * {@link org.apache.lucene.search.similarities.DefaultSimilarity}, +++ b/core/src/main/java/org/apache/lucene/queries/BlendedTermQuery.java, + * {@link org.apache.lucene.search.similarities.DefaultSimilarity}, +++ b/core/src/main/java/org/elasticsearch/action/termvectors/TermVectorsFilter.java, +import org.apache.lucene.search.similarities.DefaultSimilarity;, +        this.similarity = new DefaultSimilarity();, +++ b/core/src/main/java/org/apache/lucene/queries/BlendedTermQuery.java, + * {@link org.apache.lucene.search.similarities.DefaultSimilarity}, +++ b/core/src/main/java/org/elasticsearch/action/termvectors/TermVectorsFilter.java, +import org.apache.lucene.search.similarities.DefaultSimilarity;, +        this.similarity = new DefaultSimilarity();, +++ b/core/src/main/java/org/elasticsearch/cluster/ClusterModule.java, +++ b/core/src/main/java/org/apache/lucene/queries/BlendedTermQuery.java, + * {@link org.apache.lucene.search.similarities.DefaultSimilarity}, +++ b/core/src/main/java/org/elasticsearch/action/termvectors/TermVectorsFilter.java, +import org.apache.lucene.search.similarities.DefaultSimilarity;, +        this.similarity = new DefaultSimilarity();, +++ b/core/src/main/java/org/elasticsearch/cluster/ClusterModule.java, +++ b/core/src/main/java/org/elasticsearch/common/lucene/search/MoreLikeThisQuery.java, +import org.apache.lucene.search.similarities.DefaultSimilarity;, +        XMoreLikeThis mlt = new XMoreLikeThis(reader, similarity == null ? new DefaultSimilarity() : similarity);, +++ b/core/src/main/java/org/apache/lucene/queries/BlendedTermQuery.java, + * {@link org.apache.lucene.search.similarities.DefaultSimilarity}, +++ b/core/src/main/java/org/elasticsearch/action/termvectors/TermVectorsFilter.java, +import org.apache.lucene.search.similarities.DefaultSimilarity;, +        this.similarity = new DefaultSimilarity();, +++ b/core/src/main/java/org/elasticsearch/cluster/ClusterModule.java, +++ b/core/src/main/java/org/elasticsearch/common/lucene/search/MoreLikeThisQuery.java, +import org.apache.lucene.search.similarities.DefaultSimilarity;, +        XMoreLikeThis mlt = new XMoreLikeThis(reader, similarity == null ? new DefaultSimilarity() : similarity);, +++ b/core/src/main/java/org/elasticsearch/common/lucene/search/Queries.java, +        return (optionalClauseCount < result ?, +                optionalClauseCount : (result < 0 ? 0 : result));, +, +++ b/core/src/main/java/org/apache/lucene/queries/BlendedTermQuery.java, + * {@link org.apache.lucene.search.similarities.DefaultSimilarity}, +++ b/core/src/main/java/org/elasticsearch/action/termvectors/TermVectorsFilter.java, +import org.apache.lucene.search.similarities.DefaultSimilarity;, +        this.similarity = new DefaultSimilarity();, +++ b/core/src/main/java/org/elasticsearch/cluster/ClusterModule.java, +++ b/core/src/main/java/org/elasticsearch/common/lucene/search/MoreLikeThisQuery.java, +import org.apache.lucene.search.similarities.DefaultSimilarity;, +        XMoreLikeThis mlt = new XMoreLikeThis(reader, similarity == null ? new DefaultSimilarity() : similarity);, +++ b/core/src/main/java/org/elasticsearch/common/lucene/search/Queries.java, +        return (optionalClauseCount < result ?, +                optionalClauseCount : (result < 0 ? 0 : result));, +, +++ b/core/src/main/java/org/elasticsearch/common/lucene/search/XMoreLikeThis.java, +import org.apache.lucene.search.similarities.DefaultSimilarity;, +    private TFIDFSimilarity similarity;// = new DefaultSimilarity();, +        this(ir, new DefaultSimilarity());, +++ b/core/src/main/java/org/apache/lucene/queries/BlendedTermQuery.java, + * {@link org.apache.lucene.search.similarities.DefaultSimilarity}, +++ b/core/src/main/java/org/elasticsearch/action/termvectors/TermVectorsFilter.java, +import org.apache.lucene.search.similarities.DefaultSimilarity;, +        this.similarity = new DefaultSimilarity();, +++ b/core/src/main/java/org/elasticsearch/cluster/ClusterModule.java, +++ b/core/src/main/java/org/elasticsearch/common/lucene/search/MoreLikeThisQuery.java, +import org.apache.lucene.search.similarities.DefaultSimilarity;, +        XMoreLikeThis mlt = new XMoreLikeThis(reader, similarity == null ? new DefaultSimilarity() : similarity);, +++ b/core/src/main/java/org/elasticsearch/common/lucene/search/Queries.java, +        return (optionalClauseCount < result ?, +                optionalClauseCount : (result < 0 ? 0 : result));, +, +++ b/core/src/main/java/org/elasticsearch/common/lucene/search/XMoreLikeThis.java, +import org.apache.lucene.search.similarities.DefaultSimilarity;, +    private TFIDFSimilarity similarity;// = new DefaultSimilarity();, +        this(ir, new DefaultSimilarity());, +++ b/core/src/main/java/org/elasticsearch/index/mapper/core/TypeParsers.java, +                builder.similarity(parserContext.getSimilarity(propNode.toString()));, +                builder.similarity(parserContext.getSimilarity(propNode.toString()));, +++ b/core/src/main/java/org/apache/lucene/queries/BlendedTermQuery.java, + * {@link org.apache.lucene.search.similarities.DefaultSimilarity}, +++ b/core/src/main/java/org/elasticsearch/action/termvectors/TermVectorsFilter.java, +import org.apache.lucene.search.similarities.DefaultSimilarity;, +        this.similarity = new DefaultSimilarity();, +++ b/core/src/main/java/org/elasticsearch/cluster/ClusterModule.java, +++ b/core/src/main/java/org/elasticsearch/common/lucene/search/MoreLikeThisQuery.java, +import org.apache.lucene.search.similarities.DefaultSimilarity;, +        XMoreLikeThis mlt = new XMoreLikeThis(reader, similarity == null ? new DefaultSimilarity() : similarity);, +++ b/core/src/main/java/org/elasticsearch/common/lucene/search/Queries.java, +        return (optionalClauseCount < result ?, +                optionalClauseCount : (result < 0 ? 0 : result));, +, +++ b/core/src/main/java/org/elasticsearch/common/lucene/search/XMoreLikeThis.java, +import org.apache.lucene.search.similarities.DefaultSimilarity;, +    private TFIDFSimilarity similarity;// = new DefaultSimilarity();, +        this(ir, new DefaultSimilarity());, +++ b/core/src/main/java/org/elasticsearch/index/mapper/core/TypeParsers.java, +                builder.similarity(parserContext.getSimilarity(propNode.toString()));, +                builder.similarity(parserContext.getSimilarity(propNode.toString()));, +++ b/core/src/main/java/org/elasticsearch/index/query/BoolQueryBuilder.java, +        if (context.isFilter() && this.minimumShouldMatch == null) {, +            //will be applied for real only if there are should clauses, +++ b/core/src/main/java/org/apache/lucene/queries/BlendedTermQuery.java, + * {@link org.apache.lucene.search.similarities.DefaultSimilarity}, +++ b/core/src/main/java/org/elasticsearch/action/termvectors/TermVectorsFilter.java, +import org.apache.lucene.search.similarities.DefaultSimilarity;, +        this.similarity = new DefaultSimilarity();]
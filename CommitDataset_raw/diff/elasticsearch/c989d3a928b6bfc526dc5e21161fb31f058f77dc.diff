[+++ b/modules/elasticsearch/src/main/java/org/elasticsearch/common/io/stream/BytesStreamInput.java, +        int utflen = readInt();, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/common/io/stream/BytesStreamInput.java, +        int utflen = readInt();, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/common/io/stream/BytesStreamOutput.java, +        int newcount = count + utflen + 4;, +        // same as writeInt, +        bytearr[count++] = (byte) (utflen >> 24);, +        bytearr[count++] = (byte) (utflen >> 16);, +        bytearr[count++] = (byte) (utflen >> 8);, +        bytearr[count++] = (byte) (utflen);, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/common/io/stream/BytesStreamInput.java, +        int utflen = readInt();, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/common/io/stream/BytesStreamOutput.java, +        int newcount = count + utflen + 4;, +        // same as writeInt, +        bytearr[count++] = (byte) (utflen >> 24);, +        bytearr[count++] = (byte) (utflen >> 16);, +        bytearr[count++] = (byte) (utflen >> 8);, +        bytearr[count++] = (byte) (utflen);, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/common/io/stream/StreamInput.java, +        int utflen = readInt();, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/common/io/stream/BytesStreamInput.java, +        int utflen = readInt();, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/common/io/stream/BytesStreamOutput.java, +        int newcount = count + utflen + 4;, +        // same as writeInt, +        bytearr[count++] = (byte) (utflen >> 24);, +        bytearr[count++] = (byte) (utflen >> 16);, +        bytearr[count++] = (byte) (utflen >> 8);, +        bytearr[count++] = (byte) (utflen);, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/common/io/stream/StreamInput.java, +        int utflen = readInt();, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/common/io/stream/StreamOutput.java, +        if (this.bytearr == null || (this.bytearr.length < (utflen + 4))), +            this.bytearr = new byte[(utflen * 2) + 4];, +        // same as writeInt, +        bytearr[count++] = (byte) (utflen >> 24);, +        bytearr[count++] = (byte) (utflen >> 16);, +        bytearr[count++] = (byte) (utflen >> 8);, +        bytearr[count++] = (byte) (utflen);, +        writeBytes(bytearr, 0, utflen + 4);]
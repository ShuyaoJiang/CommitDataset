[+++ b/x-pack/plugin/ccr/src/test/java/org/elasticsearch/xpack/ccr/action/ShardFollowTaskReplicationTests.java, +            assertConsistentHistoryBetweenLeaderAndFollower(leaderGroup, followerGroup, true);, +            boolean hasPromotion = false;, +                    hasPromotion = true;, +            assertConsistentHistoryBetweenLeaderAndFollower(leaderGroup, followerGroup, hasPromotion == false);, +                    assertConsistentHistoryBetweenLeaderAndFollower(leaderGroup, followerGroup, true);, +    private void assertConsistentHistoryBetweenLeaderAndFollower(ReplicationGroup leader, ReplicationGroup follower,, +                                                                 boolean assertMaxSeqNoOfUpdatesOrDeletes) throws Exception {, +            if (assertMaxSeqNoOfUpdatesOrDeletes) {, +            }]
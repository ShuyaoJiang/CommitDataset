[+++ b/src/main/java/org/elasticsearch/cluster/routing/allocation/AllocationService.java, +++ b/src/main/java/org/elasticsearch/cluster/routing/allocation/AllocationService.java, +++ b/src/main/java/org/elasticsearch/cluster/routing/allocation/decider/AllocationDeciders.java, +    public AllocationDeciders(Settings settings, AllocationDecider[] allocations) {, +        super(settings);, +        this.allocations = allocations;, +        this(settings, allocations.toArray(new AllocationDecider[allocations.size()]));, +++ b/src/main/java/org/elasticsearch/cluster/routing/allocation/AllocationService.java, +++ b/src/main/java/org/elasticsearch/cluster/routing/allocation/decider/AllocationDeciders.java, +    public AllocationDeciders(Settings settings, AllocationDecider[] allocations) {, +        super(settings);, +        this.allocations = allocations;, +        this(settings, allocations.toArray(new AllocationDecider[allocations.size()]));, +++ b/src/main/java/org/elasticsearch/cluster/routing/allocation/decider/AllocationDecidersModule.java, +import com.google.common.collect.ImmutableSet;, +        for (Class<? extends AllocationDecider> deciderClass : DEFAULT_ALLOCATION_DECIDERS) {, +            allocationMultibinder.addBinding().to(deciderClass);, +        }, +, +    public static final ImmutableSet<Class<? extends AllocationDecider>> DEFAULT_ALLOCATION_DECIDERS = ImmutableSet.<Class<? extends AllocationDecider>>builder()., +            add(SameShardAllocationDecider.class)., +            add(FilterAllocationDecider.class)., +            add(ReplicaAfterPrimaryActiveAllocationDecider.class)., +            add(ThrottlingAllocationDecider.class)., +            add(RebalanceOnlyWhenActiveAllocationDecider.class)., +            add(ClusterRebalanceAllocationDecider.class)., +            add(ConcurrentRebalanceAllocationDecider.class)., +            add(DisableAllocationDecider.class)., +            add(AwarenessAllocationDecider.class)., +            add(ShardsLimitAllocationDecider.class)., +            add(DiskThresholdDecider.class)., +            add(SnapshotInProgressAllocationDecider.class).build();, +++ b/src/main/java/org/elasticsearch/cluster/routing/allocation/AllocationService.java, +++ b/src/main/java/org/elasticsearch/cluster/routing/allocation/decider/AllocationDeciders.java, +    public AllocationDeciders(Settings settings, AllocationDecider[] allocations) {, +        super(settings);, +        this.allocations = allocations;, +        this(settings, allocations.toArray(new AllocationDecider[allocations.size()]));, +++ b/src/main/java/org/elasticsearch/cluster/routing/allocation/decider/AllocationDecidersModule.java, +import com.google.common.collect.ImmutableSet;, +        for (Class<? extends AllocationDecider> deciderClass : DEFAULT_ALLOCATION_DECIDERS) {, +            allocationMultibinder.addBinding().to(deciderClass);, +        }, +, +    public static final ImmutableSet<Class<? extends AllocationDecider>> DEFAULT_ALLOCATION_DECIDERS = ImmutableSet.<Class<? extends AllocationDecider>>builder()., +            add(SameShardAllocationDecider.class)., +            add(FilterAllocationDecider.class)., +            add(ReplicaAfterPrimaryActiveAllocationDecider.class)., +            add(ThrottlingAllocationDecider.class)., +            add(RebalanceOnlyWhenActiveAllocationDecider.class)., +            add(ClusterRebalanceAllocationDecider.class)., +            add(ConcurrentRebalanceAllocationDecider.class)., +            add(DisableAllocationDecider.class)., +            add(AwarenessAllocationDecider.class)., +            add(ShardsLimitAllocationDecider.class)., +            add(DiskThresholdDecider.class)., +            add(SnapshotInProgressAllocationDecider.class).build();, +++ b/src/main/java/org/elasticsearch/cluster/routing/allocation/decider/DiskThresholdDecider.java, +    public DiskThresholdDecider(Settings settings, NodeSettingsService nodeSettingsService) {, +++ b/src/main/java/org/elasticsearch/cluster/routing/allocation/AllocationService.java, +++ b/src/main/java/org/elasticsearch/cluster/routing/allocation/decider/AllocationDeciders.java, +    public AllocationDeciders(Settings settings, AllocationDecider[] allocations) {, +        super(settings);, +        this.allocations = allocations;, +        this(settings, allocations.toArray(new AllocationDecider[allocations.size()]));, +++ b/src/main/java/org/elasticsearch/cluster/routing/allocation/decider/AllocationDecidersModule.java, +import com.google.common.collect.ImmutableSet;, +        for (Class<? extends AllocationDecider> deciderClass : DEFAULT_ALLOCATION_DECIDERS) {, +            allocationMultibinder.addBinding().to(deciderClass);, +        }, +, +    public static final ImmutableSet<Class<? extends AllocationDecider>> DEFAULT_ALLOCATION_DECIDERS = ImmutableSet.<Class<? extends AllocationDecider>>builder()., +            add(SameShardAllocationDecider.class)., +            add(FilterAllocationDecider.class)., +            add(ReplicaAfterPrimaryActiveAllocationDecider.class)., +            add(ThrottlingAllocationDecider.class)., +            add(RebalanceOnlyWhenActiveAllocationDecider.class)., +            add(ClusterRebalanceAllocationDecider.class)., +            add(ConcurrentRebalanceAllocationDecider.class)., +            add(DisableAllocationDecider.class)., +            add(AwarenessAllocationDecider.class)., +            add(ShardsLimitAllocationDecider.class)., +            add(DiskThresholdDecider.class)., +            add(SnapshotInProgressAllocationDecider.class).build();, +++ b/src/main/java/org/elasticsearch/cluster/routing/allocation/decider/DiskThresholdDecider.java, +    public DiskThresholdDecider(Settings settings, NodeSettingsService nodeSettingsService) {, +++ b/src/test/java/org/elasticsearch/benchmark/cluster/ClusterAllocationRerouteBenchmark.java, +import org.elasticsearch.common.settings.ImmutableSettings;, +import org.elasticsearch.test.ElasticsearchAllocationTestCase;, +, +import java.util.Random;, +        AllocationService strategy = ElasticsearchAllocationTestCase.createAllocationService(ImmutableSettings.EMPTY, new Random(1));, +++ b/src/main/java/org/elasticsearch/cluster/routing/allocation/AllocationService.java, +++ b/src/main/java/org/elasticsearch/cluster/routing/allocation/decider/AllocationDeciders.java, +    public AllocationDeciders(Settings settings, AllocationDecider[] allocations) {, +        super(settings);, +        this.allocations = allocations;, +        this(settings, allocations.toArray(new AllocationDecider[allocations.size()]));, +++ b/src/main/java/org/elasticsearch/cluster/routing/allocation/decider/AllocationDecidersModule.java, +import com.google.common.collect.ImmutableSet;]
[+++ b/src/test/java/org/elasticsearch/search/basic/SearchWithRandomExceptionsTests.java, +        NumShards numShards = getNumShards("test");, +                logger.info("Successful shards: [{}]  numShards: [{}]", searchResponse.getSuccessfulShards(), numShards.numPrimaries);, +                if (searchResponse.getSuccessfulShards() == numShards.numPrimaries && !refreshFailed) {, +                logger.info("Match all Successful shards: [{}]  numShards: [{}]", searchResponse.getSuccessfulShards(), numShards.numPrimaries);, +                if (searchResponse.getSuccessfulShards() == numShards.numPrimaries && !refreshFailed) {, +                logger.info("SearchPhaseException: [{}]", ex.getMessage());, +                // if a scheduled refresh or flush fails all shards we see all shards failed here, +                if (!(expectAllShardsFailed || refreshResponse.getSuccessfulShards() == 0 || ex.getMessage().contains("all shards failed"))) {]
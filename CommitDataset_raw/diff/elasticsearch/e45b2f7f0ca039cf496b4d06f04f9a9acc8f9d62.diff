[+++ b/Vagrantfile, +    ubuntu_common config, extra: <<-SHELL, +      # Install Jayatana so we can work around it being present., +      [ -f /usr/share/java/jayatanaag.jar ] || install jayatana, +    SHELL, +def ubuntu_common(config, extra: ''), +  deb_common config, 'apt-add-repository -y ppa:openjdk-r/ppa > /dev/null 2>&1', 'openjdk-r-*', extra: extra, +def deb_common(config, add_openjdk_repository_command, openjdk_list, extra: ''), +      #{extra}, +++ b/Vagrantfile, +    ubuntu_common config, extra: <<-SHELL, +      # Install Jayatana so we can work around it being present., +      [ -f /usr/share/java/jayatanaag.jar ] || install jayatana, +    SHELL, +def ubuntu_common(config, extra: ''), +  deb_common config, 'apt-add-repository -y ppa:openjdk-r/ppa > /dev/null 2>&1', 'openjdk-r-*', extra: extra, +def deb_common(config, add_openjdk_repository_command, openjdk_list, extra: ''), +      #{extra}, +++ b/core/src/main/java/org/elasticsearch/cluster/ClusterState.java, +import com.google.common.collect.ImmutableSet;, +import org.elasticsearch.cluster.routing.*;, +import java.util.*;, +++ b/Vagrantfile, +    ubuntu_common config, extra: <<-SHELL, +      # Install Jayatana so we can work around it being present., +      [ -f /usr/share/java/jayatanaag.jar ] || install jayatana, +    SHELL, +def ubuntu_common(config, extra: ''), +  deb_common config, 'apt-add-repository -y ppa:openjdk-r/ppa > /dev/null 2>&1', 'openjdk-r-*', extra: extra, +def deb_common(config, add_openjdk_repository_command, openjdk_list, extra: ''), +      #{extra}, +++ b/core/src/main/java/org/elasticsearch/cluster/ClusterState.java, +import com.google.common.collect.ImmutableSet;, +import org.elasticsearch.cluster.routing.*;, +import java.util.*;, +++ b/core/src/main/java/org/elasticsearch/common/inject/ConstructorBindingImpl.java, +import com.google.common.collect.ImmutableSet;, +import org.elasticsearch.common.inject.internal.*;, +        return Dependency.forInjectionPoints(new ImmutableSet.Builder<InjectionPoint>(), +                .add(getConstructor()), +                .addAll(getInjectableMembers()), +                .build());, +++ b/Vagrantfile, +    ubuntu_common config, extra: <<-SHELL, +      # Install Jayatana so we can work around it being present., +      [ -f /usr/share/java/jayatanaag.jar ] || install jayatana, +    SHELL, +def ubuntu_common(config, extra: ''), +  deb_common config, 'apt-add-repository -y ppa:openjdk-r/ppa > /dev/null 2>&1', 'openjdk-r-*', extra: extra, +def deb_common(config, add_openjdk_repository_command, openjdk_list, extra: ''), +      #{extra}, +++ b/core/src/main/java/org/elasticsearch/cluster/ClusterState.java, +import com.google.common.collect.ImmutableSet;, +import org.elasticsearch.cluster.routing.*;, +import java.util.*;, +++ b/core/src/main/java/org/elasticsearch/common/inject/ConstructorBindingImpl.java, +import com.google.common.collect.ImmutableSet;, +import org.elasticsearch.common.inject.internal.*;, +        return Dependency.forInjectionPoints(new ImmutableSet.Builder<InjectionPoint>(), +                .add(getConstructor()), +                .addAll(getInjectableMembers()), +                .build());, +++ b/core/src/main/java/org/elasticsearch/common/inject/InjectorShell.java, +import com.google.common.collect.ImmutableSet;, +import org.elasticsearch.common.inject.internal.*;, +import org.elasticsearch.common.inject.spi.*;, +++ b/Vagrantfile, +    ubuntu_common config, extra: <<-SHELL, +      # Install Jayatana so we can work around it being present., +      [ -f /usr/share/java/jayatanaag.jar ] || install jayatana, +    SHELL, +def ubuntu_common(config, extra: ''), +  deb_common config, 'apt-add-repository -y ppa:openjdk-r/ppa > /dev/null 2>&1', 'openjdk-r-*', extra: extra, +def deb_common(config, add_openjdk_repository_command, openjdk_list, extra: ''), +      #{extra}, +++ b/core/src/main/java/org/elasticsearch/cluster/ClusterState.java, +import com.google.common.collect.ImmutableSet;, +import org.elasticsearch.cluster.routing.*;, +import java.util.*;, +++ b/core/src/main/java/org/elasticsearch/common/inject/ConstructorBindingImpl.java, +import com.google.common.collect.ImmutableSet;, +import org.elasticsearch.common.inject.internal.*;, +        return Dependency.forInjectionPoints(new ImmutableSet.Builder<InjectionPoint>(), +                .add(getConstructor()), +                .addAll(getInjectableMembers()), +                .build());, +++ b/core/src/main/java/org/elasticsearch/common/inject/InjectorShell.java, +import com.google.common.collect.ImmutableSet;, +import org.elasticsearch.common.inject.internal.*;, +import org.elasticsearch.common.inject.spi.*;, +++ b/core/src/main/java/org/elasticsearch/common/inject/spi/InjectionPoint.java, +import com.google.common.collect.ImmutableSet;, +, +++ b/Vagrantfile, +    ubuntu_common config, extra: <<-SHELL, +      # Install Jayatana so we can work around it being present., +      [ -f /usr/share/java/jayatanaag.jar ] || install jayatana, +    SHELL, +def ubuntu_common(config, extra: ''), +  deb_common config, 'apt-add-repository -y ppa:openjdk-r/ppa > /dev/null 2>&1', 'openjdk-r-*', extra: extra]
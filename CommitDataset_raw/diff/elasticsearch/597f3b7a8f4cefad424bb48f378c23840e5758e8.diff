[+++ b/modules/elasticsearch/src/main/java/org/elasticsearch/cluster/metadata/MetaDataUpdateSettingsService.java, +import org.elasticsearch.ElasticSearchIllegalArgumentException;, +        // never allow to change the number of shards, +        for (String key : updatedSettingsBuilder.internalMap().keySet()) {, +            if (key.equals(IndexMetaData.SETTING_NUMBER_OF_SHARDS)) {, +                listener.onFailure(new ElasticSearchIllegalArgumentException("can't change the number of shards for an index"));, +                return;, +            }, +        }, +]
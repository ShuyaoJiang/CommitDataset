[+++ b/src/main/java/org/elasticsearch/index/engine/robin/RobinEngine.java, +    /*this is only used by one test right now and shoudl go away entirely once we update lucene*/, +    private static boolean allowRamBytesUsed = false;, +++ b/src/main/java/org/elasticsearch/index/engine/robin/RobinEngine.java, +    /*this is only used by one test right now and shoudl go away entirely once we update lucene*/, +    private static boolean allowRamBytesUsed = false;, +++ b/src/test/java/org/elasticsearch/index/engine/robin/RobinEngineIntegrationTest.java, +import java.lang.reflect.Field;, +        Field allowRamBytesUsed = RobinEngine.class.getDeclaredField("allowRamBytesUsed");, +        allowRamBytesUsed.setAccessible(true);, +        allowRamBytesUsed.set(RobinEngine.class, Boolean.TRUE);, +, +        try {, +        } finally {, +            allowRamBytesUsed.set(RobinEngine.class, Boolean.FALSE);, +        }, +        Field allowRamBytesUsed = RobinEngine.class.getDeclaredField("allowRamBytesUsed");, +        allowRamBytesUsed.setAccessible(true);, +        allowRamBytesUsed.set(RobinEngine.class, Boolean.TRUE);, +        try {, +        } finally {, +            allowRamBytesUsed.set(RobinEngine.class, Boolean.FALSE);, +        }, +, +++ b/src/main/java/org/elasticsearch/index/engine/robin/RobinEngine.java, +    /*this is only used by one test right now and shoudl go away entirely once we update lucene*/, +    private static boolean allowRamBytesUsed = false;, +++ b/src/test/java/org/elasticsearch/index/engine/robin/RobinEngineIntegrationTest.java, +import java.lang.reflect.Field;, +        Field allowRamBytesUsed = RobinEngine.class.getDeclaredField("allowRamBytesUsed");, +        allowRamBytesUsed.setAccessible(true);, +        allowRamBytesUsed.set(RobinEngine.class, Boolean.TRUE);, +, +        try {, +        } finally {, +            allowRamBytesUsed.set(RobinEngine.class, Boolean.FALSE);, +        }, +        Field allowRamBytesUsed = RobinEngine.class.getDeclaredField("allowRamBytesUsed");, +        allowRamBytesUsed.setAccessible(true);, +        allowRamBytesUsed.set(RobinEngine.class, Boolean.TRUE);, +        try {, +        } finally {, +            allowRamBytesUsed.set(RobinEngine.class, Boolean.FALSE);, +        }, +, +++ b/src/test/java/org/elasticsearch/indices/stats/SimpleIndexStatsTests.java, +import org.apache.lucene.util.Version;, +        assumeTrue(org.elasticsearch.Version.CURRENT.luceneVersion != Version.LUCENE_46);]
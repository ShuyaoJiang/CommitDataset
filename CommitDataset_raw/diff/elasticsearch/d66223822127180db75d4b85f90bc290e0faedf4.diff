[+++ b/src/test/java/org/elasticsearch/test/TestCluster.java, +    private synchronized NodeAndClient getOrBuildRandomNode() {, +            return randomNodeAndClient;, +        return buildNode;, +        return getOrBuildRandomNode().client(random);, +            return randomNodeAndClient.nodeClient(); // ensure node client master is requested, +            return randomNodeAndClient.nodeClient(); // ensure node client non-master is requested, +        private Client nodeClient;, +        Client nodeClient() {, +            if (closed.get()) {, +                throw new RuntimeException("already closed");, +            }, +            if (nodeClient == null) {, +                nodeClient = node.client();, +            }, +            return nodeClient;, +        }, +        , +            , +            if (nodeClient != null) {, +                nodeClient.close();, +                nodeClient = null;, +            }, +            TransportClient client = new TransportClient(settingsBuilder().put("client.transport.nodes_sampler_interval", "1s"), +                case 5: // disabled for now - will re-enable once tests stabelize, +//                    return TransportClientFactory.NO_SNIFF_CLIENT_FACTORY.client(node, clusterName, random);, +//                    return TransportClientFactory.SNIFF_CLIENT_FACTORY.client(node, clusterName, random);]
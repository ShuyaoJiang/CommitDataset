[+++ b/x-pack/plugin/graph/build.gradle, +// add all sub-projects of the qa sub-project, +gradle.projectsEvaluated {, +    project.subprojects, +            .find { it.path == project.path + ":qa" }, +            .subprojects, +            .findAll { it.path.startsWith(project.path + ":qa") }, +            .each { check.dependsOn it.check }, +}, +, +++ b/x-pack/plugin/graph/build.gradle, +// add all sub-projects of the qa sub-project, +gradle.projectsEvaluated {, +    project.subprojects, +            .find { it.path == project.path + ":qa" }, +            .subprojects, +            .findAll { it.path.startsWith(project.path + ":qa") }, +            .each { check.dependsOn it.check }, +}, +, +++ b/x-pack/plugin/graph/qa/build.gradle, +import org.elasticsearch.gradle.test.RestIntegTestTask, +, +subprojects {, +    // HACK: please fix this, +    // we want to add the rest api specs for xpack to qa tests, but we, +    // need to wait until after the project is evaluated to only apply, +    // to those that rest tests. this used to be done automatically, +    // when xpack was a plugin, but now there is no place with xpack as a module., +    // instead, we should package these and make them easy to use for rest tests,, +    // but currently, they must be copied into the resources of the test runner., +    project.tasks.withType(RestIntegTestTask) {, +        File xpackResources = new File(xpackProject('plugin').projectDir, 'src/test/resources'), +        project.copyRestSpec.from(xpackResources) {, +            include 'rest-api-spec/api/**', +        }, +    }, +}, +, +gradle.projectsEvaluated {, +    subprojects {, +        Task assemble = project.tasks.findByName('assemble'), +        if (assemble) {, +            assemble.enabled = false, +        }, +        Task dependenciesInfo = project.tasks.findByName('dependenciesInfo'), +        if (dependenciesInfo) {, +            dependenciesInfo.enabled = false, +        }, +    }, +}, +++ b/x-pack/plugin/graph/build.gradle, +// add all sub-projects of the qa sub-project, +gradle.projectsEvaluated {, +    project.subprojects, +            .find { it.path == project.path + ":qa" }, +            .subprojects, +            .findAll { it.path.startsWith(project.path + ":qa") }, +            .each { check.dependsOn it.check }, +}, +, +++ b/x-pack/plugin/graph/qa/build.gradle, +import org.elasticsearch.gradle.test.RestIntegTestTask, +, +subprojects {, +    // HACK: please fix this, +    // we want to add the rest api specs for xpack to qa tests, but we, +    // need to wait until after the project is evaluated to only apply, +    // to those that rest tests. this used to be done automatically, +    // when xpack was a plugin, but now there is no place with xpack as a module., +    // instead, we should package these and make them easy to use for rest tests,, +    // but currently, they must be copied into the resources of the test runner., +    project.tasks.withType(RestIntegTestTask) {, +        File xpackResources = new File(xpackProject('plugin').projectDir, 'src/test/resources'), +        project.copyRestSpec.from(xpackResources) {, +            include 'rest-api-spec/api/**', +        }, +    }, +}, +, +gradle.projectsEvaluated {, +    subprojects {, +        Task assemble = project.tasks.findByName('assemble'), +        if (assemble) {, +            assemble.enabled = false, +        }, +        Task dependenciesInfo = project.tasks.findByName('dependenciesInfo'), +        if (dependenciesInfo) {, +            dependenciesInfo.enabled = false, +        }, +    }, +}, +++ b/x-pack/plugin/graph/qa/with-security/build.gradle, +apply plugin: 'elasticsearch.standalone-rest-test', +apply plugin: 'elasticsearch.rest-test', +, +dependencies {, +  testCompile "org.elasticsearch.plugin:x-pack-core:${version}", +}, +]
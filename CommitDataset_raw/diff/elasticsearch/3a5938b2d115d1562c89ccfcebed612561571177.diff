[+++ b/plugins/river/couchdb/src/main/java/org/elasticsearch/river/couchdb/CouchdbRiver.java, +                        bulk.add(indexRequest(riverIndexName).type(riverName.name()).id("_seq"), +                                .source(jsonBuilder().startObject().startObject("couchdb").field("last_seq", lastSeq).endObject().endObject()));, +                        Map<String, Object> couchdbState = (Map<String, Object>) lastSeqGetResponse.sourceAsMap().get("couchdb");, +                        if (couchdbState != null) {, +                            lastSeq = couchdbState.get("last_seq").toString();, +                        }, +++ b/plugins/river/couchdb/src/main/java/org/elasticsearch/river/couchdb/CouchdbRiver.java, +                        bulk.add(indexRequest(riverIndexName).type(riverName.name()).id("_seq"), +                                .source(jsonBuilder().startObject().startObject("couchdb").field("last_seq", lastSeq).endObject().endObject()));, +                        Map<String, Object> couchdbState = (Map<String, Object>) lastSeqGetResponse.sourceAsMap().get("couchdb");, +                        if (couchdbState != null) {, +                            lastSeq = couchdbState.get("last_seq").toString();, +                        }, +++ b/plugins/river/couchdb/src/test/java/org/elasticsearch/river/couchdb/CouchdbRiverTest.java, +        Node node = NodeBuilder.nodeBuilder().settings(ImmutableSettings.settingsBuilder().put("gateway.type", "local")).node();, +        Thread.sleep(1000);]
[+++ b/modules/rank-eval/src/main/java/org/elasticsearch/index/rankeval/RankEvalResponse.java, +++ b/modules/rank-eval/src/main/java/org/elasticsearch/index/rankeval/RankEvalResponse.java, +++ b/modules/rank-eval/src/test/java/org/elasticsearch/index/rankeval/RankEvalResponseTests.java, +++ b/modules/rank-eval/src/main/java/org/elasticsearch/index/rankeval/RankEvalResponse.java, +++ b/modules/rank-eval/src/test/java/org/elasticsearch/index/rankeval/RankEvalResponseTests.java, +++ b/modules/rank-eval/src/test/resources/rest-api-spec/test/rank_eval/10_basic.yml, +  - match: { quality_level: 1}, +  - match: { details.amsterdam_query.quality_level: 1.0}, +  - match: { details.amsterdam_query.unknown_docs:  [ {"_index": "foo", "_id": "doc4"}]}, +  - match: { details.amsterdam_query.metric_details: {"relevant_docs_retrieved": 2, "docs_retrieved": 2}}, +  - length: { details.amsterdam_query.hits: 3}, +  - match: { details.amsterdam_query.hits.0.hit._id:  "doc2"}, +  - match: { details.amsterdam_query.hits.0.rating: 1}, +  - match: { details.amsterdam_query.hits.1.hit._id:  "doc3"}, +  - match: { details.amsterdam_query.hits.1.rating: 1}, +  - match: { details.amsterdam_query.hits.2.hit._id:  "doc4"}, +  - is_false: details.amsterdam_query.hits.2.rating, +  - match: { details.berlin_query.quality_level: 1.0}, +  - match: { details.berlin_query.unknown_docs:  [ {"_index": "foo", "_id": "doc4"}]}, +  - match: { details.berlin_query.metric_details: {"relevant_docs_retrieved": 1, "docs_retrieved": 1}}, +  - length: { details.berlin_query.hits: 2}, +  - match: { details.berlin_query.hits.0.hit._id: "doc1" }, +  - match: { details.berlin_query.hits.0.rating: 1}, +  - match: { details.berlin_query.hits.1.hit._id: "doc4" }, +  - is_false: details.berlin_query.hits.1.rating , +  - gt: {quality_level: 0.416}, +  - lt: {quality_level: 0.417}, +  - gt: {details.amsterdam_query.quality_level: 0.333}, +  - lt: {details.amsterdam_query.quality_level: 0.334}, +  - match: {details.amsterdam_query.metric_details: {"first_relevant": 3}}, +  - match: {details.amsterdam_query.unknown_docs:  [ {"_index": "foo", "_id": "doc2"},, +  - match: {details.berlin_query.quality_level: 0.5}, +  - match: {details.berlin_query.metric_details: {"first_relevant": 2}}, +  - match: {details.berlin_query.unknown_docs:  [ {"_index": "foo", "_id": "doc1"}]}, +++ b/modules/rank-eval/src/main/java/org/elasticsearch/index/rankeval/RankEvalResponse.java, +++ b/modules/rank-eval/src/test/java/org/elasticsearch/index/rankeval/RankEvalResponseTests.java, +++ b/modules/rank-eval/src/test/resources/rest-api-spec/test/rank_eval/10_basic.yml, +  - match: { quality_level: 1}, +  - match: { details.amsterdam_query.quality_level: 1.0}, +  - match: { details.amsterdam_query.unknown_docs:  [ {"_index": "foo", "_id": "doc4"}]}, +  - match: { details.amsterdam_query.metric_details: {"relevant_docs_retrieved": 2, "docs_retrieved": 2}}, +  - length: { details.amsterdam_query.hits: 3}, +  - match: { details.amsterdam_query.hits.0.hit._id:  "doc2"}, +  - match: { details.amsterdam_query.hits.0.rating: 1}, +  - match: { details.amsterdam_query.hits.1.hit._id:  "doc3"}, +  - match: { details.amsterdam_query.hits.1.rating: 1}, +  - match: { details.amsterdam_query.hits.2.hit._id:  "doc4"}, +  - is_false: details.amsterdam_query.hits.2.rating, +  - match: { details.berlin_query.quality_level: 1.0}, +  - match: { details.berlin_query.unknown_docs:  [ {"_index": "foo", "_id": "doc4"}]}, +  - match: { details.berlin_query.metric_details: {"relevant_docs_retrieved": 1, "docs_retrieved": 1}}, +  - length: { details.berlin_query.hits: 2}, +  - match: { details.berlin_query.hits.0.hit._id: "doc1" }, +  - match: { details.berlin_query.hits.0.rating: 1}, +  - match: { details.berlin_query.hits.1.hit._id: "doc4" }, +  - is_false: details.berlin_query.hits.1.rating , +  - gt: {quality_level: 0.416}, +  - lt: {quality_level: 0.417}, +  - gt: {details.amsterdam_query.quality_level: 0.333}, +  - lt: {details.amsterdam_query.quality_level: 0.334}, +  - match: {details.amsterdam_query.metric_details: {"first_relevant": 3}}, +  - match: {details.amsterdam_query.unknown_docs:  [ {"_index": "foo", "_id": "doc2"},, +  - match: {details.berlin_query.quality_level: 0.5}, +  - match: {details.berlin_query.metric_details: {"first_relevant": 2}}, +  - match: {details.berlin_query.unknown_docs:  [ {"_index": "foo", "_id": "doc1"}]}, +++ b/modules/rank-eval/src/test/resources/rest-api-spec/test/rank_eval/20_dcg.yml, +  - gt: {quality_level: 13.848263 }, +  - lt: {quality_level: 13.848264 }, +  - gt: {details.dcg_query.quality_level: 13.848263}, +  - lt: {details.dcg_query.quality_level: 13.848264}, +  - match: {details.dcg_query.unknown_docs: [ ]}, +  - gt: {quality_level: 10.299674}, +  - lt: {quality_level: 10.299675}, +  - gt: {details.dcg_query_reverse.quality_level: 10.299674}, +  - lt: {details.dcg_query_reverse.quality_level: 10.299675}, +  - match: {details.dcg_query_reverse.unknown_docs: [ ]}, +  - gt: {quality_level: 12.073969}, +  - lt: {quality_level: 12.073970}, +  - gt: {details.dcg_query.quality_level: 13.848263}, +  - lt: {details.dcg_query.quality_level: 13.848264}, +  - match: {details.dcg_query.unknown_docs: [ ]}, +  - gt: {details.dcg_query_reverse.quality_level: 10.299674}, +  - lt: {details.dcg_query_reverse.quality_level: 10.299675}, +  - match: {details.dcg_query_reverse.unknown_docs: [ ]}, +++ b/modules/rank-eval/src/main/java/org/elasticsearch/index/rankeval/RankEvalResponse.java, +++ b/modules/rank-eval/src/test/java/org/elasticsearch/index/rankeval/RankEvalResponseTests.java, +++ b/modules/rank-eval/src/test/resources/rest-api-spec/test/rank_eval/10_basic.yml, +  - match: { quality_level: 1}, +  - match: { details.amsterdam_query.quality_level: 1.0}, +  - match: { details.amsterdam_query.unknown_docs:  [ {"_index": "foo", "_id": "doc4"}]}, +  - match: { details.amsterdam_query.metric_details: {"relevant_docs_retrieved": 2, "docs_retrieved": 2}}, +  - length: { details.amsterdam_query.hits: 3}, +  - match: { details.amsterdam_query.hits.0.hit._id:  "doc2"}, +  - match: { details.amsterdam_query.hits.0.rating: 1}, +  - match: { details.amsterdam_query.hits.1.hit._id:  "doc3"}, +  - match: { details.amsterdam_query.hits.1.rating: 1}, +  - match: { details.amsterdam_query.hits.2.hit._id:  "doc4"}, +  - is_false: details.amsterdam_query.hits.2.rating, +  - match: { details.berlin_query.quality_level: 1.0}, +  - match: { details.berlin_query.unknown_docs:  [ {"_index": "foo", "_id": "doc4"}]}]
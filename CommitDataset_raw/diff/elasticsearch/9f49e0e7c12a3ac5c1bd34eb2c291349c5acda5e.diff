[+++ b/TESTING.asciidoc, +Tests can be run instrumented with jacoco to produce a coverage report in, +`target/site/jacoco/`., +, +Unit test coverage:, +Integration test coverage:, +, +---------------------------------------------------------------------------, +mvn -Dtests.coverage -Dskip.unit.tests verify jacoco:report, +---------------------------------------------------------------------------, +, +Combined (Unit+Integration) coverage:, +, +---------------------------------------------------------------------------, +mvn -Dtests.coverage verify jacoco:report, +---------------------------------------------------------------------------, +, +++ b/TESTING.asciidoc, +Tests can be run instrumented with jacoco to produce a coverage report in, +`target/site/jacoco/`., +, +Unit test coverage:, +Integration test coverage:, +, +---------------------------------------------------------------------------, +mvn -Dtests.coverage -Dskip.unit.tests verify jacoco:report, +---------------------------------------------------------------------------, +, +Combined (Unit+Integration) coverage:, +, +---------------------------------------------------------------------------, +mvn -Dtests.coverage verify jacoco:report, +---------------------------------------------------------------------------, +, +++ b/core/src/main/java/org/apache/lucene/queries/MinDocQuery.java, +            public Scorer scorer(LeafReaderContext context) throws IOException {, +++ b/TESTING.asciidoc, +Tests can be run instrumented with jacoco to produce a coverage report in, +`target/site/jacoco/`., +, +Unit test coverage:, +Integration test coverage:, +, +---------------------------------------------------------------------------, +mvn -Dtests.coverage -Dskip.unit.tests verify jacoco:report, +---------------------------------------------------------------------------, +, +Combined (Unit+Integration) coverage:, +, +---------------------------------------------------------------------------, +mvn -Dtests.coverage verify jacoco:report, +---------------------------------------------------------------------------, +, +++ b/core/src/main/java/org/apache/lucene/queries/MinDocQuery.java, +            public Scorer scorer(LeafReaderContext context) throws IOException {, +++ b/core/src/main/java/org/apache/lucene/queryparser/classic/MapperQueryParser.java, +                        q = applySlop(q, slop);, +                        q = applySlop(q, slop);, +    private Query applySlop(Query q, int slop) {, +            PhraseQuery pq = (PhraseQuery) q;, +            PhraseQuery.Builder builder = new PhraseQuery.Builder();, +            builder.setSlop(slop);, +            final Term[] terms = pq.getTerms();, +            final int[] positions = pq.getPositions();, +            for (int i = 0; i < terms.length; ++i) {, +                builder.add(terms[i], positions[i]);, +            }, +            pq = builder.build();, +            pq.setBoost(q.getBoost());, +            return pq;, +            return q;, +        } else {, +            return q;, +++ b/TESTING.asciidoc, +Tests can be run instrumented with jacoco to produce a coverage report in, +`target/site/jacoco/`., +, +Unit test coverage:, +Integration test coverage:, +, +---------------------------------------------------------------------------, +mvn -Dtests.coverage -Dskip.unit.tests verify jacoco:report, +---------------------------------------------------------------------------, +, +Combined (Unit+Integration) coverage:, +, +---------------------------------------------------------------------------, +mvn -Dtests.coverage verify jacoco:report, +---------------------------------------------------------------------------, +, +++ b/core/src/main/java/org/apache/lucene/queries/MinDocQuery.java, +            public Scorer scorer(LeafReaderContext context) throws IOException {, +++ b/core/src/main/java/org/apache/lucene/queryparser/classic/MapperQueryParser.java, +                        q = applySlop(q, slop);, +                        q = applySlop(q, slop);, +    private Query applySlop(Query q, int slop) {, +            PhraseQuery pq = (PhraseQuery) q;, +            PhraseQuery.Builder builder = new PhraseQuery.Builder();, +            builder.setSlop(slop);, +            final Term[] terms = pq.getTerms();]
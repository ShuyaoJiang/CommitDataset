[+++ b/src/main/java/org/elasticsearch/shield/authc/ldap/LdapUserSearchSessionFactory.java, +                    throw new ShieldSettingsException("[bind_dn] has not been specified so a value must be specified for [user_search.pool.health_check.dn] or [user_search.pool.health_check.enabled] must be set to false");, +        String bindDn = settings.get("bind_dn");, +            request = new SimpleBindRequest(bindDn, settings.get("bind_password"));, +++ b/src/main/java/org/elasticsearch/shield/authc/ldap/LdapUserSearchSessionFactory.java, +                    throw new ShieldSettingsException("[bind_dn] has not been specified so a value must be specified for [user_search.pool.health_check.dn] or [user_search.pool.health_check.enabled] must be set to false");, +        String bindDn = settings.get("bind_dn");, +            request = new SimpleBindRequest(bindDn, settings.get("bind_password"));, +++ b/src/test/java/org/elasticsearch/shield/authc/ldap/LdapRealmTest.java, +                .put("bind_dn", "cn=Thomas Masterman Hardy,ou=people,o=sevenSeas"), +                .put("bind_password", PASSWORD), +++ b/src/main/java/org/elasticsearch/shield/authc/ldap/LdapUserSearchSessionFactory.java, +                    throw new ShieldSettingsException("[bind_dn] has not been specified so a value must be specified for [user_search.pool.health_check.dn] or [user_search.pool.health_check.enabled] must be set to false");, +        String bindDn = settings.get("bind_dn");, +            request = new SimpleBindRequest(bindDn, settings.get("bind_password"));, +++ b/src/test/java/org/elasticsearch/shield/authc/ldap/LdapRealmTest.java, +                .put("bind_dn", "cn=Thomas Masterman Hardy,ou=people,o=sevenSeas"), +                .put("bind_password", PASSWORD), +++ b/src/test/java/org/elasticsearch/shield/authc/ldap/LdapUserSearchSessionFactoryTests.java, +                .put("bind_dn", "cn=Horatio Hornblower,ou=people,o=sevenSeas"), +                .put("bind_password", "pass"), +                .put("bind_dn", "cn=Horatio Hornblower,ou=people,o=sevenSeas"), +                .put("bind_password", "pass"), +                .put("bind_dn", "cn=Horatio Hornblower,ou=people,o=sevenSeas"), +                .put("bind_password", "pass"), +                .put("bind_dn", "cn=Horatio Hornblower,ou=people,o=sevenSeas"), +                .put("bind_password", "pass"), +                .put("bind_dn", "cn=Horatio Hornblower,ou=people,o=sevenSeas"), +                .put("bind_password", "pass"), +                .put("bind_dn", "cn=Horatio Hornblower,ou=people,o=sevenSeas"), +                .put("bind_password", "pass"), +                .put("bind_dn", "cn=Horatio Hornblower,ou=people,o=sevenSeas"), +                .put("bind_password", "pass"), +                .put("bind_dn", "ironman@ad.test.elasticsearch.com"), +                .put("bind_password", ActiveDirectorySessionFactoryTests.PASSWORD), +                .put("bind_dn", "uid=blackwidow,ou=people,dc=oldap,dc=test,dc=elasticsearch,dc=com"), +                .put("bind_password", OpenLdapTests.PASSWORD), +                .put("bind_dn", "cn=Horatio Hornblower,ou=people,o=sevenSeas"), +                .put("bind_password", "pass"), +                .put("bind_dn", "cn=Horatio Hornblower,ou=people,o=sevenSeas"), +                .put("bind_password", "pass"), +                .put("bind_password", "pass"), +            assertThat(e.getMessage(), containsString("[bind_dn] has not been specified so a value must be specified for [user_search.pool.health_check.dn] or [user_search.pool.health_check.enabled] must be set to false"));, +        BindRequest request = LdapUserSearchSessionFactory.bindRequest(settingsBuilder().put("bind_password", "password").build());, +                .put("bind_password", "password"), +                .put("bind_dn", "cn=ironman")]
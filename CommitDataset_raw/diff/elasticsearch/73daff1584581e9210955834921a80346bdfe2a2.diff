[+++ b/modules/elasticsearch/src/main/java/org/elasticsearch/index/gateway/fs/FsIndexGateway.java, +import org.elasticsearch.index.IndexException;, +, +        if (!(indexGatewayHome.exists() && indexGatewayHome.isDirectory())) {, +            boolean result;, +            for (int i = 0; i < 5; i++) {, +                result = indexGatewayHome.mkdirs();, +                if (result) {, +                    break;, +                }, +            }, +        }, +        if (!(indexGatewayHome.exists() && indexGatewayHome.isDirectory())) {, +            throw new IndexException(index, "Failed to create index gateway at [" + indexGatewayHome + "]");, +        }]
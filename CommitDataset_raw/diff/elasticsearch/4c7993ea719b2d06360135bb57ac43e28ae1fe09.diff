[+++ b/core/src/main/java/org/elasticsearch/transport/netty/NettyTransport.java, +            final TransportRequestOptions finalOptions = options;, +            ChannelFutureListener channelFutureListener =, +                f -> transportServiceAdapter.onRequestSent(node, requestId, action, request, finalOptions);, +            future.addListener(channelFutureListener);, +++ b/core/src/main/java/org/elasticsearch/transport/netty/NettyTransport.java, +            final TransportRequestOptions finalOptions = options;, +            ChannelFutureListener channelFutureListener =, +                f -> transportServiceAdapter.onRequestSent(node, requestId, action, request, finalOptions);, +            future.addListener(channelFutureListener);, +++ b/core/src/main/java/org/elasticsearch/transport/netty/NettyTransportChannel.java, +import org.jboss.netty.channel.ChannelFutureListener;, +            final TransportResponseOptions finalOptions = options;, +            ChannelFutureListener onResponseSentListener =, +                f -> transportServiceAdapter.onResponseSent(requestId, action, response, finalOptions);, +            future.addListener(onResponseSentListener);, +        ChannelFuture future = channel.write(buffer);, +        ChannelFutureListener onResponseSentListener =, +            f -> transportServiceAdapter.onResponseSent(requestId, action, error);, +        future.addListener(onResponseSentListener);]
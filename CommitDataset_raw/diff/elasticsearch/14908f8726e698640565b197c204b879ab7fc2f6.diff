[+++ b/core/src/main/java/org/elasticsearch/action/bulk/TransportShardBulkAction.java, +            DocumentRequest<?> documentRequest = item.request();, +            final Engine.Operation operation;, +                switch (documentRequest.opType()) {, +                    case CREATE:, +                    case INDEX:, +                        operation = TransportIndexAction.executeIndexRequestOnReplica(((IndexRequest) documentRequest), indexShard);, +                        break;, +                    case DELETE:, +                        operation = TransportDeleteAction.executeDeleteRequestOnReplica(((DeleteRequest) documentRequest), indexShard);, +                        break;, +                    default: throw new IllegalStateException("Unexpected request operation type on replica: ", +                            + documentRequest.opType().getLowercase());, +                }]
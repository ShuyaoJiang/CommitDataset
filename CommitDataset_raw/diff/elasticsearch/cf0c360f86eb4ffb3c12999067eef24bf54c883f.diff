[+++ b/src/main/java/org/elasticsearch/index/aliases/IndexAliasesService.java, +import org.elasticsearch.index.query.ParsedFilter;, +                ParsedFilter parsedFilter = indexQueryParser.parseInnerFilter(parser);, +                return parsedFilter == null ? null : parsedFilter.filter();, +++ b/src/main/java/org/elasticsearch/index/aliases/IndexAliasesService.java, +import org.elasticsearch.index.query.ParsedFilter;, +                ParsedFilter parsedFilter = indexQueryParser.parseInnerFilter(parser);, +                return parsedFilter == null ? null : parsedFilter.filter();, +++ b/src/main/java/org/elasticsearch/index/query/ParsedFilter.java, +        assert filter != null;, +        assert namedFilters != null;, +++ b/src/main/java/org/elasticsearch/index/aliases/IndexAliasesService.java, +import org.elasticsearch.index.query.ParsedFilter;, +                ParsedFilter parsedFilter = indexQueryParser.parseInnerFilter(parser);, +                return parsedFilter == null ? null : parsedFilter.filter();, +++ b/src/main/java/org/elasticsearch/index/query/ParsedFilter.java, +        assert filter != null;, +        assert namedFilters != null;, +++ b/src/main/java/org/elasticsearch/search/facet/FacetParseElement.java, +import org.elasticsearch.index.query.ParsedFilter;, +                            ParsedFilter parsedFilter = context.queryParserService().parseInnerFilter(parser);, +                            filter = parsedFilter == null ? null : parsedFilter.filter();, +++ b/src/main/java/org/elasticsearch/index/aliases/IndexAliasesService.java, +import org.elasticsearch.index.query.ParsedFilter;, +                ParsedFilter parsedFilter = indexQueryParser.parseInnerFilter(parser);, +                return parsedFilter == null ? null : parsedFilter.filter();, +++ b/src/main/java/org/elasticsearch/index/query/ParsedFilter.java, +        assert filter != null;, +        assert namedFilters != null;, +++ b/src/main/java/org/elasticsearch/search/facet/FacetParseElement.java, +import org.elasticsearch.index.query.ParsedFilter;, +                            ParsedFilter parsedFilter = context.queryParserService().parseInnerFilter(parser);, +                            filter = parsedFilter == null ? null : parsedFilter.filter();, +++ b/src/main/java/org/elasticsearch/search/facet/filter/FilterFacetParser.java, +import org.elasticsearch.index.query.ParsedFilter;, +        ParsedFilter parsedFilter = context.queryParserService().parseInnerFilter(parser);, +        if (parsedFilter == null) {, +            parsedFilter = ParsedFilter.EMPTY;, +        }, +        return new FilterFacetExecutor(parsedFilter.filter());, +++ b/src/main/java/org/elasticsearch/index/aliases/IndexAliasesService.java, +import org.elasticsearch.index.query.ParsedFilter;, +                ParsedFilter parsedFilter = indexQueryParser.parseInnerFilter(parser);, +                return parsedFilter == null ? null : parsedFilter.filter();, +++ b/src/main/java/org/elasticsearch/index/query/ParsedFilter.java, +        assert filter != null;, +        assert namedFilters != null;, +++ b/src/main/java/org/elasticsearch/search/facet/FacetParseElement.java, +import org.elasticsearch.index.query.ParsedFilter;, +                            ParsedFilter parsedFilter = context.queryParserService().parseInnerFilter(parser);, +                            filter = parsedFilter == null ? null : parsedFilter.filter();, +++ b/src/main/java/org/elasticsearch/search/facet/filter/FilterFacetParser.java, +import org.elasticsearch.index.query.ParsedFilter;, +        ParsedFilter parsedFilter = context.queryParserService().parseInnerFilter(parser);, +        if (parsedFilter == null) {, +            parsedFilter = ParsedFilter.EMPTY;, +        }, +        return new FilterFacetExecutor(parsedFilter.filter());, +++ b/src/main/java/org/elasticsearch/search/sort/GeoDistanceSortParser.java, +import org.elasticsearch.index.query.ParsedFilter;, +                    ParsedFilter parsedFilter = context.queryParserService().parseInnerFilter(parser);, +                    nestedFilter = parsedFilter == null ? null : parsedFilter.filter();, +++ b/src/main/java/org/elasticsearch/index/aliases/IndexAliasesService.java, +import org.elasticsearch.index.query.ParsedFilter;, +                ParsedFilter parsedFilter = indexQueryParser.parseInnerFilter(parser);, +                return parsedFilter == null ? null : parsedFilter.filter();, +++ b/src/main/java/org/elasticsearch/index/query/ParsedFilter.java, +        assert filter != null;, +        assert namedFilters != null;, +++ b/src/main/java/org/elasticsearch/search/facet/FacetParseElement.java, +import org.elasticsearch.index.query.ParsedFilter;, +                            ParsedFilter parsedFilter = context.queryParserService().parseInnerFilter(parser);, +                            filter = parsedFilter == null ? null : parsedFilter.filter();, +++ b/src/main/java/org/elasticsearch/search/facet/filter/FilterFacetParser.java, +import org.elasticsearch.index.query.ParsedFilter;, +        ParsedFilter parsedFilter = context.queryParserService().parseInnerFilter(parser);, +        if (parsedFilter == null) {, +            parsedFilter = ParsedFilter.EMPTY;, +        }, +        return new FilterFacetExecutor(parsedFilter.filter());, +++ b/src/main/java/org/elasticsearch/search/sort/GeoDistanceSortParser.java, +import org.elasticsearch.index.query.ParsedFilter;, +                    ParsedFilter parsedFilter = context.queryParserService().parseInnerFilter(parser);, +                    nestedFilter = parsedFilter == null ? null : parsedFilter.filter();, +++ b/src/main/java/org/elasticsearch/search/sort/ScriptSortParser.java, +import org.elasticsearch.index.query.ParsedFilter;, +                    ParsedFilter parsedFilter = context.queryParserService().parseInnerFilter(parser);, +                    nestedFilter = parsedFilter == null ? null : parsedFilter.filter();, +++ b/src/main/java/org/elasticsearch/index/aliases/IndexAliasesService.java, +import org.elasticsearch.index.query.ParsedFilter;, +                ParsedFilter parsedFilter = indexQueryParser.parseInnerFilter(parser);, +                return parsedFilter == null ? null : parsedFilter.filter();, +++ b/src/main/java/org/elasticsearch/index/query/ParsedFilter.java, +        assert filter != null;, +        assert namedFilters != null;, +++ b/src/main/java/org/elasticsearch/search/facet/FacetParseElement.java, +import org.elasticsearch.index.query.ParsedFilter;, +                            ParsedFilter parsedFilter = context.queryParserService().parseInnerFilter(parser);, +                            filter = parsedFilter == null ? null : parsedFilter.filter();, +++ b/src/main/java/org/elasticsearch/search/facet/filter/FilterFacetParser.java]
[+++ b/docs/reference/aggregations/bucket/composite-aggregation.asciidoc, +            "after_key": { <1>, +                "date": 1494288000000,, +                "product": "mad max", +            },, +                    "key": {, +NOTE: The `after_key` is equals to the last bucket returned in the response before, +any filtering that could be done by <<search-aggregations-pipeline, Pipeline aggregations>>., +If all buckets are filtered/removed by a pipeline aggregation, the `after_key` will contain, +the last bucket before filtering., +, +For the example below the last bucket can be found in `after_key` and the next, +            "after_key": {, +                "date": 1494201600000,, +                "product": "rocky", +            },, +++ b/docs/reference/aggregations/bucket/composite-aggregation.asciidoc, +            "after_key": { <1>, +                "date": 1494288000000,, +                "product": "mad max", +            },, +                    "key": {, +NOTE: The `after_key` is equals to the last bucket returned in the response before, +any filtering that could be done by <<search-aggregations-pipeline, Pipeline aggregations>>., +If all buckets are filtered/removed by a pipeline aggregation, the `after_key` will contain, +the last bucket before filtering., +, +For the example below the last bucket can be found in `after_key` and the next, +            "after_key": {, +                "date": 1494201600000,, +                "product": "rocky", +            },, +++ b/rest-api-spec/src/main/resources/rest-api-spec/test/search.aggregation/230_composite.yml, +      version: " - 6.1.99", +      reason:  bug fixed in 6.2.0, +, +---, +"Composite aggregation with after_key in the response":, +  - skip:, +      version: " - 6.99.99", +      reason:  starting in 7.0.0 after_key is returned in the response, +, +  - do:, +        search:, +          index: test, +          body:, +            aggregations:, +              test:, +                composite:, +                  sources: [, +                    {, +                      "keyword": {, +                        "terms": {, +                          "field": "keyword",, +                        }, +                      }, +                    }, +                  ], +, +  - match: {hits.total: 6}, +  - length: { aggregations.test.buckets: 2 }, +  - length: { aggregations.test.after_key: 1 }, +  - match: { aggregations.test.after_key.keyword:  "foo" }, +++ b/docs/reference/aggregations/bucket/composite-aggregation.asciidoc, +            "after_key": { <1>, +                "date": 1494288000000,, +                "product": "mad max", +            },, +                    "key": {, +NOTE: The `after_key` is equals to the last bucket returned in the response before, +any filtering that could be done by <<search-aggregations-pipeline, Pipeline aggregations>>., +If all buckets are filtered/removed by a pipeline aggregation, the `after_key` will contain, +the last bucket before filtering., +, +For the example below the last bucket can be found in `after_key` and the next, +            "after_key": {, +                "date": 1494201600000,, +                "product": "rocky", +            },, +++ b/rest-api-spec/src/main/resources/rest-api-spec/test/search.aggregation/230_composite.yml, +      version: " - 6.1.99", +      reason:  bug fixed in 6.2.0, +, +---, +"Composite aggregation with after_key in the response":, +  - skip:, +      version: " - 6.99.99", +      reason:  starting in 7.0.0 after_key is returned in the response, +, +  - do:, +        search:, +          index: test, +          body:, +            aggregations:, +              test:, +                composite:, +                  sources: [, +                    {, +                      "keyword": {, +                        "terms": {]
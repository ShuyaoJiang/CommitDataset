[+++ b/src/test/java/org/elasticsearch/count/query/SimpleQueryTests.java, +    @Test //https://github.com/elasticsearch/elasticsearch/issues/3540, +        //the mapping needs to be provided upfront otherwise we are not sure how many failures we get back, +        //as with dynamic mappings some shards might be lacking behind and parse a different query, +        assertAcked(prepareCreate("test").addMapping(, +                "type", "past", "type=date", "future", "type=date", +        ));, +, +++ b/src/test/java/org/elasticsearch/count/query/SimpleQueryTests.java, +    @Test //https://github.com/elasticsearch/elasticsearch/issues/3540, +        //the mapping needs to be provided upfront otherwise we are not sure how many failures we get back, +        //as with dynamic mappings some shards might be lacking behind and parse a different query, +        assertAcked(prepareCreate("test").addMapping(, +                "type", "past", "type=date", "future", "type=date", +        ));, +, +++ b/src/test/java/org/elasticsearch/search/query/SimpleQueryTests.java, +    @Test //https://github.com/elasticsearch/elasticsearch/issues/3540, +        //the mapping needs to be provided upfront otherwise we are not sure how many failures we get back, +        //as with dynamic mappings some shards might be lacking behind and parse a different query, +        assertAcked(prepareCreate("test").addMapping(, +                "type", "past", "type=date", "future", "type=date", +        ));]
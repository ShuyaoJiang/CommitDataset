[+++ b/src/main/java/org/elasticsearch/index/search/child/TopChildrenQuery.java, +    // Actual value can get lost during query rewriting in dfs phase, but this isn't an issue now., +    // Need to use boolean array instead of boolean primitive... b/c during query rewriting in dfs phase, +    private boolean[] properlyInvoked = new boolean[]{false};, +        properlyInvoked[0] = true;, +        if (!properlyInvoked[0]) {, +++ b/src/main/java/org/elasticsearch/index/search/child/TopChildrenQuery.java, +    // Actual value can get lost during query rewriting in dfs phase, but this isn't an issue now., +    // Need to use boolean array instead of boolean primitive... b/c during query rewriting in dfs phase, +    private boolean[] properlyInvoked = new boolean[]{false};, +        properlyInvoked[0] = true;, +        if (!properlyInvoked[0]) {, +++ b/src/test/java/org/elasticsearch/test/integration/search/child/SimpleChildQuerySearchTests.java, +, +        searchResponse = client.prepareSearch("test").setSearchType(SearchType.DFS_QUERY_THEN_FETCH), +                .setQuery(boolQuery().mustNot(hasParentQuery("parent", boolQuery().should(queryString("p_field:*"))).executionType(getExecutionMethod()))), +                .execute().actionGet();, +        assertThat("Failures " + Arrays.toString(searchResponse.shardFailures()), searchResponse.shardFailures().length, equalTo(0));, +, +        searchResponse = client.prepareSearch("test").setSearchType(SearchType.DFS_QUERY_THEN_FETCH), +                .setQuery(boolQuery().mustNot(topChildrenQuery("child", boolQuery().should(queryString("c_field:*"))))), +                .execute().actionGet();, +        assertThat("Failures " + Arrays.toString(searchResponse.shardFailures()), searchResponse.shardFailures().length, equalTo(0));]
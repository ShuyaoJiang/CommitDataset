[+++ b/modules/elasticsearch/src/main/java/org/elasticsearch/cluster/routing/IndexShardRoutingTable.java, +            ShardRouting shardRouting = this.shards.get(loc);, +            ordered.add(shardRouting);, +            if (nodeId.equals(shardRouting.currentNodeId())) {, +                // switch, its the matching node id, +                ordered.set(0, shardRouting);, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/cluster/routing/IndexShardRoutingTable.java, +            ShardRouting shardRouting = this.shards.get(loc);, +            ordered.add(shardRouting);, +            if (nodeId.equals(shardRouting.currentNodeId())) {, +                // switch, its the matching node id, +                ordered.set(0, shardRouting);, +++ b/modules/test/integration/src/test/java/org/elasticsearch/test/integration/search/preference/SearchPreferenceTests.java, +        searchResponse = client.prepareSearch().setQuery(matchAllQuery()).setPreference("_local").execute().actionGet();, +        assertThat(searchResponse.hits().totalHits(), equalTo(1l));, +        searchResponse = client.prepareSearch().setQuery(matchAllQuery()).setPreference("_primary").execute().actionGet();, +        assertThat(searchResponse.hits().totalHits(), equalTo(1l));, +        searchResponse = client.prepareSearch().setQuery(matchAllQuery()).setPreference("1234").execute().actionGet();, +        assertThat(searchResponse.hits().totalHits(), equalTo(1l));]
[+++ b/rest-api-spec/test/indices.exists/20_read_only_index.yaml, +---, +"Test indices.exists on a read only index":, +, +  - do:, +      indices.create:, +        index: test_index_ro, +, +  - do:, +      indices.put_settings:, +        index: test_index_ro, +        body:, +          index.blocks.read_only: true, +, +  - do:, +      indices.exists:, +        index: test_index_ro, +, +  - is_true: '', +, +  - do:, +      indices.put_settings:, +        index: test_index_ro, +        body:, +          index.blocks.read_only: false, +, +  - do:, +      indices.exists:, +        index: test_index_ro, +, +  - is_true: '', +++ b/rest-api-spec/test/indices.exists/20_read_only_index.yaml, +---, +"Test indices.exists on a read only index":, +, +  - do:, +      indices.create:, +        index: test_index_ro, +, +  - do:, +      indices.put_settings:, +        index: test_index_ro, +        body:, +          index.blocks.read_only: true, +, +  - do:, +      indices.exists:, +        index: test_index_ro, +, +  - is_true: '', +, +  - do:, +      indices.put_settings:, +        index: test_index_ro, +        body:, +          index.blocks.read_only: false, +, +  - do:, +      indices.exists:, +        index: test_index_ro, +, +  - is_true: '', +++ b/src/main/java/org/elasticsearch/action/admin/cluster/node/shutdown/TransportNodesShutdownAction.java, +        // Stopping a node impacts the cluster state, so we check for the METADATA_WRITE block here, +        return state.blocks().globalBlockedException(ClusterBlockLevel.METADATA_WRITE);, +++ b/rest-api-spec/test/indices.exists/20_read_only_index.yaml, +---, +"Test indices.exists on a read only index":, +, +  - do:, +      indices.create:, +        index: test_index_ro, +, +  - do:, +      indices.put_settings:, +        index: test_index_ro, +        body:, +          index.blocks.read_only: true, +, +  - do:, +      indices.exists:, +        index: test_index_ro, +, +  - is_true: '', +, +  - do:, +      indices.put_settings:, +        index: test_index_ro, +        body:, +          index.blocks.read_only: false, +, +  - do:, +      indices.exists:, +        index: test_index_ro, +, +  - is_true: '', +++ b/src/main/java/org/elasticsearch/action/admin/cluster/node/shutdown/TransportNodesShutdownAction.java, +        // Stopping a node impacts the cluster state, so we check for the METADATA_WRITE block here, +        return state.blocks().globalBlockedException(ClusterBlockLevel.METADATA_WRITE);, +++ b/src/main/java/org/elasticsearch/action/admin/cluster/repositories/delete/TransportDeleteRepositoryAction.java]
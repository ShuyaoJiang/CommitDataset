[+++ b/plugins/analysis-icu/src/main/java/org/elasticsearch/index/analysis/IcuCollationTokenFilterFactory.java, +import java.nio.file.InvalidPathException;, +            } catch (IOException | SecurityException | InvalidPathException e) {, +++ b/plugins/analysis-icu/src/main/java/org/elasticsearch/index/analysis/IcuCollationTokenFilterFactory.java, +import java.nio.file.InvalidPathException;, +            } catch (IOException | SecurityException | InvalidPathException e) {, +++ b/plugins/analysis-icu/src/test/java/org/elasticsearch/index/analysis/SimpleIcuCollationTokenFilterTests.java, +    , +    /*, +     * Test a basic custom rules (should not interfere with reading rules list, +     * in IcuCollationTokenFilterFactory and throw InvalidPathException on, +     * Windows platforms)., +     */, +    public void testBasicCustomRules() throws Exception {, +        Settings settings = Settings.builder(), +                .put("index.analysis.filter.myCollator.type", "icu_collation"), +                .put("index.analysis.filter.myCollator.rules", "&a < g"), +                .build();, +        TestAnalysis analysis = createTestAnalysis(new Index("test", "_na_"), settings, new AnalysisICUPlugin());, +, +        TokenFilterFactory filterFactory = analysis.tokenFilter.get("myCollator");, +        assertCollation(filterFactory, "green", "bird", -1);, +    }, +]
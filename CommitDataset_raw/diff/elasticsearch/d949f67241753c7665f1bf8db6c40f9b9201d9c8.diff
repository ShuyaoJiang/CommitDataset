[+++ b/src/test/java/org/elasticsearch/test/integration/indexlifecycle/IndexLifecycleActionTests.java, +import org.apache.lucene.util.LuceneTestCase.Slow;, +import java.util.Map;, +import java.util.Set;, +, +import static org.hamcrest.Matchers.*;, +, +        assertNodesPresent(clusterState.readOnlyRoutingNodes().nodesToShards(), node1, node2);, +        assertNodesPresent(clusterState.readOnlyRoutingNodes().nodesToShards(), node1, node2, node3);, +, +        assertNodesPresent(clusterState.readOnlyRoutingNodes().nodesToShards(), node3, node2);, +        assertNodesPresent(clusterState.readOnlyRoutingNodes().nodesToShards(), node3, node2);, +        assertNodesPresent(clusterState.readOnlyRoutingNodes().nodesToShards(), node1);, +        assertNodesPresent(clusterState.readOnlyRoutingNodes().nodesToShards(), node1, node2);, +        assertNodesPresent(clusterState.readOnlyRoutingNodes().nodesToShards(), node1, node2, node3);, +        assertNodesPresent(clusterState.readOnlyRoutingNodes().nodesToShards(), node3, node2);, +, +        assertNodesPresent(clusterState.readOnlyRoutingNodes().nodesToShards(), node3, node2);, +, +, +    private void assertNodesPresent(Map<String, ?> nodesToShards, String...nodes) {, +        Set<String> keySet = nodesToShards.keySet();, +        assertThat(keySet, containsInAnyOrder(nodes));, +    }]
[+++ b/src/test/java/org/elasticsearch/search/aggregations/metrics/GeoBoundsTests.java, +import org.elasticsearch.search.SearchHit;, +        // Added to debug a test failure where the terms aggregation seems to be reporting two documents with the same value for NUMBER_FIELD_NAME.  This will check that after, +        // random indexing each document only has 1 value for NUMBER_FIELD_NAME and it is the correct value. Following this initial change its seems that this call was getting , +        // more that 2000 hits (actual value was 2059) so now it will also check to ensure all hits have the correct index and type , +        long totalHits = response.getHits().totalHits();, +        for (int i = 0; i < totalHits; i++) {, +            SearchHit searchHit = response.getHits().getAt(i);, +            assertThat("Hit " + i + " with id: " + searchHit.getId(), searchHit.getIndex(), equalTo("high_card_idx"));, +            assertThat("Hit " + i + " with id: " + searchHit.getId(), searchHit.getType(), equalTo("type"));, +            SearchHitField hitField = searchHit.field(NUMBER_FIELD_NAME);, +            , +        assertThat(totalHits, equalTo(2000l));]
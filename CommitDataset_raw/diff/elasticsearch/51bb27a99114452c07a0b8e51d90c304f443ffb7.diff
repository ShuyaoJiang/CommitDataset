[+++ b/modules/ingest-common/src/main/java/org/elasticsearch/ingest/common/DateIndexNameProcessor.java, +import org.elasticsearch.script.ScriptService;, +import org.elasticsearch.script.TemplateScript;, +    private final TemplateScript.Factory indexNamePrefixTemplate;, +    private final TemplateScript.Factory dateRoundingTemplate;, +    private final TemplateScript.Factory indexNameFormatTemplate;, +                           TemplateScript.Factory indexNamePrefixTemplate, TemplateScript.Factory dateRoundingTemplate,, +                           TemplateScript.Factory indexNameFormatTemplate) {, +        this.indexNamePrefixTemplate = indexNamePrefixTemplate;, +        this.dateRoundingTemplate = dateRoundingTemplate;, +        this.indexNameFormatTemplate = indexNameFormatTemplate;, +        String indexNamePrefix = ingestDocument.renderTemplate(indexNamePrefixTemplate);, +        String indexNameFormat = ingestDocument.renderTemplate(indexNameFormatTemplate);, +        String dateRounding = ingestDocument.renderTemplate(dateRoundingTemplate);, +    TemplateScript.Factory getIndexNamePrefixTemplate() {, +        return indexNamePrefixTemplate;, +    TemplateScript.Factory getDateRoundingTemplate() {, +        return dateRoundingTemplate;, +    TemplateScript.Factory getIndexNameFormatTemplate() {, +        return indexNameFormatTemplate;, +        private final ScriptService scriptService;, +, +        public Factory(ScriptService scriptService) {, +            this.scriptService = scriptService;, +        }, +, +            TemplateScript.Factory indexNamePrefixTemplate =, +                ConfigurationUtils.compileTemplate(TYPE, tag, "index_name_prefix", indexNamePrefix, scriptService);, +            TemplateScript.Factory dateRoundingTemplate =, +                ConfigurationUtils.compileTemplate(TYPE, tag, "date_rounding", dateRounding, scriptService);, +            TemplateScript.Factory indexNameFormatTemplate =, +                ConfigurationUtils.compileTemplate(TYPE, tag, "index_name_format", indexNameFormat, scriptService);, +            return new DateIndexNameProcessor(tag, field, dateFormats, timezone, indexNamePrefixTemplate,, +                dateRoundingTemplate, indexNameFormatTemplate);, +++ b/modules/ingest-common/src/main/java/org/elasticsearch/ingest/common/DateIndexNameProcessor.java, +import org.elasticsearch.script.ScriptService;, +import org.elasticsearch.script.TemplateScript;, +    private final TemplateScript.Factory indexNamePrefixTemplate;, +    private final TemplateScript.Factory dateRoundingTemplate;, +    private final TemplateScript.Factory indexNameFormatTemplate;, +                           TemplateScript.Factory indexNamePrefixTemplate, TemplateScript.Factory dateRoundingTemplate,, +                           TemplateScript.Factory indexNameFormatTemplate) {, +        this.indexNamePrefixTemplate = indexNamePrefixTemplate;, +        this.dateRoundingTemplate = dateRoundingTemplate;, +        this.indexNameFormatTemplate = indexNameFormatTemplate;, +        String indexNamePrefix = ingestDocument.renderTemplate(indexNamePrefixTemplate);, +        String indexNameFormat = ingestDocument.renderTemplate(indexNameFormatTemplate);, +        String dateRounding = ingestDocument.renderTemplate(dateRoundingTemplate);, +    TemplateScript.Factory getIndexNamePrefixTemplate() {, +        return indexNamePrefixTemplate;, +    TemplateScript.Factory getDateRoundingTemplate() {, +        return dateRoundingTemplate;, +    TemplateScript.Factory getIndexNameFormatTemplate() {, +        return indexNameFormatTemplate;, +        private final ScriptService scriptService;, +, +        public Factory(ScriptService scriptService) {, +            this.scriptService = scriptService;, +        }, +, +            TemplateScript.Factory indexNamePrefixTemplate =, +                ConfigurationUtils.compileTemplate(TYPE, tag, "index_name_prefix", indexNamePrefix, scriptService);, +            TemplateScript.Factory dateRoundingTemplate =, +                ConfigurationUtils.compileTemplate(TYPE, tag, "date_rounding", dateRounding, scriptService);, +            TemplateScript.Factory indexNameFormatTemplate =, +                ConfigurationUtils.compileTemplate(TYPE, tag, "index_name_format", indexNameFormat, scriptService);, +            return new DateIndexNameProcessor(tag, field, dateFormats, timezone, indexNamePrefixTemplate,, +                dateRoundingTemplate, indexNameFormatTemplate);, +++ b/modules/ingest-common/src/main/java/org/elasticsearch/ingest/common/IngestCommonPlugin.java, +        processors.put(DateIndexNameProcessor.TYPE, new DateIndexNameProcessor.Factory(parameters.scriptService));, +++ b/modules/ingest-common/src/main/java/org/elasticsearch/ingest/common/DateIndexNameProcessor.java, +import org.elasticsearch.script.ScriptService;, +import org.elasticsearch.script.TemplateScript;, +    private final TemplateScript.Factory indexNamePrefixTemplate;, +    private final TemplateScript.Factory dateRoundingTemplate;, +    private final TemplateScript.Factory indexNameFormatTemplate;, +                           TemplateScript.Factory indexNamePrefixTemplate, TemplateScript.Factory dateRoundingTemplate,, +                           TemplateScript.Factory indexNameFormatTemplate) {, +        this.indexNamePrefixTemplate = indexNamePrefixTemplate;, +        this.dateRoundingTemplate = dateRoundingTemplate;, +        this.indexNameFormatTemplate = indexNameFormatTemplate;, +        String indexNamePrefix = ingestDocument.renderTemplate(indexNamePrefixTemplate);, +        String indexNameFormat = ingestDocument.renderTemplate(indexNameFormatTemplate);, +        String dateRounding = ingestDocument.renderTemplate(dateRoundingTemplate);, +    TemplateScript.Factory getIndexNamePrefixTemplate() {, +        return indexNamePrefixTemplate;, +    TemplateScript.Factory getDateRoundingTemplate() {, +        return dateRoundingTemplate;, +    TemplateScript.Factory getIndexNameFormatTemplate() {, +        return indexNameFormatTemplate;, +        private final ScriptService scriptService;, +, +        public Factory(ScriptService scriptService) {, +            this.scriptService = scriptService;, +        }, +, +            TemplateScript.Factory indexNamePrefixTemplate =, +                ConfigurationUtils.compileTemplate(TYPE, tag, "index_name_prefix", indexNamePrefix, scriptService);, +            TemplateScript.Factory dateRoundingTemplate =, +                ConfigurationUtils.compileTemplate(TYPE, tag, "date_rounding", dateRounding, scriptService);]
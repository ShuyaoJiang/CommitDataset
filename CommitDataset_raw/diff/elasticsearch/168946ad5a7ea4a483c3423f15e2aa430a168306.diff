[+++ b/core/src/main/java/org/elasticsearch/index/engine/InternalEngine.java, +            Exception documentFailure = extractDocumentFailure(index, e);, +            result = new IndexResult(documentFailure, index.version(),, +     * Inspects exception thrown when executing index or delete operations, +     *, +     * @return failure if the failure is a document specific failure (e.g. analysis chain failure), +     * @throws OperationFailedEngineException if the failure caused the engine to fail, +     * (e.g. out of disk, lucene tragic event), +    private Exception extractDocumentFailure(final Operation operation, final Exception failure) {, +        boolean isDocumentFailure;, +            isDocumentFailure = !((failure instanceof IllegalStateException || failure instanceof IOException), +                    && maybeFailEngine(operation.operationType().getLowercase(), failure));, +            isDocumentFailure = false;, +        if (isDocumentFailure) {, +            return failure;, +        } else {, +            Exception documentFailure = extractDocumentFailure(delete, e);, +            result = new DeleteResult(documentFailure, delete.version(),]
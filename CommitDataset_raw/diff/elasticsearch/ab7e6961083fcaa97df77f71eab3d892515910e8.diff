[+++ b/server/src/test/java/org/elasticsearch/index/engine/InternalEngineTests.java, +            // If the global checkpoint equals to the local checkpoint, the next force-merge will be a noop, +            // because all deleted documents are expunged in the previous force-merge already. We need to flush, +            // a new segment to make merge happen so that we can verify that all _recovery_source are pruned., +            if (globalCheckpoint.get() == engine.getLocalCheckpoint() && liveDocs.isEmpty() == false) {, +                String deleteId = randomFrom(liveDocs);, +                engine.delete(new Engine.Delete("test", deleteId, newUid(deleteId), primaryTerm.get()));, +                liveDocsWithSource.remove(deleteId);, +                liveDocs.remove(deleteId);, +                engine.flush();, +            }]
[+++ b/elasticsearch/src/test/java/org/elasticsearch/xpack/security/SecurityTribeIT.java, +import java.util.function.Predicate;, +        final Predicate<ClusterState> nodeCountPredicate = state -> state.nodes().getSize() == cluster1Nodes + cluster2Nodes + 3;, +        if (nodeCountPredicate.test(observer.observedState()) == false) {, +            CountDownLatch latch = new CountDownLatch(1);, +                    return nodeCountPredicate.test(newState);, +    }]
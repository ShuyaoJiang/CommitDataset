[+++ b/src/main/java/org/elasticsearch/indices/ttl/IndicesTTLService.java, +import org.elasticsearch.cluster.ClusterService;, +import org.elasticsearch.cluster.metadata.IndexMetaData;, +, +        IndexMetaData.addDynamicSettings(, +                "index.ttl.disable_purge", +        );, +    private final ClusterService clusterService;, +    public IndicesTTLService(Settings settings, ClusterService clusterService, IndicesService indicesService, NodeSettingsService nodeSettingsService, Client client) {, +        this.clusterService = clusterService;, +         * Returns the shards to purge, i.e. the local started primary shards that have ttl enabled and disable_purge to false, +                // check the value of disable_purge for this index, +                IndexMetaData indexMetaData = clusterService.state().metaData().index(indexService.index().name());, +                boolean disablePurge = indexMetaData.settings().getAsBoolean("index.ttl.disable_purge", false);, +                if (disablePurge) {, +                    continue;, +                }, +]
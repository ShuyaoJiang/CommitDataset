[+++ b/src/main/java/org/elasticsearch/transport/netty/MessageChannelHandler.java, +import org.elasticsearch.common.unit.ByteSizeValue;, +import org.elasticsearch.monitor.jvm.JvmInfo;, +import org.jboss.netty.handler.codec.frame.TooLongFrameException;, +    private static final long NINETY_PER_HEAP_SIZE = (long) (JvmInfo.jvmInfo().mem().heapMax().bytes() * 0.9);, +, +            // safety against too large frames being sent, +            if (dataLen > NINETY_PER_HEAP_SIZE) {, +                throw new TooLongFrameException(, +                        "transport content length received [" + new ByteSizeValue(dataLen) + "] exceeded [" + new ByteSizeValue(NINETY_PER_HEAP_SIZE) + "]");, +            }]
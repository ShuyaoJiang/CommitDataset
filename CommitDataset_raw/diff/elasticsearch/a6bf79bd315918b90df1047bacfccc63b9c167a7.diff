[+++ b/plugin/src/main/java/org/elasticsearch/xpack/security/Security.java, +import java.io.IOException;, +import java.nio.charset.StandardCharsets;, +import java.security.GeneralSecurityException;, +import java.time.Clock;, +import java.util.ArrayList;, +import java.util.Arrays;, +import java.util.Collection;, +import java.util.Collections;, +import java.util.HashMap;, +import java.util.LinkedHashSet;, +import java.util.List;, +import java.util.Map;, +import java.util.Optional;, +import java.util.Set;, +import java.util.function.BiConsumer;, +import java.util.function.Function;, +import java.util.function.Supplier;, +import java.util.function.UnaryOperator;, +import java.util.stream.Collectors;, +, +        final NativeUsersStore nativeUsersStore = new NativeUsersStore(settings, client, securityLifecycleService);, +                    new PkiRealmBootstrapCheck(settings, sslService), +++ b/plugin/src/main/java/org/elasticsearch/xpack/security/Security.java, +import java.io.IOException;, +import java.nio.charset.StandardCharsets;, +import java.security.GeneralSecurityException;, +import java.time.Clock;, +import java.util.ArrayList;, +import java.util.Arrays;, +import java.util.Collection;, +import java.util.Collections;, +import java.util.HashMap;, +import java.util.LinkedHashSet;, +import java.util.List;, +import java.util.Map;, +import java.util.Optional;, +import java.util.Set;, +import java.util.function.BiConsumer;, +import java.util.function.Function;, +import java.util.function.Supplier;, +import java.util.function.UnaryOperator;, +import java.util.stream.Collectors;, +, +        final NativeUsersStore nativeUsersStore = new NativeUsersStore(settings, client, securityLifecycleService);, +                    new PkiRealmBootstrapCheck(settings, sslService), +++ /dev/null, +++ b/plugin/src/main/java/org/elasticsearch/xpack/security/Security.java, +import java.io.IOException;, +import java.nio.charset.StandardCharsets;, +import java.security.GeneralSecurityException;, +import java.time.Clock;, +import java.util.ArrayList;, +import java.util.Arrays;, +import java.util.Collection;, +import java.util.Collections;, +import java.util.HashMap;, +import java.util.LinkedHashSet;, +import java.util.List;, +import java.util.Map;, +import java.util.Optional;, +import java.util.Set;, +import java.util.function.BiConsumer;, +import java.util.function.Function;, +import java.util.function.Supplier;, +import java.util.function.UnaryOperator;, +import java.util.stream.Collectors;, +, +        final NativeUsersStore nativeUsersStore = new NativeUsersStore(settings, client, securityLifecycleService);, +                    new PkiRealmBootstrapCheck(settings, sslService), +++ /dev/null, +++ b/plugin/src/main/java/org/elasticsearch/xpack/security/authc/esnative/NativeUsersStore.java, +    public NativeUsersStore(Settings settings, InternalClient client, SecurityLifecycleService securityLifecycleService) {, +++ b/plugin/src/main/java/org/elasticsearch/xpack/security/Security.java, +import java.io.IOException;, +import java.nio.charset.StandardCharsets;, +import java.security.GeneralSecurityException;, +import java.time.Clock;, +import java.util.ArrayList;, +import java.util.Arrays;, +import java.util.Collection;, +import java.util.Collections;, +import java.util.HashMap;, +import java.util.LinkedHashSet;, +import java.util.List;, +import java.util.Map;, +import java.util.Optional;, +import java.util.Set;, +import java.util.function.BiConsumer;, +import java.util.function.Function;, +import java.util.function.Supplier;, +import java.util.function.UnaryOperator;, +import java.util.stream.Collectors;, +, +        final NativeUsersStore nativeUsersStore = new NativeUsersStore(settings, client, securityLifecycleService);, +                    new PkiRealmBootstrapCheck(settings, sslService), +++ /dev/null, +++ b/plugin/src/main/java/org/elasticsearch/xpack/security/authc/esnative/NativeUsersStore.java, +    public NativeUsersStore(Settings settings, InternalClient client, SecurityLifecycleService securityLifecycleService) {, +++ /dev/null]
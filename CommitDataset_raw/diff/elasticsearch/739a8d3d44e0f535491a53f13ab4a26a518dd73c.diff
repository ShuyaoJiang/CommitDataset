[+++ b/test/framework/src/main/java/org/elasticsearch/index/replication/ESIndexLevelReplicationTestCase.java, +            executeResyncOnReplica(replica, request, getPrimaryShard().getPendingPrimaryTerm(), getPrimaryShard().getGlobalCheckpoint());, +    private void executeResyncOnReplica(IndexShard replica, ResyncReplicationRequest request,, +                                        long operationPrimaryTerm, long globalCheckpointOnPrimary) throws Exception {, +        final Translog.Location location;, +        final PlainActionFuture<Releasable> acquirePermitFuture = new PlainActionFuture<>();, +        replica.acquireReplicaOperationPermit(, +            operationPrimaryTerm, globalCheckpointOnPrimary, acquirePermitFuture, ThreadPool.Names.SAME, request);, +        try (Releasable ignored = acquirePermitFuture.actionGet()) {, +            location = TransportResyncReplicationAction.performOnReplica(request, replica);, +        }]
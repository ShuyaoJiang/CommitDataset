[+++ b/src/main/java/org/elasticsearch/cluster/node/DiscoveryNode.java, +    public static boolean clientNode(Settings settings) {, +        String client = settings.get("node.client");, +        return client != null && client.equals("true");, +    }, +, +    public static boolean masterNode(Settings settings) {, +        String master = settings.get("node.master");, +        if (master == null) {, +            return !clientNode(settings);, +        }, +        return master.equals("true");, +    }, +, +    public static boolean dataNode(Settings settings) {, +        String data = settings.get("data");, +        if (data == null) {, +            return !clientNode(settings);, +        }, +        return data.equals("true");, +    }, +, +++ b/src/main/java/org/elasticsearch/cluster/node/DiscoveryNode.java, +    public static boolean clientNode(Settings settings) {, +        String client = settings.get("node.client");, +        return client != null && client.equals("true");, +    }, +, +    public static boolean masterNode(Settings settings) {, +        String master = settings.get("node.master");, +        if (master == null) {, +            return !clientNode(settings);, +        }, +        return master.equals("true");, +    }, +, +    public static boolean dataNode(Settings settings) {, +        String data = settings.get("data");, +        if (data == null) {, +            return !clientNode(settings);, +        }, +        return data.equals("true");, +    }, +, +++ b/src/main/java/org/elasticsearch/gateway/local/state/meta/LocalGatewayMetaState.java, +import org.elasticsearch.cluster.node.DiscoveryNode;, +        if (DiscoveryNode.masterNode(settings)) {, +    }, +++ b/src/main/java/org/elasticsearch/cluster/node/DiscoveryNode.java, +    public static boolean clientNode(Settings settings) {, +        String client = settings.get("node.client");, +        return client != null && client.equals("true");, +    }, +, +    public static boolean masterNode(Settings settings) {, +        String master = settings.get("node.master");, +        if (master == null) {, +            return !clientNode(settings);, +        }, +        return master.equals("true");, +    }, +, +    public static boolean dataNode(Settings settings) {, +        String data = settings.get("data");, +        if (data == null) {, +            return !clientNode(settings);, +        }, +        return data.equals("true");, +    }, +, +++ b/src/main/java/org/elasticsearch/gateway/local/state/meta/LocalGatewayMetaState.java, +import org.elasticsearch.cluster.node.DiscoveryNode;, +        if (DiscoveryNode.masterNode(settings)) {, +    }, +++ b/src/main/java/org/elasticsearch/gateway/local/state/shards/LocalGatewayShardsState.java, +import org.elasticsearch.cluster.node.DiscoveryNode;, +        if (DiscoveryNode.dataNode(settings)) {, +    }]
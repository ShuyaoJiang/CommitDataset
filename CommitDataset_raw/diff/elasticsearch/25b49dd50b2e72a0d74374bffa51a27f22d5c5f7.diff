[+++ b/dev-tools/build_randomization.rb, +  tests_security_manager = (rand(10) != 9) #10 percent chance running without security manager, +  arg_line = [es_test_jvm_option1, es_test_jvm_option2, es_test_jvm_option3], +      'BUILD_DESC' => "%s,%s,%s%s,%s %s%s%s"%[File.basename(x), es_node_mode, tests_nightly ? 'nightly,':'',, +                                            test_assert_off ? ',assert off' : '', tests_security_manager ? ', security manager enabled' : ''], , +      'tests.security.manager' => tests_security_manager,, +      'tests.jvm.argline' => arg_line.join(" "),, +++ b/dev-tools/build_randomization.rb, +  tests_security_manager = (rand(10) != 9) #10 percent chance running without security manager, +  arg_line = [es_test_jvm_option1, es_test_jvm_option2, es_test_jvm_option3], +      'BUILD_DESC' => "%s,%s,%s%s,%s %s%s%s"%[File.basename(x), es_node_mode, tests_nightly ? 'nightly,':'',, +                                            test_assert_off ? ',assert off' : '', tests_security_manager ? ', security manager enabled' : ''], , +      'tests.security.manager' => tests_security_manager,, +      'tests.jvm.argline' => arg_line.join(" "),, +++ b/pom.xml, +                                <tests.security.manager>${tests.security.manager}</tests.security.manager>, +++ b/dev-tools/build_randomization.rb, +  tests_security_manager = (rand(10) != 9) #10 percent chance running without security manager, +  arg_line = [es_test_jvm_option1, es_test_jvm_option2, es_test_jvm_option3], +      'BUILD_DESC' => "%s,%s,%s%s,%s %s%s%s"%[File.basename(x), es_node_mode, tests_nightly ? 'nightly,':'',, +                                            test_assert_off ? ',assert off' : '', tests_security_manager ? ', security manager enabled' : ''], , +      'tests.security.manager' => tests_security_manager,, +      'tests.jvm.argline' => arg_line.join(" "),, +++ b/pom.xml, +                                <tests.security.manager>${tests.security.manager}</tests.security.manager>, +++ b/src/test/java/org/elasticsearch/test/ElasticsearchTestCase.java, +import org.elasticsearch.common.Strings;, +    public static final String TESTS_SECURITY_MANAGER = System.getProperty("tests.security.manager");, +, +    public static final String JAVA_SECURTY_POLICY = System.getProperty("java.security.policy");, +, +        if (Boolean.parseBoolean(Strings.hasLength(TESTS_SECURITY_MANAGER) ? TESTS_SECURITY_MANAGER : "true") && JAVA_SECURTY_POLICY != null) {, +            System.setSecurityManager(new SecurityManager());, +        }, +, +++ b/dev-tools/build_randomization.rb, +  tests_security_manager = (rand(10) != 9) #10 percent chance running without security manager, +  arg_line = [es_test_jvm_option1, es_test_jvm_option2, es_test_jvm_option3], +      'BUILD_DESC' => "%s,%s,%s%s,%s %s%s%s"%[File.basename(x), es_node_mode, tests_nightly ? 'nightly,':'',, +                                            test_assert_off ? ',assert off' : '', tests_security_manager ? ', security manager enabled' : ''], , +      'tests.security.manager' => tests_security_manager,, +      'tests.jvm.argline' => arg_line.join(" "),, +++ b/pom.xml, +                                <tests.security.manager>${tests.security.manager}</tests.security.manager>, +++ b/src/test/java/org/elasticsearch/test/ElasticsearchTestCase.java, +import org.elasticsearch.common.Strings;, +    public static final String TESTS_SECURITY_MANAGER = System.getProperty("tests.security.manager");, +, +    public static final String JAVA_SECURTY_POLICY = System.getProperty("java.security.policy");, +, +        if (Boolean.parseBoolean(Strings.hasLength(TESTS_SECURITY_MANAGER) ? TESTS_SECURITY_MANAGER : "true") && JAVA_SECURTY_POLICY != null) {, +            System.setSecurityManager(new SecurityManager());, +        }, +, +++ b/src/test/java/org/elasticsearch/test/junit/listeners/ReproduceInfoPrinter.java, +                    "tests.assertion.disabled", "tests.security.manager");]
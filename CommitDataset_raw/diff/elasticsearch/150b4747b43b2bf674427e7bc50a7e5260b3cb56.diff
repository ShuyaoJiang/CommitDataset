[+++ b/core/src/main/java/org/elasticsearch/client/transport/TransportClient.java, +import org.elasticsearch.common.inject.Module;, +                // plugin modules must be added here, before others or we can get crazy injection errors..., +                for (Module pluginModule : pluginsService.nodeModules()) {, +                    modules.add(pluginModule);, +                }, +                modules.add(new PluginsModule(pluginsService));, +                pluginsService.processModules(modules);, +, +++ b/core/src/main/java/org/elasticsearch/client/transport/TransportClient.java, +import org.elasticsearch.common.inject.Module;, +                // plugin modules must be added here, before others or we can get crazy injection errors..., +                for (Module pluginModule : pluginsService.nodeModules()) {, +                    modules.add(pluginModule);, +                }, +                modules.add(new PluginsModule(pluginsService));, +                pluginsService.processModules(modules);, +, +++ /dev/null, +++ b/core/src/main/java/org/elasticsearch/client/transport/TransportClient.java, +import org.elasticsearch.common.inject.Module;, +                // plugin modules must be added here, before others or we can get crazy injection errors..., +                for (Module pluginModule : pluginsService.nodeModules()) {, +                    modules.add(pluginModule);, +                }, +                modules.add(new PluginsModule(pluginsService));, +                pluginsService.processModules(modules);, +, +++ /dev/null, +++ b/core/src/main/java/org/elasticsearch/common/inject/ModulesBuilder.java, +    public ModulesBuilder add(Module... newModules) {, +        for (Module module : newModules) {, +++ b/core/src/main/java/org/elasticsearch/client/transport/TransportClient.java, +import org.elasticsearch.common.inject.Module;, +                // plugin modules must be added here, before others or we can get crazy injection errors..., +                for (Module pluginModule : pluginsService.nodeModules()) {, +                    modules.add(pluginModule);, +                }, +                modules.add(new PluginsModule(pluginsService));, +                pluginsService.processModules(modules);, +, +++ /dev/null, +++ b/core/src/main/java/org/elasticsearch/common/inject/ModulesBuilder.java, +    public ModulesBuilder add(Module... newModules) {, +        for (Module module : newModules) {, +++ /dev/null, +++ b/core/src/main/java/org/elasticsearch/client/transport/TransportClient.java, +import org.elasticsearch.common.inject.Module;, +                // plugin modules must be added here, before others or we can get crazy injection errors..., +                for (Module pluginModule : pluginsService.nodeModules()) {, +                    modules.add(pluginModule);, +                }, +                modules.add(new PluginsModule(pluginsService));, +                pluginsService.processModules(modules);, +, +++ /dev/null, +++ b/core/src/main/java/org/elasticsearch/common/inject/ModulesBuilder.java, +    public ModulesBuilder add(Module... newModules) {, +        for (Module module : newModules) {, +++ /dev/null, +++ b/core/src/main/java/org/elasticsearch/common/lucene/search/function/FieldValueFactorFunction.java, +        final SortedNumericDoubleValues values = this.indexFieldData.load(ctx).getDoubleValues();, +++ b/core/src/main/java/org/elasticsearch/client/transport/TransportClient.java, +import org.elasticsearch.common.inject.Module;, +                // plugin modules must be added here, before others or we can get crazy injection errors..., +                for (Module pluginModule : pluginsService.nodeModules()) {, +                    modules.add(pluginModule);, +                }, +                modules.add(new PluginsModule(pluginsService));, +                pluginsService.processModules(modules);, +, +++ /dev/null, +++ b/core/src/main/java/org/elasticsearch/common/inject/ModulesBuilder.java, +    public ModulesBuilder add(Module... newModules) {, +        for (Module module : newModules) {, +++ /dev/null, +++ b/core/src/main/java/org/elasticsearch/common/lucene/search/function/FieldValueFactorFunction.java, +        final SortedNumericDoubleValues values = this.indexFieldData.load(ctx).getDoubleValues();, +++ b/core/src/main/java/org/elasticsearch/index/IndexService.java, +            // plugin modules must be added here, before others or we can get crazy injection errors..., +            for (Module pluginModule : pluginsService.shardModules(indexSettings)) {, +                modules.add(pluginModule);, +            }, +, +            pluginsService.processModules(modules);, +, +++ b/core/src/main/java/org/elasticsearch/client/transport/TransportClient.java, +import org.elasticsearch.common.inject.Module;, +                // plugin modules must be added here, before others or we can get crazy injection errors..., +                for (Module pluginModule : pluginsService.nodeModules()) {, +                    modules.add(pluginModule);, +                }, +                modules.add(new PluginsModule(pluginsService));, +                pluginsService.processModules(modules);, +, +++ /dev/null, +++ b/core/src/main/java/org/elasticsearch/common/inject/ModulesBuilder.java, +    public ModulesBuilder add(Module... newModules) {, +        for (Module module : newModules) {, +++ /dev/null]
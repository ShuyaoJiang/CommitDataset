[+++ b/core/src/main/java/org/elasticsearch/search/SearchModule.java, +import org.elasticsearch.common.io.stream.NamedWriteable;, +    public void registerFunctionScoreParser(ScoreFunctionParser<? extends ScoreFunctionBuilder> parser) {, +        @SuppressWarnings("unchecked") NamedWriteable<? extends ScoreFunctionBuilder> sfb = parser.getBuilderPrototype();, +        namedWriteableRegistry.registerPrototype(ScoreFunctionBuilder.class, sfb);, +            QueryParser<? extends QueryBuilder> parser = parserSupplier.get();, +            @SuppressWarnings("unchecked") NamedWriteable<? extends QueryBuilder> qb = parser.getBuilderPrototype();, +            namedWriteableRegistry.registerPrototype(QueryBuilder.class, qb);]
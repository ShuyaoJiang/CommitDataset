[+++ b/core/src/main/java/org/elasticsearch/script/NativeScriptEngineService.java, +++ b/core/src/main/java/org/elasticsearch/script/NativeScriptEngineService.java, +++ b/core/src/main/java/org/elasticsearch/script/ScriptEngineService.java, +++ b/core/src/main/java/org/elasticsearch/script/NativeScriptEngineService.java, +++ b/core/src/main/java/org/elasticsearch/script/ScriptEngineService.java, +++ b/core/src/main/java/org/elasticsearch/script/mustache/MustacheScriptEngineService.java, +++ b/core/src/main/java/org/elasticsearch/script/NativeScriptEngineService.java, +++ b/core/src/main/java/org/elasticsearch/script/ScriptEngineService.java, +++ b/core/src/main/java/org/elasticsearch/script/mustache/MustacheScriptEngineService.java, +++ b/core/src/test/java/org/elasticsearch/script/MockScriptEngine.java, +++ b/core/src/main/java/org/elasticsearch/script/NativeScriptEngineService.java, +++ b/core/src/main/java/org/elasticsearch/script/ScriptEngineService.java, +++ b/core/src/main/java/org/elasticsearch/script/mustache/MustacheScriptEngineService.java, +++ b/core/src/test/java/org/elasticsearch/script/MockScriptEngine.java, +++ b/core/src/test/java/org/elasticsearch/script/ScriptModesTests.java, +++ b/core/src/main/java/org/elasticsearch/script/NativeScriptEngineService.java, +++ b/core/src/main/java/org/elasticsearch/script/ScriptEngineService.java, +++ b/core/src/main/java/org/elasticsearch/script/mustache/MustacheScriptEngineService.java, +++ b/core/src/test/java/org/elasticsearch/script/MockScriptEngine.java, +++ b/core/src/test/java/org/elasticsearch/script/ScriptModesTests.java, +++ b/core/src/test/java/org/elasticsearch/script/ScriptServiceTests.java, +++ b/core/src/main/java/org/elasticsearch/script/NativeScriptEngineService.java, +++ b/core/src/main/java/org/elasticsearch/script/ScriptEngineService.java, +++ b/core/src/main/java/org/elasticsearch/script/mustache/MustacheScriptEngineService.java, +++ b/core/src/test/java/org/elasticsearch/script/MockScriptEngine.java, +++ b/core/src/test/java/org/elasticsearch/script/ScriptModesTests.java, +++ b/core/src/test/java/org/elasticsearch/script/ScriptServiceTests.java, +++ b/core/src/test/java/org/elasticsearch/script/mustache/MustacheScriptEngineTests.java, +            BytesReference o = (BytesReference) qe.executable(new CompiledScript(ScriptService.ScriptType.INLINE, "", "mustache", qe.compile(template)), vars).run();, +            BytesReference o = (BytesReference) qe.executable(new CompiledScript(ScriptService.ScriptType.INLINE, "", "mustache", qe.compile(template)), vars).run();, +++ b/core/src/main/java/org/elasticsearch/script/NativeScriptEngineService.java, +++ b/core/src/main/java/org/elasticsearch/script/ScriptEngineService.java, +++ b/core/src/main/java/org/elasticsearch/script/mustache/MustacheScriptEngineService.java, +++ b/core/src/test/java/org/elasticsearch/script/MockScriptEngine.java, +++ b/core/src/test/java/org/elasticsearch/script/ScriptModesTests.java, +++ b/core/src/test/java/org/elasticsearch/script/ScriptServiceTests.java, +++ b/core/src/test/java/org/elasticsearch/script/mustache/MustacheScriptEngineTests.java, +            BytesReference o = (BytesReference) qe.executable(new CompiledScript(ScriptService.ScriptType.INLINE, "", "mustache", qe.compile(template)), vars).run();, +            BytesReference o = (BytesReference) qe.executable(new CompiledScript(ScriptService.ScriptType.INLINE, "", "mustache", qe.compile(template)), vars).run();, +++ b/plugins/lang-expression/src/main/java/org/elasticsearch/script/expression/ExpressionScriptEngineService.java, +++ b/core/src/main/java/org/elasticsearch/script/NativeScriptEngineService.java, +++ b/core/src/main/java/org/elasticsearch/script/ScriptEngineService.java, +++ b/core/src/main/java/org/elasticsearch/script/mustache/MustacheScriptEngineService.java, +++ b/core/src/test/java/org/elasticsearch/script/MockScriptEngine.java, +++ b/core/src/test/java/org/elasticsearch/script/ScriptModesTests.java, +++ b/core/src/test/java/org/elasticsearch/script/ScriptServiceTests.java, +++ b/core/src/test/java/org/elasticsearch/script/mustache/MustacheScriptEngineTests.java, +            BytesReference o = (BytesReference) qe.executable(new CompiledScript(ScriptService.ScriptType.INLINE, "", "mustache", qe.compile(template)), vars).run();, +            BytesReference o = (BytesReference) qe.executable(new CompiledScript(ScriptService.ScriptType.INLINE, "", "mustache", qe.compile(template)), vars).run();, +++ b/plugins/lang-expression/src/main/java/org/elasticsearch/script/expression/ExpressionScriptEngineService.java, +++ b/plugins/lang-groovy/src/main/java/org/elasticsearch/script/groovy/GroovyScriptEngineService.java, +++ b/core/src/main/java/org/elasticsearch/script/NativeScriptEngineService.java, +++ b/core/src/main/java/org/elasticsearch/script/ScriptEngineService.java, +++ b/core/src/main/java/org/elasticsearch/script/mustache/MustacheScriptEngineService.java, +++ b/core/src/test/java/org/elasticsearch/script/MockScriptEngine.java, +++ b/core/src/test/java/org/elasticsearch/script/ScriptModesTests.java, +++ b/core/src/test/java/org/elasticsearch/script/ScriptServiceTests.java, +++ b/core/src/test/java/org/elasticsearch/script/mustache/MustacheScriptEngineTests.java, +            BytesReference o = (BytesReference) qe.executable(new CompiledScript(ScriptService.ScriptType.INLINE, "", "mustache", qe.compile(template)), vars).run();, +            BytesReference o = (BytesReference) qe.executable(new CompiledScript(ScriptService.ScriptType.INLINE, "", "mustache", qe.compile(template)), vars).run();, +++ b/plugins/lang-expression/src/main/java/org/elasticsearch/script/expression/ExpressionScriptEngineService.java, +++ b/plugins/lang-groovy/src/main/java/org/elasticsearch/script/groovy/GroovyScriptEngineService.java, +++ b/plugins/lang-javascript/src/main/java/org/elasticsearch/script/javascript/JavaScriptScriptEngineService.java, +++ b/core/src/main/java/org/elasticsearch/script/NativeScriptEngineService.java, +++ b/core/src/main/java/org/elasticsearch/script/ScriptEngineService.java, +++ b/core/src/main/java/org/elasticsearch/script/mustache/MustacheScriptEngineService.java, +++ b/core/src/test/java/org/elasticsearch/script/MockScriptEngine.java, +++ b/core/src/test/java/org/elasticsearch/script/ScriptModesTests.java, +++ b/core/src/test/java/org/elasticsearch/script/ScriptServiceTests.java, +++ b/core/src/test/java/org/elasticsearch/script/mustache/MustacheScriptEngineTests.java, +            BytesReference o = (BytesReference) qe.executable(new CompiledScript(ScriptService.ScriptType.INLINE, "", "mustache", qe.compile(template)), vars).run();, +            BytesReference o = (BytesReference) qe.executable(new CompiledScript(ScriptService.ScriptType.INLINE, "", "mustache", qe.compile(template)), vars).run();, +++ b/plugins/lang-expression/src/main/java/org/elasticsearch/script/expression/ExpressionScriptEngineService.java, +++ b/plugins/lang-groovy/src/main/java/org/elasticsearch/script/groovy/GroovyScriptEngineService.java, +++ b/plugins/lang-javascript/src/main/java/org/elasticsearch/script/javascript/JavaScriptScriptEngineService.java, +++ b/plugins/lang-javascript/src/test/java/org/elasticsearch/script/javascript/JavaScriptScriptEngineTests.java, +        Object o = se.executable(new CompiledScript(ScriptService.ScriptType.INLINE, "testSimpleEquation", "js", se.compile("1 + 2")), vars).run();, +        Object o = se.executable(new CompiledScript(ScriptService.ScriptType.INLINE, "testMapAccess", "js", se.compile("obj1")), vars).run();, +        o = se.executable(new CompiledScript(ScriptService.ScriptType.INLINE, "testMapAccess", "js", se.compile("obj1.l[0]")), vars).run();, +        Object o = se.executable(new CompiledScript(ScriptService.ScriptType.INLINE, "testJavaScriptObjectToMap", "js",, +                se.compile("var obj1 = {}; obj1.prop1 = 'value1'; obj1.obj2 = {}; obj1.obj2.prop2 = 'value2'; obj1")), vars).run();, +        Object o = se.executable(new CompiledScript(ScriptService.ScriptType.INLINE, "testAccessInScript", "js",, +                se.compile("l.length")), vars).run();, +        o = se.executable(new CompiledScript(ScriptService.ScriptType.INLINE, "testAccessInScript", "js",, +                se.compile("l[0]")), vars).run();, +        o = se.executable(new CompiledScript(ScriptService.ScriptType.INLINE, "testAccessInScript", "js",, +                se.compile("l[3]")), vars).run();, +        o = se.executable(new CompiledScript(ScriptService.ScriptType.INLINE, "testAccessInScript", "js",, +                se.compile("l[3].prop1")), vars).run();, +++ b/core/src/main/java/org/elasticsearch/script/NativeScriptEngineService.java, +++ b/core/src/main/java/org/elasticsearch/script/ScriptEngineService.java, +++ b/core/src/main/java/org/elasticsearch/script/mustache/MustacheScriptEngineService.java, +++ b/core/src/test/java/org/elasticsearch/script/MockScriptEngine.java, +++ b/core/src/test/java/org/elasticsearch/script/ScriptModesTests.java, +++ b/core/src/test/java/org/elasticsearch/script/ScriptServiceTests.java, +++ b/core/src/test/java/org/elasticsearch/script/mustache/MustacheScriptEngineTests.java, +            BytesReference o = (BytesReference) qe.executable(new CompiledScript(ScriptService.ScriptType.INLINE, "", "mustache", qe.compile(template)), vars).run();, +            BytesReference o = (BytesReference) qe.executable(new CompiledScript(ScriptService.ScriptType.INLINE, "", "mustache", qe.compile(template)), vars).run();, +++ b/plugins/lang-expression/src/main/java/org/elasticsearch/script/expression/ExpressionScriptEngineService.java, +++ b/plugins/lang-groovy/src/main/java/org/elasticsearch/script/groovy/GroovyScriptEngineService.java]
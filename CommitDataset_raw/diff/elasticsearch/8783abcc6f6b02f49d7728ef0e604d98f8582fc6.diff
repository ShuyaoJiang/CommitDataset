[+++ b/src/main/java/org/elasticsearch/shield/authz/store/FileRolesStore.java, +                            Privilege.Name name = null;, +                                String namesStr = parser.text().trim();, +                                if (Strings.hasLength(namesStr)) {, +                                    String[] names = COMMA_DELIM.split(namesStr);, +                                }, +                                Set<String> names = new HashSet<>();, +                                if (!names.isEmpty()) {, +                                    name = new Privilege.Name(names);, +                                }, +                            if (name != null) {, +                            }, +                                    } else if (Strings.hasLength(currentFieldName)) {, +                                        Privilege.Name name = null;, +                                            String namesStr = parser.text().trim();, +                                            if (Strings.hasLength(namesStr)) {, +                                            }, +                                            if (!names.isEmpty()) {, +                                            }, +                                        if (name != null) {, +                                }, +++ b/src/main/java/org/elasticsearch/shield/authz/store/FileRolesStore.java, +                            Privilege.Name name = null;, +                                String namesStr = parser.text().trim();, +                                if (Strings.hasLength(namesStr)) {, +                                    String[] names = COMMA_DELIM.split(namesStr);, +                                }, +                                Set<String> names = new HashSet<>();, +                                if (!names.isEmpty()) {, +                                    name = new Privilege.Name(names);, +                                }, +                            if (name != null) {, +                            }, +                                    } else if (Strings.hasLength(currentFieldName)) {, +                                        Privilege.Name name = null;, +                                            String namesStr = parser.text().trim();, +                                            if (Strings.hasLength(namesStr)) {, +                                            }, +                                            if (!names.isEmpty()) {, +                                            }, +                                        if (name != null) {, +                                }, +++ b/src/test/java/org/elasticsearch/shield/authz/store/FileRolesStoreTests.java, +        assertThat(roles.size(), is(4));, +, +        role = roles.get("role4");, +        assertThat(role, notNullValue());, +        assertThat(role.name(), equalTo("role4"));, +        assertThat(role.cluster(), notNullValue());, +        assertThat(role.cluster(), is(Permission.Cluster.Core.NONE));, +        assertThat(role.indices(), is(Permission.Indices.Core.NONE));, +            role = store.role("role5");, +                writer.append("role5:").append(System.lineSeparator());, +            role = store.role("role5");, +            assertThat(role.name(), equalTo("role5"));, +++ b/src/main/java/org/elasticsearch/shield/authz/store/FileRolesStore.java, +                            Privilege.Name name = null;, +                                String namesStr = parser.text().trim();, +                                if (Strings.hasLength(namesStr)) {, +                                    String[] names = COMMA_DELIM.split(namesStr);, +                                }, +                                Set<String> names = new HashSet<>();, +                                if (!names.isEmpty()) {, +                                    name = new Privilege.Name(names);, +                                }, +                            if (name != null) {, +                            }, +                                    } else if (Strings.hasLength(currentFieldName)) {, +                                        Privilege.Name name = null;, +                                            String namesStr = parser.text().trim();, +                                            if (Strings.hasLength(namesStr)) {, +                                            }, +                                            if (!names.isEmpty()) {, +                                            }, +                                        if (name != null) {, +                                }, +++ b/src/test/java/org/elasticsearch/shield/authz/store/FileRolesStoreTests.java, +        assertThat(roles.size(), is(4));, +, +        role = roles.get("role4");, +        assertThat(role, notNullValue());, +        assertThat(role.name(), equalTo("role4"));, +        assertThat(role.cluster(), notNullValue());, +        assertThat(role.cluster(), is(Permission.Cluster.Core.NONE));, +        assertThat(role.indices(), is(Permission.Indices.Core.NONE));, +            role = store.role("role5");, +                writer.append("role5:").append(System.lineSeparator());, +            role = store.role("role5");, +            assertThat(role.name(), equalTo("role5"));, +++ b/src/test/resources/org/elasticsearch/shield/authz/store/roles.yml, +role4:, +  cluster:, +  indices:, +    'idx2':, +    '': READ, +    'idx1': []]
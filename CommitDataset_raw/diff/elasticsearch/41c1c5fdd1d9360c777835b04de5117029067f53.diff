[+++ b/qa/sql/src/main/java/org/elasticsearch/xpack/qa/sql/jdbc/JdbcAssert.java, +        try (ResultSet ex = expected; ResultSet ac = actual) {, +            assertResultSetMetadata(ex, ac, logger);, +            assertResultSetData(ex, ac, logger);, +        }, +    // metadata doesn't consume a ResultSet thus it shouldn't close it, +    // The ResultSet is consumed and thus it should be closed, +        try (ResultSet ex = expected; ResultSet ac = actual) {, +            doAssertResultSetData(ex, ac, logger);, +        }, +    }, +    , +    private static void doAssertResultSetData(ResultSet expected, ResultSet actual, Logger logger) throws SQLException {]
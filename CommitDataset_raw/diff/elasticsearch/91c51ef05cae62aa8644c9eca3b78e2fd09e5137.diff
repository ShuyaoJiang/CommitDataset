[+++ b/src/main/java/org/elasticsearch/action/suggest/SuggestRequestBuilder.java, +import java.io.IOException;, +, +            suggest.toXContent(builder, ToXContent.EMPTY_PARAMS);, +            request.suggest(builder.bytes());, +++ b/src/main/java/org/elasticsearch/action/suggest/SuggestRequestBuilder.java, +import java.io.IOException;, +, +            suggest.toXContent(builder, ToXContent.EMPTY_PARAMS);, +            request.suggest(builder.bytes());, +++ b/src/main/java/org/elasticsearch/action/suggest/TransportSuggestAction.java, +import java.util.HashMap;, +import java.util.List;, +import java.util.Map;, +import java.util.Set;, +import java.util.concurrent.atomic.AtomicReferenceArray;, +, +import static com.google.common.collect.Lists.newArrayList;, +, +        XContentParser parser = null;, +                parser = XContentFactory.xContent(suggest).createParser(suggest);, +                    throw new ElasticSearchIllegalArgumentException("suggest content missing");, +                final SuggestionSearchContext context = suggestPhase.parseElement().parseInternal(parser, indexService.mapperService());, +            throw new ElasticSearchException("failed to execute suggest", ex);, +            if (parser != null) {, +                parser.close();, +            }, +++ b/src/main/java/org/elasticsearch/action/suggest/SuggestRequestBuilder.java, +import java.io.IOException;, +, +            suggest.toXContent(builder, ToXContent.EMPTY_PARAMS);, +            request.suggest(builder.bytes());, +++ b/src/main/java/org/elasticsearch/action/suggest/TransportSuggestAction.java, +import java.util.HashMap;, +import java.util.List;, +import java.util.Map;, +import java.util.Set;, +import java.util.concurrent.atomic.AtomicReferenceArray;, +, +import static com.google.common.collect.Lists.newArrayList;, +, +        XContentParser parser = null;, +                parser = XContentFactory.xContent(suggest).createParser(suggest);, +                    throw new ElasticSearchIllegalArgumentException("suggest content missing");, +                final SuggestionSearchContext context = suggestPhase.parseElement().parseInternal(parser, indexService.mapperService());, +            throw new ElasticSearchException("failed to execute suggest", ex);, +            if (parser != null) {, +                parser.close();, +            }, +++ b/src/main/java/org/elasticsearch/rest/action/suggest/RestSuggestAction.java, +import org.elasticsearch.ElasticSearchIllegalArgumentException;, +import org.elasticsearch.rest.*;, +import java.io.IOException;, +, +import static org.elasticsearch.rest.RestRequest.Method.GET;, +import static org.elasticsearch.rest.RestRequest.Method.POST;, +import static org.elasticsearch.rest.RestStatus.BAD_REQUEST;, +import static org.elasticsearch.rest.RestStatus.OK;, +import static org.elasticsearch.rest.action.support.RestActions.buildBroadcastShardsHeader;, +, +                    throw new ElasticSearchIllegalArgumentException("no content or source provided to execute suggestion");, +++ b/src/main/java/org/elasticsearch/action/suggest/SuggestRequestBuilder.java, +import java.io.IOException;, +, +            suggest.toXContent(builder, ToXContent.EMPTY_PARAMS);, +            request.suggest(builder.bytes());, +++ b/src/main/java/org/elasticsearch/action/suggest/TransportSuggestAction.java, +import java.util.HashMap;, +import java.util.List;, +import java.util.Map;, +import java.util.Set;, +import java.util.concurrent.atomic.AtomicReferenceArray;, +, +import static com.google.common.collect.Lists.newArrayList;, +, +        XContentParser parser = null;, +                parser = XContentFactory.xContent(suggest).createParser(suggest);, +                    throw new ElasticSearchIllegalArgumentException("suggest content missing");, +                final SuggestionSearchContext context = suggestPhase.parseElement().parseInternal(parser, indexService.mapperService());, +            throw new ElasticSearchException("failed to execute suggest", ex);, +            if (parser != null) {, +                parser.close();, +            }, +++ b/src/main/java/org/elasticsearch/rest/action/suggest/RestSuggestAction.java, +import org.elasticsearch.ElasticSearchIllegalArgumentException;, +import org.elasticsearch.rest.*;, +import java.io.IOException;, +, +import static org.elasticsearch.rest.RestRequest.Method.GET;, +import static org.elasticsearch.rest.RestRequest.Method.POST;, +import static org.elasticsearch.rest.RestStatus.BAD_REQUEST;, +import static org.elasticsearch.rest.RestStatus.OK;, +import static org.elasticsearch.rest.action.support.RestActions.buildBroadcastShardsHeader;, +, +                    throw new ElasticSearchIllegalArgumentException("no content or source provided to execute suggestion");, +++ b/src/main/java/org/elasticsearch/search/suggest/SuggestPhase.java, +import com.google.common.collect.ImmutableMap;, +import java.io.IOException;, +import java.util.ArrayList;, +import java.util.List;]
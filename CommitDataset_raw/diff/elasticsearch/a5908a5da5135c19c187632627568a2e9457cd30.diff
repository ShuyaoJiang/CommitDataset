[+++ b/test/framework/src/main/java/org/elasticsearch/test/rest/client/RestTestClient.java, +import org.apache.http.client.config.RequestConfig;, +import org.apache.http.impl.client.HttpClientBuilder;, +import org.apache.http.impl.conn.PoolingHttpClientConnectionManager;, +    public static final int CONNECT_TIMEOUT_MILLIS = 1000;, +    public static final int SOCKET_TIMEOUT_MILLIS = 30000;, +    public static final int MAX_RETRY_TIMEOUT_MILLIS = SOCKET_TIMEOUT_MILLIS;, +    public static final int CONNECTION_REQUEST_TIMEOUT_MILLIS = 500;, +        PoolingHttpClientConnectionManager connectionManager = new PoolingHttpClientConnectionManager(socketFactoryRegistry);, +        //default settings may be too constraining, +        connectionManager.setDefaultMaxPerRoute(10);, +        connectionManager.setMaxTotal(30);, +, +        //default timeouts are all infinite, +        RequestConfig requestConfig = RequestConfig.custom().setConnectTimeout(CONNECT_TIMEOUT_MILLIS), +            .setSocketTimeout(SOCKET_TIMEOUT_MILLIS), +            .setConnectionRequestTimeout(CONNECTION_REQUEST_TIMEOUT_MILLIS).build();, +        CloseableHttpClient httpClient = HttpClientBuilder.create(), +            .setConnectionManager(connectionManager).setDefaultRequestConfig(requestConfig).build();, +        RestClient.Builder builder = RestClient.builder(hosts).setHttpClient(httpClient).setMaxRetryTimeoutMillis(MAX_RETRY_TIMEOUT_MILLIS);]
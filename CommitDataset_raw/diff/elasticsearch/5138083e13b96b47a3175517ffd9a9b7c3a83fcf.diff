[+++ b/README.textile, +h3. Upgrading to Elasticsearch 1.x?, +, +In order to ensure a smooth upgrade process from earlier versions of Elasticsearch (< 0.90.x), it is recommended to perform a full cluster restart. Please see the "Upgrading" section of the "setup reference":http://www.elasticsearch.org/guide/en/elasticsearch/reference/current/setup.html., +, +++ b/README.textile, +h3. Upgrading to Elasticsearch 1.x?, +, +In order to ensure a smooth upgrade process from earlier versions of Elasticsearch (< 0.90.x), it is recommended to perform a full cluster restart. Please see the "Upgrading" section of the "setup reference":http://www.elasticsearch.org/guide/en/elasticsearch/reference/current/setup.html., +, +++ b/docs/reference/setup.asciidoc, +, +include::setup/upgrade.asciidoc[], +++ b/README.textile, +h3. Upgrading to Elasticsearch 1.x?, +, +In order to ensure a smooth upgrade process from earlier versions of Elasticsearch (< 0.90.x), it is recommended to perform a full cluster restart. Please see the "Upgrading" section of the "setup reference":http://www.elasticsearch.org/guide/en/elasticsearch/reference/current/setup.html., +, +++ b/docs/reference/setup.asciidoc, +, +include::setup/upgrade.asciidoc[], +++ b/docs/reference/setup/upgrade.asciidoc, +[[setup-upgrade]], +== Upgrading, +, +Elasticsearch can usually be upgraded using a rolling upgrade process, resulting in no interruption of service.  This section details how to perform both rolling and restart upgrades., +, +[float], +[[backup]], +=== Back Up Your Data!, +, +Before performing an upgrade, it's a good idea to back up the data on your system.  This will allow you to roll back in the event of a problem with the upgrade.  The upgrades sometimes include upgrades to the Lucene libraries used by Elasticsearch to access the index files, and after an index file has been updated to work with a new version of Lucene, it may not be accessible to the versions of Lucene present in earlier Elasticsearch releases., +, +[float], +==== 0.90.x and earlier, +, +To back up a running 0.90.x system, first disable index flushing.  This will prevent indices from being flushed to disk while the backup is in process:, +, +[source,sh], +-----------------------------------, +$ curl -XPUT 'http://localhost:9200/_all/_settings' -d '{, +    "index": {, +        "translog.disable_flush": "true", +    }, +}', +-----------------------------------, +, +Then disable reallocation.  This will prevent the cluster from moving data files from one node to another while the backup is in process:, +, +[source,sh], +-----------------------------------, +$ curl -XPUT 'http://localhost:9200/_cluster/settings' -d '{, +    "transient" : {, +        "cluster.routing.allocation.disable_allocation": "true", +    }, +}', +-----------------------------------, +, +After reallocation and index flushing are disabled, initiate a backup of Elasticsearch's data path using your favorite backup method (tar, storage array snapshots, backup software).  When the backup is complete and data no longer needs to be read from the Elasticsearch data path, reallocation and index flushing must be re-enabled:, +, +[source,sh], +-----------------------------------, +$ curl -XPUT 'http://localhost:9200/_all/_settings' -d '{, +    "index": {, +        "translog.disable_flush": "false", +    }, +}', +, +$ curl -XPUT 'http://localhost:9200/_cluster/settings' -d '{, +    "transient" : {, +        "cluster.routing.allocation.disable_allocation": "false", +    }, +}', +-----------------------------------, +, +[float], +==== 1.0 and later, +, +To back up a running 1.0 or later system, it is simplest to use the snapshot feature.  Complete instructions for backup and restore with snapshots are available http://www.elasticsearch.org/guide/en/elasticsearch/reference/current/modules-snapshots.html[here]., +, +[float], +[[rolling-upgrades]], +=== Rolling Upgrades, +, +Within major releases after release 1.0, rolling upgrades are supported.  To perform a rolling upgrade:, +, +* Shut down a single node within the cluster., +, +[source,sh], +--------------------------------------------, +curl -XPOST 'http://localhost:9200/_cluster/nodes/_local/_shutdown', +--------------------------------------------, +, +* Confirm that all shards are correctly reallocated to the remaining running nodes., +, +* Upgrade the stopped node.  To upgrade using a zip or compressed tarball from elasticsearch.org:, +** Extract the zip or tarball to a new directory, usually in the same volume as the current Elasticsearch installation.  Do not overwrite the existing installation, as the downloaded archive will contain a default elasticsearch.yml file and will overwrite your existing configuration., +** Copy the configuration files from the old Elasticsearch installation's config directory to the new Elasticsearch installation's config directory.  Copy data files if necessary.  If data files are not located within the tarball's extraction directory, they will not have to be moved., +** The simplest solution for moving from one version to another is to have a symbolic link for 'elasticsearch' that points to the currently running version.  This link can be easily updated and will provide a stable access point to the most recent version.  Update this symbolic link if it is being used., +]
[+++ b/x-pack/plugin/ccr/qa/chain/src/test/java/org/elasticsearch/xpack/ccr/ChainIT.java, +            followIndex("leader_cluster", leaderIndexName, middleIndexName);, +            followIndex("middle_cluster", middleIndexName, followIndexName);, +    private static void followIndex(String leaderCluster, String leaderIndex, String followIndex) throws IOException {, +        request.setJsonEntity(, +                "{\"leader_cluster\": \"" + leaderCluster + "\", \"leader_index\": \"" + leaderIndex + "\", \"poll_timeout\": \"10ms\"}");, +++ b/x-pack/plugin/ccr/qa/chain/src/test/java/org/elasticsearch/xpack/ccr/ChainIT.java, +            followIndex("leader_cluster", leaderIndexName, middleIndexName);, +            followIndex("middle_cluster", middleIndexName, followIndexName);, +    private static void followIndex(String leaderCluster, String leaderIndex, String followIndex) throws IOException {, +        request.setJsonEntity(, +                "{\"leader_cluster\": \"" + leaderCluster + "\", \"leader_index\": \"" + leaderIndex + "\", \"poll_timeout\": \"10ms\"}");, +++ b/x-pack/plugin/ccr/qa/multi-cluster-with-non-compliant-license/src/test/java/org/elasticsearch/xpack/ccr/CcrMultiClusterLicenseIT.java, +            request.setJsonEntity("{\"leader_cluster\": \"leader_cluster\", \"leader_index\": \"leader\"}");, +            request.setJsonEntity("{\"leader_cluster\": \"leader_cluster\", \"leader_index\": \"leader\"}");, +++ b/x-pack/plugin/ccr/qa/chain/src/test/java/org/elasticsearch/xpack/ccr/ChainIT.java, +            followIndex("leader_cluster", leaderIndexName, middleIndexName);, +            followIndex("middle_cluster", middleIndexName, followIndexName);, +    private static void followIndex(String leaderCluster, String leaderIndex, String followIndex) throws IOException {, +        request.setJsonEntity(, +                "{\"leader_cluster\": \"" + leaderCluster + "\", \"leader_index\": \"" + leaderIndex + "\", \"poll_timeout\": \"10ms\"}");, +++ b/x-pack/plugin/ccr/qa/multi-cluster-with-non-compliant-license/src/test/java/org/elasticsearch/xpack/ccr/CcrMultiClusterLicenseIT.java, +            request.setJsonEntity("{\"leader_cluster\": \"leader_cluster\", \"leader_index\": \"leader\"}");, +            request.setJsonEntity("{\"leader_cluster\": \"leader_cluster\", \"leader_index\": \"leader\"}");, +++ b/x-pack/plugin/ccr/qa/multi-cluster-with-security/src/test/java/org/elasticsearch/xpack/ccr/FollowIndexSecurityIT.java, +            follow(allowedIndex, allowedIndex);, +            resumeFollow(allowedIndex, allowedIndex);, +            Exception e = expectThrows(ResponseException.class, () -> resumeFollow(allowedIndex, allowedIndex));, +            e = expectThrows(ResponseException.class, () -> follow(unallowedIndex, unallowedIndex));, +            e = expectThrows(ResponseException.class, () -> follow(unallowedIndex, allowedIndex));, +            e = expectThrows(ResponseException.class, () -> resumeFollow(unallowedIndex, unallowedIndex));, +        request.setJsonEntity("{\"leader_cluster\": \"leader_cluster\", \"leader_index\": \"" + leaderIndex +, +            "\", \"poll_timeout\": \"10ms\"}");, +        request.setJsonEntity("{\"leader_cluster\": \"leader_cluster\", \"leader_index\": \"" + leaderIndex +, +            "\", \"poll_timeout\": \"10ms\"}");, +        request.setJsonEntity("{\"query\": {\"term\": {\"ccr_stats.leader_index\": \"" + expectedLeaderIndex + "\"}}}");, +++ b/x-pack/plugin/ccr/qa/chain/src/test/java/org/elasticsearch/xpack/ccr/ChainIT.java, +            followIndex("leader_cluster", leaderIndexName, middleIndexName);, +            followIndex("middle_cluster", middleIndexName, followIndexName);, +    private static void followIndex(String leaderCluster, String leaderIndex, String followIndex) throws IOException {, +        request.setJsonEntity(, +                "{\"leader_cluster\": \"" + leaderCluster + "\", \"leader_index\": \"" + leaderIndex + "\", \"poll_timeout\": \"10ms\"}");, +++ b/x-pack/plugin/ccr/qa/multi-cluster-with-non-compliant-license/src/test/java/org/elasticsearch/xpack/ccr/CcrMultiClusterLicenseIT.java, +            request.setJsonEntity("{\"leader_cluster\": \"leader_cluster\", \"leader_index\": \"leader\"}");, +            request.setJsonEntity("{\"leader_cluster\": \"leader_cluster\", \"leader_index\": \"leader\"}");, +++ b/x-pack/plugin/ccr/qa/multi-cluster-with-security/src/test/java/org/elasticsearch/xpack/ccr/FollowIndexSecurityIT.java, +            follow(allowedIndex, allowedIndex);, +            resumeFollow(allowedIndex, allowedIndex);, +            Exception e = expectThrows(ResponseException.class, () -> resumeFollow(allowedIndex, allowedIndex));, +            e = expectThrows(ResponseException.class, () -> follow(unallowedIndex, unallowedIndex));, +            e = expectThrows(ResponseException.class, () -> follow(unallowedIndex, allowedIndex));, +            e = expectThrows(ResponseException.class, () -> resumeFollow(unallowedIndex, unallowedIndex));, +        request.setJsonEntity("{\"leader_cluster\": \"leader_cluster\", \"leader_index\": \"" + leaderIndex +, +            "\", \"poll_timeout\": \"10ms\"}");, +        request.setJsonEntity("{\"leader_cluster\": \"leader_cluster\", \"leader_index\": \"" + leaderIndex +, +            "\", \"poll_timeout\": \"10ms\"}");, +        request.setJsonEntity("{\"query\": {\"term\": {\"ccr_stats.leader_index\": \"" + expectedLeaderIndex + "\"}}}");, +++ b/x-pack/plugin/ccr/qa/multi-cluster/src/test/java/org/elasticsearch/xpack/ccr/FollowIndexIT.java, +            followIndex(leaderIndexName, followIndexName);, +            resumeFollow(leaderIndexName, followIndexName);, +            Exception e = expectThrows(ResponseException.class, () -> resumeFollow(leaderIndexName, followIndexName));, +        ResponseException e = expectThrows(ResponseException.class, () -> resumeFollow("non-existing-index", "non-existing-index"));, +        e = expectThrows(ResponseException.class, () -> followIndex("non-existing-index", "non-existing-index"));, +        request.setJsonEntity("{\"leader_cluster\": \"leader_cluster\", \"leader_index\": \"" + leaderIndex +, +            "\", \"poll_timeout\": \"10ms\"}");, +        request.setJsonEntity("{\"leader_cluster\": \"leader_cluster\", \"leader_index\": \"" + leaderIndex +, +            "\", \"poll_timeout\": \"10ms\"}");, +        request.setJsonEntity("{\"query\": {\"term\": {\"ccr_stats.leader_index\": \"" + expectedLeaderIndex + "\"}}}");, +++ b/x-pack/plugin/ccr/qa/chain/src/test/java/org/elasticsearch/xpack/ccr/ChainIT.java, +            followIndex("leader_cluster", leaderIndexName, middleIndexName);, +            followIndex("middle_cluster", middleIndexName, followIndexName);, +    private static void followIndex(String leaderCluster, String leaderIndex, String followIndex) throws IOException {, +        request.setJsonEntity(, +                "{\"leader_cluster\": \"" + leaderCluster + "\", \"leader_index\": \"" + leaderIndex + "\", \"poll_timeout\": \"10ms\"}");, +++ b/x-pack/plugin/ccr/qa/multi-cluster-with-non-compliant-license/src/test/java/org/elasticsearch/xpack/ccr/CcrMultiClusterLicenseIT.java, +            request.setJsonEntity("{\"leader_cluster\": \"leader_cluster\", \"leader_index\": \"leader\"}");, +            request.setJsonEntity("{\"leader_cluster\": \"leader_cluster\", \"leader_index\": \"leader\"}");, +++ b/x-pack/plugin/ccr/qa/multi-cluster-with-security/src/test/java/org/elasticsearch/xpack/ccr/FollowIndexSecurityIT.java, +            follow(allowedIndex, allowedIndex);, +            resumeFollow(allowedIndex, allowedIndex);, +            Exception e = expectThrows(ResponseException.class, () -> resumeFollow(allowedIndex, allowedIndex));, +            e = expectThrows(ResponseException.class, () -> follow(unallowedIndex, unallowedIndex));, +            e = expectThrows(ResponseException.class, () -> follow(unallowedIndex, allowedIndex));, +            e = expectThrows(ResponseException.class, () -> resumeFollow(unallowedIndex, unallowedIndex));, +        request.setJsonEntity("{\"leader_cluster\": \"leader_cluster\", \"leader_index\": \"" + leaderIndex +, +            "\", \"poll_timeout\": \"10ms\"}");, +        request.setJsonEntity("{\"leader_cluster\": \"leader_cluster\", \"leader_index\": \"" + leaderIndex +, +            "\", \"poll_timeout\": \"10ms\"}");, +        request.setJsonEntity("{\"query\": {\"term\": {\"ccr_stats.leader_index\": \"" + expectedLeaderIndex + "\"}}}");, +++ b/x-pack/plugin/ccr/qa/multi-cluster/src/test/java/org/elasticsearch/xpack/ccr/FollowIndexIT.java, +            followIndex(leaderIndexName, followIndexName);, +            resumeFollow(leaderIndexName, followIndexName);, +            Exception e = expectThrows(ResponseException.class, () -> resumeFollow(leaderIndexName, followIndexName));, +        ResponseException e = expectThrows(ResponseException.class, () -> resumeFollow("non-existing-index", "non-existing-index"));, +        e = expectThrows(ResponseException.class, () -> followIndex("non-existing-index", "non-existing-index"));, +        request.setJsonEntity("{\"leader_cluster\": \"leader_cluster\", \"leader_index\": \"" + leaderIndex +, +            "\", \"poll_timeout\": \"10ms\"}");, +        request.setJsonEntity("{\"leader_cluster\": \"leader_cluster\", \"leader_index\": \"" + leaderIndex +, +            "\", \"poll_timeout\": \"10ms\"}");, +        request.setJsonEntity("{\"query\": {\"term\": {\"ccr_stats.leader_index\": \"" + expectedLeaderIndex + "\"}}}");]
[+++ b/test/framework/src/main/java/org/elasticsearch/test/ESTestCase.java, +    @BeforeClass, +    public static void ensureSupportedLocale() {, +        if (isUnusableLocale()) {, +            Logger logger = LogManager.getLogger(ESTestCase.class);, +            logger.warn("Attempting to run tests in an unusable locale in a FIPS JVM. Certificate expiration validation will fail, " +, +                "switching to English. See: https://github.com/bcgit/bc-java/issues/405");, +            Locale.setDefault(Locale.ENGLISH);, +        }, +    }, +, +    private static boolean isUnusableLocale() {, +        return inFipsJvm() && (Locale.getDefault().toLanguageTag().equals("th-TH"), +            || Locale.getDefault().toLanguageTag().equals("ja-JP-u-ca-japanese-x-lvariant-JP"), +            || Locale.getDefault().toLanguageTag().equals("th-TH-u-nu-thai-x-lvariant-TH"));, +    }, +, +++ b/test/framework/src/main/java/org/elasticsearch/test/ESTestCase.java, +    @BeforeClass, +    public static void ensureSupportedLocale() {, +        if (isUnusableLocale()) {, +            Logger logger = LogManager.getLogger(ESTestCase.class);, +            logger.warn("Attempting to run tests in an unusable locale in a FIPS JVM. Certificate expiration validation will fail, " +, +                "switching to English. See: https://github.com/bcgit/bc-java/issues/405");, +            Locale.setDefault(Locale.ENGLISH);, +        }, +    }, +, +    private static boolean isUnusableLocale() {, +        return inFipsJvm() && (Locale.getDefault().toLanguageTag().equals("th-TH"), +            || Locale.getDefault().toLanguageTag().equals("ja-JP-u-ca-japanese-x-lvariant-JP"), +            || Locale.getDefault().toLanguageTag().equals("th-TH-u-nu-thai-x-lvariant-TH"));, +    }, +, +++ b/x-pack/plugin/core/src/test/java/org/elasticsearch/xpack/core/ssl/RestrictedTrustManagerTests.java, +++ b/test/framework/src/main/java/org/elasticsearch/test/ESTestCase.java, +    @BeforeClass, +    public static void ensureSupportedLocale() {, +        if (isUnusableLocale()) {, +            Logger logger = LogManager.getLogger(ESTestCase.class);, +            logger.warn("Attempting to run tests in an unusable locale in a FIPS JVM. Certificate expiration validation will fail, " +, +                "switching to English. See: https://github.com/bcgit/bc-java/issues/405");, +            Locale.setDefault(Locale.ENGLISH);, +        }, +    }, +, +    private static boolean isUnusableLocale() {, +        return inFipsJvm() && (Locale.getDefault().toLanguageTag().equals("th-TH"), +            || Locale.getDefault().toLanguageTag().equals("ja-JP-u-ca-japanese-x-lvariant-JP"), +            || Locale.getDefault().toLanguageTag().equals("th-TH-u-nu-thai-x-lvariant-TH"));, +    }, +, +++ b/x-pack/plugin/core/src/test/java/org/elasticsearch/xpack/core/ssl/RestrictedTrustManagerTests.java, +++ b/x-pack/plugin/security/src/test/java/org/elasticsearch/xpack/security/authc/saml/SamlTestCase.java, +    public static void restoreLocale() {, +++ b/test/framework/src/main/java/org/elasticsearch/test/ESTestCase.java, +    @BeforeClass, +    public static void ensureSupportedLocale() {, +        if (isUnusableLocale()) {, +            Logger logger = LogManager.getLogger(ESTestCase.class);, +            logger.warn("Attempting to run tests in an unusable locale in a FIPS JVM. Certificate expiration validation will fail, " +, +                "switching to English. See: https://github.com/bcgit/bc-java/issues/405");, +            Locale.setDefault(Locale.ENGLISH);, +        }, +    }, +, +    private static boolean isUnusableLocale() {, +        return inFipsJvm() && (Locale.getDefault().toLanguageTag().equals("th-TH"), +            || Locale.getDefault().toLanguageTag().equals("ja-JP-u-ca-japanese-x-lvariant-JP"), +            || Locale.getDefault().toLanguageTag().equals("th-TH-u-nu-thai-x-lvariant-TH"));, +    }, +, +++ b/x-pack/plugin/core/src/test/java/org/elasticsearch/xpack/core/ssl/RestrictedTrustManagerTests.java, +++ b/x-pack/plugin/security/src/test/java/org/elasticsearch/xpack/security/authc/saml/SamlTestCase.java, +    public static void restoreLocale() {, +++ b/x-pack/qa/evil-tests/src/test/java/org/elasticsearch/xpack/security/authc/kerberos/KerberosTestCase.java, +    public static void restoreLocale() {]
[+++ b/server/src/main/java/org/elasticsearch/cluster/ClusterModule.java, +++ b/server/src/main/java/org/elasticsearch/cluster/ClusterModule.java, +++ b/server/src/main/java/org/elasticsearch/cluster/service/ClusterApplier.java, +++ b/server/src/main/java/org/elasticsearch/cluster/ClusterModule.java, +++ b/server/src/main/java/org/elasticsearch/cluster/service/ClusterApplier.java, +++ b/server/src/main/java/org/elasticsearch/cluster/service/ClusterApplierService.java, +    public ClusterApplierService(Settings settings, ClusterSettings clusterSettings, ThreadPool threadPool) {, +++ b/server/src/main/java/org/elasticsearch/cluster/ClusterModule.java, +++ b/server/src/main/java/org/elasticsearch/cluster/service/ClusterApplier.java, +++ b/server/src/main/java/org/elasticsearch/cluster/service/ClusterApplierService.java, +    public ClusterApplierService(Settings settings, ClusterSettings clusterSettings, ThreadPool threadPool) {, +++ b/server/src/main/java/org/elasticsearch/cluster/service/ClusterService.java, +    public ClusterService(Settings settings, ClusterSettings clusterSettings, ThreadPool threadPool) {, +        this.clusterApplierService = new ClusterApplierService(settings, clusterSettings, threadPool);, +++ b/server/src/main/java/org/elasticsearch/cluster/ClusterModule.java, +++ b/server/src/main/java/org/elasticsearch/cluster/service/ClusterApplier.java, +++ b/server/src/main/java/org/elasticsearch/cluster/service/ClusterApplierService.java, +    public ClusterApplierService(Settings settings, ClusterSettings clusterSettings, ThreadPool threadPool) {, +++ b/server/src/main/java/org/elasticsearch/cluster/service/ClusterService.java, +    public ClusterService(Settings settings, ClusterSettings clusterSettings, ThreadPool threadPool) {, +        this.clusterApplierService = new ClusterApplierService(settings, clusterSettings, threadPool);, +++ b/server/src/main/java/org/elasticsearch/discovery/single/SingleNodeDiscovery.java, +import org.elasticsearch.cluster.ClusterName;, +        ClusterState.Builder builder = ClusterState.builder(ClusterName.CLUSTER_NAME_SETTING.get(settings));, +++ b/server/src/main/java/org/elasticsearch/cluster/ClusterModule.java, +++ b/server/src/main/java/org/elasticsearch/cluster/service/ClusterApplier.java, +++ b/server/src/main/java/org/elasticsearch/cluster/service/ClusterApplierService.java, +    public ClusterApplierService(Settings settings, ClusterSettings clusterSettings, ThreadPool threadPool) {, +++ b/server/src/main/java/org/elasticsearch/cluster/service/ClusterService.java, +    public ClusterService(Settings settings, ClusterSettings clusterSettings, ThreadPool threadPool) {, +        this.clusterApplierService = new ClusterApplierService(settings, clusterSettings, threadPool);, +++ b/server/src/main/java/org/elasticsearch/discovery/single/SingleNodeDiscovery.java, +import org.elasticsearch.cluster.ClusterName;, +        ClusterState.Builder builder = ClusterState.builder(ClusterName.CLUSTER_NAME_SETTING.get(settings));, +++ b/server/src/main/java/org/elasticsearch/discovery/zen/ZenDiscovery.java, +            ClusterState.Builder builder = ClusterState.builder(ClusterName.CLUSTER_NAME_SETTING.get(settings));, +++ b/server/src/main/java/org/elasticsearch/cluster/ClusterModule.java, +++ b/server/src/main/java/org/elasticsearch/cluster/service/ClusterApplier.java, +++ b/server/src/main/java/org/elasticsearch/cluster/service/ClusterApplierService.java, +    public ClusterApplierService(Settings settings, ClusterSettings clusterSettings, ThreadPool threadPool) {, +++ b/server/src/main/java/org/elasticsearch/cluster/service/ClusterService.java, +    public ClusterService(Settings settings, ClusterSettings clusterSettings, ThreadPool threadPool) {, +        this.clusterApplierService = new ClusterApplierService(settings, clusterSettings, threadPool);, +++ b/server/src/main/java/org/elasticsearch/discovery/single/SingleNodeDiscovery.java, +import org.elasticsearch.cluster.ClusterName;, +        ClusterState.Builder builder = ClusterState.builder(ClusterName.CLUSTER_NAME_SETTING.get(settings));, +++ b/server/src/main/java/org/elasticsearch/discovery/zen/ZenDiscovery.java, +            ClusterState.Builder builder = ClusterState.builder(ClusterName.CLUSTER_NAME_SETTING.get(settings));, +++ b/server/src/main/java/org/elasticsearch/gateway/Gateway.java, +import org.elasticsearch.cluster.ClusterName;, +        ClusterState.Builder builder = ClusterState.builder(ClusterName.CLUSTER_NAME_SETTING.get(settings));, +++ b/server/src/main/java/org/elasticsearch/cluster/ClusterModule.java, +++ b/server/src/main/java/org/elasticsearch/cluster/service/ClusterApplier.java, +++ b/server/src/main/java/org/elasticsearch/cluster/service/ClusterApplierService.java, +    public ClusterApplierService(Settings settings, ClusterSettings clusterSettings, ThreadPool threadPool) {, +++ b/server/src/main/java/org/elasticsearch/cluster/service/ClusterService.java, +    public ClusterService(Settings settings, ClusterSettings clusterSettings, ThreadPool threadPool) {, +        this.clusterApplierService = new ClusterApplierService(settings, clusterSettings, threadPool);, +++ b/server/src/main/java/org/elasticsearch/discovery/single/SingleNodeDiscovery.java, +import org.elasticsearch.cluster.ClusterName;, +        ClusterState.Builder builder = ClusterState.builder(ClusterName.CLUSTER_NAME_SETTING.get(settings));, +++ b/server/src/main/java/org/elasticsearch/discovery/zen/ZenDiscovery.java, +            ClusterState.Builder builder = ClusterState.builder(ClusterName.CLUSTER_NAME_SETTING.get(settings));, +++ b/server/src/main/java/org/elasticsearch/gateway/Gateway.java, +import org.elasticsearch.cluster.ClusterName;, +        ClusterState.Builder builder = ClusterState.builder(ClusterName.CLUSTER_NAME_SETTING.get(settings));, +++ b/server/src/main/java/org/elasticsearch/node/Node.java, +            final ClusterService clusterService = new ClusterService(settings, settingsModule.getClusterSettings(), threadPool);, +++ b/server/src/main/java/org/elasticsearch/cluster/ClusterModule.java, +++ b/server/src/main/java/org/elasticsearch/cluster/service/ClusterApplier.java, +++ b/server/src/main/java/org/elasticsearch/cluster/service/ClusterApplierService.java, +    public ClusterApplierService(Settings settings, ClusterSettings clusterSettings, ThreadPool threadPool) {, +++ b/server/src/main/java/org/elasticsearch/cluster/service/ClusterService.java, +    public ClusterService(Settings settings, ClusterSettings clusterSettings, ThreadPool threadPool) {, +        this.clusterApplierService = new ClusterApplierService(settings, clusterSettings, threadPool);, +++ b/server/src/main/java/org/elasticsearch/discovery/single/SingleNodeDiscovery.java, +import org.elasticsearch.cluster.ClusterName;, +        ClusterState.Builder builder = ClusterState.builder(ClusterName.CLUSTER_NAME_SETTING.get(settings));, +++ b/server/src/main/java/org/elasticsearch/discovery/zen/ZenDiscovery.java, +            ClusterState.Builder builder = ClusterState.builder(ClusterName.CLUSTER_NAME_SETTING.get(settings));, +++ b/server/src/main/java/org/elasticsearch/gateway/Gateway.java, +import org.elasticsearch.cluster.ClusterName;, +        ClusterState.Builder builder = ClusterState.builder(ClusterName.CLUSTER_NAME_SETTING.get(settings));, +++ b/server/src/main/java/org/elasticsearch/node/Node.java, +            final ClusterService clusterService = new ClusterService(settings, settingsModule.getClusterSettings(), threadPool);, +++ b/server/src/main/java/org/elasticsearch/plugins/ClusterPlugin.java, +++ b/server/src/main/java/org/elasticsearch/cluster/ClusterModule.java, +++ b/server/src/main/java/org/elasticsearch/cluster/service/ClusterApplier.java, +++ b/server/src/main/java/org/elasticsearch/cluster/service/ClusterApplierService.java, +    public ClusterApplierService(Settings settings, ClusterSettings clusterSettings, ThreadPool threadPool) {, +++ b/server/src/main/java/org/elasticsearch/cluster/service/ClusterService.java, +    public ClusterService(Settings settings, ClusterSettings clusterSettings, ThreadPool threadPool) {, +        this.clusterApplierService = new ClusterApplierService(settings, clusterSettings, threadPool);, +++ b/server/src/main/java/org/elasticsearch/discovery/single/SingleNodeDiscovery.java, +import org.elasticsearch.cluster.ClusterName;, +        ClusterState.Builder builder = ClusterState.builder(ClusterName.CLUSTER_NAME_SETTING.get(settings));, +++ b/server/src/main/java/org/elasticsearch/discovery/zen/ZenDiscovery.java, +            ClusterState.Builder builder = ClusterState.builder(ClusterName.CLUSTER_NAME_SETTING.get(settings));, +++ b/server/src/main/java/org/elasticsearch/gateway/Gateway.java, +import org.elasticsearch.cluster.ClusterName;]
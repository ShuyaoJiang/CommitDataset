[+++ b/docs/reference/migration/migrate_2_0.asciidoc, +, +=== Routing, +, +The default hash function that is used for routing has been changed from djb2 to, +murmur3. This change should be transparent unless you relied on very specific, +properties of djb2. This will help ensure a better balance of the document counts, +between shards., +, +In addition, the following node settings related to routing have been deprecated:, +, +[horizontal], +, +`cluster.routing.operation.hash.type`::, +, +  This was an undocumented setting that allowed to configure which hash function, +  to use for routing. `murmur3` is now enforced on new indices., +, +`cluster.routing.operation.use_type`::, +, +  This was an undocumented setting that allowed to take the `_type` of the, +  document into account when computing its shard (default: `false`). `false` is, +  now enforced on new indices., +++ b/docs/reference/migration/migrate_2_0.asciidoc, +, +=== Routing, +, +The default hash function that is used for routing has been changed from djb2 to, +murmur3. This change should be transparent unless you relied on very specific, +properties of djb2. This will help ensure a better balance of the document counts, +between shards., +, +In addition, the following node settings related to routing have been deprecated:, +, +[horizontal], +, +`cluster.routing.operation.hash.type`::, +, +  This was an undocumented setting that allowed to configure which hash function, +  to use for routing. `murmur3` is now enforced on new indices., +, +`cluster.routing.operation.use_type`::, +, +  This was an undocumented setting that allowed to take the `_type` of the, +  document into account when computing its shard (default: `false`). `false` is, +  now enforced on new indices., +++ b/rest-api-spec/test/delete/50_refresh.yaml, +# If you wonder why this document get 3 as an id instead of 2, it is because the, +# current routing algorithm would route 1 and 2 to the same shard while we need, +# them to be different for this test to pass, +          id:      3, +            query:   { terms: { _id: [1,3] }}, +            query:   { terms: { _id: [1,3] }}, +          id:      3, +            query:   { terms: { _id: [1,3] }}, +++ b/docs/reference/migration/migrate_2_0.asciidoc, +, +=== Routing, +, +The default hash function that is used for routing has been changed from djb2 to, +murmur3. This change should be transparent unless you relied on very specific, +properties of djb2. This will help ensure a better balance of the document counts, +between shards., +, +In addition, the following node settings related to routing have been deprecated:, +, +[horizontal], +, +`cluster.routing.operation.hash.type`::, +, +  This was an undocumented setting that allowed to configure which hash function, +  to use for routing. `murmur3` is now enforced on new indices., +, +`cluster.routing.operation.use_type`::, +, +  This was an undocumented setting that allowed to take the `_type` of the, +  document into account when computing its shard (default: `false`). `false` is, +  now enforced on new indices., +++ b/rest-api-spec/test/delete/50_refresh.yaml, +# If you wonder why this document get 3 as an id instead of 2, it is because the, +# current routing algorithm would route 1 and 2 to the same shard while we need, +# them to be different for this test to pass, +          id:      3, +            query:   { terms: { _id: [1,3] }}, +            query:   { terms: { _id: [1,3] }}, +          id:      3, +            query:   { terms: { _id: [1,3] }}, +++ b/src/main/java/org/elasticsearch/cluster/metadata/IndexMetaData.java, +import org.elasticsearch.cluster.routing.operation.hash.HashFunction;, +import org.elasticsearch.cluster.routing.operation.hash.murmur3.Murmur3HashFunction;, +    public static final String SETTING_LEGACY_ROUTING_HASH_FUNCTION = "index.legacy.routing.hash.type";, +    public static final String SETTING_LEGACY_ROUTING_USE_TYPE = "index.legacy.routing.use_type";, +    // hard-coded hash function as of 2.0, +    // older indices will read which hash function to use in their index settings, +    private static final HashFunction MURMUR3_HASH_FUNCTION = new Murmur3HashFunction();, +, +    private final Version indexCreatedVersion;, +    private final HashFunction routingHashFunction;, +    private final boolean useTypeForRouting;, +]
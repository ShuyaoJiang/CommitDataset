[+++ b/modules/elasticsearch/src/main/java/org/elasticsearch/search/facets/terms/TermsFacetCollector.java, +            aggregator = new AggregatorValueProc(popFacets(), excluded, pattern, this.scriptFunction, this.params);, +                if (scriptValue == null) {, +                    return;, +                }, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/search/facets/terms/TermsFacetCollector.java, +            aggregator = new AggregatorValueProc(popFacets(), excluded, pattern, this.scriptFunction, this.params);, +                if (scriptValue == null) {, +                    return;, +                }, +++ b/modules/test/integration/src/test/java/org/elasticsearch/test/integration/search/facets/SimpleFacetsTests.java, +, +        searchResponse = client.prepareSearch(), +                .setQuery(matchAllQuery()), +                .addFacet(termsFacet("facet1").field("tag").size(10).script("term == 'xxx' ? false : true").order(TermsFacet.ComparatorType.TERM)), +                .execute().actionGet();, +, +        facet = searchResponse.facets().facet("facet1");, +        assertThat(facet.name(), equalTo("facet1"));, +        assertThat(facet.entries().size(), equalTo(2));, +        assertThat(facet.entries().get(0).term(), equalTo("yyy"));, +        assertThat(facet.entries().get(0).count(), equalTo(2));, +        assertThat(facet.entries().get(1).term(), equalTo("zzz"));, +        assertThat(facet.entries().get(1).count(), equalTo(1));]
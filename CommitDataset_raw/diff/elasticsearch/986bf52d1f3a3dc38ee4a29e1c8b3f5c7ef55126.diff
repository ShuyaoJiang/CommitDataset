[+++ b/.ci/packer_cache.sh, +JAVA_HOME="${HOME}"/.java/${ES_BUILD_JAVA} ./gradlew resolveAllDependencies --parallel, +++ b/.ci/packer_cache.sh, +JAVA_HOME="${HOME}"/.java/${ES_BUILD_JAVA} ./gradlew resolveAllDependencies --parallel, +++ b/TESTING.asciidoc, +++ b/.ci/packer_cache.sh, +JAVA_HOME="${HOME}"/.java/${ES_BUILD_JAVA} ./gradlew resolveAllDependencies --parallel, +++ b/TESTING.asciidoc, +++ b/build.gradle, +final boolean bwc_tests_enabled = false, +final String bwc_tests_disabled_issue = "https://github.com/elastic/elasticsearch/issues/32006" // BWC handled at a later time, +++ b/.ci/packer_cache.sh, +JAVA_HOME="${HOME}"/.java/${ES_BUILD_JAVA} ./gradlew resolveAllDependencies --parallel, +++ b/TESTING.asciidoc, +++ b/build.gradle, +final boolean bwc_tests_enabled = false, +final String bwc_tests_disabled_issue = "https://github.com/elastic/elasticsearch/issues/32006" // BWC handled at a later time, +++ b/buildSrc/build.gradle, +++ b/.ci/packer_cache.sh, +JAVA_HOME="${HOME}"/.java/${ES_BUILD_JAVA} ./gradlew resolveAllDependencies --parallel, +++ b/TESTING.asciidoc, +++ b/build.gradle, +final boolean bwc_tests_enabled = false, +final String bwc_tests_disabled_issue = "https://github.com/elastic/elasticsearch/issues/32006" // BWC handled at a later time, +++ b/buildSrc/build.gradle, +++ b/buildSrc/src/main/groovy/org/elasticsearch/gradle/BuildPlugin.groovy, +                println "  Compiler JDK Version  : ${getPaddedMajorVersion(compilerJavaVersionEnum)} (${compilerJavaVersionDetails})", +                println "  Runtime JDK Version   : ${getPaddedMajorVersion(runtimeJavaVersionEnum)} (${runtimeJavaVersionDetails})", +                println "  Gradle JDK Version    : ${getPaddedMajorVersion(JavaVersion.toVersion(gradleJavaVersion))} (${gradleJavaVersionDetails})", +                println "  JDK Version           : ${getPaddedMajorVersion(JavaVersion.toVersion(gradleJavaVersion))} (${gradleJavaVersionDetails})", +    private static String getPaddedMajorVersion(JavaVersion compilerJavaVersionEnum) {, +        compilerJavaVersionEnum.getMajorVersion().toString().padLeft(2), +    }, +, +        String defaultParallel = 'auto', +        // Count physical cores on any Linux distro ( don't count hyper-threading ), +        if (project.file("/proc/cpuinfo").exists()) {, +            Map<String, Integer> socketToCore = [:], +            String currentID = "", +            project.file("/proc/cpuinfo").readLines().forEach({ line ->, +                if (line.contains(":")) {, +                    List<String> parts = line.split(":", 2).collect({it.trim()}), +                    String name = parts[0], value = parts[1], +                    // the ID of the CPU socket, +                    if (name == "physical id") {, +                        currentID = value, +                    }, +                    // Number  of cores not including hyper-threading, +                    if (name == "cpu cores") {, +                        assert currentID.isEmpty() == false, +                        socketToCore[currentID] = Integer.valueOf(value), +                        currentID = "", +                    }, +                }, +            }), +            defaultParallel = socketToCore.values().sum().toString();, +        }, +            parallelism System.getProperty('tests.jvms', defaultParallel), +++ b/.ci/packer_cache.sh, +JAVA_HOME="${HOME}"/.java/${ES_BUILD_JAVA} ./gradlew resolveAllDependencies --parallel, +++ b/TESTING.asciidoc, +++ b/build.gradle, +final boolean bwc_tests_enabled = false, +final String bwc_tests_disabled_issue = "https://github.com/elastic/elasticsearch/issues/32006" // BWC handled at a later time, +++ b/buildSrc/build.gradle, +++ b/buildSrc/src/main/groovy/org/elasticsearch/gradle/BuildPlugin.groovy, +                println "  Compiler JDK Version  : ${getPaddedMajorVersion(compilerJavaVersionEnum)} (${compilerJavaVersionDetails})", +                println "  Runtime JDK Version   : ${getPaddedMajorVersion(runtimeJavaVersionEnum)} (${runtimeJavaVersionDetails})", +                println "  Gradle JDK Version    : ${getPaddedMajorVersion(JavaVersion.toVersion(gradleJavaVersion))} (${gradleJavaVersionDetails})", +                println "  JDK Version           : ${getPaddedMajorVersion(JavaVersion.toVersion(gradleJavaVersion))} (${gradleJavaVersionDetails})", +    private static String getPaddedMajorVersion(JavaVersion compilerJavaVersionEnum) {, +        compilerJavaVersionEnum.getMajorVersion().toString().padLeft(2), +    }, +, +        String defaultParallel = 'auto', +        // Count physical cores on any Linux distro ( don't count hyper-threading ), +        if (project.file("/proc/cpuinfo").exists()) {, +            Map<String, Integer> socketToCore = [:], +            String currentID = "", +            project.file("/proc/cpuinfo").readLines().forEach({ line ->, +                if (line.contains(":")) {, +                    List<String> parts = line.split(":", 2).collect({it.trim()}), +                    String name = parts[0], value = parts[1], +                    // the ID of the CPU socket, +                    if (name == "physical id") {, +                        currentID = value, +                    }, +                    // Number  of cores not including hyper-threading, +                    if (name == "cpu cores") {, +                        assert currentID.isEmpty() == false, +                        socketToCore[currentID] = Integer.valueOf(value), +                        currentID = "", +                    }, +                }, +            }), +            defaultParallel = socketToCore.values().sum().toString();, +        }, +            parallelism System.getProperty('tests.jvms', defaultParallel), +++ b/buildSrc/src/main/groovy/org/elasticsearch/gradle/precommit/PrecommitTasks.groovy, +            configureThirdPartyAudit(project)]
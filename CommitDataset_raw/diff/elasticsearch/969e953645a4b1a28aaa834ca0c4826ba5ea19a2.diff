[+++ b/core/src/main/java/org/elasticsearch/index/mapper/internal/TTLFieldMapper.java, +import org.elasticsearch.Version;, +            if (parserContext.indexVersionCreated().onOrAfter(Version.V_5_0_0_alpha4)) {, +                throw new IllegalArgumentException("[_ttl] is removed in 5.0. As a replacement, you should use time based indexes or cron a delete-by-query with a range query on a timestamp field.");, +            }, +        if (enabled.enabled && Version.indexCreated(indexSettings).onOrAfter(Version.V_5_0_0_alpha4)) {, +            throw new IllegalArgumentException("[_ttl] is removed in 5.0. As a replacement, you should use time based indexes or cron a delete-by-query with a range query on a timestamp field.");, +        }, +++ b/core/src/main/java/org/elasticsearch/index/mapper/internal/TTLFieldMapper.java, +import org.elasticsearch.Version;, +            if (parserContext.indexVersionCreated().onOrAfter(Version.V_5_0_0_alpha4)) {, +                throw new IllegalArgumentException("[_ttl] is removed in 5.0. As a replacement, you should use time based indexes or cron a delete-by-query with a range query on a timestamp field.");, +            }, +        if (enabled.enabled && Version.indexCreated(indexSettings).onOrAfter(Version.V_5_0_0_alpha4)) {, +            throw new IllegalArgumentException("[_ttl] is removed in 5.0. As a replacement, you should use time based indexes or cron a delete-by-query with a range query on a timestamp field.");, +        }, +++ b/core/src/main/java/org/elasticsearch/index/mapper/internal/TimestampFieldMapper.java, +import org.elasticsearch.Version;, +            if (parserContext.indexVersionCreated().onOrAfter(Version.V_5_0_0_alpha4)) {, +                throw new IllegalArgumentException("[_timestamp] is removed in 5.0. As a replacement, you can use an ingest pipeline to add a field with the current timestamp to your documents.");, +            }, +        if (enabledState.enabled && Version.indexCreated(indexSettings).onOrAfter(Version.V_5_0_0_alpha4)) {, +            throw new IllegalArgumentException("[_timestamp] is removed in 5.0. As a replacement, you can use an ingest pipeline to add a field with the current timestamp to your documents.");, +        }, +++ b/core/src/main/java/org/elasticsearch/index/mapper/internal/TTLFieldMapper.java, +import org.elasticsearch.Version;, +            if (parserContext.indexVersionCreated().onOrAfter(Version.V_5_0_0_alpha4)) {, +                throw new IllegalArgumentException("[_ttl] is removed in 5.0. As a replacement, you should use time based indexes or cron a delete-by-query with a range query on a timestamp field.");, +            }, +        if (enabled.enabled && Version.indexCreated(indexSettings).onOrAfter(Version.V_5_0_0_alpha4)) {, +            throw new IllegalArgumentException("[_ttl] is removed in 5.0. As a replacement, you should use time based indexes or cron a delete-by-query with a range query on a timestamp field.");, +        }, +++ b/core/src/main/java/org/elasticsearch/index/mapper/internal/TimestampFieldMapper.java, +import org.elasticsearch.Version;, +            if (parserContext.indexVersionCreated().onOrAfter(Version.V_5_0_0_alpha4)) {, +                throw new IllegalArgumentException("[_timestamp] is removed in 5.0. As a replacement, you can use an ingest pipeline to add a field with the current timestamp to your documents.");, +            }, +        if (enabledState.enabled && Version.indexCreated(indexSettings).onOrAfter(Version.V_5_0_0_alpha4)) {, +            throw new IllegalArgumentException("[_timestamp] is removed in 5.0. As a replacement, you can use an ingest pipeline to add a field with the current timestamp to your documents.");, +        }, +++ b/core/src/test/java/org/elasticsearch/aliases/IndexAliasesIT.java, +        assertAcked(prepareCreate("my-index").addMapping("my-type", "timestamp", "type=date"));, +        assertAcked(admin().indices().prepareAliases().addAlias("my-index", "filter1", rangeQuery("timestamp").from("2016-12-01").to("2016-12-31")));, +        assertAcked(admin().indices().prepareAliases().addAlias("my-index", "filter2", rangeQuery("timestamp").from("2016-01-01").to("2016-12-31")));, +            client().prepareIndex("my-index", "my-type").setCreate(true).setSource("timestamp", "2016-12-12").get();, +++ b/core/src/main/java/org/elasticsearch/index/mapper/internal/TTLFieldMapper.java, +import org.elasticsearch.Version;, +            if (parserContext.indexVersionCreated().onOrAfter(Version.V_5_0_0_alpha4)) {, +                throw new IllegalArgumentException("[_ttl] is removed in 5.0. As a replacement, you should use time based indexes or cron a delete-by-query with a range query on a timestamp field.");, +            }, +        if (enabled.enabled && Version.indexCreated(indexSettings).onOrAfter(Version.V_5_0_0_alpha4)) {, +            throw new IllegalArgumentException("[_ttl] is removed in 5.0. As a replacement, you should use time based indexes or cron a delete-by-query with a range query on a timestamp field.");, +        }, +++ b/core/src/main/java/org/elasticsearch/index/mapper/internal/TimestampFieldMapper.java, +import org.elasticsearch.Version;, +            if (parserContext.indexVersionCreated().onOrAfter(Version.V_5_0_0_alpha4)) {, +                throw new IllegalArgumentException("[_timestamp] is removed in 5.0. As a replacement, you can use an ingest pipeline to add a field with the current timestamp to your documents.");, +            }, +        if (enabledState.enabled && Version.indexCreated(indexSettings).onOrAfter(Version.V_5_0_0_alpha4)) {, +            throw new IllegalArgumentException("[_timestamp] is removed in 5.0. As a replacement, you can use an ingest pipeline to add a field with the current timestamp to your documents.");, +        }, +++ b/core/src/test/java/org/elasticsearch/aliases/IndexAliasesIT.java, +        assertAcked(prepareCreate("my-index").addMapping("my-type", "timestamp", "type=date"));, +        assertAcked(admin().indices().prepareAliases().addAlias("my-index", "filter1", rangeQuery("timestamp").from("2016-12-01").to("2016-12-31")));, +        assertAcked(admin().indices().prepareAliases().addAlias("my-index", "filter2", rangeQuery("timestamp").from("2016-01-01").to("2016-12-31")));, +            client().prepareIndex("my-index", "my-type").setCreate(true).setSource("timestamp", "2016-12-12").get();, +++ b/core/src/test/java/org/elasticsearch/cluster/SpecificMasterNodesIT.java, +import java.util.Map;, +        assertAcked(client().admin().indices().preparePutMapping("test").setType("_default_").setSource("timestamp", "type=date"));, +        Map<?,?> properties = (Map<?, ?>) defaultMapping.getSourceAsMap().get("properties");, +        assertThat(properties.get("timestamp"), notNullValue());, +        assertAcked(client().admin().indices().preparePutMapping("test").setType("_default_").setSource("timestamp", "type=date"));, +        properties = (Map<?, ?>) type1Mapping.getSourceAsMap().get("properties");, +        assertThat(properties.get("timestamp"), notNullValue());, +++ b/core/src/main/java/org/elasticsearch/index/mapper/internal/TTLFieldMapper.java, +import org.elasticsearch.Version;, +            if (parserContext.indexVersionCreated().onOrAfter(Version.V_5_0_0_alpha4)) {, +                throw new IllegalArgumentException("[_ttl] is removed in 5.0. As a replacement, you should use time based indexes or cron a delete-by-query with a range query on a timestamp field.");, +            }, +        if (enabled.enabled && Version.indexCreated(indexSettings).onOrAfter(Version.V_5_0_0_alpha4)) {, +            throw new IllegalArgumentException("[_ttl] is removed in 5.0. As a replacement, you should use time based indexes or cron a delete-by-query with a range query on a timestamp field.");, +        }, +++ b/core/src/main/java/org/elasticsearch/index/mapper/internal/TimestampFieldMapper.java, +import org.elasticsearch.Version;, +            if (parserContext.indexVersionCreated().onOrAfter(Version.V_5_0_0_alpha4)) {, +                throw new IllegalArgumentException("[_timestamp] is removed in 5.0. As a replacement, you can use an ingest pipeline to add a field with the current timestamp to your documents.");, +            }, +        if (enabledState.enabled && Version.indexCreated(indexSettings).onOrAfter(Version.V_5_0_0_alpha4)) {, +            throw new IllegalArgumentException("[_timestamp] is removed in 5.0. As a replacement, you can use an ingest pipeline to add a field with the current timestamp to your documents.");, +        }, +++ b/core/src/test/java/org/elasticsearch/aliases/IndexAliasesIT.java, +        assertAcked(prepareCreate("my-index").addMapping("my-type", "timestamp", "type=date"));, +        assertAcked(admin().indices().prepareAliases().addAlias("my-index", "filter1", rangeQuery("timestamp").from("2016-12-01").to("2016-12-31")));, +        assertAcked(admin().indices().prepareAliases().addAlias("my-index", "filter2", rangeQuery("timestamp").from("2016-01-01").to("2016-12-31")));, +            client().prepareIndex("my-index", "my-type").setCreate(true).setSource("timestamp", "2016-12-12").get();, +++ b/core/src/test/java/org/elasticsearch/cluster/SpecificMasterNodesIT.java, +import java.util.Map;, +        assertAcked(client().admin().indices().preparePutMapping("test").setType("_default_").setSource("timestamp", "type=date"));, +        Map<?,?> properties = (Map<?, ?>) defaultMapping.getSourceAsMap().get("properties");, +        assertThat(properties.get("timestamp"), notNullValue());]
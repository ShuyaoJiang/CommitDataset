[+++ b/buildSrc/build.gradle, +  compile 'de.thetaphi:forbiddenapis:2.2', +++ b/buildSrc/build.gradle, +  compile 'de.thetaphi:forbiddenapis:2.2', +++ b/buildSrc/src/main/resources/checkstyle_suppressions.xml, +++ b/buildSrc/build.gradle, +  compile 'de.thetaphi:forbiddenapis:2.2', +++ b/buildSrc/src/main/resources/checkstyle_suppressions.xml, +++ b/buildSrc/src/main/resources/forbidden/es-all-signatures.txt, +@defaultMessage Don't use MethodHandles in slow ways, don't be lenient in tests., +java.lang.invoke.MethodHandle#invoke(java.lang.Object[]), +++ b/buildSrc/build.gradle, +  compile 'de.thetaphi:forbiddenapis:2.2', +++ b/buildSrc/src/main/resources/checkstyle_suppressions.xml, +++ b/buildSrc/src/main/resources/forbidden/es-all-signatures.txt, +@defaultMessage Don't use MethodHandles in slow ways, don't be lenient in tests., +java.lang.invoke.MethodHandle#invoke(java.lang.Object[]), +++ b/core/src/main/java/org/elasticsearch/Version.java, +++ b/buildSrc/build.gradle, +  compile 'de.thetaphi:forbiddenapis:2.2', +++ b/buildSrc/src/main/resources/checkstyle_suppressions.xml, +++ b/buildSrc/src/main/resources/forbidden/es-all-signatures.txt, +@defaultMessage Don't use MethodHandles in slow ways, don't be lenient in tests., +java.lang.invoke.MethodHandle#invoke(java.lang.Object[]), +++ b/core/src/main/java/org/elasticsearch/Version.java, +++ b/core/src/main/java/org/elasticsearch/action/main/TransportMainAction.java, +                               ClusterService clusterService) {, +            new MainResponse(Node.NODE_NAME_SETTING.get(settings), Version.CURRENT, clusterState.getClusterName(), Build.CURRENT,, +                available));, +++ b/buildSrc/build.gradle, +  compile 'de.thetaphi:forbiddenapis:2.2', +++ b/buildSrc/src/main/resources/checkstyle_suppressions.xml, +++ b/buildSrc/src/main/resources/forbidden/es-all-signatures.txt, +@defaultMessage Don't use MethodHandles in slow ways, don't be lenient in tests., +java.lang.invoke.MethodHandle#invoke(java.lang.Object[]), +++ b/core/src/main/java/org/elasticsearch/Version.java, +++ b/core/src/main/java/org/elasticsearch/action/main/TransportMainAction.java, +                               ClusterService clusterService) {, +            new MainResponse(Node.NODE_NAME_SETTING.get(settings), Version.CURRENT, clusterState.getClusterName(), Build.CURRENT,, +                available));, +++ /dev/null, +++ b/buildSrc/build.gradle, +  compile 'de.thetaphi:forbiddenapis:2.2', +++ b/buildSrc/src/main/resources/checkstyle_suppressions.xml, +++ b/buildSrc/src/main/resources/forbidden/es-all-signatures.txt, +@defaultMessage Don't use MethodHandles in slow ways, don't be lenient in tests., +java.lang.invoke.MethodHandle#invoke(java.lang.Object[]), +++ b/core/src/main/java/org/elasticsearch/Version.java, +++ b/core/src/main/java/org/elasticsearch/action/main/TransportMainAction.java, +                               ClusterService clusterService) {, +            new MainResponse(Node.NODE_NAME_SETTING.get(settings), Version.CURRENT, clusterState.getClusterName(), Build.CURRENT,, +                available));, +++ /dev/null, +++ b/core/src/main/java/org/elasticsearch/client/transport/TransportClient.java, +import org.apache.lucene.util.IOUtils;, +import java.io.Closeable;, +            final List<Closeable> resourcesToClose = new ArrayList<>();, +            resourcesToClose.add(() -> ThreadPool.terminate(threadPool, 10, TimeUnit.SECONDS));, +                resourcesToClose.add(circuitBreakerService);, +                BigArrays bigArrays = new BigArrays(settings, circuitBreakerService);, +                resourcesToClose.add(bigArrays);, +                modules.add((b -> {, +                    b.bind(BigArrays.class).toInstance(bigArrays);, +                    b.bind(PluginsService.class).toInstance(pluginsService);, +                    b.bind(CircuitBreakerService.class).toInstance(circuitBreakerService);, +                }));, +                resourcesToClose.clear();, +                IOUtils.closeWhileHandlingException(resourcesToClose);, +        List<Closeable> closeables = new ArrayList<>();, +        closeables.add(injector.getInstance(TransportClientNodesService.class));, +        closeables.add(injector.getInstance(TransportService.class));, +            closeables.add(injector.getInstance(plugin));, +        closeables.add(() -> ThreadPool.terminate(injector.getInstance(ThreadPool.class), 10, TimeUnit.SECONDS));, +        closeables.add(injector.getInstance(BigArrays.class));, +        IOUtils.closeWhileHandlingException(closeables);, +++ b/buildSrc/build.gradle, +  compile 'de.thetaphi:forbiddenapis:2.2', +++ b/buildSrc/src/main/resources/checkstyle_suppressions.xml, +++ b/buildSrc/src/main/resources/forbidden/es-all-signatures.txt, +@defaultMessage Don't use MethodHandles in slow ways, don't be lenient in tests., +java.lang.invoke.MethodHandle#invoke(java.lang.Object[]), +++ b/core/src/main/java/org/elasticsearch/Version.java, +++ b/core/src/main/java/org/elasticsearch/action/main/TransportMainAction.java, +                               ClusterService clusterService) {, +            new MainResponse(Node.NODE_NAME_SETTING.get(settings), Version.CURRENT, clusterState.getClusterName(), Build.CURRENT,, +                available));, +++ /dev/null, +++ b/core/src/main/java/org/elasticsearch/client/transport/TransportClient.java, +import org.apache.lucene.util.IOUtils;, +import java.io.Closeable;, +            final List<Closeable> resourcesToClose = new ArrayList<>();, +            resourcesToClose.add(() -> ThreadPool.terminate(threadPool, 10, TimeUnit.SECONDS));, +                resourcesToClose.add(circuitBreakerService);, +                BigArrays bigArrays = new BigArrays(settings, circuitBreakerService);, +                resourcesToClose.add(bigArrays);, +                modules.add((b -> {, +                    b.bind(BigArrays.class).toInstance(bigArrays);, +                    b.bind(PluginsService.class).toInstance(pluginsService);, +                    b.bind(CircuitBreakerService.class).toInstance(circuitBreakerService);, +                }));]
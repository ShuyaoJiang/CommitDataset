[+++ b/src/main/java/org/elasticsearch/indices/recovery/RecoverySource.java, +import org.elasticsearch.cluster.metadata.IndexMetaData;, +import org.elasticsearch.cluster.metadata.MappingMetaData;, +import org.elasticsearch.common.collect.ImmutableOpenMap;, +                IndexMetaData indexMetaData = clusterService.state().metaData().getIndices().get(indexService.index().getName());, +                ImmutableOpenMap<String, MappingMetaData> metaDataMappings = null;, +                if (indexMetaData != null) {, +                    metaDataMappings = indexMetaData.getMappings();, +                }, +, +                    MappingMetaData mappingMetaData = metaDataMappings == null ? null : metaDataMappings.get(documentMapper.type());, +                    if (mappingMetaData == null || !documentMapper.refreshSource().equals(mappingMetaData.source())) {, +                        // not on master yet in the right form, +                }]
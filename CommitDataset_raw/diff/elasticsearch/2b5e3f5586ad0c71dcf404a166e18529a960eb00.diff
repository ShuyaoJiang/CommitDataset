[+++ b/src/main/java/org/elasticsearch/search/sort/SortParseElement.java, +        } else {, +            do {, +                if (objectMappers.hasNested()) {, +                }, +, +                indexOf = objectPath.lastIndexOf('.');, +            } while (indexOf != -1);, +        }, +++ b/src/main/java/org/elasticsearch/search/sort/SortParseElement.java, +        } else {, +            do {, +                if (objectMappers.hasNested()) {, +                }, +, +                indexOf = objectPath.lastIndexOf('.');, +            } while (indexOf != -1);, +        }, +++ b/src/test/java/org/elasticsearch/test/integration/nested/SimpleNestedTests.java, +                .startObject("child_obj"), +                .field("value", 1l), +                .endObject(), +                .startObject("child_obj"), +                .field("value", 2l), +                .endObject(), +                .startObject("child_obj"), +                .field("value", 3l), +                .endObject(), +, +        // Check if closest nested type is resolved, +        searchResponse = client.prepareSearch(), +                .setQuery(matchAllQuery()), +                .addSort(, +                        SortBuilders.fieldSort("parent.child.child_obj.value"), +                                .setNestedFilter(FilterBuilders.termFilter("parent.child.filter", true)), +                                .order(SortOrder.ASC), +                ), +                .execute().actionGet();, +        assertThat(searchResponse.getHits().totalHits(), equalTo(3l));, +        assertThat(searchResponse.getHits().getHits().length, equalTo(3));, +        assertThat(searchResponse.getHits().getHits()[0].getId(), equalTo("1"));, +        assertThat(searchResponse.getHits().getHits()[0].sortValues()[0].toString(), equalTo("1"));, +        assertThat(searchResponse.getHits().getHits()[1].getId(), equalTo("2"));, +        assertThat(searchResponse.getHits().getHits()[1].sortValues()[0].toString(), equalTo("2"));, +        assertThat(searchResponse.getHits().getHits()[2].getId(), equalTo("3"));, +        assertThat(searchResponse.getHits().getHits()[2].sortValues()[0].toString(), equalTo("3"));]
[+++ b/modules/lang-painless/src/test/java/org/elasticsearch/painless/AndTests.java, +    , +    public void testDefCompoundAssignment() {, +        // boolean, +        assertEquals(true, exec("def x = true; x &= true; return x;"));, +        assertEquals(false, exec("def x = true; x &= false; return x;"));, +        assertEquals(false, exec("def x = false; x &= true; return x;"));, +        assertEquals(false, exec("def x = false; x &= false; return x;"));, +        assertEquals(true, exec("def[] x = new def[1]; x[0] = true; x[0] &= true; return x[0];"));, +        assertEquals(false, exec("def[] x = new def[1]; x[0] = true; x[0] &= false; return x[0];"));, +        assertEquals(false, exec("def[] x = new def[1]; x[0] = false; x[0] &= true; return x[0];"));, +        assertEquals(false, exec("def[] x = new def[1]; x[0] = false; x[0] &= false; return x[0];"));, +, +        // byte, +        assertEquals((byte) (13 & 14), exec("def x = (byte)13; x &= 14; return x;"));, +        // short, +        assertEquals((short) (13 & 14), exec("def x = (short)13; x &= 14; return x;"));, +        // char, +        assertEquals((char) (13 & 14), exec("def x = (char)13; x &= 14; return x;"));, +        // int, +        assertEquals(13 & 14, exec("def x = 13; x &= 14; return x;"));, +        // long, +        assertEquals((long) (13 & 14), exec("def x = 13L; x &= 14; return x;"));, +    }, +    , +    public void testDefBogusCompoundAssignment() {, +        expectScriptThrows(ClassCastException.class, () -> {, +            exec("def x = 4F; int y = 1; x &= y");, +        });, +        expectScriptThrows(ClassCastException.class, () -> {, +            exec("def x = 4D; int y = 1; x &= y");, +        });, +        expectScriptThrows(ClassCastException.class, () -> {, +            exec("int x = 4; def y = 1F; x &= y");, +        });, +        expectScriptThrows(ClassCastException.class, () -> {, +            exec("int x = 4; def y = 1D; x &= y");, +        });, +    }]
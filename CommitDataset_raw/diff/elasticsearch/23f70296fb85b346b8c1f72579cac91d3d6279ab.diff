[+++ b/core/src/main/java/org/elasticsearch/bootstrap/Bootstrap.java, +            // fail if somebody replaced the lucene jars, +            checkLucene();, +, +, +    private static void checkLucene() {, +        if (Version.CURRENT.luceneVersion.equals(org.apache.lucene.util.Version.LATEST) == false) {, +            throw new AssertionError("Lucene version mismatch this version of Elasticsearch requires lucene version [", +                + Version.CURRENT.luceneVersion + "]  but the current lucene version is [" + org.apache.lucene.util.Version.LATEST + "]");, +        }, +    }, +++ b/core/src/main/java/org/elasticsearch/bootstrap/Bootstrap.java, +            // fail if somebody replaced the lucene jars, +            checkLucene();, +, +, +    private static void checkLucene() {, +        if (Version.CURRENT.luceneVersion.equals(org.apache.lucene.util.Version.LATEST) == false) {, +            throw new AssertionError("Lucene version mismatch this version of Elasticsearch requires lucene version [", +                + Version.CURRENT.luceneVersion + "]  but the current lucene version is [" + org.apache.lucene.util.Version.LATEST + "]");, +        }, +    }, +++ b/core/src/main/java/org/elasticsearch/cluster/routing/allocation/decider/ClusterRebalanceAllocationDecider.java, +        logger.debug("using [{}] with [{}]", CLUSTER_ROUTING_ALLOCATION_ALLOW_REBALANCE_SETTING.getKey(), type.toString().toLowerCase(Locale.ROOT));, +++ b/core/src/main/java/org/elasticsearch/bootstrap/Bootstrap.java, +            // fail if somebody replaced the lucene jars, +            checkLucene();, +, +, +    private static void checkLucene() {, +        if (Version.CURRENT.luceneVersion.equals(org.apache.lucene.util.Version.LATEST) == false) {, +            throw new AssertionError("Lucene version mismatch this version of Elasticsearch requires lucene version [", +                + Version.CURRENT.luceneVersion + "]  but the current lucene version is [" + org.apache.lucene.util.Version.LATEST + "]");, +        }, +    }, +++ b/core/src/main/java/org/elasticsearch/cluster/routing/allocation/decider/ClusterRebalanceAllocationDecider.java, +        logger.debug("using [{}] with [{}]", CLUSTER_ROUTING_ALLOCATION_ALLOW_REBALANCE_SETTING.getKey(), type.toString().toLowerCase(Locale.ROOT));, +++ b/core/src/main/java/org/elasticsearch/common/settings/ClusterSettings.java, +import org.elasticsearch.monitor.fs.FsService;, +import org.elasticsearch.monitor.jvm.JvmGcMonitorService;, +import org.elasticsearch.monitor.jvm.JvmService;, +import org.elasticsearch.monitor.os.OsService;, +import org.elasticsearch.monitor.process.ProcessService;, +import org.elasticsearch.tribe.TribeService;, +                    TribeService.BLOCKS_METADATA_SETTING,, +                    TribeService.BLOCKS_WRITE_SETTING,, +                    TribeService.BLOCKS_WRITE_INDICES_SETTING,, +                    TribeService.BLOCKS_READ_INDICES_SETTING,, +                    TribeService.BLOCKS_METADATA_INDICES_SETTING,, +                    TribeService.ON_CONFLICT_SETTING,, +                    NodeEnvironment.ADD_NODE_ID_TO_CUSTOM_PATH,, +                    OsService.REFRESH_INTERVAL_SETTING,, +                    ProcessService.REFRESH_INTERVAL_SETTING,, +                    JvmService.REFRESH_INTERVAL_SETTING,, +                    FsService.REFRESH_INTERVAL_SETTING,, +                    JvmGcMonitorService.ENABLED_SETTING,, +                    JvmGcMonitorService.REFRESH_INTERVAL_SETTING,, +                    JvmGcMonitorService.GC_SETTING, +                )));, +++ b/core/src/main/java/org/elasticsearch/bootstrap/Bootstrap.java, +            // fail if somebody replaced the lucene jars, +            checkLucene();, +, +, +    private static void checkLucene() {, +        if (Version.CURRENT.luceneVersion.equals(org.apache.lucene.util.Version.LATEST) == false) {, +            throw new AssertionError("Lucene version mismatch this version of Elasticsearch requires lucene version [", +                + Version.CURRENT.luceneVersion + "]  but the current lucene version is [" + org.apache.lucene.util.Version.LATEST + "]");, +        }, +    }, +++ b/core/src/main/java/org/elasticsearch/cluster/routing/allocation/decider/ClusterRebalanceAllocationDecider.java, +        logger.debug("using [{}] with [{}]", CLUSTER_ROUTING_ALLOCATION_ALLOW_REBALANCE_SETTING.getKey(), type.toString().toLowerCase(Locale.ROOT));, +++ b/core/src/main/java/org/elasticsearch/common/settings/ClusterSettings.java, +import org.elasticsearch.monitor.fs.FsService;, +import org.elasticsearch.monitor.jvm.JvmGcMonitorService;, +import org.elasticsearch.monitor.jvm.JvmService;, +import org.elasticsearch.monitor.os.OsService;, +import org.elasticsearch.monitor.process.ProcessService;, +import org.elasticsearch.tribe.TribeService;, +                    TribeService.BLOCKS_METADATA_SETTING,, +                    TribeService.BLOCKS_WRITE_SETTING,, +                    TribeService.BLOCKS_WRITE_INDICES_SETTING,, +                    TribeService.BLOCKS_READ_INDICES_SETTING,, +                    TribeService.BLOCKS_METADATA_INDICES_SETTING,, +                    TribeService.ON_CONFLICT_SETTING,, +                    NodeEnvironment.ADD_NODE_ID_TO_CUSTOM_PATH,, +                    OsService.REFRESH_INTERVAL_SETTING,, +                    ProcessService.REFRESH_INTERVAL_SETTING,, +                    JvmService.REFRESH_INTERVAL_SETTING,, +                    FsService.REFRESH_INTERVAL_SETTING,, +                    JvmGcMonitorService.ENABLED_SETTING,, +                    JvmGcMonitorService.REFRESH_INTERVAL_SETTING,, +                    JvmGcMonitorService.GC_SETTING, +                )));, +++ b/core/src/main/java/org/elasticsearch/index/mapper/ParseContext.java, +    @Nullable, +++ b/core/src/main/java/org/elasticsearch/bootstrap/Bootstrap.java, +            // fail if somebody replaced the lucene jars, +            checkLucene();, +]
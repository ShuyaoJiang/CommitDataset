[+++ b/core/src/main/java/org/elasticsearch/common/util/LocaleUtils.java, +++ b/core/src/main/java/org/elasticsearch/common/util/LocaleUtils.java, +++ b/modules/ingest-common/src/main/java/org/elasticsearch/ingest/common/DateProcessor.java, +            Locale locale = Locale.ROOT;, +                locale = LocaleUtils.parse(localeString);, +++ b/core/src/main/java/org/elasticsearch/common/util/LocaleUtils.java, +++ b/modules/ingest-common/src/main/java/org/elasticsearch/ingest/common/DateProcessor.java, +            Locale locale = Locale.ROOT;, +                locale = LocaleUtils.parse(localeString);, +++ b/modules/ingest-common/src/test/java/org/elasticsearch/ingest/common/DateProcessorFactoryTests.java, +        assertThat(processor.getLocale(), equalTo(Locale.ROOT));, +        String[] locales = new String[] { "invalid_locale", "english", "xy", "xy-US" };, +            IllegalArgumentException e = expectThrows(IllegalArgumentException.class,, +                    () -> factory.create(null, null, config));, +            assertThat(e.getMessage(), equalTo("Unknown language: " + locale.split("[_-]")[0]));, +, +        locales = new String[] { "en-XY", "en-Canada" };, +        for (String locale : locales) {, +            DateProcessor.Factory factory = new DateProcessor.Factory();, +            Map<String, Object> config = new HashMap<>();, +            String sourceField = randomAlphaOfLengthBetween(1, 10);, +            config.put("field", sourceField);, +            config.put("formats", Collections.singletonList("dd/MM/yyyyy"));, +            config.put("locale", locale);, +            IllegalArgumentException e = expectThrows(IllegalArgumentException.class,, +                    () -> factory.create(null, null, config));, +            assertThat(e.getMessage(), equalTo("Unknown country: " + locale.split("[_-]")[1]));]
[+++ b/x-pack/plugin/src/main/java/org/elasticsearch/xpack/ccr/action/ShardFollowTasksExecutor.java, +        prepare(task, params.getLeaderShardId(), params.getFollowShardId(), params.getBatchSize(), followGlobalCheckPoint);, +    void prepare(AllocatedPersistentTask task, ShardId leaderShard, ShardId followerShard, long batchSize, long followGlobalCheckPoint) {, +                                    leaderShard, followerShard, batchSize, leaderGlobalCheckPoint), task::markAsFailed), +                            new ChunksCoordinator(client, ccrExecutor, batchSize, leaderShard, followerShard, handler);, +                prepare(task, leaderShard, followerShard, params.getBatchSize(), followGlobalCheckPoint);]
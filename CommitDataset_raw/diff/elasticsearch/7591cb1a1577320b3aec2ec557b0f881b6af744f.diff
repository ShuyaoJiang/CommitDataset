[+++ b/x-pack/plugin/sql/qa/src/main/resources/agg.csv-spec, + CAST(SUM(salary) AS INTEGER), +-----------------------------, +++ b/x-pack/plugin/sql/qa/src/main/resources/agg.csv-spec, + CAST(SUM(salary) AS INTEGER), +-----------------------------, +++ b/x-pack/plugin/sql/src/main/java/org/elasticsearch/xpack/sql/optimizer/Optimizer.java, +                CleanAliases.INSTANCE,, +            // eliminate redundant casts, +                        Alias as = new Alias(c.source(), c.sourceText(), argument);, +                        replacedCast.put(c.toAttribute(), as.toAttribute());, +                        return as;, +++ b/x-pack/plugin/sql/qa/src/main/resources/agg.csv-spec, + CAST(SUM(salary) AS INTEGER), +-----------------------------, +++ b/x-pack/plugin/sql/src/main/java/org/elasticsearch/xpack/sql/optimizer/Optimizer.java, +                CleanAliases.INSTANCE,, +            // eliminate redundant casts, +                        Alias as = new Alias(c.source(), c.sourceText(), argument);, +                        replacedCast.put(c.toAttribute(), as.toAttribute());, +                        return as;, +++ b/x-pack/plugin/sql/src/test/java/org/elasticsearch/xpack/sql/parser/SqlParserTests.java, +import org.elasticsearch.xpack.sql.expression.function.scalar.Cast;, +    public void testSelectCast() {, +        Cast f = singleProjection(project(parseStatement("SELECT CAST(POWER(languages, 2) AS DOUBLE) FROM foo")), Cast.class);, +        assertEquals("CAST(POWER(languages, 2) AS DOUBLE)", f.sourceText());, +    }, +, +    public void testSelectCastOperator() {, +        Cast f = singleProjection(project(parseStatement("SELECT POWER(languages, 2)::DOUBLE FROM foo")), Cast.class);, +        assertEquals("POWER(languages, 2)::DOUBLE", f.sourceText());, +    }, +, +    public void testSelectCastWithSQLOperator() {, +        Cast f = singleProjection(project(parseStatement("SELECT CONVERT(POWER(languages, 2), SQL_DOUBLE) FROM foo")), Cast.class);, +        assertEquals("CONVERT(POWER(languages, 2), SQL_DOUBLE)", f.sourceText());, +    }, +]
[+++ b/rest-api-spec/src/main/resources/rest-api-spec/test/cluster.state/20_filtering.yml, +  # Get the current cluster_uuid, +  - do:, +      cluster.state: {}, +  - set: { metadata.cluster_uuid : cluster_uuid }, +, +        metric: [ master_node, version ], +  - match: { cluster_uuid: $cluster_uuid }, +, +  - do:, +      cluster.state:, +        metric: [ routing_table ], +        index: testidx, +, +  - match: { cluster_uuid: $cluster_uuid }, +  - is_true: routing_table, +++ b/rest-api-spec/src/main/resources/rest-api-spec/test/cluster.state/20_filtering.yml, +  # Get the current cluster_uuid, +  - do:, +      cluster.state: {}, +  - set: { metadata.cluster_uuid : cluster_uuid }, +, +        metric: [ master_node, version ], +  - match: { cluster_uuid: $cluster_uuid }, +, +  - do:, +      cluster.state:, +        metric: [ routing_table ], +        index: testidx, +, +  - match: { cluster_uuid: $cluster_uuid }, +  - is_true: routing_table, +++ b/server/src/main/java/org/elasticsearch/action/admin/cluster/state/TransportClusterStateAction.java, +        MetaData.Builder mdBuilder = MetaData.builder();, +        mdBuilder.clusterUUID(currentState.metaData().clusterUUID());, +, +        if (request.metaData()) {, +            } else {, +                mdBuilder = MetaData.builder(currentState.metaData());, +        builder.metaData(mdBuilder);, +]
[+++ b/src/main/java/org/elasticsearch/common/collect/ImmutableOpenMap.java, +        /**, +         * A put operation that can be used in the fluent pattern., +         */, +        public Builder<KType, VType> fPut(KType key, VType value) {, +            map.put(key, value);, +            return this;, +        }, +, +        /**, +         * Remove that can be used in the fluent pattern., +         */, +        public Builder<KType, VType> fRemove(KType key) {, +            map.remove(key);, +            return this;, +        }, +, +++ b/src/main/java/org/elasticsearch/common/collect/ImmutableOpenMap.java, +        /**, +         * A put operation that can be used in the fluent pattern., +         */, +        public Builder<KType, VType> fPut(KType key, VType value) {, +            map.put(key, value);, +            return this;, +        }, +, +        /**, +         * Remove that can be used in the fluent pattern., +         */, +        public Builder<KType, VType> fRemove(KType key) {, +            map.remove(key);, +            return this;, +        }, +, +++ b/src/main/java/org/elasticsearch/index/store/Store.java, +import org.elasticsearch.common.collect.ImmutableOpenMap;, +    private volatile ImmutableOpenMap<String, StoreFileMetaData> filesMetadata = ImmutableOpenMap.of();, +            filesMetadata = ImmutableOpenMap.builder(filesMetadata).fRemove(from).fPut(to, toMetaData).build();, +            files = filesMetadata.keys().toArray(String.class);, +            filesMetadata = ImmutableOpenMap.builder(filesMetadata).fPut(name, metaData).build();, +                filesMetadata = ImmutableOpenMap.builder(filesMetadata).fPut(entry.getKey(), metaData).build();, +                ImmutableOpenMap.Builder<String, StoreFileMetaData> builder = ImmutableOpenMap.builder();, +                filesMetadata = builder.build();, +                files = filesMetadata.keys().toArray(String.class);, +                filesMetadata = ImmutableOpenMap.builder(filesMetadata).fRemove(name).build();, +                files = filesMetadata.keys().toArray(String.class);, +                filesMetadata = ImmutableOpenMap.builder(filesMetadata).fRemove(name).build();, +                files = filesMetadata.keys().toArray(String.class);, +                    filesMetadata = ImmutableOpenMap.builder(filesMetadata).fPut(name, metaData).build();, +                    files = filesMetadata.keys().toArray(String.class);, +                filesMetadata = ImmutableOpenMap.of();, +                filesMetadata = ImmutableOpenMap.builder(filesMetadata).fPut(name, md).build();, +                files = filesMetadata.keys().toArray(String.class);]
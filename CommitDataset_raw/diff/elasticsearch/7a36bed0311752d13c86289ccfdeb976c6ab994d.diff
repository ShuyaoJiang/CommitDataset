[+++ b/src/main/java/org/elasticsearch/index/fielddata/ordinals/DocIdOrdinals.java, +++ b/src/main/java/org/elasticsearch/index/fielddata/ordinals/DocIdOrdinals.java, +++ b/src/main/java/org/elasticsearch/index/fielddata/ordinals/EmptyOrdinals.java, +++ b/src/main/java/org/elasticsearch/index/fielddata/ordinals/DocIdOrdinals.java, +++ b/src/main/java/org/elasticsearch/index/fielddata/ordinals/EmptyOrdinals.java, +++ b/src/main/java/org/elasticsearch/index/fielddata/ordinals/MultiFlatArrayOrdinals.java, +++ b/src/main/java/org/elasticsearch/index/fielddata/ordinals/DocIdOrdinals.java, +++ b/src/main/java/org/elasticsearch/index/fielddata/ordinals/EmptyOrdinals.java, +++ b/src/main/java/org/elasticsearch/index/fielddata/ordinals/MultiFlatArrayOrdinals.java, +++ b/src/main/java/org/elasticsearch/index/fielddata/ordinals/Ordinals.java, +++ b/src/main/java/org/elasticsearch/index/fielddata/ordinals/DocIdOrdinals.java, +++ b/src/main/java/org/elasticsearch/index/fielddata/ordinals/EmptyOrdinals.java, +++ b/src/main/java/org/elasticsearch/index/fielddata/ordinals/MultiFlatArrayOrdinals.java, +++ b/src/main/java/org/elasticsearch/index/fielddata/ordinals/Ordinals.java, +++ b/src/main/java/org/elasticsearch/index/fielddata/ordinals/SingleArrayOrdinals.java, +++ b/src/main/java/org/elasticsearch/index/fielddata/ordinals/DocIdOrdinals.java, +++ b/src/main/java/org/elasticsearch/index/fielddata/ordinals/EmptyOrdinals.java, +++ b/src/main/java/org/elasticsearch/index/fielddata/ordinals/MultiFlatArrayOrdinals.java, +++ b/src/main/java/org/elasticsearch/index/fielddata/ordinals/Ordinals.java, +++ b/src/main/java/org/elasticsearch/index/fielddata/ordinals/SingleArrayOrdinals.java, +++ b/src/main/java/org/elasticsearch/index/fielddata/ordinals/SinglePackedOrdinals.java, +++ b/src/main/java/org/elasticsearch/index/fielddata/ordinals/DocIdOrdinals.java, +++ b/src/main/java/org/elasticsearch/index/fielddata/ordinals/EmptyOrdinals.java, +++ b/src/main/java/org/elasticsearch/index/fielddata/ordinals/MultiFlatArrayOrdinals.java, +++ b/src/main/java/org/elasticsearch/index/fielddata/ordinals/Ordinals.java, +++ b/src/main/java/org/elasticsearch/index/fielddata/ordinals/SingleArrayOrdinals.java, +++ b/src/main/java/org/elasticsearch/index/fielddata/ordinals/SinglePackedOrdinals.java, +++ b/src/main/java/org/elasticsearch/index/fielddata/ordinals/SparseMultiArrayOrdinals.java, +++ b/src/main/java/org/elasticsearch/index/fielddata/ordinals/DocIdOrdinals.java, +++ b/src/main/java/org/elasticsearch/index/fielddata/ordinals/EmptyOrdinals.java, +++ b/src/main/java/org/elasticsearch/index/fielddata/ordinals/MultiFlatArrayOrdinals.java, +++ b/src/main/java/org/elasticsearch/index/fielddata/ordinals/Ordinals.java, +++ b/src/main/java/org/elasticsearch/index/fielddata/ordinals/SingleArrayOrdinals.java, +++ b/src/main/java/org/elasticsearch/index/fielddata/ordinals/SinglePackedOrdinals.java, +++ b/src/main/java/org/elasticsearch/index/fielddata/ordinals/SparseMultiArrayOrdinals.java, +++ b/src/main/java/org/elasticsearch/search/facet/terms/strings/TermsStringOrdinalsFacetExecutor.java, +import org.elasticsearch.index.fielddata.ordinals.Ordinals.Docs.Iter;, +        private Ordinals.Docs ordinals;, +            ordinals = values.ordinals();, +            Iter iter = ordinals.getIter(doc);, +            int ord = iter.next();, +            current.onOrdinal(doc, ord);, +            while((ord = iter.next()) != 0) {, +                current.onOrdinal(doc, ord);, +            }, +    public static final class ReaderAggregator {, +        final void onOrdinal(int docId, int ordinal) {, +++ b/src/main/java/org/elasticsearch/index/fielddata/ordinals/DocIdOrdinals.java, +++ b/src/main/java/org/elasticsearch/index/fielddata/ordinals/EmptyOrdinals.java, +++ b/src/main/java/org/elasticsearch/index/fielddata/ordinals/MultiFlatArrayOrdinals.java, +++ b/src/main/java/org/elasticsearch/index/fielddata/ordinals/Ordinals.java, +++ b/src/main/java/org/elasticsearch/index/fielddata/ordinals/SingleArrayOrdinals.java, +++ b/src/main/java/org/elasticsearch/index/fielddata/ordinals/SinglePackedOrdinals.java, +++ b/src/main/java/org/elasticsearch/index/fielddata/ordinals/SparseMultiArrayOrdinals.java, +++ b/src/main/java/org/elasticsearch/search/facet/terms/strings/TermsStringOrdinalsFacetExecutor.java, +import org.elasticsearch.index.fielddata.ordinals.Ordinals.Docs.Iter;, +        private Ordinals.Docs ordinals;, +            ordinals = values.ordinals();, +            Iter iter = ordinals.getIter(doc);, +            int ord = iter.next();, +            current.onOrdinal(doc, ord);, +            while((ord = iter.next()) != 0) {, +                current.onOrdinal(doc, ord);, +            }, +    public static final class ReaderAggregator {, +        final void onOrdinal(int docId, int ordinal) {, +++ b/src/test/java/org/elasticsearch/test/unit/index/fielddata/ordinals/MultiOrdinalsTests.java]
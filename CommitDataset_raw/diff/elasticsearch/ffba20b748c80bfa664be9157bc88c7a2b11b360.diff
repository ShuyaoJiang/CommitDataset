[+++ b/libs/nio/src/main/java/org/elasticsearch/nio/InboundChannelBuffer.java, +++ b/libs/nio/src/main/java/org/elasticsearch/nio/InboundChannelBuffer.java, +++ b/libs/nio/src/test/java/org/elasticsearch/nio/InboundChannelBufferTests.java, +    public void testNewBufferNoPages() {, +        assertEquals(0, channelBuffer.getCapacity());, +        assertEquals(0, channelBuffer.getRemaining());, +        assertEquals(0, channelBuffer.getCapacity());, +        assertEquals(0, channelBuffer.getRemaining());, +, +        channelBuffer.ensureCapacity(PAGE_SIZE);, +        channelBuffer.ensureCapacity(PAGE_SIZE);, +        channelBuffer.ensureCapacity(PAGE_SIZE);, +        channelBuffer.ensureCapacity(PAGE_SIZE);, +        channelBuffer.ensureCapacity(PAGE_SIZE);, +++ b/libs/nio/src/main/java/org/elasticsearch/nio/InboundChannelBuffer.java, +++ b/libs/nio/src/test/java/org/elasticsearch/nio/InboundChannelBufferTests.java, +    public void testNewBufferNoPages() {, +        assertEquals(0, channelBuffer.getCapacity());, +        assertEquals(0, channelBuffer.getRemaining());, +        assertEquals(0, channelBuffer.getCapacity());, +        assertEquals(0, channelBuffer.getRemaining());, +, +        channelBuffer.ensureCapacity(PAGE_SIZE);, +        channelBuffer.ensureCapacity(PAGE_SIZE);, +        channelBuffer.ensureCapacity(PAGE_SIZE);, +        channelBuffer.ensureCapacity(PAGE_SIZE);, +        channelBuffer.ensureCapacity(PAGE_SIZE);, +++ b/x-pack/plugin/security/src/main/java/org/elasticsearch/xpack/security/transport/nio/SSLDriver.java, +            ensureApplicationBufferSize(buffer);]
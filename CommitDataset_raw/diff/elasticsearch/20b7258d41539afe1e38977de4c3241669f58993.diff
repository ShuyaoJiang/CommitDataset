[+++ b/core/src/test/java/org/elasticsearch/search/aggregations/metrics/geocentroid/InternalGeoCentroidTests.java, +            if (centroid == null) {, +                // if the new count is > 0 then we need to make sure there is a, +                // centroid or the constructor will throw an exception, +                centroid = new GeoPoint(randomDoubleBetween(-90, 90, false), randomDoubleBetween(-180, 180, false));, +            }, +            if (centroid == null) {, +                centroid = new GeoPoint(randomDoubleBetween(-90, 90, false), randomDoubleBetween(-180, 180, false));, +                count = between(1, 100);, +            } else {, +            }, +++ b/core/src/test/java/org/elasticsearch/search/aggregations/metrics/geocentroid/InternalGeoCentroidTests.java, +            if (centroid == null) {, +                // if the new count is > 0 then we need to make sure there is a, +                // centroid or the constructor will throw an exception, +                centroid = new GeoPoint(randomDoubleBetween(-90, 90, false), randomDoubleBetween(-180, 180, false));, +            }, +            if (centroid == null) {, +                centroid = new GeoPoint(randomDoubleBetween(-90, 90, false), randomDoubleBetween(-180, 180, false));, +                count = between(1, 100);, +            } else {, +            }, +++ b/core/src/test/java/org/elasticsearch/search/aggregations/metrics/scripted/InternalScriptedMetricTests.java, +            while ((newValue == null && value == null) || (newValue != null && newValue.equals(value))) {]
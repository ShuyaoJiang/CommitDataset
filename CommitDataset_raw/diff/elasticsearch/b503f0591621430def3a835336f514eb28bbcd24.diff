[+++ b/dev-tools/ci, +set -e pipefail, +gradle --info check -Dtests.network=true -Dtests.badapples=true, +++ b/dev-tools/ci, +set -e pipefail, +gradle --info check -Dtests.network=true -Dtests.badapples=true, +++ b/elasticsearch-transport-client/src/main/java/org/elasticsearch/xpack/client/PreBuiltXPackTransportClient.java, +        this(settings, plugins, null);, +    }, +, +    public PreBuiltXPackTransportClient(Settings settings, Collection<Class<? extends Plugin>> plugins,, +                                        HostFailureListener hostFailureListener) {, +        super(settings, addPlugins(plugins, Collections.singletonList(XPackPlugin.class)), hostFailureListener);, +++ b/dev-tools/ci, +set -e pipefail, +gradle --info check -Dtests.network=true -Dtests.badapples=true, +++ b/elasticsearch-transport-client/src/main/java/org/elasticsearch/xpack/client/PreBuiltXPackTransportClient.java, +        this(settings, plugins, null);, +    }, +, +    public PreBuiltXPackTransportClient(Settings settings, Collection<Class<? extends Plugin>> plugins,, +                                        HostFailureListener hostFailureListener) {, +        super(settings, addPlugins(plugins, Collections.singletonList(XPackPlugin.class)), hostFailureListener);, +++ b/elasticsearch/src/main/java/org/elasticsearch/license/License.java, +     *, +     * The id byte is used for ordering operation modes (used for merging license md in tribe node), +        MISSING((byte) 0),, +        TRIAL((byte) 1),, +        BASIC((byte) 2),, +        STANDARD((byte) 3),, +        GOLD((byte) 4),, +        PLATINUM((byte) 5);, +, +        private final byte id;, +, +        OperationMode(byte id) {, +            this.id = id;, +        }, +, +        /** Returns non-zero positive number when <code>opMode1</code> is greater than <code>opMode2</code> */, +        public static int compare(OperationMode opMode1, OperationMode opMode2) {, +            return Integer.compare(opMode1.id, opMode2.id);, +        }, +++ b/dev-tools/ci, +set -e pipefail, +gradle --info check -Dtests.network=true -Dtests.badapples=true, +++ b/elasticsearch-transport-client/src/main/java/org/elasticsearch/xpack/client/PreBuiltXPackTransportClient.java, +        this(settings, plugins, null);, +    }, +, +    public PreBuiltXPackTransportClient(Settings settings, Collection<Class<? extends Plugin>> plugins,, +                                        HostFailureListener hostFailureListener) {, +        super(settings, addPlugins(plugins, Collections.singletonList(XPackPlugin.class)), hostFailureListener);, +++ b/elasticsearch/src/main/java/org/elasticsearch/license/License.java, +     *, +     * The id byte is used for ordering operation modes (used for merging license md in tribe node), +        MISSING((byte) 0),, +        TRIAL((byte) 1),, +        BASIC((byte) 2),, +        STANDARD((byte) 3),, +        GOLD((byte) 4),, +        PLATINUM((byte) 5);, +, +        private final byte id;, +, +        OperationMode(byte id) {, +            this.id = id;, +        }, +, +        /** Returns non-zero positive number when <code>opMode1</code> is greater than <code>opMode2</code> */, +        public static int compare(OperationMode opMode1, OperationMode opMode2) {, +            return Integer.compare(opMode1.id, opMode2.id);, +        }, +++ b/elasticsearch/src/main/java/org/elasticsearch/license/LicensesMetaData.java, +import org.elasticsearch.license.License.OperationMode;, +import org.elasticsearch.tribe.TribeService;, +class LicensesMetaData extends AbstractDiffable<MetaData.Custom> implements MetaData.Custom,, +        TribeService.MergableCustomMetaData<LicensesMetaData> {, +    @Override, +    public LicensesMetaData merge(LicensesMetaData other) {, +        if (other.license == null) {, +            return this;, +        } else if (license == null, +                || OperationMode.compare(other.license.operationMode(), license.operationMode()) > 0) {, +            return other;, +        }, +        return this;, +    }, +, +++ b/dev-tools/ci, +set -e pipefail, +gradle --info check -Dtests.network=true -Dtests.badapples=true, +++ b/elasticsearch-transport-client/src/main/java/org/elasticsearch/xpack/client/PreBuiltXPackTransportClient.java, +        this(settings, plugins, null);, +    }, +, +    public PreBuiltXPackTransportClient(Settings settings, Collection<Class<? extends Plugin>> plugins,, +                                        HostFailureListener hostFailureListener) {, +        super(settings, addPlugins(plugins, Collections.singletonList(XPackPlugin.class)), hostFailureListener);, +++ b/elasticsearch/src/main/java/org/elasticsearch/license/License.java]
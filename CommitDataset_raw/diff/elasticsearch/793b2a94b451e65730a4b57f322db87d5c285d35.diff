[+++ b/x-pack/plugin/ccr/qa/multi-cluster-with-security/src/test/java/org/elasticsearch/xpack/ccr/FollowIndexSecurityIT.java, +        assertBusy(() -> {, +            verifyCcrMonitoring(allowedIndex, allowedIndex);, +            verifyAutoFollowMonitoring();, +        });, +    private static void verifyAutoFollowMonitoring() throws IOException {, +        Request request = new Request("GET", "/.monitoring-*/_search");, +        request.setJsonEntity("{\"query\": {\"term\": {\"type\": \"ccr_auto_follow_stats\"}}}");, +        Map<String, ?> response;, +        try {, +            response = toMap(adminClient().performRequest(request));, +        } catch (ResponseException e) {, +            throw new AssertionError("error while searching", e);, +        }, +, +        int numberOfSuccessfulFollowIndices = 0;, +, +        List<?> hits = (List<?>) XContentMapValues.extractValue("hits.hits", response);, +        assertThat(hits.size(), greaterThanOrEqualTo(1));, +, +        for (int i = 0; i < hits.size(); i++) {, +            Map<?, ?> hit = (Map<?, ?>) hits.get(i);, +, +            int foundNumberOfOperationsReceived =, +                (int) XContentMapValues.extractValue("_source.ccr_auto_follow_stats.number_of_successful_follow_indices", hit);, +            numberOfSuccessfulFollowIndices = Math.max(numberOfSuccessfulFollowIndices, foundNumberOfOperationsReceived);, +        }, +, +        assertThat(numberOfSuccessfulFollowIndices, greaterThanOrEqualTo(1));, +    }, +, +++ b/x-pack/plugin/ccr/qa/multi-cluster-with-security/src/test/java/org/elasticsearch/xpack/ccr/FollowIndexSecurityIT.java, +        assertBusy(() -> {, +            verifyCcrMonitoring(allowedIndex, allowedIndex);, +            verifyAutoFollowMonitoring();, +        });, +    private static void verifyAutoFollowMonitoring() throws IOException {, +        Request request = new Request("GET", "/.monitoring-*/_search");, +        request.setJsonEntity("{\"query\": {\"term\": {\"type\": \"ccr_auto_follow_stats\"}}}");, +        Map<String, ?> response;, +        try {, +            response = toMap(adminClient().performRequest(request));, +        } catch (ResponseException e) {, +            throw new AssertionError("error while searching", e);, +        }, +, +        int numberOfSuccessfulFollowIndices = 0;, +, +        List<?> hits = (List<?>) XContentMapValues.extractValue("hits.hits", response);, +        assertThat(hits.size(), greaterThanOrEqualTo(1));, +, +        for (int i = 0; i < hits.size(); i++) {, +            Map<?, ?> hit = (Map<?, ?>) hits.get(i);, +, +            int foundNumberOfOperationsReceived =, +                (int) XContentMapValues.extractValue("_source.ccr_auto_follow_stats.number_of_successful_follow_indices", hit);, +            numberOfSuccessfulFollowIndices = Math.max(numberOfSuccessfulFollowIndices, foundNumberOfOperationsReceived);, +        }, +, +        assertThat(numberOfSuccessfulFollowIndices, greaterThanOrEqualTo(1));, +    }, +, +++ b/x-pack/plugin/ccr/qa/multi-cluster/src/test/java/org/elasticsearch/xpack/ccr/FollowIndexIT.java, +        assertBusy(() -> {, +            verifyCcrMonitoring("logs-20190101", "logs-20190101");, +            verifyAutoFollowMonitoring();, +        });, +    private static void verifyAutoFollowMonitoring() throws IOException {, +        Request request = new Request("GET", "/.monitoring-*/_search");, +        request.setJsonEntity("{\"query\": {\"term\": {\"type\": \"ccr_auto_follow_stats\"}}}");, +        Map<String, ?> response;, +        try {, +            response = toMap(client().performRequest(request));, +        } catch (ResponseException e) {, +            throw new AssertionError("error while searching", e);, +        }, +, +        int numberOfSuccessfulFollowIndices = 0;, +, +        List<?> hits = (List<?>) XContentMapValues.extractValue("hits.hits", response);, +        assertThat(hits.size(), greaterThanOrEqualTo(1));, +, +        for (int i = 0; i < hits.size(); i++) {, +            Map<?, ?> hit = (Map<?, ?>) hits.get(i);, +, +            int foundNumberOfOperationsReceived =, +                (int) XContentMapValues.extractValue("_source.ccr_auto_follow_stats.number_of_successful_follow_indices", hit);, +            numberOfSuccessfulFollowIndices = Math.max(numberOfSuccessfulFollowIndices, foundNumberOfOperationsReceived);, +        }, +, +        assertThat(numberOfSuccessfulFollowIndices, greaterThanOrEqualTo(1));, +    }, +, +++ b/x-pack/plugin/ccr/qa/multi-cluster-with-security/src/test/java/org/elasticsearch/xpack/ccr/FollowIndexSecurityIT.java, +        assertBusy(() -> {, +            verifyCcrMonitoring(allowedIndex, allowedIndex);, +            verifyAutoFollowMonitoring();, +        });, +    private static void verifyAutoFollowMonitoring() throws IOException {, +        Request request = new Request("GET", "/.monitoring-*/_search");]
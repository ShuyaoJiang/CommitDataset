[+++ b/pom.xml, +        <dependency>, +            <groupId>org.xerial.snappy</groupId>, +            <artifactId>snappy-java</artifactId>, +            <version>1.0.4.1</version>, +            <scope>compile</scope>, +            <optional>true</optional>, +        </dependency>, +, +                                    <includes>lucene*, log4j*, jna*, snappy-java-*</includes>, +++ b/pom.xml, +        <dependency>, +            <groupId>org.xerial.snappy</groupId>, +            <artifactId>snappy-java</artifactId>, +            <version>1.0.4.1</version>, +            <scope>compile</scope>, +            <optional>true</optional>, +        </dependency>, +, +                                    <includes>lucene*, log4j*, jna*, snappy-java-*</includes>, +++ b/src/main/assemblies/common-bin.xml, +                <include>org.xerial.snappy:snappy-java</include>, +++ b/pom.xml, +        <dependency>, +            <groupId>org.xerial.snappy</groupId>, +            <artifactId>snappy-java</artifactId>, +            <version>1.0.4.1</version>, +            <scope>compile</scope>, +            <optional>true</optional>, +        </dependency>, +, +                                    <includes>lucene*, log4j*, jna*, snappy-java-*</includes>, +++ b/src/main/assemblies/common-bin.xml, +                <include>org.xerial.snappy:snappy-java</include>, +++ b/src/main/java/org/elasticsearch/client/transport/TransportClient.java, +import org.elasticsearch.common.compress.CompressorFactory;, +        CompressorFactory.configure(settings);, +, +++ b/pom.xml, +        <dependency>, +            <groupId>org.xerial.snappy</groupId>, +            <artifactId>snappy-java</artifactId>, +            <version>1.0.4.1</version>, +            <scope>compile</scope>, +            <optional>true</optional>, +        </dependency>, +, +                                    <includes>lucene*, log4j*, jna*, snappy-java-*</includes>, +++ b/src/main/assemblies/common-bin.xml, +                <include>org.xerial.snappy:snappy-java</include>, +++ b/src/main/java/org/elasticsearch/client/transport/TransportClient.java, +import org.elasticsearch.common.compress.CompressorFactory;, +        CompressorFactory.configure(settings);, +, +++ b/src/main/java/org/elasticsearch/cluster/ClusterState.java, +                BytesStreamOutput os = cachedEntry.bytes();, +++ b/pom.xml, +        <dependency>, +            <groupId>org.xerial.snappy</groupId>, +            <artifactId>snappy-java</artifactId>, +            <version>1.0.4.1</version>, +            <scope>compile</scope>, +            <optional>true</optional>, +        </dependency>, +, +                                    <includes>lucene*, log4j*, jna*, snappy-java-*</includes>, +++ b/src/main/assemblies/common-bin.xml, +                <include>org.xerial.snappy:snappy-java</include>, +++ b/src/main/java/org/elasticsearch/client/transport/TransportClient.java, +import org.elasticsearch.common.compress.CompressorFactory;, +        CompressorFactory.configure(settings);, +, +++ b/src/main/java/org/elasticsearch/cluster/ClusterState.java, +                BytesStreamOutput os = cachedEntry.bytes();, +++ b/src/main/java/org/elasticsearch/common/compress/CompressedIndexInput.java, +public abstract class CompressedIndexInput<T extends CompressorContext> extends IndexInput {, +    protected final T context;, +    private long totalUncompressedLength;, +    protected int uncompressedLength;, +    public CompressedIndexInput(IndexInput in, T context) throws IOException {, +        this.context = context;, +        this.totalUncompressedLength = in.readVLong();, +        int idx = (int) (pos / uncompressedLength);, +        position = (int) (pos % uncompressedLength);, +        return totalUncompressedLength;, +        currentUncompressedChunkPointer = ((long) currentOffsetIdx) * uncompressedLength;, +        cloned.uncompressed = new byte[uncompressedLength];, +        System.arraycopy(uncompressed, 0, cloned.uncompressed, 0, uncompressedLength);, +++ b/pom.xml, +        <dependency>, +            <groupId>org.xerial.snappy</groupId>, +            <artifactId>snappy-java</artifactId>, +            <version>1.0.4.1</version>, +            <scope>compile</scope>, +            <optional>true</optional>, +        </dependency>, +, +                                    <includes>lucene*, log4j*, jna*, snappy-java-*</includes>, +++ b/src/main/assemblies/common-bin.xml, +                <include>org.xerial.snappy:snappy-java</include>]
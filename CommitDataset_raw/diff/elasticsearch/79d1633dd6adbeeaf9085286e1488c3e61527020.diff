[+++ b/src/main/java/org/elasticsearch/search/aggregations/bucket/terms/InternalOrder.java, +                        return asc ? Double.compare(v1, v2) : Double.compare(v2, v1);, +                    return asc ? Double.compare(v1, v2) : Double.compare(v2, v1);, +++ b/src/main/java/org/elasticsearch/search/aggregations/bucket/terms/InternalOrder.java, +                        return asc ? Double.compare(v1, v2) : Double.compare(v2, v1);, +                    return asc ? Double.compare(v1, v2) : Double.compare(v2, v1);, +++ b/src/test/java/org/elasticsearch/search/aggregations/bucket/StringTermsTests.java, +        int i = 0;, +        for (Terms.Bucket bucket : terms.getBuckets()) {, +            i++;, +        int i = 4;, +        for (Terms.Bucket bucket : terms.getBuckets()) {, +            i--;, +        int i = 0;, +        for (Terms.Bucket bucket : terms.getBuckets()) {, +            i++;, +        int i = 4;, +        for (Terms.Bucket bucket : terms.getBuckets()) {, +            i--;, +                        .order(Terms.Order.aggregation("stats.sum_of_squares", asc)), +        int i = 0;, +        for (Terms.Bucket bucket : terms.getBuckets()) {, +            i++;]
[+++ b/core/src/main/java/org/elasticsearch/transport/TcpTransport.java, +            assert success;, +            assert success;, +++ b/core/src/main/java/org/elasticsearch/transport/TcpTransport.java, +            assert success;, +            assert success;, +++ b/test/framework/src/main/java/org/elasticsearch/transport/AbstractSimpleTransportTestCase.java, +            ConnectTransportException exception = expectThrows(ConnectTransportException.class, () -> serviceA.connectToNode(node));, +            assertTrue(exception.getCause() instanceof IllegalStateException);, +            assertEquals("handshake failed", exception.getCause().getMessage());]
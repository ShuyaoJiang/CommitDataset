[+++ b/build.gradle, +    "org.elasticsearch.distribution.integ-test-zip:elasticsearch:${version}": ':distribution:integ-test-zip',, +++ b/build.gradle, +    "org.elasticsearch.distribution.integ-test-zip:elasticsearch:${version}": ':distribution:integ-test-zip',, +++ b/buildSrc/build.gradle, +++ b/build.gradle, +    "org.elasticsearch.distribution.integ-test-zip:elasticsearch:${version}": ':distribution:integ-test-zip',, +++ b/buildSrc/build.gradle, +++ b/buildSrc/src/main/groovy/org/elasticsearch/gradle/test/ClusterConfiguration.groovy, +    String distribution = 'integ-test-zip', +++ b/build.gradle, +    "org.elasticsearch.distribution.integ-test-zip:elasticsearch:${version}": ':distribution:integ-test-zip',, +++ b/buildSrc/build.gradle, +++ b/buildSrc/src/main/groovy/org/elasticsearch/gradle/test/ClusterConfiguration.groovy, +    String distribution = 'integ-test-zip', +++ b/buildSrc/src/main/groovy/org/elasticsearch/gradle/test/ClusterFormationTasks.groovy, +        String packaging = distro, +        if (distro == 'tar') {, +            packaging = 'tar.gz', +        } else if (distro == 'integ-test-zip') {, +            packaging = 'zip', +        }, +            case 'integ-test-zip':, +++ b/build.gradle, +    "org.elasticsearch.distribution.integ-test-zip:elasticsearch:${version}": ':distribution:integ-test-zip',, +++ b/buildSrc/build.gradle, +++ b/buildSrc/src/main/groovy/org/elasticsearch/gradle/test/ClusterConfiguration.groovy, +    String distribution = 'integ-test-zip', +++ b/buildSrc/src/main/groovy/org/elasticsearch/gradle/test/ClusterFormationTasks.groovy, +        String packaging = distro, +        if (distro == 'tar') {, +            packaging = 'tar.gz', +        } else if (distro == 'integ-test-zip') {, +            packaging = 'zip', +        }, +            case 'integ-test-zip':, +++ b/buildSrc/src/main/groovy/org/elasticsearch/gradle/test/NodeInfo.groovy, +            case 'integ-test-zip':, +            case 'integ-test-zip':, +++ b/build.gradle, +    "org.elasticsearch.distribution.integ-test-zip:elasticsearch:${version}": ':distribution:integ-test-zip',, +++ b/buildSrc/build.gradle, +++ b/buildSrc/src/main/groovy/org/elasticsearch/gradle/test/ClusterConfiguration.groovy, +    String distribution = 'integ-test-zip', +++ b/buildSrc/src/main/groovy/org/elasticsearch/gradle/test/ClusterFormationTasks.groovy, +        String packaging = distro, +        if (distro == 'tar') {, +            packaging = 'tar.gz', +        } else if (distro == 'integ-test-zip') {, +            packaging = 'zip', +        }, +            case 'integ-test-zip':, +++ b/buildSrc/src/main/groovy/org/elasticsearch/gradle/test/NodeInfo.groovy, +            case 'integ-test-zip':, +            case 'integ-test-zip':, +++ b/core/src/main/java/org/elasticsearch/action/support/broadcast/node/TransportBroadcastByNodeAction.java, +++ b/build.gradle, +    "org.elasticsearch.distribution.integ-test-zip:elasticsearch:${version}": ':distribution:integ-test-zip',, +++ b/buildSrc/build.gradle, +++ b/buildSrc/src/main/groovy/org/elasticsearch/gradle/test/ClusterConfiguration.groovy, +    String distribution = 'integ-test-zip', +++ b/buildSrc/src/main/groovy/org/elasticsearch/gradle/test/ClusterFormationTasks.groovy, +        String packaging = distro, +        if (distro == 'tar') {, +            packaging = 'tar.gz', +        } else if (distro == 'integ-test-zip') {, +            packaging = 'zip', +        }, +            case 'integ-test-zip':, +++ b/buildSrc/src/main/groovy/org/elasticsearch/gradle/test/NodeInfo.groovy, +            case 'integ-test-zip':, +            case 'integ-test-zip':, +++ b/core/src/main/java/org/elasticsearch/action/support/broadcast/node/TransportBroadcastByNodeAction.java, +++ b/core/src/main/java/org/elasticsearch/bootstrap/Security.java, +        // collect up lists of plugins and modules, +        List<Path> pluginsAndModules = new ArrayList<>();, +                    pluginsAndModules.add(plugin);, +                }, +            }, +        }, +        if (Files.exists(environment.modulesFile())) {, +            try (DirectoryStream<Path> stream = Files.newDirectoryStream(environment.modulesFile())) {, +                for (Path plugin : stream) {, +                    pluginsAndModules.add(plugin);, +                }, +            }, +        }, +        // now process each one, +        for (Path plugin : pluginsAndModules) {, +, +        addPath(policy, "path.home", environment.modulesFile(), "read,readlink");, +++ b/build.gradle, +    "org.elasticsearch.distribution.integ-test-zip:elasticsearch:${version}": ':distribution:integ-test-zip',, +++ b/buildSrc/build.gradle, +++ b/buildSrc/src/main/groovy/org/elasticsearch/gradle/test/ClusterConfiguration.groovy, +    String distribution = 'integ-test-zip', +++ b/buildSrc/src/main/groovy/org/elasticsearch/gradle/test/ClusterFormationTasks.groovy, +        String packaging = distro, +        if (distro == 'tar') {, +            packaging = 'tar.gz']
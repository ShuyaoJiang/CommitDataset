[+++ b/modules/elasticsearch/src/main/java/org/elasticsearch/index/field/function/script/ScriptFieldsFunction.java, +    public boolean containsKey(Object key) {, +        // assume its a string..., +        String fieldName = key.toString();, +        FieldData fieldData = localCacheFieldData.get(fieldName);, +        if (fieldData == null) {, +            FieldMapper mapper = mapperService.smartNameFieldMapper(fieldName);, +            if (mapper == null) {, +                return false;, +            }, +        }, +        return true;, +    }, +, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/index/field/function/script/ScriptFieldsFunction.java, +    public boolean containsKey(Object key) {, +        // assume its a string..., +        String fieldName = key.toString();, +        FieldData fieldData = localCacheFieldData.get(fieldName);, +        if (fieldData == null) {, +            FieldMapper mapper = mapperService.smartNameFieldMapper(fieldName);, +            if (mapper == null) {, +                return false;, +            }, +        }, +        return true;, +    }, +, +++ b/modules/test/integration/src/test/java/org/elasticsearch/test/integration/search/scriptfield/ScriptFieldSearchTests.java, +                .setSource(jsonBuilder().startObject().field("test", "value beck").field("num1", 1.0f).field("date", "1970-01-01T00:00:00").endObject()), +                .setSource(jsonBuilder().startObject().field("test", "value beck").field("num1", 2.0f).field("date", "1970-01-01T00:00:25").endObject()), +                .setSource(jsonBuilder().startObject().field("test", "value beck").field("num1", 3.0f).field("date", "1970-01-01T00:02:00").endObject()), +                .addScriptField("date1", "doc['date'].date.millis"), +        assertThat((Long) response.hits().getAt(0).fields().get("date1").values().get(0), equalTo(0l));, +        assertThat((Long) response.hits().getAt(1).fields().get("date1").values().get(0), equalTo(25000l));, +        assertThat((Long) response.hits().getAt(2).fields().get("date1").values().get(0), equalTo(120000l));]
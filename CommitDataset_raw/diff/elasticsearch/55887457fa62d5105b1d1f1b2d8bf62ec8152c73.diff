[+++ b/plugins/repository-s3/src/main/java/org/elasticsearch/plugin/repository/s3/S3RepositoryPlugin.java, +    public List<String> getSettingsFilter() {, +        return Arrays.asList(, +            S3Repository.Repository.KEY_SETTING.getKey(),, +            S3Repository.Repository.SECRET_SETTING.getKey());, +    }, +, +    @Override, +        return Arrays.asList(, +        // Register global cloud aws settings: cloud.aws (might have been registered in ec2 plugin), +        S3Repository.Repositories.PATH_STYLE_ACCESS_SETTING);, +++ b/plugins/repository-s3/src/main/java/org/elasticsearch/plugin/repository/s3/S3RepositoryPlugin.java, +    public List<String> getSettingsFilter() {, +        return Arrays.asList(, +            S3Repository.Repository.KEY_SETTING.getKey(),, +            S3Repository.Repository.SECRET_SETTING.getKey());, +    }, +, +    @Override, +        return Arrays.asList(, +        // Register global cloud aws settings: cloud.aws (might have been registered in ec2 plugin), +        S3Repository.Repositories.PATH_STYLE_ACCESS_SETTING);, +++ b/plugins/repository-s3/src/main/java/org/elasticsearch/repositories/s3/S3Repository.java, +        Setting<String> KEY_SETTING = Setting.simpleString("access_key");, +        Setting<String> SECRET_SETTING = Setting.simpleString("secret_key");, +        Setting<String> BUCKET_SETTING = Setting.simpleString("bucket");, +        Setting<String> ENDPOINT_SETTING = Setting.simpleString("endpoint");, +        Setting<Protocol> PROTOCOL_SETTING = new Setting<>("protocol", "https", s -> Protocol.valueOf(s.toUpperCase(Locale.ROOT)));, +        Setting<String> REGION_SETTING = new Setting<>("region", "", s -> s.toLowerCase(Locale.ROOT));, +        Setting<Boolean> SERVER_SIDE_ENCRYPTION_SETTING = Setting.boolSetting("server_side_encryption", false);, +                new ByteSizeValue(5, ByteSizeUnit.MB), new ByteSizeValue(5, ByteSizeUnit.TB));, +        Setting<Integer> MAX_RETRIES_SETTING = Setting.intSetting("max_retries", 3);, +            ClientConfiguration.DEFAULT_THROTTLE_RETRIES);, +                new ByteSizeValue(5, ByteSizeUnit.MB), new ByteSizeValue(5, ByteSizeUnit.TB));, +        Setting<Boolean> COMPRESS_SETTING = Setting.boolSetting("compress", false);, +        Setting<String> STORAGE_CLASS_SETTING = Setting.simpleString("storage_class");, +        Setting<String> CANNED_ACL_SETTING = Setting.simpleString("canned_acl");, +        Setting<String> BASE_PATH_SETTING = Setting.simpleString("base_path");, +        Setting<Boolean> PATH_STYLE_ACCESS_SETTING = Setting.boolSetting("path_style_access", false);]
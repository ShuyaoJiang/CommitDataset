[+++ b/marvel/src/main/java/org/elasticsearch/marvel/agent/exporter/Exporter.java, +++ b/marvel/src/main/java/org/elasticsearch/marvel/agent/exporter/Exporter.java, +++ b/marvel/src/main/java/org/elasticsearch/marvel/agent/exporter/Exporters.java, +    @Override, +    protected void doClose() {, +    }, +, +++ b/marvel/src/main/java/org/elasticsearch/marvel/agent/exporter/Exporter.java, +++ b/marvel/src/main/java/org/elasticsearch/marvel/agent/exporter/Exporters.java, +    @Override, +    protected void doClose() {, +    }, +, +++ b/marvel/src/main/java/org/elasticsearch/marvel/agent/exporter/http/HttpExporter.java, +++ b/marvel/src/main/java/org/elasticsearch/marvel/agent/exporter/Exporter.java, +++ b/marvel/src/main/java/org/elasticsearch/marvel/agent/exporter/Exporters.java, +    @Override, +    protected void doClose() {, +    }, +, +++ b/marvel/src/main/java/org/elasticsearch/marvel/agent/exporter/http/HttpExporter.java, +++ b/marvel/src/main/java/org/elasticsearch/marvel/agent/exporter/local/LocalExporter.java, +import static org.elasticsearch.marvel.agent.exporter.http.HttpExporterUtils.MARVEL_VERSION_FIELD;, +        state.set(State.STARTING);, +        if (state.compareAndSet(State.STARTED, State.STOPPING) || state.compareAndSet(State.STARTING, State.STOPPING)) {, +        if (state.get() == State.STARTED) {, +        if (state.get() != State.STARTING) {, +        queueConsumer.start();, +        state.set(State.STARTED);, +                String version = template.settings().get("index." + MARVEL_VERSION_FIELD);, +++ b/marvel/src/main/java/org/elasticsearch/marvel/agent/exporter/Exporter.java, +++ b/marvel/src/main/java/org/elasticsearch/marvel/agent/exporter/Exporters.java, +    @Override, +    protected void doClose() {, +    }, +, +++ b/marvel/src/main/java/org/elasticsearch/marvel/agent/exporter/http/HttpExporter.java, +++ b/marvel/src/main/java/org/elasticsearch/marvel/agent/exporter/local/LocalExporter.java, +import static org.elasticsearch.marvel.agent.exporter.http.HttpExporterUtils.MARVEL_VERSION_FIELD;, +        state.set(State.STARTING);, +        if (state.compareAndSet(State.STARTED, State.STOPPING) || state.compareAndSet(State.STARTING, State.STOPPING)) {, +        if (state.get() == State.STARTED) {, +        if (state.get() != State.STARTING) {, +        queueConsumer.start();, +        state.set(State.STARTED);, +                String version = template.settings().get("index." + MARVEL_VERSION_FIELD);, +++ b/marvel/src/test/java/org/elasticsearch/marvel/agent/exporter/ExportersTests.java]
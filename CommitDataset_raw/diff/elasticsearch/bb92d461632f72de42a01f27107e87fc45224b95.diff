[+++ b/src/test/java/org/elasticsearch/tribe/TribeTests.java, +import static org.hamcrest.Matchers.notNullValue;, +        assertBusy(new Runnable() {, +            public void run() {, +                assertThat(tribeState.getMetaData().index("test1").mapping("type1"), notNullValue());, +                assertThat(tribeState.getMetaData().index("test2").mapping("type1"), notNullValue());, +        assertBusy(new Runnable() {, +            public void run() {, +                assertThat(tribeState.getMetaData().index("test1").mapping("type1"), notNullValue());, +                assertThat(tribeState.getMetaData().index("test1").mapping("type2"), notNullValue());, +                assertThat(tribeState.getMetaData().index("test2").mapping("type1"), notNullValue());, +                assertThat(tribeState.getMetaData().index("test2").mapping("type2"), notNullValue());, +        assertBusy(new Runnable() {, +            public void run() {, +                assertTrue(tribeState.getMetaData().hasIndex("test1"));, +                assertFalse(tribeState.getMetaData().hasIndex("test2"));, +                assertTrue(tribeState.getRoutingTable().hasIndex("test1"));, +                assertFalse(tribeState.getRoutingTable().hasIndex("test2"));, +        assertBusy(new Runnable() {, +            public void run() {, +                    assertTrue(tribeState.getMetaData().hasIndex(index));, +                    assertTrue(tribeState.getRoutingTable().hasIndex(index));, +        assertBusy(new Runnable() {, +            public void run() {, +                assertThat(countDataNodesForTribe("t1", tribeNodes), equalTo(internalCluster().client().admin().cluster().prepareState().get().getState().getNodes().dataNodes().size()));, +                assertThat(countDataNodesForTribe("t2", tribeNodes), equalTo(cluster2.client().admin().cluster().prepareState().get().getState().getNodes().dataNodes().size()));]
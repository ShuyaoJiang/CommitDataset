[+++ b/elasticsearch/qa/audit-tests/src/test/java/org/elasticsearch/xpack/security/audit/IndexAuditIT.java, +++ b/elasticsearch/qa/audit-tests/src/test/java/org/elasticsearch/xpack/security/audit/IndexAuditIT.java, +++ b/elasticsearch/qa/security-client-tests/src/test/java/org/elasticsearch/xpack/security/qa/SecurityTransportClientIT.java, +import org.elasticsearch.transport.MockTransportClient;, +        return new MockTransportClient(settings, XPackPlugin.class).addTransportAddress(publishAddress);, +++ b/elasticsearch/qa/audit-tests/src/test/java/org/elasticsearch/xpack/security/audit/IndexAuditIT.java, +++ b/elasticsearch/qa/security-client-tests/src/test/java/org/elasticsearch/xpack/security/qa/SecurityTransportClientIT.java, +import org.elasticsearch.transport.MockTransportClient;, +        return new MockTransportClient(settings, XPackPlugin.class).addTransportAddress(publishAddress);, +++ b/elasticsearch/qa/security-example-realm/src/test/java/org/elasticsearch/example/realm/CustomRealmIT.java, +import java.util.Arrays;, +++ b/elasticsearch/qa/audit-tests/src/test/java/org/elasticsearch/xpack/security/audit/IndexAuditIT.java, +++ b/elasticsearch/qa/security-client-tests/src/test/java/org/elasticsearch/xpack/security/qa/SecurityTransportClientIT.java, +import org.elasticsearch.transport.MockTransportClient;, +        return new MockTransportClient(settings, XPackPlugin.class).addTransportAddress(publishAddress);, +++ b/elasticsearch/qa/security-example-realm/src/test/java/org/elasticsearch/example/realm/CustomRealmIT.java, +import java.util.Arrays;, +++ b/elasticsearch/qa/smoke-test-plugins-ssl/src/test/java/org/elasticsearch/smoketest/SmokeTestMonitoringWithSecurityIT.java, +        return Settings.builder(), +                .put("xpack.security.ssl.keystore.password", KEYSTORE_PASS), +                .put(NetworkModule.TRANSPORT_TYPE_KEY, Security.NAME), +                .build();, +++ b/elasticsearch/qa/audit-tests/src/test/java/org/elasticsearch/xpack/security/audit/IndexAuditIT.java, +++ b/elasticsearch/qa/security-client-tests/src/test/java/org/elasticsearch/xpack/security/qa/SecurityTransportClientIT.java, +import org.elasticsearch.transport.MockTransportClient;, +        return new MockTransportClient(settings, XPackPlugin.class).addTransportAddress(publishAddress);, +++ b/elasticsearch/qa/security-example-realm/src/test/java/org/elasticsearch/example/realm/CustomRealmIT.java, +import java.util.Arrays;, +++ b/elasticsearch/qa/smoke-test-plugins-ssl/src/test/java/org/elasticsearch/smoketest/SmokeTestMonitoringWithSecurityIT.java, +        return Settings.builder(), +                .put("xpack.security.ssl.keystore.password", KEYSTORE_PASS), +                .put(NetworkModule.TRANSPORT_TYPE_KEY, Security.NAME), +                .build();, +++ b/elasticsearch/x-pack/build.gradle, +++ b/elasticsearch/qa/audit-tests/src/test/java/org/elasticsearch/xpack/security/audit/IndexAuditIT.java, +++ b/elasticsearch/qa/security-client-tests/src/test/java/org/elasticsearch/xpack/security/qa/SecurityTransportClientIT.java, +import org.elasticsearch.transport.MockTransportClient;, +        return new MockTransportClient(settings, XPackPlugin.class).addTransportAddress(publishAddress);, +++ b/elasticsearch/qa/security-example-realm/src/test/java/org/elasticsearch/example/realm/CustomRealmIT.java, +import java.util.Arrays;, +++ b/elasticsearch/qa/smoke-test-plugins-ssl/src/test/java/org/elasticsearch/smoketest/SmokeTestMonitoringWithSecurityIT.java, +        return Settings.builder(), +                .put("xpack.security.ssl.keystore.password", KEYSTORE_PASS), +                .put(NetworkModule.TRANSPORT_TYPE_KEY, Security.NAME), +                .build();, +++ b/elasticsearch/x-pack/build.gradle, +++ b/elasticsearch/x-pack/license-plugin/src/test/java/org/elasticsearch/license/LicenseServiceClusterTests.java, +        return Arrays.asList(XPackPlugin.class, MockNetty3Plugin.class);, +++ b/elasticsearch/qa/audit-tests/src/test/java/org/elasticsearch/xpack/security/audit/IndexAuditIT.java, +++ b/elasticsearch/qa/security-client-tests/src/test/java/org/elasticsearch/xpack/security/qa/SecurityTransportClientIT.java, +import org.elasticsearch.transport.MockTransportClient;, +        return new MockTransportClient(settings, XPackPlugin.class).addTransportAddress(publishAddress);, +++ b/elasticsearch/qa/security-example-realm/src/test/java/org/elasticsearch/example/realm/CustomRealmIT.java, +import java.util.Arrays;, +++ b/elasticsearch/qa/smoke-test-plugins-ssl/src/test/java/org/elasticsearch/smoketest/SmokeTestMonitoringWithSecurityIT.java, +        return Settings.builder(), +                .put("xpack.security.ssl.keystore.password", KEYSTORE_PASS), +                .put(NetworkModule.TRANSPORT_TYPE_KEY, Security.NAME), +                .build();, +++ b/elasticsearch/x-pack/build.gradle, +++ b/elasticsearch/x-pack/license-plugin/src/test/java/org/elasticsearch/license/LicenseServiceClusterTests.java, +        return Arrays.asList(XPackPlugin.class, MockNetty3Plugin.class);, +++ b/elasticsearch/x-pack/monitoring/src/test/java/org/elasticsearch/xpack/monitoring/agent/settings/MonitoringSettingsTests.java, +++ b/elasticsearch/qa/audit-tests/src/test/java/org/elasticsearch/xpack/security/audit/IndexAuditIT.java, +++ b/elasticsearch/qa/security-client-tests/src/test/java/org/elasticsearch/xpack/security/qa/SecurityTransportClientIT.java, +import org.elasticsearch.transport.MockTransportClient;, +        return new MockTransportClient(settings, XPackPlugin.class).addTransportAddress(publishAddress);, +++ b/elasticsearch/qa/security-example-realm/src/test/java/org/elasticsearch/example/realm/CustomRealmIT.java, +import java.util.Arrays;, +++ b/elasticsearch/qa/smoke-test-plugins-ssl/src/test/java/org/elasticsearch/smoketest/SmokeTestMonitoringWithSecurityIT.java, +        return Settings.builder(), +                .put("xpack.security.ssl.keystore.password", KEYSTORE_PASS), +                .put(NetworkModule.TRANSPORT_TYPE_KEY, Security.NAME), +                .build();, +++ b/elasticsearch/x-pack/build.gradle, +++ b/elasticsearch/x-pack/license-plugin/src/test/java/org/elasticsearch/license/LicenseServiceClusterTests.java, +        return Arrays.asList(XPackPlugin.class, MockNetty3Plugin.class);, +++ b/elasticsearch/x-pack/monitoring/src/test/java/org/elasticsearch/xpack/monitoring/agent/settings/MonitoringSettingsTests.java, +++ b/elasticsearch/x-pack/monitoring/src/test/java/org/elasticsearch/xpack/monitoring/security/MonitoringSettingsFilterTests.java, +++ b/elasticsearch/qa/audit-tests/src/test/java/org/elasticsearch/xpack/security/audit/IndexAuditIT.java, +++ b/elasticsearch/qa/security-client-tests/src/test/java/org/elasticsearch/xpack/security/qa/SecurityTransportClientIT.java, +import org.elasticsearch.transport.MockTransportClient;, +        return new MockTransportClient(settings, XPackPlugin.class).addTransportAddress(publishAddress);, +++ b/elasticsearch/qa/security-example-realm/src/test/java/org/elasticsearch/example/realm/CustomRealmIT.java, +import java.util.Arrays;, +++ b/elasticsearch/qa/smoke-test-plugins-ssl/src/test/java/org/elasticsearch/smoketest/SmokeTestMonitoringWithSecurityIT.java, +        return Settings.builder(), +                .put("xpack.security.ssl.keystore.password", KEYSTORE_PASS), +                .put(NetworkModule.TRANSPORT_TYPE_KEY, Security.NAME), +                .build();, +++ b/elasticsearch/x-pack/build.gradle, +++ b/elasticsearch/x-pack/license-plugin/src/test/java/org/elasticsearch/license/LicenseServiceClusterTests.java, +        return Arrays.asList(XPackPlugin.class, MockNetty3Plugin.class);, +++ b/elasticsearch/x-pack/monitoring/src/test/java/org/elasticsearch/xpack/monitoring/agent/settings/MonitoringSettingsTests.java, +++ b/elasticsearch/x-pack/monitoring/src/test/java/org/elasticsearch/xpack/monitoring/security/MonitoringSettingsFilterTests.java, +++ b/elasticsearch/x-pack/monitoring/src/test/java/org/elasticsearch/xpack/monitoring/test/MonitoringIntegTestCase.java, +                        .put("xpack.security.audit.enabled", auditLogsEnabled);, +++ b/elasticsearch/qa/audit-tests/src/test/java/org/elasticsearch/xpack/security/audit/IndexAuditIT.java, +++ b/elasticsearch/qa/security-client-tests/src/test/java/org/elasticsearch/xpack/security/qa/SecurityTransportClientIT.java, +import org.elasticsearch.transport.MockTransportClient;]
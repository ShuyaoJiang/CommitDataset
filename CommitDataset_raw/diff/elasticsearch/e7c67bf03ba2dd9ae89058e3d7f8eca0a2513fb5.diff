[+++ b/src/test/java/org/elasticsearch/test/CompositeTestCluster.java, +import org.elasticsearch.client.Client;, +import org.elasticsearch.client.ClusterAdminClient;, +import org.elasticsearch.client.FilterClient;, +import org.elasticsearch.client.IndicesAdminClient;, +import java.util.Arrays;, +import java.util.Collection;, +import java.util.Iterator;, +import java.util.Random;, +    public synchronized boolean upgradeAllNodes() throws InterruptedException, IOException {, +    public synchronized boolean upgradeAllNodes(Settings nodeSettings) throws InterruptedException, IOException {, +        boolean upgradedOneNode = false;, +        while(upgradeOneNode(nodeSettings)) {, +            upgradedOneNode = true;, +        return upgradedOneNode;]
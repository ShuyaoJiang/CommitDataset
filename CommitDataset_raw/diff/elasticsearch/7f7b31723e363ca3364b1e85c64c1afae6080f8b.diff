[+++ b/docs/reference/ingest/ingest-node.asciidoc, +[[ingest-conditionals]], +== Conditional Execution in Pipelines, +, +Each processor allows for an optional `if` condition to determine if that, +processor should be executed or skipped. The value of the `if` is a, +<<modules-scripting-painless, Painless>> script that needs to evaluate, +to `true` or `false`., +, +For example the following processor will <<drop-processor,drop>> the document, +(i.e. not index it) if the input document has a field named `network_name`, +and it is equal to `Guest`., +, +[source,js], +--------------------------------------------------, +PUT _ingest/pipeline/drop_guests_network, +{, +  "processors": [, +    {, +      "drop": {, +        "if": "ctx.network_name == 'Guest'", +      }, +    }, +  ], +}, +--------------------------------------------------, +// CONSOLE, +, +Using that pipeline for an index request:, +, +[source,js], +--------------------------------------------------, +POST test/_doc/1?pipeline=drop_guests_network, +{, +  "network_name" : "Guest", +}, +--------------------------------------------------, +// CONSOLE, +// TEST[continued], +, +Results in nothing indexed since the conditional evaluated to `true`., +, +[source,js], +--------------------------------------------------, +{, +  "_index": "test",, +  "_type": "_doc",, +  "_id": "1",, +  "_version": -3,, +  "result": "noop",, +  "_shards": {, +    "total": 0,, +    "successful": 0,, +    "failed": 0, +  }, +}, +--------------------------------------------------, +// TESTRESPONSE, +, +, +[[ingest-conditional-nullcheck]], +=== Handling Nested Fields in Conditionals, +, +Source documents often contain nested fields. Care should be taken, +to avoid NullPointerExceptions if the parent object does not exist, +in the document. For example `ctx.a.b.c` can throw an NullPointerExceptions, +if the source document does not have top level `a` object, or a second, +level `b` object., +, +To help protect against NullPointerExceptions, null safe operations should be used., +Fortunately, Painless makes {painless}/painless-operators-reference.html#null-safe-operator[null safe], +operations easy with the `?.` operator., +, +[source,js], +--------------------------------------------------, +PUT _ingest/pipeline/drop_guests_network, +{, +  "processors": [, +    {, +      "drop": {, +        "if": "ctx.network?.name == 'Guest'", +      }, +    }, +  ], +}, +--------------------------------------------------, +// CONSOLE, +, +The following document will get <<drop-processor,dropped>> correctly:, +, +[source,js], +--------------------------------------------------, +POST test/_doc/1?pipeline=drop_guests_network, +{, +  "network": {, +    "name": "Guest", +  }, +}, +--------------------------------------------------, +// CONSOLE]
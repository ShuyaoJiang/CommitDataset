[+++ b/modules/lang-groovy/src/main/plugin-metadata/plugin-security.policy, +  permission java.lang.reflect.ReflectPermission "suppressAccessChecks";, +, +  permission org.elasticsearch.script.ClassPermission "groovy.lang.Closure";, +  permission org.elasticsearch.script.ClassPermission "org.codehaus.groovy.runtime.GeneratedClosure";, +  permission org.elasticsearch.script.ClassPermission "groovy.lang.MetaClass";, +  permission org.elasticsearch.script.ClassPermission "groovy.lang.Range";, +++ b/modules/lang-groovy/src/main/plugin-metadata/plugin-security.policy, +  permission java.lang.reflect.ReflectPermission "suppressAccessChecks";, +, +  permission org.elasticsearch.script.ClassPermission "groovy.lang.Closure";, +  permission org.elasticsearch.script.ClassPermission "org.codehaus.groovy.runtime.GeneratedClosure";, +  permission org.elasticsearch.script.ClassPermission "groovy.lang.MetaClass";, +  permission org.elasticsearch.script.ClassPermission "groovy.lang.Range";, +++ b/modules/lang-groovy/src/test/java/org/elasticsearch/script/groovy/GroovySecurityTests.java, +        // Groovy closures, +        assertSuccess("[1, 2, 3, 4].findAll { it % 2 == 0 }");, +        assertSuccess("def buckets=[ [2, 4, 6, 8], [10, 12, 16, 14], [18, 22, 20, 24] ]; buckets[-3..-1].every { it.every { i -> i % 2 == 0 } }");]
[+++ b/core/src/test/java/org/elasticsearch/common/lucene/LuceneTests.java, +    @AwaitsFix(bugUrl = "https://github.com/elastic/elasticsearch/issues/19151"), +            LeafReaderContext leafReaderContext = reader.leaves().get(0);, +++ b/core/src/test/java/org/elasticsearch/common/lucene/LuceneTests.java, +    @AwaitsFix(bugUrl = "https://github.com/elastic/elasticsearch/issues/19151"), +            LeafReaderContext leafReaderContext = reader.leaves().get(0);, +++ b/plugins/discovery-gce/src/main/java/org/elasticsearch/cloud/gce/GceComputeServiceImpl.java, +                return instanceList.isEmpty()  || instanceList.getItems() == null ? Collections.<Instance>emptyList() : instanceList.getItems();, +++ b/core/src/test/java/org/elasticsearch/common/lucene/LuceneTests.java, +    @AwaitsFix(bugUrl = "https://github.com/elastic/elasticsearch/issues/19151"), +            LeafReaderContext leafReaderContext = reader.leaves().get(0);, +++ b/plugins/discovery-gce/src/main/java/org/elasticsearch/cloud/gce/GceComputeServiceImpl.java, +                return instanceList.isEmpty()  || instanceList.getItems() == null ? Collections.<Instance>emptyList() : instanceList.getItems();, +++ b/plugins/discovery-gce/src/test/java/org/elasticsearch/discovery/gce/GceDiscoveryTests.java, +, +    /**, +     * For issue https://github.com/elastic/elasticsearch/issues/16967, +     */, +    public void testEmptyRegion16967() {, +        Settings nodeSettings = Settings.builder(), +            .put(GceComputeService.PROJECT_SETTING.getKey(), projectName), +            .putArray(GceComputeService.ZONE_SETTING.getKey(), "europe-west1-b", "us-central1-a"), +            .build();, +        mock = new GceComputeServiceMock(nodeSettings, networkService);, +        List<DiscoveryNode> discoveryNodes = buildDynamicNodes(mock, nodeSettings);, +        assertThat(discoveryNodes, hasSize(1));, +    }, +++ b/core/src/test/java/org/elasticsearch/common/lucene/LuceneTests.java, +    @AwaitsFix(bugUrl = "https://github.com/elastic/elasticsearch/issues/19151"), +            LeafReaderContext leafReaderContext = reader.leaves().get(0);, +++ b/plugins/discovery-gce/src/main/java/org/elasticsearch/cloud/gce/GceComputeServiceImpl.java, +                return instanceList.isEmpty()  || instanceList.getItems() == null ? Collections.<Instance>emptyList() : instanceList.getItems();, +++ b/plugins/discovery-gce/src/test/java/org/elasticsearch/discovery/gce/GceDiscoveryTests.java, +, +    /**, +     * For issue https://github.com/elastic/elasticsearch/issues/16967, +     */, +    public void testEmptyRegion16967() {, +        Settings nodeSettings = Settings.builder(), +            .put(GceComputeService.PROJECT_SETTING.getKey(), projectName), +            .putArray(GceComputeService.ZONE_SETTING.getKey(), "europe-west1-b", "us-central1-a"), +            .build();, +        mock = new GceComputeServiceMock(nodeSettings, networkService);, +        List<DiscoveryNode> discoveryNodes = buildDynamicNodes(mock, nodeSettings);, +        assertThat(discoveryNodes, hasSize(1));, +    }, +++ b/plugins/discovery-gce/src/test/resources/org/elasticsearch/discovery/gce/compute/v1/projects/emptyregion16967/zones/europe-west1-b/instances, +{, +  "id": "dummy",, +  "items":[, +    {, +      "description": "ES Node 1",, +      "id": "9309873766428965105",, +      "kind": "compute#instance",, +      "machineType": "n1-standard-1",, +      "name": "test1",, +      "networkInterfaces": [, +        {, +          "accessConfigs": [, +            {, +              "kind": "compute#accessConfig",, +              "name": "External NAT",, +              "natIP": "104.155.13.147",, +              "type": "ONE_TO_ONE_NAT", +            }, +          ],, +          "name": "nic0",, +          "network": "default",, +          "networkIP": "10.240.79.59", +        }, +      ],, +      "status": "RUNNING",, +      "tags": {, +        "fingerprint": "xA6QJb-rGtg=",, +        "items": [, +          "elasticsearch",, +          "dev", +        ], +      },, +      "zone": "europe-west1-b", +    }, +  ], +}, +++ b/core/src/test/java/org/elasticsearch/common/lucene/LuceneTests.java, +    @AwaitsFix(bugUrl = "https://github.com/elastic/elasticsearch/issues/19151"), +            LeafReaderContext leafReaderContext = reader.leaves().get(0);, +++ b/plugins/discovery-gce/src/main/java/org/elasticsearch/cloud/gce/GceComputeServiceImpl.java, +                return instanceList.isEmpty()  || instanceList.getItems() == null ? Collections.<Instance>emptyList() : instanceList.getItems();, +++ b/plugins/discovery-gce/src/test/java/org/elasticsearch/discovery/gce/GceDiscoveryTests.java, +, +    /**, +     * For issue https://github.com/elastic/elasticsearch/issues/16967, +     */, +    public void testEmptyRegion16967() {, +        Settings nodeSettings = Settings.builder(), +            .put(GceComputeService.PROJECT_SETTING.getKey(), projectName), +            .putArray(GceComputeService.ZONE_SETTING.getKey(), "europe-west1-b", "us-central1-a"), +            .build();, +        mock = new GceComputeServiceMock(nodeSettings, networkService);, +        List<DiscoveryNode> discoveryNodes = buildDynamicNodes(mock, nodeSettings);]
[+++ b/core/src/test/java/org/elasticsearch/indices/settings/UpdateSettingsIT.java, +import org.elasticsearch.cluster.service.ClusterService;, +    public void testUpdateAutoThrottleSettings() throws Exception {, +                                     .put(MergeSchedulerConfig.AUTO_THROTTLE_SETTING.getKey(), "true")));, +            // if a node has processed the cluster state update but not yet returned from the update task, it might still log messages;, +            // these log messages will race with the stopping of the appender so we wait to ensure these tasks are done processing, +            assertBusy(() -> {, +                for (final ClusterService service : internalCluster().getInstances(ClusterService.class)) {, +                    assertThat(service.numberOfPendingTasks(), equalTo(0));, +                }, +            });, +, +    public void testUpdateMergeMaxThreadCount() throws Exception {, +                                     .put(MergeSchedulerConfig.MAX_MERGE_COUNT_SETTING.getKey(), "10000")));, +            // if a node has processed the cluster state update but not yet returned from the update task, it might still log messages;, +            // these log messages will race with the stopping of the appender so we wait to ensure these tasks are done processing, +            assertBusy(() -> {, +                for (final ClusterService service : internalCluster().getInstances(ClusterService.class)) {, +                    assertThat(service.numberOfPendingTasks(), equalTo(0));, +                }, +            });, +]
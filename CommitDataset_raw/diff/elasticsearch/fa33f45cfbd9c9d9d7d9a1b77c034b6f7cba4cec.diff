[+++ /dev/null, +++ /dev/null, +++ b/plugin/src/test/java/org/elasticsearch/xpack/security/action/SecurityActionMapperTests.java, +        StringBuilder actionNameBuilder = new StringBuilder();, +            actionNameBuilder.append("indices:");, +            if (randomBoolean()) {, +                actionNameBuilder.append("data/");, +                actionNameBuilder.append(randomBoolean() ? "read" : "write");, +                actionNameBuilder.append("/");, +                actionNameBuilder.append(randomAlphaOfLengthBetween(2, 12));, +                actionNameBuilder.append(randomBoolean() ? "admin" : "monitor");, +                actionNameBuilder.append("/");, +                actionNameBuilder.append(randomAlphaOfLengthBetween(2, 12));, +        } else {, +            actionNameBuilder.append("cluster:");, +            actionNameBuilder.append(randomBoolean() ? "admin" : "monitor");, +            actionNameBuilder.append("/");, +            actionNameBuilder.append(randomAlphaOfLengthBetween(2, 12));, +        }, +        String randomAction = actionNameBuilder.toString();, +        assumeFalse("Random action is one of the known mapped values: " + randomAction, randomAction.equals(ClearScrollAction.NAME) ||, +++ /dev/null, +++ b/plugin/src/test/java/org/elasticsearch/xpack/security/action/SecurityActionMapperTests.java, +        StringBuilder actionNameBuilder = new StringBuilder();, +            actionNameBuilder.append("indices:");, +            if (randomBoolean()) {, +                actionNameBuilder.append("data/");, +                actionNameBuilder.append(randomBoolean() ? "read" : "write");, +                actionNameBuilder.append("/");, +                actionNameBuilder.append(randomAlphaOfLengthBetween(2, 12));, +                actionNameBuilder.append(randomBoolean() ? "admin" : "monitor");, +                actionNameBuilder.append("/");, +                actionNameBuilder.append(randomAlphaOfLengthBetween(2, 12));, +        } else {, +            actionNameBuilder.append("cluster:");, +            actionNameBuilder.append(randomBoolean() ? "admin" : "monitor");, +            actionNameBuilder.append("/");, +            actionNameBuilder.append(randomAlphaOfLengthBetween(2, 12));, +        }, +        String randomAction = actionNameBuilder.toString();, +        assumeFalse("Random action is one of the known mapped values: " + randomAction, randomAction.equals(ClearScrollAction.NAME) ||, +++ /dev/null, +++ /dev/null, +++ b/plugin/src/test/java/org/elasticsearch/xpack/security/action/SecurityActionMapperTests.java, +        StringBuilder actionNameBuilder = new StringBuilder();, +            actionNameBuilder.append("indices:");, +            if (randomBoolean()) {, +                actionNameBuilder.append("data/");, +                actionNameBuilder.append(randomBoolean() ? "read" : "write");, +                actionNameBuilder.append("/");, +                actionNameBuilder.append(randomAlphaOfLengthBetween(2, 12));, +                actionNameBuilder.append(randomBoolean() ? "admin" : "monitor");, +                actionNameBuilder.append("/");, +                actionNameBuilder.append(randomAlphaOfLengthBetween(2, 12));, +        } else {, +            actionNameBuilder.append("cluster:");, +            actionNameBuilder.append(randomBoolean() ? "admin" : "monitor");, +            actionNameBuilder.append("/");, +            actionNameBuilder.append(randomAlphaOfLengthBetween(2, 12));, +        }, +        String randomAction = actionNameBuilder.toString();, +        assumeFalse("Random action is one of the known mapped values: " + randomAction, randomAction.equals(ClearScrollAction.NAME) ||, +++ /dev/null, +++ /dev/null]
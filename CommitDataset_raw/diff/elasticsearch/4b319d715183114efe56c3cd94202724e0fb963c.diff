[+++ b/x-pack/plugin/security/src/main/java/org/elasticsearch/xpack/security/authc/saml/SamlAuthenticator.java, +        final boolean requireSignedAssertions;, +        if (response.isSigned()) {, +            validateSignature(response.getSignature());, +            requireSignedAssertions = false;, +        } else {, +            requireSignedAssertions = true;, +        }, +, +        checkIssuer(response.getIssuer(), response);, +        Tuple<Assertion, List<Attribute>> details = extractDetails(response, allowedSamlRequestIds, requireSignedAssertions);, +    private Tuple<Assertion, List<Attribute>> extractDetails(Response response, Collection<String> allowedSamlRequestIds,, +                                                             boolean requireSignedAssertions) {]
[+++ b/core/src/test/java/org/elasticsearch/common/lucene/LuceneTests.java, +import org.apache.lucene.store.MMapDirectory;, +, +    /**, +     * Test that the "unmap hack" is detected as supported by lucene., +     * This works around the following bug: https://bugs.openjdk.java.net/browse/JDK-4724038, +     * <p>, +     * While not guaranteed, current status is "Critical Internal API": http://openjdk.java.net/jeps/260, +     * Additionally this checks we did not screw up the security logic around the hack., +     */, +    public void testMMapHackSupported() throws Exception {, +        // add assume's here if needed for certain platforms, but we should know if it does not work., +        assertTrue(MMapDirectory.UNMAP_SUPPORTED);, +    }]
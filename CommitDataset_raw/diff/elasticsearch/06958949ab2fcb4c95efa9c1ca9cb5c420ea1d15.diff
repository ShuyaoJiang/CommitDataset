[+++ b/x-pack/plugin/src/main/java/org/elasticsearch/xpack/indexlifecycle/IndexLifecycleInitialisationService.java, +import java.util.function.LongSupplier;, +    private LongSupplier nowSupplier;, +        this.nowSupplier = () -> System.currentTimeMillis();, +++ b/x-pack/plugin/src/main/java/org/elasticsearch/xpack/indexlifecycle/IndexLifecycleInitialisationService.java, +import java.util.function.LongSupplier;, +    private LongSupplier nowSupplier;, +        this.nowSupplier = () -> System.currentTimeMillis();, +++ b/x-pack/plugin/src/main/java/org/elasticsearch/xpack/indexlifecycle/LifecyclePolicy.java, +import java.util.function.LongSupplier;, +    public void execute(IndexMetaData idxMeta, Client client, LongSupplier nowSupplier) {, +++ b/x-pack/plugin/src/main/java/org/elasticsearch/xpack/indexlifecycle/IndexLifecycleInitialisationService.java, +import java.util.function.LongSupplier;, +    private LongSupplier nowSupplier;, +        this.nowSupplier = () -> System.currentTimeMillis();, +++ b/x-pack/plugin/src/main/java/org/elasticsearch/xpack/indexlifecycle/LifecyclePolicy.java, +import java.util.function.LongSupplier;, +    public void execute(IndexMetaData idxMeta, Client client, LongSupplier nowSupplier) {, +++ b/x-pack/plugin/src/main/java/org/elasticsearch/xpack/indexlifecycle/Phase.java, +import java.util.function.LongSupplier;, +    protected boolean canExecute(IndexMetaData idxMeta, LongSupplier nowSupplier) {, +        long now = nowSupplier.getAsLong();]
[+++ b/distribution/src/main/resources/bin/elasticsearch-plugin, +eval "\"$JAVA\"" "$ES_JAVA_OPTS" -client -Delasticsearch -Des.path.home="\"$ES_HOME\"" $properties -cp "\"$ES_HOME/lib/*\"" org.elasticsearch.plugins.PluginCli $args, +++ b/distribution/src/main/resources/bin/elasticsearch-plugin, +eval "\"$JAVA\"" "$ES_JAVA_OPTS" -client -Delasticsearch -Des.path.home="\"$ES_HOME\"" $properties -cp "\"$ES_HOME/lib/*\"" org.elasticsearch.plugins.PluginCli $args, +++ b/distribution/src/main/resources/bin/elasticsearch-plugin.bat, +"%JAVA_HOME%\bin\java" %ES_JAVA_OPTS% -client -Des.path.home="%ES_HOME%" !properties! -cp "%ES_HOME%/lib/*;" "org.elasticsearch.plugins.PluginCli" !args!, +++ b/distribution/src/main/resources/bin/elasticsearch-plugin, +eval "\"$JAVA\"" "$ES_JAVA_OPTS" -client -Delasticsearch -Des.path.home="\"$ES_HOME\"" $properties -cp "\"$ES_HOME/lib/*\"" org.elasticsearch.plugins.PluginCli $args, +++ b/distribution/src/main/resources/bin/elasticsearch-plugin.bat, +"%JAVA_HOME%\bin\java" %ES_JAVA_OPTS% -client -Des.path.home="%ES_HOME%" !properties! -cp "%ES_HOME%/lib/*;" "org.elasticsearch.plugins.PluginCli" !args!, +++ b/qa/vagrant/src/test/resources/packaging/scripts/module_and_plugin_test_cases.bash, +, +@test "[$GROUP] test ES_JAVA_OPTS" {, +    # preserve ES_JAVA_OPTS, +    local es_java_opts=$ES_JAVA_OPTS, +, +    export ES_JAVA_OPTS="-XX:+PrintFlagsFinal", +    # this will fail if ES_JAVA_OPTS is not passed through, +    "$ESHOME/bin/elasticsearch-plugin" list | grep MaxHeapSize, +, +    # restore ES_JAVA_OPTS, +    export ES_JAVA_OPTS=$es_java_opts, +}]
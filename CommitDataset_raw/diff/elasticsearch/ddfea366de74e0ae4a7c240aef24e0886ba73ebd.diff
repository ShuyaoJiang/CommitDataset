[+++ b/dev-tools/src/main/resources/ant/integration-tests.xml, +      <!-- print some basic package info -->, +         <arg value="-I"/>, +      <!-- extract contents from .deb package -->, +  <!-- distribution tests: .rpm -->, +  <target name="setup-workspace-rpm" depends="stop-external-cluster" unless="${shouldskip}">, +    <sequential>, +      <delete dir="${integ.scratch}"/>, +      <!-- use full paths with paranoia, we will be doing relocations -->, +      <local name="rpm.file"/>, +      <local name="rpm.database"/>, +      <local name="rpm.extracted"/>, +      <property name="rpm.file" location="${project.build.directory}/releases/elasticsearch-${project.version}.rpm"/>, +      <property name="rpm.database" location="${integ.scratch}/rpm-database"/>, +      <property name="rpm.extracted" location="${integ.scratch}/rpm-extracted"/>, +      <mkdir dir="${rpm.database}"/>, +      <mkdir dir="${rpm.extracted}"/>, +      <!-- print some basic package info -->, +      <exec executable="rpm" failonerror="true" taskname="rpm-info">, +         <arg value="-q"/>, +         <arg value="-i"/>, +         <arg value="-p"/>, +         <arg value="${rpm.file}"/> , +      </exec>, +      <!-- extract contents from .rpm package -->, +      <exec executable="rpm" failonerror="true" taskname="rpm">, +         <arg value="--dbpath"/>, +         <arg value="${rpm.database}"/>, +         <arg value="--badreloc"/>, +         <arg value="--relocate"/>, +         <arg value="/=${rpm.extracted}"/>, +         <arg value="--nodeps"/> , +         <arg value="--noscripts"/> , +         <arg value="--notriggers"/> , +         <arg value="-i"/>, +         <arg value="${rpm.file}"/> , +      </exec>, +    </sequential>, +  </target>, +, +  <target name="start-external-cluster-rpm" depends="setup-workspace-rpm" unless="${shouldskip}">, +    <startup-elasticsearch home="${integ.scratch}/rpm-extracted/usr/share/elasticsearch/"/>, +  </target>, +, +++ b/dev-tools/src/main/resources/ant/integration-tests.xml, +      <!-- print some basic package info -->, +         <arg value="-I"/>, +      <!-- extract contents from .deb package -->, +  <!-- distribution tests: .rpm -->, +  <target name="setup-workspace-rpm" depends="stop-external-cluster" unless="${shouldskip}">, +    <sequential>, +      <delete dir="${integ.scratch}"/>, +      <!-- use full paths with paranoia, we will be doing relocations -->, +      <local name="rpm.file"/>, +      <local name="rpm.database"/>, +      <local name="rpm.extracted"/>, +      <property name="rpm.file" location="${project.build.directory}/releases/elasticsearch-${project.version}.rpm"/>, +      <property name="rpm.database" location="${integ.scratch}/rpm-database"/>, +      <property name="rpm.extracted" location="${integ.scratch}/rpm-extracted"/>, +      <mkdir dir="${rpm.database}"/>, +      <mkdir dir="${rpm.extracted}"/>, +      <!-- print some basic package info -->, +      <exec executable="rpm" failonerror="true" taskname="rpm-info">, +         <arg value="-q"/>, +         <arg value="-i"/>, +         <arg value="-p"/>, +         <arg value="${rpm.file}"/> , +      </exec>, +      <!-- extract contents from .rpm package -->, +      <exec executable="rpm" failonerror="true" taskname="rpm">, +         <arg value="--dbpath"/>, +         <arg value="${rpm.database}"/>, +         <arg value="--badreloc"/>, +         <arg value="--relocate"/>, +         <arg value="/=${rpm.extracted}"/>, +         <arg value="--nodeps"/> , +         <arg value="--noscripts"/> , +         <arg value="--notriggers"/> , +         <arg value="-i"/>, +         <arg value="${rpm.file}"/> , +      </exec>, +    </sequential>, +  </target>, +, +  <target name="start-external-cluster-rpm" depends="setup-workspace-rpm" unless="${shouldskip}">, +    <startup-elasticsearch home="${integ.scratch}/rpm-extracted/usr/share/elasticsearch/"/>, +  </target>, +, +++ b/distribution/rpm/pom.xml, +                    <!-- start up external cluster -->, +                    <execution>, +                        <id>integ-setup</id>, +                        <phase>pre-integration-test</phase>, +                        <goals>, +                            <goal>run</goal>, +                        </goals>, +                        <configuration>, +                            <skip>${skip.integ.tests}</skip>, +                            <target>, +                                <ant antfile="${elasticsearch.integ.antfile}" target="start-external-cluster-rpm"/>]
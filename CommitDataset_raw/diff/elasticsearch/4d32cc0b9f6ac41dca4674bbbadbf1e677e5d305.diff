[+++ b/core/src/main/java/org/elasticsearch/Version.java, +++ b/core/src/main/java/org/elasticsearch/Version.java, +++ b/core/src/main/java/org/elasticsearch/cluster/ClusterModule.java, +        registerIndexDynamicSetting(IndexShard.INDEX_TRANSLOG_FLUSH_THRESHOLD_OPS, Validator.INTEGER);, +        registerIndexDynamicSetting(IndexShard.INDEX_TRANSLOG_DISABLE_FLUSH, Validator.EMPTY);, +++ b/core/src/main/java/org/elasticsearch/Version.java, +++ b/core/src/main/java/org/elasticsearch/cluster/ClusterModule.java, +        registerIndexDynamicSetting(IndexShard.INDEX_TRANSLOG_FLUSH_THRESHOLD_OPS, Validator.INTEGER);, +        registerIndexDynamicSetting(IndexShard.INDEX_TRANSLOG_DISABLE_FLUSH, Validator.EMPTY);, +++ b/core/src/main/java/org/elasticsearch/common/lucene/search/Queries.java, +        return result < 0 ? 0 : result;, +++ b/core/src/main/java/org/elasticsearch/Version.java, +++ b/core/src/main/java/org/elasticsearch/cluster/ClusterModule.java, +        registerIndexDynamicSetting(IndexShard.INDEX_TRANSLOG_FLUSH_THRESHOLD_OPS, Validator.INTEGER);, +        registerIndexDynamicSetting(IndexShard.INDEX_TRANSLOG_DISABLE_FLUSH, Validator.EMPTY);, +++ b/core/src/main/java/org/elasticsearch/common/lucene/search/Queries.java, +        return result < 0 ? 0 : result;, +++ b/core/src/main/java/org/elasticsearch/index/engine/InternalEngine.java, +            if (config().getMergeSchedulerConfig().isNotifyOnMergeFailure()) {, +    }, +++ b/core/src/main/java/org/elasticsearch/Version.java, +++ b/core/src/main/java/org/elasticsearch/cluster/ClusterModule.java, +        registerIndexDynamicSetting(IndexShard.INDEX_TRANSLOG_FLUSH_THRESHOLD_OPS, Validator.INTEGER);, +        registerIndexDynamicSetting(IndexShard.INDEX_TRANSLOG_DISABLE_FLUSH, Validator.EMPTY);, +++ b/core/src/main/java/org/elasticsearch/common/lucene/search/Queries.java, +        return result < 0 ? 0 : result;, +++ b/core/src/main/java/org/elasticsearch/index/engine/InternalEngine.java, +            if (config().getMergeSchedulerConfig().isNotifyOnMergeFailure()) {, +    }, +++ b/core/src/main/java/org/elasticsearch/index/mapper/DocumentMapperParser.java, +    public DocumentMapper parse(String source) throws MapperParsingException {, +        return parse(null, source);, +    }, +, +    public DocumentMapper parse(@Nullable String type, String source) throws MapperParsingException {, +    public DocumentMapper parse(@Nullable String type, String source, String defaultSource) throws MapperParsingException {, +        Map<String, Object> mapping = null;, +        if (source != null) {, +            Tuple<String, Map<String, Object>> t = extractMapping(type, source);, +            type = t.v1();, +            mapping = t.v2();, +        }, +        if (mapping == null) {, +            mapping = new HashMap<>();, +        }, +        return parse(type, mapping, defaultSource);, +    }, +, +    public DocumentMapper parseCompressed(@Nullable String type, CompressedXContent source) throws MapperParsingException {, +        return parseCompressed(type, source, null);, +    }, +, +    public DocumentMapper parseCompressed(@Nullable String type, CompressedXContent source, String defaultSource) throws MapperParsingException {, +++ b/core/src/main/java/org/elasticsearch/Version.java, +++ b/core/src/main/java/org/elasticsearch/cluster/ClusterModule.java, +        registerIndexDynamicSetting(IndexShard.INDEX_TRANSLOG_FLUSH_THRESHOLD_OPS, Validator.INTEGER);, +        registerIndexDynamicSetting(IndexShard.INDEX_TRANSLOG_DISABLE_FLUSH, Validator.EMPTY);, +++ b/core/src/main/java/org/elasticsearch/common/lucene/search/Queries.java, +        return result < 0 ? 0 : result;, +++ b/core/src/main/java/org/elasticsearch/index/engine/InternalEngine.java, +            if (config().getMergeSchedulerConfig().isNotifyOnMergeFailure()) {, +    }, +++ b/core/src/main/java/org/elasticsearch/index/mapper/DocumentMapperParser.java, +    public DocumentMapper parse(String source) throws MapperParsingException {, +        return parse(null, source);, +    }, +, +    public DocumentMapper parse(@Nullable String type, String source) throws MapperParsingException {, +    public DocumentMapper parse(@Nullable String type, String source, String defaultSource) throws MapperParsingException {, +        Map<String, Object> mapping = null;, +        if (source != null) {, +            Tuple<String, Map<String, Object>> t = extractMapping(type, source);, +            type = t.v1();, +            mapping = t.v2();, +        }, +        if (mapping == null) {, +            mapping = new HashMap<>();, +        }, +        return parse(type, mapping, defaultSource);, +    }, +, +    public DocumentMapper parseCompressed(@Nullable String type, CompressedXContent source) throws MapperParsingException {, +        return parseCompressed(type, source, null);, +    }, +, +    public DocumentMapper parseCompressed(@Nullable String type, CompressedXContent source, String defaultSource) throws MapperParsingException {, +++ b/core/src/main/java/org/elasticsearch/index/mapper/MapperService.java, +            DocumentMapper mapper = documentParser.parseCompressed(type, mappingSource);, +        return documentParser.parseCompressed(mappingType, mappingSource, applyDefault ? defaultMappingSource : null);, +++ b/core/src/main/java/org/elasticsearch/Version.java, +++ b/core/src/main/java/org/elasticsearch/cluster/ClusterModule.java, +        registerIndexDynamicSetting(IndexShard.INDEX_TRANSLOG_FLUSH_THRESHOLD_OPS, Validator.INTEGER);, +        registerIndexDynamicSetting(IndexShard.INDEX_TRANSLOG_DISABLE_FLUSH, Validator.EMPTY);, +++ b/core/src/main/java/org/elasticsearch/common/lucene/search/Queries.java, +        return result < 0 ? 0 : result;, +++ b/core/src/main/java/org/elasticsearch/index/engine/InternalEngine.java, +            if (config().getMergeSchedulerConfig().isNotifyOnMergeFailure()) {, +    }, +++ b/core/src/main/java/org/elasticsearch/index/mapper/DocumentMapperParser.java, +    public DocumentMapper parse(String source) throws MapperParsingException {]
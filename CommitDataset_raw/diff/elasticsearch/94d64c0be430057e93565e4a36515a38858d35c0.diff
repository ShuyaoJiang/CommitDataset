[+++ b/src/main/java/org/elasticsearch/index/query/HasChildFilterParser.java, +                    // TODO we need to set the type, but, `query` can come before `type`..., +++ b/src/main/java/org/elasticsearch/index/query/HasChildFilterParser.java, +                    // TODO we need to set the type, but, `query` can come before `type`..., +++ b/src/main/java/org/elasticsearch/index/query/HasChildQueryParser.java, +                    // TODO we need to set the type, but, `query` can come before `type`... (see HasChildFilterParser), +++ b/src/main/java/org/elasticsearch/index/query/HasChildFilterParser.java, +                    // TODO we need to set the type, but, `query` can come before `type`..., +++ b/src/main/java/org/elasticsearch/index/query/HasChildQueryParser.java, +                    // TODO we need to set the type, but, `query` can come before `type`... (see HasChildFilterParser), +++ b/src/main/java/org/elasticsearch/index/query/TopChildrenQueryParser.java, +                    // TODO we need to set the type, but, `query` can come before `type`... (see HasChildFilterParser), +                    // since we switch types, make sure we change the context, +                    String[] origTypes = QueryParseContext.setTypesWithPrevious(childType == null ? null : new String[]{childType});, +                    try {, +                    } finally {, +                        QueryParseContext.setTypes(origTypes);, +                    }]
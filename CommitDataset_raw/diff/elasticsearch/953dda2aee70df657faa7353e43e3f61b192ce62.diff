[+++ b/src/main/java/org/elasticsearch/common/lucene/docset/DocIdSets.java, +        if (set == null || set == DocIdSet.EMPTY_DOCIDSET) {, +++ b/src/main/java/org/elasticsearch/common/lucene/docset/DocIdSets.java, +        if (set == null || set == DocIdSet.EMPTY_DOCIDSET) {, +++ b/src/main/java/org/elasticsearch/common/lucene/search/TermFilter.java, +import org.apache.lucene.search.DocIdSetIterator;, +    public DocIdSet getDocIdSet(AtomicReaderContext context, final Bits acceptDocs) throws IOException {, +        final TermsEnum termsEnum = terms.iterator(null);, +        return new DocIdSet() {, +            @Override, +            public DocIdSetIterator iterator() throws IOException {, +                return termsEnum.docs(acceptDocs, null, DocsEnum.FLAG_NONE);, +        };]
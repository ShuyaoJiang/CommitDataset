[+++ b/core/src/main/java/org/elasticsearch/common/hash/MessageDigests.java, +        return clone(MD5_DIGEST);, +        return clone(SHA_1_DIGEST);, +        return clone(SHA_256_DIGEST);, +    private static MessageDigest clone(MessageDigest messageDigest) {, +            return (MessageDigest) messageDigest.clone();, +++ b/core/src/main/java/org/elasticsearch/common/hash/MessageDigests.java, +        return clone(MD5_DIGEST);, +        return clone(SHA_1_DIGEST);, +        return clone(SHA_256_DIGEST);, +    private static MessageDigest clone(MessageDigest messageDigest) {, +            return (MessageDigest) messageDigest.clone();, +++ b/core/src/test/java/org/elasticsearch/common/hash/MessageDigestsTests.java, +            String zeros = new String(new char[2 * bytes.length]).replace("\0", "0");, +++ b/core/src/main/java/org/elasticsearch/common/hash/MessageDigests.java, +        return clone(MD5_DIGEST);, +        return clone(SHA_1_DIGEST);, +        return clone(SHA_256_DIGEST);, +    private static MessageDigest clone(MessageDigest messageDigest) {, +            return (MessageDigest) messageDigest.clone();, +++ b/core/src/test/java/org/elasticsearch/common/hash/MessageDigestsTests.java, +            String zeros = new String(new char[2 * bytes.length]).replace("\0", "0");, +++ b/qa/vagrant/src/test/resources/packaging/scripts/20_tar_package.bats, +, +, +, +, +++ b/core/src/main/java/org/elasticsearch/common/hash/MessageDigests.java, +        return clone(MD5_DIGEST);, +        return clone(SHA_1_DIGEST);, +        return clone(SHA_256_DIGEST);, +    private static MessageDigest clone(MessageDigest messageDigest) {, +            return (MessageDigest) messageDigest.clone();, +++ b/core/src/test/java/org/elasticsearch/common/hash/MessageDigestsTests.java, +            String zeros = new String(new char[2 * bytes.length]).replace("\0", "0");, +++ b/qa/vagrant/src/test/resources/packaging/scripts/20_tar_package.bats, +, +, +, +, +++ b/qa/vagrant/src/test/resources/packaging/scripts/30_deb_package.bats, +++ b/core/src/main/java/org/elasticsearch/common/hash/MessageDigests.java, +        return clone(MD5_DIGEST);, +        return clone(SHA_1_DIGEST);, +        return clone(SHA_256_DIGEST);, +    private static MessageDigest clone(MessageDigest messageDigest) {, +            return (MessageDigest) messageDigest.clone();, +++ b/core/src/test/java/org/elasticsearch/common/hash/MessageDigestsTests.java, +            String zeros = new String(new char[2 * bytes.length]).replace("\0", "0");, +++ b/qa/vagrant/src/test/resources/packaging/scripts/20_tar_package.bats, +, +, +, +, +++ b/qa/vagrant/src/test/resources/packaging/scripts/30_deb_package.bats, +++ b/qa/vagrant/src/test/resources/packaging/scripts/40_rpm_package.bats, +++ b/core/src/main/java/org/elasticsearch/common/hash/MessageDigests.java, +        return clone(MD5_DIGEST);, +        return clone(SHA_1_DIGEST);, +        return clone(SHA_256_DIGEST);, +    private static MessageDigest clone(MessageDigest messageDigest) {, +            return (MessageDigest) messageDigest.clone();, +++ b/core/src/test/java/org/elasticsearch/common/hash/MessageDigestsTests.java, +            String zeros = new String(new char[2 * bytes.length]).replace("\0", "0");, +++ b/qa/vagrant/src/test/resources/packaging/scripts/20_tar_package.bats, +, +, +, +, +++ b/qa/vagrant/src/test/resources/packaging/scripts/30_deb_package.bats, +++ b/qa/vagrant/src/test/resources/packaging/scripts/40_rpm_package.bats, +++ b/qa/vagrant/src/test/resources/packaging/scripts/60_systemd.bats, +++ b/core/src/main/java/org/elasticsearch/common/hash/MessageDigests.java, +        return clone(MD5_DIGEST);, +        return clone(SHA_1_DIGEST);, +        return clone(SHA_256_DIGEST);, +    private static MessageDigest clone(MessageDigest messageDigest) {, +            return (MessageDigest) messageDigest.clone();, +++ b/core/src/test/java/org/elasticsearch/common/hash/MessageDigestsTests.java, +            String zeros = new String(new char[2 * bytes.length]).replace("\0", "0");, +++ b/qa/vagrant/src/test/resources/packaging/scripts/20_tar_package.bats, +, +, +, +, +++ b/qa/vagrant/src/test/resources/packaging/scripts/30_deb_package.bats, +++ b/qa/vagrant/src/test/resources/packaging/scripts/40_rpm_package.bats, +++ b/qa/vagrant/src/test/resources/packaging/scripts/60_systemd.bats, +++ b/qa/vagrant/src/test/resources/packaging/scripts/70_sysv_initd.bats]
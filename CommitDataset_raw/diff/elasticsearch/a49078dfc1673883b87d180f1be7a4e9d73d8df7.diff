[+++ b/src/main/java/org/elasticsearch/common/compress/CompressedString.java, +import org.apache.lucene.util.BytesRef;, +        BytesRef result = Unicode.unsafeFromStringAsUtf8(str);, +        this.bytes = CompressorFactory.defaultCompressor().compress(result.bytes, result.offset, result.length);, +++ b/src/main/java/org/elasticsearch/common/compress/CompressedString.java, +import org.apache.lucene.util.BytesRef;, +        BytesRef result = Unicode.unsafeFromStringAsUtf8(str);, +        this.bytes = CompressorFactory.defaultCompressor().compress(result.bytes, result.offset, result.length);, +++ b/src/main/java/org/elasticsearch/http/netty/NettyHttpChannel.java, +                    buf = ChannelBuffers.wrappedBuffer(response.content(), response.contentOffset(), response.contentLength());, +                    buf = ChannelBuffers.copiedBuffer(response.content(), response.contentOffset(), response.contentLength());, +                    buf = ChannelBuffers.wrappedBuffer(response.content(), response.contentOffset(), response.contentLength());, +                    buf = ChannelBuffers.copiedBuffer(response.content(), response.contentOffset(), response.contentLength());, +                prefixBuf = ChannelBuffers.copiedBuffer(response.prefixContent(), response.prefixContentOffset(), response.prefixContentLength());, +                suffixBuf = ChannelBuffers.copiedBuffer(response.suffixContent(), response.suffixContentOffset(), response.suffixContentLength());, +++ b/src/main/java/org/elasticsearch/common/compress/CompressedString.java, +import org.apache.lucene.util.BytesRef;, +        BytesRef result = Unicode.unsafeFromStringAsUtf8(str);, +        this.bytes = CompressorFactory.defaultCompressor().compress(result.bytes, result.offset, result.length);, +++ b/src/main/java/org/elasticsearch/http/netty/NettyHttpChannel.java, +                    buf = ChannelBuffers.wrappedBuffer(response.content(), response.contentOffset(), response.contentLength());, +                    buf = ChannelBuffers.copiedBuffer(response.content(), response.contentOffset(), response.contentLength());, +                    buf = ChannelBuffers.wrappedBuffer(response.content(), response.contentOffset(), response.contentLength());, +                    buf = ChannelBuffers.copiedBuffer(response.content(), response.contentOffset(), response.contentLength());, +                prefixBuf = ChannelBuffers.copiedBuffer(response.prefixContent(), response.prefixContentOffset(), response.prefixContentLength());, +                suffixBuf = ChannelBuffers.copiedBuffer(response.suffixContent(), response.suffixContentOffset(), response.suffixContentLength());, +++ b/src/main/java/org/elasticsearch/rest/AbstractRestResponse.java, +    public int prefixContentOffset() {, +        return 0;, +    }, +, +    @Override, +, +    @Override, +    public int suffixContentOffset() {, +        return 0;, +    }, +++ b/src/main/java/org/elasticsearch/common/compress/CompressedString.java, +import org.apache.lucene.util.BytesRef;, +        BytesRef result = Unicode.unsafeFromStringAsUtf8(str);, +        this.bytes = CompressorFactory.defaultCompressor().compress(result.bytes, result.offset, result.length);, +++ b/src/main/java/org/elasticsearch/http/netty/NettyHttpChannel.java, +                    buf = ChannelBuffers.wrappedBuffer(response.content(), response.contentOffset(), response.contentLength());, +                    buf = ChannelBuffers.copiedBuffer(response.content(), response.contentOffset(), response.contentLength());, +                    buf = ChannelBuffers.wrappedBuffer(response.content(), response.contentOffset(), response.contentLength());, +                    buf = ChannelBuffers.copiedBuffer(response.content(), response.contentOffset(), response.contentLength());, +                prefixBuf = ChannelBuffers.copiedBuffer(response.prefixContent(), response.prefixContentOffset(), response.prefixContentLength());, +                suffixBuf = ChannelBuffers.copiedBuffer(response.suffixContent(), response.suffixContentOffset(), response.suffixContentLength());, +++ b/src/main/java/org/elasticsearch/rest/AbstractRestResponse.java, +    public int prefixContentOffset() {, +        return 0;, +    }, +, +    @Override, +, +    @Override, +    public int suffixContentOffset() {, +        return 0;, +    }, +++ b/src/main/java/org/elasticsearch/rest/BytesRestResponse.java, +    public int contentOffset() throws IOException {, +        return 0;, +    }, +, +    @Override, +++ b/src/main/java/org/elasticsearch/common/compress/CompressedString.java, +import org.apache.lucene.util.BytesRef;, +        BytesRef result = Unicode.unsafeFromStringAsUtf8(str);, +        this.bytes = CompressorFactory.defaultCompressor().compress(result.bytes, result.offset, result.length);, +++ b/src/main/java/org/elasticsearch/http/netty/NettyHttpChannel.java, +                    buf = ChannelBuffers.wrappedBuffer(response.content(), response.contentOffset(), response.contentLength());, +                    buf = ChannelBuffers.copiedBuffer(response.content(), response.contentOffset(), response.contentLength());, +                    buf = ChannelBuffers.wrappedBuffer(response.content(), response.contentOffset(), response.contentLength());, +                    buf = ChannelBuffers.copiedBuffer(response.content(), response.contentOffset(), response.contentLength());, +                prefixBuf = ChannelBuffers.copiedBuffer(response.prefixContent(), response.prefixContentOffset(), response.prefixContentLength());, +                suffixBuf = ChannelBuffers.copiedBuffer(response.suffixContent(), response.suffixContentOffset(), response.suffixContentLength());, +++ b/src/main/java/org/elasticsearch/rest/AbstractRestResponse.java, +    public int prefixContentOffset() {, +        return 0;, +    }, +, +    @Override, +, +    @Override, +    public int suffixContentOffset() {, +        return 0;, +    }, +++ b/src/main/java/org/elasticsearch/rest/BytesRestResponse.java, +    public int contentOffset() throws IOException {, +        return 0;, +    }, +, +    @Override, +++ b/src/main/java/org/elasticsearch/rest/RestResponse.java, +    int contentOffset() throws IOException;, +, +    int prefixContentOffset();, +, +    int suffixContentOffset();, +]
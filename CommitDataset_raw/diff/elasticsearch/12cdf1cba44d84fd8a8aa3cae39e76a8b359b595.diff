[+++ b/docs/reference/ml/aggregations.asciidoc, +{dfeeds-cap} not only supports multi-bucket aggregations, but also single bucket aggregations., +The following shows two `filter` aggregations, each gathering the number of unique entries for, +the `error` field., +, +[source,js], +----------------------------------, +{, +  "job_id":"servers-unique-errors",, +  "indices": ["logs-*"],, +  "aggregations": {, +    "buckets": {, +      "date_histogram": {, +        "field": "time",, +        "interval": "360s",, +        "time_zone": "UTC", +      },, +      "aggregations": {, +        "time": {, +          "max": {"field": "time"}, +        }, +        "server1": {, +          "filter": {"term": {"source": "server-name-1"}},, +          "aggregations": {, +            "server1_error_count": {, +              "value_count": {, +                "field": "error", +              }, +            }, +          }, +        },, +        "server2": {, +          "filter": {"term": {"source": "server-name-2"}},, +          "aggregations": {, +            "server2_error_count": {, +              "value_count": {, +                "field": "error", +              }, +            }, +          }, +        }, +      }, +    }, +  }, +}, +----------------------------------, +// NOTCONSOLE, +, +++ b/docs/reference/ml/aggregations.asciidoc, +{dfeeds-cap} not only supports multi-bucket aggregations, but also single bucket aggregations., +The following shows two `filter` aggregations, each gathering the number of unique entries for, +the `error` field., +, +[source,js], +----------------------------------, +{, +  "job_id":"servers-unique-errors",, +  "indices": ["logs-*"],, +  "aggregations": {, +    "buckets": {, +      "date_histogram": {, +        "field": "time",, +        "interval": "360s",, +        "time_zone": "UTC", +      },, +      "aggregations": {, +        "time": {, +          "max": {"field": "time"}, +        }, +        "server1": {, +          "filter": {"term": {"source": "server-name-1"}},, +          "aggregations": {, +            "server1_error_count": {, +              "value_count": {, +                "field": "error", +              }, +            }, +          }, +        },, +        "server2": {, +          "filter": {"term": {"source": "server-name-2"}},, +          "aggregations": {, +            "server2_error_count": {, +              "value_count": {, +                "field": "error", +              }, +            }, +          }, +        }, +      }, +    }, +  }, +}, +----------------------------------, +// NOTCONSOLE, +, +++ b/x-pack/plugin/ml/qa/native-multi-node-tests/src/test/java/org/elasticsearch/xpack/ml/integration/DatafeedJobsRestIT.java, +    public void testLookbackWithSingleBucketAgg() throws Exception {, +        String jobId = "aggs-date-histogram-with-single-bucket-agg-job";, +        Request createJobRequest = new Request("PUT", MachineLearning.BASE_PATH + "anomaly_detectors/" + jobId);]
[+++ b/core/src/main/java/org/elasticsearch/action/support/single/instance/TransportInstanceSingleOperationAction.java, +                    listener.onFailure(new NodeClosedException(nodes.getLocalNode()));, +++ b/core/src/main/java/org/elasticsearch/action/support/single/instance/TransportInstanceSingleOperationAction.java, +                    listener.onFailure(new NodeClosedException(nodes.getLocalNode()));, +++ b/core/src/main/java/org/elasticsearch/client/transport/TransportClientNodesService.java, +                            entry.getValue().getState().nodes().getLocalNode(), clusterName);, +++ b/core/src/main/java/org/elasticsearch/action/support/single/instance/TransportInstanceSingleOperationAction.java, +                    listener.onFailure(new NodeClosedException(nodes.getLocalNode()));, +++ b/core/src/main/java/org/elasticsearch/client/transport/TransportClientNodesService.java, +                            entry.getValue().getState().nodes().getLocalNode(), clusterName);, +++ b/core/src/main/java/org/elasticsearch/cluster/ClusterState.java, +        return readFrom(in, nodes.getLocalNode());, +++ b/core/src/main/java/org/elasticsearch/action/support/single/instance/TransportInstanceSingleOperationAction.java, +                    listener.onFailure(new NodeClosedException(nodes.getLocalNode()));, +++ b/core/src/main/java/org/elasticsearch/client/transport/TransportClientNodesService.java, +                            entry.getValue().getState().nodes().getLocalNode(), clusterName);, +++ b/core/src/main/java/org/elasticsearch/cluster/ClusterState.java, +        return readFrom(in, nodes.getLocalNode());, +++ b/core/src/main/java/org/elasticsearch/cluster/action/index/NodeIndexDeletedAction.java, +        if (nodes.getLocalNode().isDataNode() == false) {, +++ b/core/src/main/java/org/elasticsearch/action/support/single/instance/TransportInstanceSingleOperationAction.java, +                    listener.onFailure(new NodeClosedException(nodes.getLocalNode()));, +++ b/core/src/main/java/org/elasticsearch/client/transport/TransportClientNodesService.java, +                            entry.getValue().getState().nodes().getLocalNode(), clusterName);, +++ b/core/src/main/java/org/elasticsearch/cluster/ClusterState.java, +        return readFrom(in, nodes.getLocalNode());, +++ b/core/src/main/java/org/elasticsearch/cluster/action/index/NodeIndexDeletedAction.java, +        if (nodes.getLocalNode().isDataNode() == false) {, +++ b/core/src/main/java/org/elasticsearch/cluster/node/DiscoveryNodes.java, +        return nodes.get(localNodeId);, +            if (node == getLocalNode()) {, +        return readFrom(in, getLocalNode());, +++ b/core/src/main/java/org/elasticsearch/action/support/single/instance/TransportInstanceSingleOperationAction.java, +                    listener.onFailure(new NodeClosedException(nodes.getLocalNode()));, +++ b/core/src/main/java/org/elasticsearch/client/transport/TransportClientNodesService.java, +                            entry.getValue().getState().nodes().getLocalNode(), clusterName);, +++ b/core/src/main/java/org/elasticsearch/cluster/ClusterState.java, +        return readFrom(in, nodes.getLocalNode());, +++ b/core/src/main/java/org/elasticsearch/cluster/action/index/NodeIndexDeletedAction.java, +        if (nodes.getLocalNode().isDataNode() == false) {, +++ b/core/src/main/java/org/elasticsearch/cluster/node/DiscoveryNodes.java, +        return nodes.get(localNodeId);, +            if (node == getLocalNode()) {, +        return readFrom(in, getLocalNode());, +++ b/core/src/main/java/org/elasticsearch/cluster/routing/IndexShardRoutingTable.java, +            final String localAttributeValue = nodes.getLocalNode().getAttributes().get(attribute);, +++ b/core/src/main/java/org/elasticsearch/action/support/single/instance/TransportInstanceSingleOperationAction.java, +                    listener.onFailure(new NodeClosedException(nodes.getLocalNode()));, +++ b/core/src/main/java/org/elasticsearch/client/transport/TransportClientNodesService.java, +                            entry.getValue().getState().nodes().getLocalNode(), clusterName);, +++ b/core/src/main/java/org/elasticsearch/cluster/ClusterState.java, +        return readFrom(in, nodes.getLocalNode());, +++ b/core/src/main/java/org/elasticsearch/cluster/action/index/NodeIndexDeletedAction.java, +        if (nodes.getLocalNode().isDataNode() == false) {, +++ b/core/src/main/java/org/elasticsearch/cluster/node/DiscoveryNodes.java, +        return nodes.get(localNodeId);, +            if (node == getLocalNode()) {, +        return readFrom(in, getLocalNode());, +++ b/core/src/main/java/org/elasticsearch/cluster/routing/IndexShardRoutingTable.java, +            final String localAttributeValue = nodes.getLocalNode().getAttributes().get(attribute);, +++ b/core/src/main/java/org/elasticsearch/cluster/service/ClusterService.java, +        Objects.requireNonNull(clusterState.nodes().getLocalNode(), "please set the local node before starting");, +        return clusterState.getNodes().getLocalNode();, +                    ackListener.onNodeAck(newClusterState.nodes().getLocalNode(), null);, +                    logger.debug("error while processing ack for master node [{}]", t, newClusterState.nodes().getLocalNode());, +++ b/core/src/main/java/org/elasticsearch/action/support/single/instance/TransportInstanceSingleOperationAction.java, +                    listener.onFailure(new NodeClosedException(nodes.getLocalNode()));, +++ b/core/src/main/java/org/elasticsearch/client/transport/TransportClientNodesService.java, +                            entry.getValue().getState().nodes().getLocalNode(), clusterName);, +++ b/core/src/main/java/org/elasticsearch/cluster/ClusterState.java, +        return readFrom(in, nodes.getLocalNode());, +++ b/core/src/main/java/org/elasticsearch/cluster/action/index/NodeIndexDeletedAction.java, +        if (nodes.getLocalNode().isDataNode() == false) {, +++ b/core/src/main/java/org/elasticsearch/cluster/node/DiscoveryNodes.java, +        return nodes.get(localNodeId);, +            if (node == getLocalNode()) {, +        return readFrom(in, getLocalNode());, +++ b/core/src/main/java/org/elasticsearch/cluster/routing/IndexShardRoutingTable.java, +            final String localAttributeValue = nodes.getLocalNode().getAttributes().get(attribute);, +++ b/core/src/main/java/org/elasticsearch/cluster/service/ClusterService.java, +        Objects.requireNonNull(clusterState.nodes().getLocalNode(), "please set the local node before starting");, +        return clusterState.getNodes().getLocalNode();, +                    ackListener.onNodeAck(newClusterState.nodes().getLocalNode(), null);, +                    logger.debug("error while processing ack for master node [{}]", t, newClusterState.nodes().getLocalNode());, +++ b/core/src/main/java/org/elasticsearch/discovery/local/LocalDiscovery.java, +                if (nodeSpecificClusterState.nodes().getLocalNode() != null) {, +++ b/core/src/main/java/org/elasticsearch/action/support/single/instance/TransportInstanceSingleOperationAction.java, +                    listener.onFailure(new NodeClosedException(nodes.getLocalNode()));, +++ b/core/src/main/java/org/elasticsearch/client/transport/TransportClientNodesService.java, +                            entry.getValue().getState().nodes().getLocalNode(), clusterName);, +++ b/core/src/main/java/org/elasticsearch/cluster/ClusterState.java, +        return readFrom(in, nodes.getLocalNode());, +++ b/core/src/main/java/org/elasticsearch/cluster/action/index/NodeIndexDeletedAction.java, +        if (nodes.getLocalNode().isDataNode() == false) {, +++ b/core/src/main/java/org/elasticsearch/cluster/node/DiscoveryNodes.java, +        return nodes.get(localNodeId);, +            if (node == getLocalNode()) {, +        return readFrom(in, getLocalNode());, +++ b/core/src/main/java/org/elasticsearch/cluster/routing/IndexShardRoutingTable.java, +            final String localAttributeValue = nodes.getLocalNode().getAttributes().get(attribute);]
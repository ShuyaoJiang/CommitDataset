[+++ b/core/src/main/java/org/elasticsearch/bootstrap/Security.java, +++ b/core/src/main/java/org/elasticsearch/bootstrap/Security.java, +++ b/core/src/main/resources/org/elasticsearch/bootstrap/security.policy, +  // needed by scripting engines, etc, +  permission java.lang.RuntimePermission "createClassLoader";, +, +  // needed by GroovyScriptEngineService, +  permission java.lang.RuntimePermission "closeClassLoader";, +, +  // needed by groovy scripting, +  // reflection hacks:, +  // needed by groovy engine, +  permission java.lang.RuntimePermission "accessClassInPackage.sun.reflect";, +  , +++ b/core/src/main/java/org/elasticsearch/bootstrap/Security.java, +++ b/core/src/main/resources/org/elasticsearch/bootstrap/security.policy, +  // needed by scripting engines, etc, +  permission java.lang.RuntimePermission "createClassLoader";, +, +  // needed by GroovyScriptEngineService, +  permission java.lang.RuntimePermission "closeClassLoader";, +, +  // needed by groovy scripting, +  // reflection hacks:, +  // needed by groovy engine, +  permission java.lang.RuntimePermission "accessClassInPackage.sun.reflect";, +  , +++ b/core/src/test/java/org/elasticsearch/index/query/AbstractQueryTestCase.java, +        // workaround https://bugs.openjdk.java.net/browse/JDK-8056984, +        float boost = queryBuilder.boost();, +        assertThat(query.getBoost(), equalTo(boost));, +++ b/core/src/main/java/org/elasticsearch/bootstrap/Security.java, +++ b/core/src/main/resources/org/elasticsearch/bootstrap/security.policy, +  // needed by scripting engines, etc, +  permission java.lang.RuntimePermission "createClassLoader";, +, +  // needed by GroovyScriptEngineService, +  permission java.lang.RuntimePermission "closeClassLoader";, +, +  // needed by groovy scripting, +  // reflection hacks:, +  // needed by groovy engine, +  permission java.lang.RuntimePermission "accessClassInPackage.sun.reflect";, +  , +++ b/core/src/test/java/org/elasticsearch/index/query/AbstractQueryTestCase.java, +        // workaround https://bugs.openjdk.java.net/browse/JDK-8056984, +        float boost = queryBuilder.boost();, +        assertThat(query.getBoost(), equalTo(boost));, +++ b/plugins/lang-expression/src/main/java/org/elasticsearch/script/expression/ExpressionScriptEngineService.java, +++ b/core/src/main/java/org/elasticsearch/bootstrap/Security.java, +++ b/core/src/main/resources/org/elasticsearch/bootstrap/security.policy, +  // needed by scripting engines, etc, +  permission java.lang.RuntimePermission "createClassLoader";, +, +  // needed by GroovyScriptEngineService, +  permission java.lang.RuntimePermission "closeClassLoader";, +, +  // needed by groovy scripting, +  // reflection hacks:, +  // needed by groovy engine, +  permission java.lang.RuntimePermission "accessClassInPackage.sun.reflect";, +  , +++ b/core/src/test/java/org/elasticsearch/index/query/AbstractQueryTestCase.java, +        // workaround https://bugs.openjdk.java.net/browse/JDK-8056984, +        float boost = queryBuilder.boost();, +        assertThat(query.getBoost(), equalTo(boost));, +++ b/plugins/lang-expression/src/main/java/org/elasticsearch/script/expression/ExpressionScriptEngineService.java, +++ b/plugins/lang-expression/src/test/java/org/elasticsearch/script/expression/MoreExpressionTests.java, +++ b/core/src/main/java/org/elasticsearch/bootstrap/Security.java, +++ b/core/src/main/resources/org/elasticsearch/bootstrap/security.policy, +  // needed by scripting engines, etc, +  permission java.lang.RuntimePermission "createClassLoader";, +, +  // needed by GroovyScriptEngineService, +  permission java.lang.RuntimePermission "closeClassLoader";, +, +  // needed by groovy scripting, +  // reflection hacks:, +  // needed by groovy engine, +  permission java.lang.RuntimePermission "accessClassInPackage.sun.reflect";, +  , +++ b/core/src/test/java/org/elasticsearch/index/query/AbstractQueryTestCase.java, +        // workaround https://bugs.openjdk.java.net/browse/JDK-8056984, +        float boost = queryBuilder.boost();, +        assertThat(query.getBoost(), equalTo(boost));, +++ b/plugins/lang-expression/src/main/java/org/elasticsearch/script/expression/ExpressionScriptEngineService.java, +++ b/plugins/lang-expression/src/test/java/org/elasticsearch/script/expression/MoreExpressionTests.java, +++ b/plugins/lang-groovy/src/main/java/org/elasticsearch/script/groovy/GroovyScriptEngineService.java, +        this.loader = new GroovyClassLoader(getClass().getClassLoader(), config);]
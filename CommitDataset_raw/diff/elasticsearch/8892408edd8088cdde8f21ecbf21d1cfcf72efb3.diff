[+++ b/client/rest-high-level/src/test/java/org/elasticsearch/client/SnapshotIT.java, +        if (waitForCompletion == false) {, +            // If we don't wait for the snapshot to complete we have to cancel it to not leak the snapshot task, +            AcknowledgedResponse deleteResponse = execute(, +                new DeleteSnapshotRequest(repository, snapshot),, +                highLevelClient().snapshot()::delete, highLevelClient().snapshot()::deleteAsync, +            );, +            assertTrue(deleteResponse.isAcknowledged());, +        }]
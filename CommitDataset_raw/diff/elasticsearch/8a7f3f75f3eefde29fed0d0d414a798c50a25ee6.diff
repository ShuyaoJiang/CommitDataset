[+++ b/modules/lang-mustache/src/main/java/org/elasticsearch/script/mustache/RestMultiSearchTemplateAction.java, +import java.util.Arrays;, +import java.util.HashSet;, +, +    private static final Set<String> RESPONSE_PARAMS;, +, +    static {, +        final Set<String> responseParams = new HashSet<>(, +            Arrays.asList(RestSearchAction.TYPED_KEYS_PARAM, RestSearchAction.TOTAL_HIT_AS_INT_PARAM), +        );, +        RESPONSE_PARAMS = Collections.unmodifiableSet(responseParams);, +    }, +++ b/modules/lang-mustache/src/main/java/org/elasticsearch/script/mustache/RestMultiSearchTemplateAction.java, +import java.util.Arrays;, +import java.util.HashSet;, +, +    private static final Set<String> RESPONSE_PARAMS;, +, +    static {, +        final Set<String> responseParams = new HashSet<>(, +            Arrays.asList(RestSearchAction.TYPED_KEYS_PARAM, RestSearchAction.TOTAL_HIT_AS_INT_PARAM), +        );, +        RESPONSE_PARAMS = Collections.unmodifiableSet(responseParams);, +    }, +++ b/modules/lang-mustache/src/main/java/org/elasticsearch/script/mustache/RestSearchTemplateAction.java, +import java.util.Arrays;, +import java.util.HashSet;, +    private static final Set<String> RESPONSE_PARAMS;, +, +    static {, +        final Set<String> responseParams = new HashSet<>(, +            Arrays.asList(RestSearchAction.TYPED_KEYS_PARAM, RestSearchAction.TOTAL_HIT_AS_INT_PARAM), +        );, +        RESPONSE_PARAMS = Collections.unmodifiableSet(responseParams);, +    }, +++ b/modules/lang-mustache/src/main/java/org/elasticsearch/script/mustache/RestMultiSearchTemplateAction.java, +import java.util.Arrays;, +import java.util.HashSet;, +, +    private static final Set<String> RESPONSE_PARAMS;, +, +    static {, +        final Set<String> responseParams = new HashSet<>(, +            Arrays.asList(RestSearchAction.TYPED_KEYS_PARAM, RestSearchAction.TOTAL_HIT_AS_INT_PARAM), +        );, +        RESPONSE_PARAMS = Collections.unmodifiableSet(responseParams);, +    }, +++ b/modules/lang-mustache/src/main/java/org/elasticsearch/script/mustache/RestSearchTemplateAction.java, +import java.util.Arrays;, +import java.util.HashSet;, +    private static final Set<String> RESPONSE_PARAMS;, +, +    static {, +        final Set<String> responseParams = new HashSet<>(, +            Arrays.asList(RestSearchAction.TYPED_KEYS_PARAM, RestSearchAction.TOTAL_HIT_AS_INT_PARAM), +        );, +        RESPONSE_PARAMS = Collections.unmodifiableSet(responseParams);, +    }, +++ b/modules/lang-mustache/src/test/resources/rest-api-spec/test/lang_mustache/30_search_template.yml, +, +---, +"Test with rest_total_hits_as_int":, +  - skip:, +      version: " - 6.5.99", +      reason: rest_total_hits_as_int was introduced in 6.6.0, +, +  - do:, +      index:, +        index:  test, +        type:   type, +        id:     1, +        body:   {}, +, +  - do:, +      put_script:, +        id: "template_1", +        body: { "script": { "lang": "mustache", "source": { "query": { "match_all": {} } } } }, +, +  - match: { acknowledged: true }, +, +  - do:, +      search_template:, +        rest_total_hits_as_int: true, +        body: { "id": "template_1", "params": {} }, +, +  - match: { hits.total: 0 }, +++ b/modules/lang-mustache/src/main/java/org/elasticsearch/script/mustache/RestMultiSearchTemplateAction.java, +import java.util.Arrays;, +import java.util.HashSet;, +, +    private static final Set<String> RESPONSE_PARAMS;, +, +    static {, +        final Set<String> responseParams = new HashSet<>(, +            Arrays.asList(RestSearchAction.TYPED_KEYS_PARAM, RestSearchAction.TOTAL_HIT_AS_INT_PARAM), +        );, +        RESPONSE_PARAMS = Collections.unmodifiableSet(responseParams);, +    }, +++ b/modules/lang-mustache/src/main/java/org/elasticsearch/script/mustache/RestSearchTemplateAction.java, +import java.util.Arrays;]
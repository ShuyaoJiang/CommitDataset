[+++ b/core/src/main/java/org/elasticsearch/common/settings/ClusterSettings.java, +     * already set in the given source. The diff contains either the default value for each, +     * setting or the settings value in the given default settings., +    public Settings diff(Settings source, Settings defaultSettings) {, +                builder.put(setting.getKey(), setting.getRaw(defaultSettings));, +++ b/core/src/main/java/org/elasticsearch/common/settings/ClusterSettings.java, +     * already set in the given source. The diff contains either the default value for each, +     * setting or the settings value in the given default settings., +    public Settings diff(Settings source, Settings defaultSettings) {, +                builder.put(setting.getKey(), setting.getRaw(defaultSettings));, +++ b/core/src/main/java/org/elasticsearch/rest/action/admin/cluster/settings/RestClusterGetSettingsAction.java, +                return new BytesRestResponse(RestStatus.OK, renderResponse(response.getState(), renderDefaults, builder, request));, +    private XContentBuilder renderResponse(ClusterState state, boolean renderDefaults, XContentBuilder builder, ToXContent.Params params) throws IOException {, +            clusterSettings.diff(state.metaData().settings(), this.settings).toXContent(builder, params);, +++ b/core/src/main/java/org/elasticsearch/common/settings/ClusterSettings.java, +     * already set in the given source. The diff contains either the default value for each, +     * setting or the settings value in the given default settings., +    public Settings diff(Settings source, Settings defaultSettings) {, +                builder.put(setting.getKey(), setting.getRaw(defaultSettings));, +++ b/core/src/main/java/org/elasticsearch/rest/action/admin/cluster/settings/RestClusterGetSettingsAction.java, +                return new BytesRestResponse(RestStatus.OK, renderResponse(response.getState(), renderDefaults, builder, request));, +    private XContentBuilder renderResponse(ClusterState state, boolean renderDefaults, XContentBuilder builder, ToXContent.Params params) throws IOException {, +            clusterSettings.diff(state.metaData().settings(), this.settings).toXContent(builder, params);, +++ b/core/src/test/java/org/elasticsearch/common/settings/ClusterSettingsTests.java, +        Settings diff = settings.diff(Settings.builder().put("foo.bar", 5).build(), Settings.EMPTY);, +, +        diff = settings.diff(Settings.builder().put("foo.bar", 5).build(), Settings.builder().put("foo.bar.baz", 17).build());, +        assertEquals(diff.getAsMap().size(), 1);, +        assertEquals(diff.getAsInt("foo.bar.baz", null), Integer.valueOf(17));]
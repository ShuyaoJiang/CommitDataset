[+++ b/src/main/java/org/elasticsearch/license/plugin/LicensePlugin.java, +import org.elasticsearch.client.Client;, +    private final boolean isEnabled;, +        if (DiscoveryNode.clientNode(settings)) {, +            // Enable plugin only on node clients, +            this.isEnabled = "node".equals(settings.get(Client.CLIENT_TYPE_SETTING));, +        } else {, +            this.isEnabled = true;, +        }, +        if (isEnabled) {, +        if (isEnabled) {, +        return ImmutableSet.of();, +    }, +++ b/src/main/java/org/elasticsearch/license/plugin/LicensePlugin.java, +import org.elasticsearch.client.Client;, +    private final boolean isEnabled;, +        if (DiscoveryNode.clientNode(settings)) {, +            // Enable plugin only on node clients, +            this.isEnabled = "node".equals(settings.get(Client.CLIENT_TYPE_SETTING));, +        } else {, +            this.isEnabled = true;, +        }, +        if (isEnabled) {, +        if (isEnabled) {, +        return ImmutableSet.of();, +    }, +++ b/src/main/java/org/elasticsearch/license/plugin/core/LicensesService.java, +//        if (DiscoveryNode.dataNode(settings) || DiscoveryNode.masterNode(settings)) {, +//        }, +++ b/src/main/java/org/elasticsearch/license/plugin/LicensePlugin.java, +import org.elasticsearch.client.Client;, +    private final boolean isEnabled;, +        if (DiscoveryNode.clientNode(settings)) {, +            // Enable plugin only on node clients, +            this.isEnabled = "node".equals(settings.get(Client.CLIENT_TYPE_SETTING));, +        } else {, +            this.isEnabled = true;, +        }, +        if (isEnabled) {, +        if (isEnabled) {, +        return ImmutableSet.of();, +    }, +++ b/src/main/java/org/elasticsearch/license/plugin/core/LicensesService.java, +//        if (DiscoveryNode.dataNode(settings) || DiscoveryNode.masterNode(settings)) {, +//        }, +++ b/src/test/java/org/elasticsearch/license/plugin/TestConsumerPlugin.java, +import org.elasticsearch.client.Client;, +    private final boolean isEnabled;, +        if (DiscoveryNode.clientNode(settings)) {, +            // Enable plugin only on node clients, +            this.isEnabled = "node".equals(settings.get(Client.CLIENT_TYPE_SETTING));, +        } else {, +            this.isEnabled = true;, +        }, +        if (isEnabled) {]
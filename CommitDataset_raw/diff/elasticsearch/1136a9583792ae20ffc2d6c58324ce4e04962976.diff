[+++ b/x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/security/action/privilege/PutPrivilegesRequestBuilder.java, +++ b/x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/security/action/privilege/PutPrivilegesRequestBuilder.java, +++ b/x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/security/client/SecurityClient.java, +++ b/x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/security/action/privilege/PutPrivilegesRequestBuilder.java, +++ b/x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/security/client/SecurityClient.java, +++ b/x-pack/plugin/security/src/main/java/org/elasticsearch/xpack/security/Security.java, +++ b/x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/security/action/privilege/PutPrivilegesRequestBuilder.java, +++ b/x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/security/client/SecurityClient.java, +++ b/x-pack/plugin/security/src/main/java/org/elasticsearch/xpack/security/Security.java, +++ /dev/null, +++ b/x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/security/action/privilege/PutPrivilegesRequestBuilder.java, +++ b/x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/security/client/SecurityClient.java, +++ b/x-pack/plugin/security/src/main/java/org/elasticsearch/xpack/security/Security.java, +++ /dev/null, +++ b/x-pack/plugin/security/src/main/java/org/elasticsearch/xpack/security/rest/action/privilege/RestPutPrivilegesAction.java, +import static org.elasticsearch.rest.RestRequest.Method.PUT;, +        controller.registerHandler(PUT, "/_xpack/security/privilege/", this);, +++ b/x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/security/action/privilege/PutPrivilegesRequestBuilder.java, +++ b/x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/security/client/SecurityClient.java, +++ b/x-pack/plugin/security/src/main/java/org/elasticsearch/xpack/security/Security.java, +++ /dev/null, +++ b/x-pack/plugin/security/src/main/java/org/elasticsearch/xpack/security/rest/action/privilege/RestPutPrivilegesAction.java, +import static org.elasticsearch.rest.RestRequest.Method.PUT;, +        controller.registerHandler(PUT, "/_xpack/security/privilege/", this);, +++ b/x-pack/plugin/security/src/test/java/org/elasticsearch/xpack/core/security/action/privilege/PutPrivilegesRequestBuilderTests.java, +++ b/x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/security/action/privilege/PutPrivilegesRequestBuilder.java, +++ b/x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/security/client/SecurityClient.java, +++ b/x-pack/plugin/security/src/main/java/org/elasticsearch/xpack/security/Security.java, +++ /dev/null, +++ b/x-pack/plugin/security/src/main/java/org/elasticsearch/xpack/security/rest/action/privilege/RestPutPrivilegesAction.java, +import static org.elasticsearch.rest.RestRequest.Method.PUT;, +        controller.registerHandler(PUT, "/_xpack/security/privilege/", this);, +++ b/x-pack/plugin/security/src/test/java/org/elasticsearch/xpack/core/security/action/privilege/PutPrivilegesRequestBuilderTests.java, +++ /dev/null, +++ b/x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/security/action/privilege/PutPrivilegesRequestBuilder.java, +++ b/x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/security/client/SecurityClient.java, +++ b/x-pack/plugin/security/src/main/java/org/elasticsearch/xpack/security/Security.java, +++ /dev/null, +++ b/x-pack/plugin/security/src/main/java/org/elasticsearch/xpack/security/rest/action/privilege/RestPutPrivilegesAction.java, +import static org.elasticsearch.rest.RestRequest.Method.PUT;, +        controller.registerHandler(PUT, "/_xpack/security/privilege/", this);, +++ b/x-pack/plugin/security/src/test/java/org/elasticsearch/xpack/core/security/action/privilege/PutPrivilegesRequestBuilderTests.java, +++ /dev/null, +++ b/x-pack/plugin/src/test/resources/rest-api-spec/api/xpack.security.put_privileges.json, +    "methods": [ "PUT", "POST" ],, +++ b/x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/security/action/privilege/PutPrivilegesRequestBuilder.java, +++ b/x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/security/client/SecurityClient.java, +++ b/x-pack/plugin/security/src/main/java/org/elasticsearch/xpack/security/Security.java, +++ /dev/null, +++ b/x-pack/plugin/security/src/main/java/org/elasticsearch/xpack/security/rest/action/privilege/RestPutPrivilegesAction.java, +import static org.elasticsearch.rest.RestRequest.Method.PUT;, +        controller.registerHandler(PUT, "/_xpack/security/privilege/", this);, +++ b/x-pack/plugin/security/src/test/java/org/elasticsearch/xpack/core/security/action/privilege/PutPrivilegesRequestBuilderTests.java, +++ /dev/null, +++ b/x-pack/plugin/src/test/resources/rest-api-spec/api/xpack.security.put_privileges.json, +    "methods": [ "PUT", "POST" ],, +++ b/x-pack/plugin/src/test/resources/rest-api-spec/test/privileges/10_basic.yml, +  # Single privilege, +      xpack.security.put_privileges:, +              "app": {, +                "p1": {, +              }, +            }, +  # Multiple privileges, +  # Update existing privilege, +      xpack.security.put_privileges:, +              "app": {, +                "p1": {, +              }, +            }, +++ b/x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/security/action/privilege/PutPrivilegesRequestBuilder.java, +++ b/x-pack/plugin/core/src/main/java/org/elasticsearch/xpack/core/security/client/SecurityClient.java, +++ b/x-pack/plugin/security/src/main/java/org/elasticsearch/xpack/security/Security.java, +++ /dev/null, +++ b/x-pack/plugin/security/src/main/java/org/elasticsearch/xpack/security/rest/action/privilege/RestPutPrivilegesAction.java, +import static org.elasticsearch.rest.RestRequest.Method.PUT;, +        controller.registerHandler(PUT, "/_xpack/security/privilege/", this);, +++ b/x-pack/plugin/security/src/test/java/org/elasticsearch/xpack/core/security/action/privilege/PutPrivilegesRequestBuilderTests.java, +++ /dev/null, +++ b/x-pack/plugin/src/test/resources/rest-api-spec/api/xpack.security.put_privileges.json, +    "methods": [ "PUT", "POST" ],, +++ b/x-pack/plugin/src/test/resources/rest-api-spec/test/privileges/10_basic.yml, +  # Single privilege, +      xpack.security.put_privileges:, +              "app": {, +                "p1": {, +              }, +            }, +  # Multiple privileges, +  # Update existing privilege, +      xpack.security.put_privileges:, +              "app": {, +                "p1": {, +              }, +            }, +++ b/x-pack/plugin/src/test/resources/rest-api-spec/test/security/authz/40_condtional_cluster_priv.yml, +      xpack.security.put_privileges:, +              "app-allow": {, +                "read": {, +              }]
[+++ b/src/test/java/org/elasticsearch/test/integration/cluster/ClusterServiceTests.java, +import java.util.*;, +import static org.testng.Assert.assertTrue;, +        final CountDownLatch invoked1 = new CountDownLatch(1);, +                invoked1.countDown();, +                invoked1.countDown();, +        invoked1.await();, +        // The tasks can be re-ordered, so we need to check out-of-order, +        Set<String> controlSources = new HashSet<String>(Arrays.asList("2", "3", "4", "5", "6", "7", "8", "9", "10"));, +            assertTrue(controlSources.remove(task.source().string()));, +        assertTrue(controlSources.isEmpty());, +        controlSources = new HashSet<String>(Arrays.asList("2", "3", "4", "5", "6", "7", "8", "9", "10"));, +            assertTrue(controlSources.remove(task.source().string()));, +        assertTrue(controlSources.isEmpty());, +        final CountDownLatch invoked2 = new CountDownLatch(1);, +                invoked2.countDown();, +                invoked2.countDown();, +        invoked2.await();, +        controlSources = new HashSet<String>(Arrays.asList("2", "3", "4", "5"));, +            assertTrue(controlSources.remove(task.source().string()));, +        assertTrue(controlSources.isEmpty());, +        controlSources = new HashSet<String>(Arrays.asList("2", "3", "4", "5"));, +            assertTrue(controlSources.remove(task.source().string()));, +        assertTrue(controlSources.isEmpty());]
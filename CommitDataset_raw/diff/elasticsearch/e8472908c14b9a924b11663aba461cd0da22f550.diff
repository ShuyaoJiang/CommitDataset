[+++ b/plugin/src/main/java/org/elasticsearch/license/XPackLicenseState.java, +                switch (currentMode) {, +                    case TRIAL:, +     * Logstash is allowed as long as there is an active license of type TRIAL, STANDARD, GOLD or PLATINUM, +        Status localStatus = status;, +, +        if (localStatus.active == false) {, +            return false;, +        }, +, +        switch (localStatus.mode) {, +            case TRIAL:, +            case GOLD:, +            case PLATINUM:, +            case STANDARD:, +                return true;, +            default:, +                return false;, +        }, +++ b/plugin/src/main/java/org/elasticsearch/license/XPackLicenseState.java, +                switch (currentMode) {, +                    case TRIAL:, +     * Logstash is allowed as long as there is an active license of type TRIAL, STANDARD, GOLD or PLATINUM, +        Status localStatus = status;, +, +        if (localStatus.active == false) {, +            return false;, +        }, +, +        switch (localStatus.mode) {, +            case TRIAL:, +            case GOLD:, +            case PLATINUM:, +            case STANDARD:, +                return true;, +            default:, +                return false;, +        }, +++ b/plugin/src/test/java/org/elasticsearch/license/XPackLicenseStateTests.java, +    public void testLogstashPlatinumGoldTrialStandard() throws Exception {, +        assertAllowed(TRIAL, true, XPackLicenseState::isLogstashAllowed, true);, +        assertAllowed(GOLD, true, XPackLicenseState::isLogstashAllowed, true);, +        assertAllowed(PLATINUM, true, XPackLicenseState::isLogstashAllowed, true);, +        assertAllowed(STANDARD, true, XPackLicenseState::isLogstashAllowed, true);, +    public void testLogstashBasicLicense() throws Exception {, +        assertAllowed(BASIC, true, XPackLicenseState::isLogstashAllowed, false);, +    }, +, +    public void testLogstashInactive() {, +        assertAllowed(BASIC, false, XPackLicenseState::isLogstashAllowed, false);, +        assertAllowed(TRIAL, false, XPackLicenseState::isLogstashAllowed, false);, +        assertAllowed(GOLD, false, XPackLicenseState::isLogstashAllowed, false);, +        assertAllowed(PLATINUM, false, XPackLicenseState::isLogstashAllowed, false);, +        assertAllowed(STANDARD, false, XPackLicenseState::isLogstashAllowed, false);]
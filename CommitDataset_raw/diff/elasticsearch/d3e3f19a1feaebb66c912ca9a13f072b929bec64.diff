[+++ b/docs/reference/ingest/ingest-node.asciidoc, +, +== Accessing data in pipelines, +, +Processors in pipelines have read and write access to documents that pass through the pipeline., +The fields in the source of a document and its metadata fields are accessible., +, +Accessing a field in the source is straightforward and one can refer to fields by, +their name. For example:, +, +[source,js], +--------------------------------------------------, +{, +  "set": {, +    "field": "my_field", +    "value": 582.1, +  }, +}, +--------------------------------------------------, +, +On top of this fields from the source are always accessible via the `_source` prefix:, +, +[source,js], +--------------------------------------------------, +{, +  "set": {, +    "field": "_source.my_field", +    "value": 582.1, +  }, +}, +--------------------------------------------------, +, +Metadata fields can also be accessed in the same way as fields from the source. This, +is possible because Elasticsearch doesn't allow fields in the source that have the, +same name as metadata fields., +, +The following example sets the id of a document to `1`:, +, +[source,js], +--------------------------------------------------, +{, +  "set": {, +    "field": "_id", +    "value": "1", +  }, +}, +--------------------------------------------------, +, +The following metadata fields are accessible by a processor: `_index`, `_type`, `_id`, `_routing`, `_parent`,, +`_timestamp` and `_ttl`., +, +Beyond metadata fields and source fields, ingest also adds ingest metadata to documents being processed., +These metadata properties are accessible under the `_ingest` key. Currently ingest adds the ingest timestamp, +under `_ingest.timestamp` key to the ingest metadata, which is the time ES received the index or bulk, +request to pre-process. But any processor is free to add more ingest related metadata to it. Ingest metadata is transient, +and is lost after a document has been processed by the pipeline and thus ingest metadata won't be indexed., +, +The following example adds a field with the name `received` and the value is the ingest timestamp:, +, +[source,js], +--------------------------------------------------, +{, +  "set": {, +    "field": "received", +    "value": "{{_ingest.timestamp}}", +  }, +}, +--------------------------------------------------, +, +As opposed to Elasticsearch metadata fields, the ingest metadata field name _ingest can be used as a valid field name, +in the source of a document. Use _source._ingest to refer to it, otherwise _ingest will be interpreted as ingest, +metadata fields., +, +A number of processor settings also support templating. Settings that support templating can have zero or more, +template snippets. A template snippet begins with `{{` and ends with `}}`., +Accessing fields and metafields in templates is exactly the same as via regular processor field settings., +, +In this example a field by the name `field_c` is added and its value is a concatenation of, +the values of `field_a` and `field_b`., +, +[source,js], +--------------------------------------------------, +{, +  "set": {, +    "field": "field_c", +    "value": "{{field_a}} {{field_b}}", +  }, +}, +--------------------------------------------------, +, +The following example changes the index a document is going to be indexed into. The index a document will be redirected, +to depends on the field in the source with name `geoip.country_iso_code`., +, +[source,js], +--------------------------------------------------, +{, +  "set": {, +    "field": "_index", +    "value": "{{geoip.country_iso_code}}", +  }]
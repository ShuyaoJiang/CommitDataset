[+++ b/modules/elasticsearch/src/main/java/org/elasticsearch/index/store/support/AbstractStore.java, +            StoreFileMetaData toMetaData = new StoreFileMetaData(to, fromMetaData.length(), fromMetaData.lastModified(), fromMetaData.checksum());, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/index/store/support/AbstractStore.java, +            StoreFileMetaData toMetaData = new StoreFileMetaData(to, fromMetaData.length(), fromMetaData.lastModified(), fromMetaData.checksum());, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/indices/store/TransportNodesListShardStoreMetaData.java, +import org.elasticsearch.action.support.nodes.NodeOperationRequest;, +import org.elasticsearch.action.support.nodes.NodeOperationResponse;, +import org.elasticsearch.action.support.nodes.NodesOperationRequest;, +import org.elasticsearch.action.support.nodes.NodesOperationResponse;, +import org.elasticsearch.action.support.nodes.TransportNodesOperationAction;, +        Map<String, String> checksums = null;, +            checksums = AbstractStore.readChecksums(directory);, +            if (checksumFile.exists() && (checksums == null || !checksums.containsKey(file.getName()))) {, +        }]
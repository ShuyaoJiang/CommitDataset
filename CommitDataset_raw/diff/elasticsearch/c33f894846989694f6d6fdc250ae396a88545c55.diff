[+++ b/modules/transport-netty4/src/main/java/org/elasticsearch/http/netty4/Netty4HttpRequest.java, +import java.util.AbstractMap;, +            return httpHeaders.names().stream().map(k -> new AbstractMap.SimpleImmutableEntry<>(k, httpHeaders.getAll(k))), +                    .collect(Collectors.toSet());, +++ b/modules/transport-netty4/src/main/java/org/elasticsearch/http/netty4/Netty4HttpRequest.java, +import java.util.AbstractMap;, +            return httpHeaders.names().stream().map(k -> new AbstractMap.SimpleImmutableEntry<>(k, httpHeaders.getAll(k))), +                    .collect(Collectors.toSet());, +++ b/plugins/ingest-attachment/build.gradle, +++ b/modules/transport-netty4/src/main/java/org/elasticsearch/http/netty4/Netty4HttpRequest.java, +import java.util.AbstractMap;, +            return httpHeaders.names().stream().map(k -> new AbstractMap.SimpleImmutableEntry<>(k, httpHeaders.getAll(k))), +                    .collect(Collectors.toSet());, +++ b/plugins/ingest-attachment/build.gradle, +++ b/plugins/ingest-attachment/src/main/java/org/elasticsearch/ingest/attachment/TikaImpl.java, +        new org.apache.tika.parser.microsoft.ooxml.OOXMLParser(),, +++ b/modules/transport-netty4/src/main/java/org/elasticsearch/http/netty4/Netty4HttpRequest.java, +import java.util.AbstractMap;, +            return httpHeaders.names().stream().map(k -> new AbstractMap.SimpleImmutableEntry<>(k, httpHeaders.getAll(k))), +                    .collect(Collectors.toSet());, +++ b/plugins/ingest-attachment/build.gradle, +++ b/plugins/ingest-attachment/src/main/java/org/elasticsearch/ingest/attachment/TikaImpl.java, +        new org.apache.tika.parser.microsoft.ooxml.OOXMLParser(),, +++ b/plugins/ingest-attachment/src/test/java/org/elasticsearch/ingest/attachment/AttachmentProcessorTests.java, +++ b/modules/transport-netty4/src/main/java/org/elasticsearch/http/netty4/Netty4HttpRequest.java, +import java.util.AbstractMap;, +            return httpHeaders.names().stream().map(k -> new AbstractMap.SimpleImmutableEntry<>(k, httpHeaders.getAll(k))), +                    .collect(Collectors.toSet());, +++ b/plugins/ingest-attachment/build.gradle, +++ b/plugins/ingest-attachment/src/main/java/org/elasticsearch/ingest/attachment/TikaImpl.java, +        new org.apache.tika.parser.microsoft.ooxml.OOXMLParser(),, +++ b/plugins/ingest-attachment/src/test/java/org/elasticsearch/ingest/attachment/AttachmentProcessorTests.java, +++ /dev/null, +++ b/modules/transport-netty4/src/main/java/org/elasticsearch/http/netty4/Netty4HttpRequest.java, +import java.util.AbstractMap;, +            return httpHeaders.names().stream().map(k -> new AbstractMap.SimpleImmutableEntry<>(k, httpHeaders.getAll(k))), +                    .collect(Collectors.toSet());, +++ b/plugins/ingest-attachment/build.gradle, +++ b/plugins/ingest-attachment/src/main/java/org/elasticsearch/ingest/attachment/TikaImpl.java, +        new org.apache.tika.parser.microsoft.ooxml.OOXMLParser(),, +++ b/plugins/ingest-attachment/src/test/java/org/elasticsearch/ingest/attachment/AttachmentProcessorTests.java, +++ /dev/null, +++ /dev/null, +++ b/modules/transport-netty4/src/main/java/org/elasticsearch/http/netty4/Netty4HttpRequest.java, +import java.util.AbstractMap;, +            return httpHeaders.names().stream().map(k -> new AbstractMap.SimpleImmutableEntry<>(k, httpHeaders.getAll(k))), +                    .collect(Collectors.toSet());, +++ b/plugins/ingest-attachment/build.gradle, +++ b/plugins/ingest-attachment/src/main/java/org/elasticsearch/ingest/attachment/TikaImpl.java, +        new org.apache.tika.parser.microsoft.ooxml.OOXMLParser(),, +++ b/plugins/ingest-attachment/src/test/java/org/elasticsearch/ingest/attachment/AttachmentProcessorTests.java, +++ /dev/null, +++ /dev/null, +++ /dev/null]
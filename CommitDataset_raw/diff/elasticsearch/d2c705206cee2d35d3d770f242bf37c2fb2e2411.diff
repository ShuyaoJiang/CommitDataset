[+++ b/plugin/src/main/java/org/elasticsearch/license/XPackInfoResponse.java, +                this(in.readString(), in.readOptionalString(), in.readBoolean(), in.readBoolean());, +            public FeatureSet(String name, @Nullable String description, boolean available, boolean enabled) {, +++ b/plugin/src/main/java/org/elasticsearch/license/XPackInfoResponse.java, +                this(in.readString(), in.readOptionalString(), in.readBoolean(), in.readBoolean());, +            public FeatureSet(String name, @Nullable String description, boolean available, boolean enabled) {, +++ b/plugin/src/main/java/org/elasticsearch/xpack/XPackFeatureSet.java, +++ b/plugin/src/main/java/org/elasticsearch/license/XPackInfoResponse.java, +                this(in.readString(), in.readOptionalString(), in.readBoolean(), in.readBoolean());, +            public FeatureSet(String name, @Nullable String description, boolean available, boolean enabled) {, +++ b/plugin/src/main/java/org/elasticsearch/xpack/XPackFeatureSet.java, +++ b/plugin/src/main/java/org/elasticsearch/xpack/action/TransportXPackInfoAction.java, +                    new FeatureSet(fs.name(), request.isVerbose() ? fs.description() : null, fs.available(), fs.enabled())), +++ b/plugin/src/main/java/org/elasticsearch/license/XPackInfoResponse.java, +                this(in.readString(), in.readOptionalString(), in.readBoolean(), in.readBoolean());, +            public FeatureSet(String name, @Nullable String description, boolean available, boolean enabled) {, +++ b/plugin/src/main/java/org/elasticsearch/xpack/XPackFeatureSet.java, +++ b/plugin/src/main/java/org/elasticsearch/xpack/action/TransportXPackInfoAction.java, +                    new FeatureSet(fs.name(), request.isVerbose() ? fs.description() : null, fs.available(), fs.enabled())), +++ b/plugin/src/main/java/org/elasticsearch/xpack/graph/GraphFeatureSet.java, +++ b/plugin/src/main/java/org/elasticsearch/license/XPackInfoResponse.java, +                this(in.readString(), in.readOptionalString(), in.readBoolean(), in.readBoolean());, +            public FeatureSet(String name, @Nullable String description, boolean available, boolean enabled) {, +++ b/plugin/src/main/java/org/elasticsearch/xpack/XPackFeatureSet.java, +++ b/plugin/src/main/java/org/elasticsearch/xpack/action/TransportXPackInfoAction.java, +                    new FeatureSet(fs.name(), request.isVerbose() ? fs.description() : null, fs.available(), fs.enabled())), +++ b/plugin/src/main/java/org/elasticsearch/xpack/graph/GraphFeatureSet.java, +++ b/plugin/src/main/java/org/elasticsearch/xpack/ml/MachineLearning.java, +import org.elasticsearch.cluster.routing.UnassignedInfo;, +import org.elasticsearch.common.unit.TimeValue;, +import org.elasticsearch.xpack.persistent.CreatePersistentTaskAction;, +                NativeController nativeController = new NativeController(env, new NamedPipeHelper());, +                nativeController.tailLogsInThread();, +                throw new ElasticsearchException("Failed to create native process factories", e);, +++ b/plugin/src/main/java/org/elasticsearch/license/XPackInfoResponse.java, +                this(in.readString(), in.readOptionalString(), in.readBoolean(), in.readBoolean());, +            public FeatureSet(String name, @Nullable String description, boolean available, boolean enabled) {, +++ b/plugin/src/main/java/org/elasticsearch/xpack/XPackFeatureSet.java, +++ b/plugin/src/main/java/org/elasticsearch/xpack/action/TransportXPackInfoAction.java, +                    new FeatureSet(fs.name(), request.isVerbose() ? fs.description() : null, fs.available(), fs.enabled())), +++ b/plugin/src/main/java/org/elasticsearch/xpack/graph/GraphFeatureSet.java, +++ b/plugin/src/main/java/org/elasticsearch/xpack/ml/MachineLearning.java, +import org.elasticsearch.cluster.routing.UnassignedInfo;, +import org.elasticsearch.common.unit.TimeValue;, +import org.elasticsearch.xpack.persistent.CreatePersistentTaskAction;, +                NativeController nativeController = new NativeController(env, new NamedPipeHelper());, +                nativeController.tailLogsInThread();, +                throw new ElasticsearchException("Failed to create native process factories", e);, +++ b/plugin/src/main/java/org/elasticsearch/xpack/ml/MachineLearningFeatureSet.java, +++ b/plugin/src/main/java/org/elasticsearch/license/XPackInfoResponse.java, +                this(in.readString(), in.readOptionalString(), in.readBoolean(), in.readBoolean());, +            public FeatureSet(String name, @Nullable String description, boolean available, boolean enabled) {, +++ b/plugin/src/main/java/org/elasticsearch/xpack/XPackFeatureSet.java, +++ b/plugin/src/main/java/org/elasticsearch/xpack/action/TransportXPackInfoAction.java, +                    new FeatureSet(fs.name(), request.isVerbose() ? fs.description() : null, fs.available(), fs.enabled())), +++ b/plugin/src/main/java/org/elasticsearch/xpack/graph/GraphFeatureSet.java, +++ b/plugin/src/main/java/org/elasticsearch/xpack/ml/MachineLearning.java, +import org.elasticsearch.cluster.routing.UnassignedInfo;, +import org.elasticsearch.common.unit.TimeValue;, +import org.elasticsearch.xpack.persistent.CreatePersistentTaskAction;, +                NativeController nativeController = new NativeController(env, new NamedPipeHelper());, +                nativeController.tailLogsInThread();, +                throw new ElasticsearchException("Failed to create native process factories", e);, +++ b/plugin/src/main/java/org/elasticsearch/xpack/ml/MachineLearningFeatureSet.java, +++ b/plugin/src/main/java/org/elasticsearch/xpack/ml/action/CloseJobAction.java, +import org.elasticsearch.xpack.persistent.PersistentTaskClusterService;, +        private final PersistentTaskClusterService persistentTaskClusterService;, +                               TransportCancelTasksAction cancelTasksAction, PersistentTaskClusterService persistentTaskClusterService) {, +            this.persistentTaskClusterService = persistentTaskClusterService;, +            PersistentTaskInProgress<?> task = validateAndFindTask(request.getJobId(), state);, +                                    persistentTaskClusterService.completeOrRestartPersistentTask(task.getId(), null,, +                                            ActionListener.wrap(, +                                                    empty -> listener.onResponse(new CloseJobAction.Response(true)),, +                                                    listener::onFailure, +                                            ), +                                    );, +        for (PersistentTaskInProgress<?> taskInProgress : currentTasks.tasks()) {, +            if (taskInProgress.getId() == task.getId()) {, +                updatedTasks.put(taskInProgress.getId(), new PersistentTaskInProgress<>(taskInProgress, JobState.CLOSING));, +            }, +        }, +++ b/plugin/src/main/java/org/elasticsearch/license/XPackInfoResponse.java, +                this(in.readString(), in.readOptionalString(), in.readBoolean(), in.readBoolean());, +            public FeatureSet(String name, @Nullable String description, boolean available, boolean enabled) {, +++ b/plugin/src/main/java/org/elasticsearch/xpack/XPackFeatureSet.java, +++ b/plugin/src/main/java/org/elasticsearch/xpack/action/TransportXPackInfoAction.java, +                    new FeatureSet(fs.name(), request.isVerbose() ? fs.description() : null, fs.available(), fs.enabled())), +++ b/plugin/src/main/java/org/elasticsearch/xpack/graph/GraphFeatureSet.java, +++ b/plugin/src/main/java/org/elasticsearch/xpack/ml/MachineLearning.java, +import org.elasticsearch.cluster.routing.UnassignedInfo;, +import org.elasticsearch.common.unit.TimeValue;, +import org.elasticsearch.xpack.persistent.CreatePersistentTaskAction;, +                NativeController nativeController = new NativeController(env, new NamedPipeHelper());, +                nativeController.tailLogsInThread();, +                throw new ElasticsearchException("Failed to create native process factories", e);, +++ b/plugin/src/main/java/org/elasticsearch/xpack/ml/MachineLearningFeatureSet.java, +++ b/plugin/src/main/java/org/elasticsearch/xpack/ml/action/CloseJobAction.java, +import org.elasticsearch.xpack.persistent.PersistentTaskClusterService;, +        private final PersistentTaskClusterService persistentTaskClusterService;, +                               TransportCancelTasksAction cancelTasksAction, PersistentTaskClusterService persistentTaskClusterService) {]
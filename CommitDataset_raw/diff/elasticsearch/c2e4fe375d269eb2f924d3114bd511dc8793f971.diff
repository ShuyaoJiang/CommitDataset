[+++ b/src/main/java/org/elasticsearch/alerts/actions/AlertActionManager.java, +        SearchResponse response = client.prepareSearch(ALERT_HISTORY_INDEX), +                .get();, +++ b/src/main/java/org/elasticsearch/alerts/actions/AlertActionManager.java, +        SearchResponse response = client.prepareSearch(ALERT_HISTORY_INDEX), +                .get();, +++ b/src/test/java/org/elasticsearch/alerts/BootStrapTest.java, +import org.elasticsearch.action.WriteConsistencyLevel;, +@ElasticsearchIntegrationTest.ClusterScope(scope = ElasticsearchIntegrationTest.Scope.SUITE, numClientNodes = 0, transportClientRatio = 0), +        ensureAlertingStarted();, +        client().prepareIndex(AlertsStore.ALERT_INDEX, AlertsStore.ALERT_TYPE, "my-first-alert"), +                .setSource(alertSource), +                .setConsistencyLevel(WriteConsistencyLevel.ALL), +        AlertsStatsRequest alertsStatsRequest = alertClient().prepareAlertsStats().request();, +        AlertsStatsResponse response = alertClient().alertsStats(alertsStatsRequest).actionGet();, +        ensureAlertingStarted();, +        internalTestCluster().ensureAtLeastNumDataNodes(2);, +        AlertActionEntry entry = new AlertActionEntry(alert, new DateTime(), new DateTime(), AlertActionState.SEARCH_NEEDED);, +        IndexResponse indexResponse = client().prepareIndex(AlertActionManager.ALERT_HISTORY_INDEX, AlertActionManager.ALERT_HISTORY_TYPE, entry.getId()), +                .setConsistencyLevel(WriteConsistencyLevel.ALL)]
[+++ b/rest-api-spec/test/cluster.state/20_filtering.yaml, +  - do:, +      indices.put_settings:, +        index: testidx, +        body:, +          index.blocks.read_only: false, +, +++ b/rest-api-spec/test/cluster.state/20_filtering.yaml, +  - do:, +      indices.put_settings:, +        index: testidx, +        body:, +          index.blocks.read_only: false, +, +++ b/src/main/java/org/elasticsearch/action/admin/indices/alias/exists/TransportAliasesExistAction.java, +        boolean result = state.metaData().hasAliases(request.aliases(), concreteIndices);, +++ b/rest-api-spec/test/cluster.state/20_filtering.yaml, +  - do:, +      indices.put_settings:, +        index: testidx, +        body:, +          index.blocks.read_only: false, +, +++ b/src/main/java/org/elasticsearch/action/admin/indices/alias/exists/TransportAliasesExistAction.java, +        boolean result = state.metaData().hasAliases(request.aliases(), concreteIndices);, +++ b/src/main/java/org/elasticsearch/action/admin/indices/alias/get/TransportGetAliasesAction.java, +        ImmutableOpenMap<String, List<AliasMetaData>> result = (ImmutableOpenMap) state.metaData().findAliases(request.aliases(), concreteIndices);, +++ b/rest-api-spec/test/cluster.state/20_filtering.yaml, +  - do:, +      indices.put_settings:, +        index: testidx, +        body:, +          index.blocks.read_only: false, +, +++ b/src/main/java/org/elasticsearch/action/admin/indices/alias/exists/TransportAliasesExistAction.java, +        boolean result = state.metaData().hasAliases(request.aliases(), concreteIndices);, +++ b/src/main/java/org/elasticsearch/action/admin/indices/alias/get/TransportGetAliasesAction.java, +        ImmutableOpenMap<String, List<AliasMetaData>> result = (ImmutableOpenMap) state.metaData().findAliases(request.aliases(), concreteIndices);, +++ b/src/main/java/org/elasticsearch/action/admin/indices/close/TransportCloseIndexAction.java, +        return state.blocks().indicesBlockedException(ClusterBlockLevel.METADATA, state.metaData().concreteIndices(request.indicesOptions(), request.indices()));, +        final String[] concreteIndices = state.metaData().concreteIndices(request.indicesOptions(), request.indices());, +                .indices(concreteIndices);, +                logger.debug("failed to close indices [{}]", t, concreteIndices);, +++ b/rest-api-spec/test/cluster.state/20_filtering.yaml, +  - do:, +      indices.put_settings:, +        index: testidx, +        body:, +          index.blocks.read_only: false, +, +++ b/src/main/java/org/elasticsearch/action/admin/indices/alias/exists/TransportAliasesExistAction.java, +        boolean result = state.metaData().hasAliases(request.aliases(), concreteIndices);, +++ b/src/main/java/org/elasticsearch/action/admin/indices/alias/get/TransportGetAliasesAction.java, +        ImmutableOpenMap<String, List<AliasMetaData>> result = (ImmutableOpenMap) state.metaData().findAliases(request.aliases(), concreteIndices);, +++ b/src/main/java/org/elasticsearch/action/admin/indices/close/TransportCloseIndexAction.java, +        return state.blocks().indicesBlockedException(ClusterBlockLevel.METADATA, state.metaData().concreteIndices(request.indicesOptions(), request.indices()));, +        final String[] concreteIndices = state.metaData().concreteIndices(request.indicesOptions(), request.indices());, +                .indices(concreteIndices);, +                logger.debug("failed to close indices [{}]", t, concreteIndices);, +++ b/src/main/java/org/elasticsearch/action/admin/indices/delete/TransportDeleteIndexAction.java, +        return state.blocks().indicesBlockedException(ClusterBlockLevel.METADATA, state.metaData().concreteIndices(request.indicesOptions(), request.indices()));, +        String[] concreteIndices = state.metaData().concreteIndices(request.indicesOptions(), request.indices());, +        if (concreteIndices.length == 0) {, +        final CountDown count = new CountDown(concreteIndices.length);, +        for (final String index : concreteIndices) {, +++ b/rest-api-spec/test/cluster.state/20_filtering.yaml, +  - do:, +      indices.put_settings:, +        index: testidx, +        body:, +          index.blocks.read_only: false, +, +++ b/src/main/java/org/elasticsearch/action/admin/indices/alias/exists/TransportAliasesExistAction.java, +        boolean result = state.metaData().hasAliases(request.aliases(), concreteIndices);, +++ b/src/main/java/org/elasticsearch/action/admin/indices/alias/get/TransportGetAliasesAction.java, +        ImmutableOpenMap<String, List<AliasMetaData>> result = (ImmutableOpenMap) state.metaData().findAliases(request.aliases(), concreteIndices);, +++ b/src/main/java/org/elasticsearch/action/admin/indices/close/TransportCloseIndexAction.java, +        return state.blocks().indicesBlockedException(ClusterBlockLevel.METADATA, state.metaData().concreteIndices(request.indicesOptions(), request.indices()));, +        final String[] concreteIndices = state.metaData().concreteIndices(request.indicesOptions(), request.indices());, +                .indices(concreteIndices);, +                logger.debug("failed to close indices [{}]", t, concreteIndices);, +++ b/src/main/java/org/elasticsearch/action/admin/indices/delete/TransportDeleteIndexAction.java, +        return state.blocks().indicesBlockedException(ClusterBlockLevel.METADATA, state.metaData().concreteIndices(request.indicesOptions(), request.indices()));, +        String[] concreteIndices = state.metaData().concreteIndices(request.indicesOptions(), request.indices());, +        if (concreteIndices.length == 0) {, +        final CountDown count = new CountDown(concreteIndices.length);, +        for (final String index : concreteIndices) {, +++ b/src/main/java/org/elasticsearch/action/admin/indices/exists/indices/TransportIndicesExistsAction.java, +import org.elasticsearch.action.support.IndicesOptions;, +        //make sure through indices options that the concrete indices call never throws IndexMissingException, +        IndicesOptions indicesOptions = IndicesOptions.fromOptions(true, true, request.indicesOptions().expandWildcardsOpen(), request.indicesOptions().expandWildcardsClosed());, +        return state.blocks().indicesBlockedException(ClusterBlockLevel.METADATA, clusterService.state().metaData().concreteIndices(indicesOptions, request.indices()));, +++ b/rest-api-spec/test/cluster.state/20_filtering.yaml, +  - do:, +      indices.put_settings:, +        index: testidx, +        body:, +          index.blocks.read_only: false, +, +++ b/src/main/java/org/elasticsearch/action/admin/indices/alias/exists/TransportAliasesExistAction.java]
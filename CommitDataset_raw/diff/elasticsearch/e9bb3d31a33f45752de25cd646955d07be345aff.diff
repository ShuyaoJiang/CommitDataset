[+++ b/core/src/main/java/org/elasticsearch/bootstrap/Security.java, +        addPath(policy, Environment.PATH_HOME_SETTING.getKey(), environment.binFile(), "read,readlink");, +        addPath(policy, Environment.PATH_HOME_SETTING.getKey(), environment.libFile(), "read,readlink");, +        addPath(policy, Environment.PATH_HOME_SETTING.getKey(), environment.modulesFile(), "read,readlink");, +        addPath(policy, Environment.PATH_PLUGINS_SETTING.getKey(), environment.pluginsFile(), "read,readlink");, +        addPath(policy, Environment.PATH_CONF_SETTING.getKey(), environment.configFile(), "read,readlink");, +        addPath(policy, Environment.PATH_SCRIPTS_SETTING.getKey(), environment.scriptsFile(), "read,readlink");, +        addPath(policy, Environment.PATH_LOGS_SETTING.getKey(), environment.logsFile(), "read,readlink,write,delete");, +            addPath(policy, Environment.PATH_SHARED_DATA_SETTING.getKey(), environment.sharedDataFile(), "read,readlink,write,delete");, +            addPath(policy, Environment.PATH_DATA_SETTING.getKey(), path, "read,readlink,write,delete");, +            addPath(policy, Environment.PATH_DATA_SETTING.getKey(), path, "read,readlink,write,delete");, +            addPath(policy, Environment.PATH_REPO_SETTING.getKey(), path, "read,readlink,write,delete");, +++ b/core/src/main/java/org/elasticsearch/bootstrap/Security.java, +        addPath(policy, Environment.PATH_HOME_SETTING.getKey(), environment.binFile(), "read,readlink");, +        addPath(policy, Environment.PATH_HOME_SETTING.getKey(), environment.libFile(), "read,readlink");, +        addPath(policy, Environment.PATH_HOME_SETTING.getKey(), environment.modulesFile(), "read,readlink");, +        addPath(policy, Environment.PATH_PLUGINS_SETTING.getKey(), environment.pluginsFile(), "read,readlink");, +        addPath(policy, Environment.PATH_CONF_SETTING.getKey(), environment.configFile(), "read,readlink");, +        addPath(policy, Environment.PATH_SCRIPTS_SETTING.getKey(), environment.scriptsFile(), "read,readlink");, +        addPath(policy, Environment.PATH_LOGS_SETTING.getKey(), environment.logsFile(), "read,readlink,write,delete");, +            addPath(policy, Environment.PATH_SHARED_DATA_SETTING.getKey(), environment.sharedDataFile(), "read,readlink,write,delete");, +            addPath(policy, Environment.PATH_DATA_SETTING.getKey(), path, "read,readlink,write,delete");, +            addPath(policy, Environment.PATH_DATA_SETTING.getKey(), path, "read,readlink,write,delete");, +            addPath(policy, Environment.PATH_REPO_SETTING.getKey(), path, "read,readlink,write,delete");, +++ b/core/src/main/java/org/elasticsearch/common/settings/ClusterSettings.java, +import org.elasticsearch.env.Environment;, +        Environment.PATH_CONF_SETTING,, +        Environment.PATH_DATA_SETTING,, +        Environment.PATH_HOME_SETTING,, +        Environment.PATH_LOGS_SETTING,, +        Environment.PATH_PLUGINS_SETTING,, +        Environment.PATH_REPO_SETTING,, +        Environment.PATH_SCRIPTS_SETTING,, +        Environment.PATH_SHARED_DATA_SETTING,, +        Environment.PIDFILE_SETTING, +    )));, +++ b/core/src/main/java/org/elasticsearch/bootstrap/Security.java, +        addPath(policy, Environment.PATH_HOME_SETTING.getKey(), environment.binFile(), "read,readlink");, +        addPath(policy, Environment.PATH_HOME_SETTING.getKey(), environment.libFile(), "read,readlink");, +        addPath(policy, Environment.PATH_HOME_SETTING.getKey(), environment.modulesFile(), "read,readlink");, +        addPath(policy, Environment.PATH_PLUGINS_SETTING.getKey(), environment.pluginsFile(), "read,readlink");, +        addPath(policy, Environment.PATH_CONF_SETTING.getKey(), environment.configFile(), "read,readlink");, +        addPath(policy, Environment.PATH_SCRIPTS_SETTING.getKey(), environment.scriptsFile(), "read,readlink");, +        addPath(policy, Environment.PATH_LOGS_SETTING.getKey(), environment.logsFile(), "read,readlink,write,delete");, +            addPath(policy, Environment.PATH_SHARED_DATA_SETTING.getKey(), environment.sharedDataFile(), "read,readlink,write,delete");, +            addPath(policy, Environment.PATH_DATA_SETTING.getKey(), path, "read,readlink,write,delete");, +            addPath(policy, Environment.PATH_DATA_SETTING.getKey(), path, "read,readlink,write,delete");, +            addPath(policy, Environment.PATH_REPO_SETTING.getKey(), path, "read,readlink,write,delete");, +++ b/core/src/main/java/org/elasticsearch/common/settings/ClusterSettings.java, +import org.elasticsearch.env.Environment;, +        Environment.PATH_CONF_SETTING,, +        Environment.PATH_DATA_SETTING,, +        Environment.PATH_HOME_SETTING,, +        Environment.PATH_LOGS_SETTING,, +        Environment.PATH_PLUGINS_SETTING,, +        Environment.PATH_REPO_SETTING,, +        Environment.PATH_SCRIPTS_SETTING,, +        Environment.PATH_SHARED_DATA_SETTING,, +        Environment.PIDFILE_SETTING, +    )));, +++ b/core/src/main/java/org/elasticsearch/common/settings/Setting.java, +    public static Setting<String> simpleString(String key, boolean dynamic, Scope scope) {, +        return new Setting<>(key, "", Function.identity(), dynamic, scope);, +    }, +, +++ b/core/src/main/java/org/elasticsearch/bootstrap/Security.java, +        addPath(policy, Environment.PATH_HOME_SETTING.getKey(), environment.binFile(), "read,readlink");, +        addPath(policy, Environment.PATH_HOME_SETTING.getKey(), environment.libFile(), "read,readlink");, +        addPath(policy, Environment.PATH_HOME_SETTING.getKey(), environment.modulesFile(), "read,readlink");, +        addPath(policy, Environment.PATH_PLUGINS_SETTING.getKey(), environment.pluginsFile(), "read,readlink");, +        addPath(policy, Environment.PATH_CONF_SETTING.getKey(), environment.configFile(), "read,readlink");, +        addPath(policy, Environment.PATH_SCRIPTS_SETTING.getKey(), environment.scriptsFile(), "read,readlink");, +        addPath(policy, Environment.PATH_LOGS_SETTING.getKey(), environment.logsFile(), "read,readlink,write,delete");, +            addPath(policy, Environment.PATH_SHARED_DATA_SETTING.getKey(), environment.sharedDataFile(), "read,readlink,write,delete");, +            addPath(policy, Environment.PATH_DATA_SETTING.getKey(), path, "read,readlink,write,delete");, +            addPath(policy, Environment.PATH_DATA_SETTING.getKey(), path, "read,readlink,write,delete");, +            addPath(policy, Environment.PATH_REPO_SETTING.getKey(), path, "read,readlink,write,delete");, +++ b/core/src/main/java/org/elasticsearch/common/settings/ClusterSettings.java, +import org.elasticsearch.env.Environment;, +        Environment.PATH_CONF_SETTING,, +        Environment.PATH_DATA_SETTING,, +        Environment.PATH_HOME_SETTING,, +        Environment.PATH_LOGS_SETTING,, +        Environment.PATH_PLUGINS_SETTING,, +        Environment.PATH_REPO_SETTING,, +        Environment.PATH_SCRIPTS_SETTING,, +        Environment.PATH_SHARED_DATA_SETTING,, +        Environment.PIDFILE_SETTING, +    )));, +++ b/core/src/main/java/org/elasticsearch/common/settings/Setting.java, +    public static Setting<String> simpleString(String key, boolean dynamic, Scope scope) {, +        return new Setting<>(key, "", Function.identity(), dynamic, scope);, +    }, +, +++ b/core/src/main/java/org/elasticsearch/env/Environment.java, +import org.elasticsearch.common.settings.Setting;, +import java.util.Collections;, +import java.util.List;, +import java.util.function.Function;, +    public static final Setting<String> PATH_HOME_SETTING = Setting.simpleString("path.home", false, Setting.Scope.CLUSTER);]
[+++ b/buildSrc/src/main/groovy/org/elasticsearch/gradle/plugin/PluginBuildPlugin.groovy, +            provided "log4j:log4j:${project.versions.log4j}", +            provided "log4j:apache-log4j-extras:${project.versions.log4j}", +++ b/buildSrc/src/main/groovy/org/elasticsearch/gradle/plugin/PluginBuildPlugin.groovy, +            provided "log4j:log4j:${project.versions.log4j}", +            provided "log4j:apache-log4j-extras:${project.versions.log4j}", +++ b/buildSrc/src/main/groovy/org/elasticsearch/gradle/precommit/PrecommitTasks.groovy, +            precommitTasks.add(configureLoggerUsage(project)), +++ b/buildSrc/src/main/groovy/org/elasticsearch/gradle/plugin/PluginBuildPlugin.groovy, +            provided "log4j:log4j:${project.versions.log4j}", +            provided "log4j:apache-log4j-extras:${project.versions.log4j}", +++ b/buildSrc/src/main/groovy/org/elasticsearch/gradle/precommit/PrecommitTasks.groovy, +            precommitTasks.add(configureLoggerUsage(project)), +++ b/buildSrc/version.properties, +log4j             = 1.2.17, +++ b/buildSrc/src/main/groovy/org/elasticsearch/gradle/plugin/PluginBuildPlugin.groovy, +            provided "log4j:log4j:${project.versions.log4j}", +            provided "log4j:apache-log4j-extras:${project.versions.log4j}", +++ b/buildSrc/src/main/groovy/org/elasticsearch/gradle/precommit/PrecommitTasks.groovy, +            precommitTasks.add(configureLoggerUsage(project)), +++ b/buildSrc/version.properties, +log4j             = 1.2.17, +++ b/client/benchmark/src/main/java/org/elasticsearch/client/benchmark/ops/bulk/BulkBenchmarkTask.java, +import org.elasticsearch.common.logging.ESLogger;, +        private static final ESLogger logger = ESLoggerFactory.getLogger(BulkIndexer.class.getName());, +++ b/buildSrc/src/main/groovy/org/elasticsearch/gradle/plugin/PluginBuildPlugin.groovy, +            provided "log4j:log4j:${project.versions.log4j}", +            provided "log4j:apache-log4j-extras:${project.versions.log4j}", +++ b/buildSrc/src/main/groovy/org/elasticsearch/gradle/precommit/PrecommitTasks.groovy, +            precommitTasks.add(configureLoggerUsage(project)), +++ b/buildSrc/version.properties, +log4j             = 1.2.17, +++ b/client/benchmark/src/main/java/org/elasticsearch/client/benchmark/ops/bulk/BulkBenchmarkTask.java, +import org.elasticsearch.common.logging.ESLogger;, +        private static final ESLogger logger = ESLoggerFactory.getLogger(BulkIndexer.class.getName());, +++ b/client/rest/src/main/java/org/elasticsearch/client/RestClient.java, +    private final String pathPrefix;, +               HttpHost[] hosts, String pathPrefix, FailureListener failureListener) {, +        this.pathPrefix = pathPrefix;, +        URI uri = buildUri(pathPrefix, endpoint, params);, +    private static URI buildUri(String pathPrefix, String path, Map<String, String> params) {, +            String fullPath;, +            if (pathPrefix != null) {, +                if (path.startsWith("/")) {, +                    fullPath = pathPrefix + path;, +                } else {, +                    fullPath = pathPrefix + "/" + path;, +                }, +            } else {, +                fullPath = path;, +            }, +, +            URIBuilder uriBuilder = new URIBuilder(fullPath);, +++ b/buildSrc/src/main/groovy/org/elasticsearch/gradle/plugin/PluginBuildPlugin.groovy, +            provided "log4j:log4j:${project.versions.log4j}", +            provided "log4j:apache-log4j-extras:${project.versions.log4j}", +++ b/buildSrc/src/main/groovy/org/elasticsearch/gradle/precommit/PrecommitTasks.groovy, +            precommitTasks.add(configureLoggerUsage(project)), +++ b/buildSrc/version.properties, +log4j             = 1.2.17, +++ b/client/benchmark/src/main/java/org/elasticsearch/client/benchmark/ops/bulk/BulkBenchmarkTask.java, +import org.elasticsearch.common.logging.ESLogger;, +        private static final ESLogger logger = ESLoggerFactory.getLogger(BulkIndexer.class.getName());, +++ b/client/rest/src/main/java/org/elasticsearch/client/RestClient.java, +    private final String pathPrefix;, +               HttpHost[] hosts, String pathPrefix, FailureListener failureListener) {, +        this.pathPrefix = pathPrefix;, +        URI uri = buildUri(pathPrefix, endpoint, params);, +    private static URI buildUri(String pathPrefix, String path, Map<String, String> params) {, +            String fullPath;, +            if (pathPrefix != null) {, +                if (path.startsWith("/")) {, +                    fullPath = pathPrefix + path;, +                } else {, +                    fullPath = pathPrefix + "/" + path;, +                }, +            } else {, +                fullPath = path;, +            }, +, +            URIBuilder uriBuilder = new URIBuilder(fullPath);, +++ b/client/rest/src/main/java/org/elasticsearch/client/RestClientBuilder.java, +    private String pathPrefix;, +     *, +     * @throws NullPointerException if {@code hosts} or any host is {@code null}., +     * @throws IllegalArgumentException if {@code hosts} is empty., +        Objects.requireNonNull(hosts, "hosts must not be null");, +        if (hosts.length == 0) {, +     *, +     * @throws NullPointerException if {@code defaultHeaders} or any header is {@code null}., +     *, +     * @throws NullPointerException if {@code failureListener} is {@code null}., +     * @throws IllegalArgumentException if {@code maxRetryTimeoutMillis} is not greater than 0, +     *, +     * @throws NullPointerException if {@code httpClientConfigCallback} is {@code null}., +     *, +     * @throws NullPointerException if {@code requestConfigCallback} is {@code null}., +     * Sets the path's prefix for every request used by the http client., +     * <p>, +     * For example, if this is set to "/my/path", then any client request will become <code>"/my/path/" + endpoint</code>.]
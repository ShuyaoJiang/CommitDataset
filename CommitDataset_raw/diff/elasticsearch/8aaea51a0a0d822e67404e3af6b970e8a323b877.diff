[+++ b/core/src/main/java/org/elasticsearch/action/update/UpdateHelper.java, +                ExecutableScript.Compiled compiledScript = scriptService.compile(script, ExecutableScript.UPDATE_CONTEXT);, +++ b/core/src/main/java/org/elasticsearch/action/update/UpdateHelper.java, +                ExecutableScript.Compiled compiledScript = scriptService.compile(script, ExecutableScript.UPDATE_CONTEXT);, +++ b/core/src/main/java/org/elasticsearch/index/query/InnerHitContextBuilder.java, +                    SearchScript.CONTEXT);, +++ b/core/src/main/java/org/elasticsearch/action/update/UpdateHelper.java, +                ExecutableScript.Compiled compiledScript = scriptService.compile(script, ExecutableScript.UPDATE_CONTEXT);, +++ b/core/src/main/java/org/elasticsearch/index/query/InnerHitContextBuilder.java, +                    SearchScript.CONTEXT);, +++ b/core/src/main/java/org/elasticsearch/index/query/QueryRewriteContext.java, +import org.elasticsearch.script.ExecutableScript;, +        CompiledTemplate compiledTemplate = scriptService.compileTemplate(template, ExecutableScript.CONTEXT);, +++ b/core/src/main/java/org/elasticsearch/action/update/UpdateHelper.java, +                ExecutableScript.Compiled compiledScript = scriptService.compile(script, ExecutableScript.UPDATE_CONTEXT);, +++ b/core/src/main/java/org/elasticsearch/index/query/InnerHitContextBuilder.java, +                    SearchScript.CONTEXT);, +++ b/core/src/main/java/org/elasticsearch/index/query/QueryRewriteContext.java, +import org.elasticsearch.script.ExecutableScript;, +        CompiledTemplate compiledTemplate = scriptService.compileTemplate(template, ExecutableScript.CONTEXT);, +++ b/core/src/main/java/org/elasticsearch/index/query/ScriptQueryBuilder.java, +        return new ScriptQuery(script, context.getSearchScript(script, SearchScript.CONTEXT));, +++ b/core/src/main/java/org/elasticsearch/action/update/UpdateHelper.java, +                ExecutableScript.Compiled compiledScript = scriptService.compile(script, ExecutableScript.UPDATE_CONTEXT);, +++ b/core/src/main/java/org/elasticsearch/index/query/InnerHitContextBuilder.java, +                    SearchScript.CONTEXT);, +++ b/core/src/main/java/org/elasticsearch/index/query/QueryRewriteContext.java, +import org.elasticsearch.script.ExecutableScript;, +        CompiledTemplate compiledTemplate = scriptService.compileTemplate(template, ExecutableScript.CONTEXT);, +++ b/core/src/main/java/org/elasticsearch/index/query/ScriptQueryBuilder.java, +        return new ScriptQuery(script, context.getSearchScript(script, SearchScript.CONTEXT));, +++ b/core/src/main/java/org/elasticsearch/index/query/functionscore/ScriptScoreFunctionBuilder.java, +            SearchScript searchScript = context.getSearchScript(script, SearchScript.CONTEXT);, +++ b/core/src/main/java/org/elasticsearch/action/update/UpdateHelper.java, +                ExecutableScript.Compiled compiledScript = scriptService.compile(script, ExecutableScript.UPDATE_CONTEXT);, +++ b/core/src/main/java/org/elasticsearch/index/query/InnerHitContextBuilder.java, +                    SearchScript.CONTEXT);, +++ b/core/src/main/java/org/elasticsearch/index/query/QueryRewriteContext.java, +import org.elasticsearch.script.ExecutableScript;, +        CompiledTemplate compiledTemplate = scriptService.compileTemplate(template, ExecutableScript.CONTEXT);, +++ b/core/src/main/java/org/elasticsearch/index/query/ScriptQueryBuilder.java, +        return new ScriptQuery(script, context.getSearchScript(script, SearchScript.CONTEXT));, +++ b/core/src/main/java/org/elasticsearch/index/query/functionscore/ScriptScoreFunctionBuilder.java, +            SearchScript searchScript = context.getSearchScript(script, SearchScript.CONTEXT);, +++ b/core/src/main/java/org/elasticsearch/ingest/InternalTemplateService.java, +import org.elasticsearch.script.ExecutableScript;, +            CompiledTemplate compiledTemplate = scriptService.compileTemplate(script, ExecutableScript.INGEST_CONTEXT);, +++ b/core/src/main/java/org/elasticsearch/action/update/UpdateHelper.java, +                ExecutableScript.Compiled compiledScript = scriptService.compile(script, ExecutableScript.UPDATE_CONTEXT);, +++ b/core/src/main/java/org/elasticsearch/index/query/InnerHitContextBuilder.java, +                    SearchScript.CONTEXT);, +++ b/core/src/main/java/org/elasticsearch/index/query/QueryRewriteContext.java, +import org.elasticsearch.script.ExecutableScript;, +        CompiledTemplate compiledTemplate = scriptService.compileTemplate(template, ExecutableScript.CONTEXT);, +++ b/core/src/main/java/org/elasticsearch/index/query/ScriptQueryBuilder.java, +        return new ScriptQuery(script, context.getSearchScript(script, SearchScript.CONTEXT));, +++ b/core/src/main/java/org/elasticsearch/index/query/functionscore/ScriptScoreFunctionBuilder.java, +            SearchScript searchScript = context.getSearchScript(script, SearchScript.CONTEXT);, +++ b/core/src/main/java/org/elasticsearch/ingest/InternalTemplateService.java, +import org.elasticsearch.script.ExecutableScript;, +            CompiledTemplate compiledTemplate = scriptService.compileTemplate(script, ExecutableScript.INGEST_CONTEXT);, +++ b/core/src/main/java/org/elasticsearch/script/ExecutableScript.java, +, +    ScriptContext<Compiled> CONTEXT = new ScriptContext<>("executable", Compiled.class);, +, +    // TODO: remove these once each has its own script interface, +    ScriptContext<Compiled> AGGS_CONTEXT = new ScriptContext<>("aggs_executable", Compiled.class);, +    ScriptContext<Compiled> UPDATE_CONTEXT = new ScriptContext<>("update", Compiled.class);, +    ScriptContext<Compiled> INGEST_CONTEXT = new ScriptContext<>("ingest", Compiled.class);, +++ b/core/src/main/java/org/elasticsearch/action/update/UpdateHelper.java, +                ExecutableScript.Compiled compiledScript = scriptService.compile(script, ExecutableScript.UPDATE_CONTEXT);, +++ b/core/src/main/java/org/elasticsearch/index/query/InnerHitContextBuilder.java, +                    SearchScript.CONTEXT);, +++ b/core/src/main/java/org/elasticsearch/index/query/QueryRewriteContext.java, +import org.elasticsearch.script.ExecutableScript;, +        CompiledTemplate compiledTemplate = scriptService.compileTemplate(template, ExecutableScript.CONTEXT);, +++ b/core/src/main/java/org/elasticsearch/index/query/ScriptQueryBuilder.java, +        return new ScriptQuery(script, context.getSearchScript(script, SearchScript.CONTEXT));, +++ b/core/src/main/java/org/elasticsearch/index/query/functionscore/ScriptScoreFunctionBuilder.java, +            SearchScript searchScript = context.getSearchScript(script, SearchScript.CONTEXT);, +++ b/core/src/main/java/org/elasticsearch/ingest/InternalTemplateService.java, +import org.elasticsearch.script.ExecutableScript;, +            CompiledTemplate compiledTemplate = scriptService.compileTemplate(script, ExecutableScript.INGEST_CONTEXT);, +++ b/core/src/main/java/org/elasticsearch/script/ExecutableScript.java, +, +    ScriptContext<Compiled> CONTEXT = new ScriptContext<>("executable", Compiled.class);, +, +    // TODO: remove these once each has its own script interface, +    ScriptContext<Compiled> AGGS_CONTEXT = new ScriptContext<>("aggs_executable", Compiled.class);, +    ScriptContext<Compiled> UPDATE_CONTEXT = new ScriptContext<>("update", Compiled.class);, +    ScriptContext<Compiled> INGEST_CONTEXT = new ScriptContext<>("ingest", Compiled.class);, +++ b/core/src/main/java/org/elasticsearch/script/ScriptContext.java, +++ b/core/src/main/java/org/elasticsearch/action/update/UpdateHelper.java, +                ExecutableScript.Compiled compiledScript = scriptService.compile(script, ExecutableScript.UPDATE_CONTEXT);, +++ b/core/src/main/java/org/elasticsearch/index/query/InnerHitContextBuilder.java, +                    SearchScript.CONTEXT);, +++ b/core/src/main/java/org/elasticsearch/index/query/QueryRewriteContext.java, +import org.elasticsearch.script.ExecutableScript;, +        CompiledTemplate compiledTemplate = scriptService.compileTemplate(template, ExecutableScript.CONTEXT);, +++ b/core/src/main/java/org/elasticsearch/index/query/ScriptQueryBuilder.java]
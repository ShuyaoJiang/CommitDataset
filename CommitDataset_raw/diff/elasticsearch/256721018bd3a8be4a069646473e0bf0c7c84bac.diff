[+++ b/core/src/main/java/org/elasticsearch/action/resync/TransportResyncReplicationAction.java, +import org.elasticsearch.index.seqno.SequenceNumbers;, +            final long pre60NodeCheckpoint = SequenceNumbers.PRE_60_NODE_CHECKPOINT;, +++ b/core/src/main/java/org/elasticsearch/action/resync/TransportResyncReplicationAction.java, +import org.elasticsearch.index.seqno.SequenceNumbers;, +            final long pre60NodeCheckpoint = SequenceNumbers.PRE_60_NODE_CHECKPOINT;, +++ b/core/src/main/java/org/elasticsearch/action/support/replication/TransportReplicationAction.java, +                localCheckpoint = SequenceNumbers.PRE_60_NODE_CHECKPOINT;, +                globalCheckpoint = SequenceNumbers.PRE_60_NODE_CHECKPOINT;, +++ b/core/src/main/java/org/elasticsearch/action/resync/TransportResyncReplicationAction.java, +import org.elasticsearch.index.seqno.SequenceNumbers;, +            final long pre60NodeCheckpoint = SequenceNumbers.PRE_60_NODE_CHECKPOINT;, +++ b/core/src/main/java/org/elasticsearch/action/support/replication/TransportReplicationAction.java, +                localCheckpoint = SequenceNumbers.PRE_60_NODE_CHECKPOINT;, +                globalCheckpoint = SequenceNumbers.PRE_60_NODE_CHECKPOINT;, +++ b/core/src/main/java/org/elasticsearch/index/seqno/GlobalCheckpointSyncAction.java, +            final long pre60NodeCheckpoint = SequenceNumbers.PRE_60_NODE_CHECKPOINT;, +++ b/core/src/main/java/org/elasticsearch/action/resync/TransportResyncReplicationAction.java, +import org.elasticsearch.index.seqno.SequenceNumbers;, +            final long pre60NodeCheckpoint = SequenceNumbers.PRE_60_NODE_CHECKPOINT;, +++ b/core/src/main/java/org/elasticsearch/action/support/replication/TransportReplicationAction.java, +                localCheckpoint = SequenceNumbers.PRE_60_NODE_CHECKPOINT;, +                globalCheckpoint = SequenceNumbers.PRE_60_NODE_CHECKPOINT;, +++ b/core/src/main/java/org/elasticsearch/index/seqno/GlobalCheckpointSyncAction.java, +            final long pre60NodeCheckpoint = SequenceNumbers.PRE_60_NODE_CHECKPOINT;, +++ b/core/src/main/java/org/elasticsearch/index/seqno/GlobalCheckpointTracker.java, +                lcps.localCheckpoint == SequenceNumbers.PRE_60_NODE_CHECKPOINT);, +                                || cps.globalCheckpoint == SequenceNumbers.PRE_60_NODE_CHECKPOINT));, +                                .filter(v -> v != SequenceNumbers.PRE_60_NODE_CHECKPOINT && v != SequenceNumbers.UNASSIGNED_SEQ_NO));, +                            SequenceNumbers.PRE_60_NODE_CHECKPOINT : SequenceNumbers.UNASSIGNED_SEQ_NO;, +                            SequenceNumbers.PRE_60_NODE_CHECKPOINT : SequenceNumbers.UNASSIGNED_SEQ_NO;, +                            SequenceNumbers.PRE_60_NODE_CHECKPOINT : SequenceNumbers.UNASSIGNED_SEQ_NO;, +        assert cps.localCheckpoint != SequenceNumbers.PRE_60_NODE_CHECKPOINT ||, +            localCheckpoint == SequenceNumbers.PRE_60_NODE_CHECKPOINT :, +                } else if (cps.localCheckpoint == SequenceNumbers.PRE_60_NODE_CHECKPOINT) {, +                cps.localCheckpoint != SequenceNumbers.PRE_60_NODE_CHECKPOINT) {, +                    cps.globalCheckpoint != SequenceNumbers.PRE_60_NODE_CHECKPOINT) {, +            if (entry.getValue().getLocalCheckpoint() == SequenceNumbers.PRE_60_NODE_CHECKPOINT) {, +++ b/core/src/main/java/org/elasticsearch/action/resync/TransportResyncReplicationAction.java, +import org.elasticsearch.index.seqno.SequenceNumbers;, +            final long pre60NodeCheckpoint = SequenceNumbers.PRE_60_NODE_CHECKPOINT;, +++ b/core/src/main/java/org/elasticsearch/action/support/replication/TransportReplicationAction.java, +                localCheckpoint = SequenceNumbers.PRE_60_NODE_CHECKPOINT;, +                globalCheckpoint = SequenceNumbers.PRE_60_NODE_CHECKPOINT;, +++ b/core/src/main/java/org/elasticsearch/index/seqno/GlobalCheckpointSyncAction.java, +            final long pre60NodeCheckpoint = SequenceNumbers.PRE_60_NODE_CHECKPOINT;, +++ b/core/src/main/java/org/elasticsearch/index/seqno/GlobalCheckpointTracker.java, +                lcps.localCheckpoint == SequenceNumbers.PRE_60_NODE_CHECKPOINT);, +                                || cps.globalCheckpoint == SequenceNumbers.PRE_60_NODE_CHECKPOINT));, +                                .filter(v -> v != SequenceNumbers.PRE_60_NODE_CHECKPOINT && v != SequenceNumbers.UNASSIGNED_SEQ_NO));, +                            SequenceNumbers.PRE_60_NODE_CHECKPOINT : SequenceNumbers.UNASSIGNED_SEQ_NO;, +                            SequenceNumbers.PRE_60_NODE_CHECKPOINT : SequenceNumbers.UNASSIGNED_SEQ_NO;, +                            SequenceNumbers.PRE_60_NODE_CHECKPOINT : SequenceNumbers.UNASSIGNED_SEQ_NO;, +        assert cps.localCheckpoint != SequenceNumbers.PRE_60_NODE_CHECKPOINT ||, +            localCheckpoint == SequenceNumbers.PRE_60_NODE_CHECKPOINT :, +                } else if (cps.localCheckpoint == SequenceNumbers.PRE_60_NODE_CHECKPOINT) {, +                cps.localCheckpoint != SequenceNumbers.PRE_60_NODE_CHECKPOINT) {, +                    cps.globalCheckpoint != SequenceNumbers.PRE_60_NODE_CHECKPOINT) {, +            if (entry.getValue().getLocalCheckpoint() == SequenceNumbers.PRE_60_NODE_CHECKPOINT) {, +++ b/core/src/main/java/org/elasticsearch/index/seqno/SequenceNumbers.java, +     * Represents a checkpoint coming from a pre-6.0 node, +     */, +    public static final long PRE_60_NODE_CHECKPOINT = -3L;, +    /**, +++ b/core/src/main/java/org/elasticsearch/action/resync/TransportResyncReplicationAction.java, +import org.elasticsearch.index.seqno.SequenceNumbers;, +            final long pre60NodeCheckpoint = SequenceNumbers.PRE_60_NODE_CHECKPOINT;, +++ b/core/src/main/java/org/elasticsearch/action/support/replication/TransportReplicationAction.java, +                localCheckpoint = SequenceNumbers.PRE_60_NODE_CHECKPOINT;, +                globalCheckpoint = SequenceNumbers.PRE_60_NODE_CHECKPOINT;, +++ b/core/src/main/java/org/elasticsearch/index/seqno/GlobalCheckpointSyncAction.java, +            final long pre60NodeCheckpoint = SequenceNumbers.PRE_60_NODE_CHECKPOINT;, +++ b/core/src/main/java/org/elasticsearch/index/seqno/GlobalCheckpointTracker.java, +                lcps.localCheckpoint == SequenceNumbers.PRE_60_NODE_CHECKPOINT);, +                                || cps.globalCheckpoint == SequenceNumbers.PRE_60_NODE_CHECKPOINT));, +                                .filter(v -> v != SequenceNumbers.PRE_60_NODE_CHECKPOINT && v != SequenceNumbers.UNASSIGNED_SEQ_NO));, +                            SequenceNumbers.PRE_60_NODE_CHECKPOINT : SequenceNumbers.UNASSIGNED_SEQ_NO;, +                            SequenceNumbers.PRE_60_NODE_CHECKPOINT : SequenceNumbers.UNASSIGNED_SEQ_NO;, +                            SequenceNumbers.PRE_60_NODE_CHECKPOINT : SequenceNumbers.UNASSIGNED_SEQ_NO;, +        assert cps.localCheckpoint != SequenceNumbers.PRE_60_NODE_CHECKPOINT ||, +            localCheckpoint == SequenceNumbers.PRE_60_NODE_CHECKPOINT :, +                } else if (cps.localCheckpoint == SequenceNumbers.PRE_60_NODE_CHECKPOINT) {, +                cps.localCheckpoint != SequenceNumbers.PRE_60_NODE_CHECKPOINT) {, +                    cps.globalCheckpoint != SequenceNumbers.PRE_60_NODE_CHECKPOINT) {, +            if (entry.getValue().getLocalCheckpoint() == SequenceNumbers.PRE_60_NODE_CHECKPOINT) {, +++ b/core/src/main/java/org/elasticsearch/index/seqno/SequenceNumbers.java, +     * Represents a checkpoint coming from a pre-6.0 node, +     */, +    public static final long PRE_60_NODE_CHECKPOINT = -3L;, +    /**, +++ b/core/src/main/java/org/elasticsearch/index/seqno/SequenceNumbersService.java]
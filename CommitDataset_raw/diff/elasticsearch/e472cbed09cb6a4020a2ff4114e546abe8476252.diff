[+++ b/core/src/main/java/org/elasticsearch/bootstrap/Security.java, +        // read-only dirs, +        addPath(policy, environment.binFile(), "read,readlink");, +        addPath(policy, environment.libFile(), "read,readlink");, +++ b/core/src/main/java/org/elasticsearch/bootstrap/Security.java, +        // read-only dirs, +        addPath(policy, environment.binFile(), "read,readlink");, +        addPath(policy, environment.libFile(), "read,readlink");, +++ b/core/src/main/java/org/elasticsearch/env/Environment.java, +    /** location of bin/, used by plugin manager */, +    private final Path binFile;, +, +    /** location of lib/, */, +    private final Path libFile;, +, +        final Path homeFile;, +, +        binFile = homeFile.resolve("bin");, +        libFile = homeFile.resolve("lib");, +    public Path binFile() {, +        return binFile;, +    }, +, +    public Path libFile() {, +        return libFile;, +    }, +, +++ b/core/src/main/java/org/elasticsearch/bootstrap/Security.java, +        // read-only dirs, +        addPath(policy, environment.binFile(), "read,readlink");, +        addPath(policy, environment.libFile(), "read,readlink");, +++ b/core/src/main/java/org/elasticsearch/env/Environment.java, +    /** location of bin/, used by plugin manager */, +    private final Path binFile;, +, +    /** location of lib/, */, +    private final Path libFile;, +, +        final Path homeFile;, +, +        binFile = homeFile.resolve("bin");, +        libFile = homeFile.resolve("lib");, +    public Path binFile() {, +        return binFile;, +    }, +, +    public Path libFile() {, +        return libFile;, +    }, +, +++ b/core/src/main/java/org/elasticsearch/node/Node.java, +            logger.debug("using config [{}], data [{}], logs [{}], plugins [{}]",, +                    env.configFile(), Arrays.toString(env.dataFiles()), env.logsFile(), env.pluginsFile());, +++ b/core/src/main/java/org/elasticsearch/bootstrap/Security.java, +        // read-only dirs, +        addPath(policy, environment.binFile(), "read,readlink");, +        addPath(policy, environment.libFile(), "read,readlink");, +++ b/core/src/main/java/org/elasticsearch/env/Environment.java, +    /** location of bin/, used by plugin manager */, +    private final Path binFile;, +, +    /** location of lib/, */, +    private final Path libFile;, +, +        final Path homeFile;, +, +        binFile = homeFile.resolve("bin");, +        libFile = homeFile.resolve("lib");, +    public Path binFile() {, +        return binFile;, +    }, +, +    public Path libFile() {, +        return libFile;, +    }, +, +++ b/core/src/main/java/org/elasticsearch/node/Node.java, +            logger.debug("using config [{}], data [{}], logs [{}], plugins [{}]",, +                    env.configFile(), Arrays.toString(env.dataFiles()), env.logsFile(), env.pluginsFile());, +++ b/core/src/main/java/org/elasticsearch/plugins/PluginManager.java, +            return env.binFile().resolve(name);, +++ b/core/src/main/java/org/elasticsearch/bootstrap/Security.java, +        // read-only dirs, +        addPath(policy, environment.binFile(), "read,readlink");, +        addPath(policy, environment.libFile(), "read,readlink");, +++ b/core/src/main/java/org/elasticsearch/env/Environment.java, +    /** location of bin/, used by plugin manager */, +    private final Path binFile;, +, +    /** location of lib/, */, +    private final Path libFile;, +, +        final Path homeFile;, +, +        binFile = homeFile.resolve("bin");, +        libFile = homeFile.resolve("lib");, +    public Path binFile() {, +        return binFile;, +    }, +]
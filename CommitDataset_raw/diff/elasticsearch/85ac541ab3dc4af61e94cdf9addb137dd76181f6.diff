[+++ b/build.gradle, +  version = VersionProperties.elasticsearch.toString(), +if (versions.currentVersion != VersionProperties.elasticsearch) {, +      String artifactsHost = VersionProperties.elasticsearch.toString().endsWith("-SNAPSHOT") ? "https://snapshots.elastic.co" : "https://artifacts.elastic.co", +++ b/build.gradle, +  version = VersionProperties.elasticsearch.toString(), +if (versions.currentVersion != VersionProperties.elasticsearch) {, +      String artifactsHost = VersionProperties.elasticsearch.toString().endsWith("-SNAPSHOT") ? "https://snapshots.elastic.co" : "https://artifacts.elastic.co", +++ b/buildSrc/src/main/groovy/org/elasticsearch/gradle/BuildPlugin.groovy, +                final Version versionWithoutSnapshot = new Version(, +                        VersionProperties.elasticsearch.major,, +                        VersionProperties.elasticsearch.minor,, +                        VersionProperties.elasticsearch.revision,, +                        VersionProperties.elasticsearch.suffix,, +                        false), +                        'X-Compile-Elasticsearch-Version': versionWithoutSnapshot,, +                        'X-Compile-Elasticsearch-Snapshot': VersionProperties.elasticsearch.isSnapshot(),, +++ b/build.gradle, +  version = VersionProperties.elasticsearch.toString(), +if (versions.currentVersion != VersionProperties.elasticsearch) {, +      String artifactsHost = VersionProperties.elasticsearch.toString().endsWith("-SNAPSHOT") ? "https://snapshots.elastic.co" : "https://artifacts.elastic.co", +++ b/buildSrc/src/main/groovy/org/elasticsearch/gradle/BuildPlugin.groovy, +                final Version versionWithoutSnapshot = new Version(, +                        VersionProperties.elasticsearch.major,, +                        VersionProperties.elasticsearch.minor,, +                        VersionProperties.elasticsearch.revision,, +                        VersionProperties.elasticsearch.suffix,, +                        false), +                        'X-Compile-Elasticsearch-Version': versionWithoutSnapshot,, +                        'X-Compile-Elasticsearch-Snapshot': VersionProperties.elasticsearch.isSnapshot(),, +++ b/buildSrc/src/main/groovy/org/elasticsearch/gradle/Version.groovy, +    public boolean before(Version compareTo) {, +        return id < compareTo.id, +    }, +, +        return before(fromString(compareTo)), +    }, +, +    public boolean onOrBefore(Version compareTo) {, +        return id <= compareTo.id, +        return onOrBefore(fromString(compareTo)), +    }, +, +    public boolean onOrAfter(Version compareTo) {, +        return id >= compareTo.id, +        return onOrAfter(fromString(compareTo)), +    }, +, +    public boolean after(Version compareTo) {, +        return id > compareTo.id, +        return after(fromString(compareTo)), +++ b/build.gradle, +  version = VersionProperties.elasticsearch.toString(), +if (versions.currentVersion != VersionProperties.elasticsearch) {, +      String artifactsHost = VersionProperties.elasticsearch.toString().endsWith("-SNAPSHOT") ? "https://snapshots.elastic.co" : "https://artifacts.elastic.co", +++ b/buildSrc/src/main/groovy/org/elasticsearch/gradle/BuildPlugin.groovy, +                final Version versionWithoutSnapshot = new Version(, +                        VersionProperties.elasticsearch.major,, +                        VersionProperties.elasticsearch.minor,, +                        VersionProperties.elasticsearch.revision,, +                        VersionProperties.elasticsearch.suffix,, +                        false), +                        'X-Compile-Elasticsearch-Version': versionWithoutSnapshot,, +                        'X-Compile-Elasticsearch-Snapshot': VersionProperties.elasticsearch.isSnapshot(),, +++ b/buildSrc/src/main/groovy/org/elasticsearch/gradle/Version.groovy, +    public boolean before(Version compareTo) {, +        return id < compareTo.id, +    }, +, +        return before(fromString(compareTo)), +    }, +, +    public boolean onOrBefore(Version compareTo) {, +        return id <= compareTo.id, +        return onOrBefore(fromString(compareTo)), +    }, +, +    public boolean onOrAfter(Version compareTo) {, +        return id >= compareTo.id, +        return onOrAfter(fromString(compareTo)), +    }, +, +    public boolean after(Version compareTo) {, +        return id > compareTo.id, +        return after(fromString(compareTo)), +++ b/buildSrc/src/main/groovy/org/elasticsearch/gradle/VersionProperties.groovy, +    static final Version elasticsearch, +        elasticsearch = Version.fromString(props.getProperty('elasticsearch')), +++ b/build.gradle, +  version = VersionProperties.elasticsearch.toString(), +if (versions.currentVersion != VersionProperties.elasticsearch) {, +      String artifactsHost = VersionProperties.elasticsearch.toString().endsWith("-SNAPSHOT") ? "https://snapshots.elastic.co" : "https://artifacts.elastic.co", +++ b/buildSrc/src/main/groovy/org/elasticsearch/gradle/BuildPlugin.groovy, +                final Version versionWithoutSnapshot = new Version(, +                        VersionProperties.elasticsearch.major,, +                        VersionProperties.elasticsearch.minor,, +                        VersionProperties.elasticsearch.revision,, +                        VersionProperties.elasticsearch.suffix,, +                        false), +                        'X-Compile-Elasticsearch-Version': versionWithoutSnapshot,]
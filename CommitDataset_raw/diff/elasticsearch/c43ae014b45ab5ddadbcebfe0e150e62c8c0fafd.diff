[+++ b/plugin/src/main/java/org/elasticsearch/xpack/ml/job/process/logging/CppLogMessage.java, +            LOGGER_FIELD.getPreferredName(), () -> new CppLogMessage(Instant.now()));, +    public CppLogMessage(Instant timestamp) {, +        this.timestamp = timestamp;, +++ b/plugin/src/main/java/org/elasticsearch/xpack/ml/job/process/logging/CppLogMessage.java, +            LOGGER_FIELD.getPreferredName(), () -> new CppLogMessage(Instant.now()));, +    public CppLogMessage(Instant timestamp) {, +        this.timestamp = timestamp;, +++ b/plugin/src/test/java/org/elasticsearch/xpack/ml/job/process/logging/CppLogMessageTests.java, +import org.elasticsearch.common.xcontent.NamedXContentRegistry;, +import org.elasticsearch.common.xcontent.XContent;, +import org.elasticsearch.common.xcontent.XContentFactory;, +import org.elasticsearch.common.xcontent.XContentType;, +import java.io.IOException;, +import java.time.Instant;, +, +        CppLogMessage msg = new CppLogMessage(Instant.ofEpochSecond(1494422876L));, +        assertEquals(Instant.ofEpochSecond(1494422876L), msg.getTimestamp());, +    public void testParseWithMissingTimestamp() throws IOException {, +        XContent xContent = XContentFactory.xContent(XContentType.JSON);, +        Instant before = Instant.now();, +, +        String input = "{\"logger\":\"controller\",\"level\":\"INFO\",", +                + "\"pid\":42,\"thread\":\"0x7fff7d2a8000\",\"message\":\"message 1\",\"class\":\"ml\",", +                + "\"method\":\"core::SomeNoiseMaker\",\"file\":\"Noisemaker.cc\",\"line\":333}\n";, +        XContentParser parser = xContent.createParser(NamedXContentRegistry.EMPTY, input);, +        CppLogMessage msg = CppLogMessage.PARSER.apply(parser, null);, +, +        Instant after = Instant.now();, +        assertTrue(before.isBefore(msg.getTimestamp()) || before.equals(msg.getTimestamp()));, +        assertTrue(after.isAfter(msg.getTimestamp()) || after.equals(msg.getTimestamp()));, +    }, +, +        CppLogMessage msg = new CppLogMessage(Instant.ofEpochSecond(1494422876L));]
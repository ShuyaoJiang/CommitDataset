[+++ b/modules/elasticsearch/src/main/java/org/elasticsearch/gateway/GatewayService.java, +                    boolean ignoreRecoverAfterTime;, +                        ignoreRecoverAfterTime = false;, +                        ignoreRecoverAfterTime = true;, +                            ignoreRecoverAfterTime = false;, +                            ignoreRecoverAfterTime = false;, +                            ignoreRecoverAfterTime = false;, +                    performStateRecovery(ignoreRecoverAfterTime);, +        if (lifecycle.stoppedOrClosed()) {, +                boolean ignoreRecoverAfterTime;, +                    ignoreRecoverAfterTime = false;, +                    ignoreRecoverAfterTime = true;, +                        ignoreRecoverAfterTime = false;, +                        ignoreRecoverAfterTime = false;, +                        ignoreRecoverAfterTime = false;, +                final boolean fIgnoreRecoverAfterTime = ignoreRecoverAfterTime;, +                        performStateRecovery(fIgnoreRecoverAfterTime);, +    private void performStateRecovery(boolean ignoreRecoverAfterTime) {, +        final Gateway.GatewayStateRecoveredListener recoveryListener = new GatewayRecoveryListener(new CountDownLatch(1));, +        if (!ignoreRecoverAfterTime && recoverAfterTime != null) {]
[+++ b/modules/elasticsearch/src/main/java/org/elasticsearch/search/facet/datehistogram/InternalCountAndTotalDateHistogramFacet.java, +import java.util.Arrays;, +    CountAndTotalEntry[] entries = null;, +        return Arrays.asList(computeEntries());, +        return (Iterator) entries().iterator();, +    private CountAndTotalEntry[] computeEntries() {, +        entries = new CountAndTotalEntry[counts.size()];, +        int i = 0;, +            entries[i++] = new CountAndTotalEntry(it.key(), it.value(), totals.get(it.key()));, +        Arrays.sort(entries, comparatorType.comparator());, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/search/facet/datehistogram/InternalCountAndTotalDateHistogramFacet.java, +import java.util.Arrays;, +    CountAndTotalEntry[] entries = null;, +        return Arrays.asList(computeEntries());, +        return (Iterator) entries().iterator();, +    private CountAndTotalEntry[] computeEntries() {, +        entries = new CountAndTotalEntry[counts.size()];, +        int i = 0;, +            entries[i++] = new CountAndTotalEntry(it.key(), it.value(), totals.get(it.key()));, +        Arrays.sort(entries, comparatorType.comparator());, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/search/facet/datehistogram/InternalCountDateHistogramFacet.java, +import java.util.Arrays;, +    CountEntry[] entries = null;, +        return Arrays.asList(computeEntries());, +        return (Iterator) entries().iterator();, +    private CountEntry[] computeEntries() {, +        entries = new CountEntry[counts.size()];, +        int i = 0;, +            entries[i++] = new CountEntry(it.key(), it.value());, +        Arrays.sort(entries, comparatorType.comparator());, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/search/facet/datehistogram/InternalCountAndTotalDateHistogramFacet.java, +import java.util.Arrays;, +    CountAndTotalEntry[] entries = null;, +        return Arrays.asList(computeEntries());, +        return (Iterator) entries().iterator();, +    private CountAndTotalEntry[] computeEntries() {, +        entries = new CountAndTotalEntry[counts.size()];, +        int i = 0;, +            entries[i++] = new CountAndTotalEntry(it.key(), it.value(), totals.get(it.key()));, +        Arrays.sort(entries, comparatorType.comparator());, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/search/facet/datehistogram/InternalCountDateHistogramFacet.java, +import java.util.Arrays;, +    CountEntry[] entries = null;, +        return Arrays.asList(computeEntries());, +        return (Iterator) entries().iterator();, +    private CountEntry[] computeEntries() {, +        entries = new CountEntry[counts.size()];, +        int i = 0;, +            entries[i++] = new CountEntry(it.key(), it.value());, +        Arrays.sort(entries, comparatorType.comparator());, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/search/facet/datehistogram/ValueScriptDateHistogramFacetCollector.java, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/search/facet/datehistogram/InternalCountAndTotalDateHistogramFacet.java, +import java.util.Arrays;, +    CountAndTotalEntry[] entries = null;, +        return Arrays.asList(computeEntries());, +        return (Iterator) entries().iterator();, +    private CountAndTotalEntry[] computeEntries() {, +        entries = new CountAndTotalEntry[counts.size()];, +        int i = 0;, +            entries[i++] = new CountAndTotalEntry(it.key(), it.value(), totals.get(it.key()));, +        Arrays.sort(entries, comparatorType.comparator());, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/search/facet/datehistogram/InternalCountDateHistogramFacet.java, +import java.util.Arrays;, +    CountEntry[] entries = null;, +        return Arrays.asList(computeEntries());, +        return (Iterator) entries().iterator();, +    private CountEntry[] computeEntries() {, +        entries = new CountEntry[counts.size()];, +        int i = 0;, +            entries[i++] = new CountEntry(it.key(), it.value());, +        Arrays.sort(entries, comparatorType.comparator());, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/search/facet/datehistogram/ValueScriptDateHistogramFacetCollector.java, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/search/facet/histogram/InternalCountAndTotalHistogramFacet.java, +import java.util.Arrays;, +    CountAndTotalEntry[] entries = null;, +        return Arrays.asList(computeEntries());, +        return (Iterator) entries().iterator();, +    private CountAndTotalEntry[] computeEntries() {, +        entries = new CountAndTotalEntry[counts.size()];, +        int i = 0;, +            entries[i++] = new CountAndTotalEntry(it.key(), it.value(), totals.get(it.key()));, +        Arrays.sort(entries, comparatorType.comparator());, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/search/facet/datehistogram/InternalCountAndTotalDateHistogramFacet.java, +import java.util.Arrays;, +    CountAndTotalEntry[] entries = null;, +        return Arrays.asList(computeEntries());, +        return (Iterator) entries().iterator();, +    private CountAndTotalEntry[] computeEntries() {, +        entries = new CountAndTotalEntry[counts.size()];, +        int i = 0;, +            entries[i++] = new CountAndTotalEntry(it.key(), it.value(), totals.get(it.key()));, +        Arrays.sort(entries, comparatorType.comparator());, +++ b/modules/elasticsearch/src/main/java/org/elasticsearch/search/facet/datehistogram/InternalCountDateHistogramFacet.java, +import java.util.Arrays;, +    CountEntry[] entries = null;, +        return Arrays.asList(computeEntries());, +        return (Iterator) entries().iterator();, +    private CountEntry[] computeEntries() {, +        entries = new CountEntry[counts.size()];, +        int i = 0;]
[+++ b/server/src/main/java/org/elasticsearch/cluster/action/shard/ShardStateAction.java, +            if (in.getVersion().onOrAfter(Version.V_6_3_0)) {, +            if (out.getVersion().onOrAfter(Version.V_6_3_0)) {, +            if (in.getVersion().before(Version.V_6_3_0)) {, +            if (in.getVersion().before(Version.V_6_3_0)) {, +            if (out.getVersion().before(Version.V_6_3_0)) {, +            if (out.getVersion().before(Version.V_6_3_0)) {, +++ b/server/src/main/java/org/elasticsearch/cluster/action/shard/ShardStateAction.java, +            if (in.getVersion().onOrAfter(Version.V_6_3_0)) {, +            if (out.getVersion().onOrAfter(Version.V_6_3_0)) {, +            if (in.getVersion().before(Version.V_6_3_0)) {, +            if (in.getVersion().before(Version.V_6_3_0)) {, +            if (out.getVersion().before(Version.V_6_3_0)) {, +            if (out.getVersion().before(Version.V_6_3_0)) {, +++ b/server/src/test/java/org/elasticsearch/cluster/action/shard/ShardStateActionTests.java, +            version -> version.onOrAfter(Version.V_6_3_0), () -> VersionUtils.randomVersion(random()));]
[+++ b/modules/percolator/src/main/java/org/elasticsearch/percolator/PercolateQueryBuilder.java, +        this(field, documentType, Collections.singletonList(document), XContentHelper.xContentType(document));, +                documentXContentType = XContentHelper.xContentType(documents.iterator().next());, +                    XContentHelper.xContentType(source));, +++ b/modules/percolator/src/main/java/org/elasticsearch/percolator/PercolateQueryBuilder.java, +        this(field, documentType, Collections.singletonList(document), XContentHelper.xContentType(document));, +                documentXContentType = XContentHelper.xContentType(documents.iterator().next());, +                    XContentHelper.xContentType(source));, +++ b/server/src/main/java/org/elasticsearch/action/admin/cluster/storedscripts/PutStoredScriptRequest.java, +            xContentType = XContentHelper.xContentType(content);, +++ b/modules/percolator/src/main/java/org/elasticsearch/percolator/PercolateQueryBuilder.java, +        this(field, documentType, Collections.singletonList(document), XContentHelper.xContentType(document));, +                documentXContentType = XContentHelper.xContentType(documents.iterator().next());, +                    XContentHelper.xContentType(source));, +++ b/server/src/main/java/org/elasticsearch/action/admin/cluster/storedscripts/PutStoredScriptRequest.java, +            xContentType = XContentHelper.xContentType(content);, +++ b/server/src/main/java/org/elasticsearch/action/ingest/PutPipelineRequest.java, +import org.elasticsearch.common.xcontent.XContentHelper;, +        this(id, source, XContentHelper.xContentType(source));, +            xContentType = XContentHelper.xContentType(source);, +++ b/modules/percolator/src/main/java/org/elasticsearch/percolator/PercolateQueryBuilder.java, +        this(field, documentType, Collections.singletonList(document), XContentHelper.xContentType(document));, +                documentXContentType = XContentHelper.xContentType(documents.iterator().next());, +                    XContentHelper.xContentType(source));, +++ b/server/src/main/java/org/elasticsearch/action/admin/cluster/storedscripts/PutStoredScriptRequest.java, +            xContentType = XContentHelper.xContentType(content);, +++ b/server/src/main/java/org/elasticsearch/action/ingest/PutPipelineRequest.java, +import org.elasticsearch.common.xcontent.XContentHelper;, +        this(id, source, XContentHelper.xContentType(source));, +            xContentType = XContentHelper.xContentType(source);, +++ b/server/src/main/java/org/elasticsearch/action/ingest/SimulatePipelineRequest.java, +import org.elasticsearch.common.xcontent.XContentHelper;, +        this(source, XContentHelper.xContentType(source));, +            xContentType = XContentHelper.xContentType(source);, +++ b/modules/percolator/src/main/java/org/elasticsearch/percolator/PercolateQueryBuilder.java, +        this(field, documentType, Collections.singletonList(document), XContentHelper.xContentType(document));, +                documentXContentType = XContentHelper.xContentType(documents.iterator().next());, +                    XContentHelper.xContentType(source));, +++ b/server/src/main/java/org/elasticsearch/action/admin/cluster/storedscripts/PutStoredScriptRequest.java, +            xContentType = XContentHelper.xContentType(content);, +++ b/server/src/main/java/org/elasticsearch/action/ingest/PutPipelineRequest.java, +import org.elasticsearch.common.xcontent.XContentHelper;, +        this(id, source, XContentHelper.xContentType(source));, +            xContentType = XContentHelper.xContentType(source);, +++ b/server/src/main/java/org/elasticsearch/action/ingest/SimulatePipelineRequest.java, +import org.elasticsearch.common.xcontent.XContentHelper;, +        this(source, XContentHelper.xContentType(source));, +            xContentType = XContentHelper.xContentType(source);, +++ b/server/src/main/java/org/elasticsearch/action/termvectors/TermVectorsRequest.java, +import org.elasticsearch.common.xcontent.XContentHelper;, +        return this.doc(doc, generateRandomId, XContentHelper.xContentType(doc));, +                xContentType = XContentHelper.xContentType(doc);, +++ b/modules/percolator/src/main/java/org/elasticsearch/percolator/PercolateQueryBuilder.java, +        this(field, documentType, Collections.singletonList(document), XContentHelper.xContentType(document));, +                documentXContentType = XContentHelper.xContentType(documents.iterator().next());, +                    XContentHelper.xContentType(source));, +++ b/server/src/main/java/org/elasticsearch/action/admin/cluster/storedscripts/PutStoredScriptRequest.java, +            xContentType = XContentHelper.xContentType(content);, +++ b/server/src/main/java/org/elasticsearch/action/ingest/PutPipelineRequest.java, +import org.elasticsearch.common.xcontent.XContentHelper;, +        this(id, source, XContentHelper.xContentType(source));, +            xContentType = XContentHelper.xContentType(source);, +++ b/server/src/main/java/org/elasticsearch/action/ingest/SimulatePipelineRequest.java, +import org.elasticsearch.common.xcontent.XContentHelper;, +        this(source, XContentHelper.xContentType(source));, +            xContentType = XContentHelper.xContentType(source);, +++ b/server/src/main/java/org/elasticsearch/action/termvectors/TermVectorsRequest.java, +import org.elasticsearch.common.xcontent.XContentHelper;, +        return this.doc(doc, generateRandomId, XContentHelper.xContentType(doc));, +                xContentType = XContentHelper.xContentType(doc);, +++ b/server/src/main/java/org/elasticsearch/common/compress/CompressorFactory.java, +import org.elasticsearch.common.xcontent.XContentHelper;, +                assert XContentHelper.xContentType(bytes) == null;, +        XContentType contentType = XContentHelper.xContentType(bytes);, +++ b/modules/percolator/src/main/java/org/elasticsearch/percolator/PercolateQueryBuilder.java, +        this(field, documentType, Collections.singletonList(document), XContentHelper.xContentType(document));, +                documentXContentType = XContentHelper.xContentType(documents.iterator().next());, +                    XContentHelper.xContentType(source));, +++ b/server/src/main/java/org/elasticsearch/action/admin/cluster/storedscripts/PutStoredScriptRequest.java, +            xContentType = XContentHelper.xContentType(content);, +++ b/server/src/main/java/org/elasticsearch/action/ingest/PutPipelineRequest.java, +import org.elasticsearch.common.xcontent.XContentHelper;, +        this(id, source, XContentHelper.xContentType(source));, +            xContentType = XContentHelper.xContentType(source);, +++ b/server/src/main/java/org/elasticsearch/action/ingest/SimulatePipelineRequest.java, +import org.elasticsearch.common.xcontent.XContentHelper;, +        this(source, XContentHelper.xContentType(source));, +            xContentType = XContentHelper.xContentType(source);, +++ b/server/src/main/java/org/elasticsearch/action/termvectors/TermVectorsRequest.java, +import org.elasticsearch.common.xcontent.XContentHelper;, +        return this.doc(doc, generateRandomId, XContentHelper.xContentType(doc));, +                xContentType = XContentHelper.xContentType(doc);, +++ b/server/src/main/java/org/elasticsearch/common/compress/CompressorFactory.java, +import org.elasticsearch.common.xcontent.XContentHelper;, +                assert XContentHelper.xContentType(bytes) == null;, +        XContentType contentType = XContentHelper.xContentType(bytes);, +++ b/server/src/main/java/org/elasticsearch/common/xcontent/XContentFactory.java, +            int read = 0;, +            while (read < GUESS_HEADER_LENGTH) {, +                final int r = si.read(firstBytes, read, GUESS_HEADER_LENGTH - read);]
[+++ b/src/main/java/org/elasticsearch/action/suggest/TransportSuggestAction.java, +                final SuggestionSearchContext context = suggestPhase.parseElement().parseInternal(parser, indexService.mapperService(), request.index(), request.shardId());, +++ b/src/main/java/org/elasticsearch/action/suggest/TransportSuggestAction.java, +                final SuggestionSearchContext context = suggestPhase.parseElement().parseInternal(parser, indexService.mapperService(), request.index(), request.shardId());, +++ b/src/main/java/org/elasticsearch/search/suggest/SuggestParseElement.java, +import org.elasticsearch.search.SearchShardTarget;, +, +public final class SuggestParseElement implements SearchParseElement {, +        SuggestionSearchContext suggestionSearchContext = parseInternal(parser, context.mapperService(), context.shardTarget().index(), context.shardTarget().shardId());, +    public SuggestionSearchContext parseInternal(XContentParser parser, MapperService mapperService, String index, int shardId) throws IOException {, +                        SuggestionContext suggestion = contextParser.parse(parser, mapperService);, +                        suggestion.setText(suggestText);, +                        suggestion.setShard(shardId);, +                        suggestion.setIndex(index);, +                        SuggestUtils.verifySuggestion(mapperService, globalText, suggestion);, +                        suggestionSearchContext.addSuggestion(suggestionName, suggestion);, +++ b/src/main/java/org/elasticsearch/action/suggest/TransportSuggestAction.java, +                final SuggestionSearchContext context = suggestPhase.parseElement().parseInternal(parser, indexService.mapperService(), request.index(), request.shardId());, +++ b/src/main/java/org/elasticsearch/search/suggest/SuggestParseElement.java, +import org.elasticsearch.search.SearchShardTarget;, +, +public final class SuggestParseElement implements SearchParseElement {, +        SuggestionSearchContext suggestionSearchContext = parseInternal(parser, context.mapperService(), context.shardTarget().index(), context.shardTarget().shardId());, +    public SuggestionSearchContext parseInternal(XContentParser parser, MapperService mapperService, String index, int shardId) throws IOException {, +                        SuggestionContext suggestion = contextParser.parse(parser, mapperService);, +                        suggestion.setText(suggestText);, +                        suggestion.setShard(shardId);, +                        suggestion.setIndex(index);, +                        SuggestUtils.verifySuggestion(mapperService, globalText, suggestion);, +                        suggestionSearchContext.addSuggestion(suggestionName, suggestion);, +++ b/src/main/java/org/elasticsearch/search/suggest/SuggestPhase.java, +, +++ b/src/main/java/org/elasticsearch/action/suggest/TransportSuggestAction.java, +                final SuggestionSearchContext context = suggestPhase.parseElement().parseInternal(parser, indexService.mapperService(), request.index(), request.shardId());, +++ b/src/main/java/org/elasticsearch/search/suggest/SuggestParseElement.java, +import org.elasticsearch.search.SearchShardTarget;, +, +public final class SuggestParseElement implements SearchParseElement {, +        SuggestionSearchContext suggestionSearchContext = parseInternal(parser, context.mapperService(), context.shardTarget().index(), context.shardTarget().shardId());, +    public SuggestionSearchContext parseInternal(XContentParser parser, MapperService mapperService, String index, int shardId) throws IOException {, +                        SuggestionContext suggestion = contextParser.parse(parser, mapperService);, +                        suggestion.setText(suggestText);, +                        suggestion.setShard(shardId);, +                        suggestion.setIndex(index);, +                        SuggestUtils.verifySuggestion(mapperService, globalText, suggestion);, +                        suggestionSearchContext.addSuggestion(suggestionName, suggestion);, +++ b/src/main/java/org/elasticsearch/search/suggest/SuggestPhase.java, +, +++ b/src/main/java/org/elasticsearch/search/suggest/SuggestionSearchContext.java, +        private int shardId;, +        private String index;, +        , +        public void setShard(int shardId) {, +            this.shardId = shardId;, +        public void setIndex(String index) {, +            this.index = index;, +        }, +        , +        public String getIndex() {, +            return index;, +        }, +        , +        public int getShard() {, +            return shardId;, +        }, +    }, +, +   , +]
[+++ b/samples/facebook-showcase-2/src/main/resources/org/springframework/social/samples/facebook/db/ConnectedAccount.sql, +					refreshToken varchar,, +++ b/samples/facebook-showcase-2/src/main/resources/org/springframework/social/samples/facebook/db/ConnectedAccount.sql, +					refreshToken varchar,, +++ b/samples/facebook-showcase/src/main/resources/org/springframework/social/samples/facebook/db/ConnectedAccount.sql, +					refreshToken varchar,, +++ b/samples/facebook-showcase-2/src/main/resources/org/springframework/social/samples/facebook/db/ConnectedAccount.sql, +					refreshToken varchar,, +++ b/samples/facebook-showcase/src/main/resources/org/springframework/social/samples/facebook/db/ConnectedAccount.sql, +					refreshToken varchar,, +++ b/samples/gowalla-showcase/src/main/resources/org/springframework/social/samples/gowalla/db/ConnectedAccount.sql, +					refreshToken varchar,, +++ b/samples/facebook-showcase-2/src/main/resources/org/springframework/social/samples/facebook/db/ConnectedAccount.sql, +					refreshToken varchar,, +++ b/samples/facebook-showcase/src/main/resources/org/springframework/social/samples/facebook/db/ConnectedAccount.sql, +					refreshToken varchar,, +++ b/samples/gowalla-showcase/src/main/resources/org/springframework/social/samples/gowalla/db/ConnectedAccount.sql, +					refreshToken varchar,, +++ b/samples/twitter-showcase/src/main/resources/org/springframework/social/samples/twitter/db/ConnectedAccount.sql, +					refreshToken varchar,, +++ b/samples/facebook-showcase-2/src/main/resources/org/springframework/social/samples/facebook/db/ConnectedAccount.sql, +					refreshToken varchar,, +++ b/samples/facebook-showcase/src/main/resources/org/springframework/social/samples/facebook/db/ConnectedAccount.sql, +					refreshToken varchar,, +++ b/samples/gowalla-showcase/src/main/resources/org/springframework/social/samples/gowalla/db/ConnectedAccount.sql, +					refreshToken varchar,, +++ b/samples/twitter-showcase/src/main/resources/org/springframework/social/samples/twitter/db/ConnectedAccount.sql, +					refreshToken varchar,, +++ b/spring-social-connect/src/main/java/org/springframework/social/connect/AbstractOAuth2ServiceProvider.java, +import org.springframework.web.client.RestTemplate;, +, +		OAuth2Tokens oauth2Tokens = fetchOAuth2AccessToken(tokenRequestParameters);, +		OAuthToken accessToken = oauth2Tokens.getAccessToken();, +		connectionRepository.addConnection(accountId, getName(), accessToken, oauth2Tokens.getRefreshToken(), username,, +, +	protected OAuth2Tokens fetchOAuth2AccessToken(Map<String, String> tokenRequestParameters) {, +		@SuppressWarnings("unchecked"), +		Map<String, String> result = new RestTemplate().postForObject(parameters.getAccessTokenUrl(),, +				tokenRequestParameters, Map.class);, +		return new OAuth2Tokens(new OAuthToken(result.get("access_token")), result.get("refresh_token"));, +	}, +++ b/samples/facebook-showcase-2/src/main/resources/org/springframework/social/samples/facebook/db/ConnectedAccount.sql, +					refreshToken varchar,, +++ b/samples/facebook-showcase/src/main/resources/org/springframework/social/samples/facebook/db/ConnectedAccount.sql, +					refreshToken varchar,, +++ b/samples/gowalla-showcase/src/main/resources/org/springframework/social/samples/gowalla/db/ConnectedAccount.sql, +					refreshToken varchar,, +++ b/samples/twitter-showcase/src/main/resources/org/springframework/social/samples/twitter/db/ConnectedAccount.sql, +					refreshToken varchar,, +++ b/spring-social-connect/src/main/java/org/springframework/social/connect/AbstractOAuth2ServiceProvider.java, +import org.springframework.web.client.RestTemplate;, +, +		OAuth2Tokens oauth2Tokens = fetchOAuth2AccessToken(tokenRequestParameters);, +		OAuthToken accessToken = oauth2Tokens.getAccessToken();, +		connectionRepository.addConnection(accountId, getName(), accessToken, oauth2Tokens.getRefreshToken(), username,, +, +	protected OAuth2Tokens fetchOAuth2AccessToken(Map<String, String> tokenRequestParameters) {, +		@SuppressWarnings("unchecked"), +		Map<String, String> result = new RestTemplate().postForObject(parameters.getAccessTokenUrl(),, +				tokenRequestParameters, Map.class);, +		return new OAuth2Tokens(new OAuthToken(result.get("access_token")), result.get("refresh_token"));, +	}, +++ b/spring-social-connect/src/main/java/org/springframework/social/connect/AbstractServiceProvider.java, +		connectionRepository.addConnection(accountId, getName(), oauthAccessToken, providerAccountId,, +++ b/samples/facebook-showcase-2/src/main/resources/org/springframework/social/samples/facebook/db/ConnectedAccount.sql, +					refreshToken varchar,, +++ b/samples/facebook-showcase/src/main/resources/org/springframework/social/samples/facebook/db/ConnectedAccount.sql, +					refreshToken varchar,, +++ b/samples/gowalla-showcase/src/main/resources/org/springframework/social/samples/gowalla/db/ConnectedAccount.sql, +					refreshToken varchar,, +++ b/samples/twitter-showcase/src/main/resources/org/springframework/social/samples/twitter/db/ConnectedAccount.sql, +					refreshToken varchar,, +++ b/spring-social-connect/src/main/java/org/springframework/social/connect/AbstractOAuth2ServiceProvider.java, +import org.springframework.web.client.RestTemplate;, +, +		OAuth2Tokens oauth2Tokens = fetchOAuth2AccessToken(tokenRequestParameters);, +		OAuthToken accessToken = oauth2Tokens.getAccessToken();, +		connectionRepository.addConnection(accountId, getName(), accessToken, oauth2Tokens.getRefreshToken(), username,, +, +	protected OAuth2Tokens fetchOAuth2AccessToken(Map<String, String> tokenRequestParameters) {, +		@SuppressWarnings("unchecked"), +		Map<String, String> result = new RestTemplate().postForObject(parameters.getAccessTokenUrl(),, +				tokenRequestParameters, Map.class);, +		return new OAuth2Tokens(new OAuthToken(result.get("access_token")), result.get("refresh_token"));, +	}, +++ b/spring-social-connect/src/main/java/org/springframework/social/connect/AbstractServiceProvider.java, +		connectionRepository.addConnection(accountId, getName(), oauthAccessToken, providerAccountId,, +++ b/spring-social-connect/src/main/java/org/springframework/social/connect/AccountConnection.java, +	private final Serializable accountId;, +	private final String provider;, +	private final OAuthToken accessToken;, +	private final String refreshToken;, +	private final String providerAccountId;, +	private final String providerProfileUrl;, +	public AccountConnection(Serializable accountId, String provider, OAuthToken accessToken, String refreshToken,, +			String providerAccountId, String providerProfileUrl) {, +		this.refreshToken = refreshToken;, +	public String getRefreshToken() {, +		return refreshToken;, +	}]
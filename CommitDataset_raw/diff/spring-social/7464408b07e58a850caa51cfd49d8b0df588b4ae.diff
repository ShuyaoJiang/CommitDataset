[+++ b/spring-social-security/src/main/java/org/springframework/social/security/SocialAuthenticationFilter.java, +import java.io.IOException;, +, +			try {, +				return attemptAuthService(authService, request, response);, +			} catch (SocialAuthenticationRedirectException redirect) {, +				try {, +					response.sendRedirect(redirect.getRedirectUrl());, +				} catch (IOException e) {, +					throw new SocialAuthenticationException("failed to send redirect from SocialAuthenticationRedirectException", e);, +				return null;, +		} else {, +			return null;, +		}, +			// providerUserId already connected to userId, +			// providerUserId already connected to different userId and no multi user allowed, +		Connection<?> connection = token.getConnection();, +		if (userId == null || connection == null) {, +			logger.warn("can't add connection without userId or connection");, +			return;, +		}, +		connection = addConnection(authService, userId, connection.createData());]
[+++ b/build.gradle, +    s2OAuthVersion = '1.0.0.BUILD-SNAPSHOT', +++ b/build.gradle, +    s2OAuthVersion = '1.0.0.BUILD-SNAPSHOT', +++ b/spring-social-client/src/main/java/org/springframework/social/provider/oauth1/OAuth1Operations.java, +++ b/build.gradle, +    s2OAuthVersion = '1.0.0.BUILD-SNAPSHOT', +++ b/spring-social-client/src/main/java/org/springframework/social/provider/oauth1/OAuth1Operations.java, +++ b/spring-social-client/src/main/java/org/springframework/social/provider/oauth1/OAuth1Template.java, +import org.springframework.security.oauth.common.signature.SharedConsumerSecret;, +import org.springframework.security.oauth.consumer.BaseProtectedResourceDetails;, +import org.springframework.security.oauth.consumer.CoreOAuthConsumerSupport;, +import org.springframework.security.oauth.consumer.OAuthConsumerSupport;, +import org.springframework.security.oauth.consumer.ProtectedResourceDetails;, +import org.springframework.security.oauth.consumer.token.OAuthConsumerToken;, +import org.springframework.web.util.UriTemplate;, +, +	private final UriTemplate authorizeUrlTemplate;, +	private OAuthConsumerSupport oauthConsumerSupport;, +	, +		this.authorizeUrlTemplate = new UriTemplate(authorizeUrl);, +		this.oauthConsumerSupport = new CoreOAuthConsumerSupport();, +		OAuthConsumerToken requestToken = getOAuthConsumerSupport().getUnauthorizedRequestToken(, +				getProtectedResourceDetails(), callbackUrl);, +		return new OAuthToken(requestToken.getValue(), requestToken.getSecret());, +		return authorizeUrlTemplate.expand(requestToken).toString();, +		OAuthConsumerToken consumerToken = new OAuthConsumerToken();, +		consumerToken.setValue(requestToken.getValue());, +		consumerToken.setSecret(requestToken.getSecret());, +		OAuthConsumerToken accessToken = getOAuthConsumerSupport().getAccessToken(getProtectedResourceDetails(),, +				consumerToken, requestToken.getVerifier());, +		return new OAuthToken(accessToken.getValue(), accessToken.getSecret());, +	private ProtectedResourceDetails getProtectedResourceDetails() {, +		BaseProtectedResourceDetails details = new BaseProtectedResourceDetails();, +		details.setConsumerKey(consumerKey);, +		details.setSharedSecret(new SharedConsumerSecret(consumerSecret));, +		details.setRequestTokenURL(requestTokenUrl);, +		details.setAccessTokenURL(accessTokenUrl);, +		return details;, +	}, +, +	protected OAuthConsumerSupport getOAuthConsumerSupport() {, +		return oauthConsumerSupport;, +	}, +++ b/build.gradle, +    s2OAuthVersion = '1.0.0.BUILD-SNAPSHOT', +++ b/spring-social-client/src/main/java/org/springframework/social/provider/oauth1/OAuth1Operations.java, +++ b/spring-social-client/src/main/java/org/springframework/social/provider/oauth1/OAuth1Template.java, +import org.springframework.security.oauth.common.signature.SharedConsumerSecret;, +import org.springframework.security.oauth.consumer.BaseProtectedResourceDetails;, +import org.springframework.security.oauth.consumer.CoreOAuthConsumerSupport;, +import org.springframework.security.oauth.consumer.OAuthConsumerSupport;, +import org.springframework.security.oauth.consumer.ProtectedResourceDetails;, +import org.springframework.security.oauth.consumer.token.OAuthConsumerToken;, +import org.springframework.web.util.UriTemplate;, +, +	private final UriTemplate authorizeUrlTemplate;, +	private OAuthConsumerSupport oauthConsumerSupport;, +	, +		this.authorizeUrlTemplate = new UriTemplate(authorizeUrl);, +		this.oauthConsumerSupport = new CoreOAuthConsumerSupport();, +		OAuthConsumerToken requestToken = getOAuthConsumerSupport().getUnauthorizedRequestToken(, +				getProtectedResourceDetails(), callbackUrl);, +		return new OAuthToken(requestToken.getValue(), requestToken.getSecret());, +		return authorizeUrlTemplate.expand(requestToken).toString();, +		OAuthConsumerToken consumerToken = new OAuthConsumerToken();, +		consumerToken.setValue(requestToken.getValue());, +		consumerToken.setSecret(requestToken.getSecret());, +		OAuthConsumerToken accessToken = getOAuthConsumerSupport().getAccessToken(getProtectedResourceDetails(),, +				consumerToken, requestToken.getVerifier());, +		return new OAuthToken(accessToken.getValue(), accessToken.getSecret());, +	private ProtectedResourceDetails getProtectedResourceDetails() {, +		BaseProtectedResourceDetails details = new BaseProtectedResourceDetails();, +		details.setConsumerKey(consumerKey);, +		details.setSharedSecret(new SharedConsumerSecret(consumerSecret));, +		details.setRequestTokenURL(requestTokenUrl);, +		details.setAccessTokenURL(accessTokenUrl);, +		return details;, +	}, +, +	protected OAuthConsumerSupport getOAuthConsumerSupport() {, +		return oauthConsumerSupport;, +	}, +++ b/spring-social-client/src/test/java/org/springframework/social/provider/oauth1/OAuth1TemplateTest.java, +package org.springframework.social.provider.oauth1;, +, +import static org.junit.Assert.*;, +import static org.mockito.Matchers.*;, +import static org.mockito.Mockito.*;, +, +import org.junit.Test;, +import org.mockito.ArgumentMatcher;, +import org.springframework.security.oauth.common.signature.SharedConsumerSecret;, +import org.springframework.security.oauth.consumer.BaseProtectedResourceDetails;, +import org.springframework.security.oauth.consumer.OAuthConsumerSupport;, +import org.springframework.security.oauth.consumer.ProtectedResourceDetails;, +import org.springframework.security.oauth.consumer.token.OAuthConsumerToken;, +, +public class OAuth1TemplateTest {, +]
[+++ b/spring-social-security/src/main/java/org/springframework/social/security/provider/OAuth1AuthenticationService.java, +			OAuth1Parameters params;, +			if (ops.getVersion() == OAuth1Version.CORE_10) {, +				params = new OAuth1Parameters();, +				params.setCallbackUrl(returnToUrl);, +			} else {, +				params = OAuth1Parameters.NONE;, +			}, +			, +			String oAuthUrl = ops.buildAuthenticateUrl(requestToken.getValue(), params);, +			, +++ b/spring-social-security/src/main/java/org/springframework/social/security/provider/OAuth1AuthenticationService.java, +			OAuth1Parameters params;, +			if (ops.getVersion() == OAuth1Version.CORE_10) {, +				params = new OAuth1Parameters();, +				params.setCallbackUrl(returnToUrl);, +			} else {, +				params = OAuth1Parameters.NONE;, +			}, +			, +			String oAuthUrl = ops.buildAuthenticateUrl(requestToken.getValue(), params);, +			, +++ b/spring-social-security/src/main/java/org/springframework/social/security/provider/OAuth2AuthenticationService.java, +			OAuth2Parameters params =  new OAuth2Parameters();, +			params.setRedirectUri(returnToUrl);, +			params.setScope(scope);, +					GrantType.AUTHORIZATION_CODE, params);, +++ b/spring-social-security/src/main/java/org/springframework/social/security/provider/OAuth1AuthenticationService.java, +			OAuth1Parameters params;, +			if (ops.getVersion() == OAuth1Version.CORE_10) {, +				params = new OAuth1Parameters();, +				params.setCallbackUrl(returnToUrl);, +			} else {, +				params = OAuth1Parameters.NONE;, +			}, +			, +			String oAuthUrl = ops.buildAuthenticateUrl(requestToken.getValue(), params);, +			, +++ b/spring-social-security/src/main/java/org/springframework/social/security/provider/OAuth2AuthenticationService.java, +			OAuth2Parameters params =  new OAuth2Parameters();, +			params.setRedirectUri(returnToUrl);, +			params.setScope(scope);, +					GrantType.AUTHORIZATION_CODE, params);, +++ b/spring-social-web/src/main/java/org/springframework/social/connect/web/ConnectController.java]
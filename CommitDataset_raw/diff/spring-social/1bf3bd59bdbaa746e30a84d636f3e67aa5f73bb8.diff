[+++ b/spring-social-security/src/main/java/org/springframework/social/security/SocialAuthenticationFilter.java, +import java.util.Collection;, +	public static boolean removeSignInAttempt(HttpSession session, ConnectionKey key) {, +		return session != null ? SignInAttempts.remove(session, key) : false;, +	}, +	, +	public static boolean removeSignInAttempt(HttpSession session, ConnectionData data) {, +		return removeSignInAttempt(session, SignInAttempts.key(data));, +	}, +	, +		private static Collection<ConnectionData> get(HttpSession session) {, +		private static boolean remove(HttpSession session, ConnectionKey key) {, +			SignInAttempts signInAttempts = (SignInAttempts) session.getAttribute(ATTR_SIGN_IN_ATTEMPT);, +			return signInAttempts != null ? signInAttempts.removeAttempt(key) : false;, +		}, +		, +		private boolean removeAttempt(ConnectionKey key) {, +			return attempts.remove(key) != null;, +		private Collection<ConnectionData> getAttempts() {, +			return attempts.values();, +		}, +		, +		private static ConnectionKey key(ConnectionData data) {, +++ b/spring-social-security/src/main/java/org/springframework/social/security/SocialAuthenticationFilter.java, +import java.util.Collection;, +	public static boolean removeSignInAttempt(HttpSession session, ConnectionKey key) {, +		return session != null ? SignInAttempts.remove(session, key) : false;, +	}, +	, +	public static boolean removeSignInAttempt(HttpSession session, ConnectionData data) {, +		return removeSignInAttempt(session, SignInAttempts.key(data));, +	}, +	, +		private static Collection<ConnectionData> get(HttpSession session) {, +		private static boolean remove(HttpSession session, ConnectionKey key) {, +			SignInAttempts signInAttempts = (SignInAttempts) session.getAttribute(ATTR_SIGN_IN_ATTEMPT);, +			return signInAttempts != null ? signInAttempts.removeAttempt(key) : false;, +		}, +		, +		private boolean removeAttempt(ConnectionKey key) {, +			return attempts.remove(key) != null;, +		private Collection<ConnectionData> getAttempts() {, +			return attempts.values();, +		}, +		, +		private static ConnectionKey key(ConnectionData data) {, +++ b/spring-social-security/src/test/java/org/springframework/social/security/SocialAuthenticationFilterTest.java, +		SocialAuthenticationFilter.removeSignInAttempt(session, SocialAuthenticationFilter.getSignInAttempts(session).get(0));, +		assertEquals(2, SocialAuthenticationFilter.getSignInAttempts(session).size());]
[+++ b/spring-social-web/src/main/java/org/springframework/social/connect/web/ConnectController.java, +import org.springframework.util.StringUtils;, +import org.springframework.web.util.UrlPathHelper;, +import org.springframework.web.util.WebUtils;, +	private final UrlPathHelper urlPathHelper = new UrlPathHelper();, +, +		String path = "/connect/" + providerId + getPathExtension(request);, +		HttpServletRequest nativeRequest = request.getNativeRequest(HttpServletRequest.class);, +		if (prependServletPath(nativeRequest)) {, +			path = nativeRequest.getServletPath() + path;, +		return new RedirectView(path, true);, +	private boolean prependServletPath(HttpServletRequest request) {, +		return !this.urlPathHelper.getPathWithinServletMapping(request).equals("");, +	}, +	, +	/*, +	 * Determines the path extension, if any., +	 * Returns the extension, including the period at the beginning, or an empty string if there is no extension., +	 * This makes it possible to append the returned value to a path even if there is no extension., +	 */, +	private String getPathExtension(NativeWebRequest request) {, +		String fileName = WebUtils.extractFullFilenameFromUrlPath(request.getNativeRequest(HttpServletRequest.class).getRequestURI());		, +		String extension = StringUtils.getFilenameExtension(fileName);, +		return extension != null ? "." + extension : "";, +	}, +]
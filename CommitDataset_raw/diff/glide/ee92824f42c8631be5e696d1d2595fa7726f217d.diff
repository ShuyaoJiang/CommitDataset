[+++ b/library/src/main/java/com/bumptech/glide/Glide.java, +    Downsampler downsampler =, +        new Downsampler(resources.getDisplayMetrics(), bitmapPool, arrayPool);, +        new ByteBufferGifDecoder(context, bitmapPool, arrayPool);, +    registry = new Registry(), +        .register(ByteBuffer.class, new ByteBufferEncoder()), +            new StreamGifDecoder(byteBufferGifDecoder, arrayPool)), +++ b/library/src/main/java/com/bumptech/glide/Glide.java, +    Downsampler downsampler =, +        new Downsampler(resources.getDisplayMetrics(), bitmapPool, arrayPool);, +        new ByteBufferGifDecoder(context, bitmapPool, arrayPool);, +    registry = new Registry(), +        .register(ByteBuffer.class, new ByteBufferEncoder()), +            new StreamGifDecoder(byteBufferGifDecoder, arrayPool)), +++ b/library/src/main/java/com/bumptech/glide/Registry.java, +++ b/library/src/main/java/com/bumptech/glide/Glide.java, +    Downsampler downsampler =, +        new Downsampler(resources.getDisplayMetrics(), bitmapPool, arrayPool);, +        new ByteBufferGifDecoder(context, bitmapPool, arrayPool);, +    registry = new Registry(), +        .register(ByteBuffer.class, new ByteBufferEncoder()), +            new StreamGifDecoder(byteBufferGifDecoder, arrayPool)), +++ b/library/src/main/java/com/bumptech/glide/Registry.java, +++ /dev/null, +++ b/library/src/main/java/com/bumptech/glide/Glide.java, +    Downsampler downsampler =, +        new Downsampler(resources.getDisplayMetrics(), bitmapPool, arrayPool);, +        new ByteBufferGifDecoder(context, bitmapPool, arrayPool);, +    registry = new Registry(), +        .register(ByteBuffer.class, new ByteBufferEncoder()), +            new StreamGifDecoder(byteBufferGifDecoder, arrayPool)), +++ b/library/src/main/java/com/bumptech/glide/Registry.java, +++ /dev/null, +++ /dev/null, +++ b/library/src/main/java/com/bumptech/glide/Glide.java, +    Downsampler downsampler =, +        new Downsampler(resources.getDisplayMetrics(), bitmapPool, arrayPool);, +        new ByteBufferGifDecoder(context, bitmapPool, arrayPool);, +    registry = new Registry(), +        .register(ByteBuffer.class, new ByteBufferEncoder()), +            new StreamGifDecoder(byteBufferGifDecoder, arrayPool)), +++ b/library/src/main/java/com/bumptech/glide/Registry.java, +++ /dev/null, +++ /dev/null, +++ b/library/src/main/java/com/bumptech/glide/load/data/mediastore/ThumbFetcher.java, +    return new ThumbFetcher(, +        uri, new ThumbnailStreamOpener(query, byteArrayPool, context.getContentResolver()));, +++ b/library/src/main/java/com/bumptech/glide/Glide.java, +    Downsampler downsampler =, +        new Downsampler(resources.getDisplayMetrics(), bitmapPool, arrayPool);, +        new ByteBufferGifDecoder(context, bitmapPool, arrayPool);, +    registry = new Registry(), +        .register(ByteBuffer.class, new ByteBufferEncoder()), +            new StreamGifDecoder(byteBufferGifDecoder, arrayPool)), +++ b/library/src/main/java/com/bumptech/glide/Registry.java, +++ /dev/null, +++ /dev/null, +++ b/library/src/main/java/com/bumptech/glide/load/data/mediastore/ThumbFetcher.java, +    return new ThumbFetcher(, +        uri, new ThumbnailStreamOpener(query, byteArrayPool, context.getContentResolver()));, +++ b/library/src/main/java/com/bumptech/glide/load/data/mediastore/ThumbnailStreamOpener.java, +import com.bumptech.glide.load.resource.bitmap.ImageHeaderParser;, +      ThumbnailQuery query, ArrayPool byteArrayPool, ContentResolver contentResolver) {, +    this(DEFAULT_SERVICE, query, byteArrayPool, contentResolver);, +    int orientation = ImageHeaderParser.UNKNOWN_ORIENTATION;, +      orientation = new ImageHeaderParser(is, byteArrayPool).getOrientation();, +    return orientation;, +++ b/library/src/main/java/com/bumptech/glide/Glide.java, +    Downsampler downsampler =, +        new Downsampler(resources.getDisplayMetrics(), bitmapPool, arrayPool);, +        new ByteBufferGifDecoder(context, bitmapPool, arrayPool);, +    registry = new Registry(), +        .register(ByteBuffer.class, new ByteBufferEncoder()), +            new StreamGifDecoder(byteBufferGifDecoder, arrayPool)), +++ b/library/src/main/java/com/bumptech/glide/Registry.java, +++ /dev/null, +++ /dev/null, +++ b/library/src/main/java/com/bumptech/glide/load/data/mediastore/ThumbFetcher.java, +    return new ThumbFetcher(, +        uri, new ThumbnailStreamOpener(query, byteArrayPool, context.getContentResolver()));, +++ b/library/src/main/java/com/bumptech/glide/load/data/mediastore/ThumbnailStreamOpener.java, +import com.bumptech.glide.load.resource.bitmap.ImageHeaderParser;, +      ThumbnailQuery query, ArrayPool byteArrayPool, ContentResolver contentResolver) {, +    this(DEFAULT_SERVICE, query, byteArrayPool, contentResolver);, +    int orientation = ImageHeaderParser.UNKNOWN_ORIENTATION;, +      orientation = new ImageHeaderParser(is, byteArrayPool).getOrientation();, +    return orientation;, +++ /dev/null, +++ b/library/src/main/java/com/bumptech/glide/Glide.java, +    Downsampler downsampler =, +        new Downsampler(resources.getDisplayMetrics(), bitmapPool, arrayPool);, +        new ByteBufferGifDecoder(context, bitmapPool, arrayPool);, +    registry = new Registry(), +        .register(ByteBuffer.class, new ByteBufferEncoder()), +            new StreamGifDecoder(byteBufferGifDecoder, arrayPool)), +++ b/library/src/main/java/com/bumptech/glide/Registry.java, +++ /dev/null, +++ /dev/null, +++ b/library/src/main/java/com/bumptech/glide/load/data/mediastore/ThumbFetcher.java, +    return new ThumbFetcher(]
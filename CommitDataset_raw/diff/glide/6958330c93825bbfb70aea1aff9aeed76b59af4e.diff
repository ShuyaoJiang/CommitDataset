[+++ b/library/src/androidTest/java/com/bumptech/glide/load/engine/cache/MemorySizeCalculatorTest.java, +import com.bumptech.glide.tests.Util;, +        Util.setSdkVersionInt(initialSdkVersion);, +        Util.setSdkVersionInt(10);, +++ b/library/src/androidTest/java/com/bumptech/glide/load/engine/cache/MemorySizeCalculatorTest.java, +import com.bumptech.glide.tests.Util;, +        Util.setSdkVersionInt(initialSdkVersion);, +        Util.setSdkVersionInt(10);, +++ b/library/src/androidTest/java/com/bumptech/glide/load/resource/bitmap/BitmapResourceTest.java, +import com.bumptech.glide.tests.Util;, +        Util.setSdkVersionInt(currentBuildVersion);, +        Util.setSdkVersionInt(18);, +++ b/library/src/androidTest/java/com/bumptech/glide/load/engine/cache/MemorySizeCalculatorTest.java, +import com.bumptech.glide.tests.Util;, +        Util.setSdkVersionInt(initialSdkVersion);, +        Util.setSdkVersionInt(10);, +++ b/library/src/androidTest/java/com/bumptech/glide/load/resource/bitmap/BitmapResourceTest.java, +import com.bumptech.glide.tests.Util;, +        Util.setSdkVersionInt(currentBuildVersion);, +        Util.setSdkVersionInt(18);, +++ b/library/src/androidTest/java/com/bumptech/glide/load/resource/gif/GifDrawableTest.java, +import android.os.Build;, +import com.bumptech.glide.tests.Util;, +import org.junit.After;, +    private int initialSdkVersion;, +        initialSdkVersion = Build.VERSION.SDK_INT;, +    }, +, +    @After, +    public void tearDown() {, +        Util.setSdkVersionInt(initialSdkVersion);, +    public void testStopsWhenCurrentFrameFinishesIfHasNoCallbackAndIsAtLeastAtHoneycomb() {, +    public void testDoesNotStopWhenCurrentFrameFinishesIfHasNoCallbackAndIsPreHoneycomb() {, +        Util.setSdkVersionInt(10);, +, +        drawable.setIsRunning(true);, +        drawable.setCallback(null);, +        drawable.onFrameRead(0);, +, +        assertTrue(drawable.isRunning());, +    }, +, +    @Test, +    public void testResetsFrameManagerWhenCurrentFinishesIfHasNoCallbackAndIsAtLeastAtHoneycomb() {, +        drawable.setIsRunning(true);, +        drawable.setCallback(null);, +        drawable.onFrameRead(0);, +, +, +        verify(frameManager).clear();, +    }, +, +    @Test, +    public void testDoesNotResetFrameManagerWhenCurrentFinishesIfHasNoCallbackPreHoneycomb() {, +        Util.setSdkVersionInt(10);, +, +        drawable.setIsRunning(true);, +        drawable.setCallback(null);, +        drawable.onFrameRead(0);, +, +        verify(frameManager, never()).clear();, +    }, +, +    @Test, +    public void testDoesNotResetOnStopIfAtLeastAtHoneycomb() {, +        drawable.start();, +        drawable.stop();, +, +        verify(frameManager, never()).clear();, +        // invalidate once from start., +        verify(cb, times(1)).invalidateDrawable(eq(drawable));, +    }, +, +    @Test, +    public void testDoesResetOnStopIfPreHoneycomb() {, +        Util.setSdkVersionInt(10);, +        drawable.start();, +        drawable.stop();, +, +        verify(frameManager).clear();, +        verify(cb, times(2)).invalidateDrawable(eq(drawable));, +    }, +, +    @Test, +++ b/library/src/androidTest/java/com/bumptech/glide/load/engine/cache/MemorySizeCalculatorTest.java, +import com.bumptech.glide.tests.Util;, +        Util.setSdkVersionInt(initialSdkVersion);, +        Util.setSdkVersionInt(10);, +++ b/library/src/androidTest/java/com/bumptech/glide/load/resource/bitmap/BitmapResourceTest.java, +import com.bumptech.glide.tests.Util;, +        Util.setSdkVersionInt(currentBuildVersion);, +        Util.setSdkVersionInt(18);, +++ b/library/src/androidTest/java/com/bumptech/glide/load/resource/gif/GifDrawableTest.java, +import android.os.Build;, +import com.bumptech.glide.tests.Util;, +import org.junit.After;, +    private int initialSdkVersion;, +        initialSdkVersion = Build.VERSION.SDK_INT;, +    }, +]
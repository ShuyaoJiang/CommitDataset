[+++ b/instrumentation/src/androidTest/java/com/bumptech/glide/load/resource/gif/GifDrawableTest.java, +import android.Manifest.permission;, +import android.support.test.rule.GrantPermissionRule;, +  @Rule public final TestName testName = new TestName();, +  @Rule public final TearDownGlide tearDownGlide = new TearDownGlide();, +  @Rule public final GrantPermissionRule grantPermissionRule;, +, +  {, +    if (Build.VERSION.SDK_INT > Build.VERSION_CODES.M) {, +      grantPermissionRule = GrantPermissionRule.grant(permission.SYSTEM_ALERT_WINDOW);, +    } else {, +      grantPermissionRule = GrantPermissionRule.grant();, +    }, +  }, +, +    layoutParams.type =, +        Build.VERSION.SDK_INT >= Build.VERSION_CODES.O, +            ? LayoutParams.TYPE_APPLICATION_OVERLAY, +            : Build.VERSION.SDK_INT == Build.VERSION_CODES.M, +                ? LayoutParams.TYPE_TOAST : LayoutParams.TYPE_SYSTEM_ALERT;]
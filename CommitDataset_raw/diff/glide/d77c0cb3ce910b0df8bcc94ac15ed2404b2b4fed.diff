[+++ b/instrumentation/src/androidTest/java/com/bumptech/glide/DrawableTransformationTest.java, +import android.os.Handler;, +import android.os.Looper;, +import java.util.concurrent.CountDownLatch;, +import java.util.concurrent.TimeUnit;, +    // The following section is a hack to workaround a weird behavior where a post in RequestManager, +    // can cause a failed request to be started twice in a row if the first attempt happens before., +    // the post. This seems rather unlikely to happen in real applications and it only occurs when, +    // the request fails unexpectedly, so we're working around this weird behavior in this test., +    // See #3551., +, +    // Trigger the Glide application RequestManager to be created., +    Glide.get(context).getRequestManagerRetriever().get(context);, +    // Wait until it's added as a lifecycle observer., +    final CountDownLatch latch = new CountDownLatch(1);, +    new Handler(Looper.getMainLooper()).post(new Runnable() {, +      @Override, +      public void run() {, +        latch.countDown();, +      }, +    });, +    latch.await(5, TimeUnit.SECONDS);, +, +    // End hacks., +]
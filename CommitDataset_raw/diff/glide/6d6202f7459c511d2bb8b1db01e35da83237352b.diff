[+++ b/library/src/androidTest/java/com/bumptech/glide/load/resource/bitmap/DownsamplerTest.java, +import org.robolectric.RobolectricTestRunner;, +, +import org.robolectric.RuntimeEnvironment;, +    downsampler = new Downsampler(RuntimeEnvironment.application.getResources().getDisplayMetrics(),, +        bitmapPool);, +++ b/library/src/androidTest/java/com/bumptech/glide/load/resource/bitmap/DownsamplerTest.java, +import org.robolectric.RobolectricTestRunner;, +, +import org.robolectric.RuntimeEnvironment;, +    downsampler = new Downsampler(RuntimeEnvironment.application.getResources().getDisplayMetrics(),, +        bitmapPool);, +++ b/library/src/main/java/com/bumptech/glide/Glide.java, +, +    Downsampler downsampler = new Downsampler(resources.getDisplayMetrics(), bitmapPool);, +            new ByteBufferBitmapDecoder(downsampler)), +            new StreamBitmapDecoder(downsampler)), +                new ByteBufferBitmapDecoder(downsampler))), +                new StreamBitmapDecoder(downsampler))), +++ b/library/src/androidTest/java/com/bumptech/glide/load/resource/bitmap/DownsamplerTest.java, +import org.robolectric.RobolectricTestRunner;, +, +import org.robolectric.RuntimeEnvironment;, +    downsampler = new Downsampler(RuntimeEnvironment.application.getResources().getDisplayMetrics(),, +        bitmapPool);, +++ b/library/src/main/java/com/bumptech/glide/Glide.java, +, +    Downsampler downsampler = new Downsampler(resources.getDisplayMetrics(), bitmapPool);, +            new ByteBufferBitmapDecoder(downsampler)), +            new StreamBitmapDecoder(downsampler)), +                new ByteBufferBitmapDecoder(downsampler))), +                new StreamBitmapDecoder(downsampler))), +++ b/library/src/main/java/com/bumptech/glide/load/resource/bitmap/Downsampler.java, +import android.util.DisplayMetrics;, +  private final DisplayMetrics displayMetrics;, +  public Downsampler(DisplayMetrics displayMetrics, BitmapPool bitmapPool) {, +    this.displayMetrics = displayMetrics;, +, +    } else {, +      options.inDensity = options.inTargetDensity = 0;, +    // If we scaled, the Bitmap density will be our inTargetDensity. Here we correct it back to, +    // the expected density dpi., +    downsampled.setDensity(displayMetrics.densityDpi);, +]
[+++ b/EventBusPerformance/src/de/greenrobot/eventperf/TestSetupActivity.java, +import de.greenrobot.eventperf.testsubject.PerfTestEventBus;, +    static final Class[] TEST_CLASSES_EVENTBUS = { PerfTestEventBus.Post.class,//, +            PerfTestEventBus.RegisterOneByOne.class,//, +            PerfTestEventBus.RegisterAll.class, //, +            PerfTestEventBus.RegisterFirstTime.class };, +++ b/EventBusPerformance/src/de/greenrobot/eventperf/TestSetupActivity.java, +import de.greenrobot.eventperf.testsubject.PerfTestEventBus;, +    static final Class[] TEST_CLASSES_EVENTBUS = { PerfTestEventBus.Post.class,//, +            PerfTestEventBus.RegisterOneByOne.class,//, +            PerfTestEventBus.RegisterAll.class, //, +            PerfTestEventBus.RegisterFirstTime.class };, +++ b/EventBusPerformance/src/de/greenrobot/eventperf/testsubject/PerfTestEventBus.java, +package de.greenrobot.eventperf.testsubject;, +, +import java.lang.reflect.Constructor;, +import java.lang.reflect.Method;, +import java.util.ArrayList;, +, +import android.content.Context;, +import de.greenrobot.event.EventBus;, +import de.greenrobot.eventperf.Test;, +import de.greenrobot.eventperf.TestEvent;, +import de.greenrobot.eventperf.TestParams;, +, +public abstract class PerfTestEventBus extends Test {, +, +    private final EventBus eventBus;, +    private final ArrayList<Object> subscribers;, +    private final Class<?> subscriberClass;, +    private final int eventCount;, +    private final int expectedEventCount;, +, +    public PerfTestEventBus(Context context, TestParams params) {, +        super(context, params);, +        eventBus = new EventBus();, +        subscribers = new ArrayList<Object>();, +        eventCount = params.getEventCount();, +        expectedEventCount = eventCount * params.getSubscriberCount();, +        subscriberClass = getSubscriberClassForThreadMode();, +    }, +, +    @Override, +    public void prepareTest() {, +        try {, +            Constructor<?> constructor = subscriberClass.getConstructor(PerfTestEventBus.class);, +            for (int i = 0; i < params.getSubscriberCount(); i++) {, +                Object subscriber = constructor.newInstance(this);, +                subscribers.add(subscriber);, +            }, +        } catch (Exception e) {, +            throw new RuntimeException(e);, +        }, +    }, +, +    private Class<?> getSubscriberClassForThreadMode() {, +        switch (params.getThreadMode()) {, +        case MainThread:, +            return SubscribeClassEventBusMain.class;, +        case BackgroundThread:, +            return SubscribeClassEventBusBackground.class;, +        case Async:, +            return SubscriberClassEventBusAsync.class;, +        case PostThread:, +            return SubscribeClassEventBusDefault.class;, +        default:, +            throw new RuntimeException("Unknown: " + params.getThreadMode());, +        }, +    }, +, +    public static class Post extends PerfTestEventBus {, +        public Post(Context context, TestParams params) {, +            super(context, params);, +        }, +, +        @Override, +        public void prepareTest() {, +            super.prepareTest();, +            super.registerSubscribers();, +        }, +, +        public void runTest() {, +            long timeStart = System.nanoTime();, +            for (int i = 0; i < super.eventCount; i++) {, +                super.eventBus.post(new TestEvent());, +                if (canceled) {, +                    break;, +                }, +            }, +            long timeAfterPosting = System.nanoTime();, +            waitForReceivedEventCount(super.expectedEventCount);, +            long timeAllReceived = System.nanoTime();, +, +            primaryResultMicros = (timeAfterPosting - timeStart) / 1000;, +            primaryResultCount = super.expectedEventCount;, +            long deliveredMicros = (timeAllReceived - timeStart) / 1000;, +            int deliveryRate = (int) (primaryResultCount / (deliveredMicros / 1000000d));, +            otherTestResults = "Post and delivery time: " + deliveredMicros + " micros<br/>" + //, +                    "Post and delivery rate: " + deliveryRate + "/s";, +        }]
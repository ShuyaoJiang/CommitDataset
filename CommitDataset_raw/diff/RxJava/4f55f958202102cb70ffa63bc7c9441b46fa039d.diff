[+++ b/rxjava-core/src/test/java/rx/subjects/ReplaySubjectConcurrencyTest.java, +import java.util.*;, +import rx.observers.TestSubscriber;, +import rx.schedulers.Schedulers;, +    /**, +     * https://github.com/Netflix/RxJava/issues/1147, +     */, +    @Test, +    public void testRaceForTerminalState() {, +        final List<Integer> expected = Arrays.asList(1);, +        for (int i = 0; i < 100000; i++) {, +            TestSubscriber<Integer> ts = new TestSubscriber<Integer>();, +            Observable.just(1).subscribeOn(Schedulers.computation()).cache().subscribe(ts);, +            ts.awaitTerminalEvent();, +            ts.assertReceivedOnNext(expected);, +            ts.assertTerminalEvent();, +        }, +    }, +]
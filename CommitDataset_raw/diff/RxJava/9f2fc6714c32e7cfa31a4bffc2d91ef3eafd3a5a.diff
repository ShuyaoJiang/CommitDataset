[+++ b/src/main/java/rx/internal/operators/OnSubscribeRedo.java, +                    boolean done;, +                        if (!done) {, +                            done = true;, +                    }, +                        if (!done) {, +                            done = true;, +                    }, +                        if (!done) {, +                    }, +++ b/src/main/java/rx/internal/operators/OnSubscribeRedo.java, +                    boolean done;, +                        if (!done) {, +                            done = true;, +                    }, +                        if (!done) {, +                            done = true;, +                    }, +                        if (!done) {, +                    }, +++ b/src/main/java/rx/internal/operators/OperatorRetryWithPredicate.java, +                            boolean done;, +                                if (!done) {, +                                    done = true;, +                            }, +                                if (!done) {, +                                    done = true;, +                            }, +                                if (!done) {, +                            }, +++ b/src/main/java/rx/internal/operators/OnSubscribeRedo.java, +                    boolean done;, +                        if (!done) {, +                            done = true;, +                    }, +                        if (!done) {, +                            done = true;, +                    }, +                        if (!done) {, +                    }, +++ b/src/main/java/rx/internal/operators/OperatorRetryWithPredicate.java, +                            boolean done;, +                                if (!done) {, +                                    done = true;, +                            }, +                                if (!done) {, +                                    done = true;, +                            }, +                                if (!done) {, +                            }, +++ b/src/test/java/rx/internal/operators/OperatorRetryWithPredicateTest.java, +import static org.mockito.Matchers.any;, +import static org.mockito.Mockito.*;, +, +import java.io.IOException;, +import java.util.Collections;, +import java.util.concurrent.TimeUnit;, +import java.util.concurrent.atomic.*;, +, +, +import rx.*;, +import rx.functions.*;, +import rx.observers.TestSubscriber;, +    , +    @Test, +    public void testIssue2826() {, +        TestSubscriber<Integer> ts = new TestSubscriber<Integer>();, +        final RuntimeException e = new RuntimeException("You shall not pass");, +        final AtomicInteger c = new AtomicInteger();, +        Observable.just(1).map(new Func1<Integer, Integer>() {, +            @Override, +            public Integer call(Integer t1) {, +                c.incrementAndGet();, +                throw e;, +            }, +        }).retry(retry5).subscribe(ts);, +, +        ts.assertTerminalEvent();, +        assertEquals(6, c.get());, +        assertEquals(Collections.singletonList(e), ts.getOnErrorEvents());, +    }, +    @Test, +    public void testJustAndRetry() throws Exception {, +        final AtomicBoolean throwException = new AtomicBoolean(true);, +        int value = Observable.just(1).map(new Func1<Integer, Integer>() {, +            @Override, +            public Integer call(Integer t1) {, +                if (throwException.compareAndSet(true, false)) {, +                    throw new TestException();, +                }, +                return t1;, +            }, +        }).retry(1).toBlocking().single();, +, +        assertEquals(1, value);, +    }]
[+++ b/guava-tests/test/com/google/common/hash/BloomFilterTest.java, +import javax.annotation.Nullable;, +, +  public void testEqualsWithCustomFunnel() {, +    BloomFilter<Long> bf1 = BloomFilter.create(new CustomFunnel(), 100);, +    BloomFilter<Long> bf2 = BloomFilter.create(new CustomFunnel(), 100);, +    assertEquals(bf1, bf2);, +  }, +, +  public void testSerializationWithCustomFunnel() {, +    SerializableTester.reserializeAndAssert(BloomFilter.create(new CustomFunnel(), 100));, +  }, +, +  private static final class CustomFunnel implements Funnel<Long> {, +    @Override, +    public void funnel(Long value, PrimitiveSink into) {, +      into.putLong(value);, +    }, +    @Override, +    public boolean equals(@Nullable Object object) {, +      return (object instanceof CustomFunnel);, +    }, +    @Override, +    public int hashCode() {, +      return 42;, +    }, +  }, +, +, +    SerializableTester.reserializeAndAssert(bf);, +    assertEquals(1, BloomFilterStrategies.values().length);, +    assertEquals(BloomFilterStrategies.MURMUR128_MITZ_32, BloomFilterStrategies.values()[0]);, +++ b/guava-tests/test/com/google/common/hash/BloomFilterTest.java, +import javax.annotation.Nullable;, +, +  public void testEqualsWithCustomFunnel() {, +    BloomFilter<Long> bf1 = BloomFilter.create(new CustomFunnel(), 100);, +    BloomFilter<Long> bf2 = BloomFilter.create(new CustomFunnel(), 100);, +    assertEquals(bf1, bf2);, +  }, +, +  public void testSerializationWithCustomFunnel() {, +    SerializableTester.reserializeAndAssert(BloomFilter.create(new CustomFunnel(), 100));, +  }, +, +  private static final class CustomFunnel implements Funnel<Long> {, +    @Override, +    public void funnel(Long value, PrimitiveSink into) {, +      into.putLong(value);, +    }, +    @Override, +    public boolean equals(@Nullable Object object) {, +      return (object instanceof CustomFunnel);, +    }, +    @Override, +    public int hashCode() {, +      return 42;, +    }, +  }, +, +, +    SerializableTester.reserializeAndAssert(bf);, +    assertEquals(1, BloomFilterStrategies.values().length);, +    assertEquals(BloomFilterStrategies.MURMUR128_MITZ_32, BloomFilterStrategies.values()[0]);, +++ b/guava/src/com/google/common/hash/BloomFilter.java, +          && this.funnel.equals(that.funnel), +          && this.bits.equals(that.bits), +          && this.strategy.equals(that.strategy);]
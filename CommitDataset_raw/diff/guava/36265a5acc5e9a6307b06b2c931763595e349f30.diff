[+++ b/guava/src/com/google/common/util/concurrent/ServiceManager.java, +import com.google.common.collect.MultimapBuilder;, +import java.util.EnumSet;, +        MultimapBuilder.enumKeys(State.class).linkedHashSetValues().build();, +                  not(in(EnumSet.of(TERMINATED, FAILED)))));]
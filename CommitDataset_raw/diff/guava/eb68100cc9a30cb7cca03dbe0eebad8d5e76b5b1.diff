[+++ b/guava-tests/test/com/google/common/util/concurrent/ServiceManagerTest.java, +   * Tests that a ServiceManager can be fully shut down if one of its failure listeners is slow or, +   * even permanently blocked., +    final CountDownLatch failLeave = new CountDownLatch(1);, +    final CountDownLatch afterStarted = new CountDownLatch(1);, +            // We need to wait for the main thread to leave the ServiceManager.startAsync call to, +            // ensure that the thread running the failure callbacks is not the main thread., +            Uninterruptibles.awaitUninterruptibly(afterStarted);, +        // block until after the service manager is shutdown, +        Uninterruptibles.awaitUninterruptibly(failLeave);, +    manager.startAsync();, +    afterStarted.countDown();, +    failLeave.countDown();  // release the background thread]
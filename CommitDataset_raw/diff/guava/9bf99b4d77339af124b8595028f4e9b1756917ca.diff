[+++ b/guava/src/com/google/common/cache/LocalCache.java, +    // https://code.google.com/p/android/issues/detail?id=36519 / http://r.android.com/47508, +      return toArrayList(this).toArray();, +      return toArrayList(this).toArray(a);, +    }, +  private static <E> ArrayList<E> toArrayList(Collection<E> c) {, +    ArrayList<E> result = new ArrayList<E>(c.size());, +    Iterators.addAll(result, c.iterator());, +, +    // super.toArray() may misbehave if size() is inaccurate, at least on old versions of Android., +    // https://code.google.com/p/android/issues/detail?id=36519 / http://r.android.com/47508, +, +    @Override, +    public Object[] toArray() {, +      return toArrayList(this).toArray();, +    }, +, +    @Override, +    public <E> E[] toArray(E[] a) {, +      return toArrayList(this).toArray(a);, +    }, +++ b/guava/src/com/google/common/cache/LocalCache.java, +    // https://code.google.com/p/android/issues/detail?id=36519 / http://r.android.com/47508, +      return toArrayList(this).toArray();, +      return toArrayList(this).toArray(a);, +    }, +  private static <E> ArrayList<E> toArrayList(Collection<E> c) {, +    ArrayList<E> result = new ArrayList<E>(c.size());, +    Iterators.addAll(result, c.iterator());, +, +    // super.toArray() may misbehave if size() is inaccurate, at least on old versions of Android., +    // https://code.google.com/p/android/issues/detail?id=36519 / http://r.android.com/47508, +, +    @Override, +    public Object[] toArray() {, +      return toArrayList(this).toArray();, +    }, +, +    @Override, +    public <E> E[] toArray(E[] a) {, +      return toArrayList(this).toArray(a);, +    }, +++ b/guava/src/com/google/common/collect/MapMakerInternalMap.java, +import java.util.ArrayList;, +  final class KeySet extends SafeToArraySet<K> {, +, +    // super.toArray() may misbehave if size() is inaccurate, at least on old versions of Android., +    // https://code.google.com/p/android/issues/detail?id=36519 / http://r.android.com/47508, +, +    @Override, +    public Object[] toArray() {, +      return toArrayList(this).toArray();, +    }, +, +    @Override, +    public <E> E[] toArray(E[] a) {, +      return toArrayList(this).toArray(a);, +    }, +  final class EntrySet extends SafeToArraySet<Entry<K, V>> {, +  private abstract static class SafeToArraySet<E> extends AbstractSet<E> {, +    // super.toArray() may misbehave if size() is inaccurate, at least on old versions of Android., +    // https://code.google.com/p/android/issues/detail?id=36519 / http://r.android.com/47508, +, +    @Override, +    public Object[] toArray() {, +      return toArrayList(this).toArray();, +    }, +, +    @Override, +    public <E> E[] toArray(E[] a) {, +      return toArrayList(this).toArray(a);, +    }, +  }, +, +  private static <E> ArrayList<E> toArrayList(Collection<E> c) {, +    // Avoid calling ArrayList(Collection), which may call back into toArray., +    ArrayList<E> result = new ArrayList<E>(c.size());, +    Iterators.addAll(result, c.iterator());, +    return result;, +  }, +]
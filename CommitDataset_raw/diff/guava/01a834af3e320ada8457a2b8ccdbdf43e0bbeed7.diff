[+++ b/guava-tests/test/com/google/common/collect/BenchmarkHelpers.java, +import static com.google.common.base.Preconditions.checkState;, +, +import com.google.common.base.Equivalence;, +, +import java.util.concurrent.ConcurrentMap;, +    },, +    MapMakerStrongKeysStrongValues {, +      @Override, +      <K, V> Map<K, V> create(Map<K, V> map) {, +        // We use a "custom" equivalence to force MapMaker to make a MapMakerInternalMap., +        ConcurrentMap<K, V> newMap = new MapMaker().keyEquivalence(Equivalence.equals()).makeMap();, +        checkState(newMap instanceof MapMakerInternalMap);, +        newMap.putAll(map);, +        return newMap;, +      }, +    },, +    MapMakerStrongKeysWeakValues {, +      @Override, +      <K, V> Map<K, V> create(Map<K, V> map) {, +        ConcurrentMap<K, V> newMap = new MapMaker().weakValues().makeMap();, +        checkState(newMap instanceof MapMakerInternalMap);, +        newMap.putAll(map);, +        return newMap;, +      }, +    },, +    MapMakerWeakKeysStrongValues {, +      @Override, +      <K, V> Map<K, V> create(Map<K, V> map) {, +        ConcurrentMap<K, V> newMap = new MapMaker().weakKeys().makeMap();, +        checkState(newMap instanceof MapMakerInternalMap);, +        newMap.putAll(map);, +        return newMap;, +      }, +    },, +    MapMakerWeakKeysWeakValues {, +      @Override, +      <K, V> Map<K, V> create(Map<K, V> map) {, +        ConcurrentMap<K, V> newMap = new MapMaker().weakKeys().weakValues().makeMap();, +        checkState(newMap instanceof MapMakerInternalMap);, +        newMap.putAll(map);, +        return newMap;, +      }]
[+++ b/guava-tests/test/com/google/common/cache/CacheBuilderFactory.java, +import com.google.common.cache.LocalCacheInternalMap.Strength;, +++ b/guava-tests/test/com/google/common/cache/CacheBuilderFactory.java, +import com.google.common.cache.LocalCacheInternalMap.Strength;, +++ b/guava-tests/test/com/google/common/cache/CacheBuilderTest.java, +    LocalCacheInternalMap<?, ?> map = CacheTesting.toLocalCacheInternalMap(cache);, +    LocalCacheInternalMap<?, ?> map = CacheTesting.toLocalCacheInternalMap(cache);, +    LocalCacheInternalMap<?, ?> map = CacheTesting.toLocalCacheInternalMap(cache);, +    LocalCacheInternalMap<?, ?> map = CacheTesting.toLocalCacheInternalMap(cache);, +++ b/guava-tests/test/com/google/common/cache/CacheBuilderFactory.java, +import com.google.common.cache.LocalCacheInternalMap.Strength;, +++ b/guava-tests/test/com/google/common/cache/CacheBuilderTest.java, +    LocalCacheInternalMap<?, ?> map = CacheTesting.toLocalCacheInternalMap(cache);, +    LocalCacheInternalMap<?, ?> map = CacheTesting.toLocalCacheInternalMap(cache);, +    LocalCacheInternalMap<?, ?> map = CacheTesting.toLocalCacheInternalMap(cache);, +    LocalCacheInternalMap<?, ?> map = CacheTesting.toLocalCacheInternalMap(cache);, +++ b/guava-tests/test/com/google/common/cache/CacheEvictionTest.java, +import com.google.common.cache.LocalCacheInternalMap.ReferenceEntry;, +++ b/guava-tests/test/com/google/common/cache/CacheBuilderFactory.java, +import com.google.common.cache.LocalCacheInternalMap.Strength;, +++ b/guava-tests/test/com/google/common/cache/CacheBuilderTest.java, +    LocalCacheInternalMap<?, ?> map = CacheTesting.toLocalCacheInternalMap(cache);, +    LocalCacheInternalMap<?, ?> map = CacheTesting.toLocalCacheInternalMap(cache);, +    LocalCacheInternalMap<?, ?> map = CacheTesting.toLocalCacheInternalMap(cache);, +    LocalCacheInternalMap<?, ?> map = CacheTesting.toLocalCacheInternalMap(cache);, +++ b/guava-tests/test/com/google/common/cache/CacheEvictionTest.java, +import com.google.common.cache.LocalCacheInternalMap.ReferenceEntry;, +++ b/guava-tests/test/com/google/common/cache/CacheReferencesTest.java, +import static com.google.common.cache.LocalCacheInternalMap.Strength.STRONG;, +import com.google.common.cache.LocalCacheInternalMap.Strength;, +++ b/guava-tests/test/com/google/common/cache/CacheBuilderFactory.java, +import com.google.common.cache.LocalCacheInternalMap.Strength;, +++ b/guava-tests/test/com/google/common/cache/CacheBuilderTest.java, +    LocalCacheInternalMap<?, ?> map = CacheTesting.toLocalCacheInternalMap(cache);, +    LocalCacheInternalMap<?, ?> map = CacheTesting.toLocalCacheInternalMap(cache);, +    LocalCacheInternalMap<?, ?> map = CacheTesting.toLocalCacheInternalMap(cache);, +    LocalCacheInternalMap<?, ?> map = CacheTesting.toLocalCacheInternalMap(cache);, +++ b/guava-tests/test/com/google/common/cache/CacheEvictionTest.java, +import com.google.common.cache.LocalCacheInternalMap.ReferenceEntry;, +++ b/guava-tests/test/com/google/common/cache/CacheReferencesTest.java, +import static com.google.common.cache.LocalCacheInternalMap.Strength.STRONG;, +import com.google.common.cache.LocalCacheInternalMap.Strength;, +++ b/guava-tests/test/com/google/common/cache/CacheTesting.java, +import com.google.common.cache.LocalCacheInternalMap.ReferenceEntry;, +import com.google.common.cache.LocalCacheInternalMap.Segment;, +import com.google.common.cache.LocalCacheInternalMap.ValueReference;, +    LocalCacheInternalMap<K, V> map = toLocalCacheInternalMap(cache);, +    LocalCacheInternalMap<K, V> map = toLocalCacheInternalMap(cache);, +   * Gets the {@link LocalCacheInternalMap} used by the given {@link Cache}, if any, or throws an, +   * IllegalArgumentException if this is a Cache type that doesn't have a LocalCacheInternalMap., +  static <K, V> LocalCacheInternalMap<K, V> toLocalCacheInternalMap(Cache<K, V> cache) {, +        + " doesn't have a LocalCacheInternalMap.");, +   * Determines whether the given cache can be converted to a LocalCacheInternalMap by, +   * {@link #toLocalCacheInternalMap} without throwing an exception., +  static boolean hasLocalCacheInternalMap(Cache<?, ?> cache) {, +    if (hasLocalCacheInternalMap(cache)) {, +      LocalCacheInternalMap<?, ?> map = toLocalCacheInternalMap(cache);, +    if (hasLocalCacheInternalMap(cache)) {, +      drainReferenceQueues(toLocalCacheInternalMap(cache));, +  static void drainReferenceQueues(LocalCacheInternalMap<?, ?> cchm) {, +    for (LocalCacheInternalMap.Segment segment : cchm.segments) {, +  static void drainReferenceQueue(LocalCacheInternalMap.Segment<?, ?> segment) {, +    LocalCacheInternalMap<?, ?> map = toLocalCacheInternalMap(cache);, +    if (hasLocalCacheInternalMap(cache)) {, +      checkValidState(toLocalCacheInternalMap(cache));, +  static void checkValidState(LocalCacheInternalMap<?, ?> cchm) {, +    if (hasLocalCacheInternalMap(cache)) {, +      checkExpiration(toLocalCacheInternalMap(cache));, +  static void checkExpiration(LocalCacheInternalMap<?, ?> cchm) {, +    if (hasLocalCacheInternalMap(cache)) {, +      checkEviction(toLocalCacheInternalMap(cache));, +  static void checkEviction(LocalCacheInternalMap<?, ?> map) {, +    LocalCacheInternalMap<?, ?> cchm = toLocalCacheInternalMap(cache);, +    LocalCacheInternalMap<?, ?> cchm = toLocalCacheInternalMap(cache);, +    if (hasLocalCacheInternalMap(cache)) {, +      LocalCacheInternalMap<?, ?> cchm = toLocalCacheInternalMap(cache);, +    if (hasLocalCacheInternalMap(cache)) {, +      LocalCacheInternalMap<Integer, Integer> cchm = toLocalCacheInternalMap(cache);, +    expireEntries(toLocalCacheInternalMap(cache), expiringTime, ticker);, +      LocalCacheInternalMap<?, ?> cchm, long expiringTime, FakeTicker ticker) {, +    if (map instanceof LocalCacheInternalMap) {, +      LocalCacheInternalMap<?, ?> cchm = (LocalCacheInternalMap<?, ?>) map;, +      for (LocalCacheInternalMap.Segment segment : cchm.segments) {, +++ b/guava-tests/test/com/google/common/cache/CacheBuilderFactory.java, +import com.google.common.cache.LocalCacheInternalMap.Strength;, +++ b/guava-tests/test/com/google/common/cache/CacheBuilderTest.java, +    LocalCacheInternalMap<?, ?> map = CacheTesting.toLocalCacheInternalMap(cache);, +    LocalCacheInternalMap<?, ?> map = CacheTesting.toLocalCacheInternalMap(cache);, +    LocalCacheInternalMap<?, ?> map = CacheTesting.toLocalCacheInternalMap(cache);, +    LocalCacheInternalMap<?, ?> map = CacheTesting.toLocalCacheInternalMap(cache);, +++ b/guava-tests/test/com/google/common/cache/CacheEvictionTest.java, +import com.google.common.cache.LocalCacheInternalMap.ReferenceEntry;, +++ b/guava-tests/test/com/google/common/cache/CacheReferencesTest.java, +import static com.google.common.cache.LocalCacheInternalMap.Strength.STRONG;, +import com.google.common.cache.LocalCacheInternalMap.Strength;, +++ b/guava-tests/test/com/google/common/cache/CacheTesting.java, +import com.google.common.cache.LocalCacheInternalMap.ReferenceEntry;, +import com.google.common.cache.LocalCacheInternalMap.Segment;, +import com.google.common.cache.LocalCacheInternalMap.ValueReference;, +    LocalCacheInternalMap<K, V> map = toLocalCacheInternalMap(cache);]
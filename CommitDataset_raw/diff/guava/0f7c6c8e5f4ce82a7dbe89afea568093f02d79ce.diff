[+++ b/guava/src/com/google/common/cache/LocalCache.java, +import com.google.common.collect.Iterators;, +import java.util.ArrayList;, +, +    // super.toArray() may misbehave if size() is inaccurate, at least on old versions of Android., +    // https://code.google.com/p/android/issues/detail?id=36519, +, +    @Override, +    public Object[] toArray() {, +      return toArrayList().toArray();, +    }, +, +    @Override, +    public <E> E[] toArray(E[] a) {, +      return toArrayList().toArray(a);, +    }, +, +    private ArrayList<T> toArrayList() {, +      // Avoid calling ArrayList(Collection), which may call back into toArray., +      ArrayList<T> result = new ArrayList<T>(size());, +      Iterators.addAll(result, iterator());, +      return result;, +    }, +]
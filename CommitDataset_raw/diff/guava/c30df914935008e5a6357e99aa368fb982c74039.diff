[+++ b/guava-gwt/test/com/google/common/collect/StreamsTest_gwt.java, +++ b/guava-gwt/test/com/google/common/collect/StreamsTest_gwt.java, +++ b/guava-tests/test/com/google/common/collect/StreamsTest.java, +++ b/guava-gwt/test/com/google/common/collect/StreamsTest_gwt.java, +++ b/guava-tests/test/com/google/common/collect/StreamsTest.java, +++ b/guava/src/com/google/common/collect/CollectSpliterators.java, +    class FlatMapSpliterator implements Spliterator<T> {, +      @Nullable Spliterator<T> prefix;, +          Spliterator<T> prefix, Spliterator<F> from, int characteristics, long estimatedSize) {, +          Spliterator<T> result =, +              new FlatMapSpliterator(this.prefix, fromSplit, splitCharacteristics, estSplitSize);, +    return new FlatMapSpliterator(null, fromSpliterator, topCharacteristics, topSize);, +++ b/guava-gwt/test/com/google/common/collect/StreamsTest_gwt.java, +++ b/guava-tests/test/com/google/common/collect/StreamsTest.java, +++ b/guava/src/com/google/common/collect/CollectSpliterators.java, +    class FlatMapSpliterator implements Spliterator<T> {, +      @Nullable Spliterator<T> prefix;, +          Spliterator<T> prefix, Spliterator<F> from, int characteristics, long estimatedSize) {, +          Spliterator<T> result =, +              new FlatMapSpliterator(this.prefix, fromSplit, splitCharacteristics, estSplitSize);, +    return new FlatMapSpliterator(null, fromSpliterator, topCharacteristics, topSize);, +++ b/guava/src/com/google/common/collect/Streams.java, +        .onClose(, +            () -> {, +              for (Stream<? extends T> stream : streams) {, +                stream.close();, +              }, +            });, +    // TODO(lowasser): optimize this later, +    return Stream.of(streams).flatMapToInt(stream -> stream);, +    // TODO(lowasser): optimize this later, +    return Stream.of(streams).flatMapToLong(stream -> stream);, +    // TODO(lowasser): optimize this later, +    return Stream.of(streams).flatMapToDouble(stream -> stream);]
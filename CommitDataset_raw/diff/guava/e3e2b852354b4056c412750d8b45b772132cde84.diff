[+++ b/test/com/google/common/base/EquivalencesTest.java, +import com.google.common.collect.Maps;, +import java.util.Map;, +  , +  public void testComposition() {, +    Map<String, Integer> elements = Maps.newHashMap();, +    elements.put("a1", new Integer(1));, +    , +    elements.put("b1", new Integer(2));, +    elements.put("b2", new Integer(2));, +    , +    elements.put("c1", new Integer(3));, +    elements.put("c2", new Integer(3));, +    elements.put("c3", new Integer(3));, +    , +    Function<String, Integer> elementToPartition = Functions.forMap(elements);, +    Equivalence<String> eq = Equivalences.compose(Equivalences.equals(), elementToPartition);, +    , +    new EqualsTester(), +        .addEqualityGroup(, +            Equivalences.wrap(eq, "a1")), +        .addEqualityGroup(, +            Equivalences.wrap(eq, "b1"), Equivalences.wrap(eq, "b2")), +        .addEqualityGroup(, +            Equivalences.wrap(eq, "c1"), Equivalences.wrap(eq, "c2"), Equivalences.wrap(eq, "c3")), +        .testEquals();, +  }]
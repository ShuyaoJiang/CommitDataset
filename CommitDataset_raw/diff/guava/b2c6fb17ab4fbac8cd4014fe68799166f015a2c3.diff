[+++ b/guava-tests/test/com/google/common/cache/AbstractCacheTest.java, +import com.google.common.collect.ImmutableMap;, +  public void testGetIfPresent() {, +  public void testGetAllPresent_empty() {, +    Cache<Object, Object> cache = new AbstractCache<Object, Object>() {, +      @Override, +      public Object getIfPresent(Object key) {, +        return null;, +      }, +    };, +, +    assertEquals(, +        ImmutableMap.of(),, +        cache.getAllPresent(ImmutableList.of(new Object())));, +  }, +, +  public void testGetAllPresent_cached() {, +    final Object cachedKey = new Object();, +    final Object cachedValue = new Object();, +    Cache<Object, Object> cache = new AbstractCache<Object, Object>() {, +      @Override, +      public Object getIfPresent(Object key) {, +        return cachedKey.equals(key) ? cachedValue : null;, +      }, +    };, +, +    assertEquals(, +        ImmutableMap.of(cachedKey, cachedValue),, +        cache.getAllPresent(ImmutableList.of(cachedKey, new Object())));, +  }, +, +++ b/guava-tests/test/com/google/common/cache/AbstractCacheTest.java, +import com.google.common.collect.ImmutableMap;, +  public void testGetIfPresent() {, +  public void testGetAllPresent_empty() {, +    Cache<Object, Object> cache = new AbstractCache<Object, Object>() {, +      @Override, +      public Object getIfPresent(Object key) {, +        return null;, +      }, +    };, +, +    assertEquals(, +        ImmutableMap.of(),, +        cache.getAllPresent(ImmutableList.of(new Object())));, +  }, +, +  public void testGetAllPresent_cached() {, +    final Object cachedKey = new Object();, +    final Object cachedValue = new Object();, +    Cache<Object, Object> cache = new AbstractCache<Object, Object>() {, +      @Override, +      public Object getIfPresent(Object key) {, +        return cachedKey.equals(key) ? cachedValue : null;, +      }, +    };, +, +    assertEquals(, +        ImmutableMap.of(cachedKey, cachedValue),, +        cache.getAllPresent(ImmutableList.of(cachedKey, new Object())));, +  }, +, +++ b/guava/src/com/google/common/cache/AbstractCache.java, +        V value = getIfPresent(key);, +        if (value != null) {, +          result.put(castKey, value);, +        }]
[+++ b/guava/src/com/google/common/graph/ConfigurableMutableValueGraph.java, +      checkArgument(!nodeU.equals(nodeV), SELF_LOOPS_NOT_ALLOWED, nodeU);, +    GraphConnections<N, V> connectionsU = nodeConnections.get(nodeU);, +++ b/guava/src/com/google/common/graph/ConfigurableMutableValueGraph.java, +      checkArgument(!nodeU.equals(nodeV), SELF_LOOPS_NOT_ALLOWED, nodeU);, +    GraphConnections<N, V> connectionsU = nodeConnections.get(nodeU);, +++ b/guava/src/com/google/common/graph/ConfigurableNetwork.java, +    if (!allowsSelfLoops && nodeU == nodeV) { // just an optimization, only check reference equality]
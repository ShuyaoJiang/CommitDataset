[+++ b/guava/src/com/google/common/reflect/ClassPath.java, +    private void scanDirectory(File directory, ClassLoader classloader) throws IOException {, +      scanDirectory(directory, classloader, "", ImmutableSet.<File>of());, +        File directory, ClassLoader classloader, String packagePrefix,, +        ImmutableSet<File> ancestors) throws IOException {, +      File canonical = directory.getCanonicalFile();, +      if (ancestors.contains(canonical)) {, +        // A cycle in the filesystem, for example due to a symbolic link., +        return;, +      }, +      ImmutableSet<File> newAncestors = ImmutableSet.<File>builder(), +          .addAll(ancestors), +          .add(canonical), +          .build();, +          scanDirectory(f, classloader, packagePrefix + name + "/", newAncestors);]
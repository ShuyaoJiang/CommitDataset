[+++ b/src/asciidoc/index.adoc, +The __Web__ layer consists of the Web, Web-Servlet, WebSocket and Web-Portlet modules., +, +This part of the reference documentation covers Spring Framework's support for the, +presentation tier (and specifically web-based presentation tiers) including support, +for WebSocket-style messaging in web applications., +Spring Framework's own web framework, <<mvc,Spring Web MVC>>, is covered in the, +first couple of chapters. Subsequent chapters are concerned with Spring Framework's, +Following that is coverage of Spring Framework's MVC <<portlet,portlet framework>>., +, +The section then concludes with comprehensive coverage of the Spring Framework, +<<websocket>> (including <<websocket-stomp>>)., +* <<websocket>>, +[[websocket]], +== WebSocket Support, +This part of the reference documentation covers Spring Framework's support for, +WebSocket-style messaging in web applications including use of STOMP as an, +application level WebSocket sub-protocol., +, +<<websocket-intro>> establishes a frame of mind in which to think about, +WebSocket covering adoption challenges, design considerations, and thoughts on, +it is a good fit., +, +<<websocket-server>> reviews the Spring WebSocket API on the, +server-side while <<websocket-fallback>> explains the SockJS protocol and shows, +how to configure and use it., +, +<<websocket-stomp-overview>> introduces the STOMP messaging protocol., +, +, +, +, +[[websocket-intro]], +=== Introduction, +The WebSocket protocol http://tools.ietf.org/html/rfc6455[RFC 6455] defines an important, +new capability for web applications: full-duplex, two-way communication between client, +and server. It is an exciting new capability on the heels of a long history of, +techniques to make the web more interactive including Java applets, XMLHttpRequest,, +Adobe Flash, ActiveXObject, various Comet techniques, server-sent events, and others., +, +A proper introduction of the WebSocket protocol is beyond the scope of this, +document. At a minimum however it's important to understand that HTTP is used only for, +the initial handshake, which relies on a mechanism built into HTTP to request, +a protocol upgrade (or in this case a protocol switch) to which the server can respond with, +HTTP status 101 (switching protocols) if it agrees. Assuming the handshake succeeds, +the TCP socket underlying the HTTP upgrade request remains open and both client and, +server can use it to send messages to each other., +, +Spring Framework 4 includes a new `spring-websocket` module with comprehensive, +WebSocket support. It is compatible with the Java WebSocket API standard (JSR-356), +and also provides additional value-add as explained in the rest of the introduction., +, +, +, +[[websocket-into-fallback-options]], +==== Fallback Options, +An important challenge to adoption is the lack of support for WebSocket in some, +browsers. Notably the first Internet Explorer version to support WebSocket is, +version 10 (see http://caniuse.com/websockets for support by browser versions)., +Furthermore some restrictive proxies, +may be configured in ways that either preclude the attempt to do HTTP upgrade, +or otherwise break connection after some time because it has remained opened, +for too long. For a good overview on this topic see, +http://www.infoq.com/articles/Web-Sockets-Proxy-Servers[this article]., +, +Therefore to build a WebSocket application today, fallback options are required, +to simulate the WebSocket API where necessary., +Spring Framework provides such transparent fallback, +options based on the https://github.com/sockjs/sockjs-protocol[SockJS protocol]., +These options can be enabled through configuration and do not require, +modifying the application otherwise., +, +, +, +[[websocket-intro-architecture]], +==== Messaging Architecture, +Aside from short-to-midterm adoption challenges using WebSocket, +brings up important design considerations that are important to recognize, +early on especially in contrast to what we know about building web applications today., +, +Today REST is a widely accepted, understood, and supported, +architecture for building web applications. It is an architecture that relies, +on having many URLs (nouns), a handful of HTTP methods (verbs), and, +other principles such as using hypermedia (links), remaining stateless, etc., +, +By contrast a WebSocket application may use a single URL only for the, +initial HTTP handshake. All messages thereafter share and flow on the, +same TCP connection. This points to an entirely different, asynchronous,, +event-driven, messaging architecture. One that is much closer, +to traditional messaging applications (e.g. JMS, AMQP)., +, +Spring Framework 4 includes a new `spring-messaging` module with key, +abstractions from the, +http://projects.spring.io/spring-integration/[Spring Integration] project, +such as `Message`, `MessageChannel`, `MessageHandler` and others that can serve as, +a foundation for such a messaging architecture. The module also includes a, +set of annotations for mapping messages to methods similar to the Spring MVC, +annotation based programming model., +, +]
[+++ b/spring-web/src/main/java/org/springframework/web/context/request/ServletRequestAttributes.java, + * Copyright 2002-2013 the original author or authors., +import java.util.concurrent.ConcurrentHashMap;, +	private final Map<String, Object> sessionAttributesToUpdate = new ConcurrentHashMap<String, Object>(1);, +++ b/spring-web/src/main/java/org/springframework/web/context/request/ServletRequestAttributes.java, + * Copyright 2002-2013 the original author or authors., +import java.util.concurrent.ConcurrentHashMap;, +	private final Map<String, Object> sessionAttributesToUpdate = new ConcurrentHashMap<String, Object>(1);, +++ b/spring-webmvc-portlet/src/main/java/org/springframework/web/portlet/context/PortletRequestAttributes.java, + * Copyright 2002-2013 the original author or authors., +import java.util.concurrent.ConcurrentHashMap;, +	private final Map<String, Object> sessionAttributesToUpdate = new ConcurrentHashMap<String, Object>(1);, +	private final Map<String, Object> globalSessionAttributesToUpdate = new ConcurrentHashMap<String, Object>(1);, +			try {, +			catch (IllegalStateException ex) {, +				// Session invalidated - shouldn't usually happen., +		this.sessionAttributesToUpdate.clear();, +		this.globalSessionAttributesToUpdate.clear();, +	}]
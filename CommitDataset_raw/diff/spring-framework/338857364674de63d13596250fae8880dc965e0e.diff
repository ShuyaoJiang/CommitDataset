[+++ b/spring-context/src/main/java/org/springframework/context/event/AbstractApplicationEventMulticaster.java, +import org.springframework.beans.factory.BeanClassLoaderAware;, +import org.springframework.beans.factory.config.ConfigurableBeanFactory;, +import org.springframework.util.ClassUtils;, +public abstract class AbstractApplicationEventMulticaster, +		implements ApplicationEventMulticaster, BeanClassLoaderAware, BeanFactoryAware {, +	private ClassLoader beanClassLoader;, +, +	public void setBeanClassLoader(ClassLoader classLoader) {, +		this.beanClassLoader = classLoader;, +	}, +, +	@Override, +	public void setBeanFactory(BeanFactory beanFactory) {, +		if (this.beanClassLoader == null && beanFactory instanceof ConfigurableBeanFactory) {, +			this.beanClassLoader = ((ConfigurableBeanFactory) beanFactory).getBeanClassLoader();, +		}, +			if (this.beanClassLoader == null ||, +					(ClassUtils.isCacheSafe(eventType, this.beanClassLoader) &&, +							(sourceType == null || ClassUtils.isCacheSafe(sourceType, this.beanClassLoader)))) {, +			}]
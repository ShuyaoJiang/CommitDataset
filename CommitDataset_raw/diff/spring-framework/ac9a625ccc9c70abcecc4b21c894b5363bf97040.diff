[+++ b/org.springframework.oxm/.classpath, +	<classpathentry kind="var" path="IVY_CACHE/com.thoughtworks.xstream/com.springsource.com.thoughtworks.xstream/1.3.1/com.springsource.com.thoughtworks.xstream-1.3.1.jar" sourcepath="/IVY_CACHE/com.thoughtworks.xstream/com.springsource.com.thoughtworks.xstream/1.3.1/com.springsource.com.thoughtworks.xstream-sources-1.3.1.jar"/>, +++ b/org.springframework.oxm/.classpath, +	<classpathentry kind="var" path="IVY_CACHE/com.thoughtworks.xstream/com.springsource.com.thoughtworks.xstream/1.3.1/com.springsource.com.thoughtworks.xstream-1.3.1.jar" sourcepath="/IVY_CACHE/com.thoughtworks.xstream/com.springsource.com.thoughtworks.xstream/1.3.1/com.springsource.com.thoughtworks.xstream-sources-1.3.1.jar"/>, +++ b/org.springframework.oxm/ivy.xml, +		<dependency org="com.thoughtworks.xstream" name="com.springsource.com.thoughtworks.xstream" rev="1.3.1", +++ b/org.springframework.oxm/.classpath, +	<classpathentry kind="var" path="IVY_CACHE/com.thoughtworks.xstream/com.springsource.com.thoughtworks.xstream/1.3.1/com.springsource.com.thoughtworks.xstream-1.3.1.jar" sourcepath="/IVY_CACHE/com.thoughtworks.xstream/com.springsource.com.thoughtworks.xstream/1.3.1/com.springsource.com.thoughtworks.xstream-sources-1.3.1.jar"/>, +++ b/org.springframework.oxm/ivy.xml, +		<dependency org="com.thoughtworks.xstream" name="com.springsource.com.thoughtworks.xstream" rev="1.3.1", +++ b/org.springframework.oxm/oxm.iml, +          <root url="jar://$IVY_CACHE$/com.thoughtworks.xstream/com.springsource.com.thoughtworks.xstream/1.3.1/com.springsource.com.thoughtworks.xstream-1.3.1.jar!/" />, +        <SOURCES>, +          <root url="jar://$IVY_CACHE$/com.thoughtworks.xstream/com.springsource.com.thoughtworks.xstream/1.3.1/com.springsource.com.thoughtworks.xstream-sources-1.3.1.jar!/" />, +        </SOURCES>, +++ b/org.springframework.oxm/.classpath, +	<classpathentry kind="var" path="IVY_CACHE/com.thoughtworks.xstream/com.springsource.com.thoughtworks.xstream/1.3.1/com.springsource.com.thoughtworks.xstream-1.3.1.jar" sourcepath="/IVY_CACHE/com.thoughtworks.xstream/com.springsource.com.thoughtworks.xstream/1.3.1/com.springsource.com.thoughtworks.xstream-sources-1.3.1.jar"/>, +++ b/org.springframework.oxm/ivy.xml, +		<dependency org="com.thoughtworks.xstream" name="com.springsource.com.thoughtworks.xstream" rev="1.3.1", +++ b/org.springframework.oxm/oxm.iml, +          <root url="jar://$IVY_CACHE$/com.thoughtworks.xstream/com.springsource.com.thoughtworks.xstream/1.3.1/com.springsource.com.thoughtworks.xstream-1.3.1.jar!/" />, +        <SOURCES>, +          <root url="jar://$IVY_CACHE$/com.thoughtworks.xstream/com.springsource.com.thoughtworks.xstream/1.3.1/com.springsource.com.thoughtworks.xstream-sources-1.3.1.jar!/" />, +        </SOURCES>, +++ b/org.springframework.oxm/pom.xml, +			<version>1.3.1</version>, +++ b/org.springframework.oxm/.classpath, +	<classpathentry kind="var" path="IVY_CACHE/com.thoughtworks.xstream/com.springsource.com.thoughtworks.xstream/1.3.1/com.springsource.com.thoughtworks.xstream-1.3.1.jar" sourcepath="/IVY_CACHE/com.thoughtworks.xstream/com.springsource.com.thoughtworks.xstream/1.3.1/com.springsource.com.thoughtworks.xstream-sources-1.3.1.jar"/>, +++ b/org.springframework.oxm/ivy.xml, +		<dependency org="com.thoughtworks.xstream" name="com.springsource.com.thoughtworks.xstream" rev="1.3.1", +++ b/org.springframework.oxm/oxm.iml, +          <root url="jar://$IVY_CACHE$/com.thoughtworks.xstream/com.springsource.com.thoughtworks.xstream/1.3.1/com.springsource.com.thoughtworks.xstream-1.3.1.jar!/" />, +        <SOURCES>, +          <root url="jar://$IVY_CACHE$/com.thoughtworks.xstream/com.springsource.com.thoughtworks.xstream/1.3.1/com.springsource.com.thoughtworks.xstream-sources-1.3.1.jar!/" />, +        </SOURCES>, +++ b/org.springframework.oxm/pom.xml, +			<version>1.3.1</version>, +++ b/org.springframework.oxm/src/main/java/org/springframework/oxm/xstream/XStreamMarshaller.java, + * Copyright 2002-2010 the original author or authors., +import org.springframework.beans.factory.InitializingBean;, +import org.springframework.util.ClassUtils;, +			getXStream().marshal(graph, streamWriter);, +		finally {, +			try {, +				streamWriter.flush();, +			catch (Exception ex) {, +				logger.debug("Could not flush HierarchicalStreamWriter", ex);, +			}, +		}, +	}, +++ b/org.springframework.oxm/.classpath, +	<classpathentry kind="var" path="IVY_CACHE/com.thoughtworks.xstream/com.springsource.com.thoughtworks.xstream/1.3.1/com.springsource.com.thoughtworks.xstream-1.3.1.jar" sourcepath="/IVY_CACHE/com.thoughtworks.xstream/com.springsource.com.thoughtworks.xstream/1.3.1/com.springsource.com.thoughtworks.xstream-sources-1.3.1.jar"/>, +++ b/org.springframework.oxm/ivy.xml, +		<dependency org="com.thoughtworks.xstream" name="com.springsource.com.thoughtworks.xstream" rev="1.3.1", +++ b/org.springframework.oxm/oxm.iml, +          <root url="jar://$IVY_CACHE$/com.thoughtworks.xstream/com.springsource.com.thoughtworks.xstream/1.3.1/com.springsource.com.thoughtworks.xstream-1.3.1.jar!/" />, +        <SOURCES>, +          <root url="jar://$IVY_CACHE$/com.thoughtworks.xstream/com.springsource.com.thoughtworks.xstream/1.3.1/com.springsource.com.thoughtworks.xstream-sources-1.3.1.jar!/" />, +        </SOURCES>, +++ b/org.springframework.oxm/pom.xml, +			<version>1.3.1</version>, +++ b/org.springframework.oxm/src/main/java/org/springframework/oxm/xstream/XStreamMarshaller.java, + * Copyright 2002-2010 the original author or authors., +import org.springframework.beans.factory.InitializingBean;, +import org.springframework.util.ClassUtils;, +			getXStream().marshal(graph, streamWriter);, +		finally {, +			try {, +				streamWriter.flush();, +			catch (Exception ex) {, +				logger.debug("Could not flush HierarchicalStreamWriter", ex);, +			}, +		}, +	}, +++ b/org.springframework.oxm/src/test/java/org/springframework/oxm/xstream/XStreamMarshallerTests.java, + * Copyright 2002-2010 the original author or authors., +import com.thoughtworks.xstream.io.HierarchicalStreamWriter;, +import com.thoughtworks.xstream.io.json.JsonHierarchicalStreamDriver;, +import com.thoughtworks.xstream.io.json.JsonWriter;, +	public void jettisonDriver() throws Exception {, +	public void jsonDriver() throws Exception {, +		marshaller.setStreamDriver(new JsonHierarchicalStreamDriver() {, +			@Override, +			public HierarchicalStreamWriter createWriter(Writer writer) {, +				return new JsonWriter(writer, new char[0], "", JsonWriter.DROP_ROOT_MODE);, +			}, +		});, +, +		Writer writer = new StringWriter();, +		marshaller.marshal(flight, new StreamResult(writer));, +		assertEquals("Invalid result", "{\"flightNumber\": 42}", writer.toString());, +	}, +, +	@Test]
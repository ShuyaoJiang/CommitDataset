[+++ b/spring-web/src/main/java/org/springframework/web/util/UriComponentsBuilder.java, +	 * @see <a href="https://tools.ietf.org/html/rfc6454">RFC 6454</a>, +			// Handling of invalid origins as described in SPR-13478, +			int firstSlashIdx = hostString.indexOf("/");, +			if (firstSlashIdx != -1) {, +				hostString = hostString.substring(0, firstSlashIdx);, +			}, +++ b/spring-web/src/main/java/org/springframework/web/util/UriComponentsBuilder.java, +	 * @see <a href="https://tools.ietf.org/html/rfc6454">RFC 6454</a>, +			// Handling of invalid origins as described in SPR-13478, +			int firstSlashIdx = hostString.indexOf("/");, +			if (firstSlashIdx != -1) {, +				hostString = hostString.substring(0, firstSlashIdx);, +			}, +++ b/spring-web/src/test/java/org/springframework/web/util/WebUtilsTests.java, +, +		// Handling of invalid origins as described in SPR-13478, +		assertTrue(checkSameOrigin("mydomain1.com", -1, "http://mydomain1.com/"));, +		assertTrue(checkSameOrigin("mydomain1.com", -1, "http://mydomain1.com:80/"));, +		assertTrue(checkSameOrigin("mydomain1.com", -1, "http://mydomain1.com/path"));, +		assertTrue(checkSameOrigin("mydomain1.com", -1, "http://mydomain1.com:80/path"));, +		assertFalse(checkSameOrigin("mydomain2.com", -1, "http://mydomain1.com/"));, +		assertFalse(checkSameOrigin("mydomain2.com", -1, "http://mydomain1.com:80/"));, +		assertFalse(checkSameOrigin("mydomain2.com", -1, "http://mydomain1.com/path"));, +		assertFalse(checkSameOrigin("mydomain2.com", -1, "http://mydomain1.com:80/path"));]
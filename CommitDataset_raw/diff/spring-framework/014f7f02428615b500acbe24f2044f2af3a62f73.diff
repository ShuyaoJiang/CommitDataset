[+++ b/spring-context/src/main/java/org/springframework/context/support/AbstractApplicationContext.java, +		if (!beanFactory.containsLocalBean(SYSTEM_PROPERTIES_BEAN_NAME)) {, +		if (!beanFactory.containsLocalBean(SYSTEM_ENVIRONMENT_BEAN_NAME)) {, +++ b/spring-context/src/main/java/org/springframework/context/support/AbstractApplicationContext.java, +		if (!beanFactory.containsLocalBean(SYSTEM_PROPERTIES_BEAN_NAME)) {, +		if (!beanFactory.containsLocalBean(SYSTEM_ENVIRONMENT_BEAN_NAME)) {, +++ b/spring-context/src/test/java/org/springframework/context/support/EnvironmentIntegrationTests.java, +, +import static org.hamcrest.CoreMatchers.*;, + * Tests covering the integration of {@link Environment} into {@link ApplicationContext} hierarchies., +, +++ b/spring-context/src/main/java/org/springframework/context/support/AbstractApplicationContext.java, +		if (!beanFactory.containsLocalBean(SYSTEM_PROPERTIES_BEAN_NAME)) {, +		if (!beanFactory.containsLocalBean(SYSTEM_ENVIRONMENT_BEAN_NAME)) {, +++ b/spring-context/src/test/java/org/springframework/context/support/EnvironmentIntegrationTests.java, +, +import static org.hamcrest.CoreMatchers.*;, + * Tests covering the integration of {@link Environment} into {@link ApplicationContext} hierarchies., +, +++ b/spring-webmvc-portlet/src/main/java/org/springframework/web/portlet/FrameworkPortlet.java, +		pac.setEnvironment(getEnvironment());, +++ b/spring-context/src/main/java/org/springframework/context/support/AbstractApplicationContext.java, +		if (!beanFactory.containsLocalBean(SYSTEM_PROPERTIES_BEAN_NAME)) {, +		if (!beanFactory.containsLocalBean(SYSTEM_ENVIRONMENT_BEAN_NAME)) {, +++ b/spring-context/src/test/java/org/springframework/context/support/EnvironmentIntegrationTests.java, +, +import static org.hamcrest.CoreMatchers.*;, + * Tests covering the integration of {@link Environment} into {@link ApplicationContext} hierarchies., +, +++ b/spring-webmvc-portlet/src/main/java/org/springframework/web/portlet/FrameworkPortlet.java, +		pac.setEnvironment(getEnvironment());, +++ b/spring-webmvc-portlet/src/main/java/org/springframework/web/portlet/GenericPortletBean.java, +			bw.registerCustomEditor(Resource.class, new ResourceEditor(resourceLoader, getEnvironment()));, +++ b/spring-context/src/main/java/org/springframework/context/support/AbstractApplicationContext.java, +		if (!beanFactory.containsLocalBean(SYSTEM_PROPERTIES_BEAN_NAME)) {, +		if (!beanFactory.containsLocalBean(SYSTEM_ENVIRONMENT_BEAN_NAME)) {, +++ b/spring-context/src/test/java/org/springframework/context/support/EnvironmentIntegrationTests.java, +, +import static org.hamcrest.CoreMatchers.*;, + * Tests covering the integration of {@link Environment} into {@link ApplicationContext} hierarchies., +, +++ b/spring-webmvc-portlet/src/main/java/org/springframework/web/portlet/FrameworkPortlet.java, +		pac.setEnvironment(getEnvironment());, +++ b/spring-webmvc-portlet/src/main/java/org/springframework/web/portlet/GenericPortletBean.java, +			bw.registerCustomEditor(Resource.class, new ResourceEditor(resourceLoader, getEnvironment()));, +++ b/spring-webmvc/src/main/java/org/springframework/web/servlet/FrameworkServlet.java, +		wac.setEnvironment(getEnvironment());, +++ b/spring-context/src/main/java/org/springframework/context/support/AbstractApplicationContext.java, +		if (!beanFactory.containsLocalBean(SYSTEM_PROPERTIES_BEAN_NAME)) {, +		if (!beanFactory.containsLocalBean(SYSTEM_ENVIRONMENT_BEAN_NAME)) {, +++ b/spring-context/src/test/java/org/springframework/context/support/EnvironmentIntegrationTests.java, +, +import static org.hamcrest.CoreMatchers.*;, + * Tests covering the integration of {@link Environment} into {@link ApplicationContext} hierarchies., +, +++ b/spring-webmvc-portlet/src/main/java/org/springframework/web/portlet/FrameworkPortlet.java, +		pac.setEnvironment(getEnvironment());, +++ b/spring-webmvc-portlet/src/main/java/org/springframework/web/portlet/GenericPortletBean.java, +			bw.registerCustomEditor(Resource.class, new ResourceEditor(resourceLoader, getEnvironment()));, +++ b/spring-webmvc/src/main/java/org/springframework/web/servlet/FrameworkServlet.java, +		wac.setEnvironment(getEnvironment());, +++ b/spring-webmvc/src/main/java/org/springframework/web/servlet/HttpServletBean.java, +			bw.registerCustomEditor(Resource.class, new ResourceEditor(resourceLoader, getEnvironment()));]
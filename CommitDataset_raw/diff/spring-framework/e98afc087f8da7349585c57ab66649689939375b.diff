[+++ b/org.springframework.web/src/main/java/org/springframework/http/server/ServletServerHttpRequest.java, + * Copyright 2002-2011 the original author or authors., +import java.io.ByteArrayInputStream;, +import java.io.ByteArrayOutputStream;, +import java.io.OutputStreamWriter;, +import java.io.Writer;, +import java.net.URLEncoder;, +import java.util.Arrays;, +import java.util.Iterator;, +import java.util.List;, +import java.util.Map;, +	private static final String FORM_CONTENT_TYPE = "application/x-www-form-urlencoded";, +, +	private static final String POST_METHOD = "POST";, +, +	private static final String FORM_CHARSET = "UTF-8";, +, +	 *, +					servletRequest.getServerPort(), servletRequest.getRequestURI(), servletRequest.getQueryString(),, +					null);, +				for (Enumeration headerValues = this.servletRequest.getHeaders(headerName);, +						headerValues.hasMoreElements();) {, +		if (isFormSubmittal(this.servletRequest)) {, +			return getFormBody(this.servletRequest);, +		}, +		else {, +	}, +, +	private boolean isFormSubmittal(HttpServletRequest request) {, +		return FORM_CONTENT_TYPE.equals(request.getContentType()) &&, +				POST_METHOD.equalsIgnoreCase(request.getMethod());, +	}, +, +	private InputStream getFormBody(HttpServletRequest request) throws IOException {, +		ByteArrayOutputStream bos = new ByteArrayOutputStream();, +		Writer writer = new OutputStreamWriter(bos, FORM_CHARSET);, +, +		Map<String, String[]> form = request.getParameterMap();, +		for (Iterator<String> nameIterator = form.keySet().iterator(); nameIterator.hasNext();) {, +			String name = nameIterator.next();, +			List<String> values = Arrays.asList(form.get(name));, +			for (Iterator<String> valueIterator = values.iterator(); valueIterator.hasNext();) {, +				String value = valueIterator.next();, +				writer.write(URLEncoder.encode(name, FORM_CHARSET));, +				if (value != null) {, +					writer.write('=');, +					writer.write(URLEncoder.encode(value, FORM_CHARSET));, +					if (valueIterator.hasNext()) {, +						writer.write('&');, +					}, +				}, +			}, +			if (nameIterator.hasNext()) {, +				writer.append('&');, +			}, +		}, +		writer.flush();, +, +		return new ByteArrayInputStream(bos.toByteArray());, +	}, +++ b/org.springframework.web/src/main/java/org/springframework/http/server/ServletServerHttpRequest.java, + * Copyright 2002-2011 the original author or authors., +import java.io.ByteArrayInputStream;, +import java.io.ByteArrayOutputStream;, +import java.io.OutputStreamWriter;, +import java.io.Writer;, +import java.net.URLEncoder;, +import java.util.Arrays;, +import java.util.Iterator;, +import java.util.List;, +import java.util.Map;, +	private static final String FORM_CONTENT_TYPE = "application/x-www-form-urlencoded";, +, +	private static final String POST_METHOD = "POST";, +, +	private static final String FORM_CHARSET = "UTF-8";, +, +	 *, +					servletRequest.getServerPort(), servletRequest.getRequestURI(), servletRequest.getQueryString(),, +					null);, +				for (Enumeration headerValues = this.servletRequest.getHeaders(headerName);, +						headerValues.hasMoreElements();) {, +		if (isFormSubmittal(this.servletRequest)) {, +			return getFormBody(this.servletRequest);, +		}, +		else {, +	}, +, +	private boolean isFormSubmittal(HttpServletRequest request) {, +		return FORM_CONTENT_TYPE.equals(request.getContentType()) &&, +				POST_METHOD.equalsIgnoreCase(request.getMethod());, +	}, +, +	private InputStream getFormBody(HttpServletRequest request) throws IOException {, +		ByteArrayOutputStream bos = new ByteArrayOutputStream();, +		Writer writer = new OutputStreamWriter(bos, FORM_CHARSET);, +, +		Map<String, String[]> form = request.getParameterMap();, +		for (Iterator<String> nameIterator = form.keySet().iterator(); nameIterator.hasNext();) {, +			String name = nameIterator.next();]
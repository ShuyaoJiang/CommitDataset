[+++ b/spring-websocket/src/main/java/org/springframework/web/socket/messaging/StompSubProtocolHandler.java, +, +				try {, +					SimpAttributesContextHolder.setAttributesFromMessage(message);, +					if (this.eventPublisher != null) {, +						if (StompCommand.CONNECT.equals(headerAccessor.getCommand())) {, +							publishEvent(new SessionConnectEvent(this, message));, +						}, +				try {, +					SimpAttributes simpAttributes = new SimpAttributes(session.getId(), session.getAttributes());, +					SimpAttributesContextHolder.setAttributes(simpAttributes);, +				finally {, +					SimpAttributesContextHolder.resetAttributes();, +				}, +			}, +			if (this.eventPublisher != null) {, +				publishEvent(new SessionDisconnectEvent(this, message, session.getId(), closeStatus));, +			}]
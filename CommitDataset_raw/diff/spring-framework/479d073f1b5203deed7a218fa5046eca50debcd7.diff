[+++ b/spring-orm-hibernate4/src/main/java/org/springframework/orm/hibernate4/HibernateTransactionManager.java, +				if (session.getFlushMode().equals(FlushMode.MANUAL)) {, +++ b/spring-orm-hibernate4/src/main/java/org/springframework/orm/hibernate4/HibernateTransactionManager.java, +				if (session.getFlushMode().equals(FlushMode.MANUAL)) {, +++ b/spring-orm-hibernate4/src/main/java/org/springframework/orm/hibernate4/LocalSessionFactoryBuilder.java, +	@SuppressWarnings("deprecation"), +		// APP_CLASSLOADER is deprecated as of Hibernate 4.3 but we need to remain compatible with 4.0+, +++ b/spring-orm-hibernate4/src/main/java/org/springframework/orm/hibernate4/HibernateTransactionManager.java, +				if (session.getFlushMode().equals(FlushMode.MANUAL)) {, +++ b/spring-orm-hibernate4/src/main/java/org/springframework/orm/hibernate4/LocalSessionFactoryBuilder.java, +	@SuppressWarnings("deprecation"), +		// APP_CLASSLOADER is deprecated as of Hibernate 4.3 but we need to remain compatible with 4.0+, +++ b/spring-orm-hibernate4/src/main/java/org/springframework/orm/hibernate4/SpringSessionSynchronization.java, + * Copyright 2002-2013 the original author or authors., +			if (!session.getFlushMode().equals(FlushMode.MANUAL)) {, +++ b/spring-orm-hibernate4/src/main/java/org/springframework/orm/hibernate4/HibernateTransactionManager.java, +				if (session.getFlushMode().equals(FlushMode.MANUAL)) {, +++ b/spring-orm-hibernate4/src/main/java/org/springframework/orm/hibernate4/LocalSessionFactoryBuilder.java, +	@SuppressWarnings("deprecation"), +		// APP_CLASSLOADER is deprecated as of Hibernate 4.3 but we need to remain compatible with 4.0+, +++ b/spring-orm-hibernate4/src/main/java/org/springframework/orm/hibernate4/SpringSessionSynchronization.java, + * Copyright 2002-2013 the original author or authors., +			if (!session.getFlushMode().equals(FlushMode.MANUAL)) {, +++ b/spring-orm/src/main/java/org/springframework/orm/jpa/vendor/HibernateJpaDialect.java, + * Hibernate EntityManager. Developed against Hibernate 3.6 and 4.2/4.3., +@SuppressWarnings({"serial", "deprecation"}), +			// OptimisticLockException is deprecated on Hibernate 4.x; we're just using it on 3.x anyway, +++ b/spring-orm-hibernate4/src/main/java/org/springframework/orm/hibernate4/HibernateTransactionManager.java, +				if (session.getFlushMode().equals(FlushMode.MANUAL)) {, +++ b/spring-orm-hibernate4/src/main/java/org/springframework/orm/hibernate4/LocalSessionFactoryBuilder.java, +	@SuppressWarnings("deprecation"), +		// APP_CLASSLOADER is deprecated as of Hibernate 4.3 but we need to remain compatible with 4.0+, +++ b/spring-orm-hibernate4/src/main/java/org/springframework/orm/hibernate4/SpringSessionSynchronization.java, + * Copyright 2002-2013 the original author or authors., +			if (!session.getFlushMode().equals(FlushMode.MANUAL)) {, +++ b/spring-orm/src/main/java/org/springframework/orm/jpa/vendor/HibernateJpaDialect.java, + * Hibernate EntityManager. Developed against Hibernate 3.6 and 4.2/4.3., +@SuppressWarnings({"serial", "deprecation"}), +			// OptimisticLockException is deprecated on Hibernate 4.x; we're just using it on 3.x anyway, +++ b/spring-orm/src/main/java/org/springframework/orm/jpa/vendor/HibernateJpaVendorAdapter.java, + * Copyright 2002-2013 the original author or authors., +, + * Hibernate EntityManager. Developed and tested against Hibernate 3.6 and 4.2/4.3., + * <p>Note that the package location of Hibernate's JPA support changed from 4.2 to 4.3:, + * from {@code org.hibernate.ejb.HibernateEntityManager(Factory)} to, + * {@code org.hibernate.jpa.HibernateEntityManager(Factory)}. As of Spring 4.0,, + * we're exposing the correct, non-deprecated variant depending on the Hibernate, + * version encountered at runtime, in order to avoid deprecation log entries., + *, +	private final PersistenceProvider persistenceProvider;, +	private final Class<? extends EntityManagerFactory> entityManagerFactoryInterface;, +, +	private final Class<? extends EntityManager> entityManagerInterface;, +, +, +	@SuppressWarnings({"deprecation", "unchecked"}), +	public HibernateJpaVendorAdapter() {, +		PersistenceProvider providerToUse;, +		Class<? extends EntityManagerFactory> emfIfcToUse;, +		Class<? extends EntityManager> emIfcToUse;, +		try {, +			// Try Hibernate 4.3's org.hibernate.jpa package in order to avoid deprecation warnings, +			ClassLoader cl = HibernateJpaVendorAdapter.class.getClassLoader();, +			Class<?> hibernatePersistenceProviderClass = cl.loadClass("org.hibernate.jpa.HibernatePersistenceProvider");, +			providerToUse = (PersistenceProvider) hibernatePersistenceProviderClass.newInstance();, +			emfIfcToUse = (Class<? extends EntityManagerFactory>) cl.loadClass("org.hibernate.jpa.HibernateEntityManagerFactory");, +			emIfcToUse = (Class<? extends EntityManager>) cl.loadClass("org.hibernate.jpa.HibernateEntityManager");, +		}, +		catch (ClassNotFoundException ex) {, +			// Fall back to Hibernate 3.6-4.2 org.hibernate.ejb package, +			providerToUse = new HibernatePersistence();, +			emfIfcToUse = HibernateEntityManagerFactory.class;, +			emIfcToUse = HibernateEntityManager.class;, +		}, +		catch (Exception ex) {, +			throw new IllegalStateException("Found HibernatePersistenceProvider but could not instantiate it", ex);, +		}, +		this.persistenceProvider = providerToUse;, +		this.entityManagerFactoryInterface = emfIfcToUse;, +		this.entityManagerInterface = emIfcToUse;, +	}, +, +			case DERBY: return DerbyDialect.class;  // DerbyDialect deprecated in 4.x, +			case POSTGRESQL: return PostgreSQLDialect.class;  // PostgreSQLDialect deprecated in 4.x, +			case SYBASE: return org.hibernate.dialect.SybaseDialect.class;  // SybaseDialect deprecated in 3.6 but not 4.x, +		return this.entityManagerFactoryInterface;, +		return this.entityManagerInterface;]
[+++ b/spring-websocket/src/main/java/org/springframework/web/socket/messaging/StompSubProtocolHandler.java, +import org.springframework.web.socket.BinaryMessage;, +			ByteBuffer byteBuffer;, +			if (webSocketMessage instanceof TextMessage) {, +				byteBuffer = ByteBuffer.wrap(((TextMessage) webSocketMessage).asBytes());, +			}, +			else if (webSocketMessage instanceof BinaryMessage) {, +				byteBuffer = ((BinaryMessage) webSocketMessage).getPayload();, +			}, +			else {, +				throw new IllegalArgumentException("Unexpected WebSocket message type: " + webSocketMessage);, +			}]
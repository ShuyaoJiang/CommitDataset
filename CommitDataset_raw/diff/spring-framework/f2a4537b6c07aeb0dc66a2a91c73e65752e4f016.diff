[+++ b/spring-context/src/test/java/org/springframework/beans/factory/xml/XmlBeanFactoryTests.java, + * Copyright 2002-2014 the original author or authors., +, +import org.springframework.util.ClassUtils;, +import org.xml.sax.InputSource;, +, + * @author Sam Brannen, +	/**, +	 * @since 3.2.8 and 4.0.2, +	 * @see <a href="https://jira.springsource.org/browse/SPR-10785">SPR-10785</a> and <a, +	 *      href="https://jira.springsource.org/browse/SPR-11420">SPR-11420</a>, +	 */, +	@Test, +	public void methodInjectedBeanMustBeOfSameEnhancedCglibSubclassTypeAcrossBeanFactories() {, +		Class<?> firstClass = null;, +, +		for (int i = 1; i <= 10; i++) {, +			DefaultListableBeanFactory bf = new DefaultListableBeanFactory();, +			new XmlBeanDefinitionReader(bf).loadBeanDefinitions(OVERRIDES_CONTEXT);, +, +			final Class<?> currentClass = bf.getBean("overrideOneMethod").getClass();, +			assertTrue("Method injected bean class [" + currentClass + "] must be a CGLIB enhanced subclass.",, +				ClassUtils.isCglibProxyClass(currentClass));, +, +			if (firstClass == null) {, +				firstClass = currentClass;, +			}, +			else {, +				assertEquals(firstClass, currentClass);, +			}, +		}, +	}, +		@SuppressWarnings("rawtypes")]
[+++ b/spring-test/src/main/java/org/springframework/mock/web/MockHttpServletRequest.java, +	private static final String HTTP = "http";, +, +	private static final String HTTPS = "https";, +, +	public static final String DEFAULT_PROTOCOL = HTTP;, +	/**, +	 * Set the boolean {@code secure} flag indicating whether the mock request, +	 * was made using a secure channel, such as HTTPS., +	 * @param secure a boolean indicating if the mock request was made using a, +	 * secure channel, +	 * @see #isSecure(), +	 * @see #getScheme(), +	 * @see #setScheme(String), +	 */, +	/**, +	 * Returns {@code true} if the {@link #setSecure secure} flag has been set, +	 * to {@code true} or if the {@link #getScheme scheme} is {@code https}., +	 * <p>, +	 * {@inheritDoc}, +	 * @see javax.servlet.ServletRequest#isSecure(), +	 */, +		return this.secure || HTTPS.equalsIgnoreCase(this.getScheme());, +				&& ((HTTP.equalsIgnoreCase(scheme) && this.serverPort != 80) || (HTTPS.equalsIgnoreCase(scheme) && this.serverPort != 443))) {, +++ b/spring-test/src/main/java/org/springframework/mock/web/MockHttpServletRequest.java, +	private static final String HTTP = "http";, +, +	private static final String HTTPS = "https";, +, +	public static final String DEFAULT_PROTOCOL = HTTP;, +	/**, +	 * Set the boolean {@code secure} flag indicating whether the mock request, +	 * was made using a secure channel, such as HTTPS., +	 * @param secure a boolean indicating if the mock request was made using a, +	 * secure channel, +	 * @see #isSecure(), +	 * @see #getScheme(), +	 * @see #setScheme(String), +	 */, +	/**, +	 * Returns {@code true} if the {@link #setSecure secure} flag has been set, +	 * to {@code true} or if the {@link #getScheme scheme} is {@code https}., +	 * <p>, +	 * {@inheritDoc}, +	 * @see javax.servlet.ServletRequest#isSecure(), +	 */, +		return this.secure || HTTPS.equalsIgnoreCase(this.getScheme());, +				&& ((HTTP.equalsIgnoreCase(scheme) && this.serverPort != 80) || (HTTPS.equalsIgnoreCase(scheme) && this.serverPort != 443))) {, +++ b/spring-test/src/test/java/org/springframework/mock/web/MockHttpServletRequestTests.java, +	@Test, +	public void isSecureWithHttpSchemeAndSecureFlagIsFalse() {, +		assertFalse(request.isSecure());, +		request.setScheme("http");, +		request.setSecure(false);, +		assertFalse(request.isSecure());, +	}, +, +	@Test, +	public void isSecureWithHttpSchemeAndSecureFlagIsTrue() {, +		assertFalse(request.isSecure());, +		request.setScheme("http");, +		request.setSecure(true);, +		assertTrue(request.isSecure());, +	}, +, +	@Test, +	public void isSecureWithHttpsSchemeAndSecureFlagIsFalse() {, +		assertFalse(request.isSecure());, +		request.setScheme("https");, +		request.setSecure(false);, +		assertTrue(request.isSecure());, +	}, +, +	@Test, +	public void isSecureWithHttpsSchemeAndSecureFlagIsTrue() {, +		assertFalse(request.isSecure());, +		request.setScheme("https");, +		request.setSecure(true);, +		assertTrue(request.isSecure());, +	}, +]
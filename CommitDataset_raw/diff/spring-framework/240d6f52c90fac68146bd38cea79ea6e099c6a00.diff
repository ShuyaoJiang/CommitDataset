[+++ b/spring-web/src/main/java/org/springframework/web/util/UriComponentsBuilder.java, +	 * <p><strong>Note:</strong> this method uses values from forwarded headers,, +	 * if present, in order to reflect the client-originated protocol and address., +	 * Consider using the {@code ForwardedHeaderFilter} in order to choose from a, +	 * central place whether to extract and use, or to discard such headers., +	 * See the Spring Framework reference for more on this filter., +++ b/spring-web/src/main/java/org/springframework/web/util/UriComponentsBuilder.java, +	 * <p><strong>Note:</strong> this method uses values from forwarded headers,, +	 * if present, in order to reflect the client-originated protocol and address., +	 * Consider using the {@code ForwardedHeaderFilter} in order to choose from a, +	 * central place whether to extract and use, or to discard such headers., +	 * See the Spring Framework reference for more on this filter., +++ b/spring-webmvc/src/main/java/org/springframework/web/servlet/support/ServletUriComponentsBuilder.java, + * Copyright 2002-2018 the original author or authors., +	 *, +	 *, +	 * <p>As of 4.3.15, this method replaces the contextPath with the value, +	 * of "X-Forwarded-Prefix" rather than prepending, thus aligning with, +	 * {@code ForwardedHeaderFiller}., +		String forwardedPrefix = getForwardedPrefix(request);, +		builder.replacePath(forwardedPrefix != null ? forwardedPrefix : request.getContextPath());, +	 *, +	 *, +	 * <p>As of 4.3.15, this method replaces the contextPath with the value, +	 * of "X-Forwarded-Prefix" rather than prepending, thus aligning with, +	 * {@code ForwardedHeaderFiller}., +	 *, +	 *, +	 * <p>As of 4.3.15, this method replaces the contextPath with the value, +	 * of "X-Forwarded-Prefix" rather than prepending, thus aligning with, +	 * {@code ForwardedHeaderFiller}., +		builder.initPath(getRequestUriWithForwardedPrefix(request));, +	 *, +	 *, +	 * <p>As of 4.3.15, this method replaces the contextPath with the value, +	 * of "X-Forwarded-Prefix" rather than prepending, thus aligning with, +	 * {@code ForwardedHeaderFiller}., +		builder.initPath(getRequestUriWithForwardedPrefix(request));, +	@Nullable, +	private static String getForwardedPrefix(HttpServletRequest request) {, +			while (prefix.endsWith("/")) {, +				prefix = prefix.substring(0, prefix.length() - 1);, +			}, +		}, +		return prefix;, +	}, +, +	private static String getRequestUriWithForwardedPrefix(HttpServletRequest request) {, +		String path = request.getRequestURI();, +		String forwardedPrefix = getForwardedPrefix(request);, +		if (forwardedPrefix != null) {, +			String contextPath = request.getContextPath();, +			if (!StringUtils.isEmpty(contextPath) && !contextPath.equals("/") && path.startsWith(contextPath)) {, +				path = path.substring(contextPath.length());, +			}, +			path = forwardedPrefix + path;, +	 *, +	 *, +	 * <p>As of 4.3.15, this method replaces the contextPath with the value, +	 * of "X-Forwarded-Prefix" rather than prepending, thus aligning with, +	 * {@code ForwardedHeaderFiller}., +	 *, +	 *, +	 * <p>As of 4.3.15, this method replaces the contextPath with the value, +	 * of "X-Forwarded-Prefix" rather than prepending, thus aligning with, +	 * {@code ForwardedHeaderFiller}., +	 *, +	 *, +	 * <p>As of 4.3.15, this method replaces the contextPath with the value, +	 * of "X-Forwarded-Prefix" rather than prepending, thus aligning with, +	 * {@code ForwardedHeaderFiller}., +	 *, +	 *, +	 * <p>As of 4.3.15, this method replaces the contextPath with the value, +	 * of "X-Forwarded-Prefix" rather than prepending, thus aligning with, +	 * {@code ForwardedHeaderFiller}., +++ b/spring-web/src/main/java/org/springframework/web/util/UriComponentsBuilder.java, +	 * <p><strong>Note:</strong> this method uses values from forwarded headers,, +	 * if present, in order to reflect the client-originated protocol and address., +	 * Consider using the {@code ForwardedHeaderFilter} in order to choose from a, +	 * central place whether to extract and use, or to discard such headers., +	 * See the Spring Framework reference for more on this filter., +++ b/spring-webmvc/src/main/java/org/springframework/web/servlet/support/ServletUriComponentsBuilder.java, + * Copyright 2002-2018 the original author or authors., +	 *, +	 *, +	 * <p>As of 4.3.15, this method replaces the contextPath with the value, +	 * of "X-Forwarded-Prefix" rather than prepending, thus aligning with, +	 * {@code ForwardedHeaderFiller}., +		String forwardedPrefix = getForwardedPrefix(request);, +		builder.replacePath(forwardedPrefix != null ? forwardedPrefix : request.getContextPath());, +	 *, +	 *, +	 * <p>As of 4.3.15, this method replaces the contextPath with the value, +	 * of "X-Forwarded-Prefix" rather than prepending, thus aligning with, +	 * {@code ForwardedHeaderFiller}., +	 *, +	 *, +	 * <p>As of 4.3.15, this method replaces the contextPath with the value, +	 * of "X-Forwarded-Prefix" rather than prepending, thus aligning with]
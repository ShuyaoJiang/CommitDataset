[+++ b/spring-web-reactive/build.gradle, +ext {, +	springVersion = '4.2.3.RELEASE', +	reactorVersion = '2.5.0.BUILD-SNAPSHOT', +	tomcatVersion = '8.0.28', +	jettyVersion = '9.3.5.v20151012', +}, +, +configurations {, +	jarjar, +	reactorstream, +}, +, +task reactorstreamRepackJar(type: Jar) { repackJar ->, +	repackJar.baseName = "spring-reactive-reactorstream-repack", +	repackJar.version = reactorVersion, +, +	doLast() {, +		project.ant {, +			taskdef name: "jarjar", classname: "com.tonicsystems.jarjar.JarJarTask",, +				classpath: configurations.jarjar.asPath, +			jarjar(destfile: repackJar.archivePath) {, +				configurations.reactorstream.each { originalJar ->, +					zipfileset(src: originalJar), +				}, +				// repackage reactor. => org.springframework.reactor, +				rule(pattern: "reactor.rx.**", result: "org.springframework.reactor.rx.@1"), +			}, +		}, +	}, +}, +, +, +, +	dependsOn reactorstreamRepackJar, +		from(zipTree(reactorstreamRepackJar.archivePath)) {, +			include "reactor/rx/subscriber/BlockingQueueSubscriber.java", +		}, +	reactorstream("io.projectreactor:reactor-stream:${reactorVersion}@jar"), +	compile(files(reactorstreamRepackJar)), +	jarjar("com.googlecode.jarjar:jarjar:1.3"), +, +++ b/spring-web-reactive/build.gradle, +ext {, +	springVersion = '4.2.3.RELEASE', +	reactorVersion = '2.5.0.BUILD-SNAPSHOT', +	tomcatVersion = '8.0.28', +	jettyVersion = '9.3.5.v20151012', +}, +, +configurations {, +	jarjar, +	reactorstream, +}, +, +task reactorstreamRepackJar(type: Jar) { repackJar ->, +	repackJar.baseName = "spring-reactive-reactorstream-repack", +	repackJar.version = reactorVersion, +, +	doLast() {, +		project.ant {, +			taskdef name: "jarjar", classname: "com.tonicsystems.jarjar.JarJarTask",, +				classpath: configurations.jarjar.asPath, +			jarjar(destfile: repackJar.archivePath) {, +				configurations.reactorstream.each { originalJar ->, +					zipfileset(src: originalJar), +				}, +				// repackage reactor. => org.springframework.reactor, +				rule(pattern: "reactor.rx.**", result: "org.springframework.reactor.rx.@1"), +			}, +		}, +	}, +}, +, +, +, +	dependsOn reactorstreamRepackJar, +		from(zipTree(reactorstreamRepackJar.archivePath)) {, +			include "reactor/rx/subscriber/BlockingQueueSubscriber.java", +		}, +	reactorstream("io.projectreactor:reactor-stream:${reactorVersion}@jar"), +	compile(files(reactorstreamRepackJar)), +	jarjar("com.googlecode.jarjar:jarjar:1.3"), +, +++ b/spring-web-reactive/src/main/java/org/springframework/util/ByteBufferPublisherInputStream.java, +import java.util.concurrent.ArrayBlockingQueue;, +, +import org.springframework.reactor.rx.subscriber.BlockingQueueSubscriber;, +		this.queue = new BlockingQueueSubscriber<>(publisher, null, new ArrayBlockingQueue<>(requestSize), false, requestSize);, +++ b/spring-web-reactive/build.gradle, +ext {, +	springVersion = '4.2.3.RELEASE', +	reactorVersion = '2.5.0.BUILD-SNAPSHOT', +	tomcatVersion = '8.0.28', +	jettyVersion = '9.3.5.v20151012', +}, +, +configurations {, +	jarjar, +	reactorstream]
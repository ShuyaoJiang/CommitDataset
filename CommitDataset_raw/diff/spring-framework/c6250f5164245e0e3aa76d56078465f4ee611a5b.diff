[+++ b/spring-web/src/main/java/org/springframework/web/util/ContentCachingRequestWrapper.java, +	@Override, +	public String getParameter(String name) {, +		return super.getParameter(name);, +	}, +, +	@Override, +	public Map<String, String[]> getParameterMap() {, +		if(this.cachedContent.size() == 0 && isFormPost()) {, +			writeRequestParamsToContent();, +		}, +		return super.getParameterMap();, +	}, +, +	@Override, +	public Enumeration<String> getParameterNames() {, +		if(this.cachedContent.size() == 0 && isFormPost()) {, +			writeRequestParamsToContent();, +		}, +		return super.getParameterNames();, +	}, +, +	@Override, +	public String[] getParameterValues(String name) {, +		if(this.cachedContent.size() == 0 && isFormPost()) {, +			writeRequestParamsToContent();, +		}, +		return super.getParameterValues(name);, +				Map<String, String[]> form = super.getParameterMap();, +	/**, +	 * Return the cached request content as a byte array., +	 */, +	public byte[] getContentAsByteArray() {, +		return this.cachedContent.toByteArray();, +	}, +, +++ b/spring-web/src/main/java/org/springframework/web/util/ContentCachingRequestWrapper.java, +	@Override, +	public String getParameter(String name) {, +		return super.getParameter(name);, +	}, +, +	@Override, +	public Map<String, String[]> getParameterMap() {, +		if(this.cachedContent.size() == 0 && isFormPost()) {, +			writeRequestParamsToContent();, +		}, +		return super.getParameterMap();, +	}, +, +	@Override, +	public Enumeration<String> getParameterNames() {, +		if(this.cachedContent.size() == 0 && isFormPost()) {, +			writeRequestParamsToContent();, +		}, +		return super.getParameterNames();, +	}, +, +	@Override, +	public String[] getParameterValues(String name) {, +		if(this.cachedContent.size() == 0 && isFormPost()) {, +			writeRequestParamsToContent();, +		}, +		return super.getParameterValues(name);, +				Map<String, String[]> form = super.getParameterMap();, +	/**, +	 * Return the cached request content as a byte array., +	 */, +	public byte[] getContentAsByteArray() {, +		return this.cachedContent.toByteArray();, +	}, +, +++ b/spring-web/src/test/java/org/springframework/web/util/ContentCachingRequestWrapperTests.java, +		// SPR-12810 : inputstream body should be consumed, +		Assert.assertEquals("", new String(FileCopyUtils.copyToByteArray(wrapper.getInputStream())));, +	}, +, +	// SPR-12810, +	@Test, +	public void inputStreamFormPostRequest() throws Exception {, +		this.request.setMethod("POST");, +		this.request.setContentType(FORM_CONTENT_TYPE);, +		this.request.setCharacterEncoding(CHARSET);, +		this.request.setParameter("first", "value");, +		this.request.setParameter("second", new String[] {"foo", "bar"});, +, +		ContentCachingRequestWrapper wrapper = new ContentCachingRequestWrapper(this.request);, +, +		byte[] response = FileCopyUtils.copyToByteArray(wrapper.getInputStream());, +		Assert.assertArrayEquals(response, wrapper.getContentAsByteArray());]
[+++ b/org.springframework.context.support/src/main/java/org/springframework/scheduling/quartz/QuartzJobBean.java, + * Copyright 2002-2011 the original author or authors., +import java.lang.reflect.Method;, +import java.util.Map;, +, +import org.quartz.Scheduler;, +import org.springframework.util.ReflectionUtils;, +	private static final Method getSchedulerMethod;, +, +	private static final Method getMergedJobDataMapMethod;, +, +, +	static {, +		try {, +			getSchedulerMethod = JobExecutionContext.class.getMethod("getScheduler");, +			getMergedJobDataMapMethod = JobExecutionContext.class.getMethod("getMergedJobDataMap");, +		}, +		catch (NoSuchMethodException ex) {, +			throw new IllegalStateException("Incompatible Quartz API: " + ex);, +		}, +	}, +, +, +			// Reflectively adapting to differences between Quartz 1.x and Quartz 2.0..., +			Scheduler scheduler = (Scheduler) ReflectionUtils.invokeMethod(getSchedulerMethod, context);, +			Map mergedJobDataMap = (Map) ReflectionUtils.invokeMethod(getMergedJobDataMapMethod, context);, +, +			pvs.addPropertyValues(scheduler.getContext());, +			pvs.addPropertyValues(mergedJobDataMap);]
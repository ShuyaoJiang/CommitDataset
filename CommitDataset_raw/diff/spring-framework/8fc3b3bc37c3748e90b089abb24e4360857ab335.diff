[+++ b/spring-test/src/main/java/org/springframework/test/web/reactive/server/AbstractMockServerSpec.java, +		return new DefaultWebTestClientBuilder(builder);, +++ b/spring-test/src/main/java/org/springframework/test/web/reactive/server/AbstractMockServerSpec.java, +		return new DefaultWebTestClientBuilder(builder);, +++ b/spring-test/src/main/java/org/springframework/test/web/reactive/server/DefaultWebTestClient.java, +	private final WebTestClient.Builder builder;, +, +			@Nullable Duration timeout, WebTestClient.Builder webTestClientBuilder) {, +		this.builder = webTestClientBuilder;, +		return this.builder;, +++ b/spring-test/src/main/java/org/springframework/test/web/reactive/server/AbstractMockServerSpec.java, +		return new DefaultWebTestClientBuilder(builder);, +++ b/spring-test/src/main/java/org/springframework/test/web/reactive/server/DefaultWebTestClient.java, +	private final WebTestClient.Builder builder;, +, +			@Nullable Duration timeout, WebTestClient.Builder webTestClientBuilder) {, +		this.builder = webTestClientBuilder;, +		return this.builder;, +++ b/spring-test/src/main/java/org/springframework/test/web/reactive/server/DefaultWebTestClientBuilder.java, +import org.springframework.util.Assert;, +import org.springframework.web.server.adapter.WebHttpHandlerBuilder;, +	private final WebHttpHandlerBuilder httpHandlerBuilder;, +, +		this(null, null, new ReactorClientHttpConnector(), null);, +	DefaultWebTestClientBuilder(WebHttpHandlerBuilder httpHandlerBuilder) {, +		this(null, httpHandlerBuilder, null, null);, +	DefaultWebTestClientBuilder(@Nullable WebClient.Builder webClientBuilder,, +			@Nullable WebHttpHandlerBuilder httpHandlerBuilder,, +			@Nullable ClientHttpConnector connector,, +		Assert.isTrue(httpHandlerBuilder != null || connector !=null,, +				"Either WebHttpHandlerBuilder or ClientHttpConnector must be provided");, +, +		this.httpHandlerBuilder = (httpHandlerBuilder != null ? httpHandlerBuilder.cloneBuilder() : null);, +		this.connector = connector;, +	public WebTestClient.Builder apply(WebTestClientConfigurer configurer) {, +		configurer.afterConfigurerAdded(this, this.httpHandlerBuilder, this.connector);, +		return this;, +	}, +, +	@Override, +, +		ClientHttpConnector connectorToUse = (this.connector != null ? this.connector :, +				new HttpHandlerConnector(this.httpHandlerBuilder.build()));, +, +		DefaultWebTestClientBuilder webTestClientBuilder = new DefaultWebTestClientBuilder(, +				this.webClientBuilder.build().mutate(), this.httpHandlerBuilder,, +				this.connector, this.responseTimeout);, +, +		return new DefaultWebTestClient(this.webClientBuilder,, +				connectorToUse, this.responseTimeout, webTestClientBuilder);, +++ b/spring-test/src/main/java/org/springframework/test/web/reactive/server/AbstractMockServerSpec.java, +		return new DefaultWebTestClientBuilder(builder);, +++ b/spring-test/src/main/java/org/springframework/test/web/reactive/server/DefaultWebTestClient.java, +	private final WebTestClient.Builder builder;, +, +			@Nullable Duration timeout, WebTestClient.Builder webTestClientBuilder) {, +		this.builder = webTestClientBuilder;, +		return this.builder;, +++ b/spring-test/src/main/java/org/springframework/test/web/reactive/server/DefaultWebTestClientBuilder.java, +import org.springframework.util.Assert;, +import org.springframework.web.server.adapter.WebHttpHandlerBuilder;, +	private final WebHttpHandlerBuilder httpHandlerBuilder;, +, +		this(null, null, new ReactorClientHttpConnector(), null);, +	DefaultWebTestClientBuilder(WebHttpHandlerBuilder httpHandlerBuilder) {, +		this(null, httpHandlerBuilder, null, null);, +	DefaultWebTestClientBuilder(@Nullable WebClient.Builder webClientBuilder,, +			@Nullable WebHttpHandlerBuilder httpHandlerBuilder,, +			@Nullable ClientHttpConnector connector,, +		Assert.isTrue(httpHandlerBuilder != null || connector !=null,, +				"Either WebHttpHandlerBuilder or ClientHttpConnector must be provided");, +, +		this.httpHandlerBuilder = (httpHandlerBuilder != null ? httpHandlerBuilder.cloneBuilder() : null);, +		this.connector = connector;, +	public WebTestClient.Builder apply(WebTestClientConfigurer configurer) {, +		configurer.afterConfigurerAdded(this, this.httpHandlerBuilder, this.connector);, +		return this;, +	}, +, +	@Override, +, +		ClientHttpConnector connectorToUse = (this.connector != null ? this.connector :, +				new HttpHandlerConnector(this.httpHandlerBuilder.build()));, +, +		DefaultWebTestClientBuilder webTestClientBuilder = new DefaultWebTestClientBuilder(, +				this.webClientBuilder.build().mutate(), this.httpHandlerBuilder,, +				this.connector, this.responseTimeout);, +, +		return new DefaultWebTestClient(this.webClientBuilder,, +				connectorToUse, this.responseTimeout, webTestClientBuilder);, +++ /dev/null, +++ b/spring-test/src/main/java/org/springframework/test/web/reactive/server/AbstractMockServerSpec.java, +		return new DefaultWebTestClientBuilder(builder);, +++ b/spring-test/src/main/java/org/springframework/test/web/reactive/server/DefaultWebTestClient.java, +	private final WebTestClient.Builder builder;, +, +			@Nullable Duration timeout, WebTestClient.Builder webTestClientBuilder) {, +		this.builder = webTestClientBuilder;, +		return this.builder;, +++ b/spring-test/src/main/java/org/springframework/test/web/reactive/server/DefaultWebTestClientBuilder.java]
[+++ b/spring-beans/src/main/java/org/springframework/beans/factory/support/AbstractBeanFactory.java, + * Copyright 2002-2018 the original author or authors., +			if (!BeanFactoryUtils.isFactoryDereference(name) && beanInstance == null) {, +		if (BeanFactoryUtils.isFactoryDereference(name)) {, +			if (beanInstance instanceof NullBean) {, +				return beanInstance;, +			}, +			if (!(beanInstance instanceof FactoryBean)) {, +		}, +++ b/spring-beans/src/main/java/org/springframework/beans/factory/support/AbstractBeanFactory.java, + * Copyright 2002-2018 the original author or authors., +			if (!BeanFactoryUtils.isFactoryDereference(name) && beanInstance == null) {, +		if (BeanFactoryUtils.isFactoryDereference(name)) {, +			if (beanInstance instanceof NullBean) {, +				return beanInstance;, +			}, +			if (!(beanInstance instanceof FactoryBean)) {, +		}, +++ b/spring-beans/src/main/java/org/springframework/beans/factory/support/DefaultListableBeanFactory.java, + * Copyright 2002-2018 the original author or authors., +					Object bean = getBean(FACTORY_BEAN_PREFIX + beanName);, +					if (bean instanceof FactoryBean) {, +						final FactoryBean<?> factory = (FactoryBean<?>) bean;, +				}, +++ b/spring-beans/src/main/java/org/springframework/beans/factory/support/AbstractBeanFactory.java, + * Copyright 2002-2018 the original author or authors., +			if (!BeanFactoryUtils.isFactoryDereference(name) && beanInstance == null) {, +		if (BeanFactoryUtils.isFactoryDereference(name)) {, +			if (beanInstance instanceof NullBean) {, +				return beanInstance;, +			}, +			if (!(beanInstance instanceof FactoryBean)) {, +		}, +++ b/spring-beans/src/main/java/org/springframework/beans/factory/support/DefaultListableBeanFactory.java, + * Copyright 2002-2018 the original author or authors., +					Object bean = getBean(FACTORY_BEAN_PREFIX + beanName);, +					if (bean instanceof FactoryBean) {, +						final FactoryBean<?> factory = (FactoryBean<?>) bean;, +				}, +++ b/spring-context/src/test/java/org/springframework/context/annotation/ConfigurationClassPostProcessorTests.java, + * Copyright 2002-2018 the original author or authors., +, +		@Bean, +		public FactoryBean<Object> nullFactoryBean() {, +			return null;, +		}]
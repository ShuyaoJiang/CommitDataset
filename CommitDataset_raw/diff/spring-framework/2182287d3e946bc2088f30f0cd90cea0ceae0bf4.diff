[+++ b/org.springframework.core/src/main/java/org/springframework/util/xml/StaxEventXMLReader.java, +	private static final String DEFAULT_XML_VERSION = "1.0";, +, +	private String xmlVersion = DEFAULT_XML_VERSION;, +, +	private String encoding;, +, +		if (event.isStartDocument()) {, +			StartDocument startDocument = (StartDocument) event;, +			String xmlVersion = startDocument.getVersion();, +			if (StringUtils.hasLength(xmlVersion)) {, +				this.xmlVersion = xmlVersion;, +			}, +			if (startDocument.encodingSet()) {, +				this.encoding = startDocument.getCharacterEncodingScheme();, +			}, +		}, +, +					return xmlVersion;, +					return encoding;, +				for (Iterator i = startElement.getAttributes(); i.hasNext();){, +					Attribute attribute = (Attribute) i.next();, +					String prefix = attribute.getName().getPrefix();, +					if (prefix == null) {, +						prefix = "";, +					}, +					String namespace = attribute.getName().getNamespaceURI();, +					if (namespace == null) {, +						continue;, +					}, +					getContentHandler().startPrefixMapping(prefix, namespace);, +				}, +, +++ b/org.springframework.core/src/main/java/org/springframework/util/xml/StaxEventXMLReader.java, +	private static final String DEFAULT_XML_VERSION = "1.0";, +, +	private String xmlVersion = DEFAULT_XML_VERSION;, +, +	private String encoding;, +, +		if (event.isStartDocument()) {, +			StartDocument startDocument = (StartDocument) event;, +			String xmlVersion = startDocument.getVersion();, +			if (StringUtils.hasLength(xmlVersion)) {, +				this.xmlVersion = xmlVersion;, +			}, +			if (startDocument.encodingSet()) {, +				this.encoding = startDocument.getCharacterEncodingScheme();, +			}, +		}, +, +					return xmlVersion;, +					return encoding;, +				for (Iterator i = startElement.getAttributes(); i.hasNext();){, +					Attribute attribute = (Attribute) i.next();, +					String prefix = attribute.getName().getPrefix();, +					if (prefix == null) {, +						prefix = "";, +					}, +					String namespace = attribute.getName().getNamespaceURI();, +					if (namespace == null) {, +						continue;, +					}, +					getContentHandler().startPrefixMapping(prefix, namespace);, +				}, +, +++ b/org.springframework.core/src/main/java/org/springframework/util/xml/StaxStreamXMLReader.java, +	private static final String DEFAULT_XML_VERSION = "1.0";, +, +	private String xmlVersion = DEFAULT_XML_VERSION;, +, +	private String encoding;, +, +		if (XMLStreamConstants.START_DOCUMENT == reader.getEventType()) {, +			String xmlVersion = reader.getVersion();, +			if (StringUtils.hasLength(xmlVersion)) {, +				this.xmlVersion = xmlVersion;, +			}, +			this.encoding = reader.getCharacterEncodingScheme();, +		}, +, +					return xmlVersion;, +					return encoding;, +				for (int i = 0; i < reader.getAttributeCount(); i++) {, +					String prefix = reader.getAttributePrefix(i);, +					if (prefix == null) {, +						prefix = "";, +					}, +					String namespace = reader.getAttributeNamespace(i);, +					if (namespace == null) {, +						continue;, +					}, +					getContentHandler().startPrefixMapping(prefix, namespace);, +				}]
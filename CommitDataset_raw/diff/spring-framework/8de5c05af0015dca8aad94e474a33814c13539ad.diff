[+++ b/spring-webflux/src/main/java/org/springframework/web/reactive/function/server/support/RouterFunctionMapping.java, +import java.util.Map;, +import org.springframework.web.reactive.function.server.HandlerFunction;, +			return this.routerFunction.route(request), +					.doOnNext(handler -> setAttributes(exchange.getAttributes(), request, handler));, +	@SuppressWarnings("unchecked"), +	private void setAttributes(Map<String, Object> attributes, ServerRequest serverRequest,, +			HandlerFunction<?> handlerFunction) {, +, +		attributes.put(RouterFunctions.REQUEST_ATTRIBUTE, serverRequest);, +		attributes.put(BEST_MATCHING_HANDLER_ATTRIBUTE, handlerFunction);, +, +		String matchingPattern =, +				(String) attributes.get(RouterFunctions.MATCHING_PATTERN_ATTRIBUTE);, +		if (matchingPattern != null) {, +			attributes.put(BEST_MATCHING_PATTERN_ATTRIBUTE, matchingPattern);, +		}, +		Map<String, String> uriVariables =, +				(Map<String, String>) attributes, +						.get(RouterFunctions.URI_TEMPLATE_VARIABLES_ATTRIBUTE);, +		if (uriVariables != null) {, +			attributes.put(URI_TEMPLATE_VARIABLES_ATTRIBUTE, uriVariables);, +		}, +	}, +]
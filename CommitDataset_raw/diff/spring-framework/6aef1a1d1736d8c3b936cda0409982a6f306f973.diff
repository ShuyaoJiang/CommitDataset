[+++ b/spring-webmvc/src/main/java/org/springframework/web/servlet/resource/ResourceUrlProvider.java, +		Assert.state(index != -1, "Failed to determine lookup path: " + requestUrl);, +++ b/spring-webmvc/src/main/java/org/springframework/web/servlet/resource/ResourceUrlProvider.java, +		Assert.state(index != -1, "Failed to determine lookup path: " + requestUrl);, +++ b/spring-webmvc/src/test/java/org/springframework/web/servlet/resource/ResourceTransformerSupportTests.java, +	public void rewriteAbsolutePathWithContext() throws Exception {, +	}, +, +	@Test, +	public void rewriteAbsolutePath() throws Exception {, +		this.request.setRequestURI("/resources/main.css");, +		this.request.setMethod("GET");, +		this.request.setAttribute(HandlerMapping.PATH_WITHIN_HANDLER_MAPPING_ATTRIBUTE, "/resources/main.css");, +, +		String resourcePath = "/resources/bar.css";, +		Resource mainCss = new ClassPathResource("test/main.css", getClass());, +		String actual = this.transformer.resolveUrlPath(resourcePath, this.request, mainCss, this.transformerChain);, +		assertEquals("/resources/bar-11e16cf79faee7ac698c805cf28248d2.css", actual);, +	@Test(expected = IllegalStateException.class), +	public void rewriteAbsolutePathWrongPath() throws Exception {, +		this.request.setRequestURI("/servlet/context/resources/main.css");, +		this.request.setMethod("GET");, +		this.request.setServletPath("/servlet");, +		this.request.setContextPath("/context");, +		this.request.setAttribute(HandlerMapping.PATH_WITHIN_HANDLER_MAPPING_ATTRIBUTE, "/wrong/main.css");, +, +		String resourcePath = "/servlet/context/resources/bar.css";, +		Resource mainCss = new ClassPathResource("test/main.css", getClass());, +		this.transformer.resolveUrlPath(resourcePath, this.request, mainCss, this.transformerChain);, +	}, +]
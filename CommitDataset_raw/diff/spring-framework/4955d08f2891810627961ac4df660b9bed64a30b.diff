[+++ b/spring-core/src/main/java/org/springframework/core/codec/CharSequenceEncoder.java, +import java.nio.charset.CoderMalfunctionError;, +import org.springframework.core.io.buffer.DataBufferUtils;, +			boolean release = true;, +			DataBuffer dataBuffer = bufferFactory.allocateBuffer();, +			try {, +				dataBuffer.write(charSequence, charset);, +				release = false;, +			}, +			catch (CoderMalfunctionError ex) {, +				throw new EncodingException("String encoding error: " + ex.getMessage(), ex);, +			}, +			finally {, +				if (release) {, +					DataBufferUtils.release(dataBuffer);, +				}, +			}, +			return dataBuffer;, +++ b/spring-core/src/main/java/org/springframework/core/codec/CharSequenceEncoder.java, +import java.nio.charset.CoderMalfunctionError;, +import org.springframework.core.io.buffer.DataBufferUtils;, +			boolean release = true;, +			DataBuffer dataBuffer = bufferFactory.allocateBuffer();, +			try {, +				dataBuffer.write(charSequence, charset);, +				release = false;, +			}, +			catch (CoderMalfunctionError ex) {, +				throw new EncodingException("String encoding error: " + ex.getMessage(), ex);, +			}, +			finally {, +				if (release) {, +					DataBufferUtils.release(dataBuffer);, +				}, +			}, +			return dataBuffer;, +++ b/spring-core/src/test/java/org/springframework/core/codec/CharSequenceEncoderTests.java]
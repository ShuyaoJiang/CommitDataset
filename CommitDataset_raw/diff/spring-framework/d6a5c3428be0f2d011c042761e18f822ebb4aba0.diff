[+++ b/spring-websocket/src/main/java/org/springframework/web/socket/config/annotation/WebSocketTransportRegistration.java, +	 * Configure the maximum size of an inbound sub-protocol message, such as, +	 * a STOMP frame which may be aggregated from multiple WebSocket messages., +	 * <p><strong>Note:</strong> This is not the same as the size of an, +	 * individual WebSocket message which needs to be configured at the WebSocket, +	 * server level instead. See the reference documentation for details., +++ b/spring-websocket/src/main/java/org/springframework/web/socket/config/annotation/WebSocketTransportRegistration.java, +	 * Configure the maximum size of an inbound sub-protocol message, such as, +	 * a STOMP frame which may be aggregated from multiple WebSocket messages., +	 * <p><strong>Note:</strong> This is not the same as the size of an, +	 * individual WebSocket message which needs to be configured at the WebSocket, +	 * server level instead. See the reference documentation for details., +++ b/src/docs/asciidoc/web/websocket.adoc, +[[websocket-stomp-server-config]], +=== WebSocket Server, +, +To configure the underlying WebSocket server, the information in, +<<websocket-server-runtime-configuration>> applies. For Jetty, however you need to set, +the `HandshakeHandler` and `WebSocketPolicy` through the `StompEndpointRegistry`:, +, +====, +[source,java,indent=0], +[subs="verbatim,quotes"], +----, +	@Configuration, +	@EnableWebSocketMessageBroker, +	public class WebSocketConfig implements WebSocketMessageBrokerConfigurer {, +, +		@Override, +		public void registerStompEndpoints(StompEndpointRegistry registry) {, +			registry.addEndpoint("/portfolio").setHandshakeHandler(handshakeHandler());, +		}, +, +		@Bean, +		public DefaultHandshakeHandler handshakeHandler() {, +, +			WebSocketPolicy policy = new WebSocketPolicy(WebSocketBehavior.SERVER);, +			policy.setInputBufferSize(8192);, +			policy.setIdleTimeout(600000);, +, +			return new DefaultHandshakeHandler(, +					new JettyRequestUpgradeStrategy(new WebSocketServerFactory(policy)));, +		}, +	}, +----, +====, +, +, +]
[+++ b/build.gradle, +		optional("io.undertow:undertow-core:1.0.15.Final"), +		optional("io.undertow:undertow-servlet:1.0.15.Final") {, +		optional("io.undertow:undertow-websockets-jsr:1.0.15.Final") {, +++ b/build.gradle, +		optional("io.undertow:undertow-core:1.0.15.Final"), +		optional("io.undertow:undertow-servlet:1.0.15.Final") {, +		optional("io.undertow:undertow-websockets-jsr:1.0.15.Final") {, +++ b/spring-websocket/src/main/java/org/springframework/web/socket/server/standard/UndertowRequestUpgradeStrategy.java, +import io.undertow.websockets.core.WebSocketVersion;, +import io.undertow.websockets.jsr.handshake.JsrHybi07Handshake;, +import io.undertow.websockets.jsr.handshake.JsrHybi08Handshake;, +import io.undertow.websockets.jsr.handshake.JsrHybi13Handshake;, +	private final String[] supportedVersions = new String[] {, +			WebSocketVersion.V13.toHttpHeaderValue(),, +			WebSocketVersion.V08.toHttpHeaderValue(),, +			WebSocketVersion.V07.toHttpHeaderValue(), +	};, +		final Handshake handshake = getHandshakeToUse(exchange, configuredServerEndpoint);, +, +	private Handshake getHandshakeToUse(ServletWebSocketHttpExchange exchange, ConfiguredServerEndpoint endpoint) {, +		Handshake handshake = new JsrHybi13Handshake(endpoint);, +		handshake = new JsrHybi08Handshake(endpoint);, +		if (handshake.matches(exchange)) {, +			return handshake;, +		}, +		handshake = new JsrHybi07Handshake(endpoint);, +		if (handshake.matches(exchange)) {, +			return handshake;]
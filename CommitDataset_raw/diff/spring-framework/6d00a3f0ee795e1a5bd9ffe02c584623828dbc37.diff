[+++ b/spring-messaging/src/main/java/org/springframework/messaging/handler/websocket/SubProtocolHandler.java, +	 * @param message the message to resolve the session id from, +++ b/spring-messaging/src/main/java/org/springframework/messaging/handler/websocket/SubProtocolHandler.java, +	 * @param message the message to resolve the session id from, +++ b/spring-websocket/src/main/java/org/springframework/web/socket/WebSocketExtension.java, +/*, + * Copyright 2002-2013 the original author or authors., + *, + * Licensed under the Apache License, Version 2.0 (the "License");, + * you may not use this file except in compliance with the License., + * You may obtain a copy of the License at, + *, + *      http://www.apache.org/licenses/LICENSE-2.0, + *, + * Unless required by applicable law or agreed to in writing, software, + * distributed under the License is distributed on an "AS IS" BASIS,, + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied., + * See the License for the specific language governing permissions and, + * limitations under the License., + */, +, +package org.springframework.web.socket;, +, +import org.springframework.util.Assert;, +import org.springframework.util.CollectionUtils;, +import org.springframework.util.LinkedCaseInsensitiveMap;, +import org.springframework.util.StringUtils;, +, +import java.util.ArrayList;, +import java.util.Collections;, +import java.util.LinkedHashMap;, +import java.util.List;, +import java.util.Locale;, +import java.util.Map;, +, +/**, + * WebSocket Protocol extension., + * Adds new protocol features to the WebSocket protocol; the extensions used, + * within a session are negotiated during the handshake phase:, + * <ul>, + * <li>the client may ask for specific extensions in the HTTP request</li>, + * <li>the server declares the final list of supported extensions for the current session in the HTTP response</li>, + * </ul>, + *, + * <p>WebSocket Extension HTTP headers may include parameters and follow, + * <a href="https://tools.ietf.org/html/rfc2616#section-4.2">RFC 2616 Section 4.2</a>, + * specifications.</p>, + *, + * <p>Note that the order of extensions in HTTP headers defines their order of execution,, + * e.g. extensions "foo, bar" will be executed as "bar(foo(message))".</p>, + *, + * @author Brian Clozel, + * @since 4.0, + * @see <a href="https://tools.ietf.org/html/rfc6455#section-9">, + *     WebSocket Protocol Extensions, RFC 6455 - Section 9</a>, + */, +public class WebSocketExtension {, +, +	private final String name;, +, +	private final Map<String, String> parameters;, +, +	public WebSocketExtension(String name) {, +		this(name,null);, +	}, +, +	public WebSocketExtension(String name, Map<String, String> parameters) {, +		Assert.hasLength(name, "extension name must not be empty");, +		this.name = name;, +		if (!CollectionUtils.isEmpty(parameters)) {, +			Map<String, String> m = new LinkedCaseInsensitiveMap<String>(parameters.size(), Locale.ENGLISH);, +			m.putAll(parameters);, +			this.parameters = Collections.unmodifiableMap(m);, +		}, +		else {, +			this.parameters = Collections.emptyMap();, +		}, +	}, +, +	/**, +	 * @return the name of the extension, +	 */, +	public String getName() {, +		return this.name;, +	}, +, +	/**, +	 * @return the parameters of the extension, +	 */, +	public Map<String, String> getParameters() {, +		return this.parameters;, +	}, +, +	/**, +	 * Parse a list of raw WebSocket extension headers, +	 */, +	public static List<WebSocketExtension> parseHeaders(List<String> headers) {, +		if (headers == null || headers.isEmpty()) {, +			return Collections.emptyList();, +		}]
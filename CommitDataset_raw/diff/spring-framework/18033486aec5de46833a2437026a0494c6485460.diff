[+++ b/spring-messaging/src/main/java/org/springframework/messaging/simp/stomp/StompDecoder.java, +			if((index + 1) >= inString.length()) {, +				throw new StompConversionException("Illegal escape sequence at index " + index + ": " + inString);, +			}, +++ b/spring-messaging/src/main/java/org/springframework/messaging/simp/stomp/StompDecoder.java, +			if((index + 1) >= inString.length()) {, +				throw new StompConversionException("Illegal escape sequence at index " + index + ": " + inString);, +			}, +++ b/spring-messaging/src/test/java/org/springframework/messaging/simp/stomp/BufferingStompDecoderTests.java, +	@Test(expected = StompConversionException.class) // SPR-12418, +	public void endingBackslashHeaderValueCheck() throws InterruptedException {, +		BufferingStompDecoder stompDecoder = new BufferingStompDecoder(STOMP_DECODER, 128);, +		String payload = "SEND\na:alpha\\\n\nMessage body\0";, +		stompDecoder.decode(toByteBuffer(payload));, +	}, +]
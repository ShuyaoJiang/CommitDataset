[+++ b/spring-web/src/main/java/org/springframework/web/filter/ForwardedHeaderFilter.java, +import org.springframework.util.StringUtils;, +, +, +			UriComponentsBuilder builder = UriComponentsBuilder.fromUriString(location);, +, +			// Absolute location, +			if (builder.build().getScheme() != null) {, +				super.sendRedirect(location);, +				return;, +			// Network-path reference, +			if(location.startsWith("//")) {, +				String scheme = this.request.getScheme();, +				super.sendRedirect(builder.scheme(scheme).toUriString());, +				return;, +			// Relative to Servlet container root or to current request, +			String path;, +			if (location.startsWith(FOLDER_SEPARATOR)) {, +				path = this.request.getContextPath() + location;, +			}, +			else {, +				path = StringUtils.applyRelativePath(this.request.getRequestURI(), location);, +			String result = UriComponentsBuilder, +					.fromHttpRequest(new ServletServerHttpRequest(this.request)), +					.replacePath(path), +					.build().normalize().toUriString();, +			super.sendRedirect(result);]
[+++ b/spring-test/src/main/java/org/springframework/test/context/web/ServletTestExecutionListener.java, + * Copyright 2002-2016 the original author or authors., +	/**, +	 * Attribute name for a {@link TestContext} attribute which indicates that, +	 * that the {@link ServletTestExecutionListener} should be activated. When, +	 * not specified activation occurs when the {@linkplain TestContext#getTestClass(), +	 * test class} is annotated with {@link WebAppConfiguration @WebAppConfiguration}., +	 * @since 4.4, +	 */, +	public static final String ACTIVATE_LISTENER = Conventions.getQualifiedAttributeName(, +			ServletTestExecutionListener.class, "webApplicationConfiguration");, +, +	private boolean isActivated(TestContext testContext) {, +		return (Boolean.TRUE.equals(testContext.getAttribute(ACTIVATE_LISTENER)), +				|| AnnotationUtils.findAnnotation(testContext.getTestClass(), WebAppConfiguration.class) != null);, +		if (!isActivated(testContext) || alreadyPopulatedRequestContextHolder(testContext)) {, +++ b/spring-test/src/main/java/org/springframework/test/context/web/ServletTestExecutionListener.java, + * Copyright 2002-2016 the original author or authors., +	/**, +	 * Attribute name for a {@link TestContext} attribute which indicates that, +	 * that the {@link ServletTestExecutionListener} should be activated. When, +	 * not specified activation occurs when the {@linkplain TestContext#getTestClass(), +	 * test class} is annotated with {@link WebAppConfiguration @WebAppConfiguration}., +	 * @since 4.4, +	 */, +	public static final String ACTIVATE_LISTENER = Conventions.getQualifiedAttributeName(, +			ServletTestExecutionListener.class, "webApplicationConfiguration");, +, +	private boolean isActivated(TestContext testContext) {, +		return (Boolean.TRUE.equals(testContext.getAttribute(ACTIVATE_LISTENER)), +				|| AnnotationUtils.findAnnotation(testContext.getTestClass(), WebAppConfiguration.class) != null);, +		if (!isActivated(testContext) || alreadyPopulatedRequestContextHolder(testContext)) {, +++ b/spring-test/src/test/java/org/springframework/test/context/web/ServletTestExecutionListenerTests.java, + * Copyright 2002-2016 the original author or authors., +	@Test, +	public void activateAttributeAppConfigTestCaseWithoutExistingRequestAttributes() throws Exception {, +		BDDMockito.<Class<?>> given(testContext.getTestClass()).willReturn(NoAtWebAppConfigWebTestCase.class);, +		given(testContext.getAttribute(ServletTestExecutionListener.ACTIVATE_LISTENER)).willReturn(true);, +, +		RequestContextHolder.resetRequestAttributes();, +		listener.beforeTestClass(testContext);, +		assertAttributesNotAvailable();, +, +		assertWebAppConfigTestCase();, +	}, +, +	static class NoAtWebAppConfigWebTestCase {, +	}, +]
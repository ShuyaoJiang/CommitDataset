[+++ b/spring-web/src/main/java/org/springframework/web/util/UriComponentsBuilder.java, +				adaptForwardedHost(matcher.group(1).trim());, +				adaptForwardedHost(StringUtils.tokenizeToStringArray(hostHeader, ",")[0]);, +	private void adaptForwardedHost(String hostToUse) {, +		int portSeparatorIdx = hostToUse.lastIndexOf(":");, +		if (portSeparatorIdx > hostToUse.lastIndexOf("]")) {, +			host(hostToUse.substring(0, portSeparatorIdx));, +			port(Integer.parseInt(hostToUse.substring(portSeparatorIdx + 1)));, +		}, +		else {, +			host(hostToUse);, +			port(null);, +		}, +	}, +]
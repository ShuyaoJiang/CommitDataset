[+++ b/org.springframework.web.servlet/src/main/java/org/springframework/web/servlet/mvc/annotation/AnnotationMethodHandlerAdapter.java, +	/**, +	 * Template method for creating a new HttpInputMessage instance., +	 * <p>The default implementation creates a standard {@link ServletServerHttpRequest}., +	 * This can be overridden for custom {@code HttpInputMessage} implementations, +	 * @param servletRequest current HTTP request, +	 * @return the HttpInputMessage instance to use, +	 * @throws Exception in case of errors, +	 */, +    protected HttpInputMessage createHttpInputMessage(HttpServletRequest servletRequest) throws Exception {, +, +		return new ServletServerHttpRequest(servletRequest);, +	}, +, +	/**, +	 * Template method for creating a new HttpOuputMessage instance., +	 * <p>The default implementation creates a standard {@link ServletServerHttpResponse}., +	 * This can be overridden for custom {@code HttpOutputMessage} implementations, +	 * @param servletResponse current HTTP response, +	 * @return the HttpInputMessage instance to use, +	 * @throws Exception in case of errors, +	 */, +    protected HttpOutputMessage createHttpOutputMessage(HttpServletResponse servletResponse) throws Exception {, +, +		return new ServletServerHttpResponse(servletResponse);, +	}, +, +			return AnnotationMethodHandlerAdapter.this.createHttpInputMessage(servletRequest);, +		}, +, +        @Override, +		protected HttpOutputMessage createHttpOutputMessage(NativeWebRequest webRequest) throws Exception {, +			HttpServletResponse servletResponse = (HttpServletResponse) webRequest.getNativeResponse();, +			return AnnotationMethodHandlerAdapter.this.createHttpOutputMessage(servletResponse);, +				throws Exception {, +			HttpInputMessage inputMessage = createHttpInputMessage(webRequest);, +			HttpOutputMessage outputMessage = createHttpOutputMessage(webRequest);, +				throws Exception {, +			HttpInputMessage inputMessage = createHttpInputMessage(webRequest);, +			HttpOutputMessage outputMessage = createHttpOutputMessage(webRequest);, +++ b/org.springframework.web.servlet/src/main/java/org/springframework/web/servlet/mvc/annotation/AnnotationMethodHandlerAdapter.java, +	/**, +	 * Template method for creating a new HttpInputMessage instance., +	 * <p>The default implementation creates a standard {@link ServletServerHttpRequest}., +	 * This can be overridden for custom {@code HttpInputMessage} implementations, +	 * @param servletRequest current HTTP request, +	 * @return the HttpInputMessage instance to use, +	 * @throws Exception in case of errors, +	 */, +    protected HttpInputMessage createHttpInputMessage(HttpServletRequest servletRequest) throws Exception {, +, +		return new ServletServerHttpRequest(servletRequest);, +	}, +, +	/**, +	 * Template method for creating a new HttpOuputMessage instance., +	 * <p>The default implementation creates a standard {@link ServletServerHttpResponse}., +	 * This can be overridden for custom {@code HttpOutputMessage} implementations, +	 * @param servletResponse current HTTP response, +	 * @return the HttpInputMessage instance to use, +	 * @throws Exception in case of errors, +	 */, +    protected HttpOutputMessage createHttpOutputMessage(HttpServletResponse servletResponse) throws Exception {, +, +		return new ServletServerHttpResponse(servletResponse);, +	}, +, +			return AnnotationMethodHandlerAdapter.this.createHttpInputMessage(servletRequest);, +		}, +, +        @Override, +		protected HttpOutputMessage createHttpOutputMessage(NativeWebRequest webRequest) throws Exception {, +			HttpServletResponse servletResponse = (HttpServletResponse) webRequest.getNativeResponse();, +			return AnnotationMethodHandlerAdapter.this.createHttpOutputMessage(servletResponse);, +				throws Exception {, +			HttpInputMessage inputMessage = createHttpInputMessage(webRequest);, +			HttpOutputMessage outputMessage = createHttpOutputMessage(webRequest);, +				throws Exception {, +			HttpInputMessage inputMessage = createHttpInputMessage(webRequest);, +			HttpOutputMessage outputMessage = createHttpOutputMessage(webRequest);, +++ b/org.springframework.web/src/main/java/org/springframework/web/bind/annotation/support/HandlerMethodInvoker.java, +import org.springframework.http.HttpOutputMessage;, +	 * <p>Throws an UnsupportedOperation1Exception by default., +	/**, +	 * Return a {@link HttpOutputMessage} for the given {@link NativeWebRequest}., +	 * <p>Throws an UnsupportedOperationException by default., +	 */, +	protected HttpOutputMessage createHttpOutputMessage(NativeWebRequest webRequest) throws Exception {, +		throw new UnsupportedOperationException("@ResponseBody not supported");, +	}, +]
[+++ b/spring-orm/src/main/java/org/springframework/orm/hibernate5/LocalSessionFactoryBean.java, +import org.springframework.beans.factory.BeanFactory;, +import org.springframework.beans.factory.BeanFactoryAware;, +import org.springframework.beans.factory.config.ConfigurableListableBeanFactory;, +import org.springframework.util.ClassUtils;, +		implements FactoryBean<SessionFactory>, ResourceLoaderAware, BeanFactoryAware, InitializingBean, DisposableBean {, +	private ConfigurableListableBeanFactory beanFactory;, +, +	@Nullable, +	/**, +	 * Accept the containing {@link BeanFactory}, registering corresponding Hibernate, +	 * {@link org.hibernate.resource.beans.container.spi.BeanContainer} integration for, +	 * it if possible. This requires a Spring {@link ConfigurableListableBeanFactory}, +	 * and Hibernate 5.3 or higher on the classpath., +	 * @since 5.1, +	 * @see LocalSessionFactoryBuilder#setBeanContainer, +	 */, +	@Override, +	public void setBeanFactory(BeanFactory beanFactory) {, +		if (beanFactory instanceof ConfigurableListableBeanFactory &&, +				ClassUtils.isPresent("org.hibernate.resource.beans.container.spi.BeanContainer",, +						getClass().getClassLoader())) {, +			this.beanFactory = (ConfigurableListableBeanFactory) beanFactory;, +		}, +	}, +, +		if (this.beanFactory != null) {, +			sfb.setBeanContainer(this.beanFactory);, +		}, +, +++ b/spring-orm/src/main/java/org/springframework/orm/hibernate5/LocalSessionFactoryBean.java, +import org.springframework.beans.factory.BeanFactory;, +import org.springframework.beans.factory.BeanFactoryAware;, +import org.springframework.beans.factory.config.ConfigurableListableBeanFactory;, +import org.springframework.util.ClassUtils;, +		implements FactoryBean<SessionFactory>, ResourceLoaderAware, BeanFactoryAware, InitializingBean, DisposableBean {, +	private ConfigurableListableBeanFactory beanFactory;, +, +	@Nullable, +	/**, +	 * Accept the containing {@link BeanFactory}, registering corresponding Hibernate, +	 * {@link org.hibernate.resource.beans.container.spi.BeanContainer} integration for, +	 * it if possible. This requires a Spring {@link ConfigurableListableBeanFactory}, +	 * and Hibernate 5.3 or higher on the classpath., +	 * @since 5.1, +	 * @see LocalSessionFactoryBuilder#setBeanContainer, +	 */, +	@Override, +	public void setBeanFactory(BeanFactory beanFactory) {, +		if (beanFactory instanceof ConfigurableListableBeanFactory &&, +				ClassUtils.isPresent("org.hibernate.resource.beans.container.spi.BeanContainer",, +						getClass().getClassLoader())) {, +			this.beanFactory = (ConfigurableListableBeanFactory) beanFactory;, +		}, +	}, +, +		if (this.beanFactory != null) {, +			sfb.setBeanContainer(this.beanFactory);, +		}, +, +++ b/spring-orm/src/main/java/org/springframework/orm/hibernate5/LocalSessionFactoryBuilder.java, +import org.springframework.beans.factory.config.ConfigurableListableBeanFactory;, +	 * Set a Hibernate {@link org.hibernate.resource.beans.container.spi.BeanContainer}, +	 * for the given Spring {@link ConfigurableListableBeanFactory}., +	 * <p>Note: Bean container integration requires Hibernate 5.3 or higher., +	 * It enables autowiring of Hibernate attribute converters and entity listeners., +	 * @since 5.1, +	 * @see AvailableSettings#BEAN_CONTAINER, +	 */, +	public LocalSessionFactoryBuilder setBeanContainer(ConfigurableListableBeanFactory beanFactory) {, +		getProperties().put(AvailableSettings.BEAN_CONTAINER, new SpringBeanContainer(beanFactory));, +		return this;, +	}, +, +	/**, +++ b/spring-orm/src/main/java/org/springframework/orm/hibernate5/LocalSessionFactoryBean.java, +import org.springframework.beans.factory.BeanFactory;, +import org.springframework.beans.factory.BeanFactoryAware;, +import org.springframework.beans.factory.config.ConfigurableListableBeanFactory;, +import org.springframework.util.ClassUtils;, +		implements FactoryBean<SessionFactory>, ResourceLoaderAware, BeanFactoryAware, InitializingBean, DisposableBean {, +	private ConfigurableListableBeanFactory beanFactory;, +, +	@Nullable, +	/**, +	 * Accept the containing {@link BeanFactory}, registering corresponding Hibernate, +	 * {@link org.hibernate.resource.beans.container.spi.BeanContainer} integration for, +	 * it if possible. This requires a Spring {@link ConfigurableListableBeanFactory}, +	 * and Hibernate 5.3 or higher on the classpath., +	 * @since 5.1, +	 * @see LocalSessionFactoryBuilder#setBeanContainer, +	 */, +	@Override, +	public void setBeanFactory(BeanFactory beanFactory) {, +		if (beanFactory instanceof ConfigurableListableBeanFactory &&, +				ClassUtils.isPresent("org.hibernate.resource.beans.container.spi.BeanContainer",, +						getClass().getClassLoader())) {, +			this.beanFactory = (ConfigurableListableBeanFactory) beanFactory;, +		}, +	}]
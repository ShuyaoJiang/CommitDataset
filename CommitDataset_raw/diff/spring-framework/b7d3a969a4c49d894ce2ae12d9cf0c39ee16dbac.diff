[+++ b/spring-webmvc/src/main/java/org/springframework/web/servlet/config/annotation/ResourceHandlerRegistry.java, +				catch (Throwable ex) {, +++ b/spring-webmvc/src/main/java/org/springframework/web/servlet/config/annotation/ResourceHandlerRegistry.java, +				catch (Throwable ex) {, +++ b/spring-webmvc/src/main/java/org/springframework/web/servlet/resource/ResourceHttpRequestHandler.java, +		implements HttpRequestHandler, InitializingBean, CorsConfigurationSource {, +	private PathExtensionContentNegotiationStrategy contentNegotiationStrategy;, +, +, +, +		this.contentNegotiationStrategy = initContentNegotiationStrategy();, +	/**, +	 * Initialize the content negotiation strategy depending on the {@code ContentNegotiationManager}, +	 * setup and the availability of a {@code ServletContext}., +	 * @see ServletPathExtensionContentNegotiationStrategy, +	 * @see PathExtensionContentNegotiationStrategy, +	 */, +		return (getServletContext() != null ?, +				new PathExtensionContentNegotiationStrategy(mediaTypes));, +		return this.contentNegotiationStrategy.getMediaTypeForResource(resource);, +++ b/spring-webmvc/src/main/java/org/springframework/web/servlet/config/annotation/ResourceHandlerRegistry.java, +				catch (Throwable ex) {, +++ b/spring-webmvc/src/main/java/org/springframework/web/servlet/resource/ResourceHttpRequestHandler.java, +		implements HttpRequestHandler, InitializingBean, CorsConfigurationSource {, +	private PathExtensionContentNegotiationStrategy contentNegotiationStrategy;, +, +, +, +		this.contentNegotiationStrategy = initContentNegotiationStrategy();, +	/**, +	 * Initialize the content negotiation strategy depending on the {@code ContentNegotiationManager}, +	 * setup and the availability of a {@code ServletContext}., +	 * @see ServletPathExtensionContentNegotiationStrategy, +	 * @see PathExtensionContentNegotiationStrategy, +	 */, +		return (getServletContext() != null ?, +				new PathExtensionContentNegotiationStrategy(mediaTypes));, +		return this.contentNegotiationStrategy.getMediaTypeForResource(resource);, +++ b/spring-webmvc/src/test/java/org/springframework/web/servlet/resource/ResourceHttpRequestHandlerTests.java]
[+++ b/spring-test/src/main/java/org/springframework/test/context/support/AbstractTestContextBootstrapper.java, +import org.springframework.beans.BeanInstantiationException;, + * <li>{@link #getDefaultTestExecutionListenerClassNames}, + * <li>{@link #getDefaultContextLoaderClass}, + * <li>{@link #buildMergedContextConfiguration}, + * </ul>, +					logger.trace(String.format("Retrieved @TestExecutionListeners attributes [%s] for declaring class [%s].",, +							annAttrs, declaringClass));, +				Class<? extends TestExecutionListener>[] valueListenerClasses =, +						(Class<? extends TestExecutionListener>[]) annAttrs.getClassArray("value");, +				Class<? extends TestExecutionListener>[] listenerClasses =, +						(Class<? extends TestExecutionListener>[]) annAttrs.getClassArray("listeners");, +					throw new IllegalStateException(, +							String.format("Class [%s] has been configured with @TestExecutionListeners' 'value' [%s]" +, +							ObjectUtils.nullSafeToString(listenerClasses)));, +			NoClassDefFoundError ncdfe = null;, +				ncdfe = err;, +			}, +			catch (BeanInstantiationException ex) {, +				if (ex.getCause() instanceof NoClassDefFoundError) {, +					ncdfe = (NoClassDefFoundError) ex.getCause();, +				}, +			}, +			if (ncdfe != null) {, +							"(and their dependencies) available. Offending class: [%s]",, +							listenerClass.getName(), ncdfe.getMessage()));, +				logger.info(String.format("Neither @ContextConfiguration nor @ContextHierarchy found for test class [%s]",, +			Map<String, List<ContextConfigurationAttributes>> hierarchyMap =, +					ContextLoaderUtils.buildContextHierarchyMap(testClass);, +				mergedConfig = buildMergedContextConfiguration(, +						declaringClass, reversedList, parentConfig, cacheAwareContextLoaderDelegate);, +	private MergedContextConfiguration buildMergedContextConfiguration(Class<?> testClass,, +			List<ContextConfigurationAttributes> configAttributesList, MergedContextConfiguration parentConfig,, +		ContextLoader contextLoader = resolveContextLoader(testClass, configAttributesList);, +		List<String> locationsList = new ArrayList<String>();, +		List<Class<?>> classesList = new ArrayList<Class<?>>();, +	 * @param cacheAwareContextLoaderDelegate the cache-aware context loader delegate, +	 * to be provided to the instantiated {@code MergedContextConfiguration}]
[+++ b/spring-context/src/main/java/org/springframework/cache/ehcache/EhCacheFactoryBean.java, + * Copyright 2002-2012 the original author or authors., +, +	/**, +	 * Predict the particular {@code Ehcache} implementation that will be returned from, +	 * {@link #getObject()} based on logic in {@link #createCache()} and, +	 * {@link #decorateCache(Ehcache)} as orchestrated by {@link #afterPropertiesSet()}., +	 */, +		if (this.cache != null) {, +			return this.cache.getClass();, +		}, +		if (this.cacheEntryFactory != null) {, +			if (this.cacheEntryFactory instanceof UpdatingCacheEntryFactory) {, +				return UpdatingSelfPopulatingCache.class;, +			}, +			else {, +				return SelfPopulatingCache.class;, +			}, +		}, +		if (this.blocking) {, +			return BlockingCache.class;, +		}, +		return Cache.class;, +++ b/spring-context/src/main/java/org/springframework/cache/ehcache/EhCacheFactoryBean.java, + * Copyright 2002-2012 the original author or authors., +, +	/**, +	 * Predict the particular {@code Ehcache} implementation that will be returned from, +	 * {@link #getObject()} based on logic in {@link #createCache()} and, +	 * {@link #decorateCache(Ehcache)} as orchestrated by {@link #afterPropertiesSet()}., +	 */, +		if (this.cache != null) {, +			return this.cache.getClass();, +		}, +		if (this.cacheEntryFactory != null) {, +			if (this.cacheEntryFactory instanceof UpdatingCacheEntryFactory) {, +				return UpdatingSelfPopulatingCache.class;, +			}, +			else {, +				return SelfPopulatingCache.class;, +			}, +		}, +		if (this.blocking) {, +			return BlockingCache.class;, +		}, +		return Cache.class;, +++ b/spring-context/src/test/java/org/springframework/cache/ehcache/EhCacheSupportTests.java, + * Copyright 2002-2012 the original author or authors., +, +			Class<? extends Ehcache> objectType = cacheFb.getObjectType();, +			assertTrue(Ehcache.class.isAssignableFrom(objectType));, +			Class<? extends Ehcache> objectType2 = cacheFb.getObjectType();, +			assertSame(objectType, objectType2);, +			assertEquals(cacheFb.getObjectType(), BlockingCache.class);, +			assertEquals(cacheFb.getObjectType(), SelfPopulatingCache.class);, +			assertEquals(cacheFb.getObjectType(), UpdatingSelfPopulatingCache.class);]
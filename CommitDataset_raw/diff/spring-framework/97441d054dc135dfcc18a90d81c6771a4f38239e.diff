[+++ b/spring-webmvc/src/main/java/org/springframework/web/servlet/resource/ResourceUrlProvider.java, +		int index = getLookupPathIndex(request);, +		String resolvedLookupPath = getForLookupPath(lookupPath);, +		return (resolvedLookupPath != null) ? prefix + resolvedLookupPath : null;, +	}, +	private int getLookupPathIndex(HttpServletRequest request) {, +		String requestUri = getPathHelper().getRequestUri(request);, +		String lookupPath = getPathHelper().getLookupPathForRequest(request);, +		return requestUri.indexOf(lookupPath);, +++ b/spring-webmvc/src/main/java/org/springframework/web/servlet/resource/ResourceUrlProvider.java, +		int index = getLookupPathIndex(request);, +		String resolvedLookupPath = getForLookupPath(lookupPath);, +		return (resolvedLookupPath != null) ? prefix + resolvedLookupPath : null;, +	}, +	private int getLookupPathIndex(HttpServletRequest request) {, +		String requestUri = getPathHelper().getRequestUri(request);, +		String lookupPath = getPathHelper().getLookupPathForRequest(request);, +		return requestUri.indexOf(lookupPath);, +++ b/spring-webmvc/src/test/java/org/springframework/web/servlet/resource/ResourceTransformerSupportTests.java, +		this.request.setContextPath("/context");, +		this.request.setServletPath("/servlet");, +++ b/spring-webmvc/src/main/java/org/springframework/web/servlet/resource/ResourceUrlProvider.java, +		int index = getLookupPathIndex(request);, +		String resolvedLookupPath = getForLookupPath(lookupPath);, +		return (resolvedLookupPath != null) ? prefix + resolvedLookupPath : null;, +	}, +	private int getLookupPathIndex(HttpServletRequest request) {, +		String requestUri = getPathHelper().getRequestUri(request);, +		String lookupPath = getPathHelper().getLookupPathForRequest(request);, +		return requestUri.indexOf(lookupPath);, +++ b/spring-webmvc/src/test/java/org/springframework/web/servlet/resource/ResourceTransformerSupportTests.java, +		this.request.setContextPath("/context");, +		this.request.setServletPath("/servlet");, +++ b/spring-webmvc/src/test/java/org/springframework/web/servlet/resource/ResourceUrlProviderJavaConfigTests.java, +	public void resolvePathWithServletMappedAsRoot() throws Exception {, +	public void resolvePathWithServletMappingByPrefix() throws Exception {]
[+++ b/spring-core/src/main/java/org/springframework/util/ConcurrentReferenceHashMap.java, +		int initialSize = 1 << calculateShift(roundedUpSegmentCapacity, MAXIMUM_SEGMENT_SIZE);, +		Segment[] segments = (Segment[]) Array.newInstance(Segment.class, size);, +		int resizeThreshold = (int) (initialSize * getLoadFactor());, +		for (int i = 0; i < segments.length; i++) {, +			segments[i] = new Segment(initialSize, resizeThreshold);, +		this.segments = segments;, +		public Segment(int initialSize, int resizeThreshold) {, +			this.initialSize = initialSize;, +			this.references = createReferenceArray(initialSize);, +			this.resizeThreshold = resizeThreshold;]
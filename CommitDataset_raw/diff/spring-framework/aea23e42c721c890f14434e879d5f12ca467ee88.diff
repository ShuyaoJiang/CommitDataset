[+++ b/spring-web/src/test/java/org/springframework/web/cors/DefaultCorsProcessorTests.java, +		this.request.addHeader(HttpHeaders.ORIGIN, "http://domain2.com");, +		this.request.addHeader(HttpHeaders.ORIGIN, "http://domain2.com");, +		this.request.addHeader(HttpHeaders.ORIGIN, "http://domain2.com");, +	public void actualRequestCredentials() throws Exception {, +		this.request.addHeader(HttpHeaders.ORIGIN, "http://domain2.com");, +		this.conf.addAllowedOrigin("http://domain1.com");, +		this.conf.addAllowedOrigin("http://domain2.com");, +		this.conf.addAllowedOrigin("http://domain3.com");, +		assertEquals("http://domain2.com", response.getHeader(HttpHeaders.ACCESS_CONTROL_ALLOW_ORIGIN));, +		this.request.addHeader(HttpHeaders.ORIGIN, "http://domain2.com");, +		assertEquals("http://domain2.com", response.getHeader(HttpHeaders.ACCESS_CONTROL_ALLOW_ORIGIN));, +		this.request.addHeader(HttpHeaders.ORIGIN, "http://domain2.com");, +		this.conf.addAllowedOrigin("http://DOMAIN2.com");, +		this.request.addHeader(HttpHeaders.ORIGIN, "http://domain2.com");, +		this.conf.addAllowedOrigin("http://domain2.com");, +		assertEquals("http://domain2.com", response.getHeader(HttpHeaders.ACCESS_CONTROL_ALLOW_ORIGIN));, +		this.request.addHeader(HttpHeaders.ORIGIN, "http://domain2.com");, +		this.request.addHeader(HttpHeaders.ORIGIN, "http://domain2.com");, +		this.request.addHeader(HttpHeaders.ORIGIN, "http://domain2.com");, +		this.request.addHeader(HttpHeaders.ORIGIN, "http://domain2.com");, +		this.request.addHeader(HttpHeaders.ORIGIN, "http://domain2.com");, +		this.request.addHeader(HttpHeaders.ORIGIN, "http://domain2.com");, +		this.request.addHeader(HttpHeaders.ORIGIN, "http://domain2.com");, +	public void preflightRequestCredentials() throws Exception {, +		this.request.addHeader(HttpHeaders.ORIGIN, "http://domain2.com");, +		this.conf.addAllowedOrigin("http://domain1.com");, +		this.conf.addAllowedOrigin("http://domain2.com");, +		this.conf.addAllowedOrigin("http://domain3.com");, +		assertEquals("http://domain2.com", response.getHeader(HttpHeaders.ACCESS_CONTROL_ALLOW_ORIGIN));, +		this.request.addHeader(HttpHeaders.ORIGIN, "http://domain2.com");, +		this.conf.addAllowedOrigin("http://domain1.com");, +		this.conf.addAllowedOrigin("http://domain3.com");, +		assertEquals("http://domain2.com", response.getHeader(HttpHeaders.ACCESS_CONTROL_ALLOW_ORIGIN));, +		this.request.addHeader(HttpHeaders.ORIGIN, "http://domain2.com");, +		this.conf.addAllowedOrigin("http://domain2.com");, +		this.request.addHeader(HttpHeaders.ORIGIN, "http://domain2.com");, +		this.conf.addAllowedOrigin("http://domain2.com");, +		this.request.addHeader(HttpHeaders.ORIGIN, "http://domain2.com");, +++ b/spring-web/src/test/java/org/springframework/web/cors/DefaultCorsProcessorTests.java, +		this.request.addHeader(HttpHeaders.ORIGIN, "http://domain2.com");, +		this.request.addHeader(HttpHeaders.ORIGIN, "http://domain2.com");, +		this.request.addHeader(HttpHeaders.ORIGIN, "http://domain2.com");, +	public void actualRequestCredentials() throws Exception {, +		this.request.addHeader(HttpHeaders.ORIGIN, "http://domain2.com");, +		this.conf.addAllowedOrigin("http://domain1.com");, +		this.conf.addAllowedOrigin("http://domain2.com");, +		this.conf.addAllowedOrigin("http://domain3.com");, +		assertEquals("http://domain2.com", response.getHeader(HttpHeaders.ACCESS_CONTROL_ALLOW_ORIGIN));, +		this.request.addHeader(HttpHeaders.ORIGIN, "http://domain2.com");, +		assertEquals("http://domain2.com", response.getHeader(HttpHeaders.ACCESS_CONTROL_ALLOW_ORIGIN));, +		this.request.addHeader(HttpHeaders.ORIGIN, "http://domain2.com");, +		this.conf.addAllowedOrigin("http://DOMAIN2.com");, +		this.request.addHeader(HttpHeaders.ORIGIN, "http://domain2.com");, +		this.conf.addAllowedOrigin("http://domain2.com");, +		assertEquals("http://domain2.com", response.getHeader(HttpHeaders.ACCESS_CONTROL_ALLOW_ORIGIN));, +		this.request.addHeader(HttpHeaders.ORIGIN, "http://domain2.com");, +		this.request.addHeader(HttpHeaders.ORIGIN, "http://domain2.com");, +		this.request.addHeader(HttpHeaders.ORIGIN, "http://domain2.com");, +		this.request.addHeader(HttpHeaders.ORIGIN, "http://domain2.com");, +		this.request.addHeader(HttpHeaders.ORIGIN, "http://domain2.com");, +		this.request.addHeader(HttpHeaders.ORIGIN, "http://domain2.com");, +		this.request.addHeader(HttpHeaders.ORIGIN, "http://domain2.com");, +	public void preflightRequestCredentials() throws Exception {, +		this.request.addHeader(HttpHeaders.ORIGIN, "http://domain2.com");, +		this.conf.addAllowedOrigin("http://domain1.com");, +		this.conf.addAllowedOrigin("http://domain2.com");, +		this.conf.addAllowedOrigin("http://domain3.com");, +		assertEquals("http://domain2.com", response.getHeader(HttpHeaders.ACCESS_CONTROL_ALLOW_ORIGIN));, +		this.request.addHeader(HttpHeaders.ORIGIN, "http://domain2.com");, +		this.conf.addAllowedOrigin("http://domain1.com");, +		this.conf.addAllowedOrigin("http://domain3.com");, +		assertEquals("http://domain2.com", response.getHeader(HttpHeaders.ACCESS_CONTROL_ALLOW_ORIGIN));, +		this.request.addHeader(HttpHeaders.ORIGIN, "http://domain2.com");, +		this.conf.addAllowedOrigin("http://domain2.com");, +		this.request.addHeader(HttpHeaders.ORIGIN, "http://domain2.com");, +		this.conf.addAllowedOrigin("http://domain2.com");, +		this.request.addHeader(HttpHeaders.ORIGIN, "http://domain2.com");, +++ b/spring-webmvc/src/test/java/org/springframework/web/servlet/handler/CorsAbstractHandlerMappingTests.java, +		this.request.addHeader(HttpHeaders.ORIGIN, "http://domain2.com");, +		this.request.addHeader(HttpHeaders.ORIGIN, "http://domain2.com");, +		this.request.addHeader(HttpHeaders.ORIGIN, "http://domain2.com");, +		this.request.addHeader(HttpHeaders.ORIGIN, "http://domain2.com");, +		this.request.addHeader(HttpHeaders.ORIGIN, "http://domain2.com");, +		this.request.addHeader(HttpHeaders.ORIGIN, "http://domain2.com");]
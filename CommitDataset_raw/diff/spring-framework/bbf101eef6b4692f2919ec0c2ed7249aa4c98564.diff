[+++ b/spring-websocket/src/main/java/org/springframework/web/socket/messaging/StompSubProtocolHandler.java, +				if (this.eventPublisher != null && StompCommand.CONNECT.equals(headers.getCommand())) {, +			if (this.eventPublisher != null && StompCommand.CONNECTED.equals(headers.getCommand())) {, +++ b/spring-websocket/src/main/java/org/springframework/web/socket/messaging/StompSubProtocolHandler.java, +				if (this.eventPublisher != null && StompCommand.CONNECT.equals(headers.getCommand())) {, +			if (this.eventPublisher != null && StompCommand.CONNECTED.equals(headers.getCommand())) {, +++ b/spring-websocket/src/test/java/org/springframework/web/socket/messaging/StompSubProtocolHandlerTests.java, +		assertEquals("Unexpected events " + publisher.events, 3, publisher.events.size());]
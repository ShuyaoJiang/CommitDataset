[+++ b/org.springframework.web.servlet/src/main/java/org/springframework/web/servlet/view/tiles2/TilesConfigurer.java, +import javax.servlet.jsp.JspFactory;, +		boolean activateEl = false;, +		if (tilesElPresent) {, +			activateEl = new JspExpressionChecker().isExpressionFactoryAvailable();, +			if (!this.tilesPropertyMap.containsKey(TilesContainerFactory.ATTRIBUTE_EVALUATOR_INIT_PARAM)) {, +				this.tilesPropertyMap.put(TilesContainerFactory.ATTRIBUTE_EVALUATOR_INIT_PARAM, activateEl ?, +						"org.apache.tiles.evaluator.el.ELAttributeEvaluator" : DirectAttributeEvaluator.class.getName());, +			}, +		}, +, +			logger.debug("Registering Tiles 2.2 LocaleResolver for complete-autoload setup");, +		if (activateEl && this.tilesInitializer instanceof SpringTilesInitializer) {, +			new TilesElActivator().registerEvaluator(container);, +	private class JspExpressionChecker {, +		public boolean isExpressionFactoryAvailable() {, +			try {, +				JspFactory factory = JspFactory.getDefaultFactory();, +				if (factory != null &&, +						factory.getJspApplicationContext(servletContext).getExpressionFactory() != null) {, +					logger.info("Found JSP 2.1 ExpressionFactory");, +					return true;, +				}, +			}, +			catch (Throwable ex) {, +				logger.warn("Could not obtain JSP 2.1 ExpressionFactory", ex);, +			}, +			return false;, +		}, +	}, +, +, +	private class TilesElActivator {, +, +		public void registerEvaluator(BasicTilesContainer container) {, +			logger.debug("Registering Tiles 2.2 AttributeEvaluatorFactory for JSP 2.1");, +++ b/org.springframework.web.servlet/src/main/java/org/springframework/web/servlet/view/tiles2/TilesConfigurer.java, +import javax.servlet.jsp.JspFactory;, +		boolean activateEl = false;, +		if (tilesElPresent) {, +			activateEl = new JspExpressionChecker().isExpressionFactoryAvailable();, +			if (!this.tilesPropertyMap.containsKey(TilesContainerFactory.ATTRIBUTE_EVALUATOR_INIT_PARAM)) {, +				this.tilesPropertyMap.put(TilesContainerFactory.ATTRIBUTE_EVALUATOR_INIT_PARAM, activateEl ?, +						"org.apache.tiles.evaluator.el.ELAttributeEvaluator" : DirectAttributeEvaluator.class.getName());, +			}, +		}, +, +			logger.debug("Registering Tiles 2.2 LocaleResolver for complete-autoload setup");, +		if (activateEl && this.tilesInitializer instanceof SpringTilesInitializer) {, +			new TilesElActivator().registerEvaluator(container);, +	private class JspExpressionChecker {, +		public boolean isExpressionFactoryAvailable() {, +			try {, +				JspFactory factory = JspFactory.getDefaultFactory();, +				if (factory != null &&, +						factory.getJspApplicationContext(servletContext).getExpressionFactory() != null) {, +					logger.info("Found JSP 2.1 ExpressionFactory");, +					return true;, +				}, +			}, +			catch (Throwable ex) {, +				logger.warn("Could not obtain JSP 2.1 ExpressionFactory", ex);, +			}, +			return false;, +		}, +	}, +, +, +	private class TilesElActivator {, +, +		public void registerEvaluator(BasicTilesContainer container) {, +			logger.debug("Registering Tiles 2.2 AttributeEvaluatorFactory for JSP 2.1");, +++ b/org.springframework.web.servlet/src/test/java/org/springframework/web/servlet/view/tiles2/TilesConfigurerTests.java]
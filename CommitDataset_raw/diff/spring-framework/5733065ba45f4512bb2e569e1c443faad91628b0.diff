[+++ b/src/docs/asciidoc/integration.adoc, +, +include::web/webflux-webclient.adoc[leveloffset=+3], +++ b/src/docs/asciidoc/integration.adoc, +, +include::web/webflux-webclient.adoc[leveloffset=+3], +++ /dev/null, +++ b/src/docs/asciidoc/integration.adoc, +, +include::web/webflux-webclient.adoc[leveloffset=+3], +++ /dev/null, +++ b/src/docs/asciidoc/web/webflux-webclient.adoc, +[[webflux-client]], += WebClient, +, +The `spring-webflux` module includes a non-blocking, reactive client for HTTP requests, +with Reactive Streams back pressure. It shares, +<<web-reactive.adoc#webflux-codecs,HTTP codecs>> and other infrastructure with the, +server <<web-reactive.adoc#webflux-fn,functional web framework>>., +, +`WebClient` provides a higher level API over HTTP client libraries. By default, +it uses https://github.com/reactor/reactor-netty[Reactor Netty] but that is pluggable, +with a different `ClientHttpConnector`. The `WebClient` API returns Reactor `Flux` or, +`Mono` for output and accepts Reactive Streams `Publisher` as input (see, +<<web-reactive.adoc#webflux-reactive-libraries>>)., +, +[TIP], +====, +By comparison to the, +<<integration.adoc#rest-resttemplate,RestTemplate>>, the `WebClient` offers a more, +functional and fluent API that taking full advantage of Java 8 lambdas. It supports both, +sync and async scenarios, including streaming, and brings the efficiency of, +non-blocking I/O., +====, +, +, +[[webflux-client-retrieve]], +== Retrieve, +, +The `retrieve()` method is the easiest way to get a response body and decode it:, +, +[source,java,intent=0], +[subs="verbatim,quotes"], +----, +    WebClient client = WebClient.create("http://example.org");, +, +    Mono<Person> result = client.get(), +            .uri("/persons/{id}", id).accept(MediaType.APPLICATION_JSON), +            .retrieve(), +            .bodyToMono(Person.class);, +----, +, +You can also get a stream of objects decoded from the response:, +, +[source,java,intent=0], +[subs="verbatim,quotes"], +----, +    Flux<Quote> result = client.get(), +            .uri("/quotes").accept(TEXT_EVENT_STREAM), +            .retrieve(), +            .bodyToFlux(Quote.class);, +----, +, +By default, responses with 4xx or 5xx status codes result in an error of type, +`WebClientResponseException` but you can customize that:, +, +[source,java,intent=0], +[subs="verbatim,quotes"], +----, +    Mono<Person> result = client.get(), +            .uri("/persons/{id}", id).accept(MediaType.APPLICATION_JSON), +            .retrieve(), +            .onStatus(HttpStatus::is4xxServerError, response -> ...), +            .onStatus(HttpStatus::is5xxServerError, response -> ...), +            .bodyToFlux(Person.class);, +----, +, +, +, +[[webflux-client-exchange]], +== Exchange, +, +The `exchange()` method provides more control. The below example is equivalent, +to `retrieve()` but also provides access to the `ClientResponse`:, +, +[source,java,intent=0], +[subs="verbatim,quotes"], +----, +    Mono<Person> result = client.get(), +            .uri("/persons/{id}", id).accept(MediaType.APPLICATION_JSON), +            .exchange(), +            .flatMap(response -> response.bodyToMono(Person.class));, +----, +, +At this level you can also create a full `ResponseEntity`:, +, +[source,java,intent=0], +[subs="verbatim,quotes"], +----, +    Mono<ResponseEntity<Person>> result = client.get()]
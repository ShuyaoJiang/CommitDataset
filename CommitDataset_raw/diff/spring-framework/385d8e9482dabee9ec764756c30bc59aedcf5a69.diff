[+++ b/org.springframework.beans/src/test/java/org/springframework/beans/factory/config/PropertyPlaceholderConfigurerTests.java, + * Copyright 2002-2011 the original author or authors., +		// for os x / linux, +					if (obj != null && obj.getClass().getName().equals("java.lang.ProcessEnvironment$StringEnvironment")) {, +					}, +, +		// for windows, +		Class<?> processEnvironmentClass;, +		try {, +			processEnvironmentClass = Class.forName("java.lang.ProcessEnvironment");, +		} catch (Exception e) {, +			throw new RuntimeException(e);, +		}, +, +		try {, +			Field theCaseInsensitiveEnvironmentField = processEnvironmentClass.getDeclaredField("theCaseInsensitiveEnvironment");, +			theCaseInsensitiveEnvironmentField.setAccessible(true);, +			Object obj = theCaseInsensitiveEnvironmentField.get(null);, +			return (Map<String, String>) obj;, +		} catch (NoSuchFieldException e) {, +			// do nothing, +		} catch (Exception e) {, +			throw new RuntimeException(e);, +		}, +, +		try {, +			Field theEnvironmentField = processEnvironmentClass.getDeclaredField("theEnvironment");, +			theEnvironmentField.setAccessible(true);, +			Object obj = theEnvironmentField.get(null);, +			return (Map<String, String>) obj;, +		} catch (NoSuchFieldException e) {, +			// do nothing, +		} catch (Exception e) {, +			throw new RuntimeException(e);, +		}, +, +++ b/org.springframework.beans/src/test/java/org/springframework/beans/factory/config/PropertyPlaceholderConfigurerTests.java, + * Copyright 2002-2011 the original author or authors., +		// for os x / linux, +					if (obj != null && obj.getClass().getName().equals("java.lang.ProcessEnvironment$StringEnvironment")) {, +					}, +, +		// for windows, +		Class<?> processEnvironmentClass;, +		try {, +			processEnvironmentClass = Class.forName("java.lang.ProcessEnvironment");, +		} catch (Exception e) {, +			throw new RuntimeException(e);, +		}, +, +		try {, +			Field theCaseInsensitiveEnvironmentField = processEnvironmentClass.getDeclaredField("theCaseInsensitiveEnvironment");, +			theCaseInsensitiveEnvironmentField.setAccessible(true);, +			Object obj = theCaseInsensitiveEnvironmentField.get(null);, +			return (Map<String, String>) obj;, +		} catch (NoSuchFieldException e) {, +			// do nothing, +		} catch (Exception e) {, +			throw new RuntimeException(e);, +		}, +, +		try {, +			Field theEnvironmentField = processEnvironmentClass.getDeclaredField("theEnvironment");, +			theEnvironmentField.setAccessible(true);, +			Object obj = theEnvironmentField.get(null);, +			return (Map<String, String>) obj;, +		} catch (NoSuchFieldException e) {, +			// do nothing, +		} catch (Exception e) {, +			throw new RuntimeException(e);, +		}, +, +++ b/org.springframework.core/src/test/java/org/springframework/core/env/EnvironmentTests.java, +		// for os x / linux, +					if (obj != null && obj.getClass().getName().equals("java.lang.ProcessEnvironment$StringEnvironment")) {, +					}, +, +		// for windows, +		Class<?> processEnvironmentClass;, +		try {, +			processEnvironmentClass = Class.forName("java.lang.ProcessEnvironment");, +		} catch (Exception e) {, +			throw new RuntimeException(e);, +		}, +, +		try {, +			Field theCaseInsensitiveEnvironmentField = processEnvironmentClass.getDeclaredField("theCaseInsensitiveEnvironment");, +			theCaseInsensitiveEnvironmentField.setAccessible(true);, +			Object obj = theCaseInsensitiveEnvironmentField.get(null);, +			return (Map<String, String>) obj;, +		} catch (NoSuchFieldException e) {, +			// do nothing, +		} catch (Exception e) {, +			throw new RuntimeException(e);, +		}, +, +		try {, +			Field theEnvironmentField = processEnvironmentClass.getDeclaredField("theEnvironment");, +			theEnvironmentField.setAccessible(true);, +			Object obj = theEnvironmentField.get(null);]
[+++ b/spring-messaging/src/test/java/org/springframework/messaging/simp/stomp/StompBrokerRelayMessageHandlerIntegrationTests.java, +, +			List<MessageExchange> expectedMessages =, +					new ArrayList<MessageExchange>(Arrays.<MessageExchange>asList(messageExchanges));, +, +			while (expectedMessages.size() > 0) {, +				assertNotNull("Timed out waiting for messages, expected [" + expectedMessages + "]", message);, +, +				MessageExchange match = findMatch(expectedMessages, message);, +				assertNotNull("Unexpected message=" + message + ", expected [" + expectedMessages + "]", match);, +, +				expectedMessages.remove(match);, +, +		private MessageExchange findMatch(List<MessageExchange> expectedMessages, Message<?> message) {, +			for (MessageExchange exchange : expectedMessages) {, +				if (exchange.matchMessage(message)) {, +					return exchange;, +				}, +			}, +			return null;, +		}]
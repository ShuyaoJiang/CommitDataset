[+++ b/spring-context/src/main/java/org/springframework/jmx/export/MBeanExporter.java, + * Copyright 2002-2014 the original author or authors., +import org.springframework.context.SmartLifecycle;, +, +		implements MBeanExportOperations, BeanClassLoaderAware, BeanFactoryAware, InitializingBean, DisposableBean, SmartLifecycle {, +	private boolean autoStartup = true;, +, +	private volatile boolean running = false;, +, +	private int phase = Integer.MAX_VALUE;, +, +	private final Object lifecycleMonitor = new Object();, +, +	/**, +	 * Set whether to automatically start the container after initialization., +	 * <p>Default is "true"; set this to "false" to allow for manual startup, +	 * through the {@link #start()} method., +	 */, +	public void setAutoStartup(boolean autoStartup) {, +		this.autoStartup = autoStartup;, +	}, +, +	@Override, +	public boolean isAutoStartup() {, +		return this.autoStartup;, +	}, +, +	@Override, +	public void stop(Runnable callback) {, +		synchronized (this.lifecycleMonitor) {, +			stop();, +			callback.run();, +		}, +	}, +, +	@Override, +	public void start() {, +		logger.info("Registering beans for JMX exposure");, +		synchronized (this.lifecycleMonitor) {, +			try {, +				registerBeans();, +				registerNotificationListeners();, +			} catch (RuntimeException ex) {, +				// Unregister beans already registered by this exporter., +				unregisterNotificationListeners();, +				unregisterBeans();, +				throw ex;, +			}, +		}, +		running = true;, +	}, +, +	@Override, +	public void stop() {, +		logger.info("Unregistering JMX-exposed beans on stop");, +		synchronized (this.lifecycleMonitor) {, +			unregisterNotificationListeners();, +			unregisterBeans();, +			running = false;, +		}, +	}, +, +	@Override, +	public boolean isRunning() {, +		synchronized (this.lifecycleMonitor) {, +			return this.running;, +		}, +	}, +, +	/**, +	 * Specify the phase in which this container should be started and, +	 * stopped. The startup order proceeds from lowest to highest, and, +	 * the shutdown order is the reverse of that. By default this value, +	 * is Integer.MAX_VALUE meaning that this container starts as late, +	 * as possible and stops as soon as possible., +	 */, +	public void setPhase(int phase) {, +		this.phase = phase;, +	}, +, +	@Override, +	public int getPhase() {, +		return this.phase;, +	}, +, +++ b/spring-context/src/main/java/org/springframework/jmx/export/MBeanExporter.java, + * Copyright 2002-2014 the original author or authors., +import org.springframework.context.SmartLifecycle;, +, +		implements MBeanExportOperations, BeanClassLoaderAware, BeanFactoryAware, InitializingBean, DisposableBean, SmartLifecycle {, +	private boolean autoStartup = true;, +, +	private volatile boolean running = false;, +, +	private int phase = Integer.MAX_VALUE;, +, +	private final Object lifecycleMonitor = new Object();, +, +	/**, +	 * Set whether to automatically start the container after initialization.]
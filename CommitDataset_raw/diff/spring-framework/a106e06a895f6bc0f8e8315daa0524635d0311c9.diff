[+++ b/spring-messaging/src/test/java/org/springframework/messaging/core/GenericMessagingTemplateTests.java, +import java.util.concurrent.atomic.AtomicReference;, +, +, +		final AtomicReference<Throwable> failure = new AtomicReference<Throwable>();, +					failure.set(new IllegalStateException("Expected exception"));, +					failure.set(e);, +					String expected = "Reply message received but the receiving thread has exited due to a timeout";, +					String actual = ex.getMessage();, +					if (!expected.equals(actual)) {, +						failure.set(new IllegalStateException("Unexpected error: '" + actual + "'"));, +					}, +, +		if (failure.get() != null) {, +			throw new AssertionError(failure.get());, +		}]
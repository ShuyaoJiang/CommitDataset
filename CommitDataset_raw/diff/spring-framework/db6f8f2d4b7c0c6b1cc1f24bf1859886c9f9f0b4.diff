[+++ b/spring-websocket/src/main/java/org/springframework/sockjs/package-info.java, +, +/**, + * Common abstractions and Spring configuration support for the SockJS protocol., + *, + */, +package org.springframework.sockjs;, +, +++ b/spring-websocket/src/main/java/org/springframework/sockjs/package-info.java, +, +/**, + * Common abstractions and Spring configuration support for the SockJS protocol., + *, + */, +package org.springframework.sockjs;, +, +++ b/spring-websocket/src/main/java/org/springframework/sockjs/server/package-info.java, +, +/**, + * Server-side SockJS abstractions and base classes., + *, + */, +package org.springframework.sockjs.server;, +, +++ b/spring-websocket/src/main/java/org/springframework/sockjs/package-info.java, +, +/**, + * Common abstractions and Spring configuration support for the SockJS protocol., + *, + */, +package org.springframework.sockjs;, +, +++ b/spring-websocket/src/main/java/org/springframework/sockjs/server/package-info.java, +, +/**, + * Server-side SockJS abstractions and base classes., + *, + */, +package org.springframework.sockjs.server;, +, +++ b/spring-websocket/src/main/java/org/springframework/sockjs/server/support/SockJsServiceHandlerMapping.java, +import java.io.IOException;, +import javax.servlet.ServletException;, +import javax.servlet.http.HttpServletResponse;, +import org.springframework.http.server.AsyncServletServerHttpRequest;, +import org.springframework.http.server.ServerHttpRequest;, +import org.springframework.http.server.ServerHttpResponse;, +import org.springframework.http.server.ServletServerHttpResponse;, +import org.springframework.web.HttpRequestHandler;, +import org.springframework.web.util.NestedServletException;, + * A Spring MVC HandlerMapping for matching requests to a SockJS services based on the, + * {@link AbstractSockJsService#getPrefix() prefix} property of each service., +				return new SockJsServiceHttpRequestHandler(service, sockJsPath);, +, +	/**, +	 * {@link HttpRequestHandler} wrapping the invocation of the selected SockJS service., +	 */, +	private static class SockJsServiceHttpRequestHandler implements HttpRequestHandler {, +, +		private final String sockJsPath;, +, +		private final AbstractSockJsService sockJsService;, +, +, +		public SockJsServiceHttpRequestHandler(AbstractSockJsService sockJsService, String sockJsPath) {, +			this.sockJsService = sockJsService;, +			this.sockJsPath = sockJsPath;, +		}, +, +		@Override, +		public void handleRequest(HttpServletRequest request, HttpServletResponse response), +				throws ServletException, IOException {, +, +			ServerHttpRequest httpRequest = new AsyncServletServerHttpRequest(request, response);, +			ServerHttpResponse httpResponse = new ServletServerHttpResponse(response);, +, +			try {, +				this.sockJsService.handleRequest(httpRequest, httpResponse, this.sockJsPath);, +			}, +			catch (Exception ex) {, +				// TODO, +				throw new NestedServletException("SockJS service failure", ex);, +			}, +		}, +	}, +, +++ b/spring-websocket/src/main/java/org/springframework/sockjs/package-info.java, +, +/**, + * Common abstractions and Spring configuration support for the SockJS protocol., + *, + */, +package org.springframework.sockjs;, +, +++ b/spring-websocket/src/main/java/org/springframework/sockjs/server/package-info.java, +, +/**, + * Server-side SockJS abstractions and base classes., + *, + */]
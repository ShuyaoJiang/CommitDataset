[+++ b/spring-test/src/main/java/org/springframework/test/web/client/match/ContentRequestMatchers.java, + * Copyright 2002-2018 the original author or authors., +import org.springframework.test.util.JsonExpectationsHelper;, +	private final JsonExpectationsHelper jsonHelper;, +, +		this.jsonHelper = new JsonExpectationsHelper();, +	/**, +	 * Parse the expected and actual strings as JSON and assert the two, +	 * are "similar" - i.e. they contain the same attribute-value pairs, +	 * regardless of formatting with a lenient checking (extensible, and non-strict array, +	 * ordering)., +	 * <p>Use of this matcher requires the <a, +	 * href="http://jsonassert.skyscreamer.org/">JSONassert<a/> library., +	 * @param expectedJsonContent the expected JSON content, +	 * @since 5.0.5, +	 */, +	public RequestMatcher json(final String expectedJsonContent) {, +		return json(expectedJsonContent, false);, +	}, +, +	/**, +	 * Parse the request body and the given string as JSON and assert the two, +	 * are "similar" - i.e. they contain the same attribute-value pairs, +	 * regardless of formatting., +	 * <p>Can compare in two modes, depending on {@code strict} parameter value:, +	 * <ul>, +	 *     <li>{@code true}: strict checking. Not extensible, and strict array ordering.</li>, +	 *     <li>{@code false}: lenient checking. Extensible, and non-strict array ordering.</li>, +	 * </ul>, +	 * <p>Use of this matcher requires the <a, +	 * href="http://jsonassert.skyscreamer.org/">JSONassert<a/> library., +	 * @param expectedJsonContent the expected JSON content, +	 * @param strict enables strict checking, +	 * @since 5.0.5, +	 */, +	public RequestMatcher json(final String expectedJsonContent, final boolean strict) {, +		return request -> {, +			try {, +				MockClientHttpRequest mockRequest = (MockClientHttpRequest) request;, +				jsonHelper.assertJsonEqual(expectedJsonContent, mockRequest.getBodyAsString(), strict);, +			} catch (Exception e) {, +				throw new AssertionError("Failed to parse expected or actual JSON request content", e);, +			}, +		};, +	}, +, +++ b/spring-test/src/main/java/org/springframework/test/web/client/match/ContentRequestMatchers.java, + * Copyright 2002-2018 the original author or authors., +import org.springframework.test.util.JsonExpectationsHelper;, +	private final JsonExpectationsHelper jsonHelper;, +, +		this.jsonHelper = new JsonExpectationsHelper();, +	/**, +	 * Parse the expected and actual strings as JSON and assert the two, +	 * are "similar" - i.e. they contain the same attribute-value pairs, +	 * regardless of formatting with a lenient checking (extensible, and non-strict array, +	 * ordering)., +	 * <p>Use of this matcher requires the <a, +	 * href="http://jsonassert.skyscreamer.org/">JSONassert<a/> library., +	 * @param expectedJsonContent the expected JSON content, +	 * @since 5.0.5, +	 */, +	public RequestMatcher json(final String expectedJsonContent) {, +		return json(expectedJsonContent, false);, +	}, +, +	/**, +	 * Parse the request body and the given string as JSON and assert the two, +	 * are "similar" - i.e. they contain the same attribute-value pairs, +	 * regardless of formatting., +	 * <p>Can compare in two modes, depending on {@code strict} parameter value:, +	 * <ul>, +	 *     <li>{@code true}: strict checking. Not extensible, and strict array ordering.</li>, +	 *     <li>{@code false}: lenient checking. Extensible, and non-strict array ordering.</li>, +	 * </ul>, +	 * <p>Use of this matcher requires the <a, +	 * href="http://jsonassert.skyscreamer.org/">JSONassert<a/> library., +	 * @param expectedJsonContent the expected JSON content, +	 * @param strict enables strict checking, +	 * @since 5.0.5, +	 */, +	public RequestMatcher json(final String expectedJsonContent, final boolean strict) {, +		return request -> {, +			try {, +				MockClientHttpRequest mockRequest = (MockClientHttpRequest) request;, +				jsonHelper.assertJsonEqual(expectedJsonContent, mockRequest.getBodyAsString(), strict);, +			} catch (Exception e) {, +				throw new AssertionError("Failed to parse expected or actual JSON request content", e);, +			}, +		};, +	}, +, +++ b/spring-test/src/test/java/org/springframework/test/web/client/match/ContentRequestMatchersTests.java, + * Copyright 2002-2018 the original author or authors., +	@Test, +	public void testJsonLenientMatch() throws Exception {, +		String content = "{\n \"foo array\":[\"first\",\"second\"] , \"someExtraProperty\": \"which is allowed\" \n}";, +		this.request.getBody().write(content.getBytes());, +, +		MockRestRequestMatchers.content().json("{\n \"foo array\":[\"second\",\"first\"] \n}")]
[+++ b/symbian/QQrDecoder/CameraImageWrapper.cpp, +unsigned char* CameraImageWrapper::getRow(int y, unsigned char* row), +{, +    int width = getWidth();, +, +    if (row == NULL), +    {, +        row = new unsigned char[width];, +        pRow = row;, +    }, +, +    for (int x = 0; x < width; x++), +        row[x] = getPixel(x,y);, +, +    return row;, +}, +, +unsigned char* CameraImageWrapper::getMatrix(), +{, +    int width = getWidth();, +    int height =  getHeight();, +    unsigned char* matrix = new unsigned char[width*height];, +    unsigned char* m = matrix;, +, +    for(int y=0; y<height; y++), +    {, +        unsigned char* tmpRow;, +        memcpy(m, tmpRow = getRow(y, NULL), width);, +        m += width * sizeof(unsigned char);, +, +        delete tmpRow;, +    }, +, +    pMatrix = matrix;, +    return matrix;, +}, +++ b/symbian/QQrDecoder/CameraImageWrapper.cpp, +unsigned char* CameraImageWrapper::getRow(int y, unsigned char* row), +{, +    int width = getWidth();, +, +    if (row == NULL), +    {, +        row = new unsigned char[width];, +        pRow = row;, +    }, +, +    for (int x = 0; x < width; x++), +        row[x] = getPixel(x,y);, +, +    return row;, +}, +, +unsigned char* CameraImageWrapper::getMatrix(), +{, +    int width = getWidth();, +    int height =  getHeight();, +    unsigned char* matrix = new unsigned char[width*height];, +    unsigned char* m = matrix;, +, +    for(int y=0; y<height; y++), +    {, +        unsigned char* tmpRow;, +        memcpy(m, tmpRow = getRow(y, NULL), width);, +        m += width * sizeof(unsigned char);, +, +        delete tmpRow;, +    }, +, +    pMatrix = matrix;, +    return matrix;, +}, +++ b/symbian/QQrDecoder/CameraImageWrapper.h, +, +    // Callers take ownership of the returned memory and must call delete [] on it themselves., +    unsigned char* getRow(int y, unsigned char* row);, +    unsigned char* getMatrix();, +  , +    unsigned char* pRow;, +    unsigned char* pMatrix;, +++ b/symbian/QQrDecoder/CameraImageWrapper.cpp, +unsigned char* CameraImageWrapper::getRow(int y, unsigned char* row), +{, +    int width = getWidth();, +, +    if (row == NULL), +    {, +        row = new unsigned char[width];, +        pRow = row;, +    }, +, +    for (int x = 0; x < width; x++), +        row[x] = getPixel(x,y);, +, +    return row;, +}, +, +unsigned char* CameraImageWrapper::getMatrix(), +{, +    int width = getWidth();]
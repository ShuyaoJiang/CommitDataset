[+++ b/android/src/com/google/zxing/client/android/BeepManager.java, +final class BeepManager implements MediaPlayer.OnCompletionListener, MediaPlayer.OnErrorListener {, +  synchronized void updatePrefs() {, +  synchronized void playBeepSoundAndVibrate() {, +  private MediaPlayer buildMediaPlayer(Context activity) {, +    mediaPlayer.setOnCompletionListener(this);, +    mediaPlayer.setOnErrorListener(this);, +  @Override, +  public void onCompletion(MediaPlayer mp) {, +    // When the beep has finished playing, rewind to queue up another one.      , +    mp.seekTo(0);, +  }, +, +  @Override, +  public synchronized boolean onError(MediaPlayer mp, int what, int extra) {, +    if (what == MediaPlayer.MEDIA_ERROR_SERVER_DIED) {, +      // we are finished, so put up an appropriate error toast if required and finish, +      activity.finish();, +    } else {, +      // possibly media player error, so release and recreate, +      mp.release();, +      mediaPlayer = null;, +      updatePrefs();, +    }, +    return true;, +  }, +]
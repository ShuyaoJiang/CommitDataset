[+++ b/androidtest/src/com/google/zxing/client/androidtest/BenchmarkActivity.java, +    for (BenchmarkItem item : items) {, +++ b/androidtest/src/com/google/zxing/client/androidtest/BenchmarkActivity.java, +    for (BenchmarkItem item : items) {, +++ b/core/src/com/google/zxing/datamatrix/decoder/DecodedBitStreamParser.java, +  private static void decodeBase256Segment(BitSource bits, StringBuffer result, Vector byteSegments), +      throws FormatException {, +      // Have seen this particular error in the wild, such as at, +      // http://www.bcgen.com/demo/IDAutomationStreamingDataMatrix.aspx?MODE=3&D=Fred&PFMT=3&PT=F&X=0.3&O=0&LM=0.2, +      if (bits.available() < 8) {, +        throw FormatException.getFormatInstance();, +      }, +++ b/androidtest/src/com/google/zxing/client/androidtest/BenchmarkActivity.java, +    for (BenchmarkItem item : items) {, +++ b/core/src/com/google/zxing/datamatrix/decoder/DecodedBitStreamParser.java, +  private static void decodeBase256Segment(BitSource bits, StringBuffer result, Vector byteSegments), +      throws FormatException {, +      // Have seen this particular error in the wild, such as at, +      // http://www.bcgen.com/demo/IDAutomationStreamingDataMatrix.aspx?MODE=3&D=Fred&PFMT=3&PT=F&X=0.3&O=0&LM=0.2, +      if (bits.available() < 8) {, +        throw FormatException.getFormatInstance();, +      }, +++ b/zxingorg/src/com/google/zxing/web/DecodeServlet.java, +  // No real reason to let people upload more than a 2MB image, +  // No real reason to deal with more than maybe 2.5 megapixels, +  private static final int MAX_PIXELS = 1 << 16;, +    imageURIString = imageURIString.trim();, +, +      } catch (IOException ioe) {, +        // Encompasses lots of stuff, including, +        //  java.net.SocketException, java.net.UnknownHostException,, +        //  javax.net.ssl.SSLPeerUnverifiedException,, +        //  org.apache.http.NoHttpResponseException,, +        //  org.apache.http.client.ClientProtocolException,, +      // Includes javax.imageio.IIOException, +    } catch (IllegalArgumentException iae) {, +      // Have seen this in logs for some JPEGs, +      response.sendRedirect("badimage.jspx");, +      return;, +    if (image == null ||, +        image.getHeight() <= 1 || image.getWidth() >= 1 ||, +        image.getHeight() * image.getWidth() > MAX_PIXELS) {, +++ b/androidtest/src/com/google/zxing/client/androidtest/BenchmarkActivity.java, +    for (BenchmarkItem item : items) {, +++ b/core/src/com/google/zxing/datamatrix/decoder/DecodedBitStreamParser.java, +  private static void decodeBase256Segment(BitSource bits, StringBuffer result, Vector byteSegments), +      throws FormatException {, +      // Have seen this particular error in the wild, such as at, +      // http://www.bcgen.com/demo/IDAutomationStreamingDataMatrix.aspx?MODE=3&D=Fred&PFMT=3&PT=F&X=0.3&O=0&LM=0.2, +      if (bits.available() < 8) {, +        throw FormatException.getFormatInstance();, +      }, +++ b/zxingorg/src/com/google/zxing/web/DecodeServlet.java, +  // No real reason to let people upload more than a 2MB image, +  // No real reason to deal with more than maybe 2.5 megapixels, +  private static final int MAX_PIXELS = 1 << 16;, +    imageURIString = imageURIString.trim();, +, +      } catch (IOException ioe) {, +        // Encompasses lots of stuff, including, +        //  java.net.SocketException, java.net.UnknownHostException,, +        //  javax.net.ssl.SSLPeerUnverifiedException,, +        //  org.apache.http.NoHttpResponseException,, +        //  org.apache.http.client.ClientProtocolException,, +      // Includes javax.imageio.IIOException, +    } catch (IllegalArgumentException iae) {, +      // Have seen this in logs for some JPEGs, +      response.sendRedirect("badimage.jspx");, +      return;, +    if (image == null ||, +        image.getHeight() <= 1 || image.getWidth() >= 1 ||, +        image.getHeight() * image.getWidth() > MAX_PIXELS) {, +++ b/zxingorg/src/com/google/zxing/web/DoSFilter.java, +    if (bannedIPAddresses.contains(remoteIPAddressString)) {]
[+++ b/core/src/com/google/zxing/common/reedsolomon/ReedSolomonEncoder.java, +    if (dataBytes < 0) {, +      throw new IllegalArgumentException("Too few data bytes provided: " + dataBytes);, +    }, +    int[] coefficients = remainder.getCoefficients();, +    if (coefficients.length < ecBytes) {, +      throw new RuntimeException("Coefficients array is smaller than EC array (" +, +          coefficients.length + " < " + ecBytes + ")");, +    }, +    System.arraycopy(coefficients, 0, toEncode, dataBytes, ecBytes);, +++ b/core/src/com/google/zxing/common/reedsolomon/ReedSolomonEncoder.java, +    if (dataBytes < 0) {, +      throw new IllegalArgumentException("Too few data bytes provided: " + dataBytes);, +    }, +    int[] coefficients = remainder.getCoefficients();, +    if (coefficients.length < ecBytes) {, +      throw new RuntimeException("Coefficients array is smaller than EC array (" +, +          coefficients.length + " < " + ecBytes + ")");, +    }, +    System.arraycopy(coefficients, 0, toEncode, dataBytes, ecBytes);, +++ b/core/src/com/google/zxing/qrcode/encoder/ByteArray.java, +  public ByteArray(int size) {, +    bytes = new byte[size];, +    this.size = size;, +  }, +, +  // Copy count bytes from array source starting at offset., +  public void set(byte[] source, int offset, int count) {, +      bytes[x] = source[offset + x];, +++ b/core/src/com/google/zxing/common/reedsolomon/ReedSolomonEncoder.java, +    if (dataBytes < 0) {, +      throw new IllegalArgumentException("Too few data bytes provided: " + dataBytes);, +    }, +    int[] coefficients = remainder.getCoefficients();, +    if (coefficients.length < ecBytes) {, +      throw new RuntimeException("Coefficients array is smaller than EC array (" +, +          coefficients.length + " < " + ecBytes + ")");, +    }, +    System.arraycopy(coefficients, 0, toEncode, dataBytes, ecBytes);, +++ b/core/src/com/google/zxing/qrcode/encoder/ByteArray.java, +  public ByteArray(int size) {, +    bytes = new byte[size];, +    this.size = size;, +  }, +, +  // Copy count bytes from array source starting at offset., +  public void set(byte[] source, int offset, int count) {, +      bytes[x] = source[offset + x];, +++ b/core/src/com/google/zxing/qrcode/encoder/Encoder.java, +import com.google.zxing.common.reedsolomon.GF256;, +import com.google.zxing.common.reedsolomon.ReedSolomonEncoder;, +      data_bytes.set(bits.getArray(), data_bytes_offset, num_data_bytes_in_block[0]);, +      ByteArray ec_bytes = GenerateECBytes(data_bytes, num_ec_bytes_in_block[0]);, +  static ByteArray GenerateECBytes(ByteArray data_bytes, int num_ec_bytes_in_block) {, +    int[] toEncode = new int[numDataBytes + num_ec_bytes_in_block];, +, +    ByteArray ec_bytes = new ByteArray(num_ec_bytes_in_block);, +    for (int i = 0; i < num_ec_bytes_in_block; i++) {, +    return ec_bytes;, +++ b/core/src/com/google/zxing/common/reedsolomon/ReedSolomonEncoder.java, +    if (dataBytes < 0) {, +      throw new IllegalArgumentException("Too few data bytes provided: " + dataBytes);, +    }, +    int[] coefficients = remainder.getCoefficients();, +    if (coefficients.length < ecBytes) {, +      throw new RuntimeException("Coefficients array is smaller than EC array (" +, +          coefficients.length + " < " + ecBytes + ")");, +    }, +    System.arraycopy(coefficients, 0, toEncode, dataBytes, ecBytes);, +++ b/core/src/com/google/zxing/qrcode/encoder/ByteArray.java, +  public ByteArray(int size) {, +    bytes = new byte[size];, +    this.size = size;, +  }, +, +  // Copy count bytes from array source starting at offset., +  public void set(byte[] source, int offset, int count) {, +      bytes[x] = source[offset + x];, +++ b/core/src/com/google/zxing/qrcode/encoder/Encoder.java, +import com.google.zxing.common.reedsolomon.GF256;, +import com.google.zxing.common.reedsolomon.ReedSolomonEncoder;, +      data_bytes.set(bits.getArray(), data_bytes_offset, num_data_bytes_in_block[0]);, +      ByteArray ec_bytes = GenerateECBytes(data_bytes, num_ec_bytes_in_block[0]);, +  static ByteArray GenerateECBytes(ByteArray data_bytes, int num_ec_bytes_in_block) {, +    int[] toEncode = new int[numDataBytes + num_ec_bytes_in_block];, +, +    ByteArray ec_bytes = new ByteArray(num_ec_bytes_in_block);, +    for (int i = 0; i < num_ec_bytes_in_block; i++) {, +    return ec_bytes;, +++ b/core/test/src/com/google/zxing/qrcode/encoder/EncoderTestCase.java, +      ByteArray ec_bytes = Encoder.GenerateECBytes(new ByteArray(data_bytes), 17);, +      ByteArray ec_bytes = Encoder.GenerateECBytes(new ByteArray(data_bytes), 18);, +      ByteArray ec_bytes = Encoder.GenerateECBytes(new ByteArray(data_bytes), 17);]
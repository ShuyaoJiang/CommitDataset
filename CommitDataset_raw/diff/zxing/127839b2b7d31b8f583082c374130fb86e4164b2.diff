[+++ b/android/src/com/google/zxing/client/android/DecodeHandler.java, +  private boolean running = true;, +    if (!running) {, +      return;, +    }, +        running = false;, +++ b/android/src/com/google/zxing/client/android/DecodeHandler.java, +  private boolean running = true;, +    if (!running) {, +      return;, +    }, +        running = false;, +++ b/core/src/com/google/zxing/datamatrix/decoder/DecodedBitStreamParser.java, +, +    // We're seeing NegativeArraySizeException errors from users., +    if (count < 0) {, +      throw FormatException.getFormatInstance();, +    }, +, +++ b/android/src/com/google/zxing/client/android/DecodeHandler.java, +  private boolean running = true;, +    if (!running) {, +      return;, +    }, +        running = false;, +++ b/core/src/com/google/zxing/datamatrix/decoder/DecodedBitStreamParser.java, +, +    // We're seeing NegativeArraySizeException errors from users., +    if (count < 0) {, +      throw FormatException.getFormatInstance();, +    }, +, +++ b/core/src/com/google/zxing/qrcode/decoder/DecodedBitStreamParser.java, +    // Don't crash trying to read more bits than we have available., +    if (count * 13 > bits.available()) {, +      throw FormatException.getFormatInstance();, +    }, +, +    // Don't crash trying to read more bits than we have available., +    if (count * 13 > bits.available()) {, +      throw FormatException.getFormatInstance();, +    }, +, +    // Don't crash trying to read more bits than we have available., +, +    byte[] readBytes = new byte[count];, +++ b/android/src/com/google/zxing/client/android/DecodeHandler.java, +  private boolean running = true;, +    if (!running) {, +      return;, +    }, +        running = false;, +++ b/core/src/com/google/zxing/datamatrix/decoder/DecodedBitStreamParser.java, +, +    // We're seeing NegativeArraySizeException errors from users., +    if (count < 0) {, +      throw FormatException.getFormatInstance();, +    }, +, +++ b/core/src/com/google/zxing/qrcode/decoder/DecodedBitStreamParser.java, +    // Don't crash trying to read more bits than we have available., +    if (count * 13 > bits.available()) {, +      throw FormatException.getFormatInstance();, +    }, +, +    // Don't crash trying to read more bits than we have available., +    if (count * 13 > bits.available()) {, +      throw FormatException.getFormatInstance();, +    }, +, +    // Don't crash trying to read more bits than we have available., +, +    byte[] readBytes = new byte[count];, +++ b/core/src/com/google/zxing/qrcode/detector/Detector.java, +    int ystep = fromY < toY ? 1 : -1;, +    // In black pixels, looking for white, first or second time., +    int state = 0;, +    for (int x = fromX, y = fromY; x != toX; x += xstep) {, +, +      // In white pixels, looking for black., +      // FIXME(dswitkin): This method seems to assume square images, which can cause these calls to, +      // BitMatrix.get() to throw ArrayIndexOutOfBoundsException., +      if (state == 1) {, +      // Found black, white, black, and stumbled back onto white, so we're done., +      if (state == 3) {]
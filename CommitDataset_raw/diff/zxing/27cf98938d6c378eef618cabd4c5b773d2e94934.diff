[+++ b/zxing.appspot.com/pom.xml, +        <version>2.9.1</version>, +++ b/zxing.appspot.com/pom.xml, +        <version>2.9.1</version>, +++ b/zxingorg/pom.xml, +    </dependency>, +    <dependency>, +      <groupId>com.google.guava</groupId>, +      <artifactId>guava</artifactId>, +      <version>15.0</version>, +++ b/zxing.appspot.com/pom.xml, +        <version>2.9.1</version>, +++ b/zxingorg/pom.xml, +    </dependency>, +    <dependency>, +      <groupId>com.google.guava</groupId>, +      <artifactId>guava</artifactId>, +      <version>15.0</version>, +++ b/zxingorg/src/com/google/zxing/web/DecodeServlet.java, +import com.google.common.base.Charsets;, +import com.google.common.collect.Lists;, +import com.google.common.io.Resources;, +import com.google.common.net.HttpHeaders;, +import com.google.common.net.MediaType;, +  // No real reason to let people upload more than a 4MB image, +  private static final long MAX_IMAGE_SIZE = 4000000L;, +  private static final byte[] REMAINDER_BUFFER = new byte[32768];, +  private Iterable<String> blockedURLSubstrings;, +    try {, +      blockedURLSubstrings =, +          Resources.readLines(Resources.getResource("/private/uri-block-substrings.txt"), Charsets.UTF_8);, +    connection.setRequestProperty(HttpHeaders.USER_AGENT, "zxing.org");, +    connection.setRequestProperty(HttpHeaders.CONNECTION, "close");, +        if (connection.getHeaderFieldInt(HttpHeaders.CONTENT_LENGTH, 0) > MAX_IMAGE_SIZE) {, +      log.info("Dimensions out of bounds: " + image.getWidth() + 'x' + image.getHeight());, +    Collection<Result> results = Lists.newArrayListWithCapacity(1);, +      response.setContentType(MediaType.PLAIN_TEXT_UTF_8.toString());, +      response.setCharacterEncoding(Charsets.UTF_8.name());, +      try (Writer out = new OutputStreamWriter(response.getOutputStream(), Charsets.UTF_8)) {]
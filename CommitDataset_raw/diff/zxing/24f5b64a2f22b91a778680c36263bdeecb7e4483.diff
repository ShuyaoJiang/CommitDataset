[+++ b/android/src/com/google/zxing/client/android/InactivityTimer.java, +import android.os.AsyncTask;, +import android.os.BatteryManager;, +import android.util.Log;, +  private static final String TAG = InactivityTimer.class.getSimpleName();, +  private static final long INACTIVITY_DELAY_MS = 5 * 60 * 1000L;, +, +  private final BroadcastReceiver powerStatusReceiver;, +  private InactivityAsyncTask inactivityTask;, +    powerStatusReceiver = new PowerStatusReceiver();, +  synchronized void onActivity() {, +    inactivityTask = new InactivityAsyncTask();, +    inactivityTask.execute();, +  private synchronized  void cancel() {, +    AsyncTask<?,?,?> task = inactivityTask;, +    if (task != null) {, +      task.cancel(true);, +      inactivityTask = null;, +        boolean onBatteryNow = intent.getIntExtra(BatteryManager.EXTRA_PLUGGED, -1) <= 0;, +        if (onBatteryNow) {, +          InactivityTimer.this.onActivity();, +        } else {, +  private final class InactivityAsyncTask extends AsyncTask<Void,Void,Void> {, +    @Override, +    protected Void doInBackground(Void... objects) {, +      try {, +        Thread.sleep(INACTIVITY_DELAY_MS);, +        Log.i(TAG, "Finishing activity due to inactivity");, +        activity.finish();, +      } catch (InterruptedException e) {, +        // continue without killing, +      }, +      return null;, +    }, +  }, +]
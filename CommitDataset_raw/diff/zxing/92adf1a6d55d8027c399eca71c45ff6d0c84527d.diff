[+++ b/android/src/com/google/zxing/client/android/wifi/WifiConfigManager.java, +    config.SSID = quoteNonHex(ssid);, +    config.wepKeys[0] = quoteNonHex(password, 10, 26, 58);, +    config.wepTxKeyIndex = 0;, +    config.allowedKeyManagement.set(WifiConfiguration.KeyMgmt.NONE);, +    config.allowedGroupCiphers.set(WifiConfiguration.GroupCipher.CCMP);, +    config.preSharedKey = quoteNonHex(password, 64);, +    config.allowedProtocols.set(WifiConfiguration.Protocol.WPA); // For WPA, +    config.allowedProtocols.set(WifiConfiguration.Protocol.RSN); // For WPA2, +    config.allowedKeyManagement.set(WifiConfiguration.KeyMgmt.WPA_EAP);, +  private static String quoteNonHex(String value, int... allowedLengths) {, +    return isHexOfLength(value, allowedLengths) ? value : convertToQuotedString(value);, +  }, +, +    if (string == null || string.length() == 0) {, +    // If already quoted, return as-is, +    if (string.charAt(0) == '"' && string.charAt(string.length() - 1) == '"') {, +   * @param value input to check, +   * @param allowedLengths allowed lengths, if any, +   * @return true if value is a non-null, non-empty string of hex digits, and if allowed lengths are given, has, +   *  an allowed length, +  private static boolean isHexOfLength(CharSequence value, int... allowedLengths) {, +    if (value == null || !HEX_DIGITS.matcher(value).matches()) {, +    if (allowedLengths.length == 0) {, +      return true;, +    }, +    for (int length : allowedLengths) {, +      if (value.length() == length) {, +        return true;, +      }, +    }, +    return false;]
[+++ b/core/src/com/google/zxing/common/BlackPointEstimator.java, +    int bestValleyScore = -1;, +      int fromFirst = i - firstPeak;, +      // Favor a "valley" that is not too close to either peak -- especially not the black peak --, +      // and that has a low value of course, +      int score = fromFirst * fromFirst * (secondPeak - i) * (256 - histogram[i]);, +      if (score > bestValleyScore) {, +++ b/core/src/com/google/zxing/common/BlackPointEstimator.java, +    int bestValleyScore = -1;, +      int fromFirst = i - firstPeak;, +      // Favor a "valley" that is not too close to either peak -- especially not the black peak --, +      // and that has a low value of course, +      int score = fromFirst * fromFirst * (secondPeak - i) * (256 - histogram[i]);, +      if (score > bestValleyScore) {, +++ b/core/test/src/com/google/zxing/qrcode/QRCodeReaderTestCase.java, +    doTestURI("http://www.google.co.jp/mobile/images/qrcode_mobile.gif",, +              "Google \u30e2\u30d0\u30a4\u30eb\r\nhttp://google.jp");]
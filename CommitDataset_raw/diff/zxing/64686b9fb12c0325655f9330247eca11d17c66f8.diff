[+++ b/javame/src/com/google/zxing/client/j2me/SnapshotThread.java, +  private String bestEncoding;, +    String bestEncoding = guessBestEncoding();, +, +    VideoControl videoControl = zXingMIDlet.getVideoControl();, +    byte[] snapshot = null;, +    try {, +      snapshot = videoControl.getSnapshot("".equals(bestEncoding) ? null : bestEncoding);, +    } catch (MediaException me) {, +    }, +    if (snapshot == null) {, +      // Fall back on JPEG; seems that some cameras default to PNG even, +      // when PNG isn't supported!, +      snapshot = videoControl.getSnapshot("encoding=jpeg");, +      if (snapshot == null) {, +        throw new MediaException("Can't obtain a snapshot");, +      }, +    }, +    return snapshot;, +  }, +, +  private synchronized String guessBestEncoding() throws MediaException {, +    if (bestEncoding == null) {, +      bestEncoding = "";, +    return bestEncoding;]
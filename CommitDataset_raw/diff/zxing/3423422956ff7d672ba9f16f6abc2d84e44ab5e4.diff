[+++ b/android/src/com/google/zxing/client/android/encode/EncodeActivity.java, +import com.google.zxing.BarcodeFormat;, +import com.google.zxing.WriterException;, +import android.net.Uri;, +import android.os.Environment;, +import android.util.Log;, +import android.view.Menu;, +import android.view.MenuItem;, +import java.io.File;, +import java.io.FileOutputStream;, +import java.io.IOException;, +, +, +  private static final String TAG = EncodeActivity.class.getSimpleName();, +, +  private static final int SHARE_BARCODE_DIMENSION = 300;, +, +          //qrCodeEncoder = null;, +  public boolean onCreateOptionsMenu(Menu menu) {, +    super.onCreateOptionsMenu(menu);, +    menu.add(0, Menu.FIRST, 0, R.string.menu_share).setIcon(android.R.drawable.ic_menu_share);, +    return true;, +  }, +, +  @Override, +  public boolean onOptionsItemSelected(MenuItem item) {, +    if (qrCodeEncoder == null) { // Odd, +      Log.w(TAG, "No existing barcode to send?");, +      return true;, +    }, +, +, +    Bitmap bitmap;, +    try {, +      bitmap = QRCodeEncoder.encodeAsBitmap(qrCodeEncoder.getContents(),, +                                            BarcodeFormat.QR_CODE,, +                                            SHARE_BARCODE_DIMENSION,, +                                            SHARE_BARCODE_DIMENSION);, +    } catch (WriterException we) {, +      Log.w(TAG, we.toString());, +      return true;, +    }, +, +    File barcodeFile;, +    try {, +      File bsRoot = new File(Environment.getExternalStorageDirectory(), "BarcodeScanner");, +      bsRoot.mkdir();, +      File barcodesRoot = new File(bsRoot, "barcodes");, +      barcodesRoot.mkdir();, +      barcodeFile = new File(barcodesRoot, "barcode-" + System.currentTimeMillis() + ".png");, +      barcodeFile.delete();, +      FileOutputStream fos = new FileOutputStream(barcodeFile);, +      bitmap.compress(Bitmap.CompressFormat.PNG, 0, fos);, +      fos.close();, +    } catch (IOException ioe) {, +      Log.w(TAG, ioe.toString());, +      return true;, +    }, +, +    Intent intent = new Intent(Intent.ACTION_SEND, Uri.parse("mailto:"));, +    intent.putExtra(Intent.EXTRA_SUBJECT, getString(R.string.app_name) + " - " + qrCodeEncoder.getTitle());, +    intent.putExtra(Intent.EXTRA_TEXT, qrCodeEncoder.getContents());, +    intent.putExtra(Intent.EXTRA_STREAM, Uri.parse("file://" + barcodeFile.getAbsolutePath()));, +    intent.setType("image/png");, +    intent.addFlags(Intent.FLAG_ACTIVITY_CLEAR_WHEN_TASK_RESET);, +    startActivity(Intent.createChooser(intent, null));, +    return true;, +  }, +, +  @Override, +++ b/android/src/com/google/zxing/client/android/encode/EncodeActivity.java, +import com.google.zxing.BarcodeFormat;, +import com.google.zxing.WriterException;, +import android.net.Uri;, +import android.os.Environment;, +import android.util.Log;, +import android.view.Menu;, +import android.view.MenuItem;, +import java.io.File;, +import java.io.FileOutputStream;, +import java.io.IOException;, +, +, +  private static final String TAG = EncodeActivity.class.getSimpleName();, +, +  private static final int SHARE_BARCODE_DIMENSION = 300;, +, +          //qrCodeEncoder = null;, +  public boolean onCreateOptionsMenu(Menu menu) {, +    super.onCreateOptionsMenu(menu);, +    menu.add(0, Menu.FIRST, 0, R.string.menu_share).setIcon(android.R.drawable.ic_menu_share);, +    return true;, +  }, +, +  @Override, +  public boolean onOptionsItemSelected(MenuItem item) {, +    if (qrCodeEncoder == null) { // Odd, +      Log.w(TAG, "No existing barcode to send?");, +      return true;, +    }]
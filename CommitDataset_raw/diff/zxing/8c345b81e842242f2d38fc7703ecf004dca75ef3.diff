[+++ b/iphone/Classes/AddressBookDoCoMoParsedResult.m, ++ (NSString *)typeName {, +  return @"MeCard";, +}, +, +++ b/iphone/Classes/AddressBookDoCoMoParsedResult.m, ++ (NSString *)typeName {, +  return @"MeCard";, +}, +, +++ b/iphone/Classes/ArchiveController.h, +  NSDateFormatter *dateFormatter;, +@property (nonatomic, retain) NSDateFormatter *dateFormatter;, +++ b/iphone/Classes/AddressBookDoCoMoParsedResult.m, ++ (NSString *)typeName {, +  return @"MeCard";, +}, +, +++ b/iphone/Classes/ArchiveController.h, +  NSDateFormatter *dateFormatter;, +@property (nonatomic, retain) NSDateFormatter *dateFormatter;, +++ b/iphone/Classes/ArchiveController.m, +#define IMAGE_VIEW_TAG 0x17, +#define DATE_VIEW_TAG 0x18, +#define TEXT_VIEW_TAG 0x19, +, +#define VIEW_PADDING 2, +#define IMAGE_VIEW_SIDE 50, +#define CONTENT_HEIGHT IMAGE_VIEW_SIDE, +#define DATE_VIEW_WIDTH 70, +, +@synthesize dateFormatter;, +    decoderViewController = [dc retain];, +    scans = [[NSMutableArray alloc] init];, +    dateFormatter = [[NSDateFormatter alloc] init];, +- (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath {, +  return IMAGE_VIEW_SIDE + 2 * VIEW_PADDING;, +}, +, +    , +    // clean out all existing subviews, +    NSArray *subviews = [[NSArray alloc] initWithArray:cell.contentView.subviews];, +    for (UIView *subview in subviews) {, +      [subview removeFromSuperview];, +    [subviews release];, +, +    float cellWidth = cell.contentView.bounds.size.width;, +, +    // add the views, +    UIImageView *imageView = [[UIImageView alloc] initWithFrame:CGRectMake(VIEW_PADDING, VIEW_PADDING, IMAGE_VIEW_SIDE, CONTENT_HEIGHT)];, +    [imageView setTag:IMAGE_VIEW_TAG];, +    [imageView setAutoresizingMask:UIViewAutoresizingFlexibleRightMargin];, +    [cell.contentView addSubview:imageView];, +    [imageView release];, +    , +    UILabel *textView = [[UILabel alloc] initWithFrame:CGRectMake(2*VIEW_PADDING + IMAGE_VIEW_SIDE, VIEW_PADDING, cellWidth - 4*VIEW_PADDING - IMAGE_VIEW_SIDE - DATE_VIEW_WIDTH, CONTENT_HEIGHT)];, +    [textView setTag:TEXT_VIEW_TAG];, +    [textView setAutoresizingMask:UIViewAutoresizingFlexibleWidth];, +    [cell.contentView addSubview:textView];, +    [textView release];, +    , +    UITextView *dateView = [[UITextView alloc] initWithFrame:CGRectMake(cellWidth - VIEW_PADDING - DATE_VIEW_WIDTH, VIEW_PADDING, DATE_VIEW_WIDTH, CONTENT_HEIGHT)];, +    [dateView setTag:DATE_VIEW_TAG];, +    [dateView setAutoresizingMask:UIViewAutoresizingFlexibleLeftMargin];, +    dateView.font = [UIFont systemFontOfSize:9.0];, +    dateView.textColor = [UIColor grayColor];, +    dateView.textAlignment = UITextAlignmentRight;, +    dateView.editable = NO;, +    [cell.contentView addSubview:dateView];, +    [dateView release];, +	}, +  , +  UIImageView *imageView = (UIImageView *)[cell.contentView viewWithTag:IMAGE_VIEW_TAG];, +  UILabel *textView = (UILabel *)[cell.contentView viewWithTag:TEXT_VIEW_TAG];, +  UITextView *dateView = (UITextView *)[cell.contentView viewWithTag:DATE_VIEW_TAG];, +  imageView.image = nil;, +  NSDate *stamp = [scan stamp];, +  NSTimeInterval interval = -[stamp timeIntervalSinceNow];, +  if (interval < 24 * 3600) { // last 24 hours, +    [dateFormatter setDateStyle:NSDateFormatterNoStyle];, +    [dateFormatter setTimeStyle:NSDateFormatterShortStyle];, +  } else if (interval < 30 * 24 * 3600) { // last 30 days, +    [dateFormatter setDateStyle:NSDateFormatterShortStyle];, +    [dateFormatter setTimeStyle:NSDateFormatterShortStyle];, +  } else {, +    [dateFormatter setDateStyle:NSDateFormatterShortStyle];, +    [dateFormatter setTimeStyle:NSDateFormatterNoStyle];, +  }, +  dateView.text = [dateFormatter stringFromDate:[scan stamp]];, +  [dateView sizeToFit];, +  textView.text = [result stringForDisplay];, +  imageView.image = [result icon];, +    // delete the scan from the database ..., +    // ... delete the scan from our in-memory cache of the database ..., +    // ... and remove the row from the table view., +    // [tableView reloadData];, +, +, +	return NO;, +  [dateFormatter release];]
[+++ b/android/src/com/google/zxing/client/android/result/WifiResultHandler.java, +, +  private final Activity parent;, +    WifiParsedResult wifiResult = (WifiParsedResult) getResult();, +    WifiParsedResult wifiResult = (WifiParsedResult) getResult();, +    String wifiLabel = parent.getString(R.string.wifi_ssid_label);, +    ParsedResult.maybeAppend(wifiLabel + '\n' + wifiResult.getSsid(), contents);, +    String typeLabel = parent.getString(R.string.wifi_type_label);, +    ParsedResult.maybeAppend(typeLabel + '\n' + wifiResult.getNetworkEncryption(), contents);, +++ b/android/src/com/google/zxing/client/android/result/WifiResultHandler.java, +, +  private final Activity parent;, +    WifiParsedResult wifiResult = (WifiParsedResult) getResult();, +    WifiParsedResult wifiResult = (WifiParsedResult) getResult();, +    String wifiLabel = parent.getString(R.string.wifi_ssid_label);, +    ParsedResult.maybeAppend(wifiLabel + '\n' + wifiResult.getSsid(), contents);, +    String typeLabel = parent.getString(R.string.wifi_type_label);, +    ParsedResult.maybeAppend(typeLabel + '\n' + wifiResult.getNetworkEncryption(), contents);, +++ b/android/src/com/google/zxing/client/android/wifi/NetworkUtil.java, +import java.util.regex.Pattern;, +, +  private static final Pattern HEX_DIGITS = Pattern.compile("[0-9A-Fa-f]+");, +, +    int lastPos = string.length() - 1;, +    int length = wepKey.length();, +    return (length == 10 || length == 26 || length == 58) && HEX_DIGITS.matcher(wepKey).matches();, +++ b/android/src/com/google/zxing/client/android/result/WifiResultHandler.java, +, +  private final Activity parent;, +    WifiParsedResult wifiResult = (WifiParsedResult) getResult();, +    WifiParsedResult wifiResult = (WifiParsedResult) getResult();, +    String wifiLabel = parent.getString(R.string.wifi_ssid_label);, +    ParsedResult.maybeAppend(wifiLabel + '\n' + wifiResult.getSsid(), contents);, +    String typeLabel = parent.getString(R.string.wifi_type_label);, +    ParsedResult.maybeAppend(typeLabel + '\n' + wifiResult.getNetworkEncryption(), contents);, +++ b/android/src/com/google/zxing/client/android/wifi/NetworkUtil.java, +import java.util.regex.Pattern;, +, +  private static final Pattern HEX_DIGITS = Pattern.compile("[0-9A-Fa-f]+");, +, +    int lastPos = string.length() - 1;, +    int length = wepKey.length();, +    return (length == 10 || length == 26 || length == 58) && HEX_DIGITS.matcher(wepKey).matches();, +++ b/android/src/com/google/zxing/client/android/wifi/WifiActivity.java, +import java.util.regex.Pattern;, +public final class WifiActivity extends Activity  {, +, +  private static final int MAX_ERROR_COUNT = 3;, +  private static final int FAILURE_NO_NETWORK_ID = -1;, +  private static final Pattern HEX_DIGITS_64 = Pattern.compile("[0-9A-Fa-f]{64}");, +, +  void gotError() {, +    if (errorCount > MAX_ERROR_COUNT){, +    WifiConfiguration config = new WifiConfiguration();, +    WifiConfiguration config = changeNetworkCommon(input);, +    String pass = input.getPassword();, +    WifiConfiguration config = changeNetworkCommon(input);, +    String pass = input.getPassword();, +    if (HEX_DIGITS_64.matcher(pass).matches()){, +    List<WifiConfiguration> existingConfigs = wifiManager.getConfiguredNetworks();, +    for (WifiConfiguration existingConfig : existingConfigs) {, +    Intent intent = getIntent();, +    String ssid = intent.getStringExtra(Intents.WifiConnect.SSID);, +    String networkType = intent.getStringExtra(Intents.WifiConnect.TYPE);, +    if (networkId < 0) {, +      return FAILURE_NO_NETWORK_ID;, +    }, +      networkId = FAILURE_NO_NETWORK_ID;, +      return FAILURE_NO_NETWORK_ID;, +, +++ b/android/src/com/google/zxing/client/android/result/WifiResultHandler.java, +, +  private final Activity parent;, +    WifiParsedResult wifiResult = (WifiParsedResult) getResult();, +    WifiParsedResult wifiResult = (WifiParsedResult) getResult();, +    String wifiLabel = parent.getString(R.string.wifi_ssid_label);, +    ParsedResult.maybeAppend(wifiLabel + '\n' + wifiResult.getSsid(), contents);, +    String typeLabel = parent.getString(R.string.wifi_type_label);, +    ParsedResult.maybeAppend(typeLabel + '\n' + wifiResult.getNetworkEncryption(), contents);, +++ b/android/src/com/google/zxing/client/android/wifi/NetworkUtil.java, +import java.util.regex.Pattern;, +, +  private static final Pattern HEX_DIGITS = Pattern.compile("[0-9A-Fa-f]+");, +, +    int lastPos = string.length() - 1;, +    int length = wepKey.length();, +    return (length == 10 || length == 26 || length == 58) && HEX_DIGITS.matcher(wepKey).matches();, +++ b/android/src/com/google/zxing/client/android/wifi/WifiActivity.java, +import java.util.regex.Pattern;, +public final class WifiActivity extends Activity  {, +, +  private static final int MAX_ERROR_COUNT = 3;, +  private static final int FAILURE_NO_NETWORK_ID = -1;, +  private static final Pattern HEX_DIGITS_64 = Pattern.compile("[0-9A-Fa-f]{64}");, +, +  void gotError() {, +    if (errorCount > MAX_ERROR_COUNT){, +    WifiConfiguration config = new WifiConfiguration();, +    WifiConfiguration config = changeNetworkCommon(input);, +    String pass = input.getPassword();]
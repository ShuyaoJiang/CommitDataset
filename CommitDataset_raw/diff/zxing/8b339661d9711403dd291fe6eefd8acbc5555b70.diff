[+++ b/core/src/com/google/zxing/qrcode/encoder/MaskUtil.java, +  public static boolean getDataMaskBit(int maskPattern, int x, int y) {, +    int intermediate, temp;, +        intermediate = (y + x) & 0x1;, +        break;, +        intermediate = y & 0x1;, +        break;, +        intermediate = x % 3;, +        break;, +        intermediate = (y + x) % 3;, +        break;, +        intermediate = ((y >>> 1) + (x / 3)) & 0x1;, +        break;, +        temp = y * x;, +        intermediate = (temp & 0x1) + (temp % 3);, +        break;, +        temp = y * x;, +        intermediate = (((temp & 0x1) + (temp % 3)) & 0x1);, +        break;, +        temp = y * x;, +        intermediate = (((temp % 3) + ((y + x) & 0x1)) & 0x1);, +        break;, +      default:, +        throw new IllegalArgumentException("Invalid mask pattern: " + maskPattern);, +    return intermediate == 0;, +++ b/core/src/com/google/zxing/qrcode/encoder/MaskUtil.java, +  public static boolean getDataMaskBit(int maskPattern, int x, int y) {, +    int intermediate, temp;, +        intermediate = (y + x) & 0x1;, +        break;, +        intermediate = y & 0x1;, +        break;, +        intermediate = x % 3;, +        break;, +        intermediate = (y + x) % 3;, +        break;, +        intermediate = ((y >>> 1) + (x / 3)) & 0x1;, +        break;, +        temp = y * x;, +        intermediate = (temp & 0x1) + (temp % 3);, +        break;, +        temp = y * x;, +        intermediate = (((temp & 0x1) + (temp % 3)) & 0x1);, +        break;, +        temp = y * x;, +        intermediate = (((temp % 3) + ((y + x) & 0x1)) & 0x1);, +        break;, +      default:, +        throw new IllegalArgumentException("Invalid mask pattern: " + maskPattern);, +    return intermediate == 0;, +++ b/core/src/com/google/zxing/qrcode/encoder/MatrixUtil.java, +            if (MaskUtil.getDataMaskBit(maskPattern, xx, y)) {, +              bit ^= 0x1;, +            }, +++ b/core/src/com/google/zxing/qrcode/encoder/MaskUtil.java, +  public static boolean getDataMaskBit(int maskPattern, int x, int y) {, +    int intermediate, temp;, +        intermediate = (y + x) & 0x1;, +        break;, +        intermediate = y & 0x1;, +        break;, +        intermediate = x % 3;, +        break;, +        intermediate = (y + x) % 3;, +        break;, +        intermediate = ((y >>> 1) + (x / 3)) & 0x1;, +        break;, +        temp = y * x;, +        intermediate = (temp & 0x1) + (temp % 3);, +        break;, +        temp = y * x;, +        intermediate = (((temp & 0x1) + (temp % 3)) & 0x1);, +        break;, +        temp = y * x;, +        intermediate = (((temp % 3) + ((y + x) & 0x1)) & 0x1);, +        break;, +      default:, +        throw new IllegalArgumentException("Invalid mask pattern: " + maskPattern);, +    return intermediate == 0;, +++ b/core/src/com/google/zxing/qrcode/encoder/MatrixUtil.java, +            if (MaskUtil.getDataMaskBit(maskPattern, xx, y)) {, +              bit ^= 0x1;, +            }, +++ b/core/test/src/com/google/zxing/qrcode/encoder/MaskUtilTestCase.java, +        if ((expected[y][x] == 1) !=]
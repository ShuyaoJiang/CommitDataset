Don't require the CA root to be self-signed.

Some root certificates may not be.

Also test the limits of the certificate chain length, and put defense
in for weird unexpected cycles in the trusted certificates.

Merge pull request #632 from square/jwilson_0310_recover_from_failures

Fix problems with connection recycling and recovery.
Merge pull request #1529 from nfuller/FixBadlyBehavedCache

Make badly-behaving caches cause a checked exception, not NPE
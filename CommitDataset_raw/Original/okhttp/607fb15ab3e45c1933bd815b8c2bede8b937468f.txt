Merge pull request #1282 from square/jw/sources-and-sinks

Use Sources and Sinks for all IO.
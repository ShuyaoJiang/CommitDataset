Merge pull request #1087 from square/jwilson_1012_tls_12

Revise how TLS connections are negotiated.

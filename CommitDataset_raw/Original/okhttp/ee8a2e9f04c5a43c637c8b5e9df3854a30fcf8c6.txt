Merge pull request #1876 from square/jw/buffer-in-ws-writer

Introduce intermediate storage for frame contents.
Use UnsafeCursor to XOR web socket data. (#3843)


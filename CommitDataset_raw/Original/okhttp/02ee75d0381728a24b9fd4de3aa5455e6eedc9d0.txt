Merge pull request #744 from square/jwilson_0421_restructure_authenticator

Change the authenticator API to take request and response.
Merge pull request #2520 from yschimke/platform_cleanup

split out platform and test them based on active profile
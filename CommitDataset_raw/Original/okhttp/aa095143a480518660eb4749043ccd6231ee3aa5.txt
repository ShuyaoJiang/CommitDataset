Merge pull request #2959 from square/jwilson.1105.ws_nonblocking_api

New non-blocking API for websockets.
Merge pull request #737 from square/jw/snapshot-leak

Prevent leaking a Snapshot's InputStreams when metadata read fails.
Refactor exceptions and static classes to Kotlin (#4751)


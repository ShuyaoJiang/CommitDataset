Merge pull request #2185 from square/jwilson_0101_api_ergonomics

Detect API use errors earlier.
Merge pull request #329 from square/jw/socket-factory

Allow specifying a socket factory for connections.
Merge pull request #1999 from square/jw/consumers-close

Force consumers to call WS#close on IO error.
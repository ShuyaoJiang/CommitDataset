safer check for invalid values, without catching OOM

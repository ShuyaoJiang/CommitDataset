Added bounds check for issue #952

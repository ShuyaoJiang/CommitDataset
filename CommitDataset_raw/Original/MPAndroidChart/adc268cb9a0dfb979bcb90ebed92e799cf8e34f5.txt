Merge pull request #800 from danielgindi/dry-code

Removed duplicate code
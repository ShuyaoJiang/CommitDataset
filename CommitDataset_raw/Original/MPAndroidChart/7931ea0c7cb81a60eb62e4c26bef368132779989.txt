Merge pull request #1350 from danielgindi/matrix-inf

Prevent the matrix from reaching invalid values
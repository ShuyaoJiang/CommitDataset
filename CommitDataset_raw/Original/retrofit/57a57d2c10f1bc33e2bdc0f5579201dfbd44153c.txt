We weren't syncing the file length metadata. Added syncing code. Added code to constructor to detect files corrupted by this bug and throw an exception.

Merge pull request #899 from square/jw/logic

Rewrite response parsing for more simple control flow.
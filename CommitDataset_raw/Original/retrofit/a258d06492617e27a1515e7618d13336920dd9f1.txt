Removing preInvoke and constructing headers on the main thread

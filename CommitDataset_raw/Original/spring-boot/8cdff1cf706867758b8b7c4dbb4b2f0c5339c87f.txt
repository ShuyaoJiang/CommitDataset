Fix bug in trace repository

When reverse==false we have to be careful to remove the right element
when capacity is reached.

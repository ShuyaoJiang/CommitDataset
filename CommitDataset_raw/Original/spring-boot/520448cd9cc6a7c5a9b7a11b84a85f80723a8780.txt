Add support for publisher confirms/returns

Closes gh-3945

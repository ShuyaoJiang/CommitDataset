Use ApplicationContextRunner in tests

Closes gh-12495

Fail fast if nested condition uses a phase inappropriate for its members

See gh-15086

Add support for using Undertow as an embedded container

See gh-1779

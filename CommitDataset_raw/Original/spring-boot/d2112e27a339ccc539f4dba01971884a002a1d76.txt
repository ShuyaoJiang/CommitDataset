Add FreeMarkerProperties instead of raw Environment access

It's better for readability and tooling. Changed
templateLoaderPath -> path (simpler and unlikely to clash)

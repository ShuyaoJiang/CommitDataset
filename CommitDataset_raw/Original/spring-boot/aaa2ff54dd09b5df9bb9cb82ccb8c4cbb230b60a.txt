Extract @ConditionalOnEnabledEndpoint

Extract @ConditionalOnEnabledEndpoint to a top level class.

See gh-2798

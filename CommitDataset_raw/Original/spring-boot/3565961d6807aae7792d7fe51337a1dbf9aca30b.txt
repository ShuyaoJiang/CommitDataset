Rework HTTP exchange tracing and add support for WebFlux

Closes gh-9980

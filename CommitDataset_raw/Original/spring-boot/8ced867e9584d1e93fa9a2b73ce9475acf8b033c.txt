Use Optional value in more functional style

See gh-15575

Broader attempt at fixing URLStreamHandlerFactory pollution problem

This is a follow-on from d341499 that takes a broader approach to
clearing URLs URLStreamHandlerFactory.

See gh-5290
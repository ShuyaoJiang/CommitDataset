Simplify code by using try-with-resources statement

Closes gh-15427

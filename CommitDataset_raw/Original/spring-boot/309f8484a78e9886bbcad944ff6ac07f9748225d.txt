Fix remote shell to support custom banners

Update the remote shell to use the `Banner` interface when possible.

Fixes gh-3988
Closes gh-5453

Use ResolverStyle.SMART when a custom format is specified

Fixes gh-13970

Add support for injecting a Principal into web endpoint operations

Closes gh-11941

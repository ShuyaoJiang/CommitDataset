Move code snippet to regular source file

Closes gh-9740

Unwrap DataSource target rather than plain instanceof calls

Closes gh-15227

Tweak to support finer grained locking

Fixes gh-543

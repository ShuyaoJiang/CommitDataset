Merge pull request #10077 from izeye:substring-20170825

* pr/10077:
  Avoid substring() invocation when the result is itself

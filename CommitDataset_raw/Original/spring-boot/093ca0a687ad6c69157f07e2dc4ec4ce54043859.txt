Use EnumMap whenever possible

Replace regular Map instances with EnumMap to reduce memory consumption.

Closes gh-11760

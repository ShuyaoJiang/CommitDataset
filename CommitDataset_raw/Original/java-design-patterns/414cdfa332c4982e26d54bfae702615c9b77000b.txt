Merge pull request #398 from legka/master

Event driven architecture refactored.
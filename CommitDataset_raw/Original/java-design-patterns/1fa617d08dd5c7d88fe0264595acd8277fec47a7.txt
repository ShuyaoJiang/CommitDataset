Add proper unit tests for chain pattern #293

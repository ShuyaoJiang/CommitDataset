Added tests for state pattern

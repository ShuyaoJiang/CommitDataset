Solved the classcast exception and used instanceof instead. Improved javadocs a bit.

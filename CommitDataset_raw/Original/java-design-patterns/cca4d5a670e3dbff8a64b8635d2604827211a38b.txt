Update after changes from review. Additional improvements.

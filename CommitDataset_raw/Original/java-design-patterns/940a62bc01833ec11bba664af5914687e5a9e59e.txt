Work on #74, added unit test cases

Add proper unit tests for dependency-injection pattern

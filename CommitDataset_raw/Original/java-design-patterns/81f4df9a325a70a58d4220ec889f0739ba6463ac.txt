Merge pull request #617 from mookkiah/issue_587_reader-writer-lock

#587 SonarQube reports bugs reader-writer-lock and refactor
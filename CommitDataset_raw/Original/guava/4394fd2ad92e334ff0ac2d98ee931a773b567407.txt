Fix deadlock in CompositeService when attempting to shutdown a FAILED service.  Also, when shutting down services make sure all services are either TERMINATED or FAILED before notifyingStopped or notifyingFailed.
-------------
Created by MOE: http://code.google.com/p/moe-java
MOE_MIGRATED_REVID=25070823

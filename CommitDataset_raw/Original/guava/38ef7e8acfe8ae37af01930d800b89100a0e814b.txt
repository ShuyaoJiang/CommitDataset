more carefully bound the segment count by maximum size/weight
-------------
Created by MOE: http://code.google.com/p/moe-java
MOE_MIGRATED_REVID=28665687

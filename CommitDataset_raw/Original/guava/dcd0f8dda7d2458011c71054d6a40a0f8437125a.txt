I give up. I can no longer maintain the in-place algorithm. The bugs have defeated me.

This cl introduces a much simpler, clearer algorithm that splits the path into pieces, and then builds a new path one piece at a time while resolving . and .. along the way.  Finally it does a little fixup to handle the initial slash, if any.
-------------
Created by MOE: http://code.google.com/p/moe-java
MOE_MIGRATED_REVID=24306712

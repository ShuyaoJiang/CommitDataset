I remember why I did the parallel edge check before the self-loop check now! In the MutableGraph case, it's actually more efficient, because we can return early (rather than just throw an exception) in that case. And I have the same order in MutableNetwork just for consistency.
-------------
Created by MOE: https://github.com/google/moe
MOE_MIGRATED_REVID=125487467

Synchronised with 1.0.X branch.
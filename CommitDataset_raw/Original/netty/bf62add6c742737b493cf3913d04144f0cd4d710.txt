Clean up

- Removed unnecessary 'closed' flag and redundant close() calls, etc.
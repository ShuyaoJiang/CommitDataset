Moved inner classes out to top level classes for easier testing

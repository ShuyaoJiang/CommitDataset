Fix wrong use of assertTrue in unit test.

Motivation:

My previous commit b88a980482d2ae introduced a flawed unit test,
that executes an assertion in a different thread than the test thread.
If this assertion fails, the test doesn't fail.

Modifications:

Replace the assertion by a proper workaround.

Result:

More correct unit test

proper handling of cancelled keys

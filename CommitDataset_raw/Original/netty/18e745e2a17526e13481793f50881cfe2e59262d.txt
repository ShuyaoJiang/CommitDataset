buffer.discardReadBytes() should not be called too often

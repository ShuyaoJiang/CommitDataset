Split DiscardHandler into DiscardClientHandler and DiscardServerHandler for easier understanding

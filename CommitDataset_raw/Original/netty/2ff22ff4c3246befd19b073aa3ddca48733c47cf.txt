Add javadocs and also handle writes correctly. See #396

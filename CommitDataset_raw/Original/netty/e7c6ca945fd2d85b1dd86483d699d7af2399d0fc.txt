Fix potential NPE / Use discardReadBytes instead of clear()
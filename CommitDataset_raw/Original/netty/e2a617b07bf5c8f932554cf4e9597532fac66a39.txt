Fix a bug where DetectionUtil.hasUnsafe() returns a wrong value
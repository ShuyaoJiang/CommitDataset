Use LinkedHashSet instead of HashSet to preserve order of execution
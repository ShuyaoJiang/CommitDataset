Fix a bug where SslHandler does not respect the startTls flag

- Fixes #856
- Add a dedicated test case: SocketStartTlsTest

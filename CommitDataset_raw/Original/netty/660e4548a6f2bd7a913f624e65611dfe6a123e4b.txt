Fix an unexpected RejectedExecutionException

- Ensure to run all remaining tasks before marking the executor as
  'shut down'.
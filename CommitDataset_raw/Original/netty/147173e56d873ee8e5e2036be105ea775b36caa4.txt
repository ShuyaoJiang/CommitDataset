* Fixed potential concurrency issues
* message queue should be final

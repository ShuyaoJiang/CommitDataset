Reverted back to the previous MessageEvent implementation that should perform better in most cases

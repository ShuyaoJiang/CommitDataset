Add proper boundary / freeness check on ByteBuf impls

- Fixes #827

* Added ChannelFutureListener.CLOSE_ON_FAILURE
* Reduced code duplication
* Fixed warnings by FindBugs

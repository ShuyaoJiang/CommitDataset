Replace synchronization with an lock free approach
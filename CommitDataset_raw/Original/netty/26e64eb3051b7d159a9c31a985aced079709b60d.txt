Fix IOOBE after buffer truncation / Add CompositeByteBuf.addComponents()

- plus some bug fixes while running unit tests
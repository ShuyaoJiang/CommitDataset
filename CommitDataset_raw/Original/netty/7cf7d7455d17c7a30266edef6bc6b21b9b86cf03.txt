[#1048] Make sure the promise is not notified multiple times on failure

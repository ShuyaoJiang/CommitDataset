Made a serious design mistake - rewrote partially

Reverted back the opportunistic write optimization due to unstability

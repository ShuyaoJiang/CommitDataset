Overall cleanup of cf4c464d99f0723d908151c2b4a2b9d2b203061c

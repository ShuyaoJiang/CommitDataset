[#707] Fix IndexOutOfBoundsException which could accour when the buffer is consolitated in the middle of an operation

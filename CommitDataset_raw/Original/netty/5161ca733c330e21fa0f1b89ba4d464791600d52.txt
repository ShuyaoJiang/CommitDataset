Move utility method to abstract base class and correctly handle expand of buffer also for OIO

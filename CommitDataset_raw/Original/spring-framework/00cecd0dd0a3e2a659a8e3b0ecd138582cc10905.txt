more tests, minor fixes.  some findbugs issues addressed.

Polish "Refactor duplicate code"

Closes gh-1452

call setEnvironment before other awareness methods rather than after; fixed AccessControlContext applicability check

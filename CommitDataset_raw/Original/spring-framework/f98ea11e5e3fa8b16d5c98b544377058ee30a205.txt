Fix string handling to avoid exceptions when doing path extraction

Issue: SPR-15259

Refactor AbstractRequestBodyPublisher states

The state machine is refactored in order to solve various concurrency
issues.

Tokenizer uses single process step and length-based exhaustion check

Issue: SPR-16032

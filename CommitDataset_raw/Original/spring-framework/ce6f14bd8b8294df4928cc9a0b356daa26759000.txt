refined addApplicationListener to work any time during the refresh phase

update consume to subscribe
update after to then (WIP flux)

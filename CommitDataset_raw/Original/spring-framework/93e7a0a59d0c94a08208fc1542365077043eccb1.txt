Merge pull request #1452 from diguage

* pr/1452:
  Polish "Refactor duplicate code"
  Refactor duplicate code

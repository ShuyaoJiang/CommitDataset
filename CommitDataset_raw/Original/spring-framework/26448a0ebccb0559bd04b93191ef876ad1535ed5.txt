Rework matching to use PathContainer

Merge pull request #1588 from benbenw/SPR-16170

Improve memory allocations when substituting named parameters

Issue: SPR-16170
SPR-6786: added more checks for quality factors & charsets

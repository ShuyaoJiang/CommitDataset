revised version checks and exception signatures

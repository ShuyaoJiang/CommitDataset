Consistent to/cc/bcc array handling and revised hashCode without text

Issue: SPR-16671

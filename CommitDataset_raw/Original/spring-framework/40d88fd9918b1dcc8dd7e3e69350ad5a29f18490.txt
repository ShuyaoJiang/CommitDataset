SPR-8730
+ more tests

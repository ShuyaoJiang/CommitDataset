Use AtomicInteger instead of unsafe increment on volatile fields

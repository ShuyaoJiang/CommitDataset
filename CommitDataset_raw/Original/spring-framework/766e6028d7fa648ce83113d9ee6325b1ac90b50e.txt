Defensively handle DatabaseMetaData.getConnection() returning null

Issue: SPR-16495

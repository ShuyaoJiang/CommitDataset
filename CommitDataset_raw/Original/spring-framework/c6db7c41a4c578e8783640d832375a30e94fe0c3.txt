improved javadoc, error handling and testing of matches

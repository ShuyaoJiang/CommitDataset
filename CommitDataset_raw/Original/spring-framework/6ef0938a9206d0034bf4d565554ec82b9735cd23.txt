Defensive URL cleaning (preserving the original URL if possible)

Issue: SPR-17198

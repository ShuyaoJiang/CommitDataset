Revised checkResource implementation

Issue: SPR-14729
(cherry picked from commit ca17edd)

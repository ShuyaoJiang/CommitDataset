Polish "Refactor duplicated code"

Closes gh-1445

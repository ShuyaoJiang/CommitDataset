refined exception messages; added unit tests for custom array types

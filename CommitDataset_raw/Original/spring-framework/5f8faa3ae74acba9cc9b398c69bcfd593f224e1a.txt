improved null handling and javadoc

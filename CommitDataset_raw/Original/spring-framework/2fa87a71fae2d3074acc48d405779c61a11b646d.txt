use custom InputStream traversal instead of a full byte array (SPR-9118)

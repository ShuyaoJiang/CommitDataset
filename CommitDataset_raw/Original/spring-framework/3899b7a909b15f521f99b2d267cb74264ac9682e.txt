Refactor DefaultCodecs.protobufWriter into protobufEncoder

Includes nullability declarations for the protobuf package.

Issue: SPR-15776

Switch to direct accept and no instanceof
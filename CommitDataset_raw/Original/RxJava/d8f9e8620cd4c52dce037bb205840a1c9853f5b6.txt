fix skip race conditions and request overflow

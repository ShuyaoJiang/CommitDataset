2.x: improve BaseTestConsumer with awaitCount & timeout (#5155)

* 2.x: improve BaseTestConsumer with awaitCount & timeout

* Improve diff coverage

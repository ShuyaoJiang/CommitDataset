Merge pull request #2928 from akarnokd/OperatorMergeFullRewrite

Merge and MergeMaxConcurrent unified and rewritten
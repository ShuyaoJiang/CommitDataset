Use lock free strategy

Reduce contention by using CAS (Compare And Swap) operations to replace
subscription

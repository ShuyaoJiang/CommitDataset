Changed producer interface to work with long instead of int

fix unsub of OperatorDoOnRequest and add more unit tests

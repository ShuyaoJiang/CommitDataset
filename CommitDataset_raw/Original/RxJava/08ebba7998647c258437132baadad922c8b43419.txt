Merge pull request #3668 from akarnokd/Java6Backport

2.x: full JDK 6 compatible backport + including bugfixes up to today
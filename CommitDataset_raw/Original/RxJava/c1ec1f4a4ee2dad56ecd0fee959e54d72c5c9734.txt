Make "single" support backpressure

Signed-off-by: zsxwing <zsxwing@gmail.com>

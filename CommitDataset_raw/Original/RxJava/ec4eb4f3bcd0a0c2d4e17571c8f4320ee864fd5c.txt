2.x: add withLatestFrom many, cleanups and other enhancements (#4368)


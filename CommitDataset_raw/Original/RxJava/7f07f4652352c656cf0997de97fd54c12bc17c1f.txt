Extract 'WithUpstream' interfaces. (#4326)

This allows use with types that do not extend directly from their base stream types.
Merge pull request #1158 from akarnokd/SchedulerFixes0506

Scheduler correctness improvements.
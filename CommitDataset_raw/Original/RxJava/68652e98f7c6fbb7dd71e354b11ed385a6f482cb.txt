Merge pull request #1559 from mattrjacobs/scheduler-plugin

More consistent hooks for scheduler plugins.  This is a rework of #1514.
An attempt at implementing the correct combineLatest semantics. The
tests do pass again now (they had to be adapted too).
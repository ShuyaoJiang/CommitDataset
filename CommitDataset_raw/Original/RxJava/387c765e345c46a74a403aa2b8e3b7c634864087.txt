Switch to AtomicIntegerFieldUpdater and volatile int, instead of AtomicBoolean

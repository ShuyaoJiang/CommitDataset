Synchronize Access

The `wip` variable needs its access to be synchronized. Then it calls drainAndComplete outside the lock.

Cleaned up subscriptions to make them idempotent when called from either side.

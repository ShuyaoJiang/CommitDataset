2.x: add offer() method to Publish & Behavior Processors (#5184)

* 2.x: add offer() method to Publish & Behavior Processors

* Sleep instead of yield.

Merge pull request #3783 from akarnokd/DesignRefactorMain2x

2.x: rename and refactor classes to match the design document
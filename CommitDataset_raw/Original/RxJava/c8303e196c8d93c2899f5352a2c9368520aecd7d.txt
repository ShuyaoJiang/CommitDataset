Porting the Scheduler.when operator from 1.x to 2.x (#4827)


Merge pull request #1188 from zsxwing/issue1187

Fix issue #1187 and #1196
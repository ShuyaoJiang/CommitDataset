Range concurrency & off-by-one bugfix
2.x: fix flatMap not cancelling the upstream eagerly (#5133)


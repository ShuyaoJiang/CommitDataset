Add support for return values from extension methods.

The old style is still supported for now to avoid breaking backwards compatibility, but the new style is available, simpler to write and avoids @CheckResult warnings.
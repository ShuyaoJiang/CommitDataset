Allow chaining of arbitrary # of transformations

Also includes some other cleanup, including
allowing arbitrary downsamplers.

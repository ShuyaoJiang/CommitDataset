Refactor and add tests for ImagePresenter
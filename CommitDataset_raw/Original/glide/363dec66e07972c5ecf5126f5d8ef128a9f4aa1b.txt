Throw errors instead of using assert
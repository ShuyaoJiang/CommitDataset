do bitmap ref management on a bg thread

Reduces the number of locks the main thread needs
to acquire and the amount of time they need to be
held (as well as the contention for said locks)

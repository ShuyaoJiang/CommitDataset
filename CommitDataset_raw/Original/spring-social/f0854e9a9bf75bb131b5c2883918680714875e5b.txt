Further work on enabling multiple connections per provider.

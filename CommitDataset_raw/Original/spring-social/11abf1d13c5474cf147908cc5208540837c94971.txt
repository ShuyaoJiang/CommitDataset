Pushed OAuth version-specific code into abstract classes to avoid the if blocks

core tests: replace several classes in dynamic class loader, add additional checks

fix: check variable usage before convert indexed loop to for-each variant (#483)

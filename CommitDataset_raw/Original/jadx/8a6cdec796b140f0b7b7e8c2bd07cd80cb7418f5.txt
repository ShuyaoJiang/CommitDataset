core: refactor fill-array instruction processing and constants replace (fix #48)

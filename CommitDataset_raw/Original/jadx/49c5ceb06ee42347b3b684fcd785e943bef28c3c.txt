core: add framework for internal tests

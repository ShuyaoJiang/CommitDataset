core: fix type inference StackOverflowError

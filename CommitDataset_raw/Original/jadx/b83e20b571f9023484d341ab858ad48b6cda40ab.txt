core: improve immutable list implementation

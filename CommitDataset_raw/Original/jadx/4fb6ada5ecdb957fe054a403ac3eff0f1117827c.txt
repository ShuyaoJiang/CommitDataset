core: fix type inference for phi nodes

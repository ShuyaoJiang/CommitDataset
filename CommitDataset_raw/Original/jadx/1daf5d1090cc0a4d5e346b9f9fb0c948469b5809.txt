core: fix condition processing (resolve #25)

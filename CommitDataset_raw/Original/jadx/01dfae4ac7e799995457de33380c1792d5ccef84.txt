test: add test case for anonymous type, and move assertions to NYI (PR #589)


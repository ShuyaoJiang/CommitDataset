core: fix 'this' reference in anonymous classes

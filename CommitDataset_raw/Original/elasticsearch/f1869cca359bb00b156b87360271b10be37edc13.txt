Fix role query that can match nested documents (#32705)

This change makes sure that the role query excludes nested documents
when it is ran to select the parent documents allowed by the role.
Simplify SyncedFlushService flow with StepListener (#37383)

Today the SyncedFlushService flow is written with multiple nested 
callbacks which are hard to read. This commit replaces them with 
sequential step listeners.
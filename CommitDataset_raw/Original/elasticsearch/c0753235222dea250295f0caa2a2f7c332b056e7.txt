Refactor create index service to be unit testable

This commit refactors MetaDataCreateIndexService so that it is unit
testable.

Relates #25961

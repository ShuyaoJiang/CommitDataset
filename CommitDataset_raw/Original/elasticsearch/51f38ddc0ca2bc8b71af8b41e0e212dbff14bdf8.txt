Switch MetaDataStateFormat to Lucene directory abstraction (#33989)

Switch MetaDataStateFormat to Lucene directory abstraction

This commit switches MetaDataStateFormat class to Lucene directory abstraction to make it easier to test MetaDataStateFormat for different IO failures.
This commits also adds different IO failures tests to MetaDataStateFormatTests.



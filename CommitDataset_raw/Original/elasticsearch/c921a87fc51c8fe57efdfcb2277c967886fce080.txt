Refactor ZonedDateTime.now in millis resolution (#38577)

In different places across the code base the ZonedDateTime in
milliseconds resolution has to be used for testing. Refactoring this to
a single place to avoid code duplication

closes #38511
closes #38581
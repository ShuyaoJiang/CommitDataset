[ML] Avoid assertions on empty Optional in DF usage test (#40043)

Refactor the usage class to make testing simpler

[ML] Fix master node deadlock during ML daily maintenance (#31836)

This is the implementation for master and 6.x of #31691.
Native tests are changed to use multi-node clusters in #31757.

Relates #31683



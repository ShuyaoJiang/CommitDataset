Bug fix for AnnotatedTextHighlighter - port of 39525 (#39747)

Bug fix for AnnotatedTextHighlighter - port of 39525
Relates to #39395

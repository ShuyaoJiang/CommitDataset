[ML] Add integrations tests for memory limit compliance

Relates elastic/x-pack-elasticsearch#2098

Original commit: elastic/x-pack-elasticsearch@730835edfa49e83704e2517f45f283c85ffb52d6

Consolidate version numbering semantics (#27397)

Fixes to the build system, particularly around BWC testing, and to make future
version bumps less painful.

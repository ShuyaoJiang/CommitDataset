fix infinite loop in test and correct logic in timeseries type

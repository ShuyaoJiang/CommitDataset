Revert "Revert "Sense for VirtualBox and $HOME when deciding to turn on vagrant testing. (#24636)""

This reverts commit b9e2a1f9890e12948c7e6a2fb57c30ca2b1fa76a.

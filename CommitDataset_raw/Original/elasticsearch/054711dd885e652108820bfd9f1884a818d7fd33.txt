More refinement of version is compatible test

This test further refines the version is compatible test, adding
additional handling of edge cases.

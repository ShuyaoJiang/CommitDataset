Testclusters: Refactor and fix for newly added tests (#34818)

* Testclusters: Refactor and fix for newly added tests
* Move state management outside of the config object

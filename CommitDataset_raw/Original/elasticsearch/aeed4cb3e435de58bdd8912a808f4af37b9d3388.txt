Followup refactoring for elastic/elasticsearch#25787

Original commit: elastic/x-pack-elasticsearch@ab0e5c45efb508854c0ac48861fc625363756872

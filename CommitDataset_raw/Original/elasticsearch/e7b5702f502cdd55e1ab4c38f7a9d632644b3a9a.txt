Adopt settings cleanups from core (elastic/x-pack-elasticsearch#2605)

Relates to elastic/elasticsearch#26739

Original commit: elastic/x-pack-elasticsearch@dd13d099de82d2d1025394894035c1f5cf1d5c65

Fix Master Failover and DataNode Leave Blocking Snapshot (#38460)

* Closes #38447
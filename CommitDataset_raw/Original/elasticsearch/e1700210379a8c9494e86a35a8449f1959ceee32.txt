Revert "Revert "Fix version parsing in SQL""

This reverts commit elastic/x-pack-elasticsearch@a3ef6b43f9794e6e0230ca60711b2bb211cb4fe8.

We'll merge this when we're good and ready.

Original commit: elastic/x-pack-elasticsearch@06d1e3311dac292b8977637ee275a9bb04f3b6d9

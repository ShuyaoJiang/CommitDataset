Only configure publishing if it's applied externally (#32351)

Only configure publishing if it's applied externally, reconfigure for hasClientJar

Move away from `Settings#getAsMap()` (elastic/x-pack-elasticsearch#2661)

Relates to elastic/elasticsearch#26845

Original commit: elastic/x-pack-elasticsearch@0323ea07a57d4f401857a7b55bb4663b3ecc5359

Cleanup assertions in global checkpoint listeners (#33722)

This commit is a cleanup of the assertions in global checkpoint
listeners, simplifying them and adding some messages to them in case the
assertions trip.
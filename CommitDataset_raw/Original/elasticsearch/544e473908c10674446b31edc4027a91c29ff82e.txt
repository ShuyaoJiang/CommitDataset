Improve robustness of geo shape parser for malformed shapes (#31449)

Ensures that malformed geoshapes are more reliably ignored if
"ignore_malformed" is set to true instead of failing the entire
document.

Closes #31428
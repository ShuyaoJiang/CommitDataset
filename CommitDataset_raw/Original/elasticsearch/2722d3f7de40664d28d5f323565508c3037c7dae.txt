use shell with JAVA_HOME for starting archive (#40118)

Closes #40099
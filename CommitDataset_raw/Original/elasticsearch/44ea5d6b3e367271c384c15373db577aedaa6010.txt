Separate publishing from applying cluster states

Companion commit to elastic/elasticsearch#24236

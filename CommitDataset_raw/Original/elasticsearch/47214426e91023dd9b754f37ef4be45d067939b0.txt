Use InputStreamStreamInputs validation to limit size of tokens (elastic/x-pack-elasticsearch#2537)

Relates to elastic/elasticsearch#26692
relates elastic/x-pack-elasticsearch#2493

Original commit: elastic/x-pack-elasticsearch@8e23868743c2bf62bc257664438ea3eb123555dc

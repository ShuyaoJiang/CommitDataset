Decouple XContentBuilder classes for strict building (elastic/x-pack-elasticsearch#4188)

This is the x-pack side of https://github.com/elastic/elasticsearch/pull/29197

Original commit: elastic/x-pack-elasticsearch@7237622dee8b13474491546021899878bd6b07c5

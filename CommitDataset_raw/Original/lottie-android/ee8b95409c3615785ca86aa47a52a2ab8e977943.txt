Added support for zip files (#846)

See code docs for more info.
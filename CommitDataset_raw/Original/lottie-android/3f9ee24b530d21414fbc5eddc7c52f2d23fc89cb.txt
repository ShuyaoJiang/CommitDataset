Replaced Strong/WeakRef cache with a LruCache (#861)


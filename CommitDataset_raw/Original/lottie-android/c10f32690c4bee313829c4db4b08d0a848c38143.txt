Reduce memory overhead by eliminating some unboxing and iterator creation (#126)

More can be done but this is a good start.
Apply transformation matrices to gradient fills

Fixes #273
Fixes #47

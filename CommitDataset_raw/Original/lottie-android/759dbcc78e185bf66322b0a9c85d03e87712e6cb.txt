improved input stream reading (#532)


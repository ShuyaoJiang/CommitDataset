Optimize start and end progress (#1049)

